<!DOCTYPE html>
<html><head><title>CommandSearcher.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1747);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandSearcher.cs" target="_top">engine\CommandSearcher.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used to enumerate the commands on the system that match the specified</span>
    <span class="c">///</span><span class="c"> command name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="b56d4ddadb4e7cd0" href="../R/b56d4ddadb4e7cd0.html" target="n" data-glyph="2,0" class="t t">CommandSearcher</a> : <span class="i">IEnumerable</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;, <span class="i">IEnumerator</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a command searching enumerator that resolves the location</span>
        <span class="c">///</span><span class="c"> to a command using a standard algorithm.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command to look for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines which types of commands glob resolution of the name will take place on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">commandTypes</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The types of commands to look for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for this engine instance...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7c52be99f559c2b3" href="../R/7c52be99f559c2b3.html" target="n" data-glyph="74,1" class="t constructor">CommandSearcher</a>(
            <b>string</b> <span id="r0 rd" class="r0 r">commandName</span>,
            <a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a> <span id="r1 rd" class="r1 r">options</span>,
            <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r2 rd" class="r2 r">commandTypes</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r3 rd" class="r3 r">context</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r3 r">context</span> != <b>null</b>, <span class="s">&quot;caller to verify context is not null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">commandName</span>), <span class="s">&quot;caller to verify commandName is valid&quot;</span>);
 
            <a href="#5b87b93e5cf6a218" class="i field">_commandName</a> = <span class="r0 r">commandName</span>;
            <a href="#fa55f319f99a9591" class="i field">_context</a> = <span class="r3 r">context</span>;
            <a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a> = <span class="r1 r">options</span>;
            <a href="#b19925be90abf798" class="i field">_commandTypes</a> = <span class="r2 r">commandTypes</span>;
 
            <span class="c">// Initialize the enumerators</span>
            <a href="#b56d4ddadb4e7cd0" class="k">this</a>.<a href="#e8de1406c187bd1f" class="i method">Reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of a command enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of this class as IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i">IEnumerator</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <span class="i">IEnumerable</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;.<a id="ce0cbe687743fa5a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#b56d4ddadb4e7cd0" class="k">this</a>;
        }
 
        <span class="i">IEnumerator</span> <span class="i">IEnumerable</span>.<a id="a9617a04fee7a1ab" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#b56d4ddadb4e7cd0" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Moves the enumerator to the next command match. Public for IEnumerable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if there was another command that matches, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="157d1fe83dcb77a7" href="../R/157d1fe83dcb77a7.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <b>null</b>;
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#256c294253c58527" class="i field">SearchingAliases</a>)
            {
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#1d5d8008cc8ddad9" class="i method">SearchForAliases</a>();
 
                <span class="c">// Why don&#39;t we check IsVisible on other scoped items?</span>
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b> &amp;&amp; <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#0e40bae2be4870b9" class="i method">IsVisible</a>(<a href="#2764b4a0d4bff1a0" class="i field">_commandOrigin</a>, <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// Make sure Current doesn&#39;t return an alias that isn&#39;t visible</span>
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <b>null</b>;
 
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a697950d8cf83259" class="i field">SearchingFunctions</a>;
            }
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a697950d8cf83259" class="i field">SearchingFunctions</a>)
            {
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#5aec8db02bdbe265" class="i method">SearchForFunctions</a>();
                <span class="c">// Return the alias info only if it is visible. If not, then skip to the next</span>
                <span class="c">// stage of command resolution...</span>
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a0db50dc86e73417" class="i field">SearchingCmdlets</a>;
            }
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a0db50dc86e73417" class="i field">SearchingCmdlets</a>)
            {
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#be807d9061c4bbeb" class="i method">SearchForCmdlets</a>();
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#ae0e679e6f86b890" class="i field">StartSearchingForExternalCommands</a>;
            }
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#ae0e679e6f86b890" class="i field">StartSearchingForExternalCommands</a>)
            {
                <b>if</b> ((<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; (<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>)) == 0)
                {
                    <span class="c">// Since we are not requiring any path lookup in this search, just return false now</span>
                    <span class="c">// because all the remaining searches do path lookup.</span>
                    <b>return</b> <b>false</b>;
                }
 
                <span class="c">// For security reasons, if the command is coming from outside the runspace and it looks like a path,</span>
                <span class="c">// we want to pre-check that path before doing any probing of the network or drives</span>
                <b>if</b> (<a href="#2764b4a0d4bff1a0" class="i field">_commandOrigin</a> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a> &amp;&amp; <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>.<span class="i">IndexOfAny</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#0702ea1962d7d49b" class="i field">DirectoryOrDrive</a>) &gt;= 0)
                {
                    <b>bool</b> <span id="r4 rd" class="r4 r">allowed</span> = <b>false</b>;
 
                    <span class="c">// Ok - it looks like it might be a path, so we&#39;re going to check to see if the command is prefixed</span>
                    <span class="c">// by any of the allowed paths. If so, then we allow the search to proceed...</span>
 
                    <span class="c">// If either the Applications or Script lists contain just &#39;*&#39; the command is allowed</span>
                    <span class="c">// at this point.</span>
                    <b>if</b> ((<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>.<span class="i">Count</span> == 1 &amp;&amp;
                        <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>[0].<span class="i">Equals</span>(<span class="s">&quot;*&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) ||
                        (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>.<span class="i">Count</span> == 1 &amp;&amp;
                        <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>[0].<span class="i">Equals</span>(<span class="s">&quot;*&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                    {
                        <span class="r4 r">allowed</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// Ok see it it&#39;s in the applications list</span>
                        <b>foreach</b> (<b>string</b> <span id="r5 rd" class="r5 r">path</span> <b>in</b> <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>)
                        {
                            <b>if</b> (<a href="#8014f283fc591bc2" class="i method">checkPath</a>(<span class="r5 r">path</span>, <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
                            {
                                <span class="r4 r">allowed</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
 
                        <span class="c">// If it wasn&#39;t in the applications list, see it&#39;s in the script list</span>
                        <b>if</b> (!<span class="r4 r">allowed</span>)
                        {
                            <b>foreach</b> (<b>string</b> <span id="r6 rd" class="r6 r">path</span> <b>in</b> <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>)
                            {
                                <b>if</b> (<a href="#8014f283fc591bc2" class="i method">checkPath</a>(<span class="r6 r">path</span>, <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
                                {
                                    <span class="r4 r">allowed</span> = <b>true</b>;
                                    <b>break</b>;
                                }
                            }
                        }
                    }
 
                    <b>if</b> (!<span class="r4 r">allowed</span>)
                    {
                        <b>return</b> <b>false</b>;
                    }
                }
 
                <span class="c">// Advance the state</span>
 
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#ce46122151b5109c" class="i field">PowerShellPathResolution</a>;
 
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#0235c9d1d0aad289" class="i method">ProcessBuiltinScriptState</a>();
 
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <span class="c">// Set the current state to QualifiedFileSystemPath since</span>
                    <span class="c">// we want to skip the qualified file system path search</span>
                    <span class="c">// in the case where we found a PowerShell qualified path.</span>
 
                    <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#b09a8c954961b677" class="i field">QualifiedFileSystemPath</a>;
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#ce46122151b5109c" class="i field">PowerShellPathResolution</a>)
            {
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#b09a8c954961b677" class="i field">QualifiedFileSystemPath</a>;
 
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#f8208376b98a509d" class="i method">ProcessPathResolutionState</a>();
 
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <span class="c">// Search using CommandPathSearch</span>
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#b09a8c954961b677" class="i field">QualifiedFileSystemPath</a> ||
                    <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#9bf0f3cd3e2e1f11" class="i field">PathSearch</a>)
            {
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#81eae862713f91ae" class="i method">ProcessQualifiedFileSystemState</a>();
 
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>if</b> (<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#9bf0f3cd3e2e1f11" class="i field">PathSearch</a>)
            {
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#8b7de5b0369352b3" class="i field">PowerShellRelativePath</a>;
 
                <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <a href="#3530528226287c60" class="i method">ProcessPathSearchState</a>();
 
                <b>if</b> (<a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> != <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="1d5d8008cc8ddad9" href="../R/1d5d8008cc8ddad9.html" target="n" data-glyph="76,1" class="i method">SearchForAliases</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r7 rd" class="r7 r">currentMatch</span> = <b>null</b>;
 
            <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> != <b>null</b> &amp;&amp;
                (<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a>) != 0)
            {
                <span class="r7 r">currentMatch</span> = <a href="#4771fb1d2ea146ac" class="i method">GetNextAlias</a>();
            }
 
            <b>return</b> <span class="r7 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="5aec8db02bdbe265" href="../R/5aec8db02bdbe265.html" target="n" data-glyph="76,1" class="i method">SearchForFunctions</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r8 rd" class="r8 r">currentMatch</span> = <b>null</b>;
 
            <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> != <b>null</b> &amp;&amp;
                (<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; (<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#7837d2f5f0343c5e" class="i field">Filter</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#2a673544a3a7e93f" class="i field">Configuration</a>)) != 0)
            {
                <span class="r8 r">currentMatch</span> = <a href="#74974ee60c9a9ce4" class="i method">GetNextFunction</a>();
            }
 
            <b>return</b> <span class="r8 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="be807d9061c4bbeb" href="../R/be807d9061c4bbeb.html" target="n" data-glyph="76,1" class="i method">SearchForCmdlets</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r9 rd" class="r9 r">currentMatch</span> = <b>null</b>;
 
            <b>if</b> ((<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>) != 0)
            {
                <span class="r9 r">currentMatch</span> = <a href="#e64b436404adb3e7" class="i method">GetNextCmdlet</a>();
            }
 
            <b>return</b> <span class="r9 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="0235c9d1d0aad289" href="../R/0235c9d1d0aad289.html" target="n" data-glyph="76,1" class="i method">ProcessBuiltinScriptState</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r10 rd" class="r10 r">currentMatch</span> = <b>null</b>;
 
            <span class="c">// Check to see if the path is qualified</span>
 
            <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> != <b>null</b> &amp;&amp;
                <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#6dd27d6ba191948d" class="i property">ProviderCount</a> &gt; 0 &amp;&amp;
                <a href="#ab26a9d593d404e0" class="i method">IsQualifiedPSPath</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
            {
                <span class="r10 r">currentMatch</span> = <a href="#130dc6151f86d8c4" class="i method">GetNextFromPath</a>();
            }
 
            <b>return</b> <span class="r10 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="f8208376b98a509d" href="../R/f8208376b98a509d.html" target="n" data-glyph="76,1" class="i method">ProcessPathResolutionState</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r11 rd" class="r11 r">currentMatch</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="c">// Check to see if the path is a file system path that</span>
                <span class="c">// is rooted.  If so that is the next match</span>
                <b>if</b> (<span class="i">Path</span>.<span class="i">IsPathRooted</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>) &amp;&amp;
                    <span class="i">File</span>.<span class="i">Exists</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
                {
                    <b>try</b>
                    {
                        <span class="r11 r">currentMatch</span> = <a href="#9645426172951abf" class="i method">GetInfoFromPath</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    }
                    <b>catch</b> (<span class="i">FileLoadException</span>)
                    {
                    }
                    <b>catch</b> (<span class="i">FormatException</span>)
                    {
                    }
                    <b>catch</b> (<a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a>)
                    {
                    }
                }
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <span class="c">// If the path contains illegal characters that</span>
                <span class="c">// weren&#39;t caught by the other APIs, IsPathRooted</span>
                <span class="c">// will throw an exception.</span>
                <span class="c">// For example, looking for a command called</span>
                <span class="c">// `abcdef</span>
                <span class="c">// The `a will be translated into the beep control character</span>
                <span class="c">// which is not a legal file system character, though</span>
                <span class="c">// Path.InvalidPathChars does not contain it as an invalid</span>
                <span class="c">// character.</span>
            }
 
            <b>return</b> <span class="r11 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="81eae862713f91ae" href="../R/81eae862713f91ae.html" target="n" data-glyph="76,1" class="i method">ProcessQualifiedFileSystemState</a>()
        {
            <b>try</b>
            {
                <a href="#d9317118c823b411" class="i method">setupPathSearcher</a>();
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#bc1dd3519211da22" class="i field">NoMoreMatches</a>;
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">PathTooLongException</span>)
            {
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#bc1dd3519211da22" class="i field">NoMoreMatches</a>;
                <b>throw</b>;
            }
 
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r12 rd" class="r12 r">currentMatch</span> = <b>null</b>;
            <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#9bf0f3cd3e2e1f11" class="i field">PathSearch</a>;
            <b>if</b> (<a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a>)
            {
                <b>try</b>
                {
                    <span class="c">// the previous call to setupPathSearcher ensures _pathSearcher != null</span>
                    <b>while</b> (<span class="r12 r">currentMatch</span> == <b>null</b> &amp;&amp; <a href="#843f369798ada210" class="i field">_pathSearcher</a>!.<a href="CommandPathSearch.cs.html#c075bba946a76b14" class="i method">MoveNext</a>())
                    {
                        <span class="r12 r">currentMatch</span> = <span class="i">GetInfoFromPath</span>(((<span class="i">IEnumerator</span>&lt;<b>string</b>&gt;)<a href="#843f369798ada210" class="i field">_pathSearcher</a>).<span class="i">Current</span>);
                    }
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                {
                    <span class="c">// The enumerator may throw if there are no more matches</span>
                }
            }
 
            <b>return</b> <span class="r12 r">currentMatch</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="3530528226287c60" href="../R/3530528226287c60.html" target="n" data-glyph="76,1" class="i method">ProcessPathSearchState</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r13 rd" class="r13 r">currentMatch</span> = <b>null</b>;
            <b>string</b>? <span id="r14 rd" class="r14 r">path</span> = <a href="#fe3379d42203a16a" class="i method">DoPowerShellRelativePathLookup</a>();
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r14 r">path</span>))
            {
                <span class="r13 r">currentMatch</span> = <span class="i">GetInfoFromPath</span>(<span class="r14 r">path</span>);
            }
 
            <b>return</b> <span class="r13 r">currentMatch</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the CommandInfo representing the current command match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator is positioned before the first element of</span>
        <span class="c">///</span><span class="c"> the collection or after the last element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span class="i">IEnumerator</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;.<a id="eecbe57766f9376e" href="../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>if</b> ((<a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#256c294253c58527" class="i field">SearchingAliases</a> &amp;&amp; <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> == <b>null</b>) ||
                    <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> == <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#bc1dd3519211da22" class="i field">NoMoreMatches</a> ||
                    <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                }
 
                <b>return</b> <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a>;
            }
        }
 
        <b>object</b> <span class="i">IEnumerator</span>.<a id="a88709452aaa7651" href="../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> ((<span class="i">IEnumerator</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;)<a href="#b56d4ddadb4e7cd0" class="k">this</a>).<span class="i">Current</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Required by the IEnumerator generic interface.</span>
        <span class="c">///</span><span class="c"> Resets the searcher.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7ba73ccf5768a2d2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (<a href="#843f369798ada210" class="i field">_pathSearcher</a> != <b>null</b>)
            {
                <a href="#843f369798ada210" class="i field">_pathSearcher</a>.<a href="CommandPathSearch.cs.html#ed34f64fbc3222af" class="i method">Dispose</a>();
                <a href="#843f369798ada210" class="i field">_pathSearcher</a> = <b>null</b>;
            }
 
            <a href="#e8de1406c187bd1f" class="i method">Reset</a>();
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#b56d4ddadb4e7cd0" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next command info using the command name as a path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CommandInfo for the next command if it exists as a path, or null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="130dc6151f86d8c4" href="../R/130dc6151f86d8c4.html" target="n" data-glyph="76,1" class="i method">GetNextFromPath</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r15 rd" class="r15 r">result</span> = <b>null</b>;
 
            <b>do</b> <span class="c">// false loop</span>
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                    <span class="s">&quot;The name appears to be a qualified path: {0}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
 
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                    <span class="s">&quot;Trying to resolve the path as an PSPath&quot;</span>);
 
                <span class="c">// Find the match if it is.</span>
                <span class="c">// Try literal path resolution if it is set to run first</span>
                <b>if</b> (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#9c3d13905ec4008c" class="i field">ResolveLiteralThenPathPatterns</a>))
                {
                    <b>var</b> <span id="r16 rd" class="r16 r">path</span> = <a href="#47f69f1c98e12e26" class="i method">GetNextLiteralPathThatExistsAndHandleExceptions</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>, <b>out _</b>);
 
                    <b>if</b> (<span class="r16 r">path</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="i">GetInfoFromPath</span>(<span class="r16 r">path</span>);
                    }
                }
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r17 rd" class="r17 r">resolvedPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
                {
                    <span class="r17 r">resolvedPaths</span> = <span class="i">GetNextFromPathUsingWildcards</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>, <b>out _</b>);
                }
 
                <span class="c">// Try literal path resolution if wildcards are enable first and wildcard search failed</span>
                <b>if</b> (!<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#9c3d13905ec4008c" class="i field">ResolveLiteralThenPathPatterns</a>) &amp;&amp;
                    <span class="r17 r">resolvedPaths</span>.<span class="i">Count</span> == 0)
                {
                    <b>string</b>? <span id="r18 rd" class="r18 r">path</span> = <a href="#47f69f1c98e12e26" class="i method">GetNextLiteralPathThatExistsAndHandleExceptions</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>, <b>out _</b>);
 
                    <b>if</b> (<span class="r18 r">path</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="i">GetInfoFromPath</span>(<span class="r18 r">path</span>);
                    }
                }
 
                <b>if</b> (<span class="r17 r">resolvedPaths</span>.<span class="i">Count</span> &gt; 1)
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                        <span class="s">&quot;The path resolved to more than one result so this path cannot be used.&quot;</span>);
                    <b>break</b>;
                }
 
                <span class="c">// If the path was resolved, and it exists</span>
                <b>if</b> (<span class="r17 r">resolvedPaths</span>.<span class="i">Count</span> == 1 &amp;&amp;
                    <span class="i">File</span>.<span class="i">Exists</span>(<span class="r17 r">resolvedPaths</span>[0]))
                {
                    <b>string</b> <span id="r19 rd" class="r19 r">path</span> = <span class="r17 r">resolvedPaths</span>[0];
 
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                        <span class="s">&quot;Path resolved to: {0}&quot;</span>,
                        <span class="r19 r">path</span>);
 
                    <span class="r15 r">result</span> = <a href="#9645426172951abf" class="i method">GetInfoFromPath</a>(<span class="r19 r">path</span>);
                }
            } <b>while</b> (<b>false</b>);
 
            <b>return</b> <span class="r15 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next path using WildCards.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The provider that the command was found in.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of full paths to the commands which were found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="5c328a98822bdd75" href="../R/5c328a98822bdd75.html" target="n" data-glyph="76,1" class="i method">GetNextFromPathUsingWildcards</a>(<b>string</b>? <span id="r20 rd" class="r20 r">command</span>, <b>out</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>? <span id="r21 rd" class="r21 r">provider</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>.<span class="i">GetGlobbedProviderPathsFromMonadPath</span>(<span class="i">path</span>: <span class="r20 r">command</span>, <span class="i">allowNonexistingPaths</span>: <b>false</b>, <span class="i">provider</span>: <b>out</b> <span class="r21 r">provider</span>, <span class="i">providerInstance</span>: <b>out _</b>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The path could not be found: {0}&quot;</span>,
                    <span class="r20 r">command</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#09140e6dc875019b" class="t t">DriveNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;A drive could not be found for the path: {0}&quot;</span>,
                    <span class="r20 r">command</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;A provider could not be found for the path: {0}&quot;</span>,
                    <span class="r20 r">command</span>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The path specified a home directory, but the provider home directory was not set. {0}&quot;</span>,
                    <span class="r20 r">command</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r22 rd" class="r22 r">providerException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The provider associated with the path &#39;{0}&#39; encountered an error: {1}&quot;</span>,
                    <span class="r20 r">command</span>,
                    <span class="r22 r">providerException</span>.<a href="../utils/SessionStateExceptions.cs.html#ca5c39e5cd30c80d" class="i property">Message</a>);
            }
            <b>catch</b> (<a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The provider associated with the path &#39;{0}&#39; does not implement ContainerCmdletProvider&quot;</span>,
                    <span class="r20 r">command</span>);
            }
 
            <span class="r21 r">provider</span> = <b>null</b>;
            <b>return</b> <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
        }
 
        <b>private static bool</b> <a id="8014f283fc591bc2" href="../R/8014f283fc591bc2.html" target="n" data-glyph="76,1" class="i method">checkPath</a>(<b>string</b> <span id="r23 rd" class="r23 r">path</span>, <b>string</b> <span id="r24 rd" class="r24 r">commandName</span>)
        {
            <b>return</b> <span class="r23 r">path</span>.<span class="i">StartsWith</span>(<span class="r24 r">commandName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the appropriate CommandInfo instance given the specified path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to create the CommandInfo for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the appropriate CommandInfo derivative given the specified path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">FileLoadException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">path</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a cmdlet, or cmdletprovider</span>
        <span class="c">///</span><span class="c"> and it could not be loaded as an XML document.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">FormatException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">path</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a cmdlet, or cmdletprovider</span>
        <span class="c">///</span><span class="c"> that does not adhere to the appropriate file format for its extension.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">path</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a cmdlet file that</span>
        <span class="c">///</span><span class="c"> contains invalid metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="9645426172951abf" href="../R/9645426172951abf.html" target="n" data-glyph="76,1" class="i method">GetInfoFromPath</a>(<b>string</b> <span id="r25 rd" class="r25 r">path</span>)
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r26 rd" class="r26 r">result</span> = <b>null</b>;
 
            <b>do</b> <span class="c">// false loop</span>
            {
                <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="r25 r">path</span>))
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;The path does not exist: {0}&quot;</span>, <span class="r25 r">path</span>);
                    <b>break</b>;
                }
 
                <span class="c">// Now create the appropriate CommandInfo using the extension</span>
                <b>string</b>? <span id="r27 rd" class="r27 r">extension</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r27 r">extension</span> = <span class="i">Path</span>.<span class="i">GetExtension</span>(<span class="r25 r">path</span>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                    <span class="c">// If the path contains illegal characters that</span>
                    <span class="c">// weren&#39;t caught by the other APIs, GetExtension</span>
                    <span class="c">// will throw an exception.</span>
                    <span class="c">// For example, looking for a command called</span>
                    <span class="c">// `abcdef</span>
                    <span class="c">// The `a will be translated into the beep control character</span>
                    <span class="c">// which is not a legal file system character.</span>
                }
 
                <b>if</b> (<span class="r27 r">extension</span> == <b>null</b>)
                {
                    <span class="r26 r">result</span> = <b>null</b>;
                    <b>break</b>;
                }
 
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r27 r">extension</span>, <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#2338784ad03a106f" class="i field">PowerShellScriptFileExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> ((<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>) != 0)
                    {
                        <b>string</b> <span id="r28 rd" class="r28 r">scriptName</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r25 r">path</span>);
 
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(
                            <span class="s">&quot;Command Found: path ({0}) is a script with name: {1}&quot;</span>,
                            <span class="r25 r">path</span>,
                            <span class="r28 r">scriptName</span>);
 
                        <span class="c">// The path is to a PowerShell script</span>
 
                        <span class="r26 r">result</span> = <b>new</b> <a href="ExternalScriptInfo.cs.html#0769c91ec3133070" class="t constructor">ExternalScriptInfo</a>(<span class="r28 r">scriptName</span>, <span class="r25 r">path</span>, <a href="#fa55f319f99a9591" class="i field">_context</a>);
                        <b>break</b>;
                    }
 
                    <b>break</b>;
                }
 
                <b>if</b> ((<a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp; <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>) != 0)
                {
                    <span class="c">// Anything else is treated like an application</span>
 
                    <b>string</b> <span id="r29 rd" class="r29 r">appName</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r25 r">path</span>);
 
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(
                        <span class="s">&quot;Command Found: path ({0}) is an application with name: {1}&quot;</span>,
                        <span class="r25 r">path</span>,
                        <span class="r29 r">appName</span>);
 
                    <span class="r26 r">result</span> = <b>new</b> <a href="ApplicationInfo.cs.html#79467f70e45fa69b" class="t constructor">ApplicationInfo</a>(<span class="r29 r">appName</span>, <span class="r25 r">path</span>, <a href="#fa55f319f99a9591" class="i field">_context</a>);
                    <b>break</b>;
                }
            } <b>while</b> (<b>false</b>);
 
            <span class="c">// Verify that this script is not untrusted, if we aren&#39;t constrained.</span>
            <b>if</b> (<a href="#a6fad7f09201477b" class="i method">ShouldSkipCommandResolutionForConstrainedLanguage</a>(<span class="r26 r">result</span>, <a href="#fa55f319f99a9591" class="i field">_context</a>))
            {
                <span class="r26 r">result</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r26 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next matching alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CommandInfo representing the next matching alias if found, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="4771fb1d2ea146ac" href="../R/4771fb1d2ea146ac.html" target="n" data-glyph="76,1" class="i method">GetNextAlias</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r30 rd" class="r30 r">result</span> = <b>null</b>;
 
            <b>if</b> ((<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a> &amp; <a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#ad2602de61710376" class="i field">ResolveAliasPatterns</a>) != 0)
            {
                <b>if</b> (<a href="#41030f585420e53a" class="i field">_matchingAlias</a> == <b>null</b>)
                {
                    <span class="c">// Generate the enumerator of matching alias names</span>
 
                    <span class="i">Collection</span>&lt;<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt; <span id="r31 rd" class="r31 r">matchingAliases</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt;();
 
                    <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r32 rd" class="r32 r">aliasMatcher</span> =
                        <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(
                            <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                            <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                    <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt; <span id="r33 rd" class="r33 r">aliasEntry</span> <b>in</b> <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateAliasAPIs.cs.html#2139e166b1eb6afa" class="i method">GetAliasTable</a>())
                    {
                        <b>if</b> (<span class="r32 r">aliasMatcher</span>.<span class="i">IsMatch</span>(<span class="r33 r">aliasEntry</span>.<span class="i">Key</span>) ||
                            (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#70f2a6b1e2a16492" class="i field">FuzzyMatch</a>) &amp;&amp;
                            <a href="../utils/FuzzyMatch.cs.html#39ac23db4a63eca2" class="t t">FuzzyMatcher</a>.<span class="i">IsFuzzyMatch</span>(<span class="r33 r">aliasEntry</span>.<span class="i">Key</span>, <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>)))
                        {
                            <span class="r31 r">matchingAliases</span>.<span class="i">Add</span>(<span class="r33 r">aliasEntry</span>.<span class="i">Value</span>);
                        }
                    }
 
                    <span class="c">// Process alias from modules</span>
                    <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>? <span id="r34 rd" class="r34 r">c</span> = <a href="#59692a3be9202945" class="i method">GetAliasFromModules</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    <b>if</b> (<span class="r34 r">c</span> != <b>null</b>)
                    {
                        <span class="r31 r">matchingAliases</span>.<span class="i">Add</span>(<span class="r34 r">c</span>);
                    }
 
                    <a href="#41030f585420e53a" class="i field">_matchingAlias</a> = <span class="r31 r">matchingAliases</span>.<span class="i">GetEnumerator</span>();
                }
 
                <b>if</b> (!<a href="#41030f585420e53a" class="i field">_matchingAlias</a>.<span class="i">MoveNext</span>())
                {
                    <span class="c">// Advance the state</span>
                    <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a697950d8cf83259" class="i field">SearchingFunctions</a>;
 
                    <a href="#41030f585420e53a" class="i field">_matchingAlias</a> = <b>null</b>;
                }
                <b>else</b>
                {
                    <span class="r30 r">result</span> = <a href="#41030f585420e53a" class="i field">_matchingAlias</a>.<span class="i">Current</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a697950d8cf83259" class="i field">SearchingFunctions</a>;
 
                <span class="r30 r">result</span> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateAliasAPIs.cs.html#b2fe92ea38746079" class="i method">GetAlias</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>) ?? <a href="#59692a3be9202945" class="i method">GetAliasFromModules</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
 
            <span class="c">// Verify that this alias was not created by an untrusted constrained language,</span>
            <span class="c">// if we aren&#39;t constrained.</span>
            <b>if</b> (<a href="#a6fad7f09201477b" class="i method">ShouldSkipCommandResolutionForConstrainedLanguage</a>(<span class="r30 r">result</span>, <a href="#fa55f319f99a9591" class="i field">_context</a>))
            {
                <span class="r30 r">result</span> = <b>null</b>;
            }
 
            <b>if</b> (<span class="r30 r">result</span> != <b>null</b>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(
                    <span class="s">&quot;Alias found: {0}  {1}&quot;</span>,
                    <span class="r30 r">result</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                    <span class="r30 r">result</span>.<a href="CommandInfo.cs.html#a887e8cd226475a7" class="i property">Definition</a>);
            }
 
            <b>return</b> <span class="r30 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next matching function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CommandInfo representing the next matching function if found, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="74974ee60c9a9ce4" href="../R/74974ee60c9a9ce4.html" target="n" data-glyph="76,1" class="i method">GetNextFunction</a>()
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r35 rd" class="r35 r">result</span> = <b>null</b>;
 
            <b>if</b> (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#315f95f2041e0da1" class="i field">ResolveFunctionPatterns</a>))
            {
                <b>if</b> (<a href="#ad78d3f28b0e4c3a" class="i field">_matchingFunctionEnumerator</a> == <b>null</b>)
                {
                    <span class="i">Collection</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>?&gt; <span id="r36 rd" class="r36 r">matchingFunction</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>?&gt;();
 
                    <span class="c">// Generate the enumerator of matching function names</span>
                    <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r37 rd" class="r37 r">functionMatcher</span> =
                        <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(
                            <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                            <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                    <b>foreach</b> ((<b>string</b> <span id="r38 rd" class="r38 r">functionName</span>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r39 rd" class="r39 r">functionInfo</span>) <b>in</b> <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">GetFunctionTable</span>())
                    {
                        <b>if</b> (<span class="r37 r">functionMatcher</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r38 r">functionName</span>) ||
                            (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#70f2a6b1e2a16492" class="i field">FuzzyMatch</a>) &amp;&amp;
                            <a href="../utils/FuzzyMatch.cs.html#39ac23db4a63eca2" class="t t">FuzzyMatcher</a>.<a href="../utils/FuzzyMatch.cs.html#338755097bb7a248" class="i method">IsFuzzyMatch</a>(<span class="r38 r">functionName</span>, <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>)))
                        {
                            <span class="r36 r">matchingFunction</span>.<span class="i">Add</span>(<span class="r39 r">functionInfo</span>);
                        }
                        <b>else</b> <b>if</b> (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#e5d14e217b7a7a75" class="i field">UseAbbreviationExpansion</a>))
                        {
                            <b>if</b> (<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>.<span class="i">Equals</span>(<a href="Modules/ModuleUtils.cs.html#623e3612c4173093" class="t t">ModuleUtils</a>.<a href="Modules/ModuleUtils.cs.html#78b6ed6030b3942a" class="i method">AbbreviateName</a>(<span class="r38 r">functionName</span>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r36 r">matchingFunction</span>.<span class="i">Add</span>(<span class="r39 r">functionInfo</span>);
                            }
                        }
                    }
 
                    <span class="c">// Process functions from modules</span>
                    <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r40 rd" class="r40 r">cmdInfo</span> = <a href="#629afe7c77d9713e" class="i method">GetFunctionFromModules</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    <b>if</b> (<span class="r40 r">cmdInfo</span> != <b>null</b>)
                    {
                        <span class="r36 r">matchingFunction</span>.<span class="i">Add</span>(<span class="r40 r">cmdInfo</span>);
                    }
 
                    <a href="#ad78d3f28b0e4c3a" class="i field">_matchingFunctionEnumerator</a> = <span class="r36 r">matchingFunction</span>.<span class="i">GetEnumerator</span>();
                }
 
                <b>if</b> (!<a href="#ad78d3f28b0e4c3a" class="i field">_matchingFunctionEnumerator</a>.<span class="i">MoveNext</span>())
                {
                    <span class="c">// Advance the state</span>
                    <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a0db50dc86e73417" class="i field">SearchingCmdlets</a>;
 
                    <a href="#ad78d3f28b0e4c3a" class="i field">_matchingFunctionEnumerator</a> = <b>null</b>;
                }
                <b>else</b>
                {
                    <span class="r35 r">result</span> = <a href="#ad78d3f28b0e4c3a" class="i field">_matchingFunctionEnumerator</a>.<span class="i">Current</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#a0db50dc86e73417" class="i field">SearchingCmdlets</a>;
 
                <span class="r35 r">result</span> = <a href="#d9427b05c6464c82" class="i method">GetFunction</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
 
            <span class="c">// Verify that this function was not created by an untrusted constrained language,</span>
            <span class="c">// if we aren&#39;t constrained.</span>
            <b>if</b> (<a href="#a6fad7f09201477b" class="i method">ShouldSkipCommandResolutionForConstrainedLanguage</a>(<span class="r35 r">result</span>, <a href="#fa55f319f99a9591" class="i field">_context</a>))
            {
                <span class="r35 r">result</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r35 r">result</span>;
        }
 
        <span class="c">// Don&#39;t return commands to the user if that might result in:</span>
        <span class="c">//     - Trusted commands calling untrusted functions that the user has overridden</span>
        <span class="c">//     - Debug prompts calling internal functions that are likely to have code injection</span>
        <b>private static bool</b> <a id="a6fad7f09201477b" href="../R/a6fad7f09201477b.html" target="n" data-glyph="76,1" class="i method">ShouldSkipCommandResolutionForConstrainedLanguage</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r41 rd" class="r41 r">result</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r42 rd" class="r42 r">executionContext</span>)
        {
            <b>if</b> (<span class="r41 r">result</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Don&#39;t return untrusted commands to trusted functions</span>
            <b>if</b> ((<span class="r41 r">result</span>.<a href="CommandInfo.cs.html#8677495d43679110" class="i property">DefiningLanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>) &amp;&amp;
                (<span class="r42 r">executionContext</span>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Don&#39;t allow invocation of trusted functions from debug breakpoints.</span>
            <span class="c">// They were probably defined within a trusted script, and could be</span>
            <span class="c">// susceptible to injection attacks. However, we do allow execution</span>
            <span class="c">// of functions defined in the global scope (i.e.: &quot;more&quot;,) as those</span>
            <span class="c">// are intended to be exposed explicitly to users.</span>
            <b>if</b> ((<span class="r41 r">result</span> <b>is</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>) &amp;&amp;
                (<span class="r42 r">executionContext</span>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>) &amp;&amp;
                (<span class="r41 r">result</span>.<a href="CommandInfo.cs.html#8677495d43679110" class="i property">DefiningLanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>) &amp;&amp;
                (<span class="r42 r">executionContext</span>.<a href="ExecutionContext.cs.html#3e56b2d709de0d80" class="i property">Debugger</a> != <b>null</b>) &amp;&amp;
                (<span class="r42 r">executionContext</span>.<a href="ExecutionContext.cs.html#3e56b2d709de0d80" class="i property">Debugger</a>.<a href="debugger/debugger.cs.html#bfa00bd3aebf1f44" class="i property">InBreakpoint</a>) &amp;&amp;
                (!(<span class="r42 r">executionContext</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="SessionStateFunctionAPIs.cs.html#4c97a37931935eb7" class="i method">GetFunctionTableAtScope</a>(<span class="s">&quot;GLOBAL&quot;</span>).<span class="i">ContainsKey</span>(<span class="r41 r">result</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>))))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>? <a id="59692a3be9202945" href="../R/59692a3be9202945.html" target="n" data-glyph="76,1" class="i method">GetAliasFromModules</a>(<b>string</b> <span id="r43 rd" class="r43 r">command</span>)
        {
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>? <span id="r44 rd" class="r44 r">result</span> = <b>null</b>;
 
            <b>if</b> (<span class="r43 r">command</span>.<span class="i">IndexOf</span>(<span class="s">&#39;\\&#39;</span>) &gt; 0)
            {
                <span class="c">// See if it&#39;s a module qualified alias...</span>
                <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>? <span id="r45 rd" class="r45 r">qualifiedName</span> = <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>.<span class="i">GetInstance</span>(<span class="r43 r">command</span>);
                <b>if</b> (<span class="r45 r">qualifiedName</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r45 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>))
                {
                    <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>? <span id="r46 rd" class="r46 r">module</span> = <span class="i">GetImportedModuleByName</span>(<span class="r45 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>);
 
                    <span class="r46 r">module</span>?.<a href="Modules/PSModuleInfo.cs.html#992cd7d7155ed907" class="i property">ExportedAliases</a>.<span class="i">TryGetValue</span>(<span class="r45 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>, <b>out</b> <span class="r44 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r44 r">result</span>;
        }
 
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="629afe7c77d9713e" href="../R/629afe7c77d9713e.html" target="n" data-glyph="76,1" class="i method">GetFunctionFromModules</a>(<b>string</b> <span id="r47 rd" class="r47 r">command</span>)
        {
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>? <span id="r48 rd" class="r48 r">result</span> = <b>null</b>;
 
            <b>if</b> (<span class="r47 r">command</span>.<span class="i">IndexOf</span>(<span class="s">&#39;\\&#39;</span>) &gt; 0)
            {
                <span class="c">// See if it&#39;s a module qualified function call...</span>
                <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>? <span id="r49 rd" class="r49 r">qualifiedName</span> = <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>.<span class="i">GetInstance</span>(<span class="r47 r">command</span>);
                <b>if</b> (<span class="r49 r">qualifiedName</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r49 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>))
                {
                    <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>? <span id="r50 rd" class="r50 r">module</span> = <span class="i">GetImportedModuleByName</span>(<span class="r49 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>);
 
                    <span class="r50 r">module</span>?.<a href="Modules/PSModuleInfo.cs.html#2faddd301cf044c5" class="i property">ExportedFunctions</a>.<span class="i">TryGetValue</span>(<span class="r49 r">qualifiedName</span>.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>, <b>out</b> <span class="r48 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r48 r">result</span>;
        }
 
        <b>private</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>? <a id="9c86d999dadd3f99" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetImportedModuleByName</a>(<b>string</b> <span id="r51 rd" class="r51 r">moduleName</span>)
        {
            <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>? <span id="r52 rd" class="r52 r">module</span> = <b>null</b>;
            <span class="i">List</span>&lt;<a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt; <span id="r53 rd" class="r53 r">modules</span> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#2d3edf63c7afa4b2" class="i property">Modules</a>.<a href="Modules/ModuleIntrinsics.cs.html#1c52622ea6eacb86" class="i method">GetModules</a>(<b>new</b> <b>string</b>[] { <span class="r51 r">moduleName</span> }, <b>false</b>);
 
            <b>if</b> (<span class="r53 r">modules</span> != <b>null</b> &amp;&amp; <span class="r53 r">modules</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r54 rd" class="r54 r">m</span> <b>in</b> <span class="r53 r">modules</span>)
                {
                    <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#6fbdd167e636c979" class="i property">previousModuleImported</a>.<span class="i">ContainsKey</span>(<span class="r54 r">m</span>.<a href="Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>) &amp;&amp; ((<b>string</b>?)<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#6fbdd167e636c979" class="i property">previousModuleImported</a>[<span class="r54 r">m</span>.<a href="Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>] == <span class="r54 r">m</span>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>))
                    {
                        <span class="r52 r">module</span> = <span class="r54 r">m</span>;
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r52 r">module</span> == <b>null</b>)
                {
                    <span class="r52 r">module</span> = <span class="r53 r">modules</span>[0];
                }
            }
 
            <b>return</b> <span class="r52 r">module</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the FunctionInfo or FilterInfo for the specified function name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">function</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function/filter to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo if the function name exists and is a function, a FilterInfo if</span>
        <span class="c">///</span><span class="c"> the filter name exists and is a filter, or null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="d9427b05c6464c82" href="../R/d9427b05c6464c82.html" target="n" data-glyph="76,1" class="i method">GetFunction</a>(<b>string</b> <span id="r55 rd" class="r55 r">function</span>)
        {
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <span id="r56 rd" class="r56 r">result</span> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateFunctionAPIs.cs.html#09dc9c88802b581d" class="i method">GetFunction</a>(<span class="r55 r">function</span>);
 
            <b>if</b> (<span class="r56 r">result</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r56 r">result</span> <b>is</b> <a href="FilterInfo.cs.html#945af8143f567881" class="t t">FilterInfo</a>)
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                        <span class="s">&quot;Filter found: {0}&quot;</span>,
                        <span class="r55 r">function</span>);
                }
                <b>else</b> <b>if</b> (<span class="r56 r">result</span> <b>is</b> <a href="ConfigurationInfo.cs.html#f7e2a2001ad5ccfc" class="t t">ConfigurationInfo</a>)
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                        <span class="s">&quot;Configuration found: {0}&quot;</span>,
                        <span class="r55 r">function</span>);
                }
                <b>else</b>
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                        <span class="s">&quot;Function found: {0}  {1}&quot;</span>,
                        <span class="r55 r">function</span>);
                }
            }
            <b>else</b>
            {
                <span class="r56 r">result</span> = <a href="#629afe7c77d9713e" class="i method">GetFunctionFromModules</a>(<span class="r55 r">function</span>);
            }
 
            <b>return</b> <span class="r56 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next cmdlet from the collection of matching cmdlets.</span>
        <span class="c">///</span><span class="c"> If the collection doesn&#39;t exist yet it is created and the</span>
        <span class="c">///</span><span class="c"> enumerator is moved to the first item in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CmdletInfo for the next matching Cmdlet or null if there are</span>
        <span class="c">///</span><span class="c"> no more matches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>? <a id="e64b436404adb3e7" href="../R/e64b436404adb3e7.html" target="n" data-glyph="76,1" class="i method">GetNextCmdlet</a>()
        {
            <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>? <span id="r57 rd" class="r57 r">result</span> = <b>null</b>;
            <b>bool</b> <span id="r58 rd" class="r58 r">useAbbreviationExpansion</span> = <a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#e5d14e217b7a7a75" class="i field">UseAbbreviationExpansion</a>);
 
            <b>if</b> (<a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a> == <b>null</b>)
            {
                <b>if</b> (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#038d9150e27f9fdf" class="i field">CommandNameIsPattern</a>) || <span class="r58 r">useAbbreviationExpansion</span>)
                {
                    <span class="i">Collection</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r59 rd" class="r59 r">matchingCmdletInfo</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;();
 
                    <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>? <span id="r60 rd" class="r60 r">PSSnapinQualifiedCommandName</span> =
                        <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>.<span class="i">GetInstance</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
 
                    <b>if</b> (!<span class="r58 r">useAbbreviationExpansion</span> &amp;&amp; <span class="r60 r">PSSnapinQualifiedCommandName</span> == <b>null</b>)
                    {
                        <b>return</b> <b>null</b>;
                    }
 
                    <b>string</b>? <span id="r61 rd" class="r61 r">moduleName</span> = <span class="r60 r">PSSnapinQualifiedCommandName</span>?.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>;
 
                    <b>var</b> <span id="r62 rd" class="r62 r">cmdletShortName</span> = <span class="r60 r">PSSnapinQualifiedCommandName</span>?.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>;
                    <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>? <span id="r63 rd" class="r63 r">cmdletMatcher</span> = <span class="r62 r">cmdletShortName</span> != <b>null</b>
                        ? <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r62 r">cmdletShortName</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>)
                        : <b>null</b>;
 
                    <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r64 rd" class="r64 r">ss</span> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
                    <b>foreach</b> (<span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r65 rd" class="r65 r">cmdletList</span> <b>in</b> <span class="r64 r">ss</span>.<a href="SessionStateCmdletAPIs.cs.html#45b521c66dc38967" class="i method">GetCmdletTable</a>().<span class="i">Values</span>)
                    {
                        <b>foreach</b> (<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r66 rd" class="r66 r">cmdlet</span> <b>in</b> <span class="r65 r">cmdletList</span>)
                        {
                            <b>if</b> (<span class="r63 r">cmdletMatcher</span> != <b>null</b> &amp;&amp;
                                <span class="r63 r">cmdletMatcher</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r66 r">cmdlet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>) ||
                                (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#70f2a6b1e2a16492" class="i field">FuzzyMatch</a>) &amp;&amp;
                                 <a href="../utils/FuzzyMatch.cs.html#39ac23db4a63eca2" class="t t">FuzzyMatcher</a>.<a href="../utils/FuzzyMatch.cs.html#338755097bb7a248" class="i method">IsFuzzyMatch</a>(<span class="r66 r">cmdlet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>)))
                            {
                                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">moduleName</span>) || <span class="r61 r">moduleName</span>.<span class="i">Equals</span>(<span class="r66 r">cmdlet</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <span class="c">// If PSSnapin is specified, make sure they match</span>
                                    <span class="r59 r">matchingCmdletInfo</span>.<span class="i">Add</span>(<span class="r66 r">cmdlet</span>);
                                }
                            }
                            <b>else</b> <b>if</b> (<span class="r58 r">useAbbreviationExpansion</span>)
                            {
                                <b>if</b> (<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>.<span class="i">Equals</span>(<a href="Modules/ModuleUtils.cs.html#623e3612c4173093" class="t t">ModuleUtils</a>.<a href="Modules/ModuleUtils.cs.html#78b6ed6030b3942a" class="i method">AbbreviateName</a>(<span class="r66 r">cmdlet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <span class="r59 r">matchingCmdletInfo</span>.<span class="i">Add</span>(<span class="r66 r">cmdlet</span>);
                                }
                            }
                        }
                    }
 
                    <a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a> = <span class="r59 r">matchingCmdletInfo</span>.<span class="i">GetEnumerator</span>();
                }
                <b>else</b>
                {
                    <a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<span class="i">GetCmdletInfo</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                        <a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#dcf3e09a7e1c6cc7" class="i field">SearchAllScopes</a>));
                }
            }
 
            <b>if</b> (!<a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a>.<span class="i">MoveNext</span>())
            {
                <span class="c">// Advance the state</span>
                <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#ae0e679e6f86b890" class="i field">StartSearchingForExternalCommands</a>;
 
                <a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a> = <b>null</b>;
            }
            <b>else</b>
            {
                <span class="r57 r">result</span> = <a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a>.<span class="i">Current</span>;
            }
 
            <b>return</b> <a href="#01dbea56c35b2545" class="i method">traceResult</a>(<span class="r57 r">result</span>);
        }
 
        <b>private</b> <span class="i">IEnumerator</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;? <a id="982452b606b70c8a" href="../R/982452b606b70c8a.html" target="n" data-glyph="46,1" class="i field">_matchingCmdlet</a>;
 
        [<b>return</b>: <span class="i">NotNullIfNotNull</span>(<span class="s">&quot;result&quot;</span>)]
        <b>private static</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>? <a id="01dbea56c35b2545" href="../R/01dbea56c35b2545.html" target="n" data-glyph="76,1" class="i method">traceResult</a>(<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>? <span id="r67 rd" class="r67 r">result</span>)
        {
            <b>if</b> (<span class="r67 r">result</span> != <b>null</b>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                    <span class="s">&quot;Cmdlet found: {0}  {1}&quot;</span>,
                    <span class="r67 r">result</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                    <span class="r67 r">result</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>);
            }
 
            <b>return</b> <span class="r67 r">result</span>;
        }
 
        <b>private string</b>? <a id="fe3379d42203a16a" href="../R/fe3379d42203a16a.html" target="n" data-glyph="76,1" class="i method">DoPowerShellRelativePathLookup</a>()
        {
            <b>string</b>? <span id="r68 rd" class="r68 r">result</span> = <b>null</b>;
 
            <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> != <b>null</b> &amp;&amp;
                <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#6dd27d6ba191948d" class="i property">ProviderCount</a> &gt; 0 &amp;&amp; <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>.<span class="i">Length</span> != 0)
            {
                <span class="c">// NTRAID#Windows OS Bugs-1009294-2004/02/04-JeffJon</span>
                <span class="c">// This is really slow.  Maybe since we are only allowing FS paths right</span>
                <span class="c">// now we should use the file system APIs to verify the existence of the file.</span>
 
                <span class="c">// Since the path to the command was not found using the PATH variable,</span>
                <span class="c">// maybe it is relative to the current location. Try resolving the</span>
                <span class="c">// path.</span>
                <span class="c">// Relative Path:       &quot;.\command.exe&quot;</span>
                <span class="c">// Home Path:           &quot;~\command.exe&quot;</span>
                <span class="c">// Drive Relative Path: &quot;\Users\User\AppData\Local\Temp\command.exe&quot;</span>
 
                <b>char</b> <span id="r69 rd" class="r69 r">firstChar</span> = <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>[0];
                <b>if</b> (<span class="r69 r">firstChar</span> == <span class="s">&#39;.&#39;</span> || <span class="r69 r">firstChar</span> == <span class="s">&#39;~&#39;</span> || <span class="r69 r">firstChar</span> == <span class="s">&#39;\\&#39;</span>)
                {
                    <b>using</b> (<a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                        <span class="s">&quot;{0} appears to be a relative path. Trying to resolve relative path&quot;</span>,
                        <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>))
                    {
                        <span class="r68 r">result</span> = <span class="i">ResolvePSPath</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    }
                }
            }
 
            <b>return</b> <span class="r68 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves the given path as an PSPath and ensures that it was resolved</span>
        <span class="c">///</span><span class="c"> by the FileSystemProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to resolve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path that was resolved. Null if the path couldn&#39;t be resolved or was</span>
        <span class="c">///</span><span class="c"> not resolved by the FileSystemProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b>? <a id="6a650dc79fe9ec6d" href="../R/6a650dc79fe9ec6d.html" target="n" data-glyph="76,1" class="i method">ResolvePSPath</a>(<b>string</b>? <span id="r70 rd" class="r70 r">path</span>)
        {
            <b>string</b>? <span id="r71 rd" class="r71 r">result</span> = <b>null</b>;
 
            <b>try</b>
            {
                <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>? <span id="r72 rd" class="r72 r">provider</span> = <b>null</b>;
                <b>string</b>? <span id="r73 rd" class="r73 r">resolvedPath</span> = <b>null</b>;
 
                <span class="c">// Try literal path resolution if it is set to run first</span>
                <b>if</b> (<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#9c3d13905ec4008c" class="i field">ResolveLiteralThenPathPatterns</a>))
                {
                    <span class="c">// Cannot return early as this code path only expects</span>
                    <span class="c">// The file system provider and the final check for that</span>
                    <span class="c">// must verify this before we return.</span>
                    <span class="r73 r">resolvedPath</span> = <a href="#d4717bec3e6a0d02" class="i method">GetNextLiteralPathThatExists</a>(<span class="r70 r">path</span>, <b>out</b> <span class="r72 r">provider</span>);
                }
 
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">ContainsWildcardCharacters</span>(<span class="r70 r">path</span>) &amp;&amp;
                    ((<span class="r73 r">resolvedPath</span> == <b>null</b>) || (<span class="r72 r">provider</span> == <b>null</b>)))
                {
                    <span class="c">// Let PowerShell resolve relative path with wildcards.</span>
                    <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r74 rd" class="r74 r">resolvedPaths</span> = <a href="#5c328a98822bdd75" class="i method">GetNextFromPathUsingWildcards</a>(<span class="r70 r">path</span>, <b>out</b> <span class="r72 r">provider</span>);
 
                    <b>if</b> (<span class="r74 r">resolvedPaths</span>.<span class="i">Count</span> == 0)
                    {
                        <span class="r73 r">resolvedPath</span> = <b>null</b>;
 
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                           <span class="s">&quot;The relative path with wildcard did not resolve to valid path. {0}&quot;</span>,
                           <span class="r70 r">path</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r74 r">resolvedPaths</span>.<span class="i">Count</span> &gt; 1)
                    {
                        <span class="r73 r">resolvedPath</span> = <b>null</b>;
 
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                        <span class="s">&quot;The relative path with wildcard resolved to multiple paths. {0}&quot;</span>,
                        <span class="r70 r">path</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r73 r">resolvedPath</span> = <span class="r74 r">resolvedPaths</span>[0];
                    }
                }
 
                <span class="c">// Try literal path resolution if wildcards are enabled first and wildcard search failed</span>
                <b>if</b> (!<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#9c3d13905ec4008c" class="i field">ResolveLiteralThenPathPatterns</a>) &amp;&amp;
                    ((<span class="r73 r">resolvedPath</span> == <b>null</b>) || (<span class="r72 r">provider</span> == <b>null</b>)))
                {
                    <span class="r73 r">resolvedPath</span> = <a href="#d4717bec3e6a0d02" class="i method">GetNextLiteralPathThatExists</a>(<span class="r70 r">path</span>, <b>out</b> <span class="r72 r">provider</span>);
                }
 
                <span class="c">// Verify the path was resolved to a file system path</span>
                <b>if</b> (<span class="r72 r">provider</span> != <b>null</b> &amp;&amp; <span class="r72 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>))
                {
                    <span class="r71 r">result</span> = <span class="r73 r">resolvedPath</span>;
 
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;The relative path was resolved to: {0}&quot;</span>,
                        <span class="r71 r">result</span>);
                }
                <b>else</b>
                {
                    <span class="c">// The path was not to the file system</span>
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                        <span class="s">&quot;The relative path was not a file system path. {0}&quot;</span>,
                        <span class="r70 r">path</span>);
                }
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The home path was not specified for the provider. {0}&quot;</span>,
                    <span class="r70 r">path</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r75 rd" class="r75 r">providerInvocationException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;While resolving the path, \&quot;{0}\&quot;, an error was encountered by the provider: {1}&quot;</span>,
                    <span class="r70 r">path</span>,
                    <span class="r75 r">providerInvocationException</span>.<a href="../utils/SessionStateExceptions.cs.html#ca5c39e5cd30c80d" class="i property">Message</a>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                    <span class="s">&quot;The path does not exist: {0}&quot;</span>,
                    <span class="r70 r">path</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#09140e6dc875019b" class="t t">DriveNotFoundException</a> <span id="r76 rd" class="r76 r">driveNotFound</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;The drive does not exist: {0}&quot;</span>,
                    <span class="r76 r">driveNotFound</span>.<a href="../utils/SessionStateExceptions.cs.html#8318b800167e6d3b" class="i property">ItemName</a>);
            }
 
            <b>return</b> <span class="r71 r">result</span>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next literal path.</span>
        <span class="c">///</span><span class="c"> Filtering to ones that exist for the filesystem.</span>
        <span class="c">///</span><span class="c"> Handles Exceptions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The provider that the command was found in.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Full path to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b>? <a id="47f69f1c98e12e26" href="../R/47f69f1c98e12e26.html" target="n" data-glyph="76,1" class="i method">GetNextLiteralPathThatExistsAndHandleExceptions</a>(<b>string</b> <span id="r77 rd" class="r77 r">command</span>, <b>out</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>? <span id="r78 rd" class="r78 r">provider</span>)
        {
            <b>try</b>
            {
                <b>return</b> <span class="i">GetNextLiteralPathThatExists</span>(<span class="r77 r">command</span>, <b>out</b> <span class="r78 r">provider</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;The path could not be found: {0}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#09140e6dc875019b" class="t t">DriveNotFoundException</a>)
            {
                <span class="c">// This can be because we think a scope or a url is a drive</span>
                <span class="c">// and need to continue searching.</span>
                <span class="c">// Although, scope does not work through get-command</span>
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;A drive could not be found for the path: {0}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;A provider could not be found for the path: {0}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;The path specified a home directory, but the provider home directory was not set. {0}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r79 rd" class="r79 r">providerException</span>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;The provider associated with the path &#39;{0}&#39; encountered an error: {1}&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                    <span class="r79 r">providerException</span>.<a href="../utils/SessionStateExceptions.cs.html#ca5c39e5cd30c80d" class="i property">Message</a>);
            }
            <b>catch</b> (<a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a>)
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                    <span class="s">&quot;The provider associated with the path &#39;{0}&#39; does not implement ContainerCmdletProvider&quot;</span>,
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
            }
 
            <span class="r78 r">provider</span> = <b>null</b>;
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the next literal path.</span>
        <span class="c">///</span><span class="c"> Filtering to ones that exist for the filesystem.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The provider that the command was found in.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Full path to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b>? <a id="d4717bec3e6a0d02" href="../R/d4717bec3e6a0d02.html" target="n" data-glyph="76,1" class="i method">GetNextLiteralPathThatExists</a>(<b>string</b>? <span id="r80 rd" class="r80 r">command</span>, <b>out</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>? <span id="r81 rd" class="r81 r">provider</span>)
        {
            <b>string</b> <span id="r82 rd" class="r82 r">resolvedPath</span> = <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>.<span class="i">GetProviderPath</span>(<span class="r80 r">command</span>, <b>out</b> <span class="r81 r">provider</span>);
 
            <b>if</b> (<span class="r81 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>)
                &amp;&amp; !<span class="i">File</span>.<span class="i">Exists</span>(<span class="r82 r">resolvedPath</span>)
                &amp;&amp; !<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r82 r">resolvedPath</span>))
            {
                <span class="r81 r">provider</span> = <b>null</b>;
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r82 r">resolvedPath</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a collection of patterns used to find the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">commandDiscovery</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Get names for command discovery.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the patterns used to find the command.</span>
        <span class="c">///</span><span class="c"> The patterns are as follows:</span>
        <span class="c">///</span><span class="c">     1. [commandName].cmdlet</span>
        <span class="c">///</span><span class="c">     2. [commandName].ps1</span>
        <span class="c">///</span><span class="c">     3..x</span>
        <span class="c">///</span><span class="c">         foreach (extension in PATHEXT)</span>
        <span class="c">///</span><span class="c">             [commandName].[extension]</span>
        <span class="c">///</span><span class="c">     x+1. [commandName]</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains one or more of the</span>
        <span class="c">///</span><span class="c"> invalid characters defined in InvalidPathChars.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="t t">LookupPathCollection</a> <a id="6c20aff3f0de9ce1" href="../R/6c20aff3f0de9ce1.html" target="n" data-glyph="74,1" class="i method">ConstructSearchPatternsFromName</a>(<b>string</b> <span id="r83 rd" class="r83 r">name</span>, <b>bool</b> <span id="r84 rd" class="r84 r">commandDiscovery</span> = <b>false</b>)
        {
            <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="k">var</a> <span id="r85 rd" class="r85 r">result</span> = <b>new</b> <a href="CommandDiscovery.cs.html#e8f6b7a7bef770f5" class="t constructor">LookupPathCollection</a>();
 
            <span class="c">// First check to see if the commandName has an extension, if so</span>
            <span class="c">// look for that first</span>
            <b>bool</b> <span id="r86 rd" class="r86 r">commandNameAddedFirst</span> = <span class="i">Path</span>.<span class="i">HasExtension</span>(<span class="r83 r">name</span>);
 
            <b>if</b> (<span class="r86 r">commandNameAddedFirst</span>)
            {
                <span class="r85 r">result</span>.<a href="CommandDiscovery.cs.html#5bf39696caf7c517" class="i method">Add</a>(<span class="r83 r">name</span>);
            }
 
            <span class="c">// Add the extensions for script, module and data files in that order...</span>
            <b>if</b> (<a href="#b19925be90abf798" class="i field">_commandTypes</a>.<span class="i">HasFlag</span>(<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>))
            {
                <span class="r85 r">result</span>.<span class="i">Add</span>(<span class="r83 r">name</span> + <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#2338784ad03a106f" class="i field">PowerShellScriptFileExtension</a>);
                <b>if</b> (!<span class="r84 r">commandDiscovery</span>)
                {
                    <span class="c">// psd1 and psm1 are not executable, so don&#39;t add them</span>
                    <span class="r85 r">result</span>.<span class="i">Add</span>(<span class="r83 r">name</span> + <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#d3eec386d080fd52" class="i field">PowerShellModuleFileExtension</a>);
                    <span class="r85 r">result</span>.<span class="i">Add</span>(<span class="r83 r">name</span> + <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#35afed2e7cb8ba9d" class="i field">PowerShellDataFileExtension</a>);
                }
            }
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <b>if</b> (<a href="#b19925be90abf798" class="i field">_commandTypes</a>.<span class="i">HasFlag</span>(<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>))
            {
                <span class="c">// Now add each extension from the PATHEXT environment variable</span>
                <b>foreach</b> (<b>string</b> <span id="r87 rd" class="r87 r">extension</span> <b>in</b> <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#bfb5c06a04a1d33d" class="i property">PathExtensions</a>)
                {
                    <span class="r85 r">result</span>.<span class="i">Add</span>(<span class="r83 r">name</span> + <span class="r87 r">extension</span>);
                }
            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <span class="c">// Now add the commandName by itself if it wasn&#39;t added as the first pattern</span>
            <b>if</b> (!<span class="r86 r">commandNameAddedFirst</span>)
            {
                <span class="r85 r">result</span>.<a href="CommandDiscovery.cs.html#5bf39696caf7c517" class="i method">Add</a>(<span class="r83 r">name</span>);
            }
 
            <b>return</b> <span class="r85 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the given command name is a qualified PowerShell path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the command name is either a provider-qualified or PowerShell drive-qualified</span>
        <span class="c">///</span><span class="c"> path. False otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="ab26a9d593d404e0" href="../R/ab26a9d593d404e0.html" target="n" data-glyph="76,1" class="i method">IsQualifiedPSPath</a>(<b>string</b> <span id="r88 rd" class="r88 r">commandName</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r88 r">commandName</span>),
                <span class="s">&quot;The caller should have verified the commandName&quot;</span>);
 
            <b>bool</b> <span id="r89 rd" class="r89 r">result</span> =
                <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../namespaces/LocationGlobber.cs.html#4cd70f3f191704a0" class="i method">IsAbsolutePath</a>(<span class="r88 r">commandName</span>) ||
                <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../namespaces/LocationGlobber.cs.html#45d8fc5f64551b7a" class="i method">IsProviderQualifiedPath</a>(<span class="r88 r">commandName</span>) ||
                <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../namespaces/LocationGlobber.cs.html#48978d46f1040a39" class="i method">IsHomePath</a>(<span class="r88 r">commandName</span>) ||
                <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../namespaces/LocationGlobber.cs.html#f0c7a79be5b8b12b" class="i method">IsProviderDirectPath</a>(<span class="r88 r">commandName</span>);
 
            <b>return</b> <span class="r89 r">result</span>;
        }
 
        <b>private enum</b> <a id="259d62cd16005771" href="../R/259d62cd16005771.html" target="n" data-glyph="22,1" class="t t"><span id="efe2d62944200e58">CanDoPathLookupResult</span></a>
        {
            <a id="60b0e13066309088" href="../R/60b0e13066309088.html" target="n" data-glyph="24,2" class="i field">Yes</a>,
            <a id="d019735b5ecb1479" href="../R/d019735b5ecb1479.html" target="n" data-glyph="24,2" class="i field">PathIsRooted</a>,
            <a id="f78299fec344a37d" href="../R/f78299fec344a37d.html" target="n" data-glyph="24,2" class="i field">WildcardCharacters</a>,
            <a id="1eda41f63563316e" href="../R/1eda41f63563316e.html" target="n" data-glyph="24,2" class="i field">DirectorySeparator</a>,
            <a id="ffcbc3e4e2349d6a" href="../R/ffcbc3e4e2349d6a.html" target="n" data-glyph="24,2" class="i field">IllegalCharacters</a>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the command name has any path special</span>
        <span class="c">///</span><span class="c"> characters which would require resolution. If so,</span>
        <span class="c">///</span><span class="c"> path lookup will not succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">possiblePath</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command name (or possible path) to look for the special characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the command name does not contain any special</span>
        <span class="c">///</span><span class="c"> characters.  False otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a> <a id="b976e5cbf94cc027" href="../R/b976e5cbf94cc027.html" target="n" data-glyph="76,1" class="i method">CanDoPathLookup</a>(<b>string</b> <span id="r90 rd" class="r90 r">possiblePath</span>)
        {
            <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a> <span id="r91 rd" class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#60b0e13066309088" class="i field">Yes</a>;
 
            <b>do</b> <span class="c">// false loop</span>
            {
                <span class="c">// If the command name contains any wildcard characters</span>
                <span class="c">// we can&#39;t do the path lookup</span>
 
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r90 r">possiblePath</span>))
                {
                    <span class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#f78299fec344a37d" class="i field">WildcardCharacters</a>;
                    <b>break</b>;
                }
 
                <b>try</b>
                {
                    <b>if</b> (<span class="i">Path</span>.<span class="i">IsPathRooted</span>(<span class="r90 r">possiblePath</span>))
                    {
                        <span class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#d019735b5ecb1479" class="i field">PathIsRooted</a>;
                        <b>break</b>;
                    }
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                    <span class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#ffcbc3e4e2349d6a" class="i field">IllegalCharacters</a>;
                    <b>break</b>;
                }
 
                <span class="c">// If the command contains any path separators, we can&#39;t</span>
                <span class="c">// do the path lookup</span>
                <b>if</b> (<span class="r90 r">possiblePath</span>.<span class="i">IndexOfAny</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#182cf4a18b62de18" class="i field">Directory</a>) != -1)
                {
                    <span class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#1eda41f63563316e" class="i field">DirectorySeparator</a>;
                    <b>break</b>;
                }
 
                <span class="c">// If the command contains any invalid path characters, we can&#39;t</span>
                <span class="c">// do the path lookup</span>
 
                <b>if</b> (<span class="r90 r">possiblePath</span>.<span class="i">IndexOfAny</span>(<span class="i">Path</span>.<span class="i">GetInvalidPathChars</span>()) != -1)
                {
                    <span class="r91 r">result</span> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#ffcbc3e4e2349d6a" class="i field">IllegalCharacters</a>;
                    <b>break</b>;
                }
            } <b>while</b> (<b>false</b>);
 
            <b>return</b> <span class="r91 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command name to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="5b87b93e5cf6a218" href="../R/5b87b93e5cf6a218.html" target="n" data-glyph="46,1" class="i field">_commandName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines which command types will be globbed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a> <a id="0a5f62f00cb426fc" href="../R/0a5f62f00cb426fc.html" target="n" data-glyph="46,1" class="i field">_commandResolutionOptions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines which types of commands to look for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <a id="b19925be90abf798" href="../R/b19925be90abf798.html" target="n" data-glyph="46,1" class="i field">_commandTypes</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator that uses the Path to</span>
        <span class="c">///</span><span class="c"> search for commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandPathSearch.cs.html#edd9b71bf4db52b8" class="t t">CommandPathSearch</a>? <a id="843f369798ada210" href="../R/843f369798ada210.html" target="n" data-glyph="46,1" class="i field">_pathSearcher</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context instance for the current engine...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="fa55f319f99a9591" href="../R/fa55f319f99a9591.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A routine to initialize the path searcher...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the commandName used to construct this object</span>
        <span class="c">///</span><span class="c"> contains one or more of the invalid characters defined</span>
        <span class="c">///</span><span class="c"> in InvalidPathChars.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="d9317118c823b411" href="../R/d9317118c823b411.html" target="n" data-glyph="76,1" class="i method">setupPathSearcher</a>()
        {
            <span class="c">// If it&#39;s already set up, just return...</span>
            <b>if</b> (<a href="#843f369798ada210" class="i field">_pathSearcher</a> != <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="c">// We are never going to look for non-executable commands in CommandSearcher.</span>
            <span class="c">// Even though file types like .DOC, .LOG,.TXT, etc. can be opened / invoked, users think of these as files, not applications.</span>
            <span class="c">// So I don&#39;t think we should show applications with the additional extensions at all.</span>
            <span class="c">// Applications should only include files whose extensions are in the PATHEXT list and these would only be returned with the All parameter.</span>
 
            <b>if</b> ((<a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a> &amp; <a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#038d9150e27f9fdf" class="i field">CommandNameIsPattern</a>) != 0)
            {
                <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>true</b>;
                <a href="#c453de751eaeb8ae" class="i field">_canDoPathLookupResult</a> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#60b0e13066309088" class="i field">Yes</a>;
 
                <a href="#843f369798ada210" class="i field">_pathSearcher</a> =
                    <b>new</b> <span class="t">CommandPathSearch</span>(
                        <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                        <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#9e0a3ce76f51b028" class="i method">GetLookupDirectoryPaths</a>(),
                        <a href="#fa55f319f99a9591" class="i field">_context</a>,
                        <span class="i">acceptableCommandNames</span>: <b>null</b>,
                        <span class="i">useFuzzyMatch</span>: <a href="#0a5f62f00cb426fc" class="i field">_commandResolutionOptions</a>.<span class="i">HasFlag</span>(<a href="#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="#70f2a6b1e2a16492" class="i field">FuzzyMatch</a>));
            }
            <b>else</b>
            {
                <a href="#c453de751eaeb8ae" class="i field">_canDoPathLookupResult</a> = <a href="#b976e5cbf94cc027" class="i method">CanDoPathLookup</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                <b>if</b> (<a href="#c453de751eaeb8ae" class="i field">_canDoPathLookupResult</a> == <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#60b0e13066309088" class="i field">Yes</a>)
                {
                    <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>true</b>;
                    <a href="#5b87b93e5cf6a218" class="i field">_commandName</a> = <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>.<span class="i">TrimEnd</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#a30ec3eede1d04e5" class="i field">PathSearchTrimEnd</a>);
 
                    <a href="#843f369798ada210" class="i field">_pathSearcher</a> =
                        <b>new</b> <span class="t">CommandPathSearch</span>(
                            <a href="#5b87b93e5cf6a218" class="i field">_commandName</a>,
                            <a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#9e0a3ce76f51b028" class="i method">GetLookupDirectoryPaths</a>(),
                            <a href="#fa55f319f99a9591" class="i field">_context</a>,
                            <a href="#6c20aff3f0de9ce1" class="i method">ConstructSearchPatternsFromName</a>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>, <span class="r84 r">commandDiscovery</span>: <b>true</b>),
                            <span class="i">useFuzzyMatch</span>: <b>false</b>);
                }
                <b>else</b> <b>if</b> (<a href="#c453de751eaeb8ae" class="i field">_canDoPathLookupResult</a> == <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#d019735b5ecb1479" class="i field">PathIsRooted</a>)
                {
                    <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>true</b>;
 
                    <b>string</b>? <span id="r92 rd" class="r92 r">directory</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="k">var</a> <span id="r93 rd" class="r93 r">directoryCollection</span> = <b>new</b> <a href="CommandDiscovery.cs.html#e8f6b7a7bef770f5" class="t constructor">LookupPathCollection</a> { <span class="r92 r">directory</span> };
 
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;The path is rooted, so only doing the lookup in the specified directory: {0}&quot;</span>,
                        <span class="r92 r">directory</span>);
 
                    <b>string</b> <span id="r94 rd" class="r94 r">fileName</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r94 r">fileName</span>))
                    {
                        <span class="r94 r">fileName</span> = <span class="r94 r">fileName</span>.<span class="i">TrimEnd</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#a30ec3eede1d04e5" class="i field">PathSearchTrimEnd</a>);
                        <a href="#843f369798ada210" class="i field">_pathSearcher</a> =
                            <b>new</b> <span class="t">CommandPathSearch</span>(
                                <span class="r94 r">fileName</span>,
                                <span class="r93 r">directoryCollection</span>,
                                <a href="#fa55f319f99a9591" class="i field">_context</a>,
                                <a href="#6c20aff3f0de9ce1" class="i method">ConstructSearchPatternsFromName</a>(<span class="r94 r">fileName</span>, <span class="r84 r">commandDiscovery</span>: <b>true</b>),
                                <span class="i">useFuzzyMatch</span>: <b>false</b>);
                    }
                    <b>else</b>
                    {
                        <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>false</b>;
                    }
                }
                <b>else</b> <b>if</b> (<a href="#c453de751eaeb8ae" class="i field">_canDoPathLookupResult</a> == <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#1eda41f63563316e" class="i field">DirectorySeparator</a>)
                {
                    <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>true</b>;
 
                    <span class="c">// We must try to resolve the path as an PSPath or else we can&#39;t do</span>
                    <span class="c">// path lookup for relative paths.</span>
 
                    <b>string</b>? <span id="r95 rd" class="r95 r">directory</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
                    <span class="r95 r">directory</span> = <a href="#6a650dc79fe9ec6d" class="i method">ResolvePSPath</a>(<span class="r95 r">directory</span>);
 
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;The path is relative, so only doing the lookup in the specified directory: {0}&quot;</span>,
                        <span class="r95 r">directory</span>);
 
                    <b>if</b> (<span class="r95 r">directory</span> == <b>null</b>)
                    {
                        <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>false</b>;
                    }
                    <b>else</b>
                    {
                        <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="k">var</a> <span id="r96 rd" class="r96 r">directoryCollection</span> = <b>new</b> <a href="CommandDiscovery.cs.html#e8f6b7a7bef770f5" class="t constructor">LookupPathCollection</a> { <span class="r95 r">directory</span> };
 
                        <b>string</b> <span id="r97 rd" class="r97 r">fileName</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<a href="#5b87b93e5cf6a218" class="i field">_commandName</a>);
 
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r97 r">fileName</span>))
                        {
                            <span class="r97 r">fileName</span> = <span class="r97 r">fileName</span>.<span class="i">TrimEnd</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#a30ec3eede1d04e5" class="i field">PathSearchTrimEnd</a>);
                            <a href="#843f369798ada210" class="i field">_pathSearcher</a> =
                                <b>new</b> <span class="t">CommandPathSearch</span>(
                                    <span class="r97 r">fileName</span>,
                                    <span class="r96 r">directoryCollection</span>,
                                    <a href="#fa55f319f99a9591" class="i field">_context</a>,
                                    <a href="#6c20aff3f0de9ce1" class="i method">ConstructSearchPatternsFromName</a>(<span class="r97 r">fileName</span>, <span class="r84 r">commandDiscovery</span>: <b>true</b>),
                                    <span class="i">useFuzzyMatch</span>: <b>false</b>);
                        }
                        <b>else</b>
                        {
                            <a href="#0b9f7e42aa07f54c" class="i field">_canDoPathLookup</a> = <b>false</b>;
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the enumerator to before the first command match, public for IEnumerable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="e8de1406c187bd1f" href="../R/e8de1406c187bd1f.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <span class="c">// If this is a command coming from outside the runspace and there are no</span>
            <span class="c">// permitted scripts or applications,</span>
            <span class="c">// remove them from the set of things to search for...</span>
            <b>if</b> (<a href="#2764b4a0d4bff1a0" class="i field">_commandOrigin</a> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a>)
            {
                <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>.<span class="i">Count</span> == 0)
                    <a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp;= ~<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>;
                <b>if</b> (<a href="#fa55f319f99a9591" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>.<span class="i">Count</span> == 0)
                    <a href="#b19925be90abf798" class="i field">_commandTypes</a> &amp;= ~<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
            }
 
            <a href="#843f369798ada210" class="i field">_pathSearcher</a>?.<a href="CommandPathSearch.cs.html#7d3e6fa18be68d7f" class="i method">Reset</a>();
 
            <a href="#a9fb781b3aa781d3" class="i field">_currentMatch</a> = <b>null</b>;
            <a href="#6e93de4afd2d87e5" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#256c294253c58527" class="i field">SearchingAliases</a>;
            <a href="#41030f585420e53a" class="i field">_matchingAlias</a> = <b>null</b>;
            <a href="#982452b606b70c8a" class="i field">_matchingCmdlet</a> = <b>null</b>;
        }
 
        <b>internal</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="34d5e34f877c31b7" href="../R/34d5e34f877c31b7.html" target="n" data-glyph="104,1" class="i property">CommandOrigin</a>
        {
            <b>get</b> { <b>return</b> <a href="#2764b4a0d4bff1a0" class="i field">_commandOrigin</a>; }
 
            <b>set</b> { <a href="#2764b4a0d4bff1a0" class="i field">_commandOrigin</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="2764b4a0d4bff1a0" href="../R/2764b4a0d4bff1a0.html" target="n" data-glyph="46,1" class="i field">_commandOrigin</a> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An enumerator of the matching aliases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerator</span>&lt;<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt;? <a id="41030f585420e53a" href="../R/41030f585420e53a.html" target="n" data-glyph="46,1" class="i field">_matchingAlias</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An enumerator of the matching functions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerator</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>?&gt;? <a id="ad78d3f28b0e4c3a" href="../R/ad78d3f28b0e4c3a.html" target="n" data-glyph="46,1" class="i field">_matchingFunctionEnumerator</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CommandInfo that references the command that matches the pattern.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>? <a id="a9fb781b3aa781d3" href="../R/a9fb781b3aa781d3.html" target="n" data-glyph="46,1" class="i field">_currentMatch</a>;
 
        <b>private bool</b> <a id="0b9f7e42aa07f54c" href="../R/0b9f7e42aa07f54c.html" target="n" data-glyph="46,1" class="i field">_canDoPathLookup</a>;
        <b>private</b> <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a> <a id="c453de751eaeb8ae" href="../R/c453de751eaeb8ae.html" target="n" data-glyph="46,1" class="i field">_canDoPathLookupResult</a> = <a href="#259d62cd16005771" class="t t">CanDoPathLookupResult</a>.<a href="#60b0e13066309088" class="i field">Yes</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current state of the enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#8ae8685691870021" class="t t">SearchState</a> <a id="6e93de4afd2d87e5" href="../R/6e93de4afd2d87e5.html" target="n" data-glyph="46,1" class="i field">_currentState</a> = <a href="#8ae8685691870021" class="t t">SearchState</a>.<a href="#256c294253c58527" class="i field">SearchingAliases</a>;
 
        <b>private enum</b> <a id="8ae8685691870021" href="../R/8ae8685691870021.html" target="n" data-glyph="22,1" class="t t"><span id="2f1d424f57f37626">SearchState</span></a>
        {
            <span class="c">// the searcher has been reset or has not been advanced since being created.</span>
            <a id="256c294253c58527" href="../R/256c294253c58527.html" target="n" data-glyph="24,2" class="i field">SearchingAliases</a>,
 
            <span class="c">// the searcher has finished alias resolution and is now searching for functions.</span>
            <a id="a697950d8cf83259" href="../R/a697950d8cf83259.html" target="n" data-glyph="24,2" class="i field">SearchingFunctions</a>,
 
            <span class="c">// the searcher has finished function resolution and is now searching for cmdlets</span>
            <a id="a0db50dc86e73417" href="../R/a0db50dc86e73417.html" target="n" data-glyph="24,2" class="i field">SearchingCmdlets</a>,
 
            <span class="c">// the search has finished builtin script resolution and is now searching for external commands</span>
            <a id="ae0e679e6f86b890" href="../R/ae0e679e6f86b890.html" target="n" data-glyph="24,2" class="i field">StartSearchingForExternalCommands</a>,
 
            <span class="c">// the searcher has moved to</span>
            <a id="ce46122151b5109c" href="../R/ce46122151b5109c.html" target="n" data-glyph="24,2" class="i field">PowerShellPathResolution</a>,
 
            <span class="c">// the searcher has moved to a qualified file system path</span>
            <a id="b09a8c954961b677" href="../R/b09a8c954961b677.html" target="n" data-glyph="24,2" class="i field">QualifiedFileSystemPath</a>,
 
            <span class="c">// the searcher has moved to using a CommandPathSearch object</span>
            <span class="c">// for resolution</span>
            <a id="9bf0f3cd3e2e1f11" href="../R/9bf0f3cd3e2e1f11.html" target="n" data-glyph="24,2" class="i field">PathSearch</a>,
 
            <span class="c">// the searcher has moved to using a CommandPathSearch object</span>
            <span class="c">// with get prepended to the command name for resolution</span>
            <a id="4f9d4623bf4fd1e6" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">GetPathSearch</a>,
 
            <span class="c">// the searcher has moved to resolving the command as a</span>
            <span class="c">// relative PowerShell path</span>
            <a id="8b7de5b0369352b3" href="../R/8b7de5b0369352b3.html" target="n" data-glyph="24,2" class="i field">PowerShellRelativePath</a>,
 
            <span class="c">// No more matches can be found</span>
            <a id="bc1dd3519211da22" href="../R/bc1dd3519211da22.html" target="n" data-glyph="24,2" class="i field">NoMoreMatches</a>,
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Determines which types of commands should be globbed using the specified</span>
    <span class="c">///</span><span class="c"> pattern. Any flag that is not specified will only match if exact.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="a5748603008affdc" href="../R/a5748603008affdc.html" target="n" data-glyph="20,0" class="t t"><span id="fda3aa8c63c384b1">SearchResolutionOptions</span></a>
    {
        <a id="4a3a990ab3669ccf" href="../R/4a3a990ab3669ccf.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x0,
        <a id="ad2602de61710376" href="../R/ad2602de61710376.html" target="n" data-glyph="24,1" class="i field">ResolveAliasPatterns</a> = 0x01,
        <a id="315f95f2041e0da1" href="../R/315f95f2041e0da1.html" target="n" data-glyph="24,1" class="i field">ResolveFunctionPatterns</a> = 0x02,
        <a id="038d9150e27f9fdf" href="../R/038d9150e27f9fdf.html" target="n" data-glyph="24,1" class="i field">CommandNameIsPattern</a> = 0x04,
        <a id="dcf3e09a7e1c6cc7" href="../R/dcf3e09a7e1c6cc7.html" target="n" data-glyph="24,1" class="i field">SearchAllScopes</a> = 0x08,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Use fuzzy matching.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="70f2a6b1e2a16492" href="../R/70f2a6b1e2a16492.html" target="n" data-glyph="24,1" class="i field">FuzzyMatch</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable searching for cmdlets/functions by abbreviation expansion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e5d14e217b7a7a75" href="../R/e5d14e217b7a7a75.html" target="n" data-glyph="24,1" class="i field">UseAbbreviationExpansion</a> = 0x20,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable resolving wildcard in paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9c3d13905ec4008c" href="../R/9c3d13905ec4008c.html" target="n" data-glyph="24,1" class="i field">ResolveLiteralThenPathPatterns</a> = 0x40
    }
}
</pre></td></tr></table></div></body></html>
