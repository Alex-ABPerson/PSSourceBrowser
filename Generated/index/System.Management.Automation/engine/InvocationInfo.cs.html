<!DOCTYPE html>
<html><head><title>InvocationInfo.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(526);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/InvocationInfo.cs" target="_top">engine\InvocationInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Describes how and where this command was invoked.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;Command = {MyCommand}&quot;</span>)]
    <b>public class</b> <a id="407d6c7d1ecbc8cc" href="../R/407d6c7d1ecbc8cc.html" target="n" data-glyph="0,0" class="t t">InvocationInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for InvocationInfo object when the associated command object is present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="3acc68517601c6e3" href="../R/3acc68517601c6e3.html" target="n" data-glyph="74,1" class="t constructor">InvocationInfo</a>(<a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <span id="r0 rd" class="r0 r">command</span>)
            : <a href="#73425a3cbc3397ab" class="k">this</a>(<span class="r0 r">command</span>.<a href="CommandBase.cs.html#1f4a1f38862b466a" class="i property">CommandInfo</a>,
                   <span class="r0 r">command</span>.<a href="CommandBase.cs.html#848be65db101584d" class="i property">InvocationExtent</a> ?? <a href="parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="parser/Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>)
        {
            <a href="#02c0f35838462a5e" class="i property">CommandOrigin</a> = <span class="r0 r">command</span>.<a href="CommandBase.cs.html#6cef80897300e0a9" class="i property">CommandOrigin</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for InvocationInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command information the invocation info represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">scriptPosition</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position representing the invocation, or the position representing the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="73425a3cbc3397ab" href="../R/73425a3cbc3397ab.html" target="n" data-glyph="74,1" class="t constructor">InvocationInfo</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r1 rd" class="r1 r">commandInfo</span>, <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r2 rd" class="r2 r">scriptPosition</span>)
            : <a href="#05f8dff4c341ddae" class="k">this</a>(<span class="r1 r">commandInfo</span>, <span class="r2 r">scriptPosition</span>, <b>null</b>)
        {
            <span class="c">// nothing to do here</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for InvocationInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command information the invocation info represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">scriptPosition</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position representing the invocation, or the position representing the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context in which the InvocationInfo is being created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="05f8dff4c341ddae" href="../R/05f8dff4c341ddae.html" target="n" data-glyph="74,1" class="t constructor">InvocationInfo</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r3 rd" class="r3 r">commandInfo</span>, <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r4 rd" class="r4 r">scriptPosition</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r5 rd" class="r5 r">context</span>)
        {
            <a href="#8edab65bf1913897" class="i property">MyCommand</a> = <span class="r3 r">commandInfo</span>;
            <a href="#02c0f35838462a5e" class="i property">CommandOrigin</a> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
            <a href="#19225bffdada419b" class="i field">_scriptPosition</a> = <span class="r4 r">scriptPosition</span>;
 
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r6 rd" class="r6 r">contextToUse</span> = <b>null</b>;
            <b>if</b> ((<span class="r3 r">commandInfo</span> != <b>null</b>) &amp;&amp; (<span class="r3 r">commandInfo</span>.<a href="CommandInfo.cs.html#a17100165b2aaab8" class="i property">Context</a> != <b>null</b>))
            {
                <span class="r6 r">contextToUse</span> = <span class="r3 r">commandInfo</span>.<a href="CommandInfo.cs.html#a17100165b2aaab8" class="i property">Context</a>;
            }
            <b>else</b> <b>if</b> (<span class="r5 r">context</span> != <b>null</b>)
            {
                <span class="r6 r">contextToUse</span> = <span class="r5 r">context</span>;
            }
 
            <span class="c">// Populate the history ID of this command</span>
            <b>if</b> (<span class="r6 r">contextToUse</span> != <b>null</b>)
            {
                <span class="i n">Runspaces</span>.<a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r7 rd" class="r7 r">localRunspace</span> = <span class="r6 r">contextToUse</span>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a> <b>as</b> <span class="i n">Runspaces</span>.<a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>;
                <b>if</b> (<span class="r7 r">localRunspace</span> != <b>null</b> &amp;&amp; <span class="r7 r">localRunspace</span>.<a href="hostifaces/LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a> != <b>null</b>)
                {
                    <a href="#6118e67ee157a06b" class="i property">HistoryId</a> = <span class="r7 r">localRunspace</span>.<a href="hostifaces/LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a>.<a href="hostifaces/History.cs.html#29135ba8df22e381" class="i method">GetNextHistoryId</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an InformationalRecord from an instance serialized as a PSObject by ToPSObjectForRemoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="4817611dedebd2b0" href="../R/4817611dedebd2b0.html" target="n" data-glyph="74,1" class="t constructor">InvocationInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r8 rd" class="r8 r">psObject</span>)
        {
            <a href="#02c0f35838462a5e" class="i property">CommandOrigin</a> = (<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#8e7e8d551c24aa2e" class="i method">GetPsObjectPropertyBaseObject</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_CommandOrigin&quot;</span>);
            <a href="#9a1646f37a942067" class="i property">ExpectingInput</a> = (<b>bool</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_ExpectingInput&quot;</span>);
            <a href="#273e906097823dd8" class="i field">_invocationName</a> = (<b>string</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_InvocationName&quot;</span>);
            <a href="#6118e67ee157a06b" class="i property">HistoryId</a> = (<b>long</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_HistoryId&quot;</span>);
            <a href="#7d73dcbb6106b235" class="i property">PipelineLength</a> = (<b>int</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelineLength&quot;</span>);
            <a href="#b9401843293d51d4" class="i property">PipelinePosition</a> = (<b>int</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelinePosition&quot;</span>);
 
            <b>string</b> <span id="r9 rd" class="r9 r">scriptName</span> = (<b>string</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_ScriptName&quot;</span>);
            <b>int</b> <span id="r10 rd" class="r10 r">scriptLineNumber</span> = (<b>int</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_ScriptLineNumber&quot;</span>);
            <b>int</b> <span id="r11 rd" class="r11 r">offsetInLine</span> = (<b>int</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_OffsetInLine&quot;</span>);
            <b>string</b> <span id="r12 rd" class="r12 r">line</span> = (<b>string</b>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_Line&quot;</span>);
            <a href="parser/Position.cs.html#391058fa374c4cba" class="k">var</a> <span id="r13 rd" class="r13 r">scriptPosition</span> = <b>new</b> <a href="parser/Position.cs.html#40eb7f8097372724" class="t constructor">ScriptPosition</a>(<span class="r9 r">scriptName</span>, <span class="r10 r">scriptLineNumber</span>, <span class="r11 r">offsetInLine</span>, <span class="r12 r">line</span>);
 
            <a href="parser/Position.cs.html#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r14 rd" class="r14 r">scriptEndPosition</span>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r12 r">line</span>))
            {
                <b>int</b> <span id="r15 rd" class="r15 r">endColumn</span> = <span class="r12 r">line</span>.<span class="i">Length</span> + 1;
                <span class="r14 r">scriptEndPosition</span> = <b>new</b> <a href="parser/Position.cs.html#40eb7f8097372724" class="t constructor">ScriptPosition</a>(<span class="r9 r">scriptName</span>, <span class="r10 r">scriptLineNumber</span>, <span class="r15 r">endColumn</span>, <span class="r12 r">line</span>);
            }
            <b>else</b>
            {
                <span class="r14 r">scriptEndPosition</span> = <span class="r13 r">scriptPosition</span>;
            }
 
            <a href="#19225bffdada419b" class="i field">_scriptPosition</a> = <b>new</b> <a href="parser/Position.cs.html#da6958ef7491b809" class="t constructor">ScriptExtent</a>(<span class="r13 r">scriptPosition</span>, <span class="r14 r">scriptEndPosition</span>);
 
            <a href="#8edab65bf1913897" class="i property">MyCommand</a> = <a href="#9d899371dac620ed" class="t t">RemoteCommandInfo</a>.<a href="#da9ea89539048f2a" class="i method">FromPSObjectForRemoting</a>(<span class="r8 r">psObject</span>);
 
            <span class="c">//</span>
            <span class="c">// Arrays are de-serialized as ArrayList so we need to convert the deserialized</span>
            <span class="c">// object into an int[] before assigning to pipelineIterationInfo.</span>
            <span class="c">//</span>
            <b>var</b> <span id="r16 rd" class="r16 r">list</span> = (<span class="i">ArrayList</span>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#8e7e8d551c24aa2e" class="i method">GetPsObjectPropertyBaseObject</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelineIterationInfo&quot;</span>);
            <b>if</b> (<span class="r16 r">list</span> != <b>null</b>)
            {
                <a href="#0696af7afce6ee9b" class="i property">PipelineIterationInfo</a> = (<b>int</b>[])<span class="r16 r">list</span>.<span class="i">ToArray</span>(<b>typeof</b>(<b>int</b>));
            }
            <b>else</b>
            {
                <a href="#0696af7afce6ee9b" class="i property">PipelineIterationInfo</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>int</b>&gt;();
            }
 
            <span class="c">//</span>
            <span class="c">// Dictionaries are de-serialized as Hashtables so we need to convert the deserialized object into a dictionary</span>
            <span class="c">// before assigning to CommandLineParameters.</span>
            <span class="c">//</span>
            <span class="i">Hashtable</span> <span id="r17 rd" class="r17 r">hashtable</span> = (<span class="i">Hashtable</span>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#8e7e8d551c24aa2e" class="i method">GetPsObjectPropertyBaseObject</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_BoundParameters&quot;</span>);
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r18 rd" class="r18 r">dictionary</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
 
            <b>if</b> (<span class="r17 r">hashtable</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r19 rd" class="r19 r">entry</span> <b>in</b> <span class="r17 r">hashtable</span>)
                {
                    <span class="r18 r">dictionary</span>.<span class="i">Add</span>((<b>string</b>)<span class="r19 r">entry</span>.<span class="i">Key</span>, <span class="r19 r">entry</span>.<span class="i">Value</span>);
                }
            }
 
            <a href="#48e7bbf1912a84fa" class="i field">_boundParameters</a> = <span class="r18 r">dictionary</span>;
 
            <span class="c">//</span>
            <span class="c">// The unbound parameters are de-serialized as an ArrayList, which we need to convert to a List</span>
            <span class="c">//</span>
            <b>var</b> <span id="r20 rd" class="r20 r">unboundArguments</span> = (<span class="i">ArrayList</span>)<a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#8e7e8d551c24aa2e" class="i method">GetPsObjectPropertyBaseObject</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;InvocationInfo_UnboundArguments&quot;</span>);
 
            <a href="#2f138af166b20486" class="i field">_unboundArguments</a> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <b>if</b> (<span class="r20 r">unboundArguments</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r21 rd" class="r21 r">o</span> <b>in</b> <span class="r20 r">unboundArguments</span>)
                {
                    <a href="#2f138af166b20486" class="i field">_unboundArguments</a>.<span class="i">Add</span>(<span class="r21 r">o</span>);
                }
            }
 
            <b>object</b> <span id="r22 rd" class="r22 r">value</span> = <a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r8 r">psObject</span>, <span class="s">&quot;SerializeExtent&quot;</span>);
            <b>bool</b> <span id="r23 rd" class="r23 r">serializeExtent</span> = <b>false</b>;
 
            <b>if</b> (<span class="r22 r">value</span> != <b>null</b>)
                <span class="r23 r">serializeExtent</span> = (<b>bool</b>)<span class="r22 r">value</span>;
 
            <b>if</b> (<span class="r23 r">serializeExtent</span>)
                <a href="#da1298533340b29e" class="i property">DisplayScriptPosition</a> = <a href="parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a>.<a href="parser/Position.cs.html#075c6281733095ac" class="i method">FromPSObjectForRemoting</a>(<span class="r8 r">psObject</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="19225bffdada419b" href="../R/19225bffdada419b.html" target="n" data-glyph="46,1" class="i field">_scriptPosition</a>;
        <b>private string</b> <a id="273e906097823dd8" href="../R/273e906097823dd8.html" target="n" data-glyph="46,1" class="i field">_invocationName</a>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <a id="48e7bbf1912a84fa" href="../R/48e7bbf1912a84fa.html" target="n" data-glyph="46,1" class="i field">_boundParameters</a>;
        <b>private</b> <span class="i">List</span>&lt;<b>object</b>&gt; <a id="2f138af166b20486" href="../R/2f138af166b20486.html" target="n" data-glyph="46,1" class="i field">_unboundArguments</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal or Private
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provide basic information about the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">may be null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <a id="8edab65bf1913897" href="../R/8edab65bf1913897.html" target="n" data-glyph="102,1" class="i property">MyCommand</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This member provides a dictionary of the parameters that were bound for this</span>
        <span class="c">///</span><span class="c"> script or command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <a id="1927782a0117ff76" href="../R/1927782a0117ff76.html" target="n" data-glyph="102,1" class="i property">BoundParameters</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#48e7bbf1912a84fa" class="i field">_boundParameters</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
 
            <b>internal set</b>
            {
                <a href="#48e7bbf1912a84fa" class="i field">_boundParameters</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This member provides a list of the arguments that were not bound to any parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>object</b>&gt; <a id="6bbbff769b24d3a5" href="../R/6bbbff769b24d3a5.html" target="n" data-glyph="102,1" class="i property">UnboundArguments</a>
        {
            <b>get</b> { <b>return</b> <a href="#2f138af166b20486" class="i field">_unboundArguments</a> ??= <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;(); }
 
            <b>internal set</b> { <a href="#2f138af166b20486" class="i field">_unboundArguments</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number in the executing script that contained this cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The script line number or -1 if not executing in a script.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="6d9f0c2743c6397f" href="../R/6d9f0c2743c6397f.html" target="n" data-glyph="102,1" class="i property">ScriptLineNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command&#39;s character offset in that line. If the command was</span>
        <span class="c">///</span><span class="c"> executed directly through the host interfaces, this will be -1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The line offset or -1 if not executed from a text line.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="4f9dbd8a4a5fe79c" href="../R/4f9dbd8a4a5fe79c.html" target="n" data-glyph="102,1" class="i property">OffsetInLine</a>
        {
            <b>get</b> { <b>return</b> <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> History ID that represents the command. If unavailable, this will be -1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The history ID or -1 if not available.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="6118e67ee157a06b" href="../R/6118e67ee157a06b.html" target="n" data-glyph="102,1" class="i property">HistoryId</a> { <b>get</b>; <b>internal set</b>; } = -1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the script containing the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The script name or &quot;&quot; if there was no script.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ffa710af0f908256" href="../R/ffa710af0f908256.html" target="n" data-glyph="102,1" class="i property">ScriptName</a>
        {
            <b>get</b> { <b>return</b> <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#e933edecd2b0cc1d" class="i property">File</a> ?? <b>string</b>.<span class="i">Empty</span>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The text of the line that contained this cmdlet invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Line that was entered to invoke this command</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d8a2387de19e4425" href="../R/d8a2387de19e4425.html" target="n" data-glyph="102,1" class="i property">Line</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>;
                }
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Formatted message indicating where the cmdlet appeared</span>
        <span class="c">///</span><span class="c"> in the line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Formatted string indicating the command&#39;s position in the line</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c6e9275e22dd1db0" href="../R/c6e9275e22dd1db0.html" target="n" data-glyph="102,1" class="i property">PositionMessage</a>
        {
            <b>get</b> { <b>return</b> <a href="parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="parser/Position.cs.html#a5bde72c0431231a" class="i method">VerboseMessage</a>(<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property tells you the directory from where you were being invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="41cd5a3f641a6037" href="../R/41cd5a3f641a6037.html" target="n" data-glyph="102,1" class="i property">PSScriptRoot</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>))
                {
                    <b>return</b> <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property tells you the full path to the command from where you were being invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f655312f60d6e9b8" href="../R/f655312f60d6e9b8.html" target="n" data-glyph="102,1" class="i property">PSCommandPath</a>
        {
            <b>get</b> { <b>return</b> <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command name used to invoke this string - if invoked through an alias, then</span>
        <span class="c">///</span><span class="c"> this would be the alias name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The name string.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="57f452abf157b50b" href="../R/57f452abf157b50b.html" target="n" data-glyph="102,1" class="i property">InvocationName</a>
        {
            <b>get</b> { <b>return</b> <a href="#273e906097823dd8" class="i field">_invocationName</a> ?? <b>string</b>.<span class="i">Empty</span>; }
 
            <b>internal set</b> { <a href="#273e906097823dd8" class="i field">_invocationName</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> How many elements are in the containing pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">number of elements in the containing pipeline</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="7d73dcbb6106b235" href="../R/7d73dcbb6106b235.html" target="n" data-glyph="102,1" class="i property">PipelineLength</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Which element this command was in the containing pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">which element this command was in the containing pipeline</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="b9401843293d51d4" href="../R/b9401843293d51d4.html" target="n" data-glyph="102,1" class="i property">PipelinePosition</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is true if this command is expecting input...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="9a1646f37a942067" href="../R/9a1646f37a942067.html" target="n" data-glyph="102,1" class="i property">ExpectingInput</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property tells you if you were being invoked inside the runspace or</span>
        <span class="c">///</span><span class="c"> if it was an external request.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="02c0f35838462a5e" href="../R/02c0f35838462a5e.html" target="n" data-glyph="102,1" class="i property">CommandOrigin</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position for the invocation or error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="da1298533340b29e" href="../R/da1298533340b29e.html" target="n" data-glyph="102,1" class="i property">DisplayScriptPosition</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">scriptPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="cdfa6414e01bad12" href="../R/cdfa6414e01bad12.html" target="n" data-glyph="72,1" class="i method">Create</a>(
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r24 rd" class="r24 r">commandInfo</span>,
            <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r25 rd" class="r25 r">scriptPosition</span>)
        {
            <a href="#407d6c7d1ecbc8cc" class="k">var</a> <span id="r26 rd" class="r26 r">invocationInfo</span> = <b>new</b> <a href="#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<span class="r24 r">commandInfo</span>, <span class="r25 r">scriptPosition</span>);
            <span class="r26 r">invocationInfo</span>.<a href="#da1298533340b29e" class="i property">DisplayScriptPosition</a> = <span class="r25 r">scriptPosition</span>;
 
            <b>return</b> <span class="r26 r">invocationInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position for the invocation or error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="36c1c0cc46ab70ad" href="../R/36c1c0cc46ab70ad.html" target="n" data-glyph="104,1" class="i property">ScriptPosition</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#da1298533340b29e" class="i property">DisplayScriptPosition</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#da1298533340b29e" class="i property">DisplayScriptPosition</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <a href="#19225bffdada419b" class="i field">_scriptPosition</a>;
                }
            }
 
            <b>set</b>
            {
                <a href="#19225bffdada419b" class="i field">_scriptPosition</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the full text of the script for this invocation info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="f773f8a07f843643" href="../R/f773f8a07f843643.html" target="n" data-glyph="74,1" class="i method">GetFullScript</a>()
        {
            <b>return</b> (<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a> != <b>null</b>) &amp;&amp; (<a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a> != <b>null</b>) ?
                <a href="#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="parser/Position.cs.html#b2c2e7d614605592" class="i method">GetFullScript</a>() : <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Index of the ProcessRecord iteration for each of the commands in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All the commands in a given pipeline share the same PipelinePositionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal int</b>[] <a id="0696af7afce6ee9b" href="../R/0696af7afce6ee9b.html" target="n" data-glyph="104,1" class="i property">PipelineIterationInfo</a> { <b>get</b>; <b>set</b>; } = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>int</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the information about this informational record to a PSObject as note properties.</span>
        <span class="c">///</span><span class="c"> The PSObject is used to serialize the record during remote operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InvocationInfos are usually serialized as part of another object, so we add &quot;InvocationInfo_&quot; to</span>
        <span class="c">///</span><span class="c"> the note properties to prevent collisions with any properties set by the containing object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="a046fd5ea44698d2" href="../R/a046fd5ea44698d2.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r27 rd" class="r27 r">psObject</span>)
        {
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>object</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_BoundParameters&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#1927782a0117ff76" class="i property">BoundParameters</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_CommandOrigin&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#02c0f35838462a5e" class="i property">CommandOrigin</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>bool</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_ExpectingInput&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#9a1646f37a942067" class="i property">ExpectingInput</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_InvocationName&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#57f452abf157b50b" class="i property">InvocationName</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_Line&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#d8a2387de19e4425" class="i property">Line</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>int</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_OffsetInLine&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#4f9dbd8a4a5fe79c" class="i property">OffsetInLine</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>long</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_HistoryId&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#6118e67ee157a06b" class="i property">HistoryId</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>int</b>[]&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelineIterationInfo&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#0696af7afce6ee9b" class="i property">PipelineIterationInfo</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>int</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelineLength&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#7d73dcbb6106b235" class="i property">PipelineLength</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>int</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PipelinePosition&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#b9401843293d51d4" class="i property">PipelinePosition</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PSScriptRoot&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#41cd5a3f641a6037" class="i property">PSScriptRoot</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PSCommandPath&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#f655312f60d6e9b8" class="i property">PSCommandPath</a>);
            <span class="c">// PositionMessage is ignored when deserializing because it is synthesized from the other position related fields, but</span>
            <span class="c">// it is serialized for backwards compatibility.</span>
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_PositionMessage&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#c6e9275e22dd1db0" class="i property">PositionMessage</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>int</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_ScriptLineNumber&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#6d9f0c2743c6397f" class="i property">ScriptLineNumber</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_ScriptName&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#ffa710af0f908256" class="i property">ScriptName</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>object</b>&gt;(<span class="r27 r">psObject</span>, <span class="s">&quot;InvocationInfo_UnboundArguments&quot;</span>, () =&gt; <a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#6bbbff769b24d3a5" class="i property">UnboundArguments</a>);
 
            <a href="parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a> <span id="r28 rd" class="r28 r">extent</span> = <a href="#da1298533340b29e" class="i property">DisplayScriptPosition</a> <b>as</b> <a href="parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a>;
            <b>if</b> (<span class="r28 r">extent</span> != <b>null</b>)
            {
                <span class="r28 r">extent</span>.<a href="parser/Position.cs.html#2f4502bd5d538e02" class="i method">ToPSObjectForRemoting</a>(<span class="r27 r">psObject</span>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>(<span class="r27 r">psObject</span>, <span class="s">&quot;SerializeExtent&quot;</span>, <b>static</b> () =&gt; <b>true</b>);
            }
            <b>else</b>
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>(<span class="r27 r">psObject</span>, <span class="s">&quot;SerializeExtent&quot;</span>, <b>static</b> () =&gt; <b>false</b>);
            }
 
            <a href="#9d899371dac620ed" class="t t">RemoteCommandInfo</a>.<a href="#2b69c124e62accfa" class="i method">ToPSObjectForRemoting</a>(<a href="#407d6c7d1ecbc8cc" class="k">this</a>.<a href="#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r27 r">psObject</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A CommandInfo that has been serialized/deserialized as part of an InvocationInfo during a remote invocation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="9d899371dac620ed" href="../R/9d899371dac620ed.html" target="n" data-glyph="0,0" class="t t">RemoteCommandInfo</a> : <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a id="e648109574694902" href="../R/e648109574694902.html" target="n" data-glyph="76,1" class="t constructor">RemoteCommandInfo</a>(<b>string</b> <span id="r29 rd" class="r29 r">name</span>, <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r30 rd" class="r30 r">type</span>)
            : <a href="CommandInfo.cs.html#cf9c3d8288d6464f" class="k">base</a>(<span class="r29 r">name</span>, <span class="r30 r">type</span>)
        {
            <span class="c">// nothing to do here</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the definition of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="53327d23d4036a5c" href="../R/53327d23d4036a5c.html" target="n" data-glyph="102,1" class="i property">Definition</a> { <b>get</b> { <b>return</b> <a href="#64c31efdd2c207d2" class="i field">_definition</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RemoteCommandInfo from an instance serialized as a PSObject by ToPSObjectForRemoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#9d899371dac620ed" class="t t">RemoteCommandInfo</a> <a id="da9ea89539048f2a" href="../R/da9ea89539048f2a.html" target="n" data-glyph="74,1" class="i method">FromPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r31 rd" class="r31 r">psObject</span>)
        {
            <a href="#9d899371dac620ed" class="t t">RemoteCommandInfo</a> <span id="r32 rd" class="r32 r">commandInfo</span> = <b>null</b>;
 
            <b>object</b> <span id="r33 rd" class="r33 r">ctype</span> = <a href="serialization.cs.html#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="serialization.cs.html#8e7e8d551c24aa2e" class="i method">GetPsObjectPropertyBaseObject</a>(<span class="r31 r">psObject</span>, <span class="s">&quot;CommandInfo_CommandType&quot;</span>);
 
            <b>if</b> (<span class="r33 r">ctype</span> != <b>null</b>)
            {
                <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r34 rd" class="r34 r">type</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>&gt;(<span class="r31 r">psObject</span>, <span class="s">&quot;CommandInfo_CommandType&quot;</span>);
                <b>string</b> <span id="r35 rd" class="r35 r">name</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r31 r">psObject</span>, <span class="s">&quot;CommandInfo_Name&quot;</span>);
 
                <span class="r32 r">commandInfo</span> = <b>new</b> <a href="#e648109574694902" class="t constructor">RemoteCommandInfo</a>(<span class="r35 r">name</span>, <span class="r34 r">type</span>);
                <span class="r32 r">commandInfo</span>.<a href="#64c31efdd2c207d2" class="i field">_definition</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r31 r">psObject</span>, <span class="s">&quot;CommandInfo_Definition&quot;</span>);
                <span class="r32 r">commandInfo</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>&gt;(<span class="r31 r">psObject</span>, <span class="s">&quot;CommandInfo_Visibility&quot;</span>);
            }
 
            <b>return</b> <span class="r32 r">commandInfo</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the information about this instance to a PSObject as note properties.</span>
        <span class="c">///</span><span class="c"> The PSObject is used to serialize the CommandInfo during remote operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CommandInfos are usually serialized as part of InvocationInfos, so we add &quot;CommandInfo_&quot; to</span>
        <span class="c">///</span><span class="c"> the note properties to prevent collisions with any properties set by the containing object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="2b69c124e62accfa" href="../R/2b69c124e62accfa.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r36 rd" class="r36 r">commandInfo</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r37 rd" class="r37 r">psObject</span>)
        {
            <b>if</b> (<span class="r36 r">commandInfo</span> != <b>null</b>)
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>&gt;(<span class="r37 r">psObject</span>, <span class="s">&quot;CommandInfo_CommandType&quot;</span>, () =&gt; <span class="r36 r">commandInfo</span>.<a href="CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r37 r">psObject</span>, <span class="s">&quot;CommandInfo_Definition&quot;</span>, () =&gt; <span class="r36 r">commandInfo</span>.<a href="CommandInfo.cs.html#a887e8cd226475a7" class="i property">Definition</a>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r37 r">psObject</span>, <span class="s">&quot;CommandInfo_Name&quot;</span>, () =&gt; <span class="r36 r">commandInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>&gt;(<span class="r37 r">psObject</span>, <span class="s">&quot;CommandInfo_Visibility&quot;</span>, () =&gt; <span class="r36 r">commandInfo</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> NYI.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <a id="22e68bac96c4203b" href="../R/22e68bac96c4203b.html" target="n" data-glyph="102,1" class="i property">OutputType</a>
        {
            <b>get</b> { <b>return</b> <b>null</b>; }
        }
 
        <b>private string</b> <a id="64c31efdd2c207d2" href="../R/64c31efdd2c207d2.html" target="n" data-glyph="46,1" class="i field">_definition</a>;
    }
}
</pre></td></tr></table></div></body></html>
