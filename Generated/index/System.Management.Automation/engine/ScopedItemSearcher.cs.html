<!DOCTYPE html>
<html><head><title>ScopedItemSearcher.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(488);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ScopedItemSearcher.cs" target="_top">engine\ScopedItemSearcher.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enumerates the items matching a particular name in the scopes specified using</span>
    <span class="c">///</span><span class="c"> the appropriate scoping lookup rules.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The type of items that the derived class returns.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="7ceec02d35f81562" href="../R/7ceec02d35f81562.html" target="n" data-glyph="2,0" class="t t">ScopedItemSearcher</a>&lt;<span id="r0 rd t" class="r0 r t">T</span>&gt; : <span class="i">IEnumerator</span>&lt;<span class="r0 r t">T</span>&gt;, <span class="i">IEnumerable</span>&lt;<span class="r0 r t">T</span>&gt;
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a scoped item searcher.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The state of the engine instance to enumerate through the scopes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">lookupPath</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parsed name of the item to lookup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">lookupPath</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="eac5b84dc164ec66" href="../R/eac5b84dc164ec66.html" target="n" data-glyph="74,1" class="t constructor">ScopedItemSearcher</a>(
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r1 rd" class="r1 r">sessionState</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r2 rd" class="r2 r">lookupPath</span>)
        {
            <b>if</b> (<span class="r1 r">sessionState</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">sessionState</span>));
            }
 
            <b>if</b> (<span class="r2 r">lookupPath</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">lookupPath</span>));
            }
 
            <a href="#7ceec02d35f81562" class="k">this</a>.<a href="#0a366716cb7e8bec" class="i field">sessionState</a> = <span class="r1 r">sessionState</span>;
            <a href="#11cb11387be05943" class="i field">_lookupPath</a> = <span class="r2 r">lookupPath</span>;
            <a href="#2ca87eb58cdf4d55" class="i method">InitializeScopeEnumerator</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable/IEnumerator members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the current object as an IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current object as an IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>.<span class="i">IEnumerator</span>&lt;<span class="r0 r t">T</span>&gt; <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>.<span class="i">IEnumerable</span>&lt;<span class="r0 r t">T</span>&gt;.<a id="9da8447ac4db3b67" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#7ceec02d35f81562" class="k">this</a>;
        }
 
        <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerator</span> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerable</span>.<a id="c7dc8544599f99d2" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#7ceec02d35f81562" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Moves the enumerator to the next matching scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if another matching scoped item was found, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="0f8fb6322922ec52" href="../R/0f8fb6322922ec52.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <b>bool</b> <span id="r3 rd" class="r3 r">result</span> = <b>true</b>;
 
            <b>if</b> (!<a href="#546575dfa986c738" class="i field">_isInitialized</a>)
            {
                <a href="#2ca87eb58cdf4d55" class="i method">InitializeScopeEnumerator</a>();
            }
 
            <span class="c">// Enumerate the scopes until a matching scoped item is found</span>
 
            <b>while</b> (<a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a>.<a href="SessionStateScopeEnumerator.cs.html#354583ae32ed9470" class="i method">MoveNext</a>())
            {
                <span class="r0 r t">T</span> <span id="r4 rd" class="r4 r">newCurrentItem</span>;
 
                <b>if</b> (<span class="i">TryGetNewScopeItem</span>(((<span class="i">IEnumerator</span>&lt;<a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a>&gt;)<a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a>).<span class="i">Current</span>, <b>out</b> <span class="r4 r">newCurrentItem</span>))
                {
                    <a href="#523d6775eb01fe1d" class="i field">_currentScope</a> = ((<span class="i">IEnumerator</span>&lt;<a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a>&gt;)<a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a>).<span class="i">Current</span>;
                    <a href="#17bd3fc2d6c5f57e" class="i field">_current</a> = <span class="r4 r">newCurrentItem</span>;
                    <span class="r3 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <span class="r3 r">result</span> = <b>false</b>;
 
                <b>if</b> (<a href="#fc37f68bca18997c" class="i field">_isSingleScopeLookup</a>)
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r3 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the current scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="r0 r t">T</span> <span class="i">IEnumerator</span>&lt;<span class="r0 r t">T</span>&gt;.<a id="81d38ac05117062e" href="../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#17bd3fc2d6c5f57e" class="i field">_current</a>;
            }
        }
 
        <b>public object</b> <a id="a677a2bfc6a5e52d" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#17bd3fc2d6c5f57e" class="i field">_current</a>;
            }
        }
 
        <b>public void</b> <a id="f8021f586024e1f8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#2ca87eb58cdf4d55" class="i method">InitializeScopeEnumerator</a>();
        }
 
        <b>public void</b> <a id="5289b81480bfa679" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#17bd3fc2d6c5f57e" class="i field">_current</a> = <b>default</b>(<span class="r0 r t">T</span>);
            <a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a>.<a href="SessionStateScopeEnumerator.cs.html#ec3e3da49d9bfca4" class="i method">Dispose</a>();
            <a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a> = <b>null</b>;
            <a href="#546575dfa986c738" class="i field">_isInitialized</a> = <b>false</b>;
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#7ceec02d35f81562" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes override this method to return their</span>
        <span class="c">///</span><span class="c"> particular type of scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to look the item up in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">newCurrentItem</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope item that the derived class should return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the scope item was found or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract bool</b> <a id="84bf56f0b4fc5c6e" href="../R/84bf56f0b4fc5c6e.html" target="n" data-glyph="75,1" class="i method">GetScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r5 rd" class="r5 r">scope</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r6 rd" class="r6 r">name</span>,
            <b>out</b> <span class="r0 r t">T</span> <span id="r7 rd" class="r7 r">newCurrentItem</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IEnumerable/IEnumerator members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the lookup scope that the Current item was found in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <a id="7fe343bdad9aa843" href="../R/7fe343bdad9aa843.html" target="n" data-glyph="104,1" class="i property">CurrentLookupScope</a>
        {
            <b>get</b> { <b>return</b> <a href="#523d6775eb01fe1d" class="i field">_currentScope</a>; }
        }
 
        <b>private</b> <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <a id="523d6775eb01fe1d" href="../R/523d6775eb01fe1d.html" target="n" data-glyph="46,1" class="i field">_currentScope</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the scope in which the search begins.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <a id="f31f90d5a808498c" href="../R/f31f90d5a808498c.html" target="n" data-glyph="104,1" class="i property">InitialScope</a>
        {
            <b>get</b> { <b>return</b> <a href="#de284bca4dbde7e0" class="i field">_initialScope</a>; }
        }
 
        <b>private</b> <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <a id="de284bca4dbde7e0" href="../R/de284bca4dbde7e0.html" target="n" data-glyph="46,1" class="i field">_initialScope</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <b>private bool</b> <a id="3df5650c6814b0c7" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TryGetNewScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r8 rd" class="r8 r">lookupScope</span>,
            <b>out</b> <span class="r0 r t">T</span> <span id="r9 rd" class="r9 r">newCurrentItem</span>)
        {
            <b>bool</b> <span id="r10 rd" class="r10 r">result</span> = <a href="#84bf56f0b4fc5c6e" class="i method">GetScopeItem</a>(
                <span class="r8 r">lookupScope</span>,
                <a href="#11cb11387be05943" class="i field">_lookupPath</a>,
                <b>out</b> <span class="r9 r">newCurrentItem</span>);
 
            <b>return</b> <span class="r10 r">result</span>;
        }
 
        <b>private void</b> <a id="2ca87eb58cdf4d55" href="../R/2ca87eb58cdf4d55.html" target="n" data-glyph="76,1" class="i method">InitializeScopeEnumerator</a>()
        {
            <span class="c">// Define the lookup scope and if we have to do single</span>
            <span class="c">// level or dynamic lookup based on the lookup variable</span>
 
            <a href="#de284bca4dbde7e0" class="i field">_initialScope</a> = <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>;
 
            <b>if</b> (<a href="#11cb11387be05943" class="i field">_lookupPath</a>.<a href="VariablePath.cs.html#d9aea63a59fab144" class="i property">IsGlobal</a>)
            {
                <a href="#de284bca4dbde7e0" class="i field">_initialScope</a> = <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
                <a href="#fc37f68bca18997c" class="i field">_isSingleScopeLookup</a> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (<a href="#11cb11387be05943" class="i field">_lookupPath</a>.<a href="VariablePath.cs.html#c3ed9dfca1006eb8" class="i property">IsLocal</a> ||
                     <a href="#11cb11387be05943" class="i field">_lookupPath</a>.<a href="VariablePath.cs.html#3f742174e4f0a6ad" class="i property">IsPrivate</a>)
            {
                <a href="#de284bca4dbde7e0" class="i field">_initialScope</a> = <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>;
                <a href="#fc37f68bca18997c" class="i field">_isSingleScopeLookup</a> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (<a href="#11cb11387be05943" class="i field">_lookupPath</a>.<a href="VariablePath.cs.html#371f4864f3877b8e" class="i property">IsScript</a>)
            {
                <a href="#de284bca4dbde7e0" class="i field">_initialScope</a> = <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#3e9b212d63ea9802" class="i property">ScriptScope</a>;
                <a href="#fc37f68bca18997c" class="i field">_isSingleScopeLookup</a> = <b>true</b>;
            }
 
            <a href="#ba43ff38aaa9d300" class="i field">_scopeEnumerable</a> =
                 <b>new</b> <a href="SessionStateScopeEnumerator.cs.html#5e5d2a8d36a22ba8" class="t constructor">SessionStateScopeEnumerator</a>(<a href="#de284bca4dbde7e0" class="i field">_initialScope</a>);
 
            <a href="#546575dfa986c738" class="i field">_isInitialized</a> = <b>true</b>;
        }
 
        <b>private</b> <span class="r0 r t">T</span> <a id="17bd3fc2d6c5f57e" href="../R/17bd3fc2d6c5f57e.html" target="n" data-glyph="46,1" class="i field">_current</a>;
        <b>protected</b> <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <a id="0a366716cb7e8bec" href="../R/0a366716cb7e8bec.html" target="n" data-glyph="45,1" class="i field">sessionState</a>;
        <b>private readonly</b> <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <a id="11cb11387be05943" href="../R/11cb11387be05943.html" target="n" data-glyph="46,1" class="i field">_lookupPath</a>;
        <b>private</b> <a href="SessionStateScopeEnumerator.cs.html#8788a8469feccecf" class="t t">SessionStateScopeEnumerator</a> <a id="ba43ff38aaa9d300" href="../R/ba43ff38aaa9d300.html" target="n" data-glyph="46,1" class="i field">_scopeEnumerable</a>;
        <b>private bool</b> <a id="fc37f68bca18997c" href="../R/fc37f68bca18997c.html" target="n" data-glyph="46,1" class="i field">_isSingleScopeLookup</a>;
        <b>private bool</b> <a id="546575dfa986c738" href="../R/546575dfa986c738.html" target="n" data-glyph="46,1" class="i field">_isInitialized</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The scope searcher for variables.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="ad5d85fdcf1604e8" href="../R/ad5d85fdcf1604e8.html" target="n" data-glyph="2,0" class="t t">VariableScopeItemSearcher</a> : <a href="#7ceec02d35f81562" class="t t">ScopedItemSearcher</a>&lt;<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt;
    {
        <b>public</b> <a id="1ca5bffec0ab42a5" href="../R/1ca5bffec0ab42a5.html" target="n" data-glyph="72,1" class="t constructor">VariableScopeItemSearcher</a>(
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r11 rd" class="r11 r">sessionState</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r12 rd" class="r12 r">lookupPath</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r13 rd" class="r13 r">origin</span>) : <a href="#eac5b84dc164ec66" class="k">base</a>(<span class="r11 r">sessionState</span>, <span class="r12 r">lookupPath</span>)
        {
            <a href="#6d02c3c21906568d" class="i field">_origin</a> = <span class="r13 r">origin</span>;
        }
 
        <b>private readonly</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="6d02c3c21906568d" href="../R/6d02c3c21906568d.html" target="n" data-glyph="46,1" class="i field">_origin</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes override this method to return their</span>
        <span class="c">///</span><span class="c"> particular type of scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to look the item up in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope item that the derived class should return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the scope item was found or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="ef56a9672be72e41" href="../R/ef56a9672be72e41.html" target="n" data-glyph="75,1" class="i method">GetScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r14 rd" class="r14 r">scope</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r15 rd" class="r15 r">name</span>,
            <b>out</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r16 rd" class="r16 r">variable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r15 r">name</span> <b>is not</b> <a href="VariablePath.cs.html#16909d1fb60c5b06" class="t t">FunctionLookupPath</a>,
                <span class="s">&quot;name was scanned incorrect if we get here and it is a FunctionLookupPath&quot;</span>);
 
            <b>bool</b> <span id="r17 rd" class="r17 r">result</span> = <b>true</b>;
 
            <span class="r16 r">variable</span> = <span class="r14 r">scope</span>.<a href="SessionStateScope.cs.html#a1f277d1ce96506f" class="i method">GetVariable</a>(<span class="r15 r">name</span>.<a href="VariablePath.cs.html#90635bdb0f559a39" class="i property">QualifiedName</a>, <a href="#6d02c3c21906568d" class="i field">_origin</a>);
 
            <span class="c">// If the variable is private and the lookup scope</span>
            <span class="c">// isn&#39;t the current scope, claim that the variable</span>
            <span class="c">// doesn&#39;t exist so that the lookup continues.</span>
 
            <b>if</b> (<span class="r16 r">variable</span> == <b>null</b> ||
                (<span class="r16 r">variable</span>.<a href="ShellVariable.cs.html#4c2b483b28395996" class="i property">IsPrivate</a> &amp;&amp;
                 <span class="r14 r">scope</span> != <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>))
            {
                <span class="r17 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r17 r">result</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The scope searcher for aliases.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="9cae066cde9b1c21" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">AliasScopeItemSearcher</a> : <a href="#7ceec02d35f81562" class="t t">ScopedItemSearcher</a>&lt;<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt;
    {
        <b>public</b> <a id="be347c681128ec19" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">AliasScopeItemSearcher</a>(
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r18 rd" class="r18 r">sessionState</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r19 rd" class="r19 r">lookupPath</span>) : <a href="#eac5b84dc164ec66" class="k">base</a>(<span class="r18 r">sessionState</span>, <span class="r19 r">lookupPath</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes override this method to return their</span>
        <span class="c">///</span><span class="c"> particular type of scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to look the item up in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">alias</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope item that the derived class should return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the scope item was found or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="eacbbdc425c4726d" href="../R/eacbbdc425c4726d.html" target="n" data-glyph="75,1" class="i method">GetScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r20 rd" class="r20 r">scope</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r21 rd" class="r21 r">name</span>,
            <b>out</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r22 rd" class="r22 r">alias</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r21 r">name</span> <b>is not</b> <a href="VariablePath.cs.html#16909d1fb60c5b06" class="t t">FunctionLookupPath</a>,
                <span class="s">&quot;name was scanned incorrect if we get here and it is a FunctionLookupPath&quot;</span>);
 
            <b>bool</b> <span id="r23 rd" class="r23 r">result</span> = <b>true</b>;
            <span class="r22 r">alias</span> = <span class="r20 r">scope</span>.<a href="SessionStateScope.cs.html#c52884be8798f63a" class="i method">GetAlias</a>(<span class="r21 r">name</span>.<a href="VariablePath.cs.html#90635bdb0f559a39" class="i property">QualifiedName</a>);
 
            <span class="c">// If the alias is private and the lookup scope</span>
            <span class="c">// isn&#39;t the current scope, claim that the alias</span>
            <span class="c">// doesn&#39;t exist so that the lookup continues.</span>
 
            <b>if</b> (<span class="r22 r">alias</span> == <b>null</b> ||
                ((<span class="r22 r">alias</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#0f1f390d997269ee" class="i field">Private</a>) != 0 &amp;&amp;
                 <span class="r20 r">scope</span> != <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>))
            {
                <span class="r23 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r23 r">result</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The scope searcher for functions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="5de231778a2b9306" href="../R/5de231778a2b9306.html" target="n" data-glyph="2,0" class="t t">FunctionScopeItemSearcher</a> : <a href="#7ceec02d35f81562" class="t t">ScopedItemSearcher</a>&lt;<a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt;
    {
        <b>public</b> <a id="59b7660d86483e72" href="../R/59b7660d86483e72.html" target="n" data-glyph="72,1" class="t constructor">FunctionScopeItemSearcher</a>(
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r24 rd" class="r24 r">sessionState</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r25 rd" class="r25 r">lookupPath</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r26 rd" class="r26 r">origin</span>) : <a href="#eac5b84dc164ec66" class="k">base</a>(<span class="r24 r">sessionState</span>, <span class="r25 r">lookupPath</span>)
        {
            <a href="#215edac58e4eb226" class="i field">_origin</a> = <span class="r26 r">origin</span>;
        }
 
        <b>private readonly</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="215edac58e4eb226" href="../R/215edac58e4eb226.html" target="n" data-glyph="46,1" class="i field">_origin</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes override this method to return their</span>
        <span class="c">///</span><span class="c"> particular type of scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to look the item up in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">script</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope item that the derived class should return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the scope item was found or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="45bbe8a1723eb85b" href="../R/45bbe8a1723eb85b.html" target="n" data-glyph="75,1" class="i method">GetScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r27 rd" class="r27 r">scope</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r28 rd" class="r28 r">path</span>,
            <b>out</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r29 rd" class="r29 r">script</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r28 r">path</span> <b>is</b> <a href="VariablePath.cs.html#16909d1fb60c5b06" class="t t">FunctionLookupPath</a>,
                <span class="s">&quot;name was scanned incorrect if we get here and it is not a FunctionLookupPath&quot;</span>);
 
            <b>bool</b> <span id="r30 rd" class="r30 r">result</span> = <b>true</b>;
 
            <a href="#6b0ee19a8ee7e26e" class="i field">_name</a> = <span class="r28 r">path</span>.<a href="VariablePath.cs.html#ce4d73d30c3f19e5" class="i property">IsFunction</a> ? <span class="r28 r">path</span>.<a href="VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a> : <span class="r28 r">path</span>.<a href="VariablePath.cs.html#90635bdb0f559a39" class="i property">QualifiedName</a>;
 
            <span class="r29 r">script</span> = <span class="r27 r">scope</span>.<a href="SessionStateScope.cs.html#2057e0e5221ac1d4" class="i method">GetFunction</a>(<a href="#6b0ee19a8ee7e26e" class="i field">_name</a>);
 
            <b>if</b> (<span class="r29 r">script</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r31 rd" class="r31 r">isPrivate</span>;
                <a href="FilterInfo.cs.html#945af8143f567881" class="t t">FilterInfo</a> <span id="r32 rd" class="r32 r">filterInfo</span> = <span class="r29 r">script</span> <b>as</b> <a href="FilterInfo.cs.html#945af8143f567881" class="t t">FilterInfo</a>;
                <b>if</b> (<span class="r32 r">filterInfo</span> != <b>null</b>)
                {
                    <span class="r31 r">isPrivate</span> = (<span class="r32 r">filterInfo</span>.<a href="FunctionInfo.cs.html#4eff0d117fdeb729" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#0f1f390d997269ee" class="i field">Private</a>) != 0;
                }
                <b>else</b>
                {
                    <span class="r31 r">isPrivate</span> = (<span class="r29 r">script</span>.<a href="FunctionInfo.cs.html#4eff0d117fdeb729" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#0f1f390d997269ee" class="i field">Private</a>) != 0;
                }
 
                <span class="c">// If the function is private and the lookup scope</span>
                <span class="c">// isn&#39;t the current scope, claim that the function</span>
                <span class="c">// doesn&#39;t exist so that the lookup continues.</span>
 
                <b>if</b> (<span class="r31 r">isPrivate</span> &amp;&amp;
                    <span class="r27 r">scope</span> != <a href="#0a366716cb7e8bec" class="i field">sessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>)
                {
                    <span class="r30 r">result</span> = <b>false</b>;
                }
                <b>else</b>
                {
                    <span class="c">// Now check the visibility of the variable...</span>
                    <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<a href="#215edac58e4eb226" class="i field">_origin</a>, <span class="r29 r">script</span>);
                }
            }
            <b>else</b>
            {
                <span class="r30 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r30 r">result</span>;
        }
 
        <b>internal string</b> <a id="aa0acb13799c14db" href="../R/aa0acb13799c14db.html" target="n" data-glyph="104,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <a href="#6b0ee19a8ee7e26e" class="i field">_name</a>; }
        }
 
        <b>private string</b> <a id="6b0ee19a8ee7e26e" href="../R/6b0ee19a8ee7e26e.html" target="n" data-glyph="46,1" class="i field">_name</a> = <b>string</b>.<span class="i">Empty</span>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The scope searcher for drives.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="8ae35f2dec2e87d1" href="../R/8ae35f2dec2e87d1.html" target="n" data-glyph="2,0" class="t t">DriveScopeItemSearcher</a> : <a href="#7ceec02d35f81562" class="t t">ScopedItemSearcher</a>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;
    {
        <b>public</b> <a id="69a1644332426d7d" href="../R/69a1644332426d7d.html" target="n" data-glyph="72,1" class="t constructor">DriveScopeItemSearcher</a>(
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r33 rd" class="r33 r">sessionState</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r34 rd" class="r34 r">lookupPath</span>) : <a href="#eac5b84dc164ec66" class="k">base</a>(<span class="r33 r">sessionState</span>, <span class="r34 r">lookupPath</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes override this method to return their</span>
        <span class="c">///</span><span class="c"> particular type of scoped item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to look the item up in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">drive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope item that the derived class should return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the scope item was found or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="5d4546f5eb5a1f23" href="../R/5d4546f5eb5a1f23.html" target="n" data-glyph="75,1" class="i method">GetScopeItem</a>(
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r35 rd" class="r35 r">scope</span>,
            <a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r36 rd" class="r36 r">name</span>,
            <b>out</b> <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r37 rd" class="r37 r">drive</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r36 r">name</span> <b>is not</b> <a href="VariablePath.cs.html#16909d1fb60c5b06" class="t t">FunctionLookupPath</a>,
                <span class="s">&quot;name was scanned incorrect if we get here and it is a FunctionLookupPath&quot;</span>);
 
            <b>bool</b> <span id="r38 rd" class="r38 r">result</span> = <b>true</b>;
            <span class="r37 r">drive</span> = <span class="r35 r">scope</span>.<a href="SessionStateScope.cs.html#60d8a02344b18642" class="i method">GetDrive</a>(<span class="r36 r">name</span>.<a href="VariablePath.cs.html#88c3e3f5b3aa0d19" class="i property">DriveName</a>);
 
            <b>if</b> (<span class="r37 r">drive</span> == <b>null</b>)
            {
                <span class="r38 r">result</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r38 r">result</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
