<!DOCTYPE html>
<html><head><title>CoreAdapter.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(6164);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CoreAdapter.cs" target="_top">engine\CoreAdapter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Data</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Dynamic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Emit</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for all Adapters</span>
    <span class="c">///</span><span class="c"> This is the place to look every time you create a new Adapter. Consider if you</span>
    <span class="c">///</span><span class="c"> should implement each of the virtual methods here.</span>
    <span class="c">///</span><span class="c"> The base class deals with errors and performs additional operations before and after</span>
    <span class="c">///</span><span class="c"> calling the derived virtual methods.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="88aa0312e9fc25c7" href="../R/88aa0312e9fc25c7.html" target="n" data-glyph="2,0" class="t t"><span id="a049017fd23a6e7b">Adapter</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tracer for this and derivate classes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">TraceSource</span>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>)]
        <b>protected static</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="213b43cbfb274b2c" href="../R/213b43cbfb274b2c.html" target="n" data-glyph="45,1" class="i field">tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>);
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> member
 
        <b>internal virtual bool</b> <a id="7b7ccffa3fef6396" href="../R/7b7ccffa3fef6396.html" target="n" data-glyph="74,1" class="i method">CanSiteBinderOptimize</a>(<span class="i">MemberTypes</span> <span id="r0 rd" class="r0 r">typeToOperateOn</span>) { <b>return</b> <b>false</b>; }
 
        <b>protected static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="e9c0c445c871debf" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetDotNetTypeNameHierarchy</a>(<span class="i">Type</span> <span id="r1 rd" class="r1 r">type</span>)
        {
            <b>for</b> (; <span class="r1 r">type</span> != <b>null</b>; <span class="r1 r">type</span> = <span class="r1 r">type</span>.<span class="i">BaseType</span>)
            {
                <b>yield</b> <b>return</b> <span class="r1 r">type</span>.<span class="i">FullName</span>;
            }
        }
 
        <b>protected static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="1dd94f9582ce75a1" href="../R/1dd94f9582ce75a1.html" target="n" data-glyph="75,1" class="i method">GetDotNetTypeNameHierarchy</a>(<b>object</b> <span id="r2 rd" class="r2 r">obj</span>)
        {
            <b>return</b> <span class="i">GetDotNetTypeNameHierarchy</span>(<span class="r2 r">obj</span>.<span class="i">GetType</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the TypeNameHierarchy out of an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get the TypeNameHierarchy from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="1e5e338de08b68df" href="../R/1e5e338de08b68df.html" target="n" data-glyph="75,1" class="i method">GetTypeNameHierarchy</a>(<b>object</b> <span id="r3 rd" class="r3 r">obj</span>)
        {
            <b>return</b> <a href="#1dd94f9582ce75a1" class="i method">GetDotNetTypeNameHierarchy</a>(<span class="r3 r">obj</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the cached typename, if it can be cached, otherwise constructs a new typename.</span>
        <span class="c">///</span><span class="c"> By default, we don&#39;t return interned values, adapters can override if they choose.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get the TypeNameHierarchy from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="1203d1735d03cfb1" href="../R/1203d1735d03cfb1.html" target="n" data-glyph="75,1" class="i method">GetInternedTypeNameHierarchy</a>(<b>object</b> <span id="r4 rd" class="r4 r">obj</span>)
        {
            <b>return</b> <b>new</b> <a href="TypeTable.cs.html#1945a8541e959e21" class="t constructor">ConsolidatedString</a>(<a href="#1e5e338de08b68df" class="i method">GetTypeNameHierarchy</a>(<span class="r4 r">obj</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if memberName is not a member in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSMemberInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">memberName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the member to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to memberName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="r7 r t">T</span> <a id="c1f634cbfc1c8d58" href="../R/c1f634cbfc1c8d58.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r7 rd t" class="r7 r t">T</span>&gt;(<b>object</b> <span id="r5 rd" class="r5 r">obj</span>, <b>string</b> <span id="r6 rd" class="r6 r">memberName</span>) <b>where</b> <span class="r7 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first PSMemberInfo whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">predicate</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The predicate to find the matching member.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to the predicate match.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="r10 r t">T</span> <a id="e8326911c268c3c4" href="../R/e8326911c268c3c4.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r10 rd t" class="r10 r t">T</span>&gt;(<b>object</b> <span id="r8 rd" class="r8 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r9 rd" class="r9 r">predicate</span>) <b>where</b> <span class="r10 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the members available in the object.</span>
        <span class="c">///</span><span class="c"> The adapter implementation is encouraged to cache all properties/methods available</span>
        <span class="c">///</span><span class="c"> in the first call to GetMember and GetMembers so that subsequent</span>
        <span class="c">///</span><span class="c"> calls can use the cache.</span>
        <span class="c">///</span><span class="c"> In the case of the .NET adapter that would be a cache from the .NET type to</span>
        <span class="c">///</span><span class="c"> the public properties and fields available in that type.</span>
        <span class="c">///</span><span class="c"> In the case of the DirectoryEntry adapter, this could be a cache of the objectClass</span>
        <span class="c">///</span><span class="c"> to the properties available in it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the member information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All members in obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r12 r t">T</span>&gt; <a id="eeb765e496061a7d" href="../R/eeb765e496061a7d.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r12 rd t" class="r12 r t">T</span>&gt;(<b>object</b> <span id="r11 rd" class="r11 r">obj</span>) <b>where</b> <span class="r12 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> member
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> property
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract object</b> <a id="9b880ae8f23380d6" href="../R/9b880ae8f23380d6.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r13 rd" class="r13 r">property</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected abstract void</b> <a id="df9dd20512fbc127" href="../R/df9dd20512fbc127.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r14 rd" class="r14 r">property</span>, <b>object</b> <span id="r15 rd" class="r15 r">setValue</span>, <b>bool</b> <span id="r16 rd" class="r16 r">convertIfPossible</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract bool</b> <a id="d894c69e1a7fbfd4" href="../R/d894c69e1a7fbfd4.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r17 rd" class="r17 r">property</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract bool</b> <a id="8db3ef8fa7688ec8" href="../R/8db3ef8fa7688ec8.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r18 rd" class="r18 r">property</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property&#39;s value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the member.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract string</b> <a id="050cf6f01da64e0a" href="../R/050cf6f01da64e0a.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r19 rd" class="r19 r">property</span>, <b>bool</b> <span id="r20 rd" class="r20 r">forDisplay</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the property in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the property in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract string</b> <a id="4f23e3c0e8cd7b39" href="../R/4f23e3c0e8cd7b39.html" target="n" data-glyph="75,1" class="i method">PropertyToString</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r21 rd" class="r21 r">property</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an array with the property attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property we want the attributes from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array with the property attributes.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="i">AttributeCollection</span> <a id="d25202e4c51d7c9e" href="../R/d25202e4c51d7c9e.html" target="n" data-glyph="75,1" class="i method">PropertyAttributes</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r22 rd" class="r22 r">property</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> property
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> method
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to try to call</span>
        <span class="c">///</span><span class="c"> the method with the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMethods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">invocationConstraints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation constraints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected virtual object</b> <a id="11d02e170c7047c5" href="../R/11d02e170c7047c5.html" target="n" data-glyph="75,1" class="i method">MethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r23 rd" class="r23 r">method</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r24 rd" class="r24 r">invocationConstraints</span>, <b>object</b>[] <span id="r25 rd" class="r25 r">arguments</span>)
        {
            <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#0a0a7af900f51685" class="i method">MethodInvoke</a>(<span class="r23 r">method</span>, <span class="r25 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to try to call</span>
        <span class="c">///</span><span class="c"> the method with the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMethods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract object</b> <a id="0a0a7af900f51685" href="../R/0a0a7af900f51685.html" target="n" data-glyph="75,1" class="i method">MethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r26 rd" class="r26 r">method</span>, <b>object</b>[] <span id="r27 rd" class="r27 r">arguments</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to return the overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The return of GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="b9d4cf3b0d5861af" href="../R/b9d4cf3b0d5861af.html" target="n" data-glyph="75,1" class="i method">MethodDefinitions</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r28 rd" class="r28 r">method</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the method in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the method in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected virtual string</b> <a id="ce9bbc784b0eda8f" href="../R/ce9bbc784b0eda8f.html" target="n" data-glyph="75,1" class="i method">MethodToString</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r29 rd" class="r29 r">method</span>)
        {
            <span class="i">StringBuilder</span> <span id="r30 rd" class="r30 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r31 rd" class="r31 r">definitions</span> = <a href="#b9d4cf3b0d5861af" class="i method">MethodDefinitions</a>(<span class="r29 r">method</span>);
            <b>for</b> (<b>int</b> <span id="r32 rd" class="r32 r">i</span> = 0; <span class="r32 r">i</span> &lt; <span class="r31 r">definitions</span>.<span class="i">Count</span>; <span class="r32 r">i</span>++)
            {
                <span class="r30 r">returnValue</span>.<span class="i">Append</span>(<span class="r31 r">definitions</span>[<span class="r32 r">i</span>]);
                <span class="r30 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
            }
 
            <span class="r30 r">returnValue</span>.<span class="i">Remove</span>(<span class="r30 r">returnValue</span>.<span class="i">Length</span> - 2, 2);
            <b>return</b> <span class="r30 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> method
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameterized property
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property&#39;s value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the member.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual string</b> <a id="8bc34b2f81df84b8" href="../R/8bc34b2f81df84b8.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyType</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r33 rd" class="r33 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual bool</b> <a id="8a7221eff0b78426" href="../R/8a7221eff0b78426.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r34 rd" class="r34 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual bool</b> <a id="e31512ffccd6e887" href="../R/e31512ffccd6e887.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r35 rd" class="r35 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to return the overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The return of GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="6ea5366998939231" href="../R/6ea5366998939231.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyDefinitions</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r36 rd" class="r36 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to get the property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual object</b> <a id="2c336895fee22bec" href="../R/2c336895fee22bec.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyGet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r37 rd" class="r37 r">property</span>, <b>object</b>[] <span id="r38 rd" class="r38 r">arguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to set the property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="e42e47c8fb563449" href="../R/e42e47c8fb563449.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertySet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r39 rd" class="r39 r">property</span>, <b>object</b> <span id="r40 rd" class="r40 r">setValue</span>, <b>object</b>[] <span id="r41 rd" class="r41 r">arguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the property in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the property in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is not necessary for derived methods to override this.</span>
        <span class="c">///</span><span class="c"> This method is called only if ParameterizedProperties are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected virtual string</b> <a id="256ccdcc519e8278" href="../R/256ccdcc519e8278.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyToString</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r42 rd" class="r42 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;adapter is not called for parameterized properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameterized property
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> base
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
 
        <b>private static</b> <span class="i">Exception</span> <a id="dc8ebca590866e85" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewException</a>(
            <span class="i">Exception</span> <span id="r43 rd" class="r43 r">e</span>,
            <b>string</b> <span id="r44 rd" class="r44 r">errorId</span>,
            <b>string</b> <span id="r45 rd" class="r45 r">targetErrorId</span>,
            <b>string</b> <span id="r46 rd" class="r46 r">resourceString</span>,
            <b>params object</b>[] <span id="r47 rd" class="r47 r">parameters</span>)
        {
            <b>object</b>[] <span id="r48 rd" class="r48 r">newParameters</span> = <b>new</b> <b>object</b>[<span class="r47 r">parameters</span>.<span class="i">Length</span> + 1];
            <b>for</b> (<b>int</b> <span id="r49 rd" class="r49 r">i</span> = 0; <span class="r49 r">i</span> &lt; <span class="r47 r">parameters</span>.<span class="i">Length</span>; <span class="r49 r">i</span>++)
            {
                <span class="r48 r">newParameters</span>[<span class="r49 r">i</span> + 1] = <span class="r47 r">parameters</span>[<span class="r49 r">i</span>];
            }
 
            <span class="i">Exception</span> <span id="r50 rd" class="r50 r">ex</span> = <span class="r43 r">e</span> <b>as</b> <span class="i">TargetInvocationException</span>;
            <b>if</b> (<span class="r50 r">ex</span> != <b>null</b>)
            {
                <span class="i">Exception</span> <span id="r51 rd" class="r51 r">inner</span> = <span class="r50 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r50 r">ex</span>;
                <span class="r48 r">newParameters</span>[0] = <span class="r51 r">inner</span>.<span class="i">Message</span>;
                <b>return</b> <b>new</b> <a href="ExtendedTypeSystemException.cs.html#d493c5227ad2472e" class="t constructor">ExtendedTypeSystemException</a>(
                    <span class="r45 r">targetErrorId</span>,
                    <span class="r51 r">inner</span>,
                    <span class="r46 r">resourceString</span>,
                    <span class="r48 r">newParameters</span>);
            }
 
            <span class="r48 r">newParameters</span>[0] = <span class="r43 r">e</span>.<span class="i">Message</span>;
            <b>return</b> <b>new</b> <a href="ExtendedTypeSystemException.cs.html#d493c5227ad2472e" class="t constructor">ExtendedTypeSystemException</a>(
                <span class="r44 r">errorId</span>,
                <span class="r43 r">e</span>,
                <span class="r46 r">resourceString</span>,
                <span class="r48 r">newParameters</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> member
 
        <b>internal</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="e70aa32975138432" href="../R/e70aa32975138432.html" target="n" data-glyph="74,1" class="i method">BaseGetTypeNameHierarchy</a>(<b>object</b> <span id="r52 rd" class="r52 r">obj</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#1203d1735d03cfb1" class="i method">GetInternedTypeNameHierarchy</a>(<span class="r52 r">obj</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r53 rd" class="r53 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r53 r">e</span>,
                    <span class="s">&quot;CatchFromBaseGetTypeNameHierarchy&quot;</span>,
                    <span class="s">&quot;CatchFromBaseGetTypeNameHierarchyTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingTypeNameHierarchy</span>);
            }
        }
 
        <b>internal</b> <span class="r54 r t">T</span> <a id="4a4d5a71feb79697" href="../R/4a4d5a71feb79697.html" target="n" data-glyph="74,1" class="i method">BaseGetMember</a>&lt;<span id="r54 rd t" class="r54 r t">T</span>&gt;(<b>object</b> <span id="r55 rd" class="r55 r">obj</span>, <b>string</b> <span id="r56 rd" class="r56 r">memberName</span>) <b>where</b> <span class="r54 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<span class="i">GetMember</span>&lt;<span class="r54 r t">T</span>&gt;(<span class="r55 r">obj</span>, <span class="r56 r">memberName</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r57 rd" class="r57 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r57 r">e</span>,
                    <span class="s">&quot;CatchFromBaseGetMember&quot;</span>,
                    <span class="s">&quot;CatchFromBaseGetMemberTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionGettingMember</span>,
                    <span class="r56 r">memberName</span>);
            }
        }
 
        <b>internal</b> <span class="r58 r t">T</span> <a id="b693b5c9a2699c3f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">BaseGetFirstMemberOrDefault</a>&lt;<span id="r58 rd t" class="r58 r t">T</span>&gt;(<b>object</b> <span id="r59 rd" class="r59 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r60 rd" class="r60 r">predicate</span>) <b>where</b> <span class="r58 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<span class="i">GetFirstMemberOrDefault</span>&lt;<span class="r58 r t">T</span>&gt;(<span class="r59 r">obj</span>, <span class="r60 r">predicate</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r61 rd" class="r61 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r61 r">e</span>,
                    <span class="s">&quot;CatchFromBaseGetMember&quot;</span>,
                    <span class="s">&quot;CatchFromBaseGetMemberTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionGettingMember</span>,
                    <b>nameof</b>(<span class="r60 r">predicate</span>));
            }
        }
 
        <b>internal</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r62 r t">T</span>&gt; <a id="9c78fe6d2464e81a" href="../R/9c78fe6d2464e81a.html" target="n" data-glyph="74,1" class="i method">BaseGetMembers</a>&lt;<span id="r62 rd t" class="r62 r t">T</span>&gt;(<b>object</b> <span id="r63 rd" class="r63 r">obj</span>) <b>where</b> <span class="r62 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<span class="i">GetMembers</span>&lt;<span class="r62 r t">T</span>&gt;(<span class="r63 r">obj</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r64 rd" class="r64 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r64 r">e</span>,
                    <span class="s">&quot;CatchFromBaseGetMembers&quot;</span>,
                    <span class="s">&quot;CatchFromBaseGetMembersTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionGettingMembers</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> member
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> property
 
        <b>internal object</b> <a id="ccace9705dec121f" href="../R/ccace9705dec121f.html" target="n" data-glyph="74,1" class="i method">BasePropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r65 rd" class="r65 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#9b880ae8f23380d6" class="i method">PropertyGet</a>(<span class="r65 r">property</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r66 rd" class="r66 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r67 rd" class="r67 r">inner</span> = <span class="r66 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r66 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">GetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterGetValueTI&quot;</span>,
                    <span class="r67 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenGetting</span>,
                    <span class="r65 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r67 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r68 rd" class="r68 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">GetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterGetValue&quot;</span>,
                    <span class="r68 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenGetting</span>,
                    <span class="r65 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r68 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>internal void</b> <a id="cce9e3e0b85775a5" href="../R/cce9e3e0b85775a5.html" target="n" data-glyph="74,1" class="i method">BasePropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r69 rd" class="r69 r">property</span>, <b>object</b> <span id="r70 rd" class="r70 r">setValue</span>, <b>bool</b> <span id="r71 rd" class="r71 r">convert</span>)
        {
            <b>try</b>
            {
                <a href="#df9dd20512fbc127" class="i method">PropertySet</a>(<span class="r69 r">property</span>, <span class="r70 r">setValue</span>, <span class="r71 r">convert</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r72 rd" class="r72 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r73 rd" class="r73 r">inner</span> = <span class="r72 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r72 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">SetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterSetValueTI&quot;</span>,
                    <span class="r73 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenSetting</span>,
                    <span class="r69 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r73 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r74 rd" class="r74 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterSetValue&quot;</span>,
                    <span class="r74 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenSetting</span>,
                    <span class="r69 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r74 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>internal bool</b> <a id="3d9ba29556db9d16" href="../R/3d9ba29556db9d16.html" target="n" data-glyph="74,1" class="i method">BasePropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r75 rd" class="r75 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#d894c69e1a7fbfd4" class="i method">PropertyIsSettable</a>(<span class="r75 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r76 rd" class="r76 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r76 r">e</span>,
                    <span class="s">&quot;CatchFromBasePropertyIsSettable&quot;</span>,
                    <span class="s">&quot;CatchFromBasePropertyIsSettableTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingPropertyWriteState</span>,
                    <span class="r75 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal bool</b> <a id="548361493243bd21" href="../R/548361493243bd21.html" target="n" data-glyph="74,1" class="i method">BasePropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r77 rd" class="r77 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#8db3ef8fa7688ec8" class="i method">PropertyIsGettable</a>(<span class="r77 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r78 rd" class="r78 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r78 r">e</span>,
                    <span class="s">&quot;CatchFromBasePropertyIsGettable&quot;</span>,
                    <span class="s">&quot;CatchFromBasePropertyIsGettableTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingPropertyReadState</span>,
                    <span class="r77 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal string</b> <a id="24816c84711d6c7d" href="../R/24816c84711d6c7d.html" target="n" data-glyph="74,1" class="i method">BasePropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r79 rd" class="r79 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#050cf6f01da64e0a" class="i method">PropertyType</a>(<span class="r79 r">property</span>, <span class="r20 r">forDisplay</span>: <b>false</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r80 rd" class="r80 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r80 r">e</span>,
                    <span class="s">&quot;CatchFromBasePropertyType&quot;</span>,
                    <span class="s">&quot;CatchFromBasePropertyTypeTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingPropertyType</span>,
                    <span class="r79 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal string</b> <a id="908bc1d763e3796b" href="../R/908bc1d763e3796b.html" target="n" data-glyph="74,1" class="i method">BasePropertyToString</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r81 rd" class="r81 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#4f23e3c0e8cd7b39" class="i method">PropertyToString</a>(<span class="r81 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r82 rd" class="r82 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r82 r">e</span>,
                    <span class="s">&quot;CatchFromBasePropertyToString&quot;</span>,
                    <span class="s">&quot;CatchFromBasePropertyToStringTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingPropertyString</span>,
                    <span class="r81 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal</b> <span class="i">AttributeCollection</span> <a id="c3ee5c871ccb7e77" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">BasePropertyAttributes</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r83 rd" class="r83 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#d25202e4c51d7c9e" class="i method">PropertyAttributes</a>(<span class="r83 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r84 rd" class="r84 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r84 r">e</span>,
                    <span class="s">&quot;CatchFromBasePropertyAttributes&quot;</span>,
                    <span class="s">&quot;CatchFromBasePropertyAttributesTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingPropertyAttributes</span>,
                    <span class="r83 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> property
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> method
        <b>internal object</b> <a id="6fa516c0e4da96dd" href="../R/6fa516c0e4da96dd.html" target="n" data-glyph="74,1" class="i method">BaseMethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r85 rd" class="r85 r">method</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r86 rd" class="r86 r">invocationConstraints</span>, <b>params object</b>[] <span id="r87 rd" class="r87 r">arguments</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#11d02e170c7047c5" class="i method">MethodInvoke</a>(<span class="r85 r">method</span>, <span class="r86 r">invocationConstraints</span>, <span class="r87 r">arguments</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r88 rd" class="r88 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r89 rd" class="r89 r">inner</span> = <span class="r88 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r88 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterMethodInvokeTI&quot;</span>,
                    <span class="r89 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r87 r">arguments</span>.<span class="i">Length</span>,
                    <span class="r89 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r90 rd" class="r90 r">e</span>)
            {
                <b>if</b> (<span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#690c27a539d8abab" class="i field">baseObject</a> <b>is</b> <a href="lang/scriptblock.cs.html#5e20a8a88cfbe6cb" class="t t">SteppablePipeline</a>
                    &amp;&amp; (<span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Begin&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                        <span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Process&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                        <span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;End&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <b>throw</b>;
                }
 
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterMethodInvoke&quot;</span>,
                    <span class="r90 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="r85 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r87 r">arguments</span>.<span class="i">Length</span>,
                    <span class="r90 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="44c7f0dd2fa1d04d" href="../R/44c7f0dd2fa1d04d.html" target="n" data-glyph="74,1" class="i method">BaseMethodDefinitions</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r91 rd" class="r91 r">method</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#b9d4cf3b0d5861af" class="i method">MethodDefinitions</a>(<span class="r91 r">method</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r92 rd" class="r92 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r92 r">e</span>,
                    <span class="s">&quot;CatchFromBaseMethodDefinitions&quot;</span>,
                    <span class="s">&quot;CatchFromBaseMethodDefinitionsTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingMethodDefinitions</span>,
                    <span class="r91 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal string</b> <a id="31d1c1441c00059e" href="../R/31d1c1441c00059e.html" target="n" data-glyph="74,1" class="i method">BaseMethodToString</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r93 rd" class="r93 r">method</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#ce9bbc784b0eda8f" class="i method">MethodToString</a>(<span class="r93 r">method</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r94 rd" class="r94 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r94 r">e</span>,
                    <span class="s">&quot;CatchFromBaseMethodToString&quot;</span>,
                    <span class="s">&quot;CatchFromBaseMethodToStringTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingMethodString</span>,
                    <span class="r93 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> method
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameterized property
        <b>internal string</b> <a id="00d467c06432f1e5" href="../R/00d467c06432f1e5.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyType</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r95 rd" class="r95 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#8bc34b2f81df84b8" class="i method">ParameterizedPropertyType</a>(<span class="r95 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r96 rd" class="r96 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r96 r">e</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyType&quot;</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyTypeTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingParameterizedPropertytype</span>,
                    <span class="r95 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal bool</b> <a id="76fc9aa53f4c9be9" href="../R/76fc9aa53f4c9be9.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r97 rd" class="r97 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#8a7221eff0b78426" class="i method">ParameterizedPropertyIsSettable</a>(<span class="r97 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r98 rd" class="r98 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r98 r">e</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyIsSettable&quot;</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyIsSettableTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingParameterizedPropertyWriteState</span>,
                    <span class="r97 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal bool</b> <a id="07985e0295004605" href="../R/07985e0295004605.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r99 rd" class="r99 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#e31512ffccd6e887" class="i method">ParameterizedPropertyIsGettable</a>(<span class="r99 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r100 rd" class="r100 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r100 r">e</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyIsGettable&quot;</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyIsGettableTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingParameterizedPropertyReadState</span>,
                    <span class="r99 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="896f193caf8a9bc8" href="../R/896f193caf8a9bc8.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyDefinitions</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r101 rd" class="r101 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#6ea5366998939231" class="i method">ParameterizedPropertyDefinitions</a>(<span class="r101 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r102 rd" class="r102 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r102 r">e</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyDefinitions&quot;</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyDefinitionsTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingParameterizedPropertyDefinitions</span>,
                    <span class="r101 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <b>internal object</b> <a id="fccdd5d05ea57538" href="../R/fccdd5d05ea57538.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyGet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r103 rd" class="r103 r">property</span>, <b>params object</b>[] <span id="r104 rd" class="r104 r">arguments</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#2c336895fee22bec" class="i method">ParameterizedPropertyGet</a>(<span class="r103 r">property</span>, <span class="r104 r">arguments</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r105 rd" class="r105 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r106 rd" class="r106 r">inner</span> = <span class="r105 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r105 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">GetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterParameterizedPropertyGetValueTI&quot;</span>,
                    <span class="r106 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenGetting</span>,
                    <span class="r103 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r106 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r107 rd" class="r107 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">GetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyAdapterGetValue&quot;</span>,
                    <span class="r107 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenGetting</span>,
                    <span class="r103 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r107 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>internal void</b> <a id="9fe39cceeb5bd297" href="../R/9fe39cceeb5bd297.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertySet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r108 rd" class="r108 r">property</span>, <b>object</b> <span id="r109 rd" class="r109 r">setValue</span>, <b>params object</b>[] <span id="r110 rd" class="r110 r">arguments</span>)
        {
            <b>try</b>
            {
                <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#e42e47c8fb563449" class="i method">ParameterizedPropertySet</a>(<span class="r108 r">property</span>, <span class="r109 r">setValue</span>, <span class="r110 r">arguments</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r111 rd" class="r111 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r112 rd" class="r112 r">inner</span> = <span class="r111 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r111 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">SetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterParameterizedPropertySetValueTI&quot;</span>,
                    <span class="r112 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenSetting</span>,
                    <span class="r108 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r112 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r113 rd" class="r113 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueInvocationException</span>(
                    <span class="s">&quot;CatchFromBaseAdapterParameterizedPropertySetValue&quot;</span>,
                    <span class="r113 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionWhenSetting</span>,
                    <span class="r108 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r113 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>internal string</b> <a id="312adaf384cf20f9" href="../R/312adaf384cf20f9.html" target="n" data-glyph="74,1" class="i method">BaseParameterizedPropertyToString</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r114 rd" class="r114 r">property</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#88aa0312e9fc25c7" class="k">this</a>.<a href="#256ccdcc519e8278" class="i method">ParameterizedPropertyToString</a>(<span class="r114 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r115 rd" class="r115 r">e</span>)
            {
                <b>throw</b> <span class="i">NewException</span>(
                    <span class="r115 r">e</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyToString&quot;</span>,
                    <span class="s">&quot;CatchFromBaseParameterizedPropertyToStringTI&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionRetrievingParameterizedPropertyString</span>,
                    <span class="r114 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameterized property
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Helper Methods
 
        <b>private static</b> <span class="i">Type</span> <a id="917bd12497fc31af" href="../R/917bd12497fc31af.html" target="n" data-glyph="76,1" class="i method">GetArgumentType</a>(<b>object</b> <span id="r116 rd" class="r116 r">argument</span>, <b>bool</b> <span id="r117 rd" class="r117 r">isByRefParameter</span>)
        {
            <b>if</b> (<span class="r116 r">argument</span> == <b>null</b>)
            {
                <b>return</b> <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>);
            }
 
            <b>if</b> (<span class="r117 r">isByRefParameter</span> &amp;&amp; <span class="r116 r">argument</span> <b>is</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a> <span id="r118 rd" class="r118 r">psref</span>)
            {
                <b>return</b> <a href="#917bd12497fc31af" class="i method">GetArgumentType</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r118 r">psref</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>), <span class="r117 r">isByRefParameter</span>: <b>false</b>);
            }
 
            <b>return</b> <span class="r116 r">argument</span>.<span class="i">GetType</span>();
        }
 
        <b>internal static</b> <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <a id="45565066f9e591c4" href="../R/45565066f9e591c4.html" target="n" data-glyph="74,1" class="i method">GetArgumentConversionRank</a>(<b>object</b> <span id="r119 rd" class="r119 r">argument</span>, <span class="i">Type</span> <span id="r120 rd" class="r120 r">parameterType</span>, <b>bool</b> <span id="r121 rd" class="r121 r">isByRef</span>, <b>bool</b> <span id="r122 rd" class="r122 r">allowCastingToByRefLikeType</span>)
        {
            <span class="i">Type</span> <span id="r123 rd" class="r123 r">fromType</span> = <b>null</b>;
            <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r124 rd" class="r124 r">rank</span> = <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#c8e6b7371e1dec03" class="i field">None</a>;
 
            <b>if</b> (<span class="r122 r">allowCastingToByRefLikeType</span> &amp;&amp; <span class="r120 r">parameterType</span>.<span class="i">IsByRefLike</span>)
            {
                <span class="c">// When resolving best method for use in binders, we can accept implicit/explicit casting conversions to</span>
                <span class="c">// a ByRef-like target type, because when generating IL from a call site with the binder, the IL includes</span>
                <span class="c">// the casting operation. However, we don&#39;t accept such conversions when it&#39;s for invoking the method via</span>
                <span class="c">// reflection, because reflection just doesn&#39;t support ByRef-like type.</span>
                <span class="r123 r">fromType</span> = <a href="#917bd12497fc31af" class="i method">GetArgumentType</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r119 r">argument</span>), <span class="r117 r">isByRefParameter</span>: <b>false</b>);
                <b>if</b> (<span class="r123 r">fromType</span> != <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))
                {
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#09a5a9e9100e4d75" class="i method">FigureCastConversion</a>(<span class="r123 r">fromType</span>, <span class="r120 r">parameterType</span>, <b>ref</b> <span class="r124 r">rank</span>);
                }
 
                <b>return</b> <span class="r124 r">rank</span>;
            }
 
            <span class="r123 r">fromType</span> = <a href="#917bd12497fc31af" class="i method">GetArgumentType</a>(<span class="r119 r">argument</span>, <span class="r121 r">isByRef</span>);
            <span class="r124 r">rank</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#33facd506a7034a5" class="i method">GetConversionRank</a>(<span class="r123 r">fromType</span>, <span class="r120 r">parameterType</span>);
 
            <b>if</b> (<span class="r124 r">rank</span> == <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#c8e6b7371e1dec03" class="i field">None</a>)
            {
                <span class="r123 r">fromType</span> = <a href="#917bd12497fc31af" class="i method">GetArgumentType</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r119 r">argument</span>), <span class="r121 r">isByRef</span>);
                <span class="r124 r">rank</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#33facd506a7034a5" class="i method">GetConversionRank</a>(<span class="r123 r">fromType</span>, <span class="r120 r">parameterType</span>);
            }
 
            <b>return</b> <span class="r124 r">rank</span>;
        }
 
        <b>private static</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <a id="382f9df0d5f5cd35" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ExpandParameters</a>(<b>int</b> <span id="r125 rd" class="r125 r">argCount</span>, <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r126 rd" class="r126 r">parameters</span>, <span class="i">Type</span> <span id="r127 rd" class="r127 r">elementType</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r126 r">parameters</span>[<span class="r126 r">parameters</span>.<span class="i">Length</span> - 1].<a href="#4041f05f1648e314" class="i field">isParamArray</a>, <span class="s">&quot;ExpandParameters shouldn&#39;t be called on non-param method&quot;</span>);
 
            <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r128 rd" class="r128 r">newParameters</span> = <b>new</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[<span class="r125 r">argCount</span>];
            <span class="i">Array</span>.<span class="i">Copy</span>(<span class="r126 r">parameters</span>, <span class="r128 r">newParameters</span>, <span class="r126 r">parameters</span>.<span class="i">Length</span> - 1);
            <b>for</b> (<b>int</b> <span id="r129 rd" class="r129 r">i</span> = <span class="r126 r">parameters</span>.<span class="i">Length</span> - 1; <span class="r129 r">i</span> &lt; <span class="r125 r">argCount</span>; ++<span class="r129 r">i</span>)
            {
                <span class="r128 r">newParameters</span>[<span class="r129 r">i</span>] = <b>new</b> <a href="#7a11dae9f7ce6a9f" class="t constructor">ParameterInformation</a>(<span class="r127 r">elementType</span>, <b>false</b>, <b>null</b>, <b>false</b>);
            }
 
            <b>return</b> <span class="r128 r">newParameters</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compare the 2 methods, determining which method is better.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">1 if method1 is better, -1 if method2 is better, 0 otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="366b53877fe9b272" href="../R/366b53877fe9b272.html" target="n" data-glyph="76,1" class="i method">CompareOverloadCandidates</a>(<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r130 rd" class="r130 r">candidate1</span>, <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r131 rd" class="r131 r">candidate2</span>, <b>object</b>[] <span id="r132 rd" class="r132 r">arguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span> == <span class="r131 r">candidate2</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>,
                               <span class="s">&quot;should have same number of conversions regardless of the number of parameters - default arguments are not included here&quot;</span>);
 
            <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r133 rd" class="r133 r">params1</span> = <span class="r130 r">candidate1</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> ?? <span class="r130 r">candidate1</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>;
            <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r134 rd" class="r134 r">params2</span> = <span class="r131 r">candidate2</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> ?? <span class="r131 r">candidate2</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>;
 
            <b>int</b> <span id="r135 rd" class="r135 r">betterCount</span> = 0;
            <b>int</b> <span id="r136 rd" class="r136 r">multiplier</span> = <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>;
            <b>for</b> (<b>int</b> <span id="r137 rd" class="r137 r">i</span> = 0; <span class="r137 r">i</span> &lt; <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>; ++<span class="r137 r">i</span>, --<span class="r136 r">multiplier</span>)
            {
                <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r137 r">i</span>] &lt; <span class="r131 r">candidate2</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r137 r">i</span>])
                {
                    <span class="r135 r">betterCount</span> -= <span class="r136 r">multiplier</span>;
                }
                <b>else</b> <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r137 r">i</span>] &gt; <span class="r131 r">candidate2</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r137 r">i</span>])
                {
                    <span class="r135 r">betterCount</span> += <span class="r136 r">multiplier</span>;
                }
                <b>else</b> <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r137 r">i</span>] == <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#9ae727afff1169c0" class="i field">UnrelatedArrays</a>)
                {
                    <span class="c">// If both are unrelated arrays, then use the element type conversions instead.</span>
                    <span class="i">Type</span> <span id="r138 rd" class="r138 r">argElemType</span> = <a href="#51f4ddcc1f426787" class="i method">EffectiveArgumentType</a>(<span class="r132 r">arguments</span>[<span class="r137 r">i</span>]).<span class="i">GetElementType</span>();
                    <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r139 rd" class="r139 r">rank1</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">GetConversionRank</span>(<span class="r138 r">argElemType</span>, <span class="r133 r">params1</span>[<span class="r137 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>());
                    <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r140 rd" class="r140 r">rank2</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">GetConversionRank</span>(<span class="r138 r">argElemType</span>, <span class="r134 r">params2</span>[<span class="r137 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>());
                    <b>if</b> (<span class="r139 r">rank1</span> &lt; <span class="r140 r">rank2</span>)
                    {
                        <span class="r135 r">betterCount</span> -= <span class="r136 r">multiplier</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r139 r">rank1</span> &gt; <span class="r140 r">rank2</span>)
                    {
                        <span class="r135 r">betterCount</span> += <span class="r136 r">multiplier</span>;
                    }
                }
            }
 
            <b>if</b> (<span class="r135 r">betterCount</span> == 0)
            {
                <span class="r136 r">multiplier</span> = <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>;
                <b>for</b> (<b>int</b> <span id="r141 rd" class="r141 r">i</span> = 0; <span class="r141 r">i</span> &lt; <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>; ++<span class="r141 r">i</span>, <span class="r136 r">multiplier</span> = <span class="i">Math</span>.<span class="i">Abs</span>(<span class="r136 r">multiplier</span>) - 1)
                {
                    <span class="c">// The following rather tricky logic tries to pick the best method in 2 very different cases -</span>
                    <span class="c">//   - Pick the most specific method when conversions aren&#39;t losing information</span>
                    <span class="c">//   - Pick the most general method when conversions will lose information.</span>
                    <span class="c">// Consider:</span>
                    <span class="c">//    f(uint32), f(decimal), call with f([byte]$i)</span>
                    <span class="c">//        in this case, we want to call f(uint32) because it is more specific</span>
                    <span class="c">//        while not losing information</span>
                    <span class="c">//    f(byte), f(int16), call with f([int]$i)</span>
                    <span class="c">//        in this case, we want to call f(int16) because it is more general,</span>
                    <span class="c">//        we know we could lose information with either call, but we will lose</span>
                    <span class="c">//        less information calling f(int16).</span>
                    <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r142 rd" class="r142 r">rank1</span> = <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r141 r">i</span>];
                    <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r143 rd" class="r143 r">rank2</span> = <span class="r131 r">candidate2</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r141 r">i</span>];
                    <b>if</b> (<span class="r142 r">rank1</span> &lt; <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#ec18e6e3fbcda029" class="i field">NullToValue</a> || <span class="r143 r">rank2</span> &lt; <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#ec18e6e3fbcda029" class="i field">NullToValue</a>)
                    {
                        <span class="c">// The tie breaking rules here do not apply to conversions that are not</span>
                        <span class="c">// numeric or inheritance related.</span>
                        <b>continue</b>;
                    }
 
                    <b>if</b> ((<span class="r142 r">rank1</span> &gt;= <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#2c07b8fc3068341e" class="i field">NumericImplicit</a>) != (<span class="r143 r">rank2</span> &gt;= <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#2c07b8fc3068341e" class="i field">NumericImplicit</a>))
                    {
                        <span class="c">// Skip trying to break ties when argument conversions are not both implicit or both</span>
                        <span class="c">// explicit.  If we have that situation, there are multiple arguments and an</span>
                        <span class="c">// ambiguity is probably the best choice.</span>
                        <b>continue</b>;
                    }
 
                    <span class="c">// We will now compare the parameter types, ignoring the actual argument type.  To choose</span>
                    <span class="c">// the right method, we need to know if we want the &quot;most specific&quot; or the &quot;most general&quot;.</span>
                    <span class="c">// If we have implicit argument conversions, we&#39;ll want the most specific, so invert the multiplier.</span>
                    <b>if</b> (<span class="r142 r">rank1</span> &gt;= <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#2c07b8fc3068341e" class="i field">NumericImplicit</a>)
                    {
                        <span class="r136 r">multiplier</span> = -<span class="r136 r">multiplier</span>;
                    }
 
                    <span class="c">// With a positive multiplier, we&#39;ll choose the &quot;most general&quot; type, and a negative</span>
                    <span class="c">// multiplier will choose the &quot;most specific&quot;.</span>
                    <span class="r142 r">rank1</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#33facd506a7034a5" class="i method">GetConversionRank</a>(<span class="r133 r">params1</span>[<span class="r141 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>, <span class="r134 r">params2</span>[<span class="r141 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>);
                    <span class="r143 r">rank2</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#33facd506a7034a5" class="i method">GetConversionRank</a>(<span class="r134 r">params2</span>[<span class="r141 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>, <span class="r133 r">params1</span>[<span class="r141 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>);
                    <b>if</b> (<span class="r142 r">rank1</span> &lt; <span class="r143 r">rank2</span>)
                    {
                        <span class="r135 r">betterCount</span> += <span class="r136 r">multiplier</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r142 r">rank1</span> &gt; <span class="r143 r">rank2</span>)
                    {
                        <span class="r135 r">betterCount</span> -= <span class="r136 r">multiplier</span>;
                    }
                }
            }
 
            <b>if</b> (<span class="r135 r">betterCount</span> == 0)
            {
                <span class="c">// Check if parameters are the same.  If so, we have a few tiebreakering rules down below.</span>
                <b>for</b> (<b>int</b> <span id="r144 rd" class="r144 r">i</span> = 0; <span class="r144 r">i</span> &lt; <span class="r130 r">candidate1</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>.<span class="i">Length</span>; ++<span class="r144 r">i</span>)
                {
                    <b>if</b> (<span class="r133 r">params1</span>[<span class="r144 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a> != <span class="r134 r">params2</span>[<span class="r144 r">i</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>)
                    {
                        <b>return</b> 0;
                    }
                }
 
                <span class="c">// Apply tie breaking rules, related to expanded parameters</span>
                <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> != <b>null</b> &amp;&amp; <span class="r131 r">candidate2</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> != <b>null</b>)
                {
                    <span class="c">// Both are using expanded parameters.  The one with more parameters is better</span>
                    <b>return</b> (<span class="r130 r">candidate1</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span> &gt; <span class="r131 r">candidate2</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span>) ? 1 : -1;
                }
                <b>else</b> <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> != <b>null</b>)
                {
                    <b>return</b> -1;
                }
                <b>else</b> <b>if</b> (<span class="r131 r">candidate2</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> != <b>null</b>)
                {
                    <b>return</b> 1;
                }
 
                <span class="c">// Apply tie breaking rules, related to specificity of parameters</span>
                <span class="r135 r">betterCount</span> = <a href="#b51290a786afe45c" class="i method">CompareTypeSpecificity</a>(<span class="r130 r">candidate1</span>, <span class="r131 r">candidate2</span>);
            }
 
            <span class="c">// The methods with fewer parameter wins</span>
            <span class="c">// Need to revisit this if we support named arguments</span>
            <b>if</b> (<span class="r135 r">betterCount</span> == 0)
            {
                <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span> &lt; <span class="r131 r">candidate2</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span>)
                {
                    <b>return</b> 1;
                }
                <b>else</b> <b>if</b> (<span class="r130 r">candidate1</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span> &gt; <span class="r131 r">candidate2</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span>)
                {
                    <b>return</b> -1;
                }
            }
 
            <b>return</b> <span class="r135 r">betterCount</span>;
        }
 
        <b>private static</b> <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <a id="d2da110c0e8950c4" href="../R/d2da110c0e8950c4.html" target="n" data-glyph="76,1" class="i method">FindBestCandidate</a>(<span class="i">List</span>&lt;<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a>&gt; <span id="r145 rd" class="r145 r">candidates</span>, <b>object</b>[] <span id="r146 rd" class="r146 r">arguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r145 r">candidates</span> != <b>null</b>, <span class="s">&quot;Caller should verify candidates != null&quot;</span>);
 
            <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r147 rd" class="r147 r">bestCandidateSoFar</span> = <b>null</b>;
            <b>bool</b> <span id="r148 rd" class="r148 r">multipleBestCandidates</span> = <b>false</b>;
 
            <b>for</b> (<b>int</b> <span id="r149 rd" class="r149 r">i</span> = 0; <span class="r149 r">i</span> &lt; <span class="r145 r">candidates</span>.<span class="i">Count</span>; <span class="r149 r">i</span>++)
            {
                <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r150 rd" class="r150 r">currentCandidate</span> = <span class="r145 r">candidates</span>[<span class="r149 r">i</span>];
                <b>if</b> (<span class="r147 r">bestCandidateSoFar</span> == <b>null</b>) <span class="c">// first iteration</span>
                {
                    <span class="r147 r">bestCandidateSoFar</span> = <span class="r150 r">currentCandidate</span>;
                    <b>continue</b>;
                }
 
                <b>int</b> <span id="r151 rd" class="r151 r">comparisonResult</span> = <a href="#366b53877fe9b272" class="i method">CompareOverloadCandidates</a>(<span class="r147 r">bestCandidateSoFar</span>, <span class="r150 r">currentCandidate</span>, <span class="r146 r">arguments</span>);
                <b>if</b> (<span class="r151 r">comparisonResult</span> == 0)
                {
                    <span class="r148 r">multipleBestCandidates</span> = <b>true</b>;
                }
                <b>else</b> <b>if</b> (<span class="r151 r">comparisonResult</span> &lt; 0)
                {
                    <span class="r147 r">bestCandidateSoFar</span> = <span class="r150 r">currentCandidate</span>;
                    <span class="r148 r">multipleBestCandidates</span> = <b>false</b>;
                }
            }
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                !<span class="r145 r">candidates</span>.<span class="i">Any</span>(<span id="r152 rd" class="r152 r">otherCandidate</span> =&gt; <span class="r152 r">otherCandidate</span> != <span class="r147 r">bestCandidateSoFar</span> &amp;&amp; <span class="i">CompareOverloadCandidates</span>(<span class="r152 r">otherCandidate</span>, <span class="r147 r">bestCandidateSoFar</span>, <span class="r146 r">arguments</span>) &gt; 0),
                <span class="s">&quot;No other candidates are better than bestCandidateSoFar&quot;</span>);
 
            <b>return</b> <span class="r148 r">multipleBestCandidates</span> ? <b>null</b> : <span class="r147 r">bestCandidateSoFar</span>;
        }
 
        <b>private static</b> <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <a id="ea0a52af11efdfb0" href="../R/ea0a52af11efdfb0.html" target="n" data-glyph="76,1" class="i method">FindBestCandidate</a>(<span class="i">List</span>&lt;<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a>&gt; <span id="r153 rd" class="r153 r">candidates</span>, <b>object</b>[] <span id="r154 rd" class="r154 r">arguments</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r155 rd" class="r155 r">invocationConstraints</span>)
        {
            <span class="i">List</span>&lt;<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a>&gt; <span id="r156 rd" class="r156 r">filteredCandidates</span> = <span class="r153 r">candidates</span>.<span class="i">Where</span>(<span id="r157 rd" class="r157 r">candidate</span> =&gt; <span class="i">IsInvocationConstraintSatisfied</span>(<span class="r157 r">candidate</span>, <span class="r155 r">invocationConstraints</span>)).<span class="i">ToList</span>();
            <b>if</b> (<span class="r156 r">filteredCandidates</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r153 r">candidates</span> = <span class="r156 r">filteredCandidates</span>;
            }
 
            <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r158 rd" class="r158 r">bestCandidate</span> = <a href="#d2da110c0e8950c4" class="i method">FindBestCandidate</a>(<span class="r153 r">candidates</span>, <span class="r154 r">arguments</span>);
            <b>return</b> <span class="r158 r">bestCandidate</span>;
        }
 
        <b>private static int</b> <a id="03f659b9f9c814de" href="../R/03f659b9f9c814de.html" target="n" data-glyph="76,1" class="i method">CompareTypeSpecificity</a>(<span class="i">Type</span> <span id="r159 rd" class="r159 r">type1</span>, <span class="i">Type</span> <span id="r160 rd" class="r160 r">type2</span>)
        {
            <b>if</b> (<span class="r159 r">type1</span>.<span class="i">IsGenericParameter</span> || <span class="r160 r">type2</span>.<span class="i">IsGenericParameter</span>)
            {
                <b>int</b> <span id="r161 rd" class="r161 r">result</span> = 0;
                <b>if</b> (<span class="r159 r">type1</span>.<span class="i">IsGenericParameter</span>)
                {
                    <span class="r161 r">result</span> -= 1;
                }
 
                <b>if</b> (<span class="r160 r">type2</span>.<span class="i">IsGenericParameter</span>)
                {
                    <span class="r161 r">result</span> += 1;
                }
 
                <b>return</b> <span class="r161 r">result</span>;
            }
 
            <b>if</b> (<span class="r159 r">type1</span>.<span class="i">IsArray</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r160 r">type2</span>.<span class="i">IsArray</span>, <span class="s">&quot;Caller should verify that both overload candidates have the same parameter types&quot;</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r159 r">type1</span>.<span class="i">GetArrayRank</span>() == <span class="r160 r">type2</span>.<span class="i">GetArrayRank</span>(), <span class="s">&quot;Caller should verify that both overload candidates have the same parameter types&quot;</span>);
                <b>return</b> <span class="i">CompareTypeSpecificity</span>(<span class="r159 r">type1</span>.<span class="i">GetElementType</span>(), <span class="r160 r">type2</span>.<span class="i">GetElementType</span>());
            }
 
            <b>if</b> (<span class="r159 r">type1</span>.<span class="i">IsGenericType</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r160 r">type2</span>.<span class="i">IsGenericType</span>, <span class="s">&quot;Caller should verify that both overload candidates have the same parameter types&quot;</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r159 r">type1</span>.<span class="i">GetGenericTypeDefinition</span>() == <span class="r160 r">type2</span>.<span class="i">GetGenericTypeDefinition</span>(), <span class="s">&quot;Caller should verify that both overload candidates have the same parameter types&quot;</span>);
                <b>return</b> <span class="i">CompareTypeSpecificity</span>(<span class="r159 r">type1</span>.<span class="i">GetGenericArguments</span>(), <span class="r160 r">type2</span>.<span class="i">GetGenericArguments</span>());
            }
 
            <b>return</b> 0;
        }
 
        <b>private static int</b> <a id="55428d59009afb3b" href="../R/55428d59009afb3b.html" target="n" data-glyph="76,1" class="i method">CompareTypeSpecificity</a>(<span class="i">Type</span>[] <span id="r162 rd" class="r162 r">params1</span>, <span class="i">Type</span>[] <span id="r163 rd" class="r163 r">params2</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r162 r">params1</span>.<span class="i">Length</span> == <span class="r163 r">params2</span>.<span class="i">Length</span>, <span class="s">&quot;Caller should verify that both overload candidates have the same number of parameters&quot;</span>);
 
            <b>bool</b> <span id="r164 rd" class="r164 r">candidate1hasAtLeastOneMoreSpecificParameter</span> = <b>false</b>;
            <b>bool</b> <span id="r165 rd" class="r165 r">candidate2hasAtLeastOneMoreSpecificParameter</span> = <b>false</b>;
            <b>for</b> (<b>int</b> <span id="r166 rd" class="r166 r">i</span> = 0; <span class="r166 r">i</span> &lt; <span class="r162 r">params1</span>.<span class="i">Length</span>; ++<span class="r166 r">i</span>)
            {
                <b>int</b> <span id="r167 rd" class="r167 r">specificityComparison</span> = <a href="#03f659b9f9c814de" class="i method">CompareTypeSpecificity</a>(<span class="r162 r">params1</span>[<span class="r166 r">i</span>], <span class="r163 r">params2</span>[<span class="r166 r">i</span>]);
                <b>if</b> (<span class="r167 r">specificityComparison</span> &gt; 0)
                {
                    <span class="r164 r">candidate1hasAtLeastOneMoreSpecificParameter</span> = <b>true</b>;
                }
                <b>else</b> <b>if</b> (<span class="r167 r">specificityComparison</span> &lt; 0)
                {
                    <span class="r165 r">candidate2hasAtLeastOneMoreSpecificParameter</span> = <b>true</b>;
                }
 
                <b>if</b> (<span class="r164 r">candidate1hasAtLeastOneMoreSpecificParameter</span> &amp;&amp; <span class="r165 r">candidate2hasAtLeastOneMoreSpecificParameter</span>)
                {
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r164 r">candidate1hasAtLeastOneMoreSpecificParameter</span> &amp;&amp; !<span class="r165 r">candidate2hasAtLeastOneMoreSpecificParameter</span>)
            {
                <b>return</b> 1;
            }
            <b>else</b> <b>if</b> (<span class="r165 r">candidate2hasAtLeastOneMoreSpecificParameter</span> &amp;&amp; !<span class="r164 r">candidate1hasAtLeastOneMoreSpecificParameter</span>)
            {
                <b>return</b> -1;
            }
            <b>else</b>
            {
                <b>return</b> 0;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns -1 if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">candidate1</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is less specific than </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">candidate2</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> (1 otherwise, or 0 if both are equally specific or non-comparable)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="b51290a786afe45c" href="../R/b51290a786afe45c.html" target="n" data-glyph="76,1" class="i method">CompareTypeSpecificity</a>(<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r168 rd" class="r168 r">candidate1</span>, <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r169 rd" class="r169 r">candidate2</span>)
        {
            <b>if</b> (!(<span class="r168 r">candidate1</span>.<a href="#78bcdf6d1a8af18b" class="i field">method</a>.<a href="#3b0dea3013af6d99" class="i field">isGeneric</a> || <span class="r169 r">candidate2</span>.<a href="#78bcdf6d1a8af18b" class="i field">method</a>.<a href="#3b0dea3013af6d99" class="i field">isGeneric</a>))
            {
                <b>return</b> 0;
            }
 
            <span class="i">Type</span>[] <span id="r170 rd" class="r170 r">params1</span> = <a href="#b72c306a25548542" class="i method">GetGenericMethodDefinitionIfPossible</a>(<span class="r168 r">candidate1</span>.<a href="#78bcdf6d1a8af18b" class="i field">method</a>.<a href="#3a0e575988f5a5de" class="i field">method</a>).<span class="i">GetParameters</span>().<span class="i">Select</span>(<b>static</b> <span id="r171 rd" class="r171 r">p</span> =&gt; <span class="r171 r">p</span>.<span class="i">ParameterType</span>).<span class="i">ToArray</span>();
            <span class="i">Type</span>[] <span id="r172 rd" class="r172 r">params2</span> = <a href="#b72c306a25548542" class="i method">GetGenericMethodDefinitionIfPossible</a>(<span class="r169 r">candidate2</span>.<a href="#78bcdf6d1a8af18b" class="i field">method</a>.<a href="#3a0e575988f5a5de" class="i field">method</a>).<span class="i">GetParameters</span>().<span class="i">Select</span>(<b>static</b> <span id="r173 rd" class="r173 r">p</span> =&gt; <span class="r173 r">p</span>.<span class="i">ParameterType</span>).<span class="i">ToArray</span>();
            <b>return</b> <a href="#55428d59009afb3b" class="i method">CompareTypeSpecificity</a>(<span class="r170 r">params1</span>, <span class="r172 r">params2</span>);
        }
 
        <b>private static</b> <span class="i">MethodBase</span> <a id="b72c306a25548542" href="../R/b72c306a25548542.html" target="n" data-glyph="76,1" class="i method">GetGenericMethodDefinitionIfPossible</a>(<span class="i">MethodBase</span> <span id="r174 rd" class="r174 r">method</span>)
        {
            <b>if</b> (<span class="r174 r">method</span>.<span class="i">IsGenericMethod</span> &amp;&amp; !<span class="r174 r">method</span>.<span class="i">IsGenericMethodDefinition</span>)
            {
                <span class="i">MethodInfo</span> <span id="r175 rd" class="r175 r">methodInfo</span> = <span class="r174 r">method</span> <b>as</b> <span class="i">MethodInfo</span>;
                <b>if</b> (<span class="r175 r">methodInfo</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r175 r">methodInfo</span>.<span class="i">GetGenericMethodDefinition</span>();
                }
            }
 
            <b>return</b> <span class="r174 r">method</span>;
        }
 
        [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;OverloadCandidate: {method.methodDefinition}&quot;</span>)]
        <b>private sealed class</b> <a id="61c22fd1fb0139fb" href="../R/61c22fd1fb0139fb.html" target="n" data-glyph="4,1" class="t t">OverloadCandidate</a>
        {
            <b>internal</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="78bcdf6d1a8af18b" href="../R/78bcdf6d1a8af18b.html" target="n" data-glyph="44,2" class="i field">method</a>;
            <b>internal</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <a id="116e12fdf9722250" href="../R/116e12fdf9722250.html" target="n" data-glyph="44,2" class="i field">parameters</a>;
            <b>internal</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <a id="91ba4405f612d767" href="../R/91ba4405f612d767.html" target="n" data-glyph="44,2" class="i field">expandedParameters</a>;
            <b>internal</b> <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>[] <a id="fbc8d807feadbd67" href="../R/fbc8d807feadbd67.html" target="n" data-glyph="44,2" class="i field">conversionRanks</a>;
 
            <b>internal</b> <a id="436a0cdb98152ca6" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">OverloadCandidate</a>(<a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r176 rd" class="r176 r">method</span>, <b>int</b> <span id="r177 rd" class="r177 r">argCount</span>)
            {
                <a href="#61c22fd1fb0139fb" class="k">this</a>.<a href="#78bcdf6d1a8af18b" class="i field">method</a> = <span class="r176 r">method</span>;
                <a href="#61c22fd1fb0139fb" class="k">this</a>.<a href="#116e12fdf9722250" class="i field">parameters</a> = <span class="r176 r">method</span>.<a href="#8c283f1778f314b5" class="i field">parameters</a>;
                <a href="#fbc8d807feadbd67" class="i field">conversionRanks</a> = <b>new</b> <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>[<span class="r177 r">argCount</span>];
            }
        }
 
        <b>private static bool</b> <a id="0e0f6e048f95f1b2" href="../R/0e0f6e048f95f1b2.html" target="n" data-glyph="76,1" class="i method">IsInvocationTargetConstraintSatisfied</a>(<a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r178 rd" class="r178 r">method</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r179 rd" class="r179 r">invocationConstraints</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r178 r">method</span> != <b>null</b>, <span class="s">&quot;Caller should verify method != null&quot;</span>);
 
            <b>if</b> (<span class="r178 r">method</span>.<a href="#3a0e575988f5a5de" class="i field">method</a> == <b>null</b>)
            {
                <b>return</b> <b>true</b>; <span class="c">// do not apply methodTargetType constraint to non-.NET types (i.e. to COM or WMI types)</span>
            }
 
            <span class="c">// An invocation constraint is only specified when there is an explicit cast on the target expression, so:</span>
            <span class="c">//</span>
            <span class="c">//    [IFoo]$x.Bar()</span>
            <span class="c">//</span>
            <span class="c">// will have [IFoo] as the method target type, but</span>
            <span class="c">//</span>
            <span class="c">//    $hash = @{}; $hash.Add(1,2)</span>
            <span class="c">//</span>
            <span class="c">// will have no method target type.</span>
 
            <b>var</b> <span id="r180 rd" class="r180 r">methodDeclaringType</span> = <span class="r178 r">method</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>;
            <b>if</b> (<span class="r179 r">invocationConstraints</span> == <b>null</b> || <span class="r179 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a> == <b>null</b>)
            {
                <span class="c">// If no method target type is specified, we say the constraint is matched as long as the method is not an interface.</span>
                <span class="c">// This behavior matches V2 - our candidate sets never included methods with declaring type as an interface in V2.</span>
 
                <b>return</b> !<span class="r180 r">methodDeclaringType</span>.<span class="i">IsInterface</span>;
            }
 
            <b>var</b> <span id="r181 rd" class="r181 r">targetType</span> = <span class="r179 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a>;
            <b>if</b> (<span class="r181 r">targetType</span>.<span class="i">IsInterface</span>)
            {
                <span class="c">// If targetType is an interface, types must match exactly.  This is how we can call method impls.</span>
                <span class="c">// We also allow the method declaring type to be in a base interface.</span>
                <b>return</b> <span class="r180 r">methodDeclaringType</span> == <span class="r181 r">targetType</span> || (<span class="r180 r">methodDeclaringType</span>.<span class="i">IsInterface</span> &amp;&amp; <span class="r181 r">targetType</span>.<span class="i">IsSubclassOf</span>(<span class="r180 r">methodDeclaringType</span>));
            }
 
            <b>if</b> (<span class="r180 r">methodDeclaringType</span>.<span class="i">IsInterface</span>)
            {
                <span class="c">// targetType is a class.  We don&#39;t try comparing with targetType because we&#39;ll end up with</span>
                <span class="c">// an ambiguous set because what is effectively the same method may appear in our set multiple</span>
                <span class="c">// times (once with the declaring type as the interface, and once as the actual class type.)</span>
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Dual-purpose of ([type]&lt;expression&gt;).method() syntax makes this code a little bit tricky to understand.</span>
            <span class="c">// First purpose of this syntax is cast.</span>
            <span class="c">// Second is a non-virtual super-class method call.</span>
            <span class="c">//</span>
            <span class="c">// Consider this code:</span>
            <span class="c">//</span>
            <span class="c">// ```</span>
            <span class="c">// class B {</span>
            <span class="c">//     [string]foo() {return &#39;B.foo&#39;}</span>
            <span class="c">//     [string]foo($a) {return &#39;B.foo&#39;}</span>
            <span class="c">// }</span>
            <span class="c">//</span>
            <span class="c">// class Q : B {</span>
            <span class="c">//     [string]$Name</span>
            <span class="c">//     Q([string]$name) {$this.name = $name}</span>
            <span class="c">// }</span>
            <span class="c">//</span>
            <span class="c">// ([Q]&#39;t&#39;).foo()</span>
            <span class="c">// ```</span>
            <span class="c">//</span>
            <span class="c">// Here we are using [Q] just for the cast and we are expecting foo() to be resolved to a super-class method.</span>
            <span class="c">// So methodDeclaringType is [B] and targetType is [Q]</span>
            <span class="c">//</span>
            <span class="c">// Now consider another code</span>
            <span class="c">//</span>
            <span class="c">// ```</span>
            <span class="c">// ([object]&quot;abc&quot;).ToString()</span>
            <span class="c">// ```</span>
            <span class="c">//</span>
            <span class="c">// Here we are using [object] to specify that we want a super-class implementation of ToString(), so it should</span>
            <span class="c">// return &quot;System.String&quot;</span>
            <span class="c">// Here methodDeclaringType is [string] and targetType is [object]</span>
            <span class="c">//</span>
            <span class="c">// Notice: in one case targetType is a subclass of methodDeclaringType,</span>
            <span class="c">// in another case it&#39;s the reverse.</span>
            <span class="c">// Both of them are valid.</span>
            <span class="c">//</span>
            <span class="c">// Array is a special case.</span>
            <b>return</b> <span class="r181 r">targetType</span>.<span class="i">IsAssignableFrom</span>(<span class="r180 r">methodDeclaringType</span>)
                || <span class="r180 r">methodDeclaringType</span>.<span class="i">IsAssignableFrom</span>(<span class="r181 r">targetType</span>)
                || (<span class="r181 r">targetType</span>.<span class="i">IsArray</span> &amp;&amp; <span class="r180 r">methodDeclaringType</span> == <b>typeof</b>(<span class="i">Array</span>));
        }
 
        <b>private static bool</b> <a id="f49c15ff0cfd1ab1" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsInvocationConstraintSatisfied</a>(<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r182 rd" class="r182 r">overloadCandidate</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r183 rd" class="r183 r">invocationConstraints</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r182 r">overloadCandidate</span> != <b>null</b>, <span class="s">&quot;Caller should verify overloadCandidate != null&quot;</span>);
 
            <b>if</b> (<span class="r183 r">invocationConstraints</span> == <b>null</b>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r183 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#256e114c1c5029ef" class="i property">ParameterTypes</a> != <b>null</b>)
            {
                <b>int</b> <span id="r184 rd" class="r184 r">parameterIndex</span> = 0;
                <b>foreach</b> (<span class="i">Type</span> <span id="r185 rd" class="r185 r">parameterTypeConstraint</span> <b>in</b> <span class="r183 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#256e114c1c5029ef" class="i property">ParameterTypes</a>)
                {
                    <b>if</b> (<span class="r185 r">parameterTypeConstraint</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r184 r">parameterIndex</span> &gt;= <span class="r182 r">overloadCandidate</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>.<span class="i">Length</span>)
                        {
                            <b>return</b> <b>false</b>;
                        }
 
                        <span class="i">Type</span> <span id="r186 rd" class="r186 r">parameterType</span> = <span class="r182 r">overloadCandidate</span>.<a href="#116e12fdf9722250" class="i field">parameters</a>[<span class="r184 r">parameterIndex</span>].<a href="#0403f9d43449a337" class="i field">parameterType</a>;
                        <b>if</b> (<span class="r186 r">parameterType</span> != <span class="r185 r">parameterTypeConstraint</span>)
                        {
                            <b>return</b> <b>false</b>;
                        }
                    }
 
                    <span class="r184 r">parameterIndex</span>++;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the best method out of overloaded methods.</span>
        <span class="c">///</span><span class="c"> The best has the smallest type distance between the method&#39;s parameters and the given arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">methods</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Different overloads for a method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">invocationConstraints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation constraints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">allowCastingToByRefLikeType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if we accept implicit/explicit casting conversion to a ByRef-like parameter type for method resolution.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r190 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments to check against the overloads.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r191 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no best method, the error id to use in the error message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r192 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no best method, the error message (format string) to use in the error message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">expandParamsOnBest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the best method&#39;s last parameter is a params method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">callNonVirtually</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if best method should be called as non-virtual.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="938ac4d3d430f987" href="../R/938ac4d3d430f987.html" target="n" data-glyph="74,1" class="i method">FindBestMethod</a>(
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r187 rd" class="r187 r">methods</span>,
            <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r188 rd" class="r188 r">invocationConstraints</span>,
            <b>bool</b> <span id="r189 rd" class="r189 r">allowCastingToByRefLikeType</span>,
            <b>object</b>[] <span id="r190 rd" class="r190 r">arguments</span>,
            <b>ref string</b> <span id="r191 rd" class="r191 r">errorId</span>,
            <b>ref string</b> <span id="r192 rd" class="r192 r">errorMsg</span>,
            <b>out bool</b> <span id="r193 rd" class="r193 r">expandParamsOnBest</span>,
            <b>out bool</b> <span id="r194 rd" class="r194 r">callNonVirtually</span>)
        {
            <span class="r194 r">callNonVirtually</span> = <b>false</b>;
            <a href="#8ae0c30e474b7c1e" class="k">var</a> <span id="r195 rd" class="r195 r">methodInfo</span> = <a href="#8c1e0e27f8eac0e7" class="i method">FindBestMethodImpl</a>(<span class="r187 r">methods</span>, <span class="r188 r">invocationConstraints</span>, <span class="r189 r">allowCastingToByRefLikeType</span>, <span class="r190 r">arguments</span>, <b>ref</b> <span class="r191 r">errorId</span>, <b>ref</b> <span class="r192 r">errorMsg</span>, <b>out</b> <span class="r193 r">expandParamsOnBest</span>);
            <b>if</b> (<span class="r195 r">methodInfo</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// For PS classes we need to support base method call syntax:</span>
            <span class="c">//</span>
            <span class="c">// class BaseClass</span>
            <span class="c">// {</span>
            <span class="c">//    [int] foo() { return 1}</span>
            <span class="c">// }</span>
            <span class="c">// class DerivedClass : BaseClass</span>
            <span class="c">// {</span>
            <span class="c">//    [int] foo() { return 2 * ([BaseClass]$this).foo() }</span>
            <span class="c">// }</span>
            <span class="c">//</span>
            <span class="c">// If we have such information in invocationConstraints then we should call method on the baseClass.</span>
            <b>if</b> (<span class="r188 r">invocationConstraints</span> != <b>null</b> &amp;&amp;
                <span class="r188 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a> != <b>null</b> &amp;&amp;
                <span class="r195 r">methodInfo</span>.<a href="#3a0e575988f5a5de" class="i field">method</a> != <b>null</b> &amp;&amp;
                <span class="r195 r">methodInfo</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span> != <b>null</b>)
            {
                <span class="i">Type</span> <span id="r196 rd" class="r196 r">targetType</span> = <span class="r195 r">methodInfo</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>;
                <b>if</b> (<span class="r196 r">targetType</span> != <span class="r188 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a> &amp;&amp; <span class="r196 r">targetType</span>.<span class="i">IsSubclassOf</span>(<span class="r188 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a>))
                {
                    <b>var</b> <span id="r197 rd" class="r197 r">parameterTypes</span> = <span class="r195 r">methodInfo</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">GetParameters</span>().<span class="i">Select</span>(<b>static</b> <span id="r198 rd" class="r198 r">parameter</span> =&gt; <span class="r198 r">parameter</span>.<span class="i">ParameterType</span>).<span class="i">ToArray</span>();
                    <b>var</b> <span id="r199 rd" class="r199 r">targetTypeMethod</span> = <span class="r188 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#c5767ba0e1e84dc7" class="i property">MethodTargetType</a>.<span class="i">GetMethod</span>(<span class="r195 r">methodInfo</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>, <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>, <b>null</b>, <span class="r197 r">parameterTypes</span>, <b>null</b>);
 
                    <b>if</b> (<span class="r199 r">targetTypeMethod</span> != <b>null</b> &amp;&amp; (<span class="r199 r">targetTypeMethod</span>.<span class="i">IsPublic</span> || <span class="r199 r">targetTypeMethod</span>.<span class="i">IsFamily</span> || <span class="r199 r">targetTypeMethod</span>.<span class="i">IsFamilyOrAssembly</span>))
                    {
                        <span class="r195 r">methodInfo</span> = <b>new</b> <span class="t">MethodInformation</span>(<span class="r199 r">targetTypeMethod</span>, 0);
                        <span class="r194 r">callNonVirtually</span> = <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r195 r">methodInfo</span>;
        }
 
        <b>private static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="8c1e0e27f8eac0e7" href="../R/8c1e0e27f8eac0e7.html" target="n" data-glyph="76,1" class="i method">FindBestMethodImpl</a>(
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r200 rd" class="r200 r">methods</span>,
            <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r201 rd" class="r201 r">invocationConstraints</span>,
            <b>bool</b> <span id="r202 rd" class="r202 r">allowCastingToByRefLikeType</span>,
            <b>object</b>[] <span id="r203 rd" class="r203 r">arguments</span>,
            <b>ref string</b> <span id="r204 rd" class="r204 r">errorId</span>,
            <b>ref string</b> <span id="r205 rd" class="r205 r">errorMsg</span>,
            <b>out bool</b> <span id="r206 rd" class="r206 r">expandParamsOnBest</span>)
        {
            <span class="r206 r">expandParamsOnBest</span> = <b>false</b>;
 
            <span class="c">// Small optimization so we don&#39;t calculate type distances when there is only one method</span>
            <span class="c">// We skip the optimization, if the method hasVarArgs, since in the case where arguments</span>
            <span class="c">// and parameters are of the same size, we want to know if the last argument should</span>
            <span class="c">// be turned into an array.</span>
            <span class="c">// We also skip the optimization if the number of arguments and parameters is different</span>
            <span class="c">// so we let the loop deal with possible optional parameters.</span>
            <b>if</b> ((<span class="r200 r">methods</span>.<span class="i">Length</span> == 1) &amp;&amp;
                (!<span class="r200 r">methods</span>[0].<a href="#14153cc4167a8706" class="i field">hasVarArgs</a>) &amp;&amp;
                (!<span class="r200 r">methods</span>[0].<a href="#3b0dea3013af6d99" class="i field">isGeneric</a>) &amp;&amp;
                (<span class="r200 r">methods</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a> == <b>null</b> || !(<span class="r200 r">methods</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>.<span class="i">IsGenericTypeDefinition</span>)) &amp;&amp;
                <span class="c">// generic methods need to be double checked in a loop below - generic methods can be rejected if type inference fails</span>
                (<span class="r200 r">methods</span>[0].<a href="#8c283f1778f314b5" class="i field">parameters</a>.<span class="i">Length</span> == <span class="r203 r">arguments</span>.<span class="i">Length</span>))
            {
                <b>return</b> <span class="r200 r">methods</span>[0];
            }
 
            <span class="i">Type</span>[] <span id="r207 rd" class="r207 r">argumentTypes</span> = <span class="r203 r">arguments</span>.<span class="i">Select</span>(<span class="i">EffectiveArgumentType</span>).<span class="i">ToArray</span>();
            <span class="i">List</span>&lt;<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a>&gt; <span id="r208 rd" class="r208 r">candidates</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a>&gt;();
            <b>for</b> (<b>int</b> <span id="r209 rd" class="r209 r">i</span> = 0; <span class="r209 r">i</span> &lt; <span class="r200 r">methods</span>.<span class="i">Length</span>; <span class="r209 r">i</span>++)
            {
                <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r210 rd" class="r210 r">method</span> = <span class="r200 r">methods</span>[<span class="r209 r">i</span>];
 
                <b>if</b> (<span class="r210 r">method</span>.<a href="#3a0e575988f5a5de" class="i field">method</a> != <b>null</b> &amp;&amp; <span class="r210 r">method</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>.<span class="i">IsGenericTypeDefinition</span>)
                {
                    <b>continue</b>; <span class="c">// skip methods defined by an *open* generic type</span>
                }
 
                <b>if</b> (<span class="r210 r">method</span>.<a href="#3b0dea3013af6d99" class="i field">isGeneric</a>)
                {
                    <span class="i">Type</span>[] <span id="r211 rd" class="r211 r">argumentTypesForTypeInference</span> = <b>new</b> <span class="i">Type</span>[<span class="r207 r">argumentTypes</span>.<span class="i">Length</span>];
                    <span class="i">Array</span>.<span class="i">Copy</span>(<span class="r207 r">argumentTypes</span>, <span class="r211 r">argumentTypesForTypeInference</span>, <span class="r207 r">argumentTypes</span>.<span class="i">Length</span>);
                    <b>if</b> (<span class="r201 r">invocationConstraints</span> != <b>null</b> &amp;&amp; <span class="r201 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#256e114c1c5029ef" class="i property">ParameterTypes</a> != <b>null</b>)
                    {
                        <b>int</b> <span id="r212 rd" class="r212 r">parameterIndex</span> = 0;
                        <b>foreach</b> (<span class="i">Type</span> <span id="r213 rd" class="r213 r">typeConstraintFromCallSite</span> <b>in</b> <span class="r201 r">invocationConstraints</span>.<a href="MshMemberInfo.cs.html#256e114c1c5029ef" class="i property">ParameterTypes</a>)
                        {
                            <b>if</b> (<span class="r213 r">typeConstraintFromCallSite</span> != <b>null</b>)
                            {
                                <span class="r211 r">argumentTypesForTypeInference</span>[<span class="r212 r">parameterIndex</span>] = <span class="r213 r">typeConstraintFromCallSite</span>;
                            }
 
                            <span class="r212 r">parameterIndex</span>++;
                        }
                    }
 
                    <span class="r210 r">method</span> = <a href="#acd2bca2943f5b05" class="t t">TypeInference</a>.<a href="#8181da27cc6e1765" class="i method">Infer</a>(<span class="r210 r">method</span>, <span class="r211 r">argumentTypesForTypeInference</span>);
                    <b>if</b> (<span class="r210 r">method</span> == <b>null</b>)
                    {
                        <span class="c">// Skip generic methods for which we cannot infer type arguments</span>
                        <b>continue</b>;
                    }
                }
 
                <b>if</b> (!<a href="#0e0f6e048f95f1b2" class="i method">IsInvocationTargetConstraintSatisfied</a>(<span class="r210 r">method</span>, <span class="r201 r">invocationConstraints</span>))
                {
                    <b>continue</b>;
                }
 
                <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r214 rd" class="r214 r">parameters</span> = <span class="r210 r">method</span>.<a href="#8c283f1778f314b5" class="i field">parameters</a>;
                <b>if</b> (<span class="r203 r">arguments</span>.<span class="i">Length</span> != <span class="r214 r">parameters</span>.<span class="i">Length</span>)
                {
                    <span class="c">// Skip methods w/ an incorrect # of arguments.</span>
 
                    <b>if</b> (<span class="r203 r">arguments</span>.<span class="i">Length</span> &gt; <span class="r214 r">parameters</span>.<span class="i">Length</span>)
                    {
                        <span class="c">// If too many args,it&#39;s only OK if the method is varargs.</span>
                        <b>if</b> (!<span class="r210 r">method</span>.<a href="#14153cc4167a8706" class="i field">hasVarArgs</a>)
                        {
                            <b>continue</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Too few args, OK if there are optionals, or varargs with the param array omitted</span>
                        <b>if</b> (!<span class="r210 r">method</span>.<a href="#2fd3629ed0782119" class="i field">hasOptional</a> &amp;&amp; (!<span class="r210 r">method</span>.<a href="#14153cc4167a8706" class="i field">hasVarArgs</a> || (<span class="r203 r">arguments</span>.<span class="i">Length</span> + 1) != <span class="r214 r">parameters</span>.<span class="i">Length</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <b>if</b> (<span class="r210 r">method</span>.<a href="#2fd3629ed0782119" class="i field">hasOptional</a>)
                        {
                            <span class="c">// Count optionals.  This code is rarely hit, mainly when calling code in the</span>
                            <span class="c">// assembly Microsoft.VisualBasic.  If it were more frequent, the optional count</span>
                            <span class="c">// should be stored in MethodInformation.</span>
                            <b>int</b> <span id="r215 rd" class="r215 r">optionals</span> = 0;
                            <b>for</b> (<b>int</b> <span id="r216 rd" class="r216 r">j</span> = 0; <span class="r216 r">j</span> &lt; <span class="r214 r">parameters</span>.<span class="i">Length</span>; <span class="r216 r">j</span>++)
                            {
                                <b>if</b> (<span class="r214 r">parameters</span>[<span class="r216 r">j</span>].<a href="#99334ea28bdc3021" class="i field">isOptional</a>)
                                {
                                    <span class="r215 r">optionals</span> += 1;
                                }
                            }
 
                            <b>if</b> (<span class="r203 r">arguments</span>.<span class="i">Length</span> + <span class="r215 r">optionals</span> &lt; <span class="r214 r">parameters</span>.<span class="i">Length</span>)
                            {
                                <span class="c">// Even with optionals, there are too few.</span>
                                <b>continue</b>;
                            }
                        }
                    }
                }
 
                <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r217 rd" class="r217 r">candidate</span> = <b>new</b> <span class="t">OverloadCandidate</span>(<span class="r210 r">method</span>, <span class="r203 r">arguments</span>.<span class="i">Length</span>);
                <b>for</b> (<b>int</b> <span id="r218 rd" class="r218 r">j</span> = 0; <span class="r217 r">candidate</span> != <b>null</b> &amp;&amp; <span class="r218 r">j</span> &lt; <span class="r214 r">parameters</span>.<span class="i">Length</span>; <span class="r218 r">j</span>++)
                {
                    <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a> <span id="r219 rd" class="r219 r">parameter</span> = <span class="r214 r">parameters</span>[<span class="r218 r">j</span>];
                    <b>if</b> (<span class="r219 r">parameter</span>.<a href="#99334ea28bdc3021" class="i field">isOptional</a> &amp;&amp; <span class="r203 r">arguments</span>.<span class="i">Length</span> &lt;= <span class="r218 r">j</span>)
                    {
                        <b>break</b>; <span class="c">// All the other parameters are optional and it is ok not to have more arguments</span>
                    }
                    <b>else</b> <b>if</b> (<span class="r219 r">parameter</span>.<a href="#4041f05f1648e314" class="i field">isParamArray</a>)
                    {
                        <span class="i">Type</span> <span id="r220 rd" class="r220 r">elementType</span> = <span class="r219 r">parameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>();
                        <b>if</b> (<span class="r214 r">parameters</span>.<span class="i">Length</span> == <span class="r203 r">arguments</span>.<span class="i">Length</span>)
                        {
                            <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r221 rd" class="r221 r">arrayConv</span> = <a href="#45565066f9e591c4" class="i method">GetArgumentConversionRank</a>(
                                <span class="r203 r">arguments</span>[<span class="r218 r">j</span>],
                                <span class="r219 r">parameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>,
                                <span class="r121 r">isByRef</span>: <b>false</b>,
                                <span class="r122 r">allowCastingToByRefLikeType</span>: <b>false</b>);
 
                            <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r222 rd" class="r222 r">elemConv</span> = <a href="#45565066f9e591c4" class="i method">GetArgumentConversionRank</a>(
                                <span class="r203 r">arguments</span>[<span class="r218 r">j</span>],
                                <span class="r220 r">elementType</span>,
                                <span class="r121 r">isByRef</span>: <b>false</b>,
                                <span class="r122 r">allowCastingToByRefLikeType</span>: <b>false</b>);
 
                            <b>if</b> (<span class="r222 r">elemConv</span> &gt; <span class="r221 r">arrayConv</span>)
                            {
                                <span class="r217 r">candidate</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> = <span class="i">ExpandParameters</span>(<span class="r203 r">arguments</span>.<span class="i">Length</span>, <span class="r214 r">parameters</span>, <span class="r220 r">elementType</span>);
                                <span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r218 r">j</span>] = <span class="r222 r">elemConv</span>;
                            }
                            <b>else</b>
                            {
                                <span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r218 r">j</span>] = <span class="r221 r">arrayConv</span>;
                            }
 
                            <b>if</b> (<span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r218 r">j</span>] == <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#c8e6b7371e1dec03" class="i field">None</a>)
                            {
                                <span class="r217 r">candidate</span> = <b>null</b>;
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// All remaining arguments will be added to one array to be passed as this params</span>
                            <span class="c">// argument.</span>
                            <span class="c">// Note that we go through here when the param array parameter has no argument.</span>
                            <b>for</b> (<b>int</b> <span id="r223 rd" class="r223 r">k</span> = <span class="r218 r">j</span>; <span class="r223 r">k</span> &lt; <span class="r203 r">arguments</span>.<span class="i">Length</span>; <span class="r223 r">k</span>++)
                            {
                                <span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r223 r">k</span>] = <a href="#45565066f9e591c4" class="i method">GetArgumentConversionRank</a>(
                                    <span class="r203 r">arguments</span>[<span class="r223 r">k</span>],
                                    <span class="r220 r">elementType</span>,
                                    <span class="r121 r">isByRef</span>: <b>false</b>,
                                    <span class="r122 r">allowCastingToByRefLikeType</span>: <b>false</b>);
 
                                <b>if</b> (<span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r223 r">k</span>] == <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#c8e6b7371e1dec03" class="i field">None</a>)
                                {
                                    <span class="c">// No longer a candidate</span>
                                    <span class="r217 r">candidate</span> = <b>null</b>;
                                    <b>break</b>;
                                }
                            }
 
                            <b>if</b> (<span class="r217 r">candidate</span> != <b>null</b>)
                            {
                                <span class="r217 r">candidate</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> = <span class="i">ExpandParameters</span>(<span class="r203 r">arguments</span>.<span class="i">Length</span>, <span class="r214 r">parameters</span>, <span class="r220 r">elementType</span>);
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r218 r">j</span>] = <a href="#45565066f9e591c4" class="i method">GetArgumentConversionRank</a>(
                            <span class="r203 r">arguments</span>[<span class="r218 r">j</span>],
                            <span class="r219 r">parameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>,
                            <span class="r219 r">parameter</span>.<a href="#682d6e36c933d06b" class="i field">isByRef</a>,
                            <span class="r202 r">allowCastingToByRefLikeType</span>);
 
                        <b>if</b> (<span class="r217 r">candidate</span>.<a href="#fbc8d807feadbd67" class="i field">conversionRanks</a>[<span class="r218 r">j</span>] == <a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#c8e6b7371e1dec03" class="i field">None</a>)
                        {
                            <span class="c">// No longer a candidate</span>
                            <span class="r217 r">candidate</span> = <b>null</b>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r217 r">candidate</span> != <b>null</b>)
                {
                    <span class="r208 r">candidates</span>.<span class="i">Add</span>(<span class="r217 r">candidate</span>);
                }
            }
 
            <b>if</b> (<span class="r208 r">candidates</span>.<span class="i">Count</span> == 0)
            {
                <b>if</b> ((<span class="r200 r">methods</span>.<span class="i">Length</span> &gt; 0) &amp;&amp; (<span class="r200 r">methods</span>.<span class="i">All</span>(<b>static</b> <span id="r224 rd" class="r224 r">m</span> =&gt; <span class="r224 r">m</span>.<span class="i">method</span> != <b>null</b> &amp;&amp; <span class="r224 r">m</span>.<span class="i">method</span>.<span class="i">DeclaringType</span>.<span class="i">IsGenericTypeDefinition</span> &amp;&amp; <span class="r224 r">m</span>.<span class="i">method</span>.<span class="i">IsStatic</span>)))
                {
                    <span class="r204 r">errorId</span> = <span class="s">&quot;CannotInvokeStaticMethodOnUninstantiatedGenericType&quot;</span>;
                    <span class="r205 r">errorMsg</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">CannotInvokeStaticMethodOnUninstantiatedGenericType</span>,
                        <span class="r200 r">methods</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>.<span class="i">FullName</span>);
                    <b>return</b> <b>null</b>;
                }
                <b>else</b>
                {
                    <span class="r204 r">errorId</span> = <span class="s">&quot;MethodCountCouldNotFindBest&quot;</span>;
                    <span class="r205 r">errorMsg</span> = <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentCountException</span>;
                    <b>return</b> <b>null</b>;
                }
            }
 
            <a href="#61c22fd1fb0139fb" class="t t">OverloadCandidate</a> <span id="r225 rd" class="r225 r">bestCandidate</span> = <span class="r208 r">candidates</span>.<span class="i">Count</span> == 1
                ? <span class="r208 r">candidates</span>[0]
                : <a href="#ea0a52af11efdfb0" class="i method">FindBestCandidate</a>(<span class="r208 r">candidates</span>, <span class="r203 r">arguments</span>, <span class="r201 r">invocationConstraints</span>);
            <b>if</b> (<span class="r225 r">bestCandidate</span> != <b>null</b>)
            {
                <span class="r206 r">expandParamsOnBest</span> = <span class="r225 r">bestCandidate</span>.<a href="#91ba4405f612d767" class="i field">expandedParameters</a> != <b>null</b>;
                <b>return</b> <span class="r225 r">bestCandidate</span>.<a href="#78bcdf6d1a8af18b" class="i field">method</a>;
            }
 
            <span class="r204 r">errorId</span> = <span class="s">&quot;MethodCountCouldNotFindBest&quot;</span>;
            <span class="r205 r">errorMsg</span> = <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodAmbiguousException</span>;
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <span class="i">Type</span> <a id="51f4ddcc1f426787" href="../R/51f4ddcc1f426787.html" target="n" data-glyph="74,1" class="i method">EffectiveArgumentType</a>(<b>object</b> <span id="r226 rd" class="r226 r">arg</span>)
        {
            <b>if</b> (<span class="r226 r">arg</span> != <b>null</b>)
            {
                <span class="r226 r">arg</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r226 r">arg</span>);
                <b>object</b>[] <span id="r227 rd" class="r227 r">argAsArray</span> = <span class="r226 r">arg</span> <b>as object</b>[];
                <b>if</b> (<span class="r227 r">argAsArray</span> != <b>null</b> &amp;&amp; <span class="r227 r">argAsArray</span>.<span class="i">Length</span> &gt; 0 &amp;&amp; <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r227 r">argAsArray</span>[0]) != <b>null</b>)
                {
                    <span class="i">Type</span> <span id="r228 rd" class="r228 r">firstType</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r227 r">argAsArray</span>[0]).<span class="i">GetType</span>();
                    <b>bool</b> <span id="r229 rd" class="r229 r">allSameType</span> = <b>true</b>;
 
                    <b>for</b> (<b>int</b> <span id="r230 rd" class="r230 r">j</span> = 1; <span class="r230 r">j</span> &lt; <span class="r227 r">argAsArray</span>.<span class="i">Length</span>; ++<span class="r230 r">j</span>)
                    {
                        <b>if</b> (<span class="r227 r">argAsArray</span>[<span class="r230 r">j</span>] == <b>null</b> || <span class="r228 r">firstType</span> != <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r227 r">argAsArray</span>[<span class="r230 r">j</span>]).<span class="i">GetType</span>())
                        {
                            <span class="r229 r">allSameType</span> = <b>false</b>;
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r229 r">allSameType</span>)
                    {
                        <b>return</b> <span class="r228 r">firstType</span>.<span class="i">MakeArrayType</span>();
                    }
                }
 
                <b>return</b> <span class="r226 r">arg</span>.<span class="i">GetType</span>();
            }
            <b>else</b>
            {
                <b>return</b> <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>);
            }
        }
 
        <b>internal static void</b> <a id="ca72ea1b83c8700c" href="../R/ca72ea1b83c8700c.html" target="n" data-glyph="74,1" class="i method">SetReferences</a>(<b>object</b>[] <span id="r231 rd" class="r231 r">arguments</span>, <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r232 rd" class="r232 r">methodInformation</span>, <b>object</b>[] <span id="r233 rd" class="r233 r">originalArguments</span>)
        {
            <b>using</b> (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(<span class="s">&quot;Checking for possible references.&quot;</span>))
            {
                <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r234 rd" class="r234 r">parameters</span> = <span class="r232 r">methodInformation</span>.<a href="#8c283f1778f314b5" class="i field">parameters</a>;
                <b>for</b> (<b>int</b> <span id="r235 rd" class="r235 r">i</span> = 0; (<span class="r235 r">i</span> &lt; <span class="r233 r">originalArguments</span>.<span class="i">Length</span>) &amp;&amp; (<span class="r235 r">i</span> &lt; <span class="r234 r">parameters</span>.<span class="i">Length</span>) &amp;&amp; (<span class="r235 r">i</span> &lt; <span class="r231 r">arguments</span>.<span class="i">Length</span>); <span class="r235 r">i</span>++)
                {
                    <b>object</b> <span id="r236 rd" class="r236 r">originalArgument</span> = <span class="r233 r">originalArguments</span>[<span class="r235 r">i</span>];
                    <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a> <span id="r237 rd" class="r237 r">originalArgumentReference</span> = <span class="r236 r">originalArgument</span> <b>as</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>;
                    <span class="c">// It still might be an PSObject wrapping an PSReference</span>
                    <b>if</b> (<span class="r237 r">originalArgumentReference</span> == <b>null</b>)
                    {
                        <b>if</b> (!(<span class="r236 r">originalArgument</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r238 rd" class="r238 r">originalArgumentObj</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="r237 r">originalArgumentReference</span> = <span class="r238 r">originalArgumentObj</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>;
                        <b>if</b> (<span class="r237 r">originalArgumentReference</span> == <b>null</b>)
                        {
                            <b>continue</b>;
                        }
                    }
 
                    <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a> <span id="r239 rd" class="r239 r">parameter</span> = <span class="r234 r">parameters</span>[<span class="r235 r">i</span>];
                    <b>if</b> (!<span class="r239 r">parameter</span>.<a href="#682d6e36c933d06b" class="i field">isByRef</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>object</b> <span id="r240 rd" class="r240 r">argument</span> = <span class="r231 r">arguments</span>[<span class="r235 r">i</span>];
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Argument &#39;{0}&#39; was a reference so it will be set to \&quot;{1}\&quot;.&quot;</span>, <span class="r235 r">i</span> + 1, <span class="r240 r">argument</span>);
                    <span class="r237 r">originalArgumentReference</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a> = <span class="r240 r">argument</span>;
                }
            }
        }
 
        <b>internal static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="e944e95cc84a218e" href="../R/e944e95cc84a218e.html" target="n" data-glyph="74,1" class="i method">GetBestMethodAndArguments</a>(
            <b>string</b> <span id="r241 rd" class="r241 r">methodName</span>,
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r242 rd" class="r242 r">methods</span>,
            <b>object</b>[] <span id="r243 rd" class="r243 r">arguments</span>,
            <b>out object</b>[] <span id="r244 rd" class="r244 r">newArguments</span>)
        {
            <b>return</b> <a href="#aaaa99713b7f3ebc" class="i method">GetBestMethodAndArguments</a>(<span class="r241 r">methodName</span>, <span class="r242 r">methods</span>, <b>null</b>, <span class="r243 r">arguments</span>, <b>out</b> <span class="r244 r">newArguments</span>);
        }
 
        <b>internal static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="aaaa99713b7f3ebc" href="../R/aaaa99713b7f3ebc.html" target="n" data-glyph="74,1" class="i method">GetBestMethodAndArguments</a>(
            <b>string</b> <span id="r245 rd" class="r245 r">methodName</span>,
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r246 rd" class="r246 r">methods</span>,
            <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r247 rd" class="r247 r">invocationConstraints</span>,
            <b>object</b>[] <span id="r248 rd" class="r248 r">arguments</span>,
            <b>out object</b>[] <span id="r249 rd" class="r249 r">newArguments</span>)
        {
            <b>bool</b> <span id="r250 rd" class="r250 r">expandParamsOnBest</span>;
            <b>bool</b> <span id="r251 rd" class="r251 r">callNonVirtually</span>;
            <b>string</b> <span id="r252 rd" class="r252 r">errorId</span> = <b>null</b>;
            <b>string</b> <span id="r253 rd" class="r253 r">errorMsg</span> = <b>null</b>;
 
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r254 rd" class="r254 r">bestMethod</span> = <a href="#938ac4d3d430f987" class="i method">FindBestMethod</a>(
                <span class="r246 r">methods</span>,
                <span class="r247 r">invocationConstraints</span>,
                <span class="r189 r">allowCastingToByRefLikeType</span>: <b>false</b>,
                <span class="r248 r">arguments</span>,
                <b>ref</b> <span class="r252 r">errorId</span>,
                <b>ref</b> <span class="r253 r">errorMsg</span>,
                <b>out</b> <span class="r250 r">expandParamsOnBest</span>,
                <b>out</b> <span class="r251 r">callNonVirtually</span>);
 
            <b>if</b> (<span class="r254 r">bestMethod</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">MethodException</span>(<span class="r252 r">errorId</span>, <b>null</b>, <span class="r253 r">errorMsg</span>, <span class="r245 r">methodName</span>, <span class="r248 r">arguments</span>.<span class="i">Length</span>);
            }
 
            <span class="r249 r">newArguments</span> = <a href="#687398dca1ee4b8d" class="i method">GetMethodArgumentsBase</a>(<span class="r245 r">methodName</span>, <span class="r254 r">bestMethod</span>.<a href="#8c283f1778f314b5" class="i field">parameters</a>, <span class="r248 r">arguments</span>, <span class="r250 r">expandParamsOnBest</span>);
            <b>return</b> <span class="r254 r">bestMethod</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called in GetBestMethodAndArguments after a call to FindBestMethod to perform the</span>
        <span class="c">///</span><span class="c"> type conversion, copying(varArg) and optional value setting of the final arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static object</b>[] <a id="687398dca1ee4b8d" href="../R/687398dca1ee4b8d.html" target="n" data-glyph="74,1" class="i method">GetMethodArgumentsBase</a>(<b>string</b> <span id="r255 rd" class="r255 r">methodName</span>,
            <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r256 rd" class="r256 r">parameters</span>, <b>object</b>[] <span id="r257 rd" class="r257 r">arguments</span>,
            <b>bool</b> <span id="r258 rd" class="r258 r">expandParamsOnBest</span>)
        {
            <b>int</b> <span id="r259 rd" class="r259 r">parametersLength</span> = <span class="r256 r">parameters</span>.<span class="i">Length</span>;
            <b>if</b> (<span class="r259 r">parametersLength</span> == 0)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;();
            }
 
            <b>object</b>[] <span id="r260 rd" class="r260 r">retValue</span> = <b>new</b> <b>object</b>[<span class="r259 r">parametersLength</span>];
            <b>for</b> (<b>int</b> <span id="r261 rd" class="r261 r">i</span> = 0; <span class="r261 r">i</span> &lt; <span class="r259 r">parametersLength</span> - 1; <span class="r261 r">i</span>++)
            {
                <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a> <span id="r262 rd" class="r262 r">parameter</span> = <span class="r256 r">parameters</span>[<span class="r261 r">i</span>];
                <a href="#94bdb54aba2c3df6" class="i method">SetNewArgument</a>(<span class="r255 r">methodName</span>, <span class="r257 r">arguments</span>, <span class="r260 r">retValue</span>, <span class="r262 r">parameter</span>, <span class="r261 r">i</span>);
            }
 
            <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a> <span id="r263 rd" class="r263 r">lastParameter</span> = <span class="r256 r">parameters</span>[<span class="r259 r">parametersLength</span> - 1];
            <b>if</b> (!<span class="r258 r">expandParamsOnBest</span>)
            {
                <span class="i">SetNewArgument</span>(<span class="r255 r">methodName</span>, <span class="r257 r">arguments</span>, <span class="r260 r">retValue</span>, <span class="r263 r">lastParameter</span>, <span class="r259 r">parametersLength</span> - 1);
                <b>return</b> <span class="r260 r">retValue</span>;
            }
 
            <span class="c">// From this point on, we are dealing with VarArgs (Params)</span>
 
            <span class="c">// If we have no arguments left, we use an appropriate empty array for the last parameter</span>
            <b>if</b> (<span class="r257 r">arguments</span>.<span class="i">Length</span> &lt; <span class="r259 r">parametersLength</span>)
            {
                <span class="r260 r">retValue</span>[<span class="r259 r">parametersLength</span> - 1] = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<span class="r263 r">lastParameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>(), <b>new</b> <b>int</b>[] { 0 });
                <b>return</b> <span class="r260 r">retValue</span>;
            }
 
            <span class="c">// We are going to put all the remaining arguments into an array</span>
            <span class="c">// and convert them to the propper type, if necessary to be the</span>
            <span class="c">// one argument for this last parameter</span>
            <b>int</b> <span id="r264 rd" class="r264 r">remainingArgumentCount</span> = <span class="r257 r">arguments</span>.<span class="i">Length</span> - <span class="r259 r">parametersLength</span> + 1;
            <b>if</b> (<span class="r264 r">remainingArgumentCount</span> == 1 &amp;&amp; <span class="r257 r">arguments</span>[<span class="r257 r">arguments</span>.<span class="i">Length</span> - 1] == <b>null</b>)
            {
                <span class="c">// Don&#39;t turn a single null argument into an array of 1 element, just pass null.</span>
                <span class="r260 r">retValue</span>[<span class="r259 r">parametersLength</span> - 1] = <b>null</b>;
            }
            <b>else</b>
            {
                <b>object</b>[] <span id="r265 rd" class="r265 r">remainingArguments</span> = <b>new</b> <b>object</b>[<span class="r264 r">remainingArgumentCount</span>];
                <span class="i">Type</span> <span id="r266 rd" class="r266 r">paramsElementType</span> = <span class="r263 r">lastParameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>();
                <b>for</b> (<b>int</b> <span id="r267 rd" class="r267 r">j</span> = 0; <span class="r267 r">j</span> &lt; <span class="r264 r">remainingArgumentCount</span>; <span class="r267 r">j</span>++)
                {
                    <b>int</b> <span id="r268 rd" class="r268 r">argumentIndex</span> = <span class="r267 r">j</span> + <span class="r259 r">parametersLength</span> - 1;
                    <b>try</b>
                    {
                        <span class="r265 r">remainingArguments</span>[<span class="r267 r">j</span>] = <span class="i">MethodArgumentConvertTo</span>(<span class="r257 r">arguments</span>[<span class="r268 r">argumentIndex</span>], <b>false</b>, <span class="r268 r">argumentIndex</span>,
                            <span class="r266 r">paramsElementType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    }
                    <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r269 rd" class="r269 r">e</span>)
                    {
                        <span class="c">// NTRAID#Windows Out Of Band Releases-924162-2005/11/17-JonN</span>
                        <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                            <span class="s">&quot;MethodArgumentConversionInvalidCastArgument&quot;</span>,
                            <span class="r269 r">e</span>,
                            <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentConversionException</span>,
                            <span class="r268 r">argumentIndex</span>, <span class="r257 r">arguments</span>[<span class="r268 r">argumentIndex</span>], <span class="r255 r">methodName</span>, <span class="r266 r">paramsElementType</span>, <span class="r269 r">e</span>.<span class="i">Message</span>);
                    }
                }
 
                <b>try</b>
                {
                    <span class="r260 r">retValue</span>[<span class="r259 r">parametersLength</span> - 1] = <span class="i">MethodArgumentConvertTo</span>(<span class="r265 r">remainingArguments</span>,
                        <span class="r263 r">lastParameter</span>.<a href="#682d6e36c933d06b" class="i field">isByRef</a>, <span class="r259 r">parametersLength</span> - 1, <span class="r263 r">lastParameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>,
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r270 rd" class="r270 r">e</span>)
                {
                    <span class="c">// NTRAID#Windows Out Of Band Releases-924162-2005/11/17-JonN</span>
                    <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                        <span class="s">&quot;MethodArgumentConversionParamsConversion&quot;</span>,
                        <span class="r270 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentConversionException</span>,
                        <span class="r259 r">parametersLength</span> - 1, <span class="r265 r">remainingArguments</span>, <span class="r255 r">methodName</span>, <span class="r263 r">lastParameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>, <span class="r270 r">e</span>.<span class="i">Message</span>);
                }
            }
 
            <b>return</b> <span class="r260 r">retValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Auxiliary method in MethodInvoke to set newArguments[index] with the propper value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used for the MethodException that might be thrown.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r272 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The complete array of arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r273 r">newArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The complete array of new arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The parameter to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index in newArguments to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="94bdb54aba2c3df6" href="../R/94bdb54aba2c3df6.html" target="n" data-glyph="74,1" class="i method">SetNewArgument</a>(<b>string</b> <span id="r271 rd" class="r271 r">methodName</span>, <b>object</b>[] <span id="r272 rd" class="r272 r">arguments</span>,
            <b>object</b>[] <span id="r273 rd" class="r273 r">newArguments</span>, <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a> <span id="r274 rd" class="r274 r">parameter</span>, <b>int</b> <span id="r275 rd" class="r275 r">index</span>)
        {
            <b>if</b> (<span class="r272 r">arguments</span>.<span class="i">Length</span> &gt; <span class="r275 r">index</span>)
            {
                <b>try</b>
                {
                    <span class="r273 r">newArguments</span>[<span class="r275 r">index</span>] = <span class="i">MethodArgumentConvertTo</span>(<span class="r272 r">arguments</span>[<span class="r275 r">index</span>], <span class="r274 r">parameter</span>.<a href="#682d6e36c933d06b" class="i field">isByRef</a>, <span class="r275 r">index</span>,
                        <span class="r274 r">parameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r276 rd" class="r276 r">e</span>)
                {
                    <span class="c">// NTRAID#Windows Out Of Band Releases-924162-2005/11/17-JonN</span>
                    <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                        <span class="s">&quot;MethodArgumentConversionInvalidCastArgument&quot;</span>,
                        <span class="r276 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentConversionException</span>,
                        <span class="r275 r">index</span>, <span class="r272 r">arguments</span>[<span class="r275 r">index</span>], <span class="r271 r">methodName</span>, <span class="r274 r">parameter</span>.<a href="#0403f9d43449a337" class="i field">parameterType</a>, <span class="r276 r">e</span>.<span class="i">Message</span>);
                }
            }
            <b>else</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r274 r">parameter</span>.<a href="#99334ea28bdc3021" class="i field">isOptional</a>, <span class="s">&quot;FindBestMethod would not return this method if there is no corresponding argument for a non optional parameter&quot;</span>);
                <span class="r273 r">newArguments</span>[<span class="r275 r">index</span>] = <span class="r274 r">parameter</span>.<a href="#0a1e0cc0fb6858d5" class="i field">defaultValue</a>;
            }
        }
 
        <b>internal static object</b> <a id="ebb2f425795926a7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">MethodArgumentConvertTo</a>(<b>object</b> <span id="r277 rd" class="r277 r">valueToConvert</span>,
            <b>bool</b> <span id="r278 rd" class="r278 r">isParameterByRef</span>, <b>int</b> <span id="r279 rd" class="r279 r">parameterIndex</span>, <span class="i">Type</span> <span id="r280 rd" class="r280 r">resultType</span>,
            <span class="i">IFormatProvider</span> <span id="r281 rd" class="r281 r">formatProvider</span>)
        {
            <b>using</b> (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(<span class="s">&quot;Method argument conversion.&quot;</span>))
            {
                <b>if</b> (<span class="r280 r">resultType</span> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r280 r">resultType</span>));
                }
 
                <b>bool</b> <span id="r282 rd" class="r282 r">isArgumentByRef</span>;
                <span class="r277 r">valueToConvert</span> = <a href="#65ee853e5e83c3f0" class="i method">UnReference</a>(<span class="r277 r">valueToConvert</span>, <b>out</b> <span class="r282 r">isArgumentByRef</span>);
                <b>if</b> (<span class="r278 r">isParameterByRef</span> &amp;&amp; !<span class="r282 r">isArgumentByRef</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">MethodException</span>(<span class="s">&quot;NonRefArgumentToRefParameterMsg&quot;</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">NonRefArgumentToRefParameter</span>, <span class="r279 r">parameterIndex</span> + 1, <b>typeof</b>(<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>).<span class="i">FullName</span>, <span class="s">&quot;[ref]&quot;</span>);
                }
 
                <b>if</b> (<span class="r282 r">isArgumentByRef</span> &amp;&amp; !<span class="r278 r">isParameterByRef</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">MethodException</span>(<span class="s">&quot;RefArgumentToNonRefParameterMsg&quot;</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">RefArgumentToNonRefParameter</span>, <span class="r279 r">parameterIndex</span> + 1, <b>typeof</b>(<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>).<span class="i">FullName</span>, <span class="s">&quot;[ref]&quot;</span>);
                }
 
                <b>return</b> <a href="#b6fd8bd97e66bec3" class="i method">PropertySetAndMethodArgumentConvertTo</a>(<span class="r277 r">valueToConvert</span>, <span class="r280 r">resultType</span>, <span class="r281 r">formatProvider</span>);
            }
        }
 
        <b>internal static object</b> <a id="65ee853e5e83c3f0" href="../R/65ee853e5e83c3f0.html" target="n" data-glyph="74,1" class="i method">UnReference</a>(<b>object</b> <span id="r283 rd" class="r283 r">obj</span>, <b>out bool</b> <span id="r284 rd" class="r284 r">isArgumentByRef</span>)
        {
            <span class="r284 r">isArgumentByRef</span> = <b>false</b>;
            <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a> <span id="r285 rd" class="r285 r">reference</span> = <span class="r283 r">obj</span> <b>as</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>;
            <b>if</b> (<span class="r285 r">reference</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Parameter was a reference.&quot;</span>);
                <span class="r284 r">isArgumentByRef</span> = <b>true</b>;
                <b>return</b> <span class="r285 r">reference</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>;
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r286 rd" class="r286 r">mshObj</span> = <span class="r283 r">obj</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<span class="r286 r">mshObj</span> != <b>null</b>)
            {
                <span class="r285 r">reference</span> = <span class="r286 r">mshObj</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>;
            }
 
            <b>if</b> (<span class="r285 r">reference</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Parameter was an PSObject containing a reference.&quot;</span>);
                <span class="r284 r">isArgumentByRef</span> = <b>true</b>;
                <b>return</b> <span class="r285 r">reference</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>;
            }
 
            <b>return</b> <span class="r283 r">obj</span>;
        }
 
        <b>internal static object</b> <a id="b6fd8bd97e66bec3" href="../R/b6fd8bd97e66bec3.html" target="n" data-glyph="74,1" class="i method">PropertySetAndMethodArgumentConvertTo</a>(<b>object</b> <span id="r287 rd" class="r287 r">valueToConvert</span>,
            <span class="i">Type</span> <span id="r288 rd" class="r288 r">resultType</span>, <span class="i">IFormatProvider</span> <span id="r289 rd" class="r289 r">formatProvider</span>)
        {
            <b>using</b> (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<span class="i">TraceScope</span>(<span class="s">&quot;Converting parameter \&quot;{0}\&quot; to \&quot;{1}\&quot;.&quot;</span>, <span class="r287 r">valueToConvert</span>, <span class="r288 r">resultType</span>))
            {
                <b>if</b> (<span class="r288 r">resultType</span> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r288 r">resultType</span>));
                }
 
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r290 rd" class="r290 r">mshObj</span> = <span class="r287 r">valueToConvert</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                <b>if</b> (<span class="r290 r">mshObj</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r288 r">resultType</span> == <b>typeof</b>(<b>object</b>))
                    {
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Parameter was an PSObject and will be converted to System.Object.&quot;</span>);
                        <span class="c">// we use PSObject.Base so we don&#39;t return</span>
                        <span class="c">// PSCustomObject</span>
                        <b>return</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r290 r">mshObj</span>);
                    }
                }
 
                <b>return</b> <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#0c97df7b75910bea" class="i method">ConvertTo</a>(<span class="r287 r">valueToConvert</span>, <span class="r288 r">resultType</span>, <span class="r289 r">formatProvider</span>);
            }
        }
 
        <b>internal static void</b> <a id="9d08e929dff5fc8e" href="../R/9d08e929dff5fc8e.html" target="n" data-glyph="74,1" class="i method">DoBoxingIfNecessary</a>(<span class="i">ILGenerator</span> <span id="r291 rd" class="r291 r">generator</span>, <span class="i">Type</span> <span id="r292 rd" class="r292 r">type</span>)
        {
            <b>if</b> (<span class="r292 r">type</span>.<span class="i">IsByRef</span>)
            {
                <span class="c">// We can&#39;t use a byref like we would use System.Object (the CLR will</span>
                <span class="c">// crash if we attempt to do so.)  There isn&#39;t much anyone could do</span>
                <span class="c">// with a byref in PowerShell anyway, so just load the object and</span>
                <span class="c">// return that instead.</span>
                <span class="r292 r">type</span> = <span class="r292 r">type</span>.<span class="i">GetElementType</span>();
                <b>if</b> (<span class="r292 r">type</span>.<span class="i">IsPrimitive</span>)
                {
                    <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>byte</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_U1</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>ushort</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_U2</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>uint</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_U4</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>sbyte</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_I8</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>short</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_I2</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>int</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_I4</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>long</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_I8</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>float</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_R4</span>); }
                    <b>else</b> <b>if</b> (<span class="r292 r">type</span> == <b>typeof</b>(<b>double</b>)) { <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_R8</span>); }
                }
                <b>else</b> <b>if</b> (<span class="r292 r">type</span>.<span class="i">IsValueType</span>)
                {
                    <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldobj</span>, <span class="r292 r">type</span>);
                }
                <b>else</b>
                {
                    <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldind_Ref</span>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r292 r">type</span>.<span class="i">IsPointer</span>)
            {
                <span class="c">// Pointers are similar to a byref.  Here we mimic what C# would do</span>
                <span class="c">// when assigning a pointer to an object.  This might not be useful</span>
                <span class="c">// to PowerShell script, but if we did nothing, the CLR would crash</span>
                <span class="c">// our process.</span>
                <span class="i">MethodInfo</span> <span id="r293 rd" class="r293 r">boxMethod</span> = <b>typeof</b>(<span class="i">Pointer</span>).<span class="i">GetMethod</span>(<span class="s">&quot;Box&quot;</span>);
                <span class="i">MethodInfo</span> <span id="r294 rd" class="r294 r">typeFromHandle</span> = <b>typeof</b>(<span class="i">Type</span>).<span class="i">GetMethod</span>(<span class="s">&quot;GetTypeFromHandle&quot;</span>);
                <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldtoken</span>, <span class="r292 r">type</span>);
                <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r294 r">typeFromHandle</span>);
                <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r293 r">boxMethod</span>);
            }
 
            <b>if</b> (<span class="r292 r">type</span>.<span class="i">IsValueType</span>)
            {
                <span class="r291 r">generator</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r292 r">type</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> base
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The abstract cache entry type.</span>
    <span class="c">///</span><span class="c"> All specific cache entry types should derive from it.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="fc6f71826b2098c0" href="../R/fc6f71826b2098c0.html" target="n" data-glyph="2,0" class="t t"><span id="0540cfc27732c6cb">CacheEntry</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the boolean value to indicate if the member is hidden.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently, we only check the &#39;HiddenAttribute&#39; declared for properties and methods,</span>
        <span class="c">///</span><span class="c"> because it can be done for them through the &#39;hidden&#39; keyword in PowerShell Class.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> We can&#39;t currently write a parameterized property in a PowerShell class so it&#39;s not too important</span>
        <span class="c">///</span><span class="c"> to check for the &#39;HiddenAttribute&#39; for parameterized properties. But if someone added the attribute</span>
        <span class="c">///</span><span class="c"> to their C#, it&#39;d be good to set this property correctly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="b2143099734a48e9" href="../R/b2143099734a48e9.html" target="n" data-glyph="104,1" class="i property">IsHidden</a> =&gt; <b>false</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Ordered and case insensitive hashtable.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="e46a59e67c3de683" href="../R/e46a59e67c3de683.html" target="n" data-glyph="2,0" class="t t">CacheTable</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object collection is used to help make populating method cache table more efficient</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#59a474c09d4f8efb" class="i method">PopulateMethodReflectionTable</a>(<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>, <span class="i">BindingFlags</span>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<b>object</b>&gt; <a id="6357f52cb95ce225" href="../R/6357f52cb95ce225.html" target="n" data-glyph="44,1" class="i field">memberCollection</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt; <a id="7029ceb7ba62a533" href="../R/7029ceb7ba62a533.html" target="n" data-glyph="46,1" class="i field">_indexes</a>;
 
        <b>internal</b> <a id="beeacb92aef9bb8e" href="../R/beeacb92aef9bb8e.html" target="n" data-glyph="74,1" class="t constructor">CacheTable</a>()
        {
            <a href="#6357f52cb95ce225" class="i field">memberCollection</a> = <b>new</b> <span class="i">Collection</span>&lt;<b>object</b>&gt;();
            <a href="#7029ceb7ba62a533" class="i field">_indexes</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <b>internal void</b> <a id="ad9a69c8f181d214" href="../R/ad9a69c8f181d214.html" target="n" data-glyph="74,1" class="i method">Add</a>(<b>string</b> <span id="r295 rd" class="r295 r">name</span>, <b>object</b> <span id="r296 rd" class="r296 r">member</span>)
        {
            <a href="#7029ceb7ba62a533" class="i field">_indexes</a>[<span class="r295 r">name</span>] = <a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>;
            <a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Add</span>(<span class="r296 r">member</span>);
        }
 
        <b>internal object</b> <a id="968b0af707b9b12e" href="../R/968b0af707b9b12e.html" target="n" data-glyph="104,1" class="k">this</a>[<b>string</b> <span id="r297 rd" class="r297 r">name</span>]
        {
            <b>get</b>
            {
                <b>int</b> <span id="r298 rd" class="r298 r">indexObj</span>;
                <b>if</b> (!<a href="#7029ceb7ba62a533" class="i field">_indexes</a>.<span class="i">TryGetValue</span>(<span class="r297 r">name</span>, <b>out</b> <span class="r298 r">indexObj</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>return</b> <a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r298 r">indexObj</span>];
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the first non-hidden member that satisfies the predicate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hidden members are not returned for any fuzzy searches (searching by &#39;match&#39; or enumerating a collection).</span>
        <span class="c">///</span><span class="c"> A hidden member is returned only if the member name is explicitly looked for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="9f0b3a7636d870e6" href="../R/9f0b3a7636d870e6.html" target="n" data-glyph="74,1" class="i method">GetFirstOrDefault</a>(<a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r299 rd" class="r299 r">predicate</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r300 rd" class="r300 r">entry</span> <b>in</b> <a href="#7029ceb7ba62a533" class="i field">_indexes</a>)
            {
                <b>if</b> (<span class="r299 r">predicate</span>(<span class="r300 r">entry</span>.<span class="i">Key</span>))
                {
                    <b>object</b> <span id="r301 rd" class="r301 r">member</span> = <a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r300 r">entry</span>.<span class="i">Value</span>];
                    <b>if</b> (<span class="r301 r">member</span> <b>is</b> <a href="#fc6f71826b2098c0" class="t t">CacheEntry</a> <span id="r302 rd" class="r302 r">cacheEntry</span> &amp;&amp; <span class="r302 r">cacheEntry</span>.<a href="#b2143099734a48e9" class="i property">IsHidden</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>return</b> <span class="r301 r">member</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Stores method related information.</span>
    <span class="c">///</span><span class="c"> This structure should be used whenever a new type is adapted.</span>
    <span class="c">///</span><span class="c"> For example, ManagementObjectAdapter uses this structure to store</span>
    <span class="c">///</span><span class="c"> WMI method information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;MethodInformation: {methodDefinition}&quot;</span>)]
    <b>internal class</b> <a id="8ae0c30e474b7c1e" href="../R/8ae0c30e474b7c1e.html" target="n" data-glyph="2,0" class="t t">MethodInformation</a>
    {
        <b>internal</b> <span class="i">MethodBase</span> <a id="3a0e575988f5a5de" href="../R/3a0e575988f5a5de.html" target="n" data-glyph="44,1" class="i field">method</a>;
        <b>private string</b> <a id="145f37b466ca6fd0" href="../R/145f37b466ca6fd0.html" target="n" data-glyph="46,1" class="i field">_cachedMethodDefinition</a>;
 
        <b>internal string</b> <a id="19363bd11c738b44" href="../R/19363bd11c738b44.html" target="n" data-glyph="104,1" class="i property">methodDefinition</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#145f37b466ca6fd0" class="i field">_cachedMethodDefinition</a> == <b>null</b>)
                {
                    <b>var</b> <span id="r303 rd" class="r303 r">name</span> = <a href="#3a0e575988f5a5de" class="i field">method</a> <b>is</b> <span class="i">ConstructorInfo</span> ? <span class="s">&quot;new&quot;</span> : <a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>;
                    <b>var</b> <span id="r304 rd" class="r304 r">methodDefn</span> = <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<span class="i">GetMethodInfoOverloadDefinition</span>(<span class="r303 r">name</span>, <a href="#3a0e575988f5a5de" class="i field">method</a>, <a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">GetParameters</span>().<span class="i">Length</span> - <a href="#8c283f1778f314b5" class="i field">parameters</a>.<span class="i">Length</span>);
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#145f37b466ca6fd0" class="i field">_cachedMethodDefinition</a>, <span class="r304 r">methodDefn</span>, <b>null</b>);
                }
 
                <b>return</b> <a href="#145f37b466ca6fd0" class="i field">_cachedMethodDefinition</a>;
            }
        }
 
        <b>internal</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <a id="8c283f1778f314b5" href="../R/8c283f1778f314b5.html" target="n" data-glyph="44,1" class="i field">parameters</a>;
        <b>internal bool</b> <a id="14153cc4167a8706" href="../R/14153cc4167a8706.html" target="n" data-glyph="44,1" class="i field">hasVarArgs</a>;
        <b>internal bool</b> <a id="2fd3629ed0782119" href="../R/2fd3629ed0782119.html" target="n" data-glyph="44,1" class="i field">hasOptional</a>;
        <b>internal bool</b> <a id="3b0dea3013af6d99" href="../R/3b0dea3013af6d99.html" target="n" data-glyph="44,1" class="i field">isGeneric</a>;
 
        <b>private bool</b> <a id="ad66c09deb75109d" href="../R/ad66c09deb75109d.html" target="n" data-glyph="46,1" class="i field">_useReflection</a>;
 
        <b>private delegate object</b> <a id="4818594cc9df7993" href="../R/4818594cc9df7993.html" target="n" data-glyph="16,1" class="t t"><span id="a101a61cf97c5be9">MethodInvoker</span></a>(<b>object</b> <span id="r305 rd" class="r305 r">target</span>, <b>object</b>[] <span id="r306 rd" class="r306 r">arguments</span>);
 
        <b>private</b> <a href="#4818594cc9df7993" class="t t">MethodInvoker</a> <a id="f124c05977bcb861" href="../R/f124c05977bcb861.html" target="n" data-glyph="46,1" class="i field">_methodInvoker</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor supports .net methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="30207fdc76f60c05" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">MethodInformation</a>(<span class="i">MethodBase</span> <span id="r307 rd" class="r307 r">method</span>, <b>int</b> <span id="r308 rd" class="r308 r">parametersToIgnore</span>)
        {
            <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#3a0e575988f5a5de" class="i field">method</a> = <span class="r307 r">method</span>;
            <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#3b0dea3013af6d99" class="i field">isGeneric</a> = <span class="r307 r">method</span>.<span class="i">IsGenericMethod</span>;
            <span class="i">ParameterInfo</span>[] <span id="r309 rd" class="r309 r">methodParameters</span> = <span class="r307 r">method</span>.<span class="i">GetParameters</span>();
            <b>int</b> <span id="r310 rd" class="r310 r">parametersLength</span> = <span class="r309 r">methodParameters</span>.<span class="i">Length</span> - <span class="r308 r">parametersToIgnore</span>;
            <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#8c283f1778f314b5" class="i field">parameters</a> = <b>new</b> <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[<span class="r310 r">parametersLength</span>];
 
            <b>for</b> (<b>int</b> <span id="r311 rd" class="r311 r">i</span> = 0; <span class="r311 r">i</span> &lt; <span class="r310 r">parametersLength</span>; <span class="r311 r">i</span>++)
            {
                <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#8c283f1778f314b5" class="i field">parameters</a>[<span class="r311 r">i</span>] = <b>new</b> <span class="t">ParameterInformation</span>(<span class="r309 r">methodParameters</span>[<span class="r311 r">i</span>]);
                <b>if</b> (<span class="r309 r">methodParameters</span>[<span class="r311 r">i</span>].<span class="i">IsOptional</span>)
                {
                    <a href="#2fd3629ed0782119" class="i field">hasOptional</a> = <b>true</b>;
                }
            }
 
            <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#14153cc4167a8706" class="i field">hasVarArgs</a> = <b>false</b>;
            <b>if</b> (<span class="r310 r">parametersLength</span> &gt; 0)
            {
                <span class="i">ParameterInfo</span> <span id="r312 rd" class="r312 r">lastParameter</span> = <span class="r309 r">methodParameters</span>[<span class="r310 r">parametersLength</span> - 1];
 
                <span class="c">// Optional and params together are forbidden in VB and so we only check for params</span>
                <span class="c">// if !hasOptional</span>
                <b>if</b> (!<a href="#2fd3629ed0782119" class="i field">hasOptional</a> &amp;&amp; <span class="r312 r">lastParameter</span>.<span class="i">ParameterType</span>.<span class="i">IsArray</span>)
                {
                    <span class="c">// The extension method &#39;CustomAttributeExtensions.GetCustomAttributes(ParameterInfo, Type, Boolean)&#39; has inconsistent</span>
                    <span class="c">// behavior on its return value in both FullCLR and CoreCLR. According to MSDN, if the attribute cannot be found, it</span>
                    <span class="c">// should return an empty collection. However, it returns null in some rare cases [when the parameter isn&#39;t backed by</span>
                    <span class="c">// actual metadata].</span>
                    <span class="c">// This inconsistent behavior affects OneCore powershell because we are using the extension method here when compiling</span>
                    <span class="c">// against CoreCLR. So we need to add a null check until this is fixed in CLR.</span>
                    <b>var</b> <span id="r313 rd" class="r313 r">paramArrayAttrs</span> = <span class="r312 r">lastParameter</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<span class="i">ParamArrayAttribute</span>), <b>false</b>);
                    <b>if</b> (<span class="r313 r">paramArrayAttrs</span> != <b>null</b> &amp;&amp; <span class="r313 r">paramArrayAttrs</span>.<span class="i">Length</span> &gt; 0)
                    {
                        <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#14153cc4167a8706" class="i field">hasVarArgs</a> = <b>true</b>;
                        <a href="#8ae0c30e474b7c1e" class="k">this</a>.<a href="#8c283f1778f314b5" class="i field">parameters</a>[<span class="r310 r">parametersLength</span> - 1].<a href="#4041f05f1648e314" class="i field">isParamArray</a> = <b>true</b>;
                    }
                }
            }
        }
 
        <b>internal</b> <a id="ec576a3e1af0171f" href="../R/ec576a3e1af0171f.html" target="n" data-glyph="74,1" class="t constructor">MethodInformation</a>(<b>bool</b> <span id="r314 rd" class="r314 r">hasvarargs</span>, <b>bool</b> <span id="r315 rd" class="r315 r">hasoptional</span>, <a href="#d694ba38a24d6665" class="t t">ParameterInformation</a>[] <span id="r316 rd" class="r316 r">arguments</span>)
        {
            <a href="#14153cc4167a8706" class="i field">hasVarArgs</a> = <span class="r314 r">hasvarargs</span>;
            <a href="#2fd3629ed0782119" class="i field">hasOptional</a> = <span class="r315 r">hasoptional</span>;
            <a href="#8c283f1778f314b5" class="i field">parameters</a> = <span class="r316 r">arguments</span>;
        }
 
        <b>internal object</b> <a id="73d5130c197cab35" href="../R/73d5130c197cab35.html" target="n" data-glyph="74,1" class="i method">Invoke</a>(<b>object</b> <span id="r317 rd" class="r317 r">target</span>, <b>object</b>[] <span id="r318 rd" class="r318 r">arguments</span>)
        {
            <span class="c">// There may be parameters of ByRef-like types, but they will be taken care of</span>
            <span class="c">// when we resolve overloads to find the best methods -- proper exception will</span>
            <span class="c">// be thrown when converting arguments to the ByRef-like parameter types.</span>
            <span class="c">//</span>
            <span class="c">// So when reaching here, we only care about (1) if the method return type is</span>
            <span class="c">// BeRef-like; (2) if it&#39;s a constrcutor of a ByRef-like type.</span>
 
            <b>if</b> (<a href="#3a0e575988f5a5de" class="i field">method</a> <b>is</b> <span class="i">ConstructorInfo</span> <span id="r319 rd" class="r319 r">ctor</span>)
            {
                <b>if</b> (<span class="r319 r">ctor</span>.<span class="i">DeclaringType</span>.<span class="i">IsByRefLike</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                        <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotInstantiateBoxedByRefLikeType</span>),
                        <span class="i">innerException</span>: <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">CannotInstantiateBoxedByRefLikeType</span>,
                        <span class="r319 r">ctor</span>.<span class="i">DeclaringType</span>);
                }
 
                <b>return</b> <span class="r319 r">ctor</span>.<span class="i">Invoke</span>(<span class="r318 r">arguments</span>);
            }
 
            <b>var</b> <span id="r320 rd" class="r320 r">methodInfo</span> = (<span class="i">MethodInfo</span>)<a href="#3a0e575988f5a5de" class="i field">method</a>;
            <b>if</b> (<span class="r320 r">methodInfo</span>.<span class="i">ReturnType</span>.<span class="i">IsByRefLike</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                    <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotCallMethodWithByRefLikeReturnType</span>),
                    <span class="i">innerException</span>: <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">CannotCallMethodWithByRefLikeReturnType</span>,
                    <span class="r320 r">methodInfo</span>.<span class="i">Name</span>,
                    <span class="r320 r">methodInfo</span>.<span class="i">ReturnType</span>);
            }
 
            <b>if</b> (<span class="r317 r">target</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <b>if</b> (!<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span>.<span class="i">IsAssignableFrom</span>(<span class="r317 r">target</span>.<span class="i">GetType</span>()))
                {
                    <span class="r317 r">target</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r317 r">target</span>);
                }
            }
 
            <b>if</b> (!<a href="#ad66c09deb75109d" class="i field">_useReflection</a>)
            {
                <b>if</b> (<a href="#f124c05977bcb861" class="i field">_methodInvoker</a> == <b>null</b>)
                {
                    <a href="#f124c05977bcb861" class="i field">_methodInvoker</a> = <a href="#76bd3f6912c0ece9" class="i method">GetMethodInvoker</a>(<span class="r320 r">methodInfo</span>);
                }
 
                <b>if</b> (<a href="#f124c05977bcb861" class="i field">_methodInvoker</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#f124c05977bcb861" class="i field">_methodInvoker</a>(<span class="r317 r">target</span>, <span class="r318 r">arguments</span>);
                }
            }
 
            <b>return</b> <a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Invoke</span>(<span class="r317 r">target</span>, <span class="r318 r">arguments</span>);
        }
 
        <b>private static readonly</b> <span class="i">OpCode</span>[] <a id="46554d4739ace54e" href="../R/46554d4739ace54e.html" target="n" data-glyph="46,1" class="i field">s_ldc</a> = <b>new</b> <span class="i">OpCode</span>[] {
            <span class="i">OpCodes</span>.<span class="i">Ldc_I4_0</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_1</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_2</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_3</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_4</span>,
            <span class="i">OpCodes</span>.<span class="i">Ldc_I4_5</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_6</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_7</span>, <span class="i">OpCodes</span>.<span class="i">Ldc_I4_8</span>
        };
 
        <b>private static void</b> <a id="78870586be4c8bae" href="../R/78870586be4c8bae.html" target="n" data-glyph="76,1" class="i method">EmitLdc</a>(<span class="i">ILGenerator</span> <span id="r321 rd" class="r321 r">emitter</span>, <b>int</b> <span id="r322 rd" class="r322 r">c</span>)
        {
            <b>if</b> (<span class="r322 r">c</span> &lt; <a href="#46554d4739ace54e" class="i field">s_ldc</a>.<span class="i">Length</span>)
            {
                <span class="r321 r">emitter</span>.<span class="i">Emit</span>(<a href="#46554d4739ace54e" class="i field">s_ldc</a>[<span class="r322 r">c</span>]);
            }
            <b>else</b>
            {
                <span class="r321 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r322 r">c</span>);
            }
        }
 
        <b>private static bool</b> <a id="e8ed2ee0dbbe3096" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompareMethodParameters</a>(<span class="i">MethodBase</span> <span id="r323 rd" class="r323 r">method1</span>, <span class="i">MethodBase</span> <span id="r324 rd" class="r324 r">method2</span>)
        {
            <span class="i">ParameterInfo</span>[] <span id="r325 rd" class="r325 r">params1</span> = <span class="r323 r">method1</span>.<span class="i">GetParameters</span>();
            <span class="i">ParameterInfo</span>[] <span id="r326 rd" class="r326 r">params2</span> = <span class="r324 r">method2</span>.<span class="i">GetParameters</span>();
 
            <b>if</b> (<span class="r325 r">params1</span>.<span class="i">Length</span> != <span class="r326 r">params2</span>.<span class="i">Length</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>for</b> (<b>int</b> <span id="r327 rd" class="r327 r">i</span> = 0; <span class="r327 r">i</span> &lt; <span class="r325 r">params1</span>.<span class="i">Length</span>; ++<span class="r327 r">i</span>)
            {
                <b>if</b> (<span class="r325 r">params1</span>[<span class="r327 r">i</span>].<span class="i">ParameterType</span> != <span class="r326 r">params2</span>[<span class="r327 r">i</span>].<span class="i">ParameterType</span>)
                {
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static</b> <span class="i">Type</span> <a id="dc792b0f2987f4c1" href="../R/dc792b0f2987f4c1.html" target="n" data-glyph="76,1" class="i method">FindInterfaceForMethod</a>(<span class="i">MethodInfo</span> <span id="r328 rd" class="r328 r">method</span>, <b>out</b> <span class="i">MethodInfo</span> <span id="r329 rd" class="r329 r">methodToCall</span>)
        {
            <span class="r329 r">methodToCall</span> = <b>null</b>;
 
            <span class="i">Type</span> <span id="r330 rd" class="r330 r">valuetype</span> = <span class="r328 r">method</span>.<span class="i">DeclaringType</span>;
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r330 r">valuetype</span>.<span class="i">IsValueType</span>, <span class="s">&quot;This code only works with valuetypes&quot;</span>);
 
            <span class="i">Type</span>[] <span id="r331 rd" class="r331 r">interfaces</span> = <span class="r330 r">valuetype</span>.<span class="i">GetInterfaces</span>();
            <b>for</b> (<b>int</b> <span id="r332 rd" class="r332 r">i</span> = 0; <span class="r332 r">i</span> &lt; <span class="r331 r">interfaces</span>.<span class="i">Length</span>; <span class="r332 r">i</span>++)
            {
                <span class="i">Type</span> <span id="r333 rd" class="r333 r">type</span> = <span class="r331 r">interfaces</span>[<span class="r332 r">i</span>];
                <span class="i">MethodInfo</span> <span id="r334 rd" class="r334 r">methodInfo</span> = <span class="r333 r">type</span>.<span class="i">GetMethod</span>(<span class="r328 r">method</span>.<span class="i">Name</span>, <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
                <b>if</b> (<span class="r334 r">methodInfo</span> != <b>null</b> &amp;&amp; <span class="i">CompareMethodParameters</span>(<span class="r334 r">methodInfo</span>, <span class="r328 r">method</span>))
                {
                    <span class="r329 r">methodToCall</span> = <span class="r334 r">methodInfo</span>;
                    <b>return</b> <span class="r333 r">type</span>;
                }
            }
 
            <span class="c">// TODO: method impls (not especially important because I don&#39;t think they can be called in script.</span>
 
            <b>return</b> <b>null</b>;
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;NullPtr&quot;</span>, <span class="s">&quot;#pw26500&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This is a false positive. Original warning was on the deference of &#39;locals&#39; on line 1863: emitter.Emit(OpCodes.Ldloca, locals[cLocal])&quot;</span>)]
        <b>private</b> <a href="#4818594cc9df7993" class="t t">MethodInvoker</a> <a id="76bd3f6912c0ece9" href="../R/76bd3f6912c0ece9.html" target="n" data-glyph="76,1" class="i method">GetMethodInvoker</a>(<span class="i">MethodInfo</span> <span id="r335 rd" class="r335 r">method</span>)
        {
            <span class="i">Type</span> <span id="r336 rd" class="r336 r">type</span>;
            <b>bool</b> <span id="r337 rd" class="r337 r">valueTypeInstanceMethod</span> = <b>false</b>;
            <b>bool</b> <span id="r338 rd" class="r338 r">anyOutOrRefParameters</span> = <b>false</b>;
            <b>bool</b> <span id="r339 rd" class="r339 r">mustStoreRetVal</span> = <b>false</b>;
            <span class="i">MethodInfo</span> <span id="r340 rd" class="r340 r">methodToCall</span> = <span class="r335 r">method</span>;
            <b>int</b> <span id="r341 rd" class="r341 r">cLocal</span> = 0;
            <b>int</b> <span id="r342 rd" class="r342 r">c</span>;
 
            <span class="i">DynamicMethod</span> <span id="r343 rd" class="r343 r">dynamicMethod</span> = <b>new</b> <span class="i">DynamicMethod</span>(<span class="r335 r">method</span>.<span class="i">Name</span>, <b>typeof</b>(<b>object</b>),
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>object</b>), <b>typeof</b>(<b>object</b>[]) }, <b>typeof</b>(<a href="#88aa0312e9fc25c7" class="t t">Adapter</a>).<span class="i">Module</span>, <b>true</b>);
 
            <span class="i">ILGenerator</span> <span id="r344 rd" class="r344 r">emitter</span> = <span class="r343 r">dynamicMethod</span>.<span class="i">GetILGenerator</span>();
            <span class="i">ParameterInfo</span>[] <span id="r345 rd" class="r345 r">parameters</span> = <span class="r335 r">method</span>.<span class="i">GetParameters</span>();
 
            <b>int</b> <span id="r346 rd" class="r346 r">localCount</span> = 0;
            <b>if</b> (!<span class="r335 r">method</span>.<span class="i">IsStatic</span> &amp;&amp; <span class="r335 r">method</span>.<span class="i">DeclaringType</span>.<span class="i">IsValueType</span>)
            {
                <b>if</b> (!<span class="r335 r">method</span>.<span class="i">IsVirtual</span>)
                {
                    <span class="c">// We need a local to unbox the instance argument into</span>
                    <span class="r337 r">valueTypeInstanceMethod</span> = <b>true</b>;
                    <span class="r346 r">localCount</span> += 1;
                }
            }
 
            <b>for</b> (<b>int</b> <span id="r347 rd" class="r347 r">i</span> = 0; <span class="r347 r">i</span> &lt; <span class="r345 r">parameters</span>.<span class="i">Length</span>; <span class="r347 r">i</span>++)
            {
                <span class="c">// We need locals for any out/ref parameters.  We could get</span>
                <span class="c">// away with avoiding a local if the parameter was &#39;object&#39;,</span>
                <span class="c">// but that optimization is not implemented.</span>
                <b>if</b> (<span class="r345 r">parameters</span>[<span class="r347 r">i</span>].<span class="i">IsOut</span> || <span class="r345 r">parameters</span>[<span class="r347 r">i</span>].<span class="i">ParameterType</span>.<span class="i">IsByRef</span>)
                {
                    <span class="r338 r">anyOutOrRefParameters</span> = <b>true</b>;
                    <span class="r346 r">localCount</span> += 1;
                }
            }
 
            <span class="i">LocalBuilder</span>[] <span id="r348 rd" class="r348 r">locals</span> = <b>null</b>;
            <span class="i">Type</span> <span id="r349 rd" class="r349 r">returnType</span> = <span class="r335 r">method</span>.<span class="i">ReturnType</span>;
            <b>if</b> (<span class="r346 r">localCount</span> &gt; 0)
            {
                <b>if</b> (<span class="r338 r">anyOutOrRefParameters</span> &amp;&amp; <span class="r349 r">returnType</span> != <b>typeof</b>(<b>void</b>))
                {
                    <span class="c">// If there are any ref/out parameters, we set them after the</span>
                    <span class="c">// call.  We can&#39;t leave the return value on the stack (it fails</span>
                    <span class="c">// verification), so we must create a local to hold the return value.</span>
                    <span class="r346 r">localCount</span> += 1;
                    <span class="r339 r">mustStoreRetVal</span> = <b>true</b>;
                }
 
                <span class="r348 r">locals</span> = <b>new</b> <span class="i">LocalBuilder</span>[<span class="r346 r">localCount</span>];
 
                <span class="r341 r">cLocal</span> = 0;
                <b>if</b> (<span class="r337 r">valueTypeInstanceMethod</span>)
                {
                    <span class="c">// Unbox the instance parameter into a local.</span>
                    <span class="r336 r">type</span> = <span class="r335 r">method</span>.<span class="i">DeclaringType</span>;
                    <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>] = <span class="r344 r">emitter</span>.<span class="i">DeclareLocal</span>(<span class="r336 r">type</span>);
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Unbox_Any</span>, <span class="r336 r">type</span>);
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
                    <span class="r341 r">cLocal</span> += 1;
                }
 
                <span class="c">// Copy all arguments that are being passed as out/ref parameters into</span>
                <span class="c">// locals.</span>
                <b>for</b> (<span class="r342 r">c</span> = 0; <span class="r342 r">c</span> &lt; <span class="r345 r">parameters</span>.<span class="i">Length</span>; ++<span class="r342 r">c</span>)
                {
                    <span class="r336 r">type</span> = <span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">ParameterType</span>;
                    <b>if</b> (<span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">IsOut</span> || <span class="r336 r">type</span>.<span class="i">IsByRef</span>)
                    {
                        <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsByRef</span>)
                        {
                            <span class="r336 r">type</span> = <span class="r336 r">type</span>.<span class="i">GetElementType</span>();
                        }
 
                        <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>] = <span class="r344 r">emitter</span>.<span class="i">DeclareLocal</span>(<span class="r336 r">type</span>);
 
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_1</span>);
                        <a href="#78870586be4c8bae" class="i method">EmitLdc</a>(<span class="r344 r">emitter</span>, <span class="r342 r">c</span>);
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldelem_Ref</span>);
                        <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsValueType</span>)
                        {
                            <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Unbox_Any</span>, <span class="r336 r">type</span>);
                        }
                        <b>else</b> <b>if</b> (<span class="r336 r">type</span> != <b>typeof</b>(<b>object</b>))
                        {
                            <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Castclass</span>, <span class="r336 r">type</span>);
                        }
 
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
 
                        <span class="r341 r">cLocal</span> += 1;
                    }
                }
 
                <b>if</b> (<span class="r339 r">mustStoreRetVal</span>)
                {
                    <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>] = <span class="r344 r">emitter</span>.<span class="i">DeclareLocal</span>(<span class="r349 r">returnType</span>);
                }
            }
 
            <span class="r341 r">cLocal</span> = 0;
            <b>if</b> (!<span class="r335 r">method</span>.<span class="i">IsStatic</span>)
            {
                <span class="c">// Load the &quot;instance&quot; argument.</span>
                <b>if</b> (<span class="r335 r">method</span>.<span class="i">DeclaringType</span>.<span class="i">IsValueType</span>)
                {
                    <b>if</b> (<span class="r335 r">method</span>.<span class="i">IsVirtual</span>)
                    {
                        <span class="r336 r">type</span> = <a href="#dc792b0f2987f4c1" class="i method">FindInterfaceForMethod</a>(<span class="r335 r">method</span>, <b>out</b> <span class="r340 r">methodToCall</span>);
                        <b>if</b> (<span class="r336 r">type</span> == <b>null</b>)
                        {
                            <a href="#ad66c09deb75109d" class="i field">_useReflection</a> = <b>true</b>;
                            <b>return</b> <b>null</b>;
                        }
 
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Castclass</span>, <span class="r336 r">type</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloca</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
                        <span class="r341 r">cLocal</span> += 1;
                    }
                }
                <b>else</b>
                {
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
                }
            }
 
            <b>for</b> (<span class="r342 r">c</span> = 0; <span class="r342 r">c</span> &lt; <span class="r345 r">parameters</span>.<span class="i">Length</span>; <span class="r342 r">c</span>++)
            {
                <span class="r336 r">type</span> = <span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">ParameterType</span>;
                <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsByRef</span>)
                {
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloca</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
                    <span class="r341 r">cLocal</span> += 1;
                }
                <b>else</b> <b>if</b> (<span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">IsOut</span>)
                {
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
                    <span class="r341 r">cLocal</span> += 1;
                }
                <b>else</b>
                {
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_1</span>);
                    <a href="#78870586be4c8bae" class="i method">EmitLdc</a>(<span class="r344 r">emitter</span>, <span class="r342 r">c</span>);
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldelem_Ref</span>);
 
                    <span class="c">// Unbox value types since our args array is full of objects</span>
                    <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsValueType</span>)
                    {
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Unbox_Any</span>, <span class="r336 r">type</span>);
                    }
                    <span class="c">// For reference types, cast from object</span>
                    <b>else</b> <b>if</b> (<span class="r336 r">type</span> != <b>typeof</b>(<b>object</b>))
                    {
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Castclass</span>, <span class="r336 r">type</span>);
                    }
                }
            }
 
            <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="r335 r">method</span>.<span class="i">IsStatic</span> ? <span class="i">OpCodes</span>.<span class="i">Call</span> : <span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r340 r">methodToCall</span>);
 
            <b>if</b> (<span class="r339 r">mustStoreRetVal</span>)
            {
                <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stloc</span>, <span class="r348 r">locals</span>[<span class="r348 r">locals</span>.<span class="i">Length</span> - 1]);
            }
 
            <span class="c">// Handle the ref/out arguments by copying the locals</span>
            <span class="c">// back into the original args array</span>
            <b>if</b> (<span class="r338 r">anyOutOrRefParameters</span>)
            {
                <span class="r341 r">cLocal</span> = <span class="r337 r">valueTypeInstanceMethod</span> ? 1 : 0;
                <b>for</b> (<span class="r342 r">c</span> = 0; <span class="r342 r">c</span> &lt; <span class="r345 r">parameters</span>.<span class="i">Length</span>; <span class="r342 r">c</span>++)
                {
                    <span class="r336 r">type</span> = <span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">ParameterType</span>;
                    <b>if</b> (!<span class="r345 r">parameters</span>[<span class="r342 r">c</span>].<span class="i">IsOut</span> &amp;&amp; !<span class="r336 r">type</span>.<span class="i">IsByRef</span>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsByRef</span>)
                    {
                        <span class="r336 r">type</span> = <span class="r336 r">type</span>.<span class="i">GetElementType</span>();
                    }
 
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_1</span>);
                    <a href="#78870586be4c8bae" class="i method">EmitLdc</a>(<span class="r344 r">emitter</span>, <span class="r342 r">c</span>);
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r348 r">locals</span>[<span class="r341 r">cLocal</span>]);
 
                    <span class="c">// Again, box value types since the args array holds objects</span>
                    <b>if</b> (<span class="r336 r">type</span>.<span class="i">IsValueType</span>)
                    {
                        <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r336 r">type</span>);
                    }
 
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stelem_Ref</span>);
                    <span class="r341 r">cLocal</span> += 1;
                }
            }
 
            <span class="c">// We must return something, so return null for void methods</span>
            <b>if</b> (<span class="r349 r">returnType</span> == <b>typeof</b>(<b>void</b>))
            {
                <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldnull</span>);
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r339 r">mustStoreRetVal</span>)
                {
                    <span class="c">// Return value was stored in a local, load it before return</span>
                    <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc</span>, <span class="r348 r">locals</span>[<span class="r348 r">locals</span>.<span class="i">Length</span> - 1]);
                }
 
                <a href="#88aa0312e9fc25c7" class="t t">Adapter</a>.<a href="#9d08e929dff5fc8e" class="i method">DoBoxingIfNecessary</a>(<span class="r344 r">emitter</span>, <span class="r349 r">returnType</span>);
            }
 
            <span class="r344 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
            <b>return</b> (<a href="#4818594cc9df7993" class="t t">MethodInvoker</a>)<span class="r343 r">dynamicMethod</span>.<span class="i">CreateDelegate</span>(<b>typeof</b>(<a href="#4818594cc9df7993" class="t t">MethodInvoker</a>));
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Stores parameter related information.</span>
    <span class="c">///</span><span class="c"> This structure should be used whenever a new type is adapted.</span>
    <span class="c">///</span><span class="c"> For example, ManagementObjectAdapter uses this structure to store</span>
    <span class="c">///</span><span class="c"> method parameter information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="d694ba38a24d6665" href="../R/d694ba38a24d6665.html" target="n" data-glyph="2,0" class="t t">ParameterInformation</a>
    {
        <b>internal</b> <span class="i">Type</span> <a id="0403f9d43449a337" href="../R/0403f9d43449a337.html" target="n" data-glyph="44,1" class="i field">parameterType</a>;
        <b>internal object</b> <a id="0a1e0cc0fb6858d5" href="../R/0a1e0cc0fb6858d5.html" target="n" data-glyph="44,1" class="i field">defaultValue</a>;
        <b>internal bool</b> <a id="99334ea28bdc3021" href="../R/99334ea28bdc3021.html" target="n" data-glyph="44,1" class="i field">isOptional</a>;
        <b>internal bool</b> <a id="682d6e36c933d06b" href="../R/682d6e36c933d06b.html" target="n" data-glyph="44,1" class="i field">isByRef</a>;
        <b>internal bool</b> <a id="4041f05f1648e314" href="../R/4041f05f1648e314.html" target="n" data-glyph="44,1" class="i field">isParamArray</a>;
 
        <b>internal</b> <a id="a9e0f45035c4666e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ParameterInformation</a>(<span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">ParameterInfo</span> <span id="r350 rd" class="r350 r">parameter</span>)
        {
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#99334ea28bdc3021" class="i field">isOptional</a> = <span class="r350 r">parameter</span>.<span class="i">IsOptional</span>;
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0a1e0cc0fb6858d5" class="i field">defaultValue</a> = <span class="r350 r">parameter</span>.<span class="i">DefaultValue</span>;
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0403f9d43449a337" class="i field">parameterType</a> = <span class="r350 r">parameter</span>.<span class="i">ParameterType</span>;
            <b>if</b> (<a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">IsByRef</span>)
            {
                <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#682d6e36c933d06b" class="i field">isByRef</a> = <b>true</b>;
                <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0403f9d43449a337" class="i field">parameterType</a> = <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0403f9d43449a337" class="i field">parameterType</a>.<span class="i">GetElementType</span>();
            }
            <b>else</b>
            {
                <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#682d6e36c933d06b" class="i field">isByRef</a> = <b>false</b>;
            }
        }
 
        <b>internal</b> <a id="7a11dae9f7ce6a9f" href="../R/7a11dae9f7ce6a9f.html" target="n" data-glyph="74,1" class="t constructor">ParameterInformation</a>(<span class="i">Type</span> <span id="r351 rd" class="r351 r">parameterType</span>, <b>bool</b> <span id="r352 rd" class="r352 r">isOptional</span>, <b>object</b> <span id="r353 rd" class="r353 r">defaultValue</span>, <b>bool</b> <span id="r354 rd" class="r354 r">isByRef</span>)
        {
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0403f9d43449a337" class="i field">parameterType</a> = <span class="r351 r">parameterType</span>;
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#99334ea28bdc3021" class="i field">isOptional</a> = <span class="r352 r">isOptional</span>;
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#0a1e0cc0fb6858d5" class="i field">defaultValue</a> = <span class="r353 r">defaultValue</span>;
            <a href="#d694ba38a24d6665" class="k">this</a>.<a href="#682d6e36c933d06b" class="i field">isByRef</a> = <span class="r354 r">isByRef</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is the adapter used for all objects that don&#39;t match the appropriate types for other adapters.</span>
    <span class="c">///</span><span class="c"> It uses reflection to retrieve property information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="27353615475f6dbc" href="../R/27353615475f6dbc.html" target="n" data-glyph="2,0" class="t t">DotNetAdapter</a> : <a href="#88aa0312e9fc25c7" class="t t">Adapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> auxiliary methods and classes
 
        <b>private const</b> <span class="i">BindingFlags</span> <a id="7381d4fd39afd10e" href="../R/7381d4fd39afd10e.html" target="n" data-glyph="10,1" class="i field">instanceBindingFlags</a> = (<span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> |
                                                              <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
 
        <b>private const</b> <span class="i">BindingFlags</span> <a id="71463d1c978c63f7" href="../R/71463d1c978c63f7.html" target="n" data-glyph="10,1" class="i field">staticBindingFlags</a> = (<span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> |
                                                              <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span>);
 
        <b>private readonly bool</b> <a id="aa537ca690ae70b3" href="../R/aa537ca690ae70b3.html" target="n" data-glyph="46,1" class="i field">_isStatic</a>;
 
        <b>internal</b> <a id="6658f94fd5929609" href="../R/6658f94fd5929609.html" target="n" data-glyph="74,1" class="t constructor">DotNetAdapter</a>() { }
 
        <b>internal</b> <a id="50a27efb3848aebe" href="../R/50a27efb3848aebe.html" target="n" data-glyph="74,1" class="t constructor">DotNetAdapter</a>(<b>bool</b> <span id="r355 rd" class="r355 r">isStatic</span>)
        {
            <a href="#aa537ca690ae70b3" class="i field">_isStatic</a> = <span class="r355 r">isStatic</span>;
        }
 
        <span class="c">// This static is thread safe based on the lock in GetInstancePropertyReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection property cache for instance properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt; <a id="860819c380846600" href="../R/860819c380846600.html" target="n" data-glyph="46,1" class="i field">s_instancePropertyCacheTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt;();
 
        <span class="c">// This static is thread safe based on the lock in GetStaticPropertyReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection property cache for static properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt; <a id="518436f5c83529b7" href="../R/518436f5c83529b7.html" target="n" data-glyph="46,1" class="i field">s_staticPropertyCacheTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt;();
 
        <span class="c">// This static is thread safe based on the lock in GetInstanceMethodReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection method cache for instance methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt; <a id="0b48fd87c3602a9d" href="../R/0b48fd87c3602a9d.html" target="n" data-glyph="46,1" class="i field">s_instanceMethodCacheTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt;();
 
        <span class="c">// This static is thread safe based on the lock in GetStaticMethodReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection method cache for static methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt; <a id="4ecaae4c3873ff15" href="../R/4ecaae4c3873ff15.html" target="n" data-glyph="46,1" class="i field">s_staticMethodCacheTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a>&gt;();
 
        <span class="c">// This static is thread safe based on the lock in GetInstanceMethodReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection method cache for instance events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;&gt; <a id="786174010c889c04" href="../R/786174010c889c04.html" target="n" data-glyph="46,1" class="i field">s_instanceEventCacheTable</a>
            = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;&gt;();
 
        <span class="c">// This static is thread safe based on the lock in GetStaticMethodReflectionTable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR reflection method cache for static events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;&gt; <a id="415f898d49bfe080" href="../R/415f898d49bfe080.html" target="n" data-glyph="46,1" class="i field">s_staticEventCacheTable</a>
            = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;&gt;();
 
        <b>internal class</b> <a id="6dfefa2e34e759ac" href="../R/6dfefa2e34e759ac.html" target="n" data-glyph="2,1" class="t t">MethodCacheEntry</a> : <a href="#fc6f71826b2098c0" class="t t">CacheEntry</a>
        {
            <b>internal readonly</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <a id="faf234dfe054f8ec" href="../R/faf234dfe054f8ec.html" target="n" data-glyph="44,2" class="i field">methodInformationStructures</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Cache delegate to the ctor of PSMethod</span><span class="c">&amp;lt;</span><span class="c">&amp;gt;</span><span class="c"> with a template parameter derived from the methodInformationStructures.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">Func</span>&lt;<b>string</b>, <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>, <b>object</b>, <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>, <b>bool</b>, <b>bool</b>, <a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>&gt; <a id="d6871a33608efb06" href="../R/d6871a33608efb06.html" target="n" data-glyph="44,2" class="i field">PSMethodCtor</a>;
 
            <b>internal</b> <a id="3ec9dbcac6751f6e" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">MethodCacheEntry</a>(<span class="i">IList</span>&lt;<span class="i">MethodBase</span>&gt; <span id="r356 rd" class="r356 r">methods</span>)
            {
                <a href="#faf234dfe054f8ec" class="i field">methodInformationStructures</a> = <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#7e648f9d6be8ddd7" class="i method">GetMethodInformationArray</a>(<span class="r356 r">methods</span>);
            }
 
            <b>internal</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="19b4cce66b970b07" href="../R/../../0000000000.html" target="n" data-glyph="104,2" class="k">this</a>[<b>int</b> <span id="r357 rd" class="r357 r">i</span>]
            {
                <b>get</b>
                {
                    <b>return</b> <a href="#faf234dfe054f8ec" class="i field">methodInformationStructures</a>[<span class="r357 r">i</span>];
                }
            }
 
            <b>private bool</b>? <a id="8021b07d37fbc6ec" href="../R/8021b07d37fbc6ec.html" target="n" data-glyph="46,2" class="i field">_isHidden</a>;
 
            <b>internal override bool</b> <a id="0ea51ae745f80f8f" href="../R/0ea51ae745f80f8f.html" target="n" data-glyph="104,2" class="i property">IsHidden</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#8021b07d37fbc6ec" class="i field">_isHidden</a> == <b>null</b>)
                    {
                        <b>bool</b> <span id="r358 rd" class="r358 r">hasHiddenAttribute</span> = <b>false</b>;
                        <b>foreach</b> (<a href="#8ae0c30e474b7c1e" class="k">var</a> <span id="r359 rd" class="r359 r">method</span> <b>in</b> <a href="#faf234dfe054f8ec" class="i field">methodInformationStructures</a>)
                        {
                            <b>if</b> (<span class="r359 r">method</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<a href="Attributes.cs.html#95fc557737f7107e" class="t t">HiddenAttribute</a>), <span class="i">inherit</span>: <b>false</b>).<span class="i">Length</span> != 0)
                            {
                                <span class="r358 r">hasHiddenAttribute</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
 
                        <a href="#8021b07d37fbc6ec" class="i field">_isHidden</a> = <span class="r358 r">hasHiddenAttribute</span>;
                    }
 
                    <b>return</b> <a href="#8021b07d37fbc6ec" class="i field">_isHidden</a>.<span class="i">Value</span>;
                }
            }
        }
 
        <b>internal class</b> <a id="e16698b66376e45c" href="../R/e16698b66376e45c.html" target="n" data-glyph="2,1" class="t t">EventCacheEntry</a> : <a href="#fc6f71826b2098c0" class="t t">CacheEntry</a>
        {
            <b>internal</b> <span class="i">EventInfo</span>[] <a id="8bbce5d69faf0ef1" href="../R/8bbce5d69faf0ef1.html" target="n" data-glyph="44,2" class="i field">events</a>;
 
            <b>internal</b> <a id="3a7bf84215241b6b" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">EventCacheEntry</a>(<span class="i">EventInfo</span>[] <span id="r360 rd" class="r360 r">events</span>)
            {
                <a href="#e16698b66376e45c" class="k">this</a>.<a href="#8bbce5d69faf0ef1" class="i field">events</a> = <span class="r360 r">events</span>;
            }
        }
 
        <b>internal class</b> <a id="f4ae97dd9b847d8b" href="../R/f4ae97dd9b847d8b.html" target="n" data-glyph="2,1" class="t t">ParameterizedPropertyCacheEntry</a> : <a href="#fc6f71826b2098c0" class="t t">CacheEntry</a>
        {
            <b>internal</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <a id="286d5059f2e36343" href="../R/286d5059f2e36343.html" target="n" data-glyph="44,2" class="i field">getterInformation</a>;
            <b>internal</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <a id="88a36133c0dc84ef" href="../R/88a36133c0dc84ef.html" target="n" data-glyph="44,2" class="i field">setterInformation</a>;
            <b>internal string</b> <a id="b342cdcccf025067" href="../R/b342cdcccf025067.html" target="n" data-glyph="44,2" class="i field">propertyName</a>;
            <b>internal bool</b> <a id="6587d647fcc65895" href="../R/6587d647fcc65895.html" target="n" data-glyph="44,2" class="i field">readOnly</a>;
            <b>internal bool</b> <a id="87ee699bf94c0126" href="../R/87ee699bf94c0126.html" target="n" data-glyph="44,2" class="i field">writeOnly</a>;
            <b>internal</b> <span class="i">Type</span> <a id="38808cd96083abb0" href="../R/38808cd96083abb0.html" target="n" data-glyph="44,2" class="i field">propertyType</a>;
            <span class="c">// propertyDefinition is used as a string representation of the property</span>
            <b>internal string</b>[] <a id="0d623e7cee7e8743" href="../R/0d623e7cee7e8743.html" target="n" data-glyph="44,2" class="i field">propertyDefinition</a>;
 
            <b>internal</b> <a id="2f8ee681dbcba09b" href="../R/2f8ee681dbcba09b.html" target="n" data-glyph="74,2" class="t constructor">ParameterizedPropertyCacheEntry</a>(<span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r361 rd" class="r361 r">properties</span>)
            {
                <span class="i">PropertyInfo</span> <span id="r362 rd" class="r362 r">firstProperty</span> = <span class="r361 r">properties</span>[0];
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#b342cdcccf025067" class="i field">propertyName</a> = <span class="r362 r">firstProperty</span>.<span class="i">Name</span>;
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#38808cd96083abb0" class="i field">propertyType</a> = <span class="r362 r">firstProperty</span>.<span class="i">PropertyType</span>;
                <b>var</b> <span id="r363 rd" class="r363 r">getterList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MethodInfo</span>&gt;();
                <b>var</b> <span id="r364 rd" class="r364 r">setterList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MethodInfo</span>&gt;();
                <b>var</b> <span id="r365 rd" class="r365 r">definitionArray</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <b>for</b> (<b>int</b> <span id="r366 rd" class="r366 r">i</span> = 0; <span class="r366 r">i</span> &lt; <span class="r361 r">properties</span>.<span class="i">Count</span>; <span class="r366 r">i</span>++)
                {
                    <span class="i">PropertyInfo</span> <span id="r367 rd" class="r367 r">property</span> = <span class="r361 r">properties</span>[<span class="r366 r">i</span>];
                    <span class="c">// Properties can have different return types. If they do</span>
                    <span class="c">// we pretend it is System.Object</span>
                    <b>if</b> (<span class="r367 r">property</span>.<span class="i">PropertyType</span> != <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#38808cd96083abb0" class="i field">propertyType</a>)
                    {
                        <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#38808cd96083abb0" class="i field">propertyType</a> = <b>typeof</b>(<b>object</b>);
                    }
 
                    <span class="c">// Get the public getter</span>
                    <span class="i">MethodInfo</span> <span id="r368 rd" class="r368 r">propertyGetter</span> = <span class="r367 r">property</span>.<span class="i">GetGetMethod</span>();
                    <span class="i">StringBuilder</span> <span id="r369 rd" class="r369 r">definition</span> = <b>new</b> <span class="i">StringBuilder</span>();
                    <span class="i">StringBuilder</span> <span id="r370 rd" class="r370 r">extraDefinition</span> = <b>new</b> <span class="i">StringBuilder</span>();
                    <b>if</b> (<span class="r368 r">propertyGetter</span> != <b>null</b>)
                    {
                        <span class="r370 r">extraDefinition</span>.<span class="i">Append</span>(<span class="s">&quot;get;&quot;</span>);
                        <span class="r369 r">definition</span>.<span class="i">Append</span>(<a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<span class="i">GetMethodInfoOverloadDefinition</span>(<a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#b342cdcccf025067" class="i field">propertyName</a>, <span class="r368 r">propertyGetter</span>, 0));
                        <span class="r363 r">getterList</span>.<span class="i">Add</span>(<span class="r368 r">propertyGetter</span>);
                    }
 
                    <span class="c">// Get the public setter</span>
                    <span class="i">MethodInfo</span> <span id="r371 rd" class="r371 r">propertySetter</span> = <span class="r367 r">property</span>.<span class="i">GetSetMethod</span>();
                    <b>if</b> (<span class="r371 r">propertySetter</span> != <b>null</b>)
                    {
                        <span class="r370 r">extraDefinition</span>.<span class="i">Append</span>(<span class="s">&quot;set;&quot;</span>);
                        <b>if</b> (<span class="r369 r">definition</span>.<span class="i">Length</span> == 0)
                        {
                            <span class="r369 r">definition</span>.<span class="i">Append</span>(<a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<span class="i">GetMethodInfoOverloadDefinition</span>(<a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#b342cdcccf025067" class="i field">propertyName</a>, <span class="r371 r">propertySetter</span>, 1));
                        }
 
                        <span class="r364 r">setterList</span>.<span class="i">Add</span>(<span class="r371 r">propertySetter</span>);
                    }
 
                    <span class="r369 r">definition</span>.<span class="i">Append</span>(<span class="s">&quot; {&quot;</span>);
                    <span class="r369 r">definition</span>.<span class="i">Append</span>(<span class="r370 r">extraDefinition</span>);
                    <span class="r369 r">definition</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
                    <span class="r365 r">definitionArray</span>.<span class="i">Add</span>(<span class="r369 r">definition</span>.<span class="i">ToString</span>());
                }
 
                <a href="#0d623e7cee7e8743" class="i field">propertyDefinition</a> = <span class="r365 r">definitionArray</span>.<span class="i">ToArray</span>();
 
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#87ee699bf94c0126" class="i field">writeOnly</a> = <span class="r363 r">getterList</span>.<span class="i">Count</span> == 0;
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#6587d647fcc65895" class="i field">readOnly</a> = <span class="r364 r">setterList</span>.<span class="i">Count</span> == 0;
 
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#286d5059f2e36343" class="i field">getterInformation</a> = <b>new</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[<span class="r363 r">getterList</span>.<span class="i">Count</span>];
                <b>for</b> (<b>int</b> <span id="r372 rd" class="r372 r">i</span> = 0; <span class="r372 r">i</span> &lt; <span class="r363 r">getterList</span>.<span class="i">Count</span>; <span class="r372 r">i</span>++)
                {
                    <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#286d5059f2e36343" class="i field">getterInformation</a>[<span class="r372 r">i</span>] = <b>new</b> <span class="t">MethodInformation</span>(<span class="r363 r">getterList</span>[<span class="r372 r">i</span>], 0);
                }
 
                <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#88a36133c0dc84ef" class="i field">setterInformation</a> = <b>new</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[<span class="r364 r">setterList</span>.<span class="i">Count</span>];
                <b>for</b> (<b>int</b> <span id="r373 rd" class="r373 r">i</span> = 0; <span class="r373 r">i</span> &lt; <span class="r364 r">setterList</span>.<span class="i">Count</span>; <span class="r373 r">i</span>++)
                {
                    <a href="#f4ae97dd9b847d8b" class="k">this</a>.<a href="#88a36133c0dc84ef" class="i field">setterInformation</a>[<span class="r373 r">i</span>] = <b>new</b> <span class="t">MethodInformation</span>(<span class="r364 r">setterList</span>[<span class="r373 r">i</span>], 1);
                }
            }
        }
 
        <b>internal class</b> <a id="e42273e13efeb8a7" href="../R/e42273e13efeb8a7.html" target="n" data-glyph="2,1" class="t t">PropertyCacheEntry</a> : <a href="#fc6f71826b2098c0" class="t t">CacheEntry</a>
        {
            <b>internal delegate object</b> <a id="0cb9958b15ce51ef" href="../R/0cb9958b15ce51ef.html" target="n" data-glyph="14,2" class="t t"><span id="7ce0b6622670965a">GetterDelegate</span></a>(<b>object</b> <span id="r374 rd" class="r374 r">instance</span>);
 
            <b>internal delegate void</b> <a id="b810cce9e211f7f8" href="../R/b810cce9e211f7f8.html" target="n" data-glyph="14,2" class="t t"><span id="cb0ca929c54af977">SetterDelegate</span></a>(<b>object</b> <span id="r375 rd" class="r375 r">instance</span>, <b>object</b> <span id="r376 rd" class="r376 r">setValue</span>);
 
            <b>internal</b> <a id="062ddd336e6b2596" href="../R/062ddd336e6b2596.html" target="n" data-glyph="74,2" class="t constructor">PropertyCacheEntry</a>(<span class="i">PropertyInfo</span> <span id="r377 rd" class="r377 r">property</span>)
            {
                <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#588c19f161433e56" class="i field">member</a> = <span class="r377 r">property</span>;
                <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#46125476611507e4" class="i field">propertyType</a> = <span class="r377 r">property</span>.<span class="i">PropertyType</span>;
                <span class="c">// Generating code for fields/properties in ValueTypes is complex and will probably</span>
                <span class="c">// require different delegates</span>
                <span class="c">// The same is true for generics, COM Types.</span>
                <span class="i">Type</span> <span id="r378 rd" class="r378 r">declaringType</span> = <span class="r377 r">property</span>.<span class="i">DeclaringType</span>;
 
                <b>if</b> (<span class="r378 r">declaringType</span>.<span class="i">IsValueType</span> ||
                    <a href="#46125476611507e4" class="i field">propertyType</a>.<span class="i">IsGenericType</span> ||
                    <span class="r378 r">declaringType</span>.<span class="i">IsGenericType</span> ||
                    <span class="r378 r">declaringType</span>.<span class="i">IsCOMObject</span> ||
                    <a href="#46125476611507e4" class="i field">propertyType</a>.<span class="i">IsCOMObject</span>)
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#93842d04ef458a61" class="i field">readOnly</a> = <span class="r377 r">property</span>.<span class="i">GetSetMethod</span>() == <b>null</b>;
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#1dd2f357ccb290c0" class="i field">writeOnly</a> = <span class="r377 r">property</span>.<span class="i">GetGetMethod</span>() == <b>null</b>;
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#3d8e849eefab9a49" class="i field">useReflection</a> = <b>true</b>;
                    <b>return</b>;
                }
 
                <span class="c">// Get the public or protected getter</span>
                <span class="i">MethodInfo</span> <span id="r379 rd" class="r379 r">propertyGetter</span> = <span class="r377 r">property</span>.<span class="i">GetGetMethod</span>(<b>true</b>);
                <b>if</b> (<span class="r379 r">propertyGetter</span> != <b>null</b> &amp;&amp; (<span class="r379 r">propertyGetter</span>.<span class="i">IsPublic</span> || <span class="r379 r">propertyGetter</span>.<span class="i">IsFamily</span>))
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a> = <span class="r379 r">propertyGetter</span>.<span class="i">IsStatic</span>;
                    <span class="c">// Delegate is initialized later to avoid jit if it&#39;s not called</span>
                }
                <b>else</b>
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#1dd2f357ccb290c0" class="i field">writeOnly</a> = <b>true</b>;
                }
 
                <span class="c">// Get the public or protected setter</span>
                <span class="i">MethodInfo</span> <span id="r380 rd" class="r380 r">propertySetter</span> = <span class="r377 r">property</span>.<span class="i">GetSetMethod</span>(<b>true</b>);
                <b>if</b> (<span class="r380 r">propertySetter</span> != <b>null</b> &amp;&amp; (<span class="r380 r">propertySetter</span>.<span class="i">IsPublic</span> || <span class="r380 r">propertySetter</span>.<span class="i">IsFamily</span>))
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a> = <span class="r380 r">propertySetter</span>.<span class="i">IsStatic</span>;
                }
                <b>else</b>
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#93842d04ef458a61" class="i field">readOnly</a> = <b>true</b>;
                }
            }
 
            <b>internal</b> <a id="e2913351242647ed" href="../R/e2913351242647ed.html" target="n" data-glyph="74,2" class="t constructor">PropertyCacheEntry</a>(<span class="i">FieldInfo</span> <span id="r381 rd" class="r381 r">field</span>)
            {
                <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#588c19f161433e56" class="i field">member</a> = <span class="r381 r">field</span>;
                <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a> = <span class="r381 r">field</span>.<span class="i">IsStatic</span>;
                <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#46125476611507e4" class="i field">propertyType</a> = <span class="r381 r">field</span>.<span class="i">FieldType</span>;
 
                <span class="c">// const fields have no setter and we are getting them with GetValue instead of</span>
                <span class="c">// using generated code. Init fields are only settable during initialization</span>
                <span class="c">// then cannot be set afterwards..</span>
                <b>if</b> (<span class="r381 r">field</span>.<span class="i">IsLiteral</span> || <span class="r381 r">field</span>.<span class="i">IsInitOnly</span>)
                {
                    <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#93842d04ef458a61" class="i field">readOnly</a> = <b>true</b>;
                }
            }
 
            <b>private void</b> <a id="934985170b8e0272" href="../R/934985170b8e0272.html" target="n" data-glyph="76,2" class="i method">InitGetter</a>()
            {
                <b>if</b> (<a href="#1dd2f357ccb290c0" class="i field">writeOnly</a> || <a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
                {
                    <b>return</b>;
                }
 
                <b>var</b> <span id="r382 rd" class="r382 r">parameter</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<b>object</b>));
                <span class="i">Expression</span> <span id="r383 rd" class="r383 r">instance</span> = <b>null</b>;
 
                <b>var</b> <span id="r384 rd" class="r384 r">field</span> = <a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">FieldInfo</span>;
                <b>if</b> (<span class="r384 r">field</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r385 rd" class="r385 r">declaringType</span> = <span class="r384 r">field</span>.<span class="i">DeclaringType</span>;
                    <b>if</b> (!<span class="r384 r">field</span>.<span class="i">IsStatic</span>)
                    {
                        <b>if</b> (<span class="r385 r">declaringType</span>.<span class="i">IsValueType</span>)
                        {
                            <span class="c">// I&#39;m not sure we can get here with a Nullable, but if so,</span>
                            <span class="c">// we must use the Value property, see PSGetMemberBinder.GetTargetValue.</span>
                            <span class="r383 r">instance</span> = <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r385 r">declaringType</span>) != <b>null</b>
                                ? (<span class="i">Expression</span>)<span class="i">Expression</span>.<span class="i">Property</span>(<span class="r382 r">parameter</span>, <span class="s">&quot;Value&quot;</span>)
                                : <span class="i">Expression</span>.<span class="i">Unbox</span>(<span class="r382 r">parameter</span>, <span class="r385 r">declaringType</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r383 r">instance</span> = <span class="r382 r">parameter</span>.<span class="i">Cast</span>(<span class="r385 r">declaringType</span>);
                        }
                    }
 
                    <span class="i">Expression</span> <span id="r386 rd" class="r386 r">getterExpr</span>;
 
                    <b>if</b> (<span class="r385 r">declaringType</span>.<span class="i">IsGenericTypeDefinition</span>)
                    {
                        <span class="i">Expression</span> <span id="r387 rd" class="r387 r">innerException</span> = <span class="i">Expression</span>.<span class="i">New</span>(<a href="parser/Compiler.cs.html#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="parser/Compiler.cs.html#f8342ce08ab7434c" class="i field">GetValueException_ctor</a>,
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="s">&quot;PropertyGetException&quot;</span>),
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Exception</span>)),
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">ParserStrings</span>.<span class="i">PropertyInGenericType</span>),
                            <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r384 r">field</span>.<span class="i">Name</span>)));
                        <span class="r386 r">getterExpr</span> = <a href="parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">ThrowRuntimeErrorWithInnerException</span>(<span class="s">&quot;PropertyGetException&quot;</span>,
                                                                          <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">ParserStrings</span>.<span class="i">PropertyInGenericType</span>),
                                                                          <span class="r387 r">innerException</span>, <b>typeof</b>(<b>object</b>), <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r384 r">field</span>.<span class="i">Name</span>));
                    }
                    <b>else</b>
                    {
                        <span class="r386 r">getterExpr</span> = <span class="i">Expression</span>.<span class="i">Field</span>(<span class="r383 r">instance</span>, <span class="r384 r">field</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>));
                    }
 
                    <a href="#7c66a1c2a04f7c69" class="i field">_getterDelegate</a> = <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<a href="#0cb9958b15ce51ef" class="t t">GetterDelegate</a>&gt;(<span class="r386 r">getterExpr</span>, <span class="r382 r">parameter</span>).<span class="i">Compile</span>();
                    <b>return</b>;
                }
 
                <b>var</b> <span id="r388 rd" class="r388 r">property</span> = (<span class="i">PropertyInfo</span>)<a href="#588c19f161433e56" class="i field">member</a>;
                <b>var</b> <span id="r389 rd" class="r389 r">propertyGetter</span> = <span class="r388 r">property</span>.<span class="i">GetGetMethod</span>(<b>true</b>);
 
                <span class="r383 r">instance</span> = <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a> ? <b>null</b> : <span class="r382 r">parameter</span>.<span class="i">Cast</span>(<span class="r389 r">propertyGetter</span>.<span class="i">DeclaringType</span>);
                <a href="#7c66a1c2a04f7c69" class="i field">_getterDelegate</a> = <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<a href="#0cb9958b15ce51ef" class="t t">GetterDelegate</a>&gt;(
                    <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r383 r">instance</span>, <span class="r388 r">property</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)), <span class="r382 r">parameter</span>).<span class="i">Compile</span>();
            }
 
            <b>private void</b> <a id="a592470f2c3f1d28" href="../R/a592470f2c3f1d28.html" target="n" data-glyph="76,2" class="i method">InitSetter</a>()
            {
                <b>if</b> (<a href="#93842d04ef458a61" class="i field">readOnly</a> || <a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
                {
                    <b>return</b>;
                }
 
                <b>var</b> <span id="r390 rd" class="r390 r">parameter</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<b>object</b>));
                <b>var</b> <span id="r391 rd" class="r391 r">value</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<b>object</b>));
                <span class="i">Expression</span> <span id="r392 rd" class="r392 r">instance</span> = <b>null</b>;
 
                <b>var</b> <span id="r393 rd" class="r393 r">field</span> = <a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">FieldInfo</span>;
                <b>if</b> (<span class="r393 r">field</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r394 rd" class="r394 r">declaringType</span> = <span class="r393 r">field</span>.<span class="i">DeclaringType</span>;
                    <b>if</b> (!<span class="r393 r">field</span>.<span class="i">IsStatic</span>)
                    {
                        <b>if</b> (<span class="r394 r">declaringType</span>.<span class="i">IsValueType</span>)
                        {
                            <span class="c">// I&#39;m not sure we can get here with a Nullable, but if so,</span>
                            <span class="c">// we must use the Value property, see PSGetMemberBinder.GetTargetValue.</span>
                            <span class="r392 r">instance</span> = <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r394 r">declaringType</span>) != <b>null</b>
                                ? (<span class="i">Expression</span>)<span class="i">Expression</span>.<span class="i">Property</span>(<span class="r390 r">parameter</span>, <span class="s">&quot;Value&quot;</span>)
                                : <span class="i">Expression</span>.<span class="i">Unbox</span>(<span class="r390 r">parameter</span>, <span class="r394 r">declaringType</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r392 r">instance</span> = <span class="r390 r">parameter</span>.<span class="i">Cast</span>(<span class="r394 r">declaringType</span>);
                        }
                    }
 
                    <span class="i">Expression</span> <span id="r395 rd" class="r395 r">setterExpr</span>;
                    <b>string</b> <span id="r396 rd" class="r396 r">errMessage</span> = <b>null</b>;
                    <span class="i">Type</span> <span id="r397 rd" class="r397 r">errType</span> = <span class="r393 r">field</span>.<span class="i">FieldType</span>;
                    <b>if</b> (<span class="r394 r">declaringType</span>.<span class="i">IsGenericTypeDefinition</span>)
                    {
                        <span class="r396 r">errMessage</span> = <span class="i">ParserStrings</span>.<span class="i">PropertyInGenericType</span>;
                        <b>if</b> (<span class="r397 r">errType</span>.<span class="i">ContainsGenericParameters</span>)
                        {
                            <span class="r397 r">errType</span> = <b>typeof</b>(<b>object</b>);
                        }
                    }
                    <b>else</b> <b>if</b> (<a href="#93842d04ef458a61" class="i field">readOnly</a>)
                    {
                        <span class="r396 r">errMessage</span> = <span class="i">ParserStrings</span>.<span class="i">PropertyIsReadOnly</span>;
                    }
 
                    <b>if</b> (<span class="r396 r">errMessage</span> != <b>null</b>)
                    {
                        <span class="i">Expression</span> <span id="r398 rd" class="r398 r">innerException</span> = <span class="i">Expression</span>.<span class="i">New</span>(<a href="parser/Compiler.cs.html#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="parser/Compiler.cs.html#4287f2a124c4e87d" class="i field">SetValueException_ctor</a>,
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="s">&quot;PropertyAssignmentException&quot;</span>),
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Exception</span>)),
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r396 r">errMessage</span>),
                            <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r393 r">field</span>.<span class="i">Name</span>)));
                        <span class="r395 r">setterExpr</span> = <a href="parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">ThrowRuntimeErrorWithInnerException</span>(<span class="s">&quot;PropertyAssignmentException&quot;</span>,
                                                                                  <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r396 r">errMessage</span>),
                                                                                  <span class="r398 r">innerException</span>, <span class="r397 r">errType</span>, <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r393 r">field</span>.<span class="i">Name</span>));
                    }
                    <b>else</b>
                    {
                        <span class="r395 r">setterExpr</span> = <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="i">Expression</span>.<span class="i">Field</span>(<span class="r392 r">instance</span>, <span class="r393 r">field</span>), <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r391 r">value</span>, <span class="r393 r">field</span>.<span class="i">FieldType</span>));
                    }
 
                    <a href="#f603b78e07cbad29" class="i field">_setterDelegate</a> = <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<a href="#b810cce9e211f7f8" class="t t">SetterDelegate</a>&gt;(<span class="r395 r">setterExpr</span>, <span class="r390 r">parameter</span>, <span class="r391 r">value</span>).<span class="i">Compile</span>();
                    <b>return</b>;
                }
 
                <b>var</b> <span id="r399 rd" class="r399 r">property</span> = (<span class="i">PropertyInfo</span>)<a href="#588c19f161433e56" class="i field">member</a>;
                <span class="i">MethodInfo</span> <span id="r400 rd" class="r400 r">propertySetter</span> = <span class="r399 r">property</span>.<span class="i">GetSetMethod</span>(<b>true</b>);
 
                <span class="r392 r">instance</span> = <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a> ? <b>null</b> : <span class="r390 r">parameter</span>.<span class="i">Cast</span>(<span class="r400 r">propertySetter</span>.<span class="i">DeclaringType</span>);
                <a href="#f603b78e07cbad29" class="i field">_setterDelegate</a> =
                    <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<a href="#b810cce9e211f7f8" class="t t">SetterDelegate</a>&gt;(
                        <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="i">Expression</span>.<span class="i">Property</span>(<span class="r392 r">instance</span>, <span class="r399 r">property</span>),
                            <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r391 r">value</span>, <span class="r399 r">property</span>.<span class="i">PropertyType</span>)), <span class="r390 r">parameter</span>, <span class="r391 r">value</span>).<span class="i">Compile</span>();
            }
 
            <b>internal</b> <span class="i">MemberInfo</span> <a id="588c19f161433e56" href="../R/588c19f161433e56.html" target="n" data-glyph="44,2" class="i field">member</a>;
 
            <b>internal</b> <a href="#0cb9958b15ce51ef" class="t t">GetterDelegate</a> <a id="786033b5164ff4ed" href="../R/786033b5164ff4ed.html" target="n" data-glyph="104,2" class="i property">getterDelegate</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#7c66a1c2a04f7c69" class="i field">_getterDelegate</a> == <b>null</b>)
                    {
                        <a href="#934985170b8e0272" class="i method">InitGetter</a>();
                    }
 
                    <b>return</b> <a href="#7c66a1c2a04f7c69" class="i field">_getterDelegate</a>;
                }
            }
 
            <b>private</b> <a href="#0cb9958b15ce51ef" class="t t">GetterDelegate</a> <a id="7c66a1c2a04f7c69" href="../R/7c66a1c2a04f7c69.html" target="n" data-glyph="46,2" class="i field">_getterDelegate</a>;
 
            <b>internal</b> <a href="#b810cce9e211f7f8" class="t t">SetterDelegate</a> <a id="5087d15e097e51d2" href="../R/5087d15e097e51d2.html" target="n" data-glyph="104,2" class="i property">setterDelegate</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#f603b78e07cbad29" class="i field">_setterDelegate</a> == <b>null</b>)
                    {
                        <a href="#a592470f2c3f1d28" class="i method">InitSetter</a>();
                    }
 
                    <b>return</b> <a href="#f603b78e07cbad29" class="i field">_setterDelegate</a>;
                }
            }
 
            <b>private</b> <a href="#b810cce9e211f7f8" class="t t">SetterDelegate</a> <a id="f603b78e07cbad29" href="../R/f603b78e07cbad29.html" target="n" data-glyph="46,2" class="i field">_setterDelegate</a>;
 
            <b>internal bool</b> <a id="3d8e849eefab9a49" href="../R/3d8e849eefab9a49.html" target="n" data-glyph="44,2" class="i field">useReflection</a>;
            <b>internal bool</b> <a id="93842d04ef458a61" href="../R/93842d04ef458a61.html" target="n" data-glyph="44,2" class="i field">readOnly</a>;
            <b>internal bool</b> <a id="1dd2f357ccb290c0" href="../R/1dd2f357ccb290c0.html" target="n" data-glyph="44,2" class="i field">writeOnly</a>;
            <b>internal bool</b> <a id="6bddc5f21ac9fad4" href="../R/6bddc5f21ac9fad4.html" target="n" data-glyph="44,2" class="i field">isStatic</a>;
            <b>internal</b> <span class="i">Type</span> <a id="46125476611507e4" href="../R/46125476611507e4.html" target="n" data-glyph="44,2" class="i field">propertyType</a>;
 
            <b>private bool</b>? <a id="a9fc5e909b883f64" href="../R/a9fc5e909b883f64.html" target="n" data-glyph="46,2" class="i field">_isHidden</a>;
 
            <b>internal override bool</b> <a id="380e189d15ba9351" href="../R/380e189d15ba9351.html" target="n" data-glyph="104,2" class="i property">IsHidden</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#a9fc5e909b883f64" class="i field">_isHidden</a> == <b>null</b>)
                    {
                        <a href="#a9fc5e909b883f64" class="i field">_isHidden</a> = <a href="#588c19f161433e56" class="i field">member</a>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<a href="Attributes.cs.html#95fc557737f7107e" class="t t">HiddenAttribute</a>), <span class="i">inherit</span>: <b>false</b>).<span class="i">Length</span> != 0;
                    }
 
                    <b>return</b> <a href="#a9fc5e909b883f64" class="i field">_isHidden</a>.<span class="i">Value</span>;
                }
            }
 
            <b>private</b> <span class="i">AttributeCollection</span> <a id="45b2195a51125031" href="../R/45b2195a51125031.html" target="n" data-glyph="46,2" class="i field">_attributes</a>;
 
            <b>internal</b> <span class="i">AttributeCollection</span> <a id="5e918ae3822db084" href="../R/5e918ae3822db084.html" target="n" data-glyph="104,2" class="i property">Attributes</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#45b2195a51125031" class="i field">_attributes</a> == <b>null</b>)
                    {
                        <span class="c">// Since AttributeCollection can only be constructed with an Attribute[], one is built.</span>
                        <b>var</b> <span id="r401 rd" class="r401 r">objAttributes</span> = <a href="#e42273e13efeb8a7" class="k">this</a>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">GetCustomAttributes</span>(<b>true</b>);
                        <a href="#45b2195a51125031" class="i field">_attributes</a> = <b>new</b> <span class="i">AttributeCollection</span>(<span class="r401 r">objAttributes</span>.<span class="i">Cast</span>&lt;<span class="i">Attribute</span>&gt;().<span class="i">ToArray</span>());
                    }
 
                    <b>return</b> <a href="#45b2195a51125031" class="i field">_attributes</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compare the signatures of the methods, returning true if the methods have</span>
        <span class="c">///</span><span class="c"> the same signature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="fc1fda06c7a3b69e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SameSignature</a>(<span class="i">MethodBase</span> <span id="r402 rd" class="r402 r">method1</span>, <span class="i">MethodBase</span> <span id="r403 rd" class="r403 r">method2</span>)
        {
            <b>if</b> (<span class="r402 r">method1</span>.<span class="i">GetGenericArguments</span>().<span class="i">Length</span> != <span class="r403 r">method2</span>.<span class="i">GetGenericArguments</span>().<span class="i">Length</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">ParameterInfo</span>[] <span id="r404 rd" class="r404 r">parameters1</span> = <span class="r402 r">method1</span>.<span class="i">GetParameters</span>();
            <span class="i">ParameterInfo</span>[] <span id="r405 rd" class="r405 r">parameters2</span> = <span class="r403 r">method2</span>.<span class="i">GetParameters</span>();
            <b>if</b> (<span class="r404 r">parameters1</span>.<span class="i">Length</span> != <span class="r405 r">parameters2</span>.<span class="i">Length</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>for</b> (<b>int</b> <span id="r406 rd" class="r406 r">i</span> = 0; <span class="r406 r">i</span> &lt; <span class="r404 r">parameters1</span>.<span class="i">Length</span>; ++<span class="r406 r">i</span>)
            {
                <b>if</b> (<span class="r404 r">parameters1</span>[<span class="r406 r">i</span>].<span class="i">ParameterType</span> != <span class="r405 r">parameters2</span>[<span class="r406 r">i</span>].<span class="i">ParameterType</span>
                    || <span class="r404 r">parameters1</span>[<span class="r406 r">i</span>].<span class="i">IsOut</span> != <span class="r405 r">parameters2</span>[<span class="r406 r">i</span>].<span class="i">IsOut</span>
                    || <span class="r404 r">parameters1</span>[<span class="r406 r">i</span>].<span class="i">IsOptional</span> != <span class="r405 r">parameters2</span>[<span class="r406 r">i</span>].<span class="i">IsOptional</span>)
                {
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an overload to a list of MethodInfo.  Before adding to the list, the</span>
        <span class="c">///</span><span class="c"> list is searched to make sure we don&#39;t end up with 2 functions with the</span>
        <span class="c">///</span><span class="c"> same signature.  This can happen when there is a newslot method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="bad72d4519a2df67" href="../R/bad72d4519a2df67.html" target="n" data-glyph="76,1" class="i method">AddOverload</a>(<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt; <span id="r407 rd" class="r407 r">previousMethodEntry</span>, <span class="i">MethodInfo</span> <span id="r408 rd" class="r408 r">method</span>)
        {
            <b>bool</b> <span id="r409 rd" class="r409 r">add</span> = <b>true</b>;
 
            <b>for</b> (<b>int</b> <span id="r410 rd" class="r410 r">i</span> = 0; <span class="r410 r">i</span> &lt; <span class="r407 r">previousMethodEntry</span>.<span class="i">Count</span>; <span class="r410 r">i</span>++)
            {
                <b>if</b> (<span class="i">SameSignature</span>(<span class="r407 r">previousMethodEntry</span>[<span class="r410 r">i</span>], <span class="r408 r">method</span>))
                {
                    <span class="r409 r">add</span> = <b>false</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r409 r">add</span>)
            {
                <span class="r407 r">previousMethodEntry</span>.<span class="i">Add</span>(<span class="r408 r">method</span>);
            }
        }
 
        <b>private static void</b> <a id="d6d6bee556b2c5ff" href="../R/d6d6bee556b2c5ff.html" target="n" data-glyph="76,1" class="i method">PopulateMethodReflectionTable</a>(<span class="i">Type</span> <span id="r411 rd" class="r411 r">type</span>, <span class="i">MethodInfo</span>[] <span id="r412 rd" class="r412 r">methods</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r413 rd" class="r413 r">typeMethods</span>)
        {
            <b>foreach</b> (<span class="i">MethodInfo</span> <span id="r414 rd" class="r414 r">method</span> <b>in</b> <span class="r412 r">methods</span>)
            {
                <b>if</b> (<span class="r414 r">method</span>.<span class="i">DeclaringType</span> == <span class="r411 r">type</span>)
                {
                    <b>string</b> <span id="r415 rd" class="r415 r">methodName</span> = <span class="r414 r">method</span>.<span class="i">Name</span>;
                    <b>var</b> <span id="r416 rd" class="r416 r">previousMethodEntry</span> = (<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;)<span class="r413 r">typeMethods</span><a href="#968b0af707b9b12e">[</a><span class="r415 r">methodName</span>];
                    <b>if</b> (<span class="r416 r">previousMethodEntry</span> == <b>null</b>)
                    {
                        <b>var</b> <span id="r417 rd" class="r417 r">methodEntry</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt; { <span class="r414 r">method</span> };
                        <span class="r413 r">typeMethods</span>.<span class="i">Add</span>(<span class="r415 r">methodName</span>, <span class="r417 r">methodEntry</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#bad72d4519a2df67" class="i method">AddOverload</a>(<span class="r416 r">previousMethodEntry</span>, <span class="r414 r">method</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r411 r">type</span>.<span class="i">BaseType</span> != <b>null</b>)
            {
                <span class="i">PopulateMethodReflectionTable</span>(<span class="r411 r">type</span>.<span class="i">BaseType</span>, <span class="r412 r">methods</span>, <span class="r413 r">typeMethods</span>);
            }
        }
 
        <b>private static void</b> <a id="096b501a7816780f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">PopulateMethodReflectionTable</a>(<span class="i">ConstructorInfo</span>[] <span id="r418 rd" class="r418 r">ctors</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r419 rd" class="r419 r">typeMethods</span>)
        {
            <b>foreach</b> (<span class="i">ConstructorInfo</span> <span id="r420 rd" class="r420 r">ctor</span> <b>in</b> <span class="r418 r">ctors</span>)
            {
                <b>var</b> <span id="r421 rd" class="r421 r">previousMethodEntry</span> = (<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;)<span class="r419 r">typeMethods</span><a href="#968b0af707b9b12e">[</a><span class="s">&quot;new&quot;</span>];
                <b>if</b> (<span class="r421 r">previousMethodEntry</span> == <b>null</b>)
                {
                    <b>var</b> <span id="r422 rd" class="r422 r">methodEntry</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;();
                    <span class="r422 r">methodEntry</span>.<span class="i">Add</span>(<span class="r420 r">ctor</span>);
                    <span class="r419 r">typeMethods</span>.<span class="i">Add</span>(<span class="s">&quot;new&quot;</span>, <span class="r422 r">methodEntry</span>);
                }
                <b>else</b>
                {
                    <span class="r421 r">previousMethodEntry</span>.<span class="i">Add</span>(<span class="r420 r">ctor</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from GetMethodReflectionTable within a lock to fill the</span>
        <span class="c">///</span><span class="c"> method cache table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r423 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to get methods from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r424 r">typeMethods</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Table to be filled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r425 r">bindingFlags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">BindingFlags to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="59a474c09d4f8efb" href="../R/59a474c09d4f8efb.html" target="n" data-glyph="76,1" class="i method">PopulateMethodReflectionTable</a>(<span class="i">Type</span> <span id="r423 rd" class="r423 r">type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r424 rd" class="r424 r">typeMethods</span>, <span class="i">BindingFlags</span> <span id="r425 rd" class="r425 r">bindingFlags</span>)
        {
            <b>bool</b> <span id="r426 rd" class="r426 r">isStatic</span> = <span class="r425 r">bindingFlags</span>.<span class="i">HasFlag</span>(<span class="i">BindingFlags</span>.<span class="i">Static</span>);
 
            <span class="i">MethodInfo</span>[] <span id="r427 rd" class="r427 r">methods</span> = <span class="r423 r">type</span>.<span class="i">GetMethods</span>(<span class="r425 r">bindingFlags</span>);
            <a href="#d6d6bee556b2c5ff" class="i method">PopulateMethodReflectionTable</a>(<span class="r423 r">type</span>, <span class="r427 r">methods</span>, <span class="r424 r">typeMethods</span>);
 
            <span class="i">Type</span>[] <span id="r428 rd" class="r428 r">interfaces</span> = <span class="r423 r">type</span>.<span class="i">GetInterfaces</span>();
            <b>foreach</b> (<span class="i">Type</span> <span id="r429 rd" class="r429 r">interfaceType</span> <b>in</b> <span class="r428 r">interfaces</span>)
            {
                <b>if</b> (!<a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#4060500316c13cf6" class="i method">IsPublic</a>(<span class="r429 r">interfaceType</span>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r429 r">interfaceType</span>.<span class="i">IsGenericType</span> &amp;&amp; <span class="r423 r">type</span>.<span class="i">IsArray</span>)
                {
                    <span class="c">// A bit of background: Array doesn&#39;t directly support any generic interface at all. Instead, a stub class</span>
                    <span class="c">// named &#39;SZArrayHelper&#39; provides these generic interfaces at runtime for zero-based one-dimension arrays.</span>
                    <span class="c">// This is why &#39;[object[]].GetInterfaceMap([ICollection[object]])&#39; throws &#39;ArgumentException&#39;.</span>
                    <span class="c">// (see https://stackoverflow.com/a/31883327)</span>
                    <span class="c">//</span>
                    <span class="c">// We had always been skipping generic interfaces for array types because &#39;GetInterfaceMap&#39; doesn&#39;t work</span>
                    <span class="c">// for it. Today, even though we don&#39;t use &#39;GetInterfaceMap&#39; anymore, the same code is kept here because</span>
                    <span class="c">// methods from generic interfaces of an array type could cause ambiguity in method overloads resolution.</span>
                    <span class="c">// For example, &quot;$objs = @(1,2,3,4); $objs.Contains(1)&quot; would fail because there would be 2 overloads of</span>
                    <span class="c">// the &#39;Contains&#39; methods which are equally good matches for the call.</span>
                    <span class="c">//    bool IList.Contains(System.Object value)</span>
                    <span class="c">//    bool ICollection[Object].Contains(System.Object item)</span>
                    <b>continue</b>;
                }
 
                <span class="r427 r">methods</span> = <span class="r429 r">interfaceType</span>.<span class="i">GetMethods</span>(<span class="r425 r">bindingFlags</span>);
 
                <b>foreach</b> (<span class="i">MethodInfo</span> <span id="r430 rd" class="r430 r">interfaceMethod</span> <b>in</b> <span class="r427 r">methods</span>)
                {
                    <b>if</b> (<span class="r426 r">isStatic</span> &amp;&amp; <span class="r430 r">interfaceMethod</span>.<span class="i">IsVirtual</span>)
                    {
                        <span class="c">// Ignore static virtual/abstract methods on an interface because:</span>
                        <span class="c">//  1. if it&#39;s implicitly implemented, which will be mostly the case, then the corresponding</span>
                        <span class="c">//     methods were already retrieved from the &#39;type.GetMethods&#39; step above;</span>
                        <span class="c">//  2. if it&#39;s explicitly implemented, we cannot call &#39;Invoke(null, args)&#39; on the static method,</span>
                        <span class="c">//     but have to use &#39;type.GetInterfaceMap(interfaceType)&#39; to get the corresponding target</span>
                        <span class="c">//     methods, and call &#39;Invoke(null, args)&#39; on them. The target methods will be non-public</span>
                        <span class="c">//     in this case, which we always ignore.</span>
                        <span class="c">//  3. The recommendation from .NET team is to ignore the static virtuals on interfaces,</span>
                        <span class="c">//     especially given that the APIs may change in .NET 7.</span>
                        <b>continue</b>;
                    }
 
                    <b>var</b> <span id="r431 rd" class="r431 r">previousMethodEntry</span> = (<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;)<span class="r424 r">typeMethods</span>[<span class="r430 r">interfaceMethod</span>.<span class="i">Name</span>];
                    <b>if</b> (<span class="r431 r">previousMethodEntry</span> == <b>null</b>)
                    {
                        <b>var</b> <span id="r432 rd" class="r432 r">methodEntry</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt; { <span class="r430 r">interfaceMethod</span> };
                        <span class="r424 r">typeMethods</span>.<span class="i">Add</span>(<span class="r430 r">interfaceMethod</span>.<span class="i">Name</span>, <span class="r432 r">methodEntry</span>);
                    }
                    <b>else</b>
                    {
                        <b>if</b> (!<span class="r431 r">previousMethodEntry</span>.<span class="i">Contains</span>(<span class="r430 r">interfaceMethod</span>))
                        {
                            <span class="r431 r">previousMethodEntry</span>.<span class="i">Add</span>(<span class="r430 r">interfaceMethod</span>);
                        }
                    }
                }
            }
 
            <b>if</b> ((<span class="r425 r">bindingFlags</span> &amp; <span class="i">BindingFlags</span>.<span class="i">Static</span>) != 0 &amp;&amp; <a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#4060500316c13cf6" class="i method">IsPublic</a>(<span class="r423 r">type</span>))
            {
                <span class="c">// We don&#39;t add constructors if there was a static method named new.</span>
                <span class="c">// We don&#39;t add constructors if the target type is not public, because it&#39;s useless to an internal type.</span>
                <b>var</b> <span id="r433 rd" class="r433 r">previousMethodEntry</span> = (<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;)<span class="r424 r">typeMethods</span><a href="#968b0af707b9b12e">[</a><span class="s">&quot;new&quot;</span>];
                <b>if</b> (<span class="r433 r">previousMethodEntry</span> == <b>null</b>)
                {
                    <b>var</b> <span id="r434 rd" class="r434 r">ctorBindingFlags</span> = <span class="r425 r">bindingFlags</span> &amp; ~(<span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span>);
                    <span class="r434 r">ctorBindingFlags</span> |= <span class="i">BindingFlags</span>.<span class="i">Instance</span>;
                    <b>var</b> <span id="r435 rd" class="r435 r">ctorInfos</span> = <span class="r423 r">type</span>.<span class="i">GetConstructors</span>(<span class="r434 r">ctorBindingFlags</span>);
                    <span class="i">PopulateMethodReflectionTable</span>(<span class="r435 r">ctorInfos</span>, <span class="r424 r">typeMethods</span>);
                }
            }
 
            <b>for</b> (<b>int</b> <span id="r436 rd" class="r436 r">i</span> = 0; <span class="r436 r">i</span> &lt; <span class="r424 r">typeMethods</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>; <span class="r436 r">i</span>++)
            {
                <span class="r424 r">typeMethods</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r436 r">i</span>] =
                    <b>new</b> <span class="t">MethodCacheEntry</span>((<span class="i">List</span>&lt;<span class="i">MethodBase</span>&gt;)<span class="r424 r">typeMethods</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r436 r">i</span>]);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from GetEventReflectionTable within a lock to fill the</span>
        <span class="c">///</span><span class="c"> event cache table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r437 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to get events from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r438 r">typeEvents</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Table to be filled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r439 r">bindingFlags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">BindingFlags to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="fe079aea50e6463e" href="../R/fe079aea50e6463e.html" target="n" data-glyph="76,1" class="i method">PopulateEventReflectionTable</a>(<span class="i">Type</span> <span id="r437 rd" class="r437 r">type</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt; <span id="r438 rd" class="r438 r">typeEvents</span>, <span class="i">BindingFlags</span> <span id="r439 rd" class="r439 r">bindingFlags</span>)
        {
            <span class="i">EventInfo</span>[] <span id="r440 rd" class="r440 r">events</span> = <span class="r437 r">type</span>.<span class="i">GetEvents</span>(<span class="r439 r">bindingFlags</span>);
            <b>var</b> <span id="r441 rd" class="r441 r">tempTable</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">EventInfo</span>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>foreach</b> (<span class="i">EventInfo</span> <span id="r442 rd" class="r442 r">typeEvent</span> <b>in</b> <span class="r440 r">events</span>)
            {
                <b>string</b> <span id="r443 rd" class="r443 r">eventName</span> = <span class="r442 r">typeEvent</span>.<span class="i">Name</span>;
                <b>if</b> (!<span class="r441 r">tempTable</span>.<span class="i">TryGetValue</span>(<span class="r443 r">eventName</span>, <b>out</b> <span class="i">List</span>&lt;<span class="i">EventInfo</span>&gt; <span id="r444 rd" class="r444 r">entryList</span>))
                {
                    <span class="r444 r">entryList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">EventInfo</span>&gt;();
                    <span class="r441 r">tempTable</span>.<span class="i">Add</span>(<span class="r443 r">eventName</span>, <span class="r444 r">entryList</span>);
                }
 
                <span class="r444 r">entryList</span>.<span class="i">Add</span>(<span class="r442 r">typeEvent</span>);
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">EventInfo</span>&gt;&gt; <span id="r445 rd" class="r445 r">entry</span> <b>in</b> <span class="r441 r">tempTable</span>)
            {
                <span class="r438 r">typeEvents</span>.<span class="i">Add</span>(<span class="r445 r">entry</span>.<span class="i">Key</span>, <b>new</b> <span class="t">EventCacheEntry</span>(<span class="r445 r">entry</span>.<span class="i">Value</span>.<span class="i">ToArray</span>()));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is necessary because an overridden property in a specific class derived from a generic one will</span>
        <span class="c">///</span><span class="c"> appear twice. The second time, it should be ignored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="9f83e7fddb40f105" href="../R/9f83e7fddb40f105.html" target="n" data-glyph="76,1" class="i method">PropertyAlreadyPresent</a>(<span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r446 rd" class="r446 r">previousProperties</span>, <span class="i">PropertyInfo</span> <span id="r447 rd" class="r447 r">property</span>)
        {
            <span class="c">// The loop below</span>
            <b>bool</b> <span id="r448 rd" class="r448 r">returnValue</span> = <b>false</b>;
            <span class="i">ParameterInfo</span>[] <span id="r449 rd" class="r449 r">propertyParameters</span> = <span class="r447 r">property</span>.<span class="i">GetIndexParameters</span>();
            <b>int</b> <span id="r450 rd" class="r450 r">propertyIndexLength</span> = <span class="r449 r">propertyParameters</span>.<span class="i">Length</span>;
 
            <b>foreach</b> (<span class="i">PropertyInfo</span> <span id="r451 rd" class="r451 r">previousProperty</span> <b>in</b> <span class="r446 r">previousProperties</span>)
            {
                <span class="i">ParameterInfo</span>[] <span id="r452 rd" class="r452 r">previousParameters</span> = <span class="r451 r">previousProperty</span>.<span class="i">GetIndexParameters</span>();
                <b>if</b> (<span class="r452 r">previousParameters</span>.<span class="i">Length</span> == <span class="r450 r">propertyIndexLength</span>)
                {
                    <b>bool</b> <span id="r453 rd" class="r453 r">parametersAreSame</span> = <b>true</b>;
                    <b>for</b> (<b>int</b> <span id="r454 rd" class="r454 r">parameterIndex</span> = 0; <span class="r454 r">parameterIndex</span> &lt; <span class="r452 r">previousParameters</span>.<span class="i">Length</span>; <span class="r454 r">parameterIndex</span>++)
                    {
                        <span class="i">ParameterInfo</span> <span id="r455 rd" class="r455 r">previousParameter</span> = <span class="r452 r">previousParameters</span>[<span class="r454 r">parameterIndex</span>];
                        <span class="i">ParameterInfo</span> <span id="r456 rd" class="r456 r">propertyParameter</span> = <span class="r449 r">propertyParameters</span>[<span class="r454 r">parameterIndex</span>];
                        <b>if</b> (<span class="r455 r">previousParameter</span>.<span class="i">ParameterType</span> != <span class="r456 r">propertyParameter</span>.<span class="i">ParameterType</span>)
                        {
                            <span class="r453 r">parametersAreSame</span> = <b>false</b>;
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r453 r">parametersAreSame</span>)
                    {
                        <span class="r448 r">returnValue</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r448 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from GetPropertyReflectionTable within a lock to fill the</span>
        <span class="c">///</span><span class="c"> property cache table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r457 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to get properties from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r458 r">typeProperties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Table to be filled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r459 r">bindingFlags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">BindingFlags to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="aca5617670e063fb" href="../R/aca5617670e063fb.html" target="n" data-glyph="76,1" class="i method">PopulatePropertyReflectionTable</a>(<span class="i">Type</span> <span id="r457 rd" class="r457 r">type</span>, <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r458 rd" class="r458 r">typeProperties</span>, <span class="i">BindingFlags</span> <span id="r459 rd" class="r459 r">bindingFlags</span>)
        {
            <b>bool</b> <span id="r460 rd" class="r460 r">isStatic</span> = <span class="r459 r">bindingFlags</span>.<span class="i">HasFlag</span>(<span class="i">BindingFlags</span>.<span class="i">Static</span>);
            <b>var</b> <span id="r461 rd" class="r461 r">tempTable</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <span class="i">PropertyInfo</span>[] <span id="r462 rd" class="r462 r">properties</span> = <span class="r457 r">type</span>.<span class="i">GetProperties</span>(<span class="r459 r">bindingFlags</span>);
            <b>foreach</b> (<span class="i">PropertyInfo</span> <span id="r463 rd" class="r463 r">property</span> <b>in</b> <span class="r462 r">properties</span>)
            {
                <span class="i">PopulateSingleProperty</span>(<span class="r457 r">type</span>, <span class="r463 r">property</span>, <span class="r461 r">tempTable</span>, <span class="r463 r">property</span>.<span class="i">Name</span>);
            }
 
            <span class="i">Type</span>[] <span id="r464 rd" class="r464 r">interfaces</span> = <span class="r457 r">type</span>.<span class="i">GetInterfaces</span>();
            <b>foreach</b> (<span class="i">Type</span> <span id="r465 rd" class="r465 r">interfaceType</span> <b>in</b> <span class="r464 r">interfaces</span>)
            {
                <b>if</b> (!<a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#4060500316c13cf6" class="i method">IsPublic</a>(<span class="r465 r">interfaceType</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="r462 r">properties</span> = <span class="r465 r">interfaceType</span>.<span class="i">GetProperties</span>(<span class="r459 r">bindingFlags</span>);
                <b>foreach</b> (<span class="i">PropertyInfo</span> <span id="r466 rd" class="r466 r">property</span> <b>in</b> <span class="r462 r">properties</span>)
                {
                    <b>if</b> (<span class="r460 r">isStatic</span> &amp;&amp;
                        (<span class="r466 r">property</span>.<span class="i">GetMethod</span>?.<span class="i">IsVirtual</span> == <b>true</b> || <span class="r466 r">property</span>.<span class="i">SetMethod</span>?.<span class="i">IsVirtual</span> == <b>true</b>))
                    {
                        <span class="c">// Ignore static virtual/abstract properties on an interface because:</span>
                        <span class="c">//  1. if it&#39;s implicitly implemented, which will be mostly the case, then the corresponding</span>
                        <span class="c">//     properties were already retrieved from the &#39;type.GetProperties&#39; step above;</span>
                        <span class="c">//  2. if it&#39;s explicitly implemented, we cannot call &#39;GetValue(null)&#39; on the static property,</span>
                        <span class="c">//     but have to use &#39;type.GetInterfaceMap(interfaceType)&#39; to get the corresponding target</span>
                        <span class="c">//     get/set accessor methods, and call &#39;Invoke(null, args)&#39; on them. The target methods will</span>
                        <span class="c">//     be non-public in this case, which we always ignore.</span>
                        <span class="c">//  3. The recommendation from .NET team is to ignore the static virtuals on interfaces,</span>
                        <span class="c">//     especially given that the APIs may change in .NET 7.</span>
                        <b>continue</b>;
                    }
 
                    <span class="i">PopulateSingleProperty</span>(<span class="r457 r">type</span>, <span class="r466 r">property</span>, <span class="r461 r">tempTable</span>, <span class="r466 r">property</span>.<span class="i">Name</span>);
                }
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt;&gt; <span id="r467 rd" class="r467 r">entry</span> <b>in</b> <span class="r461 r">tempTable</span>)
            {
                <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r468 rd" class="r468 r">propertiesList</span> = <span class="r467 r">entry</span>.<span class="i">Value</span>;
                <span class="i">PropertyInfo</span> <span id="r469 rd" class="r469 r">firstProperty</span> = <span class="r468 r">propertiesList</span>[0];
                <b>if</b> ((<span class="r468 r">propertiesList</span>.<span class="i">Count</span> &gt; 1) || (<span class="r469 r">firstProperty</span>.<span class="i">GetIndexParameters</span>().<span class="i">Length</span> != 0))
                {
                    <span class="r458 r">typeProperties</span>.<span class="i">Add</span>(<span class="r467 r">entry</span>.<span class="i">Key</span>, <b>new</b> <a href="#2f8ee681dbcba09b" class="t constructor">ParameterizedPropertyCacheEntry</a>(<span class="r468 r">propertiesList</span>));
                }
                <b>else</b>
                {
                    <span class="r458 r">typeProperties</span>.<span class="i">Add</span>(<span class="r467 r">entry</span>.<span class="i">Key</span>, <b>new</b> <a href="#062ddd336e6b2596" class="t constructor">PropertyCacheEntry</a>(<span class="r469 r">firstProperty</span>));
                }
            }
 
            <span class="i">FieldInfo</span>[] <span id="r470 rd" class="r470 r">fields</span> = <span class="r457 r">type</span>.<span class="i">GetFields</span>(<span class="r459 r">bindingFlags</span>);
            <b>foreach</b> (<span class="i">FieldInfo</span> <span id="r471 rd" class="r471 r">field</span> <b>in</b> <span class="r470 r">fields</span>)
            {
                <b>string</b> <span id="r472 rd" class="r472 r">fieldName</span> = <span class="r471 r">field</span>.<span class="i">Name</span>;
                <a href="#e42273e13efeb8a7" class="k">var</a> <span id="r473 rd" class="r473 r">previousMember</span> = (<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r458 r">typeProperties</span><a href="#968b0af707b9b12e">[</a><span class="r472 r">fieldName</span>];
                <b>if</b> (<span class="r473 r">previousMember</span> == <b>null</b>)
                {
                    <span class="r458 r">typeProperties</span>.<a href="#ad9a69c8f181d214" class="i method">Add</a>(<span class="r472 r">fieldName</span>, <b>new</b> <a href="#e2913351242647ed" class="t constructor">PropertyCacheEntry</a>(<span class="r471 r">field</span>));
                }
                <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r473 r">previousMember</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>, <span class="r472 r">fieldName</span>))
                {
                    <span class="c">// A property/field declared with &#39;new&#39; in a derived class might appear twice, and it&#39;s OK to ignore</span>
                    <span class="c">// the second property/field in that case.</span>
                    <span class="c">// However, if the names of two properties/fields are different only in letter casing, then it&#39;s not</span>
                    <span class="c">// CLS complaint and we throw an exception.</span>
                    <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(
                        <span class="s">&quot;NotACLSComplaintField&quot;</span>,
                        <span class="i">innerException</span>: <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">NotAClsCompliantFieldProperty</span>,
                        <span class="r472 r">fieldName</span>,
                        <span class="r457 r">type</span>.<span class="i">FullName</span>,
                        <span class="r473 r">previousMember</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>);
                }
            }
        }
 
        <b>private static void</b> <a id="64f307b07ceb1590" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">PopulateSingleProperty</a>(<span class="i">Type</span> <span id="r474 rd" class="r474 r">type</span>, <span class="i">PropertyInfo</span> <span id="r475 rd" class="r475 r">property</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt;&gt; <span id="r476 rd" class="r476 r">tempTable</span>, <b>string</b> <span id="r477 rd" class="r477 r">propertyName</span>)
        {
            <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r478 rd" class="r478 r">previousPropertyEntry</span>;
            <b>if</b> (!<span class="r476 r">tempTable</span>.<span class="i">TryGetValue</span>(<span class="r477 r">propertyName</span>, <b>out</b> <span class="r478 r">previousPropertyEntry</span>))
            {
                <span class="r478 r">previousPropertyEntry</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">PropertyInfo</span>&gt; { <span class="r475 r">property</span> };
                <span class="r476 r">tempTable</span>.<span class="i">Add</span>(<span class="r477 r">propertyName</span>, <span class="r478 r">previousPropertyEntry</span>);
            }
            <b>else</b>
            {
                <b>var</b> <span id="r479 rd" class="r479 r">firstProperty</span> = <span class="r478 r">previousPropertyEntry</span>[0];
                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r475 r">property</span>.<span class="i">Name</span>, <span class="r479 r">firstProperty</span>.<span class="i">Name</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(<span class="s">&quot;NotACLSComplaintProperty&quot;</span>, <b>null</b>,
                                                          <span class="i">ExtendedTypeSystem</span>.<span class="i">NotAClsCompliantFieldProperty</span>, <span class="r475 r">property</span>.<span class="i">Name</span>, <span class="r474 r">type</span>.<span class="i">FullName</span>, <span class="r479 r">firstProperty</span>.<span class="i">Name</span>);
                }
 
                <b>if</b> (<a href="#9f83e7fddb40f105" class="i method">PropertyAlreadyPresent</a>(<span class="r478 r">previousPropertyEntry</span>, <span class="r475 r">property</span>))
                {
                    <b>return</b>;
                }
 
                <span class="r478 r">previousPropertyEntry</span>.<span class="i">Add</span>(<span class="r475 r">property</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from GetProperty and GetProperties to populate the</span>
        <span class="c">///</span><span class="c"> typeTable with all public properties and fields</span>
        <span class="c">///</span><span class="c"> of type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r480 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to load properties for.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <a id="5af8d6c7420cc3c9" href="../R/5af8d6c7420cc3c9.html" target="n" data-glyph="76,1" class="i method">GetStaticPropertyReflectionTable</a>(<span class="i">Type</span> <span id="r480 rd" class="r480 r">type</span>)
        {
            <b>lock</b> (<a href="#518436f5c83529b7" class="i field">s_staticPropertyCacheTable</a>)
            {
                <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r481 rd" class="r481 r">typeTable</span> = <b>null</b>;
                <b>if</b> (<a href="#518436f5c83529b7" class="i field">s_staticPropertyCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r480 r">type</span>, <b>out</b> <span class="r481 r">typeTable</span>))
                {
                    <b>return</b> <span class="r481 r">typeTable</span>;
                }
 
                <span class="r481 r">typeTable</span> = <b>new</b> <a href="#beeacb92aef9bb8e" class="t constructor">CacheTable</a>();
                <a href="#aca5617670e063fb" class="i method">PopulatePropertyReflectionTable</a>(<span class="r480 r">type</span>, <span class="r481 r">typeTable</span>, <a href="#71463d1c978c63f7" class="i field">staticBindingFlags</a>);
                <a href="#518436f5c83529b7" class="i field">s_staticPropertyCacheTable</a>[<span class="r480 r">type</span>] = <span class="r481 r">typeTable</span>;
                <b>return</b> <span class="r481 r">typeTable</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the table for static methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r482 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to load methods for.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <a id="b7a60670860fdf96" href="../R/b7a60670860fdf96.html" target="n" data-glyph="76,1" class="i method">GetStaticMethodReflectionTable</a>(<span class="i">Type</span> <span id="r482 rd" class="r482 r">type</span>)
        {
            <b>lock</b> (<a href="#4ecaae4c3873ff15" class="i field">s_staticMethodCacheTable</a>)
            {
                <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r483 rd" class="r483 r">typeTable</span> = <b>null</b>;
                <b>if</b> (<a href="#4ecaae4c3873ff15" class="i field">s_staticMethodCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r482 r">type</span>, <b>out</b> <span class="r483 r">typeTable</span>))
                {
                    <b>return</b> <span class="r483 r">typeTable</span>;
                }
 
                <span class="r483 r">typeTable</span> = <b>new</b> <a href="#beeacb92aef9bb8e" class="t constructor">CacheTable</a>();
                <a href="#59a474c09d4f8efb" class="i method">PopulateMethodReflectionTable</a>(<span class="r482 r">type</span>, <span class="r483 r">typeTable</span>, <a href="#71463d1c978c63f7" class="i field">staticBindingFlags</a>);
                <a href="#4ecaae4c3873ff15" class="i field">s_staticMethodCacheTable</a>[<span class="r482 r">type</span>] = <span class="r483 r">typeTable</span>;
                <b>return</b> <span class="r483 r">typeTable</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the table for static events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r484 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type containing properties to load in typeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt; <a id="c625af2cafee5b8f" href="../R/c625af2cafee5b8f.html" target="n" data-glyph="76,1" class="i method">GetStaticEventReflectionTable</a>(<span class="i">Type</span> <span id="r484 rd" class="r484 r">type</span>)
        {
            <b>lock</b> (<a href="#415f898d49bfe080" class="i field">s_staticEventCacheTable</a>)
            {
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt; <span id="r485 rd" class="r485 r">typeTable</span>;
                <b>if</b> (<a href="#415f898d49bfe080" class="i field">s_staticEventCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r484 r">type</span>, <b>out</b> <span class="r485 r">typeTable</span>))
                {
                    <b>return</b> <span class="r485 r">typeTable</span>;
                }
 
                <span class="r485 r">typeTable</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;();
                <a href="#fe079aea50e6463e" class="i method">PopulateEventReflectionTable</a>(<span class="r484 r">type</span>, <span class="r485 r">typeTable</span>, <a href="#71463d1c978c63f7" class="i field">staticBindingFlags</a>);
                <a href="#415f898d49bfe080" class="i field">s_staticEventCacheTable</a>[<span class="r484 r">type</span>] = <span class="r485 r">typeTable</span>;
                <b>return</b> <span class="r485 r">typeTable</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from GetProperty and GetProperties to populate the</span>
        <span class="c">///</span><span class="c"> typeTable with all public properties and fields</span>
        <span class="c">///</span><span class="c"> of type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r486 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type with properties to load in typeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <a id="d52106c13a7121fa" href="../R/d52106c13a7121fa.html" target="n" data-glyph="76,1" class="i method">GetInstancePropertyReflectionTable</a>(<span class="i">Type</span> <span id="r486 rd" class="r486 r">type</span>)
        {
            <b>lock</b> (<a href="#860819c380846600" class="i field">s_instancePropertyCacheTable</a>)
            {
                <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r487 rd" class="r487 r">typeTable</span> = <b>null</b>;
                <b>if</b> (<a href="#860819c380846600" class="i field">s_instancePropertyCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r486 r">type</span>, <b>out</b> <span class="r487 r">typeTable</span>))
                {
                    <b>return</b> <span class="r487 r">typeTable</span>;
                }
 
                <span class="r487 r">typeTable</span> = <b>new</b> <a href="#beeacb92aef9bb8e" class="t constructor">CacheTable</a>();
                <a href="#aca5617670e063fb" class="i method">PopulatePropertyReflectionTable</a>(<span class="r486 r">type</span>, <span class="r487 r">typeTable</span>, <a href="#7381d4fd39afd10e" class="i field">instanceBindingFlags</a>);
                <a href="#860819c380846600" class="i field">s_instancePropertyCacheTable</a>[<span class="r486 r">type</span>] = <span class="r487 r">typeTable</span>;
                <b>return</b> <span class="r487 r">typeTable</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the table for instance methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r488 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type with methods to load in typeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <a id="01e4ea18d60d724b" href="../R/01e4ea18d60d724b.html" target="n" data-glyph="76,1" class="i method">GetInstanceMethodReflectionTable</a>(<span class="i">Type</span> <span id="r488 rd" class="r488 r">type</span>)
        {
            <b>lock</b> (<a href="#0b48fd87c3602a9d" class="i field">s_instanceMethodCacheTable</a>)
            {
                <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r489 rd" class="r489 r">typeTable</span> = <b>null</b>;
                <b>if</b> (<a href="#0b48fd87c3602a9d" class="i field">s_instanceMethodCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r488 r">type</span>, <b>out</b> <span class="r489 r">typeTable</span>))
                {
                    <b>return</b> <span class="r489 r">typeTable</span>;
                }
 
                <span class="r489 r">typeTable</span> = <b>new</b> <a href="#beeacb92aef9bb8e" class="t constructor">CacheTable</a>();
                <a href="#59a474c09d4f8efb" class="i method">PopulateMethodReflectionTable</a>(<span class="r488 r">type</span>, <span class="r489 r">typeTable</span>, <a href="#7381d4fd39afd10e" class="i field">instanceBindingFlags</a>);
                <a href="#0b48fd87c3602a9d" class="i field">s_instanceMethodCacheTable</a>[<span class="r488 r">type</span>] = <span class="r489 r">typeTable</span>;
                <b>return</b> <span class="r489 r">typeTable</span>;
            }
        }
 
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<b>object</b>&gt; <a id="2e49ab7da186d13a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetPropertiesAndMethods</a>(<span class="i">Type</span> <span id="r490 rd" class="r490 r">type</span>, <b>bool</b> <span id="r491 rd" class="r491 r">@static</span>)
        {
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r492 rd" class="r492 r">propertyTable</span> = <span class="r491 r">@static</span>
                ? <a href="#5af8d6c7420cc3c9" class="i method">GetStaticPropertyReflectionTable</a>(<span class="r490 r">type</span>)
                : <a href="#d52106c13a7121fa" class="i method">GetInstancePropertyReflectionTable</a>(<span class="r490 r">type</span>);
            <b>for</b> (<b>int</b> <span id="r493 rd" class="r493 r">i</span> = 0; <span class="r493 r">i</span> &lt; <span class="r492 r">propertyTable</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>; <span class="r493 r">i</span>++)
            {
                <a href="#e42273e13efeb8a7" class="k">var</a> <span id="r494 rd" class="r494 r">propertyCacheEntry</span> = <span class="r492 r">propertyTable</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r493 r">i</span>] <b>as</b> <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>;
                <b>if</b> (<span class="r494 r">propertyCacheEntry</span> != <b>null</b>)
                    <b>yield</b> <b>return</b> <span class="r494 r">propertyCacheEntry</span>.<a href="#588c19f161433e56" class="i field">member</a>;
            }
 
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r495 rd" class="r495 r">methodTable</span> = <span class="r491 r">@static</span>
                ? <a href="#b7a60670860fdf96" class="i method">GetStaticMethodReflectionTable</a>(<span class="r490 r">type</span>)
                : <a href="#01e4ea18d60d724b" class="i method">GetInstanceMethodReflectionTable</a>(<span class="r490 r">type</span>);
            <b>for</b> (<b>int</b> <span id="r496 rd" class="r496 r">i</span> = 0; <span class="r496 r">i</span> &lt; <span class="r495 r">methodTable</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>; <span class="r496 r">i</span>++)
            {
                <a href="#6dfefa2e34e759ac" class="k">var</a> <span id="r497 rd" class="r497 r">method</span> = <span class="r495 r">methodTable</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r496 r">i</span>] <b>as</b> <a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>;
                <b>if</b> (<span class="r497 r">method</span> != <b>null</b> &amp;&amp; !<span class="r497 r">method</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">IsSpecialName</span>)
                {
                    <b>yield</b> <b>return</b> <span class="r497 r">method</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the table for instance events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r498 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type containing methods to load in typeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt; <a id="92ef66fb92ec2f57" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetInstanceEventReflectionTable</a>(<span class="i">Type</span> <span id="r498 rd" class="r498 r">type</span>)
        {
            <b>lock</b> (<a href="#786174010c889c04" class="i field">s_instanceEventCacheTable</a>)
            {
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt; <span id="r499 rd" class="r499 r">typeTable</span>;
                <b>if</b> (<a href="#786174010c889c04" class="i field">s_instanceEventCacheTable</a>.<span class="i">TryGetValue</span>(<span class="r498 r">type</span>, <b>out</b> <span class="r499 r">typeTable</span>))
                {
                    <b>return</b> <span class="r499 r">typeTable</span>;
                }
 
                <span class="r499 r">typeTable</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#e16698b66376e45c" class="t t">EventCacheEntry</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <a href="#fe079aea50e6463e" class="i method">PopulateEventReflectionTable</a>(<span class="r498 r">type</span>, <span class="r499 r">typeTable</span>, <a href="#7381d4fd39afd10e" class="i field">instanceBindingFlags</a>);
                <a href="#786174010c889c04" class="i field">s_instanceEventCacheTable</a>[<span class="r498 r">type</span>] = <span class="r499 r">typeTable</span>;
                <b>return</b> <span class="r499 r">typeTable</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if a parameterized property should be in a PSMemberInfoCollection of type t.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r500 r">t</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of a PSMemberInfoCollection like the type of T in PSMemberInfoCollection of T.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if a parameterized property should be in a collection.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Usually typeof(T).IsAssignableFrom(typeof(PSParameterizedProperty)) would work like it does</span>
        <span class="c">///</span><span class="c"> for PSMethod and PSProperty, but since PSParameterizedProperty derives from PSMethodInfo and</span>
        <span class="c">///</span><span class="c"> since we don&#39;t want to have ParameterizedProperties in PSMemberInfoCollection of PSMethodInfo</span>
        <span class="c">///</span><span class="c"> we need this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="3ea646c4a534441e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsTypeParameterizedProperty</a>(<span class="i">Type</span> <span id="r500 rd" class="r500 r">t</span>)
        {
            <b>return</b> <span class="r500 r">t</span> == <b>typeof</b>(<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>) || <span class="r500 r">t</span> == <b>typeof</b>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>);
        }
 
        <b>private</b> <span class="r501 r t">T</span> <a id="6ea0cd13e44f9010" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetDotNetPropertyImpl</a>&lt;<span id="r501 rd t" class="r501 r t">T</span>&gt;(<b>object</b> <span id="r502 rd" class="r502 r">obj</span>, <b>string</b> <span id="r503 rd" class="r503 r">propertyName</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r504 rd" class="r504 r">predicate</span>) <b>where</b> <span class="r501 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>bool</b> <span id="r505 rd" class="r505 r">lookingForProperties</span> = <b>typeof</b>(<span class="r501 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>));
            <b>bool</b> <span id="r506 rd" class="r506 r">lookingForParameterizedProperties</span> = <span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r501 r t">T</span>));
            <b>if</b> (!<span class="r505 r">lookingForProperties</span> &amp;&amp; !<span class="r506 r">lookingForParameterizedProperties</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r507 rd" class="r507 r">typeTable</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                                       ? <a href="#5af8d6c7420cc3c9" class="i method">GetStaticPropertyReflectionTable</a>((<span class="i">Type</span>)<span class="r502 r">obj</span>)
                                       : <span class="i">GetInstancePropertyReflectionTable</span>(<span class="r502 r">obj</span>.<span class="i">GetType</span>());
 
            <b>object</b> <span id="r508 rd" class="r508 r">entry</span> = <span class="r504 r">predicate</span> != <b>null</b>
                               ? <span class="r507 r">typeTable</span>.<a href="#9f0b3a7636d870e6" class="i method">GetFirstOrDefault</a>(<span class="r504 r">predicate</span>)
                               : <span class="r507 r">typeTable</span><a href="#968b0af707b9b12e">[</a><span class="r503 r">propertyName</span>];
            <b>switch</b> (<span class="r508 r">entry</span>)
            {
                <b>case</b> <b>null</b>:
                    <b>return</b> <b>null</b>;
                <b>case</b> <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r509 rd" class="r509 r">cacheEntry</span> <b>when</b> <span class="r505 r">lookingForProperties</span>:
                    <b>return</b> <b>new</b> <span class="t">PSProperty</span>(<span class="r509 r">cacheEntry</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>, <a href="#27353615475f6dbc" class="k">this</a>, <span class="r502 r">obj</span>, <span class="r509 r">cacheEntry</span>) { <a href="MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a> = <span class="r509 r">cacheEntry</span>.<a href="#380e189d15ba9351" class="i property">IsHidden</a> } <b>as</b> <span class="r501 r t">T</span>;
                <b>case</b> <a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a> <span id="r510 rd" class="r510 r">paramCacheEntry</span> <b>when</b> <span class="r506 r">lookingForParameterizedProperties</span>:
 
                    <span class="c">// TODO: check for HiddenAttribute</span>
                    <span class="c">// We can&#39;t currently write a parameterized property in a PowerShell class so this isn&#39;t too important,</span>
                    <span class="c">// but if someone added the attribute to their C#, it&#39;d be good to set isHidden correctly here.</span>
                    <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#3ecbc15cdeba7bc5" class="t constructor">PSParameterizedProperty</a>(<span class="r510 r">paramCacheEntry</span>.<a href="#b342cdcccf025067" class="i field">propertyName</a>, <a href="#27353615475f6dbc" class="k">this</a>, <span class="r502 r">obj</span>, <span class="r510 r">paramCacheEntry</span>) <b>as</b> <span class="r501 r t">T</span>;
                <b>default</b>: <b>return</b> <b>null</b>;
            }
        }
 
        <b>private</b> <span class="r511 r t">T</span> <a id="6f11f71084240961" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetDotNetMethodImpl</a>&lt;<span id="r511 rd t" class="r511 r t">T</span>&gt;(<b>object</b> <span id="r512 rd" class="r512 r">obj</span>, <b>string</b> <span id="r513 rd" class="r513 r">methodName</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r514 rd" class="r514 r">predicate</span>) <b>where</b> <span class="r511 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (!<b>typeof</b>(<span class="r511 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)))
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r515 rd" class="r515 r">typeTable</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                                       ? <a href="#b7a60670860fdf96" class="i method">GetStaticMethodReflectionTable</a>((<span class="i">Type</span>)<span class="r512 r">obj</span>)
                                       : <span class="i">GetInstanceMethodReflectionTable</span>(<span class="r512 r">obj</span>.<span class="i">GetType</span>());
 
            <b>var</b> <span id="r516 rd" class="r516 r">methods</span> = <span class="r514 r">predicate</span> != <b>null</b>
                              ? (<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r515 r">typeTable</span>.<a href="#9f0b3a7636d870e6" class="i method">GetFirstOrDefault</a>(<span class="r514 r">predicate</span>)
                              : (<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r515 r">typeTable</span><a href="#968b0af707b9b12e">[</a><span class="r513 r">methodName</span>];
 
            <b>if</b> (<span class="r516 r">methods</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r517 rd" class="r517 r">isCtor</span> = <span class="r516 r">methods</span>[0].<span class="i">method</span> <b>is</b> <span class="i">ConstructorInfo</span>;
            <b>bool</b> <span id="r518 rd" class="r518 r">isSpecial</span> = !<span class="r517 r">isCtor</span> &amp;&amp; <span class="r516 r">methods</span>[0].<span class="i">method</span>.<span class="i">IsSpecialName</span>;
 
            <b>return</b> <a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>.<span class="i">Create</span>(<span class="r516 r">methods</span>[0].<span class="i">method</span>.<span class="i">Name</span>, <a href="#27353615475f6dbc" class="k">this</a>, <span class="r512 r">obj</span>, <span class="r516 r">methods</span>, <span class="r518 r">isSpecial</span>, <span class="r516 r">methods</span>.<span class="i">IsHidden</span>) <b>as</b> <span class="r511 r t">T</span>;
        }
 
        <b>internal</b> <span class="r519 r t">T</span> <a id="6541656a66c848e9" href="../R/6541656a66c848e9.html" target="n" data-glyph="74,1" class="i method">GetDotNetProperty</a>&lt;<span id="r519 rd t" class="r519 r t">T</span>&gt;(<b>object</b> <span id="r520 rd" class="r520 r">obj</span>, <b>string</b> <span id="r521 rd" class="r521 r">propertyName</span>) <b>where</b> <span class="r519 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>return</b> <span class="i">GetDotNetPropertyImpl</span>&lt;<span class="r519 r t">T</span>&gt;(<span class="r520 r">obj</span>, <span class="r521 r">propertyName</span>, <span class="i">predicate</span>: <b>null</b>);
        }
 
        <b>internal</b> <span class="r522 r t">T</span> <a id="37b1315c558998d3" href="../R/37b1315c558998d3.html" target="n" data-glyph="74,1" class="i method">GetDotNetMethod</a>&lt;<span id="r522 rd t" class="r522 r t">T</span>&gt;(<b>object</b> <span id="r523 rd" class="r523 r">obj</span>, <b>string</b> <span id="r524 rd" class="r524 r">methodName</span>) <b>where</b> <span class="r522 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>return</b> <span class="i">GetDotNetMethodImpl</span>&lt;<span class="r522 r t">T</span>&gt;(<span class="r523 r">obj</span>, <span class="r524 r">methodName</span>, <span class="i">predicate</span>: <b>null</b>);
        }
 
        <b>protected</b> <span class="r525 r t">T</span> <a id="0957d1020e2e8cce" href="../R/0957d1020e2e8cce.html" target="n" data-glyph="75,1" class="i method">GetFirstDotNetPropertyOrDefault</a>&lt;<span id="r525 rd t" class="r525 r t">T</span>&gt;(<b>object</b> <span id="r526 rd" class="r526 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r527 rd" class="r527 r">predicate</span>) <b>where</b> <span class="r525 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>return</b> <span class="i">GetDotNetPropertyImpl</span>&lt;<span class="r525 r t">T</span>&gt;(<span class="r526 r">obj</span>, <span class="i">propertyName</span>: <b>null</b>, <span class="r527 r">predicate</span>);
        }
 
        <b>protected</b> <span class="r528 r t">T</span> <a id="763d4a2f6fdd79d4" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetFirstDotNetMethodOrDefault</a>&lt;<span id="r528 rd t" class="r528 r t">T</span>&gt;(<b>object</b> <span id="r529 rd" class="r529 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r530 rd" class="r530 r">predicate</span>) <b>where</b> <span class="r528 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>return</b> <span class="i">GetDotNetMethodImpl</span>&lt;<span class="r528 r t">T</span>&gt;(<span class="r529 r">obj</span>, <span class="i">methodName</span>: <b>null</b>, <span class="r530 r">predicate</span>);
        }
 
        <b>protected</b> <span class="r531 r t">T</span> <a id="58b05b65b5688652" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetFirstDotNetEventOrDefault</a>&lt;<span id="r531 rd t" class="r531 r t">T</span>&gt;(<b>object</b> <span id="r532 rd" class="r532 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r533 rd" class="r533 r">predicate</span>) <b>where</b> <span class="r531 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (!<b>typeof</b>(<span class="r531 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#431f0da216e36c56" class="t t">PSEvent</a>)))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r534 rd" class="r534 r">table</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                ? <a href="#c625af2cafee5b8f" class="i method">GetStaticEventReflectionTable</a>((<span class="i">Type</span>)<span class="r532 r">obj</span>)
                : <span class="i">GetInstanceEventReflectionTable</span>(<span class="r532 r">obj</span>.<span class="i">GetType</span>());
 
            <b>foreach</b> (<b>var</b> <span id="r535 rd" class="r535 r">psEvent</span> <b>in</b> <span class="r534 r">table</span>.<span class="i">Values</span>)
            {
                <b>if</b> (<span class="r533 r">predicate</span>(<span class="r535 r">psEvent</span>.<span class="i">events</span>[0].<span class="i">Name</span>))
                {
                    <b>return</b> <b>new</b> <span class="t">PSEvent</span>(<span class="r535 r">psEvent</span>.<span class="i">events</span>[0]) <b>as</b> <span class="r531 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>protected</b> <span class="r536 r t">T</span> <a id="bb4f5c424450daad" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetFirstDynamicMemberOrDefault</a>&lt;<span id="r536 rd t" class="r536 r t">T</span>&gt;(<b>object</b> <span id="r537 rd" class="r537 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r538 rd" class="r538 r">predicate</span>) <b>where</b> <span class="r536 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>var</b> <span id="r539 rd" class="r539 r">idmop</span> = <span class="r537 r">obj</span> <b>as</b> <span class="i">IDynamicMetaObjectProvider</span>;
            <b>if</b> (<span class="r539 r">idmop</span> == <b>null</b> || <span class="r537 r">obj</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (!<b>typeof</b>(<span class="r536 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#277eee0ea8de7929" class="t t">PSDynamicMember</a>)))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>foreach</b> (<b>var</b> <span id="r540 rd" class="r540 r">name</span> <b>in</b> <span class="r539 r">idmop</span>.<span class="i">GetMetaObject</span>(<span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r539 r">idmop</span>.<span class="i">GetType</span>())).<span class="i">GetDynamicMemberNames</span>())
            {
                <b>if</b> (<span class="r538 r">predicate</span>(<span class="r540 r">name</span>))
                {
                    <b>return</b> <b>new</b> <span class="t">PSDynamicMember</span>(<span class="r540 r">name</span>) <b>as</b> <span class="r536 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal void</b> <a id="f410eabc7f8cbc0c" href="../R/f410eabc7f8cbc0c.html" target="n" data-glyph="74,1" class="i method">AddAllProperties</a>&lt;<span id="r541 rd t" class="r541 r t">T</span>&gt;(<b>object</b> <span id="r542 rd" class="r542 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r541 r t">T</span>&gt; <span id="r543 rd" class="r543 r">members</span>, <b>bool</b> <span id="r544 rd" class="r544 r">ignoreDuplicates</span>) <b>where</b> <span class="r541 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>bool</b> <span id="r545 rd" class="r545 r">lookingForProperties</span> = <b>typeof</b>(<span class="r541 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>));
            <b>bool</b> <span id="r546 rd" class="r546 r">lookingForParameterizedProperties</span> = <span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r541 r t">T</span>));
            <b>if</b> (!<span class="r545 r">lookingForProperties</span> &amp;&amp; !<span class="r546 r">lookingForParameterizedProperties</span>)
            {
                <b>return</b>;
            }
 
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r547 rd" class="r547 r">table</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                ? <a href="#5af8d6c7420cc3c9" class="i method">GetStaticPropertyReflectionTable</a>((<span class="i">Type</span>)<span class="r542 r">obj</span>)
                : <span class="i">GetInstancePropertyReflectionTable</span>(<span class="r542 r">obj</span>.<span class="i">GetType</span>());
 
            <b>for</b> (<b>int</b> <span id="r548 rd" class="r548 r">i</span> = 0; <span class="r548 r">i</span> &lt; <span class="r547 r">table</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>; <span class="r548 r">i</span>++)
            {
                <b>if</b> (<span class="r547 r">table</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r548 r">i</span>] <b>is</b> <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r549 rd" class="r549 r">propertyEntry</span>)
                {
                    <b>if</b> (<span class="r545 r">lookingForProperties</span>)
                    {
                        <b>if</b> (!<span class="r544 r">ignoreDuplicates</span> || (<span class="r543 r">members</span>[<span class="r549 r">propertyEntry</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>] == <b>null</b>))
                        {
                            <span class="r543 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(
                                <b>new</b> <span class="t">PSProperty</span>(
                                    <span class="i">name</span>: <span class="r549 r">propertyEntry</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>,
                                    <span class="i">adapter</span>: <a href="#27353615475f6dbc" class="k">this</a>,
                                    <span class="i">baseObject</span>: <span class="r542 r">obj</span>,
                                    <span class="i">adapterData</span>: <span class="r549 r">propertyEntry</span>)
                                { <a href="MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a> = <span class="r549 r">propertyEntry</span>.<a href="#380e189d15ba9351" class="i property">IsHidden</a> } <b>as</b> <span class="r541 r t">T</span>);
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r546 r">lookingForParameterizedProperties</span>)
                {
                    <a href="#f4ae97dd9b847d8b" class="k">var</a> <span id="r550 rd" class="r550 r">parameterizedPropertyEntry</span> = (<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r547 r">table</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r548 r">i</span>];
                    <b>if</b> (!<span class="r544 r">ignoreDuplicates</span> || (<span class="r543 r">members</span><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="r550 r">parameterizedPropertyEntry</span>.<a href="#b342cdcccf025067" class="i field">propertyName</a>] == <b>null</b>))
                    {
                        <span class="c">// TODO: check for HiddenAttribute</span>
                        <span class="c">// We can&#39;t currently write a parameterized property in a PowerShell class so this isn&#39;t too important,</span>
                        <span class="c">// but if someone added the attribute to their C#, it&#39;d be good to set isHidden correctly here.</span>
                        <span class="r543 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#3ecbc15cdeba7bc5" class="t constructor">PSParameterizedProperty</a>(<span class="r550 r">parameterizedPropertyEntry</span>.<a href="#b342cdcccf025067" class="i field">propertyName</a>,
                            <a href="#27353615475f6dbc" class="k">this</a>, <span class="r542 r">obj</span>, <span class="r550 r">parameterizedPropertyEntry</span>) <b>as</b> <span class="r541 r t">T</span>);
                    }
                }
            }
        }
 
        <b>internal void</b> <a id="5d5d96c038baf815" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddAllMethods</a>&lt;<span id="r551 rd t" class="r551 r t">T</span>&gt;(<b>object</b> <span id="r552 rd" class="r552 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r551 r t">T</span>&gt; <span id="r553 rd" class="r553 r">members</span>, <b>bool</b> <span id="r554 rd" class="r554 r">ignoreDuplicates</span>) <b>where</b> <span class="r551 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (!<b>typeof</b>(<span class="r551 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)))
            {
                <b>return</b>;
            }
 
            <a href="#e46a59e67c3de683" class="t t">CacheTable</a> <span id="r555 rd" class="r555 r">table</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                ? <a href="#b7a60670860fdf96" class="i method">GetStaticMethodReflectionTable</a>((<span class="i">Type</span>)<span class="r552 r">obj</span>)
                : <span class="i">GetInstanceMethodReflectionTable</span>(<span class="r552 r">obj</span>.<span class="i">GetType</span>());
 
            <b>for</b> (<b>int</b> <span id="r556 rd" class="r556 r">i</span> = 0; <span class="r556 r">i</span> &lt; <span class="r555 r">table</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>.<span class="i">Count</span>; <span class="r556 r">i</span>++)
            {
                <a href="#6dfefa2e34e759ac" class="k">var</a> <span id="r557 rd" class="r557 r">method</span> = (<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r555 r">table</span>.<a href="#6357f52cb95ce225" class="i field">memberCollection</a>[<span class="r556 r">i</span>];
                <b>var</b> <span id="r558 rd" class="r558 r">isCtor</span> = <span class="r557 r">method</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a> <b>is</b> <span class="i">ConstructorInfo</span>;
                <b>var</b> <span id="r559 rd" class="r559 r">name</span> = <span class="r558 r">isCtor</span> ? <span class="s">&quot;new&quot;</span> : <span class="r557 r">method</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>;
 
                <b>if</b> (!<span class="r554 r">ignoreDuplicates</span> || (<span class="r553 r">members</span><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="r559 r">name</span>] == <b>null</b>))
                {
                    <b>bool</b> <span id="r560 rd" class="r560 r">isSpecial</span> = !<span class="r558 r">isCtor</span> &amp;&amp; <span class="r557 r">method</span>[0].<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">IsSpecialName</span>;
                    <span class="r553 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>.<a href="MshMemberInfo.cs.html#b1052cf4e98bd177" class="i method">Create</a>(<span class="r559 r">name</span>, <a href="#27353615475f6dbc" class="k">this</a>, <span class="r552 r">obj</span>, <span class="r557 r">method</span>, <span class="r560 r">isSpecial</span>, <span class="r557 r">method</span>.<a href="#0ea51ae745f80f8f" class="i property">IsHidden</a>) <b>as</b> <span class="r551 r t">T</span>);
                }
            }
        }
 
        <b>internal void</b> <a id="f3158b668a15c62a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddAllEvents</a>&lt;<span id="r561 rd t" class="r561 r t">T</span>&gt;(<b>object</b> <span id="r562 rd" class="r562 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r561 r t">T</span>&gt; <span id="r563 rd" class="r563 r">members</span>, <b>bool</b> <span id="r564 rd" class="r564 r">ignoreDuplicates</span>) <b>where</b> <span class="r561 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (!<b>typeof</b>(<span class="r561 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#431f0da216e36c56" class="t t">PSEvent</a>)))
            {
                <b>return</b>;
            }
 
            <b>var</b> <span id="r565 rd" class="r565 r">table</span> = <a href="#aa537ca690ae70b3" class="i field">_isStatic</a>
                ? <a href="#c625af2cafee5b8f" class="i method">GetStaticEventReflectionTable</a>((<span class="i">Type</span>)<span class="r562 r">obj</span>)
                : <span class="i">GetInstanceEventReflectionTable</span>(<span class="r562 r">obj</span>.<span class="i">GetType</span>());
 
            <b>foreach</b> (<b>var</b> <span id="r566 rd" class="r566 r">psEvent</span> <b>in</b> <span class="r565 r">table</span>.<span class="i">Values</span>)
            {
                <b>if</b> (!<span class="r564 r">ignoreDuplicates</span> || (<span class="r563 r">members</span>[<span class="r566 r">psEvent</span>.<span class="i">events</span>[0].<span class="i">Name</span>] == <b>null</b>))
                {
                    <span class="r563 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <span class="t">PSEvent</span>(<span class="r566 r">psEvent</span>.<span class="i">events</span>[0]) <b>as</b> <span class="r561 r t">T</span>);
                }
            }
        }
 
        <b>internal void</b> <a id="d921a136d364a9e9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddAllDynamicMembers</a>&lt;<span id="r567 rd t" class="r567 r t">T</span>&gt;(<b>object</b> <span id="r568 rd" class="r568 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r567 r t">T</span>&gt; <span id="r569 rd" class="r569 r">members</span>, <b>bool</b> <span id="r570 rd" class="r570 r">ignoreDuplicates</span>) <b>where</b> <span class="r567 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>var</b> <span id="r571 rd" class="r571 r">idmop</span> = <span class="r568 r">obj</span> <b>as</b> <span class="i">IDynamicMetaObjectProvider</span>;
            <b>if</b> (<span class="r571 r">idmop</span> == <b>null</b> || <span class="r568 r">obj</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (!<b>typeof</b>(<span class="r567 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#277eee0ea8de7929" class="t t">PSDynamicMember</a>)))
            {
                <b>return</b>;
            }
 
            <b>foreach</b> (<b>var</b> <span id="r572 rd" class="r572 r">name</span> <b>in</b> <span class="r571 r">idmop</span>.<span class="i">GetMetaObject</span>(<span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r571 r">idmop</span>.<span class="i">GetType</span>())).<span class="i">GetDynamicMemberNames</span>())
            {
                <span class="r569 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <span class="t">PSDynamicMember</span>(<span class="r572 r">name</span>) <b>as</b> <span class="r567 r t">T</span>);
            }
        }
 
        <b>private static bool</b> <a id="e22b625f705890dc" href="../R/e22b625f705890dc.html" target="n" data-glyph="76,1" class="i method">PropertyIsStatic</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r573 rd" class="r573 r">property</span>)
        {
            <b>if</b> (!(<span class="r573 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a> <b>is</b> <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r574 rd" class="r574 r">entry</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r574 r">entry</span>.<a href="#6bddc5f21ac9fad4" class="i field">isStatic</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> auxiliary methods and classes
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> member
 
        <b>internal override bool</b> <a id="80e01acdfdc97b35" href="../R/80e01acdfdc97b35.html" target="n" data-glyph="74,1" class="i method">CanSiteBinderOptimize</a>(<span class="i">MemberTypes</span> <span id="r575 rd" class="r575 r">typeToOperateOn</span>) { <b>return</b> <b>true</b>; }
 
        <b>private static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">Type</span>, <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt; <a id="4a0fca821fbacafc" href="../R/4a0fca821fbacafc.html" target="n" data-glyph="46,1" class="i field">s_typeToTypeNameDictionary</a> =
            <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">Type</span>, <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt;();
 
        <b>internal static</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="38850b0cfc4d333d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetInternedTypeNameHierarchy</a>(<span class="i">Type</span> <span id="r576 rd" class="r576 r">type</span>)
        {
            <b>return</b> <a href="#4a0fca821fbacafc" class="i field">s_typeToTypeNameDictionary</a>.<span class="i">GetOrAdd</span>(<span class="r576 r">type</span>,
                                                     <span id="r577 rd" class="r577 r">t</span> =&gt; <b>new</b> <a href="TypeTable.cs.html#dd2ddcba91b4f44f" class="t constructor">ConsolidatedString</a>(<span class="i">GetDotNetTypeNameHierarchy</span>(<span class="r577 r">t</span>), <span class="r578 r">interned</span>: <b>true</b>));
        }
 
        <b>protected override</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="e6bf104732bc21f7" href="../R/e6bf104732bc21f7.html" target="n" data-glyph="75,1" class="i method">GetInternedTypeNameHierarchy</a>(<b>object</b> <span id="r579 rd" class="r579 r">obj</span>)
        {
            <b>return</b> <span class="i">GetInternedTypeNameHierarchy</span>(<span class="r579 r">obj</span>.<span class="i">GetType</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the .NET member based on the given member name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remark</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dynamic members of an object that implements IDynamicMetaObjectProvider are not included because</span>
        <span class="c">///</span><span class="c">   1. Dynamic members cannot be invoked via reflection;</span>
        <span class="c">///</span><span class="c">   2. Access to dynamic members is handled by the DLR for free.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remark</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r580 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r581 r">memberName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the member to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSMemberInfo corresponding to memberName from obj,</span>
        <span class="c">///</span><span class="c"> or null if the given member name is not a member in the adapter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r582 r t">T</span> <a id="e436b62014e4af85" href="../R/e436b62014e4af85.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r582 rd t" class="r582 r t">T</span>&gt;(<b>object</b> <span id="r580 rd" class="r580 r">obj</span>, <b>string</b> <span id="r581 rd" class="r581 r">memberName</span>)
        {
            <span class="r582 r t">T</span> <span id="r583 rd" class="r583 r">returnValue</span> = <span class="i">GetDotNetProperty</span>&lt;<span class="r582 r t">T</span>&gt;(<span class="r580 r">obj</span>, <span class="r581 r">memberName</span>);
            <b>if</b> (<span class="r583 r">returnValue</span> != <b>null</b>) <b>return</b> <span class="r583 r">returnValue</span>;
            <b>return</b> <span class="i">GetDotNetMethod</span>&lt;<span class="r582 r t">T</span>&gt;(<span class="r580 r">obj</span>, <span class="r581 r">memberName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the first .NET member whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r584 r t">T</span> <a id="2c6fc4ab99a22626" href="../R/2c6fc4ab99a22626.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r584 rd t" class="r584 r t">T</span>&gt;(<b>object</b> <span id="r585 rd" class="r585 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r586 rd" class="r586 r">predicate</span>)
        {
            <b>return</b> <span class="i">GetFirstDotNetPropertyOrDefault</span>&lt;<span class="r584 r t">T</span>&gt;(<span class="r585 r">obj</span>, <span class="r586 r">predicate</span>) ?? <span class="i">GetFirstDotNetMethodOrDefault</span>&lt;<span class="r584 r t">T</span>&gt;(<span class="r585 r">obj</span>, <span class="r586 r">predicate</span>) ??
                   <span class="i">GetFirstDotNetEventOrDefault</span>&lt;<span class="r584 r t">T</span>&gt;(<span class="r585 r">obj</span>, <span class="r586 r">predicate</span>) ?? <span class="i">GetFirstDynamicMemberOrDefault</span>&lt;<span class="r584 r t">T</span>&gt;(<span class="r585 r">obj</span>, <span class="r586 r">predicate</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the members available in the object.</span>
        <span class="c">///</span><span class="c"> The adapter implementation is encouraged to cache all properties/methods available</span>
        <span class="c">///</span><span class="c"> in the first call to GetMember and GetMembers so that subsequent</span>
        <span class="c">///</span><span class="c"> calls can use the cache.</span>
        <span class="c">///</span><span class="c"> In the case of the .NET adapter that would be a cache from the .NET type to</span>
        <span class="c">///</span><span class="c"> the public properties and fields available in that type.</span>
        <span class="c">///</span><span class="c"> In the case of the DirectoryEntry adapter, this could be a cache of the objectClass</span>
        <span class="c">///</span><span class="c"> to the properties available in it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remark</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dynamic members of an object that implements IDynamicMetaObjectProvider are included because</span>
        <span class="c">///</span><span class="c"> we want to view the dynamic members via &#39;Get-Member&#39; and be able to auto-complete those members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remark</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r587 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the member information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All members in obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r588 r t">T</span>&gt; <a id="01a93321e77ec800" href="../R/01a93321e77ec800.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r588 rd t" class="r588 r t">T</span>&gt;(<b>object</b> <span id="r587 rd" class="r587 r">obj</span>)
        {
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r588 r t">T</span>&gt; <span id="r589 rd" class="r589 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r588 r t">T</span>&gt;();
            <span class="i">AddAllProperties</span>&lt;<span class="r588 r t">T</span>&gt;(<span class="r587 r">obj</span>, <span class="r589 r">returnValue</span>, <b>false</b>);
            <span class="i">AddAllMethods</span>&lt;<span class="r588 r t">T</span>&gt;(<span class="r587 r">obj</span>, <span class="r589 r">returnValue</span>, <b>false</b>);
            <span class="i">AddAllEvents</span>&lt;<span class="r588 r t">T</span>&gt;(<span class="r587 r">obj</span>, <span class="r589 r">returnValue</span>, <b>false</b>);
            <span class="i">AddAllDynamicMembers</span>(<span class="r587 r">obj</span>, <span class="r589 r">returnValue</span>, <b>false</b>);
 
            <b>return</b> <span class="r589 r">returnValue</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> member
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> property
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an array with the property attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r590 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property we want the attributes from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array with the property attributes.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">AttributeCollection</span> <a id="98e75a74ac7405b8" href="../R/98e75a74ac7405b8.html" target="n" data-glyph="75,1" class="i method">PropertyAttributes</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r590 rd" class="r590 r">property</span>)
        {
            <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r591 rd" class="r591 r">adapterData</span> = (<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r590 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <b>return</b> <span class="r591 r">adapterData</span>.<a href="#5e918ae3822db084" class="i property">Attributes</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the property in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r592 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the property in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="9960a2d3dafe196f" href="../R/9960a2d3dafe196f.html" target="n" data-glyph="75,1" class="i method">PropertyToString</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r592 rd" class="r592 r">property</span>)
        {
            <span class="i">StringBuilder</span> <span id="r593 rd" class="r593 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>if</b> (<a href="#e22b625f705890dc" class="i method">PropertyIsStatic</a>(<span class="r592 r">property</span>))
            {
                <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;static &quot;</span>);
            }
 
            <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<a href="#bf6c4c013fd070fd" class="i method">PropertyType</a>(<span class="r592 r">property</span>, <span class="r594 r">forDisplay</span>: <b>true</b>));
            <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
            <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="r592 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot; {&quot;</span>);
            <b>if</b> (<a href="#79a7ac64b10623db" class="i method">PropertyIsGettable</a>(<span class="r592 r">property</span>))
            {
                <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;get;&quot;</span>);
            }
 
            <b>if</b> (<a href="#942848bfb3a04c60" class="i method">PropertyIsSettable</a>(<span class="r592 r">property</span>))
            {
                <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;set;&quot;</span>);
            }
 
            <span class="r593 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
            <b>return</b> <span class="r593 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r595 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="24be6a1da650b7b4" href="../R/24be6a1da650b7b4.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r595 rd" class="r595 r">property</span>)
        {
            <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r596 rd" class="r596 r">adapterData</span> = (<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r595 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
 
            <b>if</b> (<span class="r596 r">adapterData</span>.<a href="#46125476611507e4" class="i field">propertyType</a>.<span class="i">IsByRefLike</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">GetValueException</span>(
                    <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>),
                    <span class="i">innerException</span>: <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>,
                    <span class="r596 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>,
                    <span class="r596 r">adapterData</span>.<a href="#46125476611507e4" class="i field">propertyType</a>);
            }
 
            <span class="i">PropertyInfo</span> <span id="r597 rd" class="r597 r">propertyInfo</span> = <span class="r596 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">PropertyInfo</span>;
            <b>if</b> (<span class="r597 r">propertyInfo</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r596 r">adapterData</span>.<a href="#1dd2f357ccb290c0" class="i field">writeOnly</a>)
                {
                    <b>throw</b> <b>new</b> <span class="t">GetValueException</span>(
                        <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">WriteOnlyProperty</span>),
                        <span class="i">innerException</span>: <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">WriteOnlyProperty</span>,
                        <span class="r597 r">propertyInfo</span>.<span class="i">Name</span>);
                }
 
                <b>if</b> (<span class="r596 r">adapterData</span>.<a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
                {
                    <b>return</b> <span class="r597 r">propertyInfo</span>.<span class="i">GetValue</span>(<span class="r595 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>, <b>null</b>);
                }
                <b>else</b>
                {
                    <b>return</b> <span class="r596 r">adapterData</span>.<a href="#786033b5164ff4ed" class="i property">getterDelegate</a>(<span class="r595 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>);
                }
            }
 
            <span class="i">FieldInfo</span> <span id="r598 rd" class="r598 r">field</span> = <span class="r596 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">FieldInfo</span>;
            <b>if</b> (<span class="r596 r">adapterData</span>.<a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
            {
                <b>return</b> <span class="r598 r">field</span>?.<span class="i">GetValue</span>(<span class="r595 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>);
            }
            <b>else</b>
            {
                <b>return</b> <span class="r596 r">adapterData</span>.<a href="#786033b5164ff4ed" class="i property">getterDelegate</a>(<span class="r595 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r599 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r600 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r601 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="2a51f34f0a9b839b" href="../R/2a51f34f0a9b839b.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r599 rd" class="r599 r">property</span>, <b>object</b> <span id="r600 rd" class="r600 r">setValue</span>, <b>bool</b> <span id="r601 rd" class="r601 r">convertIfPossible</span>)
        {
            <a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a> <span id="r602 rd" class="r602 r">adapterData</span> = (<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r599 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
 
            <b>if</b> (<span class="r602 r">adapterData</span>.<a href="#93842d04ef458a61" class="i field">readOnly</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueException</span>(
                    <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>),
                    <span class="i">innerException</span>: <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>,
                    <span class="r602 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>);
            }
 
            <b>if</b> (<span class="r602 r">adapterData</span>.<a href="#46125476611507e4" class="i field">propertyType</a>.<span class="i">IsByRefLike</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueException</span>(
                    <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>),
                    <span class="i">innerException</span>: <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>,
                    <span class="r602 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a>.<span class="i">Name</span>,
                    <span class="r602 r">adapterData</span>.<a href="#46125476611507e4" class="i field">propertyType</a>);
            }
 
            <span class="i">PropertyInfo</span> <span id="r603 rd" class="r603 r">propertyInfo</span> = <span class="r602 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">PropertyInfo</span>;
            <b>if</b> (<span class="r603 r">propertyInfo</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r601 r">convertIfPossible</span>)
                {
                    <span class="r600 r">setValue</span> = <span class="i">PropertySetAndMethodArgumentConvertTo</span>(<span class="r600 r">setValue</span>, <span class="r603 r">propertyInfo</span>.<span class="i">PropertyType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
 
                <b>if</b> (<span class="r602 r">adapterData</span>.<a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
                {
                    <span class="r603 r">propertyInfo</span>.<span class="i">SetValue</span>(<span class="r599 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>, <span class="r600 r">setValue</span>, <b>null</b>);
                }
                <b>else</b>
                {
                    <span class="r602 r">adapterData</span>.<a href="#5087d15e097e51d2" class="i property">setterDelegate</a>(<span class="r599 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>, <span class="r600 r">setValue</span>);
                }
 
                <b>return</b>;
            }
 
            <span class="i">FieldInfo</span> <span id="r604 rd" class="r604 r">field</span> = <span class="r602 r">adapterData</span>.<a href="#588c19f161433e56" class="i field">member</a> <b>as</b> <span class="i">FieldInfo</span>;
            <b>if</b> (<span class="r601 r">convertIfPossible</span>)
            {
                <span class="r600 r">setValue</span> = <span class="i">PropertySetAndMethodArgumentConvertTo</span>(<span class="r600 r">setValue</span>, <span class="r604 r">field</span>.<span class="i">FieldType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <b>if</b> (<span class="r602 r">adapterData</span>.<a href="#3d8e849eefab9a49" class="i field">useReflection</a>)
            {
                <span class="r604 r">field</span>.<span class="i">SetValue</span>(<span class="r599 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>, <span class="r600 r">setValue</span>);
            }
            <b>else</b>
            {
                <span class="r602 r">adapterData</span>.<a href="#5087d15e097e51d2" class="i property">setterDelegate</a>(<span class="r599 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>, <span class="r600 r">setValue</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r605 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="942848bfb3a04c60" href="../R/942848bfb3a04c60.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r605 rd" class="r605 r">property</span>)
        {
            <b>return</b> !((<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r605 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>).<a href="#93842d04ef458a61" class="i field">readOnly</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r606 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="79a7ac64b10623db" href="../R/79a7ac64b10623db.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r606 rd" class="r606 r">property</span>)
        {
            <b>return</b> !((<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r606 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>).<a href="#1dd2f357ccb290c0" class="i field">writeOnly</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property&#39;s value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r607 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r594 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the member.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="bf6c4c013fd070fd" href="../R/bf6c4c013fd070fd.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r607 rd" class="r607 r">property</span>, <b>bool</b> <span id="r594 rd" class="r594 r">forDisplay</span>)
        {
            <b>var</b> <span id="r608 rd" class="r608 r">propertyType</span> = ((<a href="#e42273e13efeb8a7" class="t t">PropertyCacheEntry</a>)<span class="r607 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>).<a href="#46125476611507e4" class="i field">propertyType</a>;
            <b>return</b> <span class="r594 r">forDisplay</span> ? <a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r608 r">propertyType</span>) : <span class="r608 r">propertyType</span>.<span class="i">FullName</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> property
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> method
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> auxiliary to method calling
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls constructor using the arguments and catching the appropriate exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r609 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Final arguments to the constructor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return of the constructor.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r610 r">methodInformation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Information about the method to call. Used for setting references.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r611 r">originalArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Original arguments in the method call. Used for setting references.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#e6dcf9b0f6d4c9f1" class="t t">MethodInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the constructor throws an exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="9cb34257961fc85a" href="../R/9cb34257961fc85a.html" target="n" data-glyph="74,1" class="i method">AuxiliaryConstructorInvoke</a>(<a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r610 rd" class="r610 r">methodInformation</span>, <b>object</b>[] <span id="r609 rd" class="r609 r">arguments</span>, <b>object</b>[] <span id="r611 rd" class="r611 r">originalArguments</span>)
        {
            <b>object</b> <span id="r612 rd" class="r612 r">returnValue</span>;
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
            <b>try</b>
            {
                <span class="r612 r">returnValue</span> = <span class="r610 r">methodInformation</span>.<a href="#73d5130c197cab35" class="i method">Invoke</a>(<span class="r317 r">target</span>: <b>null</b>, <span class="r609 r">arguments</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r613 rd" class="r613 r">ex</span>)
            {
                <span class="i">Exception</span> <span id="r614 rd" class="r614 r">inner</span> = <span class="r613 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r613 r">ex</span>;
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;DotNetconstructorTargetInvocation&quot;</span>,
                    <span class="r614 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="s">&quot;.ctor&quot;</span>, <span class="r609 r">arguments</span>.<span class="i">Length</span>, <span class="r614 r">inner</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r615 rd" class="r615 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;DotNetconstructorException&quot;</span>,
                    <span class="r615 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="s">&quot;.ctor&quot;</span>, <span class="r609 r">arguments</span>.<span class="i">Length</span>, <span class="r615 r">e</span>.<span class="i">Message</span>);
            }
 
            <a href="#ca72ea1b83c8700c" class="i method">SetReferences</a>(<span class="r609 r">arguments</span>, <span class="r610 r">methodInformation</span>, <span class="r611 r">originalArguments</span>);
            <b>return</b> <span class="r612 r">returnValue</span>;
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls method on target using the arguments and catching the appropriate exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r616 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object we want to call the method on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r617 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Final arguments to the method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r618 r">methodInformation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Information about the method to call. Used for setting references.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r619 r">originalArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Original arguments in the method call. Used for setting references.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return of the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#e6dcf9b0f6d4c9f1" class="t t">MethodInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the method throws an exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="968f9a74d6dd4962" href="../R/968f9a74d6dd4962.html" target="n" data-glyph="74,1" class="i method">AuxiliaryMethodInvoke</a>(<b>object</b> <span id="r616 rd" class="r616 r">target</span>, <b>object</b>[] <span id="r617 rd" class="r617 r">arguments</span>, <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r618 rd" class="r618 r">methodInformation</span>, <b>object</b>[] <span id="r619 rd" class="r619 r">originalArguments</span>)
        {
            <b>object</b> <span id="r620 rd" class="r620 r">result</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
            <b>try</b>
            {
                <span class="c">// call the method and return the result unless the return type is void in which</span>
                <span class="c">// case we&#39;ll return AutomationNull.Value</span>
                <span class="r620 r">result</span> = <span class="r618 r">methodInformation</span>.<a href="#73d5130c197cab35" class="i method">Invoke</a>(<span class="r616 r">target</span>, <span class="r617 r">arguments</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r621 rd" class="r621 r">ex</span>)
            {
                <span class="c">// Special handling to allow methods to throw flowcontrol exceptions</span>
                <span class="c">// Needed for ExitNestedPrompt exception.</span>
                <b>if</b> (<span class="r621 r">ex</span>.<span class="i">InnerException</span> <b>is</b> <a href="lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a> || <span class="r621 r">ex</span>.<span class="i">InnerException</span> <b>is</b> <a href="../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>)
                    <b>throw</b> <span class="r621 r">ex</span>.<span class="i">InnerException</span>;
                <span class="c">// Win7:138054 - When wrapping cmdlets, we want the original exception to be raised,</span>
                <span class="c">// not the wrapped exception that occurs from invoking a steppable pipeline method.</span>
                <b>if</b> (<span class="r621 r">ex</span>.<span class="i">InnerException</span> <b>is</b> <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
                    <b>throw</b> <span class="r621 r">ex</span>.<span class="i">InnerException</span>;
 
                <span class="i">Exception</span> <span id="r622 rd" class="r622 r">inner</span> = <span class="r621 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r621 r">ex</span>;
 
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;DotNetMethodTargetInvocation&quot;</span>,
                    <span class="r622 r">inner</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>, <span class="r617 r">arguments</span>.<span class="i">Length</span>, <span class="r622 r">inner</span>.<span class="i">Message</span>);
            }
            <span class="c">//</span>
            <span class="c">// Note that FlowControlException, ScriptCallDepthException and ParameterBindingException will be wrapped in</span>
            <span class="c">// a TargetInvocationException only when the invocation uses reflection so we need to bubble them up here as well.</span>
            <span class="c">//</span>
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>) { <b>throw</b>; }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>) { <b>throw</b>; }
            <b>catch</b> (<span class="i">Exception</span> <span id="r623 rd" class="r623 r">e</span>)
            {
                <b>if</b> (<span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">DeclaringType</span> == <b>typeof</b>(<a href="lang/scriptblock.cs.html#5e20a8a88cfbe6cb" class="t t">SteppablePipeline</a>) &amp;&amp;
                    (<span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;Begin&quot;</span>) ||
                     <span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;Process&quot;</span>) ||
                     <span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;End&quot;</span>)))
                {
                    <span class="c">// Don&#39;t wrap exceptions that happen when calling methods on SteppablePipeline</span>
                    <span class="c">// that are only used for proxy commands.</span>
                    <b>throw</b>;
                }
 
                <b>throw</b> <b>new</b> <span class="t">MethodInvocationException</span>(
                    <span class="s">&quot;DotNetMethodException&quot;</span>,
                    <span class="r623 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodInvocationException</span>,
                    <span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>, <span class="r617 r">arguments</span>.<span class="i">Length</span>, <span class="r623 r">e</span>.<span class="i">Message</span>);
            }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
 
            <a href="#ca72ea1b83c8700c" class="i method">SetReferences</a>(<span class="r617 r">arguments</span>, <span class="r618 r">methodInformation</span>, <span class="r619 r">originalArguments</span>);
            <span class="i">MethodInfo</span> <span id="r624 rd" class="r624 r">methodInfo</span> = <span class="r618 r">methodInformation</span>.<a href="#3a0e575988f5a5de" class="i field">method</a> <b>as</b> <span class="i">MethodInfo</span>;
            <b>if</b> (<span class="r624 r">methodInfo</span> != <b>null</b> &amp;&amp; <span class="r624 r">methodInfo</span>.<span class="i">ReturnType</span> != <b>typeof</b>(<b>void</b>))
                <b>return</b> <span class="r620 r">result</span>;
            <b>return</b> <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a MethodBase[] into a MethodInformation[]</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r625 r">methods</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The methods to be converted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The MethodInformation[] corresponding to methods.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <a id="7e648f9d6be8ddd7" href="../R/7e648f9d6be8ddd7.html" target="n" data-glyph="74,1" class="i method">GetMethodInformationArray</a>(<span class="i">IList</span>&lt;<span class="i">MethodBase</span>&gt; <span id="r625 rd" class="r625 r">methods</span>)
        {
            <b>var</b> <span id="r626 rd" class="r626 r">returnValue</span> = <b>new</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[<span class="r625 r">methods</span>.<span class="i">Count</span>];
            <b>for</b> (<b>int</b> <span id="r627 rd" class="r627 r">i</span> = 0; <span class="r627 r">i</span> &lt; <span class="r625 r">methods</span>.<span class="i">Count</span>; <span class="r627 r">i</span>++)
            {
                <span class="r626 r">returnValue</span>[<span class="r627 r">i</span>] = <b>new</b> <span class="t">MethodInformation</span>(<span class="r625 r">methods</span>[<span class="r627 r">i</span>], 0);
            }
 
            <b>return</b> <span class="r626 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls the method best suited to the arguments on target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r628 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used for error messages.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r629 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to call the method on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r630 r">methodInformation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Method information corresponding to methods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r631 r">invocationConstraints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation constraints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r632 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments of the call.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return of the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#e6dcf9b0f6d4c9f1" class="t t">MethodInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the method throws an exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If we could not find a method for the given arguments.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="59f80aabdc4be50e" href="../R/59f80aabdc4be50e.html" target="n" data-glyph="74,1" class="i method">MethodInvokeDotNet</a>(
            <b>string</b> <span id="r628 rd" class="r628 r">methodName</span>,
            <b>object</b> <span id="r629 rd" class="r629 r">target</span>,
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r630 rd" class="r630 r">methodInformation</span>,
            <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r631 rd" class="r631 r">invocationConstraints</span>,
            <b>object</b>[] <span id="r632 rd" class="r632 r">arguments</span>)
        {
            <b>object</b>[] <span id="r633 rd" class="r633 r">newArguments</span>;
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r634 rd" class="r634 r">bestMethod</span> = <a href="#aaaa99713b7f3ebc" class="i method">GetBestMethodAndArguments</a>(<span class="r628 r">methodName</span>, <span class="r630 r">methodInformation</span>, <span class="r631 r">invocationConstraints</span>, <span class="r632 r">arguments</span>, <b>out</b> <span class="r633 r">newArguments</span>);
            <b>if</b> (<span class="r634 r">bestMethod</span>.<a href="#3a0e575988f5a5de" class="i field">method</a> <b>is</b> <span class="i">ConstructorInfo</span>)
            {
                <b>return</b> <a href="#c2001637995c8df4" class="i method">InvokeResolvedConstructor</a>(<span class="r634 r">bestMethod</span>, <span class="r633 r">newArguments</span>, <span class="r632 r">arguments</span>);
            }
 
            <b>string</b> <span id="r635 rd" class="r635 r">methodDefinition</span> = <span class="r634 r">bestMethod</span>.<a href="#19363bd11c738b44" class="i property">methodDefinition</a>;
            <a href="lang/parserutils.cs.html#4e9954e542a936a8" class="t t">ScriptTrace</a>.<span class="i">Trace</span>(1, <span class="s">&quot;TraceMethodCall&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">TraceMethodCall</span>, <span class="r635 r">methodDefinition</span>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Calling Method: {0}&quot;</span>, <span class="r635 r">methodDefinition</span>);
            <b>return</b> <a href="#968f9a74d6dd4962" class="i method">AuxiliaryMethodInvoke</a>(<span class="r629 r">target</span>, <span class="r633 r">newArguments</span>, <span class="r634 r">bestMethod</span>, <span class="r632 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls the method best suited to the arguments on target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r636 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type being constructed, used for diagnostics and caching.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r637 r">constructors</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">All overloads for the constructors.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r638 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments of the call.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return of the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#e6dcf9b0f6d4c9f1" class="t t">MethodInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the method throws an exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If we could not find a method for the given arguments.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="6c4f37fa522be898" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ConstructorInvokeDotNet</a>(<span class="i">Type</span> <span id="r636 rd" class="r636 r">type</span>, <span class="i">ConstructorInfo</span>[] <span id="r637 rd" class="r637 r">constructors</span>, <b>object</b>[] <span id="r638 rd" class="r638 r">arguments</span>)
        {
            <b>var</b> <span id="r639 rd" class="r639 r">newConstructors</span> = <span class="i">GetMethodInformationArray</span>(<span class="r637 r">constructors</span>);
            <b>object</b>[] <span id="r640 rd" class="r640 r">newArguments</span>;
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r641 rd" class="r641 r">bestMethod</span> = <span class="i">GetBestMethodAndArguments</span>(<span class="r636 r">type</span>.<span class="i">Name</span>, <span class="r639 r">newConstructors</span>, <span class="r638 r">arguments</span>, <b>out</b> <span class="r640 r">newArguments</span>);
            <b>return</b> <a href="#c2001637995c8df4" class="i method">InvokeResolvedConstructor</a>(<span class="r641 r">bestMethod</span>, <span class="r640 r">newArguments</span>, <span class="r638 r">arguments</span>);
        }
 
        <b>private static object</b> <a id="c2001637995c8df4" href="../R/c2001637995c8df4.html" target="n" data-glyph="76,1" class="i method">InvokeResolvedConstructor</a>(<a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r642 rd" class="r642 r">bestMethod</span>, <b>object</b>[] <span id="r643 rd" class="r643 r">newArguments</span>, <b>object</b>[] <span id="r644 rd" class="r644 r">arguments</span>)
        {
            <b>if</b> ((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#39a46fbab64bf75b" class="i property">Options</a> &amp; <a href="../utils/StructuredTraceSource.cs.html#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="../utils/StructuredTraceSource.cs.html#d9418c516f830881" class="i field">WriteLine</a>) != 0)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Calling Constructor: {0}&quot;</span>, <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#0ec0297a0ce8c005" class="i method">GetMethodInfoOverloadDefinition</a>(<b>null</b>,
                    <span class="r642 r">bestMethod</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>, 0));
            }
 
            <b>return</b> <a href="#9cb34257961fc85a" class="i method">AuxiliaryConstructorInvoke</a>(<span class="r642 r">bestMethod</span>, <span class="r643 r">newArguments</span>, <span class="r644 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a flavor of MethodInvokeDotNet to deal with a peculiarity of property setters:</span>
        <span class="c">///</span><span class="c"> Tthe setValue is always the last parameter. This enables a parameter after a varargs or optional</span>
        <span class="c">///</span><span class="c"> parameters and GetBestMethodAndArguments is not prepared for that.</span>
        <span class="c">///</span><span class="c"> This method disregards the last parameter in its call to GetBestMethodAndArguments used in this case</span>
        <span class="c">///</span><span class="c"> more for its &quot;Arguments&quot; side than for its &quot;BestMethod&quot; side, since there is only one method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="2c4d1b4e894bc062" href="../R/2c4d1b4e894bc062.html" target="n" data-glyph="74,1" class="i method">ParameterizedPropertyInvokeSet</a>(<b>string</b> <span id="r645 rd" class="r645 r">propertyName</span>, <b>object</b> <span id="r646 rd" class="r646 r">target</span>, <b>object</b> <span id="r647 rd" class="r647 r">valuetoSet</span>, <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a>[] <span id="r648 rd" class="r648 r">methodInformation</span>, <b>object</b>[] <span id="r649 rd" class="r649 r">arguments</span>)
        {
            <span class="c">// bestMethodIndex is ignored since we know we have only 1 method. GetBestMethodAndArguments</span>
            <span class="c">// is still useful to deal with optional and varargs parameters and to perform the type conversions</span>
            <span class="c">// of all parameters but the last one</span>
            <b>object</b>[] <span id="r650 rd" class="r650 r">newArguments</span>;
            <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r651 rd" class="r651 r">bestMethod</span> = <a href="#e944e95cc84a218e" class="i method">GetBestMethodAndArguments</a>(<span class="r645 r">propertyName</span>, <span class="r648 r">methodInformation</span>, <span class="r649 r">arguments</span>, <b>out</b> <span class="r650 r">newArguments</span>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Calling Set Method: {0}&quot;</span>, <span class="r651 r">bestMethod</span>.<a href="#19363bd11c738b44" class="i property">methodDefinition</a>);
            <span class="i">ParameterInfo</span>[] <span id="r652 rd" class="r652 r">bestMethodParameters</span> = <span class="r651 r">bestMethod</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>.<span class="i">GetParameters</span>();
            <span class="i">Type</span> <span id="r653 rd" class="r653 r">propertyType</span> = <span class="r652 r">bestMethodParameters</span>[<span class="r652 r">bestMethodParameters</span>.<span class="i">Length</span> - 1].<span class="i">ParameterType</span>;
 
            <span class="c">// we have to convert the last parameter (valuetoSet) manually since it has been</span>
            <span class="c">// disregarded in GetBestMethodAndArguments.</span>
            <b>object</b> <span id="r654 rd" class="r654 r">lastArgument</span>;
            <b>try</b>
            {
                <span class="r654 r">lastArgument</span> = <span class="i">PropertySetAndMethodArgumentConvertTo</span>(<span class="r647 r">valuetoSet</span>, <span class="r653 r">propertyType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r655 rd" class="r655 r">e</span>)
            {
                <span class="c">// NTRAID#Windows Out Of Band Releases-924162-2005/11/17-JonN</span>
                <b>throw</b> <b>new</b> <span class="t">MethodException</span>(
                    <span class="s">&quot;PropertySetterConversionInvalidCastArgument&quot;</span>,
                    <span class="r655 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentConversionException</span>,
                    <span class="r649 r">arguments</span>.<span class="i">Length</span> - 1, <span class="r647 r">valuetoSet</span>, <span class="r645 r">propertyName</span>, <span class="r653 r">propertyType</span>, <span class="r655 r">e</span>.<span class="i">Message</span>);
            }
 
            <span class="c">// and we also have to rebuild the argument array to include the last parameter</span>
            <b>object</b>[] <span id="r656 rd" class="r656 r">finalArguments</span> = <b>new</b> <b>object</b>[<span class="r650 r">newArguments</span>.<span class="i">Length</span> + 1];
            <b>for</b> (<b>int</b> <span id="r657 rd" class="r657 r">i</span> = 0; <span class="r657 r">i</span> &lt; <span class="r650 r">newArguments</span>.<span class="i">Length</span>; <span class="r657 r">i</span>++)
            {
                <span class="r656 r">finalArguments</span>[<span class="r657 r">i</span>] = <span class="r650 r">newArguments</span>[<span class="r657 r">i</span>];
            }
 
            <span class="r656 r">finalArguments</span>[<span class="r650 r">newArguments</span>.<span class="i">Length</span>] = <span class="r654 r">lastArgument</span>;
 
            <a href="#968f9a74d6dd4962" class="i method">AuxiliaryMethodInvoke</a>(<span class="r646 r">target</span>, <span class="r656 r">finalArguments</span>, <span class="r651 r">bestMethod</span>, <span class="r649 r">arguments</span>);
        }
 
        <b>internal static string</b> <a id="0ec0297a0ce8c005" href="../R/0ec0297a0ce8c005.html" target="n" data-glyph="74,1" class="i method">GetMethodInfoOverloadDefinition</a>(<b>string</b> <span id="r658 rd" class="r658 r">memberName</span>, <span class="i">MethodBase</span> <span id="r659 rd" class="r659 r">methodEntry</span>, <b>int</b> <span id="r660 rd" class="r660 r">parametersToIgnore</span>)
        {
            <span class="i">StringBuilder</span> <span id="r661 rd" class="r661 r">builder</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>if</b> (<span class="r659 r">methodEntry</span>.<span class="i">IsStatic</span>)
            {
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&quot;static &quot;</span>);
            }
 
            <span class="i">MethodInfo</span> <span id="r662 rd" class="r662 r">method</span> = <span class="r659 r">methodEntry</span> <b>as</b> <span class="i">MethodInfo</span>;
            <b>if</b> (<span class="r662 r">method</span> != <b>null</b>)
            {
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r662 r">method</span>.<span class="i">ReturnType</span>));
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
            }
            <b>else</b>
            {
                <span class="i">ConstructorInfo</span> <span id="r663 rd" class="r663 r">ctorInfo</span> = <span class="r659 r">methodEntry</span> <b>as</b> <span class="i">ConstructorInfo</span>;
                <b>if</b> (<span class="r663 r">ctorInfo</span> != <b>null</b>)
                {
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r663 r">ctorInfo</span>.<span class="i">DeclaringType</span>));
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                }
            }
 
            <b>if</b> (<span class="r659 r">methodEntry</span>.<span class="i">DeclaringType</span>.<span class="i">IsInterface</span>)
            {
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r659 r">methodEntry</span>.<span class="i">DeclaringType</span>, <span class="i">dropNamespaces</span>: <b>true</b>));
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;.&#39;</span>);
            }
 
            <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="r658 r">memberName</span> ?? <span class="r659 r">methodEntry</span>.<span class="i">Name</span>);
            <b>if</b> (<span class="r659 r">methodEntry</span>.<span class="i">IsGenericMethodDefinition</span>)
            {
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
 
                <span class="i">Type</span>[] <span id="r664 rd" class="r664 r">genericArgs</span> = <span class="r659 r">methodEntry</span>.<span class="i">GetGenericArguments</span>();
                <b>for</b> (<b>int</b> <span id="r665 rd" class="r665 r">i</span> = 0; <span class="r665 r">i</span> &lt; <span class="r664 r">genericArgs</span>.<span class="i">Length</span>; <span class="r665 r">i</span>++)
                {
                    <b>if</b> (<span class="r665 r">i</span> &gt; 0) { <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>); }
 
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r664 r">genericArgs</span>[<span class="r665 r">i</span>]));
                }
 
                <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
            }
 
            <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;(&#39;</span>);
            <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">ParameterInfo</span>[] <span id="r666 rd" class="r666 r">parameters</span> = <span class="r659 r">methodEntry</span>.<span class="i">GetParameters</span>();
            <b>int</b> <span id="r667 rd" class="r667 r">parametersLength</span> = <span class="r666 r">parameters</span>.<span class="i">Length</span> - <span class="r660 r">parametersToIgnore</span>;
            <b>if</b> (<span class="r667 r">parametersLength</span> &gt; 0)
            {
                <b>for</b> (<b>int</b> <span id="r668 rd" class="r668 r">i</span> = 0; <span class="r668 r">i</span> &lt; <span class="r667 r">parametersLength</span>; <span class="r668 r">i</span>++)
                {
                    <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">ParameterInfo</span> <span id="r669 rd" class="r669 r">parameter</span> = <span class="r666 r">parameters</span>[<span class="r668 r">i</span>];
                    <b>var</b> <span id="r670 rd" class="r670 r">parameterType</span> = <span class="r669 r">parameter</span>.<span class="i">ParameterType</span>;
                    <b>if</b> (<span class="r670 r">parameterType</span>.<span class="i">IsByRef</span>)
                    {
                        <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&quot;[ref] &quot;</span>);
                        <span class="r670 r">parameterType</span> = <span class="r670 r">parameterType</span>.<span class="i">GetElementType</span>();
                    }
 
                    <b>if</b> (<span class="r670 r">parameterType</span>.<span class="i">IsArray</span> &amp;&amp; (<span class="r668 r">i</span> == <span class="r667 r">parametersLength</span> - 1))
                    {
                        <span class="c">// The extension method &#39;CustomAttributeExtensions.GetCustomAttributes(ParameterInfo, Type, Boolean)&#39; has inconsistent</span>
                        <span class="c">// behavior on its return value in both FullCLR and CoreCLR. According to MSDN, if the attribute cannot be found, it</span>
                        <span class="c">// should return an empty collection. However, it returns null in some rare cases [when the parameter isn&#39;t backed by</span>
                        <span class="c">// actual metadata].</span>
                        <span class="c">// This inconsistent behavior affects OneCore powershell because we are using the extension method here when compiling</span>
                        <span class="c">// against CoreCLR. So we need to add a null check until this is fixed in CLR.</span>
                        <b>var</b> <span id="r671 rd" class="r671 r">paramArrayAttrs</span> = <span class="r669 r">parameter</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<span class="i">ParamArrayAttribute</span>), <b>false</b>);
                        <b>if</b> (<span class="r671 r">paramArrayAttrs</span> != <b>null</b> &amp;&amp; <span class="r671 r">paramArrayAttrs</span>.<span class="i">Length</span> &gt; 0)
                            <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&quot;Params &quot;</span>);
                    }
 
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r670 r">parameterType</span>));
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="r669 r">parameter</span>.<span class="i">Name</span>);
                    <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                }
 
                <span class="r661 r">builder</span>.<span class="i">Remove</span>(<span class="r661 r">builder</span>.<span class="i">Length</span> - 2, 2);
            }
 
            <span class="r661 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
 
            <b>return</b> <span class="r661 r">builder</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> auxiliary to method calling
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to try to call</span>
        <span class="c">///</span><span class="c"> the method with the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r672 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMethods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r673 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="49fb8ee1ecc8c510" href="../R/49fb8ee1ecc8c510.html" target="n" data-glyph="75,1" class="i method">MethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r672 rd" class="r672 r">method</span>, <b>object</b>[] <span id="r673 rd" class="r673 r">arguments</span>)
        {
            <b>return</b> <a href="#27353615475f6dbc" class="k">this</a>.<a href="#9feab2a3bcedf5d5" class="i method">MethodInvoke</a>(<span class="r672 r">method</span>, <b>null</b>, <span class="r673 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to try to call</span>
        <span class="c">///</span><span class="c"> the method with the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r674 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMethods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r675 r">invocationConstraints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation constraints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r676 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="9feab2a3bcedf5d5" href="../R/9feab2a3bcedf5d5.html" target="n" data-glyph="75,1" class="i method">MethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r674 rd" class="r674 r">method</span>, <a href="MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r675 rd" class="r675 r">invocationConstraints</span>, <b>object</b>[] <span id="r676 rd" class="r676 r">arguments</span>)
        {
            <a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a> <span id="r677 rd" class="r677 r">methodEntry</span> = (<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r674 r">method</span>.<a href="MshMemberInfo.cs.html#90d6e570e2f5700c" class="i field">adapterData</a>;
            <b>return</b> <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#59f80aabdc4be50e" class="i method">MethodInvokeDotNet</a>(
                <span class="r674 r">method</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                <span class="r674 r">method</span>.<a href="MshMemberInfo.cs.html#690c27a539d8abab" class="i field">baseObject</a>,
                <span class="r677 r">methodEntry</span>.<a href="#faf234dfe054f8ec" class="i field">methodInformationStructures</a>,
                <span class="r675 r">invocationConstraints</span>,
                <span class="r676 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to return the overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r678 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The return of GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="9a54e1d830f846d9" href="../R/9a54e1d830f846d9.html" target="n" data-glyph="75,1" class="i method">MethodDefinitions</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r678 rd" class="r678 r">method</span>)
        {
            <a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a> <span id="r679 rd" class="r679 r">methodEntry</span> = (<a href="#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r678 r">method</span>.<a href="MshMemberInfo.cs.html#90d6e570e2f5700c" class="i field">adapterData</a>;
            <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r680 rd" class="r680 r">uniqueValues</span> = <span class="r679 r">methodEntry</span>
                .<a href="#faf234dfe054f8ec" class="i field">methodInformationStructures</a>
                .<span class="i">Select</span>(<b>static</b> <span id="r681 rd" class="r681 r">m</span> =&gt; <span class="r681 r">m</span>.<span class="i">methodDefinition</span>)
                .<span class="i">Distinct</span>(<span class="i">StringComparer</span>.<span class="i">Ordinal</span>)
                .<span class="i">ToList</span>();
            <b>return</b> <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<span class="r680 r">uniqueValues</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> method
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameterized property
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property&#39;s value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r682 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the member.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="32acbb3a8dadc943" href="../R/32acbb3a8dadc943.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyType</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r682 rd" class="r682 r">property</span>)
        {
            <a href="#f4ae97dd9b847d8b" class="k">var</a> <span id="r683 rd" class="r683 r">adapterData</span> = (<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r682 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>;
            <b>return</b> <span class="r683 r">adapterData</span>.<a href="#38808cd96083abb0" class="i field">propertyType</a>.<span class="i">FullName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r684 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="dad9bf5741098f3d" href="../R/dad9bf5741098f3d.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r684 rd" class="r684 r">property</span>)
        {
            <b>return</b> !((<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r684 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>).<a href="#6587d647fcc65895" class="i field">readOnly</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r685 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="aae1a78a02fbad01" href="../R/aae1a78a02fbad01.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r685 rd" class="r685 r">property</span>)
        {
            <b>return</b> !((<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r685 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>).<a href="#87ee699bf94c0126" class="i field">writeOnly</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to get the property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r686 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r687 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="dd439f31565c9055" href="../R/dd439f31565c9055.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyGet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r686 rd" class="r686 r">property</span>, <b>object</b>[] <span id="r687 rd" class="r687 r">arguments</span>)
        {
            <a href="#f4ae97dd9b847d8b" class="k">var</a> <span id="r688 rd" class="r688 r">adapterData</span> = (<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r686 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>;
            <b>return</b> <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="#59f80aabdc4be50e" class="i method">MethodInvokeDotNet</a>(<span class="r686 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r686 r">property</span>.<a href="MshMemberInfo.cs.html#e2a044cc0681cf3e" class="i field">baseObject</a>,
                <span class="r688 r">adapterData</span>.<a href="#286d5059f2e36343" class="i field">getterInformation</a>, <b>null</b>, <span class="r687 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to set the property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r689 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r690 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r691 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="aca3b3d273f26436" href="../R/aca3b3d273f26436.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertySet</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r689 rd" class="r689 r">property</span>, <b>object</b> <span id="r690 rd" class="r690 r">setValue</span>, <b>object</b>[] <span id="r691 rd" class="r691 r">arguments</span>)
        {
            <a href="#f4ae97dd9b847d8b" class="k">var</a> <span id="r692 rd" class="r692 r">adapterData</span> = (<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r689 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>;
            <a href="#2c4d1b4e894bc062" class="i method">ParameterizedPropertyInvokeSet</a>(<span class="r692 r">adapterData</span>.<a href="#b342cdcccf025067" class="i field">propertyName</a>, <span class="r689 r">property</span>.<a href="MshMemberInfo.cs.html#e2a044cc0681cf3e" class="i field">baseObject</a>, <span class="r690 r">setValue</span>,
                <span class="r692 r">adapterData</span>.<a href="#88a36133c0dc84ef" class="i field">setterInformation</a>, <span class="r691 r">arguments</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to return the overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="b994718679ef093e" href="../R/b994718679ef093e.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyDefinitions</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r693 rd" class="r693 r">property</span>)
        {
            <a href="#f4ae97dd9b847d8b" class="k">var</a> <span id="r694 rd" class="r694 r">adapterData</span> = (<a href="#f4ae97dd9b847d8b" class="t t">ParameterizedPropertyCacheEntry</a>)<span class="r693 r">property</span>.<a href="MshMemberInfo.cs.html#3f0b10b66a386cf5" class="i field">adapterData</a>;
            <b>var</b> <span id="r695 rd" class="r695 r">returnValue</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>for</b> (<b>int</b> <span id="r696 rd" class="r696 r">i</span> = 0; <span class="r696 r">i</span> &lt; <span class="r694 r">adapterData</span>.<a href="#0d623e7cee7e8743" class="i field">propertyDefinition</a>.<span class="i">Length</span>; <span class="r696 r">i</span>++)
            {
                <span class="r695 r">returnValue</span>.<span class="i">Add</span>(<span class="r694 r">adapterData</span>.<a href="#0d623e7cee7e8743" class="i field">propertyDefinition</a>[<span class="r696 r">i</span>]);
            }
 
            <b>return</b> <span class="r695 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the property in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r697 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the property in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="df906dcb43298cbf" href="../R/df906dcb43298cbf.html" target="n" data-glyph="75,1" class="i method">ParameterizedPropertyToString</a>(<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r697 rd" class="r697 r">property</span>)
        {
            <span class="i">StringBuilder</span> <span id="r698 rd" class="r698 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r699 rd" class="r699 r">definitions</span> = <a href="#b994718679ef093e" class="i method">ParameterizedPropertyDefinitions</a>(<span class="r697 r">property</span>);
            <b>for</b> (<b>int</b> <span id="r700 rd" class="r700 r">i</span> = 0; <span class="r700 r">i</span> &lt; <span class="r699 r">definitions</span>.<span class="i">Count</span>; <span class="r700 r">i</span>++)
            {
                <span class="r698 r">returnValue</span>.<span class="i">Append</span>(<span class="r699 r">definitions</span>[<span class="r700 r">i</span>]);
                <span class="r698 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
            }
 
            <span class="r698 r">returnValue</span>.<span class="i">Remove</span>(<span class="r698 r">returnValue</span>.<span class="i">Length</span> - 2, 2);
            <b>return</b> <span class="r698 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameterized property
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DotNetAdapterWithOnlyPropertyLookup
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is used by PSObject to support dotnet member lookup for the adapted</span>
    <span class="c">///</span><span class="c"> objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class is created to avoid cluttering DotNetAdapter with if () { } blocks .</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="ca31faada82abbbb" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="dac2b09f85df0203">BaseDotNetAdapterForAdaptedObjects</span></a> : <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a collection representing the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r701 r">obj</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object&#39;s</span>
        <span class="c">///</span><span class="c"> members as returned by CLR reflection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r702 r t">T</span>&gt; <a id="f6f317fcd6d8b779" href="../R/f6f317fcd6d8b779.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r702 rd t" class="r702 r t">T</span>&gt;(<b>object</b> <span id="r701 rd" class="r701 r">obj</span>)
        {
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r702 r t">T</span>&gt; <span id="r703 rd" class="r703 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r702 r t">T</span>&gt;();
            <span class="i">AddAllProperties</span>&lt;<span class="r702 r t">T</span>&gt;(<span class="r701 r">obj</span>, <span class="r703 r">returnValue</span>, <b>true</b>);
            <span class="i">AddAllMethods</span>&lt;<span class="r702 r t">T</span>&gt;(<span class="r701 r">obj</span>, <span class="r703 r">returnValue</span>, <b>true</b>);
            <span class="i">AddAllEvents</span>&lt;<span class="r702 r t">T</span>&gt;(<span class="r701 r">obj</span>, <span class="r703 r">returnValue</span>, <b>true</b>);
 
            <b>return</b> <span class="r703 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a member representing the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r704 r">obj</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> as given by CLR reflection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r705 r t">T</span> <a id="a964f270f33ef37b" href="../R/a964f270f33ef37b.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r705 rd t" class="r705 r t">T</span>&gt;(<b>object</b> <span id="r704 rd" class="r704 r">obj</span>, <b>string</b> <span id="r706 rd" class="r706 r">memberName</span>)
        {
            <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r707 rd" class="r707 r">property</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#6541656a66c848e9" class="i method">GetDotNetProperty</a>&lt;<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>&gt;(<span class="r704 r">obj</span>, <span class="r706 r">memberName</span>);
            <b>if</b> (<b>typeof</b>(<span class="r705 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)) &amp;&amp; (<span class="r707 r">property</span> != <b>null</b>))
            {
                <b>return</b> <span class="r707 r">property</span> <b>as</b> <span class="r705 r t">T</span>;
            }
 
            <span class="c">// In order to not break v1..base dotnet adapter should not return methods</span>
            <span class="c">// when accessed with T as PSMethod.. accessing method with PSMemberInfo</span>
            <span class="c">// is ok as property always gets precedence over methods and duplicates</span>
            <span class="c">// are ignored.</span>
            <b>if</b> (<b>typeof</b>(<span class="r705 r t">T</span>) == <b>typeof</b>(<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>))
            {
                <span class="r705 r t">T</span> <span id="r708 rd" class="r708 r">returnValue</span> = <a href="#27353615475f6dbc" class="k">base</a>.<span class="i">GetDotNetMethod</span>&lt;<span class="r705 r t">T</span>&gt;(<span class="r704 r">obj</span>, <span class="r706 r">memberName</span>);
                <span class="c">// We only return a method if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r708 r">returnValue</span> != <b>null</b> &amp;&amp; <span class="r707 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r708 r">returnValue</span>;
                }
            }
 
            <b>if</b> (<span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r705 r t">T</span>)))
            {
                <a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r709 rd" class="r709 r">parameterizedProperty</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#6541656a66c848e9" class="i method">GetDotNetProperty</a>&lt;<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>&gt;(<span class="r704 r">obj</span>, <span class="r706 r">memberName</span>);
                <span class="c">// We only return a parameterized property if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r709 r">parameterizedProperty</span> != <b>null</b> &amp;&amp; <span class="r707 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r709 r">parameterizedProperty</span> <b>as</b> <span class="r705 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first reflection member whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r710 r t">T</span> <a id="3b8836c3823e8ff1" href="../R/3b8836c3823e8ff1.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r710 rd t" class="r710 r t">T</span>&gt;(<b>object</b> <span id="r711 rd" class="r711 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r712 rd" class="r712 r">predicate</span>)
        {
            <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r713 rd" class="r713 r">property</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#0957d1020e2e8cce" class="i method">GetFirstDotNetPropertyOrDefault</a>&lt;<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>&gt;(<span class="r711 r">obj</span>, <span class="r712 r">predicate</span>);
            <b>if</b> (<b>typeof</b>(<span class="r710 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)) &amp;&amp; <span class="r713 r">property</span> != <b>null</b>)
            {
                <b>return</b> <span class="r713 r">property</span> <b>as</b> <span class="r710 r t">T</span>;
            }
 
            <span class="c">// In order to not break v1..base dotnet adapter should not return methods</span>
            <span class="c">// when accessed with T as PSMethod.. accessing method with PSMemberInfo</span>
            <span class="c">// is ok as property always gets precedence over methods and duplicates</span>
            <span class="c">// are ignored.</span>
            <b>if</b> (<b>typeof</b>(<span class="r710 r t">T</span>) == <b>typeof</b>(<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>))
            {
                <span class="r710 r t">T</span> <span id="r714 rd" class="r714 r">returnValue</span> = <a href="#27353615475f6dbc" class="k">base</a>.<span class="i">GetFirstDotNetMethodOrDefault</span>&lt;<span class="r710 r t">T</span>&gt;(<span class="r711 r">obj</span>, <span class="r712 r">predicate</span>);
 
                <span class="c">// We only return a method if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r714 r">returnValue</span> != <b>null</b> &amp;&amp; <span class="r713 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r714 r">returnValue</span>;
                }
            }
 
            <b>if</b> (<span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r710 r t">T</span>)))
            {
                <a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="k">var</a> <span id="r715 rd" class="r715 r">parameterizedProperty</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#0957d1020e2e8cce" class="i method">GetFirstDotNetPropertyOrDefault</a>&lt;<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>&gt;(<span class="r711 r">obj</span>, <span class="r712 r">predicate</span>);
 
                <span class="c">// We only return a parameterized property if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r715 r">parameterizedProperty</span> != <b>null</b> &amp;&amp; <span class="r713 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r715 r">parameterizedProperty</span> <b>as</b> <span class="r710 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used only to add a COM style type name to a COM interop .NET type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="e199bf25cb6cab7b" href="../R/e199bf25cb6cab7b.html" target="n" data-glyph="2,0" class="t t">DotNetAdapterWithComTypeName</a> : <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>
    {
        <b>private readonly</b> <a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a> <a id="3b1f4a8a6bc4cbae" href="../R/3b1f4a8a6bc4cbae.html" target="n" data-glyph="46,1" class="i field">_comTypeInfo</a>;
 
        <b>internal</b> <a id="95818270c558d5d0" href="../R/95818270c558d5d0.html" target="n" data-glyph="74,1" class="t constructor">DotNetAdapterWithComTypeName</a>(<a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a> <span id="r716 rd" class="r716 r">comTypeInfo</span>)
        {
            <a href="#3b1f4a8a6bc4cbae" class="i field">_comTypeInfo</a> = <span class="r716 r">comTypeInfo</span>;
        }
 
        <b>protected override</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="1bfb1c84866ea8c6" href="../R/1bfb1c84866ea8c6.html" target="n" data-glyph="75,1" class="i method">GetTypeNameHierarchy</a>(<b>object</b> <span id="r717 rd" class="r717 r">obj</span>)
        {
            <b>for</b> (<span class="i">Type</span> <span id="r718 rd" class="r718 r">type</span> = <span class="r717 r">obj</span>.<span class="i">GetType</span>(); <span class="r718 r">type</span> != <b>null</b>; <span class="r718 r">type</span> = <span class="r718 r">type</span>.<span class="i">BaseType</span>)
            {
                <b>if</b> (<span class="r718 r">type</span>.<span class="i">FullName</span>.<span class="i">Equals</span>(<span class="s">&quot;System.__ComObject&quot;</span>))
                {
                    <b>yield</b> <b>return</b> <a href="COM/ComAdapter.cs.html#61b1810077624f4a" class="t t">ComAdapter</a>.<a href="COM/ComAdapter.cs.html#2209bc5395f688ab" class="i method">GetComTypeName</a>(<a href="#3b1f4a8a6bc4cbae" class="i field">_comTypeInfo</a>.<a href="COM/ComTypeInfo.cs.html#44617c5c4229bcb9" class="i property">Clsid</a>);
                }
 
                <b>yield</b> <b>return</b> <span class="r718 r">type</span>.<span class="i">FullName</span>;
            }
        }
 
        <b>protected override</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="46db5bb06cd6fb3b" href="../R/46db5bb06cd6fb3b.html" target="n" data-glyph="75,1" class="i method">GetInternedTypeNameHierarchy</a>(<b>object</b> <span id="r719 rd" class="r719 r">obj</span>)
        {
            <b>return</b> <b>new</b> <a href="TypeTable.cs.html#dd2ddcba91b4f44f" class="t constructor">ConsolidatedString</a>(<a href="#1bfb1c84866ea8c6" class="i method">GetTypeNameHierarchy</a>(<span class="r719 r">obj</span>), <span class="r578 r">interned</span>: <b>true</b>);
        }
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Adapter used for GetMember and GetMembers only.</span>
    <span class="c">///</span><span class="c"> All other methods will not be called.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="8976b5fe8aa99f4a" href="../R/8976b5fe8aa99f4a.html" target="n" data-glyph="2,0" class="t t"><span id="9a437f43fea391ea">MemberRedirectionAdapter</span></a> : <a href="#88aa0312e9fc25c7" class="t t">Adapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> property specific
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an array with the property attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r720 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property we want the attributes from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array with the property attributes.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">AttributeCollection</span> <a id="6787b89021f6a477" href="../R/6787b89021f6a477.html" target="n" data-glyph="75,1" class="i method">PropertyAttributes</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r720 rd" class="r720 r">property</span>)
        {
            <b>return</b> <b>new</b> <span class="i">AttributeCollection</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r721 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="d21ca32e8d42cc3f" href="../R/d21ca32e8d42cc3f.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r721 rd" class="r721 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to GetMember.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r722 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r723 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r724 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="0630e72141bb77c0" href="../R/0630e72141bb77c0.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r722 rd" class="r722 r">property</span>, <b>object</b> <span id="r723 rd" class="r723 r">setValue</span>, <b>bool</b> <span id="r724 rd" class="r724 r">convertIfPossible</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r725 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="35510976e69ce5c6" href="../R/35510976e69ce5c6.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r725 rd" class="r725 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r726 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="c4e7ae2911760f5a" href="../R/c4e7ae2911760f5a.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r726 rd" class="r726 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property&#39;s value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r727 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r728 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the member.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="dd8826da6dbe97ac" href="../R/dd8826da6dbe97ac.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r727 rd" class="r727 r">property</span>, <b>bool</b> <span id="r728 rd" class="r728 r">forDisplay</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the property in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r729 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property obtained in a previous GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the property in the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="346720256a457b3c" href="../R/346720256a457b3c.html" target="n" data-glyph="75,1" class="i method">PropertyToString</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r729 rd" class="r729 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for properties&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> property specific
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> method specific
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to try to call</span>
        <span class="c">///</span><span class="c"> the method with the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r730 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The non empty return from GetMethods.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r731 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The return value for the method.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="9ddd24858bfd4e77" href="../R/9ddd24858bfd4e77.html" target="n" data-glyph="75,1" class="i method">MethodInvoke</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r730 rd" class="r730 r">method</span>, <b>object</b>[] <span id="r731 rd" class="r731 r">arguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for methods&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after a non null return from GetMember to return the overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r732 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The return of GetMember.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="db0938116798050b" href="../R/db0938116798050b.html" target="n" data-glyph="75,1" class="i method">MethodDefinitions</a>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r732 rd" class="r732 r">method</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;redirection adapter is not called for methods&quot;</span>);
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> method specific
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Adapter for properties in the inside PSObject if it has a null BaseObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="aea14fe5945858f4" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="aeac3678f87f1a30">PSObjectAdapter</span></a> : <a href="#8976b5fe8aa99f4a" class="t t">MemberRedirectionAdapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the TypeNameHierarchy out of an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r733 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get the TypeNameHierarchy from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="206d8aadc33f463c" href="../R/206d8aadc33f463c.html" target="n" data-glyph="75,1" class="i method">GetTypeNameHierarchy</a>(<b>object</b> <span id="r733 rd" class="r733 r">obj</span>)
        {
            <b>return</b> ((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r733 r">obj</span>).<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if memberName is not a member in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSMemberInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r734 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r735 r">memberName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the member to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to memberName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r736 r t">T</span> <a id="907889e1142f69fa" href="../R/907889e1142f69fa.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r736 rd t" class="r736 r t">T</span>&gt;(<b>object</b> <span id="r734 rd" class="r734 r">obj</span>, <b>string</b> <span id="r735 rd" class="r735 r">memberName</span>)
        {
            <b>return</b> ((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r734 r">obj</span>).<a href="MshObject.cs.html#56bc82b240e4291b" class="i property">Members</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r735 r">memberName</span>] <b>as</b> <span class="r736 r t">T</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first PSMemberInfo whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r737 r t">T</span> <a id="d96b7e1dcfad9891" href="../R/d96b7e1dcfad9891.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r737 rd t" class="r737 r t">T</span>&gt;(<b>object</b> <span id="r738 rd" class="r738 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r739 rd" class="r739 r">predicate</span>)
        {
            <b>return</b> ((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r738 r">obj</span>).<a href="MshObject.cs.html#1c0e9bcb3834bacc" class="i method">GetFirstPropertyOrDefault</a>(<span class="r739 r">predicate</span>) <b>as</b> <span class="r737 r t">T</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the members available in the object.</span>
        <span class="c">///</span><span class="c"> The adapter implementation is encouraged to cache all properties/methods available</span>
        <span class="c">///</span><span class="c"> in the first call to GetMember and GetMembers so that subsequent</span>
        <span class="c">///</span><span class="c"> calls can use the cache.</span>
        <span class="c">///</span><span class="c"> In the case of the .NET adapter that would be a cache from the .NET type to</span>
        <span class="c">///</span><span class="c"> the public properties and fields available in that type.</span>
        <span class="c">///</span><span class="c"> In the case of the DirectoryEntry adapter, this could be a cache of the objectClass</span>
        <span class="c">///</span><span class="c"> to the properties available in it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r740 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the member information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All members in obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r741 r t">T</span>&gt; <a id="4d39a45b528527f2" href="../R/4d39a45b528527f2.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r741 rd t" class="r741 r t">T</span>&gt;(<b>object</b> <span id="r740 rd" class="r740 r">obj</span>)
        {
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="k">var</a> <span id="r742 rd" class="r742 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r741 r t">T</span>&gt;();
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r743 rd" class="r743 r">mshObj</span> = (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r740 r">obj</span>;
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r744 rd" class="r744 r">member</span> <b>in</b> <span class="r743 r">mshObj</span>.<a href="MshObject.cs.html#56bc82b240e4291b" class="i property">Members</a>)
            {
                <span class="r741 r t">T</span> <span id="r745 rd" class="r745 r">memberAsT</span> = <span class="r744 r">member</span> <b>as</b> <span class="r741 r t">T</span>;
                <b>if</b> (<span class="r745 r">memberAsT</span> != <b>null</b>)
                {
                    <span class="r742 r">returnValue</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r745 r">memberAsT</span>);
                }
            }
 
            <b>return</b> <span class="r742 r">returnValue</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Adapter for properties inside a member set.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="5fca776d9087d9c5" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="d0ec437207a6ec9c">PSMemberSetAdapter</span></a> : <a href="#8976b5fe8aa99f4a" class="t t">MemberRedirectionAdapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <b>protected override</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="7924f61e818f9060" href="../R/7924f61e818f9060.html" target="n" data-glyph="75,1" class="i method">GetTypeNameHierarchy</a>(<b>object</b> <span id="r746 rd" class="r746 r">obj</span>)
        {
            <span class="c">// Make sure PSMemberSet adapter shows PSMemberSet as the typename.</span>
            <span class="c">// This is because PSInternalMemberSet internal class derives from</span>
            <span class="c">// PSMemberSet to support delay loading PSBase, PSObject etc. We</span>
            <span class="c">// should not show internal type members to the users. Also this</span>
            <span class="c">// might break type files shipped in v1.</span>
            <b>yield</b> <b>return</b> <b>typeof</b>(<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>).<span class="i">FullName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if memberName is not a member in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSMemberInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r747 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r748 r">memberName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the member to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to memberName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r749 r t">T</span> <a id="9c38741685a0bc8d" href="../R/9c38741685a0bc8d.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r749 rd t" class="r749 r t">T</span>&gt;(<b>object</b> <span id="r747 rd" class="r747 r">obj</span>, <b>string</b> <span id="r748 rd" class="r748 r">memberName</span>)
        {
            <b>return</b> ((<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>)<span class="r747 r">obj</span>).<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r748 r">memberName</span>] <b>as</b> <span class="r749 r t">T</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first PSMemberInfo whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r750 r t">T</span> <a id="c42c44cd01564e7d" href="../R/c42c44cd01564e7d.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r750 rd t" class="r750 r t">T</span>&gt;(<b>object</b> <span id="r751 rd" class="r751 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r752 rd" class="r752 r">predicate</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r753 rd" class="r753 r">member</span> <b>in</b> ((<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>)<span class="r751 r">obj</span>).<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a>)
            {
                <b>if</b> (<span class="r752 r">predicate</span>(<span class="r753 r">member</span>.<span class="i">Name</span>))
                {
                    <b>return</b> <span class="r753 r">member</span> <b>as</b> <span class="r750 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the members available in the object.</span>
        <span class="c">///</span><span class="c"> The adapter implementation is encouraged to cache all properties/methods available</span>
        <span class="c">///</span><span class="c"> in the first call to GetMember and GetMembers so that subsequent</span>
        <span class="c">///</span><span class="c"> calls can use the cache.</span>
        <span class="c">///</span><span class="c"> In the case of the .NET adapter that would be a cache from the .NET type to</span>
        <span class="c">///</span><span class="c"> the public properties and fields available in that type.</span>
        <span class="c">///</span><span class="c"> In the case of the DirectoryEntry adapter, this could be a cache of the objectClass</span>
        <span class="c">///</span><span class="c"> to the properties available in it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r754 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the member information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All members in obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r755 r t">T</span>&gt; <a id="bc59c4c03b04c1db" href="../R/bc59c4c03b04c1db.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r755 rd t" class="r755 r t">T</span>&gt;(<b>object</b> <span id="r754 rd" class="r754 r">obj</span>)
        {
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="k">var</a> <span id="r756 rd" class="r756 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r755 r t">T</span>&gt;();
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r757 rd" class="r757 r">member</span> <b>in</b> ((<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>)<span class="r754 r">obj</span>).<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a>)
            {
                <span class="r755 r t">T</span> <span id="r758 rd" class="r758 r">memberAsT</span> = <span class="r757 r">member</span> <b>as</b> <span class="r755 r t">T</span>;
                <b>if</b> (<span class="r758 r">memberAsT</span> != <b>null</b>)
                {
                    <span class="r756 r">returnValue</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r758 r">memberAsT</span>);
                }
            }
 
            <b>return</b> <span class="r756 r">returnValue</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for all adapters that adapt only properties and retain</span>
    <span class="c">///</span><span class="c"> .NET methods.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="9f76367ae64df138" href="../R/9f76367ae64df138.html" target="n" data-glyph="2,0" class="t t"><span id="d5fb7e6c2f818b71">PropertyOnlyAdapter</span></a> : <a href="#27353615475f6dbc" class="t t">DotNetAdapter</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For a PropertyOnlyAdapter, the property may come from various sources,</span>
        <span class="c">///</span><span class="c"> but methods, including parameterized properties, still come from DotNetAdapter.</span>
        <span class="c">///</span><span class="c"> So, the binder can optimize on method calls for objects that map to a</span>
        <span class="c">///</span><span class="c"> custom PropertyOnlyAdapter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="d25871695e05e7bf" href="../R/d25871695e05e7bf.html" target="n" data-glyph="74,1" class="i method">CanSiteBinderOptimize</a>(<span class="i">MemberTypes</span> <span id="r759 rd" class="r759 r">typeToOperateOn</span>)
        {
            <b>switch</b> (<span class="r759 r">typeToOperateOn</span>)
            {
                <b>case</b> <span class="i">MemberTypes</span>.<span class="i">Property</span>:
                    <b>return</b> <b>false</b>;
                <b>case</b> <span class="i">MemberTypes</span>.<span class="i">Method</span>:
                    <b>return</b> <b>true</b>;
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;Should be unreachable. Update code if other member types need to be handled here.&quot;</span>);
            }
        }
 
        <b>protected override</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="02e5ce93b61c1e8a" href="../R/02e5ce93b61c1e8a.html" target="n" data-glyph="75,1" class="i method">GetInternedTypeNameHierarchy</a>(<b>object</b> <span id="r760 rd" class="r760 r">obj</span>)
        {
            <b>return</b> <b>new</b> <a href="TypeTable.cs.html#dd2ddcba91b4f44f" class="t constructor">ConsolidatedString</a>(<a href="#1e5e338de08b68df" class="i method">GetTypeNameHierarchy</a>(<span class="r760 r">obj</span>), <span class="r578 r">interned</span>: <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if propertyName is not a property in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSProperty with its adapterData set to information</span>
        <span class="c">///</span><span class="c"> to be used when retrieving the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r761 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSProperty from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r762 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the property to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSProperty corresponding to propertyName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="8f8700ee0ce68bab" href="../R/8f8700ee0ce68bab.html" target="n" data-glyph="75,1" class="i method">DoGetProperty</a>(<b>object</b> <span id="r761 rd" class="r761 r">obj</span>, <b>string</b> <span id="r762 rd" class="r762 r">propertyName</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first PSProperty whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r763 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSProperty from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r764 r">predicate</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The predicate to find the matching member.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The first PSProperty whose name matches the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r764 r">predicate</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="987ad57bebe1f3b6" href="../R/987ad57bebe1f3b6.html" target="n" data-glyph="75,1" class="i method">DoGetFirstPropertyOrDefault</a>(<b>object</b> <span id="r763 rd" class="r763 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r764 rd" class="r764 r">predicate</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the properties available in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r765 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the property information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r766 r">members</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection where the properties will be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected abstract void</b> <a id="34cbc78852dc141b" href="../R/34cbc78852dc141b.html" target="n" data-glyph="75,1" class="i method">DoAddAllProperties</a>&lt;<span id="r767 rd t" class="r767 r t">T</span>&gt;(<b>object</b> <span id="r765 rd" class="r765 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r767 r t">T</span>&gt; <span id="r766 rd" class="r766 r">members</span>) <b>where</b> <span class="r767 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if memberName is not a member in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSMemberInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r768 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r769 r">memberName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the member to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to memberName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r770 r t">T</span> <a id="e7fc3c8281310d00" href="../R/e7fc3c8281310d00.html" target="n" data-glyph="75,1" class="i method">GetMember</a>&lt;<span id="r770 rd t" class="r770 r t">T</span>&gt;(<b>object</b> <span id="r768 rd" class="r768 r">obj</span>, <b>string</b> <span id="r769 rd" class="r769 r">memberName</span>)
        {
            <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r771 rd" class="r771 r">property</span> = <a href="#8f8700ee0ce68bab" class="i method">DoGetProperty</a>(<span class="r768 r">obj</span>, <span class="r769 r">memberName</span>);
 
            <b>if</b> (<b>typeof</b>(<span class="r770 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)) &amp;&amp; <span class="r771 r">property</span> != <b>null</b>)
            {
                <b>return</b> <span class="r771 r">property</span> <b>as</b> <span class="r770 r t">T</span>;
            }
 
            <b>if</b> (<b>typeof</b>(<span class="r770 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)))
            {
                <span class="r770 r t">T</span> <span id="r772 rd" class="r772 r">returnValue</span> = <a href="#27353615475f6dbc" class="k">base</a>.<span class="i">GetDotNetMethod</span>&lt;<span class="r770 r t">T</span>&gt;(<span class="r768 r">obj</span>, <span class="r769 r">memberName</span>);
                <span class="c">// We only return a method if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r772 r">returnValue</span> != <b>null</b> &amp;&amp; <span class="r771 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r772 r">returnValue</span>;
                }
            }
 
            <b>if</b> (<span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r770 r t">T</span>)))
            {
                <a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r773 rd" class="r773 r">parameterizedProperty</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#6541656a66c848e9" class="i method">GetDotNetProperty</a>&lt;<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>&gt;(<span class="r768 r">obj</span>, <span class="r769 r">memberName</span>);
                <span class="c">// We only return a parameterized property if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r773 r">parameterizedProperty</span> != <b>null</b> &amp;&amp; <span class="r771 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r773 r">parameterizedProperty</span> <b>as</b> <span class="r770 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the first PSMemberInfo whose name matches the specified </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Otherwise, return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r774 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A subtype of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r775 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSMemberInfo from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r776 r">predicate</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A name matching predicate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSMemberInfo corresponding to the predicate match.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="r774 r t">T</span> <a id="a195196f2c115e1b" href="../R/a195196f2c115e1b.html" target="n" data-glyph="75,1" class="i method">GetFirstMemberOrDefault</a>&lt;<span id="r774 rd t" class="r774 r t">T</span>&gt;(<b>object</b> <span id="r775 rd" class="r775 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r776 rd" class="r776 r">predicate</span>)
        {
            <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r777 rd" class="r777 r">property</span> = <a href="#987ad57bebe1f3b6" class="i method">DoGetFirstPropertyOrDefault</a>(<span class="r775 r">obj</span>, <span class="r776 r">predicate</span>);
 
            <b>if</b> (<b>typeof</b>(<span class="r774 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)))
            {
                <b>return</b> <span class="r777 r">property</span> <b>as</b> <span class="r774 r t">T</span>;
            }
 
            <b>if</b> (<b>typeof</b>(<span class="r774 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)))
            {
                <span class="r774 r t">T</span> <span id="r778 rd" class="r778 r">returnValue</span> = <a href="#27353615475f6dbc" class="k">base</a>.<span class="i">GetFirstDotNetMethodOrDefault</span>&lt;<span class="r774 r t">T</span>&gt;(<span class="r775 r">obj</span>, <span class="r776 r">predicate</span>);
 
                <span class="c">// We only return a method if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r778 r">returnValue</span> != <b>null</b> &amp;&amp; <span class="r777 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r778 r">returnValue</span>;
                }
            }
 
            <b>if</b> (<span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r774 r t">T</span>)))
            {
                <a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="k">var</a> <span id="r779 rd" class="r779 r">parameterizedProperty</span> = <a href="#27353615475f6dbc" class="k">base</a>.<a href="#0957d1020e2e8cce" class="i method">GetFirstDotNetPropertyOrDefault</a>&lt;<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>&gt;(<span class="r775 r">obj</span>, <span class="r776 r">predicate</span>);
 
                <span class="c">// We only return a parameterized property if there is no property by the same name</span>
                <span class="c">// to match the behavior we have in GetMembers</span>
                <b>if</b> (<span class="r779 r">parameterizedProperty</span> != <b>null</b> &amp;&amp; <span class="r777 r">property</span> == <b>null</b>)
                {
                    <b>return</b> <span class="r779 r">parameterizedProperty</span> <b>as</b> <span class="r774 r t">T</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the members available in the object.</span>
        <span class="c">///</span><span class="c"> The adapter implementation is encouraged to cache all properties/methods available</span>
        <span class="c">///</span><span class="c"> in the first call to GetMember and GetMembers so that subsequent</span>
        <span class="c">///</span><span class="c"> calls can use the cache.</span>
        <span class="c">///</span><span class="c"> In the case of the .NET adapter that would be a cache from the .NET type to</span>
        <span class="c">///</span><span class="c"> the public properties and fields available in that type.</span>
        <span class="c">///</span><span class="c"> In the case of the DirectoryEntry adapter, this could be a cache of the objectClass</span>
        <span class="c">///</span><span class="c"> to the properties available in it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r780 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the member information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All members in obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r781 r t">T</span>&gt; <a id="2b146f3019f5a720" href="../R/2b146f3019f5a720.html" target="n" data-glyph="75,1" class="i method">GetMembers</a>&lt;<span id="r781 rd t" class="r781 r t">T</span>&gt;(<b>object</b> <span id="r780 rd" class="r780 r">obj</span>)
        {
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="k">var</a> <span id="r782 rd" class="r782 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r781 r t">T</span>&gt;();
            <b>if</b> (<b>typeof</b>(<span class="r781 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)))
            {
                <span class="i">DoAddAllProperties</span>&lt;<span class="r781 r t">T</span>&gt;(<span class="r780 r">obj</span>, <span class="r782 r">returnValue</span>);
            }
 
            <a href="#27353615475f6dbc" class="k">base</a>.<span class="i">AddAllMethods</span>(<span class="r780 r">obj</span>, <span class="r782 r">returnValue</span>, <b>true</b>);
            <b>if</b> (<span class="i">IsTypeParameterizedProperty</span>(<b>typeof</b>(<span class="r781 r t">T</span>)))
            {
                <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="k">var</a> <span id="r783 rd" class="r783 r">parameterizedProperties</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a>&gt;();
                <a href="#27353615475f6dbc" class="k">base</a>.<a href="#f410eabc7f8cbc0c" class="i method">AddAllProperties</a>(<span class="r780 r">obj</span>, <span class="r783 r">parameterizedProperties</span>, <b>true</b>);
                <b>foreach</b> (<a href="MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r784 rd" class="r784 r">parameterizedProperty</span> <b>in</b> <span class="r783 r">parameterizedProperties</span>)
                {
                    <b>try</b>
                    {
                        <span class="r782 r">returnValue</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r784 r">parameterizedProperty</span> <b>as</b> <span class="r781 r t">T</span>);
                    }
                    <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>)
                    {
                        <span class="c">// ignore duplicates: the adapted properties will take precedence</span>
                    }
                }
            }
 
            <b>return</b> <span class="r782 r">returnValue</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Deals with XmlNode objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="6373add5fe3dfee4" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="cceaf898c5800293">XmlNodeAdapter</span></a> : <a href="#9f76367ae64df138" class="t t">PropertyOnlyAdapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the TypeNameHierarchy out of an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r785 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get the TypeNameHierarchy from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="8a8fbab0115b8d45" href="../R/8a8fbab0115b8d45.html" target="n" data-glyph="75,1" class="i method">GetTypeNameHierarchy</a>(<b>object</b> <span id="r785 rd" class="r785 r">obj</span>)
        {
            <span class="i">XmlNode</span> <span id="r786 rd" class="r786 r">node</span> = (<span class="i">XmlNode</span>)<span class="r785 r">obj</span>;
            <b>string</b> <span id="r787 rd" class="r787 r">nodeNamespace</span> = <span class="r786 r">node</span>.<span class="i">NamespaceURI</span>;
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r788 rd" class="r788 r">baseTypeNames</span> = <a href="#1dd94f9582ce75a1" class="i method">GetDotNetTypeNameHierarchy</a>(<span class="r785 r">obj</span>);
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r787 r">nodeNamespace</span>))
            {
                <b>foreach</b> (<b>string</b> <span id="r789 rd" class="r789 r">baseType</span> <b>in</b> <span class="r788 r">baseTypeNames</span>)
                {
                    <b>yield</b> <b>return</b> <span class="r789 r">baseType</span>;
                }
            }
            <b>else</b>
            {
                <span class="i">StringBuilder</span> <span id="r790 rd" class="r790 r">firstType</span> = <b>null</b>;
                <b>foreach</b> (<b>string</b> <span id="r791 rd" class="r791 r">baseType</span> <b>in</b> <span class="r788 r">baseTypeNames</span>)
                {
                    <b>if</b> (<span class="r790 r">firstType</span> == <b>null</b>)
                    {
                        <span class="r790 r">firstType</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r791 r">baseType</span>);
                        <span class="r790 r">firstType</span>.<span class="i">Append</span>(<span class="s">&#39;#&#39;</span>);
                        <span class="r790 r">firstType</span>.<span class="i">Append</span>(<span class="r786 r">node</span>.<span class="i">NamespaceURI</span>);
                        <span class="r790 r">firstType</span>.<span class="i">Append</span>(<span class="s">&#39;#&#39;</span>);
                        <span class="r790 r">firstType</span>.<span class="i">Append</span>(<span class="r786 r">node</span>.<span class="i">LocalName</span>);
                        <b>yield</b> <b>return</b> <span class="r790 r">firstType</span>.<span class="i">ToString</span>();
                    }
 
                    <b>yield</b> <b>return</b> <span class="r791 r">baseType</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the properties available in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r792 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the property information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r793 r">members</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection where the members will be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="52a9a68a58a9e1b6" href="../R/52a9a68a58a9e1b6.html" target="n" data-glyph="75,1" class="i method">DoAddAllProperties</a>&lt;<span id="r794 rd t" class="r794 r t">T</span>&gt;(<b>object</b> <span id="r792 rd" class="r792 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r794 r t">T</span>&gt; <span id="r793 rd" class="r793 r">members</span>)
        {
            <span class="i">XmlNode</span> <span id="r795 rd" class="r795 r">node</span> = (<span class="i">XmlNode</span>)<span class="r792 r">obj</span>;
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;&gt; <span id="r796 rd" class="r796 r">nodeArrays</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>if</b> (<span class="r795 r">node</span>.<span class="i">Attributes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r797 rd" class="r797 r">attribute</span> <b>in</b> <span class="r795 r">node</span>.<span class="i">Attributes</span>)
                {
                    <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt; <span id="r798 rd" class="r798 r">nodeList</span>;
                    <b>if</b> (!<span class="r796 r">nodeArrays</span>.<span class="i">TryGetValue</span>(<span class="r797 r">attribute</span>.<span class="i">LocalName</span>, <b>out</b> <span class="r798 r">nodeList</span>))
                    {
                        <span class="r798 r">nodeList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;();
                        <span class="r796 r">nodeArrays</span>[<span class="r797 r">attribute</span>.<span class="i">LocalName</span>] = <span class="r798 r">nodeList</span>;
                    }
 
                    <span class="r798 r">nodeList</span>.<span class="i">Add</span>(<span class="r797 r">attribute</span>);
                }
            }
 
            <b>if</b> (<span class="r795 r">node</span>.<span class="i">ChildNodes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r799 rd" class="r799 r">childNode</span> <b>in</b> <span class="r795 r">node</span>.<span class="i">ChildNodes</span>)
                {
                    <span class="c">// Win8: 437544 ignore whitespace</span>
                    <b>if</b> (<span class="r799 r">childNode</span> <b>is</b> <span class="i">XmlWhitespace</span>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt; <span id="r800 rd" class="r800 r">nodeList</span>;
                    <b>if</b> (!<span class="r796 r">nodeArrays</span>.<span class="i">TryGetValue</span>(<span class="r799 r">childNode</span>.<span class="i">LocalName</span>, <b>out</b> <span class="r800 r">nodeList</span>))
                    {
                        <span class="r800 r">nodeList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;();
                        <span class="r796 r">nodeArrays</span>[<span class="r799 r">childNode</span>.<span class="i">LocalName</span>] = <span class="r800 r">nodeList</span>;
                    }
 
                    <span class="r800 r">nodeList</span>.<span class="i">Add</span>(<span class="r799 r">childNode</span>);
                }
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;&gt; <span id="r801 rd" class="r801 r">nodeArrayEntry</span> <b>in</b> <span class="r796 r">nodeArrays</span>)
            {
                <span class="r793 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <span class="t">PSProperty</span>(<span class="r801 r">nodeArrayEntry</span>.<span class="i">Key</span>, <a href="#6373add5fe3dfee4" class="k">this</a>, <span class="r792 r">obj</span>, <span class="r801 r">nodeArrayEntry</span>.<span class="i">Value</span>.<span class="i">ToArray</span>()) <b>as</b> <span class="r794 r t">T</span>);
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if propertyName is not a property in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSProperty with its adapterData set to information</span>
        <span class="c">///</span><span class="c"> to be used when retrieving the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r802 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSProperty from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r803 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the property to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSProperty corresponding to propertyName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="7e281fc7c6c73a63" href="../R/7e281fc7c6c73a63.html" target="n" data-glyph="75,1" class="i method">DoGetProperty</a>(<b>object</b> <span id="r802 rd" class="r802 r">obj</span>, <b>string</b> <span id="r803 rd" class="r803 r">propertyName</span>)
        {
            <span class="i">XmlNode</span>[] <span id="r804 rd" class="r804 r">nodes</span> = <span class="i">FindNodes</span>(<span class="r802 r">obj</span>, <span class="r803 r">propertyName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>if</b> (<span class="r804 r">nodes</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <span class="t">PSProperty</span>(<span class="r804 r">nodes</span>[0].<span class="i">LocalName</span>, <a href="#6373add5fe3dfee4" class="k">this</a>, <span class="r802 r">obj</span>, <span class="r804 r">nodes</span>);
        }
 
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="0625177ac6f880c6" href="../R/0625177ac6f880c6.html" target="n" data-glyph="75,1" class="i method">DoGetFirstPropertyOrDefault</a>(<b>object</b> <span id="r805 rd" class="r805 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r806 rd" class="r806 r">predicate</span>)
        {
            <span class="i">XmlNode</span> <span id="r807 rd" class="r807 r">node</span> = <a href="#ab6253ecacd4ae60" class="i method">FindNode</a>(<span class="r805 r">obj</span>, <span class="r806 r">predicate</span>);
            <b>return</b> <span class="r807 r">node</span> == <b>null</b> ? <b>null</b> : <b>new</b> <span class="t">PSProperty</span>(<span class="r807 r">node</span>.<span class="i">LocalName</span>, <a href="#6373add5fe3dfee4" class="k">this</a>, <span class="r805 r">obj</span>, <span class="r807 r">node</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r808 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="2121fa3575234fd8" href="../R/2121fa3575234fd8.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r808 rd" class="r808 r">property</span>)
        {
            <span class="i">XmlNode</span>[] <span id="r809 rd" class="r809 r">nodes</span> = (<span class="i">XmlNode</span>[])<span class="r808 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r809 r">nodes</span>.<span class="i">Length</span> != 0, <span class="s">&quot;DoGetProperty would not return an empty array, it would return null instead&quot;</span>);
            <b>if</b> (<span class="r809 r">nodes</span>.<span class="i">Length</span> != 1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">XmlNode</span> <span id="r810 rd" class="r810 r">node</span> = <span class="r809 r">nodes</span>[0];
            <b>if</b> (<span class="r810 r">node</span> <b>is</b> <span class="i">XmlText</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r810 r">node</span> <b>is</b> <span class="i">XmlAttribute</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="i">XmlAttributeCollection</span> <span id="r811 rd" class="r811 r">nodeAttributes</span> = <span class="r810 r">node</span>.<span class="i">Attributes</span>;
            <b>if</b> ((<span class="r811 r">nodeAttributes</span> != <b>null</b>) &amp;&amp; (<span class="r811 r">nodeAttributes</span>.<span class="i">Count</span> != 0))
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">XmlNodeList</span> <span id="r812 rd" class="r812 r">nodeChildren</span> = <span class="r810 r">node</span>.<span class="i">ChildNodes</span>;
            <b>if</b> ((<span class="r812 r">nodeChildren</span> == <b>null</b>) || (<span class="r812 r">nodeChildren</span>.<span class="i">Count</span> == 0))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> ((<span class="r812 r">nodeChildren</span>.<span class="i">Count</span> == 1) &amp;&amp; (<span class="r812 r">nodeChildren</span>[0].<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Text</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r813 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="0a0cbb949bf92cd3" href="../R/0a0cbb949bf92cd3.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r813 rd" class="r813 r">property</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>private static object</b> <a id="b853440db7f928cd" href="../R/b853440db7f928cd.html" target="n" data-glyph="76,1" class="i method">GetNodeObject</a>(<span class="i">XmlNode</span> <span id="r814 rd" class="r814 r">node</span>)
        {
            <span class="i">XmlText</span> <span id="r815 rd" class="r815 r">text</span> = <span class="r814 r">node</span> <b>as</b> <span class="i">XmlText</span>;
            <b>if</b> (<span class="r815 r">text</span> != <b>null</b>)
            {
                <b>return</b> <span class="r815 r">text</span>.<span class="i">InnerText</span>;
            }
 
            <span class="i">XmlAttributeCollection</span> <span id="r816 rd" class="r816 r">nodeAttributes</span> = <span class="r814 r">node</span>.<span class="i">Attributes</span>;
 
            <span class="c">// A node with attributes should not be simplified</span>
            <b>if</b> ((<span class="r816 r">nodeAttributes</span> != <b>null</b>) &amp;&amp; (<span class="r816 r">nodeAttributes</span>.<span class="i">Count</span> != 0))
            {
                <b>return</b> <span class="r814 r">node</span>;
            }
 
            <span class="c">// If node does not have any children, return the innertext of the node</span>
            <b>if</b> (!<span class="r814 r">node</span>.<span class="i">HasChildNodes</span>)
            {
                <b>return</b> <span class="r814 r">node</span>.<span class="i">InnerText</span>;
            }
 
            <span class="i">XmlNodeList</span> <span id="r817 rd" class="r817 r">nodeChildren</span> = <span class="r814 r">node</span>.<span class="i">ChildNodes</span>;
            <span class="c">// nodeChildren will not be null as we already verified iff the node has children.</span>
            <b>if</b> ((<span class="r817 r">nodeChildren</span>.<span class="i">Count</span> == 1) &amp;&amp; (<span class="r817 r">nodeChildren</span>[0].<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Text</span>))
            {
                <b>return</b> <span class="r814 r">node</span>.<span class="i">InnerText</span>;
            }
 
            <span class="i">XmlAttribute</span> <span id="r818 rd" class="r818 r">attribute</span> = <span class="r814 r">node</span> <b>as</b> <span class="i">XmlAttribute</span>;
            <b>if</b> (<span class="r818 r">attribute</span> != <b>null</b>)
            {
                <b>return</b> <span class="r818 r">attribute</span>.<span class="i">Value</span>;
            }
 
            <b>return</b> <span class="r814 r">node</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r819 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="7284a6a11b1c90ad" href="../R/7284a6a11b1c90ad.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r819 rd" class="r819 r">property</span>)
        {
            <span class="i">XmlNode</span>[] <span id="r820 rd" class="r820 r">nodes</span> = (<span class="i">XmlNode</span>[])<span class="r819 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
 
            <b>if</b> (<span class="r820 r">nodes</span>.<span class="i">Length</span> == 1)
            {
                <b>return</b> <a href="#b853440db7f928cd" class="i method">GetNodeObject</a>(<span class="r820 r">nodes</span>[0]);
            }
 
            <b>object</b>[] <span id="r821 rd" class="r821 r">returnValue</span> = <b>new</b> <b>object</b>[<span class="r820 r">nodes</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r822 rd" class="r822 r">i</span> = 0; <span class="r822 r">i</span> &lt; <span class="r820 r">nodes</span>.<span class="i">Length</span>; <span class="r822 r">i</span>++)
            {
                <span class="r821 r">returnValue</span>[<span class="r822 r">i</span>] = <a href="#b853440db7f928cd" class="i method">GetNodeObject</a>(<span class="r820 r">nodes</span>[<span class="r822 r">i</span>]);
            }
 
            <b>return</b> <span class="r821 r">returnValue</span>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r823 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r824 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r825 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="2ed50b4b838af0eb" href="../R/2ed50b4b838af0eb.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r823 rd" class="r823 r">property</span>, <b>object</b> <span id="r824 rd" class="r824 r">setValue</span>, <b>bool</b> <span id="r825 rd" class="r825 r">convertIfPossible</span>)
        {
            <span class="c">// XML is always a string so implicitly convert to string</span>
            <b>string</b> <span id="r826 rd" class="r826 r">valueString</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>string</b>&gt;(<span class="r824 r">setValue</span>);
            <span class="i">XmlNode</span>[] <span id="r827 rd" class="r827 r">nodes</span> = (<span class="i">XmlNode</span>[])<span class="r823 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r827 r">nodes</span>.<span class="i">Length</span> != 0, <span class="s">&quot;DoGetProperty would not return an empty array, it would return null instead&quot;</span>);
            <b>if</b> (<span class="r827 r">nodes</span>.<span class="i">Length</span> &gt; 1)
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueException</span>(<span class="s">&quot;XmlNodeSetRestrictionsMoreThanOneNode&quot;</span>,
                    <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">XmlNodeSetShouldBeAString</span>,
                    <span class="r823 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
 
            <span class="i">XmlNode</span> <span id="r828 rd" class="r828 r">node</span> = <span class="r827 r">nodes</span>[0];
            <span class="i">XmlText</span> <span id="r829 rd" class="r829 r">text</span> = <span class="r828 r">node</span> <b>as</b> <span class="i">XmlText</span>;
            <b>if</b> (<span class="r829 r">text</span> != <b>null</b>)
            {
                <span class="r829 r">text</span>.<span class="i">InnerText</span> = <span class="r826 r">valueString</span>;
                <b>return</b>;
            }
 
            <span class="i">XmlAttributeCollection</span> <span id="r830 rd" class="r830 r">nodeAttributes</span> = <span class="r828 r">node</span>.<span class="i">Attributes</span>;
            <span class="c">// A node with attributes cannot be set</span>
            <b>if</b> ((<span class="r830 r">nodeAttributes</span> != <b>null</b>) &amp;&amp; (<span class="r830 r">nodeAttributes</span>.<span class="i">Count</span> != 0))
            {
                <b>throw</b> <b>new</b> <span class="t">SetValueException</span>(<span class="s">&quot;XmlNodeSetRestrictionsNodeWithAttributes&quot;</span>,
                    <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">XmlNodeSetShouldBeAString</span>,
                    <span class="r823 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            }
 
            <span class="i">XmlNodeList</span> <span id="r831 rd" class="r831 r">nodeChildren</span> = <span class="r828 r">node</span>.<span class="i">ChildNodes</span>;
            <b>if</b> (<span class="r831 r">nodeChildren</span> == <b>null</b> || <span class="r831 r">nodeChildren</span>.<span class="i">Count</span> == 0)
            {
                <span class="r828 r">node</span>.<span class="i">InnerText</span> = <span class="r826 r">valueString</span>;
                <b>return</b>;
            }
 
            <b>if</b> ((<span class="r831 r">nodeChildren</span>.<span class="i">Count</span> == 1) &amp;&amp; (<span class="r831 r">nodeChildren</span>[0].<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Text</span>))
            {
                <span class="r828 r">node</span>.<span class="i">InnerText</span> = <span class="r826 r">valueString</span>;
                <b>return</b>;
            }
 
            <span class="i">XmlAttribute</span> <span id="r832 rd" class="r832 r">attribute</span> = <span class="r828 r">node</span> <b>as</b> <span class="i">XmlAttribute</span>;
            <b>if</b> (<span class="r832 r">attribute</span> != <b>null</b>)
            {
                <span class="r832 r">attribute</span>.<span class="i">Value</span> = <span class="r826 r">valueString</span>;
                <b>return</b>;
            }
 
            <b>throw</b> <b>new</b> <span class="t">SetValueException</span>(<span class="s">&quot;XmlNodeSetRestrictionsUnknownNodeType&quot;</span>,
                <b>null</b>,
                <span class="i">ExtendedTypeSystem</span>.<span class="i">XmlNodeSetShouldBeAString</span>,
                <span class="r823 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r833 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r834 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="de06083b1a1f9502" href="../R/de06083b1a1f9502.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r833 rd" class="r833 r">property</span>, <b>bool</b> <span id="r834 rd" class="r834 r">forDisplay</span>)
        {
            <b>object</b> <span id="r835 rd" class="r835 r">value</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r835 r">value</span> = <a href="#ccace9705dec121f" class="i method">BasePropertyGet</a>(<span class="r833 r">property</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a>)
            {
            }
 
            <b>var</b> <span id="r836 rd" class="r836 r">type</span> = <span class="r835 r">value</span> == <b>null</b> ? <b>typeof</b>(<b>object</b>) : <span class="r835 r">value</span>.<span class="i">GetType</span>();
            <b>return</b> <span class="r834 r">forDisplay</span> ? <a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r836 r">type</span>) : <span class="r836 r">type</span>.<span class="i">FullName</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Auxiliary in GetProperty to perform case sensitive and case insensitive searches</span>
        <span class="c">///</span><span class="c"> in the child nodes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r837 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">XmlNode to extract property from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r838 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to look for.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r839 r">comparisonType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type pf comparison to perform.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The corresponding XmlNode or null if not present.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">XmlNode</span>[] <a id="efdec0bb4423395a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">FindNodes</a>(<b>object</b> <span id="r837 rd" class="r837 r">obj</span>, <b>string</b> <span id="r838 rd" class="r838 r">propertyName</span>, <span class="i">StringComparison</span> <span id="r839 rd" class="r839 r">comparisonType</span>)
        {
            <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt; <span id="r840 rd" class="r840 r">retValue</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">XmlNode</span>&gt;();
            <span class="i">XmlNode</span> <span id="r841 rd" class="r841 r">node</span> = (<span class="i">XmlNode</span>)<span class="r837 r">obj</span>;
 
            <b>if</b> (<span class="r841 r">node</span>.<span class="i">Attributes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r842 rd" class="r842 r">attribute</span> <b>in</b> <span class="r841 r">node</span>.<span class="i">Attributes</span>)
                {
                    <b>if</b> (<span class="r842 r">attribute</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="r838 r">propertyName</span>, <span class="r839 r">comparisonType</span>))
                    {
                        <span class="r840 r">retValue</span>.<span class="i">Add</span>(<span class="r842 r">attribute</span>);
                    }
                }
            }
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r843 rd" class="r843 r">childNode</span> <b>in</b> <span class="r841 r">node</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r843 r">childNode</span> <b>is</b> <span class="i">XmlWhitespace</span>)
                {
                    <span class="c">// Win8: 437544 ignore whitespace</span>
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r843 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="r838 r">propertyName</span>, <span class="r839 r">comparisonType</span>))
                {
                    <span class="r840 r">retValue</span>.<span class="i">Add</span>(<span class="r843 r">childNode</span>);
                }
            }
 
            <b>return</b> <span class="r840 r">retValue</span>.<span class="i">ToArray</span>();
        }
 
        <b>private static</b> <span class="i">XmlNode</span> <a id="ab6253ecacd4ae60" href="../R/ab6253ecacd4ae60.html" target="n" data-glyph="76,1" class="i method">FindNode</a>(<b>object</b> <span id="r844 rd" class="r844 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r845 rd" class="r845 r">predicate</span>)
        {
            <b>var</b> <span id="r846 rd" class="r846 r">node</span> = (<span class="i">XmlNode</span>)<span class="r844 r">obj</span>;
 
            <b>if</b> (<span class="r846 r">node</span>.<span class="i">Attributes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r847 rd" class="r847 r">attribute</span> <b>in</b> <span class="r846 r">node</span>.<span class="i">Attributes</span>)
                {
                    <b>if</b> (<span class="r845 r">predicate</span>(<span class="r847 r">attribute</span>.<span class="i">LocalName</span>))
                    {
                        <b>return</b> <span class="r847 r">attribute</span>;
                    }
                }
            }
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r848 rd" class="r848 r">childNode</span> <b>in</b> <span class="r846 r">node</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r848 r">childNode</span> <b>is</b> <span class="i">XmlWhitespace</span>)
                {
                    <span class="c">// Win8: 437544 ignore whitespace</span>
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r845 r">predicate</span>(<span class="r848 r">childNode</span>.<span class="i">LocalName</span>))
                {
                    <b>return</b> <span class="r848 r">childNode</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Deals with DataRow objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="67880612366e359d" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="2db965da0f06d1b6">DataRowAdapter</span></a> : <a href="#9f76367ae64df138" class="t t">PropertyOnlyAdapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the properties available in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r849 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the property information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r850 r">members</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection where the members will be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5933329d8b0f43c8" href="../R/5933329d8b0f43c8.html" target="n" data-glyph="75,1" class="i method">DoAddAllProperties</a>&lt;<span id="r851 rd t" class="r851 r t">T</span>&gt;(<b>object</b> <span id="r849 rd" class="r849 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r851 r t">T</span>&gt; <span id="r850 rd" class="r850 r">members</span>)
        {
            <span class="i">DataRow</span> <span id="r852 rd" class="r852 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r849 r">obj</span>;
            <b>if</b> (<span class="r852 r">dataRow</span>.<span class="i">Table</span> == <b>null</b> || <span class="r852 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>foreach</b> (<span class="i">DataColumn</span> <span id="r853 rd" class="r853 r">property</span> <b>in</b> <span class="r852 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>)
            {
                <span class="r850 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <span class="t">PSProperty</span>(<span class="r853 r">property</span>.<span class="i">ColumnName</span>, <a href="#67880612366e359d" class="k">this</a>, <span class="r849 r">obj</span>, <span class="r853 r">property</span>.<span class="i">ColumnName</span>) <b>as</b> <span class="r851 r t">T</span>);
            }
 
            <b>return</b>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if propertyName is not a property in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSProperty with its adapterData set to information</span>
        <span class="c">///</span><span class="c"> to be used when retrieving the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r854 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSProperty from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r855 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the property to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSProperty corresponding to propertyName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="a1bf423715623ee8" href="../R/a1bf423715623ee8.html" target="n" data-glyph="75,1" class="i method">DoGetProperty</a>(<b>object</b> <span id="r854 rd" class="r854 r">obj</span>, <b>string</b> <span id="r855 rd" class="r855 r">propertyName</span>)
        {
            <span class="i">DataRow</span> <span id="r856 rd" class="r856 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r854 r">obj</span>;
 
            <b>if</b> (!<span class="r856 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>.<span class="i">Contains</span>(<span class="r855 r">propertyName</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>string</b> <span id="r857 rd" class="r857 r">columnName</span> = <span class="r856 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r855 r">propertyName</span>].<span class="i">ColumnName</span>;
            <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#494064705451d8c3" class="t constructor">PSProperty</a>(<span class="r857 r">columnName</span>, <a href="#67880612366e359d" class="k">this</a>, <span class="r854 r">obj</span>, <span class="r857 r">columnName</span>);
        }
 
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="39d74ec59841923e" href="../R/39d74ec59841923e.html" target="n" data-glyph="75,1" class="i method">DoGetFirstPropertyOrDefault</a>(<b>object</b> <span id="r858 rd" class="r858 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r859 rd" class="r859 r">predicate</span>)
        {
            <span class="i">DataRow</span> <span id="r860 rd" class="r860 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r858 r">obj</span>;
 
            <b>foreach</b> (<span class="i">DataColumn</span> <span id="r861 rd" class="r861 r">property</span> <b>in</b> <span class="r860 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>)
            {
                <b>if</b> (<span class="r859 r">predicate</span>(<span class="r861 r">property</span>.<span class="i">ColumnName</span>))
                {
                    <b>return</b> <b>new</b> <span class="t">PSProperty</span>(<span class="r861 r">property</span>.<span class="i">ColumnName</span>, <a href="#67880612366e359d" class="k">this</a>, <span class="r858 r">obj</span>, <span class="r861 r">property</span>.<span class="i">ColumnName</span>);
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r862 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r863 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="d75e61149f572ad4" href="../R/d75e61149f572ad4.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r862 rd" class="r862 r">property</span>, <b>bool</b> <span id="r863 rd" class="r863 r">forDisplay</span>)
        {
            <b>string</b> <span id="r864 rd" class="r864 r">columnName</span> = (<b>string</b>)<span class="r862 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <span class="i">DataRow</span> <span id="r865 rd" class="r865 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r862 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>var</b> <span id="r866 rd" class="r866 r">dataType</span> = <span class="r865 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r864 r">columnName</span>].<span class="i">DataType</span>;
            <b>return</b> <span class="r863 r">forDisplay</span> ? <a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r866 r">dataType</span>) : <span class="r866 r">dataType</span>.<span class="i">FullName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r867 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="a3ceeb01d7dd2c5e" href="../R/a3ceeb01d7dd2c5e.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r867 rd" class="r867 r">property</span>)
        {
            <b>string</b> <span id="r868 rd" class="r868 r">columnName</span> = (<b>string</b>)<span class="r867 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <span class="i">DataRow</span> <span id="r869 rd" class="r869 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r867 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>return</b> !<span class="r869 r">dataRow</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r868 r">columnName</span>].<span class="i">ReadOnly</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r870 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="3d56f083fef36010" href="../R/3d56f083fef36010.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r870 rd" class="r870 r">property</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r871 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="711039b0f8910806" href="../R/711039b0f8910806.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r871 rd" class="r871 r">property</span>)
        {
            <span class="i">DataRow</span> <span id="r872 rd" class="r872 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r871 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>return</b> <span class="r872 r">dataRow</span>[(<b>string</b>)<span class="r871 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>];
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r873 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r874 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r875 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="d8037a288670ac4c" href="../R/d8037a288670ac4c.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r873 rd" class="r873 r">property</span>, <b>object</b> <span id="r874 rd" class="r874 r">setValue</span>, <b>bool</b> <span id="r875 rd" class="r875 r">convertIfPossible</span>)
        {
            <span class="i">DataRow</span> <span id="r876 rd" class="r876 r">dataRow</span> = (<span class="i">DataRow</span>)<span class="r873 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <span class="r876 r">dataRow</span>[(<b>string</b>)<span class="r873 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>] = <span class="r874 r">setValue</span>;
            <b>return</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Deals with DataRowView objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="093597554a688902" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="163535d446531a9c">DataRowViewAdapter</span></a> : <a href="#9f76367ae64df138" class="t t">PropertyOnlyAdapter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> virtual
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves all the properties available in the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r877 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to get all the property information from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r878 r">members</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection where the members will be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="9bce18778b20d429" href="../R/9bce18778b20d429.html" target="n" data-glyph="75,1" class="i method">DoAddAllProperties</a>&lt;<span id="r879 rd t" class="r879 r t">T</span>&gt;(<b>object</b> <span id="r877 rd" class="r877 r">obj</span>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r879 r t">T</span>&gt; <span id="r878 rd" class="r878 r">members</span>)
        {
            <span class="i">DataRowView</span> <span id="r880 rd" class="r880 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r877 r">obj</span>;
            <b>if</b> (<span class="r880 r">dataRowView</span>.<span class="i">Row</span> == <b>null</b> || <span class="r880 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span> == <b>null</b> || <span class="r880 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>foreach</b> (<span class="i">DataColumn</span> <span id="r881 rd" class="r881 r">property</span> <b>in</b> <span class="r880 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>)
            {
                <span class="r878 r">members</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<b>new</b> <span class="t">PSProperty</span>(<span class="r881 r">property</span>.<span class="i">ColumnName</span>, <a href="#093597554a688902" class="k">this</a>, <span class="r877 r">obj</span>, <span class="r881 r">property</span>.<span class="i">ColumnName</span>) <b>as</b> <span class="r879 r t">T</span>);
            }
 
            <b>return</b>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns null if propertyName is not a property in the adapter or</span>
        <span class="c">///</span><span class="c"> the corresponding PSProperty with its adapterData set to information</span>
        <span class="c">///</span><span class="c"> to be used when retrieving the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r882 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to retrieve the PSProperty from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r883 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the property to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The PSProperty corresponding to propertyName from obj.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="3a36373948e9536c" href="../R/3a36373948e9536c.html" target="n" data-glyph="75,1" class="i method">DoGetProperty</a>(<b>object</b> <span id="r882 rd" class="r882 r">obj</span>, <b>string</b> <span id="r883 rd" class="r883 r">propertyName</span>)
        {
            <span class="i">DataRowView</span> <span id="r884 rd" class="r884 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r882 r">obj</span>;
 
            <b>if</b> (!<span class="r884 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>.<span class="i">Contains</span>(<span class="r883 r">propertyName</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>string</b> <span id="r885 rd" class="r885 r">columnName</span> = <span class="r884 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r883 r">propertyName</span>].<span class="i">ColumnName</span>;
            <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#494064705451d8c3" class="t constructor">PSProperty</a>(<span class="r885 r">columnName</span>, <a href="#093597554a688902" class="k">this</a>, <span class="r882 r">obj</span>, <span class="r885 r">columnName</span>);
        }
 
        <b>protected override</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <a id="0ce6e9b8dcfd46e2" href="../R/0ce6e9b8dcfd46e2.html" target="n" data-glyph="75,1" class="i method">DoGetFirstPropertyOrDefault</a>(<b>object</b> <span id="r886 rd" class="r886 r">obj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r887 rd" class="r887 r">predicate</span>)
        {
            <span class="i">DataRowView</span> <span id="r888 rd" class="r888 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r886 r">obj</span>;
 
            <b>foreach</b> (<span class="i">DataColumn</span> <span id="r889 rd" class="r889 r">column</span> <b>in</b> <span class="r888 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>)
            {
                <b>string</b> <span id="r890 rd" class="r890 r">columnName</span> = <span class="r889 r">column</span>.<span class="i">ColumnName</span>;
                <b>if</b> (<span class="r887 r">predicate</span>(<span class="r890 r">columnName</span>))
                {
                    <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#494064705451d8c3" class="t constructor">PSProperty</a>(<span class="r890 r">columnName</span>, <a href="#093597554a688902" class="k">this</a>, <span class="r886 r">obj</span>, <span class="r890 r">columnName</span>);
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type corresponding to the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r891 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty obtained in a previous DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r892 r">forDisplay</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the result is for display purposes only.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the type corresponding to the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="dd0537758f9652a1" href="../R/dd0537758f9652a1.html" target="n" data-glyph="75,1" class="i method">PropertyType</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r891 rd" class="r891 r">property</span>, <b>bool</b> <span id="r892 rd" class="r892 r">forDisplay</span>)
        {
            <b>string</b> <span id="r893 rd" class="r893 r">columnName</span> = (<b>string</b>)<span class="r891 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <span class="i">DataRowView</span> <span id="r894 rd" class="r894 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r891 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>var</b> <span id="r895 rd" class="r895 r">dataType</span> = <span class="r894 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r893 r">columnName</span>].<span class="i">DataType</span>;
            <b>return</b> <span class="r892 r">forDisplay</span> ? <a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r895 r">dataType</span>) : <span class="r895 r">dataType</span>.<span class="i">FullName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is settable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r896 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is settable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="8f207b2050344351" href="../R/8f207b2050344351.html" target="n" data-glyph="75,1" class="i method">PropertyIsSettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r896 rd" class="r896 r">property</span>)
        {
            <b>string</b> <span id="r897 rd" class="r897 r">columnName</span> = (<b>string</b>)<span class="r896 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>;
            <span class="i">DataRowView</span> <span id="r898 rd" class="r898 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r896 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>return</b> !<span class="r898 r">dataRowView</span>.<span class="i">Row</span>.<span class="i">Table</span>.<span class="i">Columns</span>[<span class="r897 r">columnName</span>].<span class="i">ReadOnly</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the property is gettable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r899 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the property is gettable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="199ebc4c8b414704" href="../R/199ebc4c8b414704.html" target="n" data-glyph="75,1" class="i method">PropertyIsGettable</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r899 rd" class="r899 r">property</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the value from a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r900 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value of the property.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="4915b56fd811aaff" href="../R/4915b56fd811aaff.html" target="n" data-glyph="75,1" class="i method">PropertyGet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r900 rd" class="r900 r">property</span>)
        {
            <span class="i">DataRowView</span> <span id="r901 rd" class="r901 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r900 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <b>return</b> <span class="r901 r">dataRowView</span>[(<b>string</b>)<span class="r900 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>];
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the value of a property coming from a previous call to DoGetProperty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r902 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSProperty coming from a previous call to DoGetProperty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r903 r">setValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to set the property with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r904 r">convertIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instructs the adapter to convert before setting, if the adapter supports conversion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="cf7092dc2af8ec73" href="../R/cf7092dc2af8ec73.html" target="n" data-glyph="75,1" class="i method">PropertySet</a>(<a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r902 rd" class="r902 r">property</span>, <b>object</b> <span id="r903 rd" class="r903 r">setValue</span>, <b>bool</b> <span id="r904 rd" class="r904 r">convertIfPossible</span>)
        {
            <span class="i">DataRowView</span> <span id="r905 rd" class="r905 r">dataRowView</span> = (<span class="i">DataRowView</span>)<span class="r902 r">property</span>.<a href="MshMemberInfo.cs.html#8e3b5d06e5f1cc8c" class="i field">baseObject</a>;
            <span class="r905 r">dataRowView</span>[(<b>string</b>)<span class="r902 r">property</span>.<a href="MshMemberInfo.cs.html#d6dbce48987e002d" class="i field">adapterData</a>] = <span class="r903 r">setValue</span>;
            <b>return</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> virtual
    }
 
    <b>internal class</b> <a id="acd2bca2943f5b05" href="../R/acd2bca2943f5b05.html" target="n" data-glyph="2,0" class="t t">TypeInference</a>
    {
        [<span class="i">TraceSource</span>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="2c32176ccf8c1b67" href="../R/2c32176ccf8c1b67.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>);
 
        <b>internal static</b> <a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <a id="8181da27cc6e1765" href="../R/8181da27cc6e1765.html" target="n" data-glyph="74,1" class="i method">Infer</a>(<a href="#8ae0c30e474b7c1e" class="t t">MethodInformation</a> <span id="r906 rd" class="r906 r">genericMethod</span>, <span class="i">Type</span>[] <span id="r907 rd" class="r907 r">argumentTypes</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r906 r">genericMethod</span> != <b>null</b>, <span class="s">&quot;Caller should verify that genericMethod != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r907 r">argumentTypes</span> != <b>null</b>, <span class="s">&quot;Caller should verify that arguments != null&quot;</span>);
 
            <span class="c">// the cast is safe, because</span>
            <span class="c">// 1) only ConstructorInfo and MethodInfo derive from MethodBase</span>
            <span class="c">// 2) ConstructorInfo.IsGenericMethod is always false</span>
            <span class="i">MethodInfo</span> <span id="r908 rd" class="r908 r">originalMethod</span> = (<span class="i">MethodInfo</span>)<span class="r906 r">genericMethod</span>.<a href="#3a0e575988f5a5de" class="i field">method</a>;
            <span class="i">MethodInfo</span> <span id="r909 rd" class="r909 r">inferredMethod</span> = <a href="#acd2bca2943f5b05" class="t t">TypeInference</a>.<a href="#8d57515143366b5f" class="i method">Infer</a>(<span class="r908 r">originalMethod</span>, <span class="r907 r">argumentTypes</span>, <span class="r906 r">genericMethod</span>.<a href="#14153cc4167a8706" class="i field">hasVarArgs</a>);
 
            <b>if</b> (<span class="r909 r">inferredMethod</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <span class="t">MethodInformation</span>(<span class="r909 r">inferredMethod</span>, 0);
            }
            <b>else</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <b>private static</b> <span class="i">MethodInfo</span> <a id="8d57515143366b5f" href="../R/8d57515143366b5f.html" target="n" data-glyph="76,1" class="i method">Infer</a>(<span class="i">MethodInfo</span> <span id="r910 rd" class="r910 r">genericMethod</span>, <span class="i">Type</span>[] <span id="r911 rd" class="r911 r">typesOfMethodArguments</span>, <b>bool</b> <span id="r912 rd" class="r912 r">hasVarArgs</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r910 r">genericMethod</span> != <b>null</b>, <span class="s">&quot;Caller should verify that genericMethod != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r911 r">typesOfMethodArguments</span> != <b>null</b>, <span class="s">&quot;Caller should verify that arguments != null&quot;</span>);
 
            <b>if</b> (!<span class="r910 r">genericMethod</span>.<span class="i">ContainsGenericParameters</span>)
            {
                <b>return</b> <span class="r910 r">genericMethod</span>;
            }
 
            <span class="i">Type</span>[] <span id="r913 rd" class="r913 r">typeParameters</span> = <span class="r910 r">genericMethod</span>.<span class="i">GetGenericArguments</span>();
            <span class="i">Type</span>[] <span id="r914 rd" class="r914 r">typesOfMethodParameters</span> = <span class="r910 r">genericMethod</span>.<span class="i">GetParameters</span>().<span class="i">Select</span>(<b>static</b> <span id="r915 rd" class="r915 r">p</span> =&gt; <span class="r915 r">p</span>.<span class="i">ParameterType</span>).<span class="i">ToArray</span>();
 
            <span class="i">MethodInfo</span> <span id="r916 rd" class="r916 r">inferredMethod</span> = <span class="i">Infer</span>(<span class="r910 r">genericMethod</span>, <span class="r913 r">typeParameters</span>, <span class="r914 r">typesOfMethodParameters</span>, <span class="r911 r">typesOfMethodArguments</span>);
 
            <span class="c">// normal inference failed, perhaps instead of inferring for</span>
            <span class="c">//   M&lt;T1,T2,T3&gt;(T1, T2, ..., params T3 [])</span>
            <span class="c">// we can try to infer for this signature instead</span>
            <span class="c">//   M&lt;T1,T2,T3&gt;)(T1, T2, ..., T3, T3, T3, T3)</span>
            <span class="c">// where T3 is repeated appropriate number of times depending on the number of actual method arguments.</span>
            <b>if</b> (<span class="r916 r">inferredMethod</span> == <b>null</b> &amp;&amp;
                <span class="r912 r">hasVarArgs</span> &amp;&amp;
                <span class="r911 r">typesOfMethodArguments</span>.<span class="i">Length</span> &gt;= (<span class="r914 r">typesOfMethodParameters</span>.<span class="i">Length</span> - 1))
            {
                <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r917 rd" class="r917 r">typeOfRegularParameters</span> = <span class="r914 r">typesOfMethodParameters</span>.<span class="i">Take</span>(<span class="r914 r">typesOfMethodParameters</span>.<span class="i">Length</span> - 1);
                <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r918 rd" class="r918 r">multipliedVarArgsElementType</span> = <span class="i">Enumerable</span>.<span class="i">Repeat</span>(
                    <span class="r914 r">typesOfMethodParameters</span>[<span class="r914 r">typesOfMethodParameters</span>.<span class="i">Length</span> - 1].<span class="i">GetElementType</span>(),
                    <span class="r911 r">typesOfMethodArguments</span>.<span class="i">Length</span> - <span class="r914 r">typesOfMethodParameters</span>.<span class="i">Length</span> + 1);
 
                <span class="r916 r">inferredMethod</span> = <span class="i">Infer</span>(
                    <span class="r910 r">genericMethod</span>,
                    <span class="r913 r">typeParameters</span>,
                    <span class="r917 r">typeOfRegularParameters</span>.<span class="i">Concat</span>(<span class="r918 r">multipliedVarArgsElementType</span>),
                    <span class="r911 r">typesOfMethodArguments</span>);
            }
 
            <b>return</b> <span class="r916 r">inferredMethod</span>;
        }
 
        <b>private static</b> <span class="i">MethodInfo</span> <a id="cb04eda08dc9e92a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Infer</a>(<span class="i">MethodInfo</span> <span id="r919 rd" class="r919 r">genericMethod</span>, <span class="i">ICollection</span>&lt;<span class="i">Type</span>&gt; <span id="r920 rd" class="r920 r">typeParameters</span>, <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r921 rd" class="r921 r">typesOfMethodParameters</span>, <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r922 rd" class="r922 r">typesOfMethodArguments</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r919 r">genericMethod</span> != <b>null</b>, <span class="s">&quot;Caller should verify that genericMethod != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r920 r">typeParameters</span> != <b>null</b>, <span class="s">&quot;Caller should verify that typeParameters != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r921 r">typesOfMethodParameters</span> != <b>null</b>, <span class="s">&quot;Caller should verify that typesOfMethodParameters != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r922 r">typesOfMethodArguments</span> != <b>null</b>, <span class="s">&quot;Caller should verify that typesOfMethodArguments != null&quot;</span>);
 
            <b>using</b> (<a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">TraceScope</span>(<span class="s">&quot;Inferring type parameters for the following method: {0}&quot;</span>, <span class="r919 r">genericMethod</span>))
            {
                <b>if</b> ((<a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#39a46fbab64bf75b" class="i property">Options</a> &amp; <a href="../utils/StructuredTraceSource.cs.html#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="../utils/StructuredTraceSource.cs.html#d9418c516f830881" class="i field">WriteLine</a>) == <a href="../utils/StructuredTraceSource.cs.html#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="../utils/StructuredTraceSource.cs.html#d9418c516f830881" class="i field">WriteLine</a>)
                {
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;Types of method arguments: {0}&quot;</span>,
                        <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;, &quot;</span>, <span class="r922 r">typesOfMethodArguments</span>.<span class="i">Select</span>(<b>static</b> <span id="r923 rd" class="r923 r">t</span> =&gt; <span class="r923 r">t</span>.<span class="i">ToString</span>()).<span class="i">ToArray</span>()));
                }
 
                <a href="#acd2bca2943f5b05" class="k">var</a> <span id="r924 rd" class="r924 r">typeInference</span> = <b>new</b> <a href="#1b70c80d8516d0c8" class="t constructor">TypeInference</a>(<span class="r920 r">typeParameters</span>);
                <b>if</b> (!<span class="r924 r">typeInference</span>.<a href="#6a9116667bb24fa6" class="i method">UnifyMultipleTerms</a>(<span class="r921 r">typesOfMethodParameters</span>, <span class="r922 r">typesOfMethodArguments</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r925 rd" class="r925 r">inferredTypeParameters</span> = <span class="r920 r">typeParameters</span>.<span class="i">Select</span>(<span class="r924 r">typeInference</span>.<span class="i">GetInferredType</span>);
                <b>if</b> (<span class="r925 r">inferredTypeParameters</span>.<span class="i">Any</span>(<b>static</b> <span id="r926 rd" class="r926 r">inferredType</span> =&gt; <span class="r926 r">inferredType</span> == <b>null</b>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>try</b>
                {
                    <span class="i">MethodInfo</span> <span id="r927 rd" class="r927 r">instantiatedMethod</span> = <span class="r919 r">genericMethod</span>.<span class="i">MakeGenericMethod</span>(<span class="r925 r">inferredTypeParameters</span>.<span class="i">ToArray</span>());
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Inference succesful: {0}&quot;</span>, <span class="r927 r">instantiatedMethod</span>);
                    <b>return</b> <span class="r927 r">instantiatedMethod</span>;
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r928 rd" class="r928 r">e</span>)
                {
                    <span class="c">// Inference failure - most likely due to generic constraints being violated (i.e. where T: IEnumerable)</span>
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Inference failure: {0}&quot;</span>, <span class="r928 r">e</span>.<span class="i">Message</span>);
                    <b>return</b> <b>null</b>;
                }
            }
        }
 
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;[] <a id="305a1771a95a8653" href="../R/305a1771a95a8653.html" target="n" data-glyph="46,1" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt; <a id="ec2c14e7a05571c8" href="../R/ec2c14e7a05571c8.html" target="n" data-glyph="46,1" class="i field">_typeParametersOfTheMethod</a>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <b>internal</b> <a id="1b70c80d8516d0c8" href="../R/1b70c80d8516d0c8.html" target="n" data-glyph="74,1" class="t constructor">TypeInference</a>(<span class="i">ICollection</span>&lt;<span class="i">Type</span>&gt; <span id="r929 rd" class="r929 r">typeParameters</span>)
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r929 r">typeParameters</span> != <b>null</b>, <span class="s">&quot;Caller should verify that typeParameters != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                <span class="r929 r">typeParameters</span>.<span class="i">All</span>(<span id="r930 rd" class="r930 r">t</span> =&gt; <span class="r930 r">t</span>.<span class="i">IsGenericParameter</span>),
                <span class="s">&quot;Caller should verify that typeParameters are really generic type parameters&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a> = <b>new</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;[<span class="r929 r">typeParameters</span>.<span class="i">Count</span>];
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
            <span class="i">List</span>&lt;<b>int</b>&gt; <span id="r931 rd" class="r931 r">listOfTypeParameterPositions</span> = <span class="r929 r">typeParameters</span>.<span class="i">Select</span>(<b>static</b> <span id="r932 rd" class="r932 r">t</span> =&gt; <span class="r932 r">t</span>.<span class="i">GenericParameterPosition</span>).<span class="i">ToList</span>();
            <span class="r931 r">listOfTypeParameterPositions</span>.<span class="i">Sort</span>();
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r931 r">listOfTypeParameterPositions</span>.<span class="i">Count</span> == <span class="r931 r">listOfTypeParameterPositions</span>.<span class="i">Distinct</span>().<span class="i">Count</span>(),
                <span class="s">&quot;No type parameters should occupy the same position&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                <span class="r931 r">listOfTypeParameterPositions</span>.<span class="i">All</span>(<span id="r933 rd" class="r933 r">p</span> =&gt; <span class="r933 r">p</span> &gt;= 0),
                <span class="s">&quot;Type parameter positions should be between 0 and #ofParams&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                <span class="r931 r">listOfTypeParameterPositions</span>.<span class="i">All</span>(<span id="r934 rd" class="r934 r">p</span> =&gt; <span class="r934 r">p</span> &lt; <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>.<span class="i">Length</span>),
                <span class="s">&quot;Type parameter positions should be between 0 and #ofParams&quot;</span>);
 
            <a href="#ec2c14e7a05571c8" class="i field">_typeParametersOfTheMethod</a> = <b>new</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;();
            <b>foreach</b> (<span class="i">Type</span> <span id="r935 rd" class="r935 r">t</span> <b>in</b> <span class="r929 r">typeParameters</span>)
            {
                <a href="#ec2c14e7a05571c8" class="i field">_typeParametersOfTheMethod</a>.<span class="i">Add</span>(<span class="r935 r">t</span>);
            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <b>internal</b> <span class="i">Type</span> <a id="b645aa000b3e83de" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetInferredType</a>(<span class="i">Type</span> <span id="r936 rd" class="r936 r">typeParameter</span>)
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r936 r">typeParameter</span> != <b>null</b>, <span class="s">&quot;Caller should verify typeParameter != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                <a href="#ec2c14e7a05571c8" class="i field">_typeParametersOfTheMethod</a>.<span class="i">Contains</span>(<span class="r936 r">typeParameter</span>),
                <span class="s">&quot;Caller should verify that typeParameter is actually a generic type parameter of the method&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <span class="i">ICollection</span>&lt;<span class="i">Type</span>&gt; <span id="r937 rd" class="r937 r">inferenceCandidates</span> =
                <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r936 r">typeParameter</span>.<span class="i">GenericParameterPosition</span>];
 
            <b>if</b> ((<span class="r937 r">inferenceCandidates</span> != <b>null</b>) &amp;&amp; (<span class="r937 r">inferenceCandidates</span>.<span class="i">Any</span>(<b>static</b> <span id="r938 rd" class="r938 r">t</span> =&gt; <span class="r938 r">t</span> == <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))))
            {
                <span class="i">Type</span> <span id="r939 rd" class="r939 r">firstValueType</span> = <span class="r937 r">inferenceCandidates</span>.<span class="i">FirstOrDefault</span>(<b>static</b> <span id="r940 rd" class="r940 r">t</span> =&gt; <span class="r940 r">t</span>.<span class="i">IsValueType</span>);
                <b>if</b> (<span class="r939 r">firstValueType</span> != <b>null</b>)
                {
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Cannot reconcile null and {0} (a value type)&quot;</span>, <span class="r939 r">firstValueType</span>);
                    <span class="r937 r">inferenceCandidates</span> = <b>null</b>;
                    <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r936 r">typeParameter</span>.<span class="i">GenericParameterPosition</span>] = <b>null</b>;
                }
                <b>else</b>
                {
                    <span class="r937 r">inferenceCandidates</span> = <span class="r937 r">inferenceCandidates</span>.<span class="i">Where</span>(<b>static</b> <span id="r941 rd" class="r941 r">t</span> =&gt; <span class="r941 r">t</span> != <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>)).<span class="i">ToList</span>();
                    <b>if</b> (<span class="r937 r">inferenceCandidates</span>.<span class="i">Count</span> == 0)
                    {
                        <span class="r937 r">inferenceCandidates</span> = <b>null</b>;
                        <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r936 r">typeParameter</span>.<span class="i">GenericParameterPosition</span>] = <b>null</b>;
                    }
                }
            }
 
            <b>if</b> ((<span class="r937 r">inferenceCandidates</span> != <b>null</b>) &amp;&amp; (<span class="r937 r">inferenceCandidates</span>.<span class="i">Count</span> &gt; 1))
            {
                <span class="c">// &quot;base class&quot; assignability-wise (to account for interfaces)</span>
                <span class="i">Type</span> <span id="r942 rd" class="r942 r">commonBaseClass</span> = <span class="r937 r">inferenceCandidates</span>.<span class="i">FirstOrDefault</span>(
                    <span id="r943 rd" class="r943 r">potentiallyCommonBaseClass</span> =&gt;
                        <span class="r937 r">inferenceCandidates</span>.<span class="i">All</span>(
                            <span id="r944 rd" class="r944 r">otherCandidate</span> =&gt;
                                <span class="r944 r">otherCandidate</span> == <span class="r943 r">potentiallyCommonBaseClass</span> ||
                                <span class="r943 r">potentiallyCommonBaseClass</span>.<span class="i">IsAssignableFrom</span>(<span class="r944 r">otherCandidate</span>)));
 
                <b>if</b> (<span class="r942 r">commonBaseClass</span> != <b>null</b>)
                {
                    <span class="r937 r">inferenceCandidates</span>.<span class="i">Clear</span>();
                    <span class="r937 r">inferenceCandidates</span>.<span class="i">Add</span>(<span class="r942 r">commonBaseClass</span>);
                }
                <b>else</b>
                {
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Multiple unreconcilable inferences for type parameter {0}&quot;</span>, <span class="r936 r">typeParameter</span>);
                    <span class="r937 r">inferenceCandidates</span> = <b>null</b>;
                    <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r936 r">typeParameter</span>.<span class="i">GenericParameterPosition</span>] = <b>null</b>;
                }
            }
 
            <b>if</b> (<span class="r937 r">inferenceCandidates</span> == <b>null</b>)
            {
                <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Couldn&#39;t infer type parameter {0}&quot;</span>, <span class="r936 r">typeParameter</span>);
                <b>return</b> <b>null</b>;
            }
            <b>else</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r937 r">inferenceCandidates</span>.<span class="i">Count</span> == 1, <span class="s">&quot;inferenceCandidates should contain exactly 1 element at this point&quot;</span>);
                <b>return</b> <span class="r937 r">inferenceCandidates</span>.<span class="i">Single</span>();
            }
        }
 
        <b>internal bool</b> <a id="6a9116667bb24fa6" href="../R/6a9116667bb24fa6.html" target="n" data-glyph="74,1" class="i method">UnifyMultipleTerms</a>(<span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r945 rd" class="r945 r">parameterTypes</span>, <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r946 rd" class="r946 r">argumentTypes</span>)
        {
            <span class="i">List</span>&lt;<span class="i">Type</span>&gt; <span id="r947 rd" class="r947 r">leftList</span> = <span class="r945 r">parameterTypes</span>.<span class="i">ToList</span>();
            <span class="i">List</span>&lt;<span class="i">Type</span>&gt; <span id="r948 rd" class="r948 r">rightList</span> = <span class="r946 r">argumentTypes</span>.<span class="i">ToList</span>();
 
            <b>if</b> (<span class="r947 r">leftList</span>.<span class="i">Count</span> != <span class="r948 r">rightList</span>.<span class="i">Count</span>)
            {
                <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Mismatch in number of parameters and arguments&quot;</span>);
                <b>return</b> <b>false</b>;
            }
 
            <b>for</b> (<b>int</b> <span id="r949 rd" class="r949 r">i</span> = 0; <span class="r949 r">i</span> &lt; <span class="r947 r">leftList</span>.<span class="i">Count</span>; <span class="r949 r">i</span>++)
            {
                <b>if</b> (!<a href="#acd2bca2943f5b05" class="k">this</a>.<span class="i">Unify</span>(<span class="r947 r">leftList</span>[<span class="r949 r">i</span>], <span class="r948 r">rightList</span>[<span class="r949 r">i</span>]))
                {
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Couldn&#39;t unify {0} with {1}&quot;</span>, <span class="r947 r">leftList</span>[<span class="r949 r">i</span>], <span class="r948 r">rightList</span>[<span class="r949 r">i</span>]);
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private bool</b> <a id="f6cbcc25f8ad6b3d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Unify</a>(<span class="i">Type</span> <span id="r950 rd" class="r950 r">parameterType</span>, <span class="i">Type</span> <span id="r951 rd" class="r951 r">argumentType</span>)
        {
            <b>if</b> (!<span class="r950 r">parameterType</span>.<span class="i">ContainsGenericParameters</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r950 r">parameterType</span>.<span class="i">IsGenericParameter</span>)
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                    <a href="#ec2c14e7a05571c8" class="i field">_typeParametersOfTheMethod</a>.<span class="i">Contains</span>(<span class="r950 r">parameterType</span>),
                    <span class="s">&quot;Only uninstantiated generic type parameters encountered in real life, should be the ones coming from the method&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
                <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt; <span id="r952 rd" class="r952 r">inferenceCandidates</span> = <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r950 r">parameterType</span>.<span class="i">GenericParameterPosition</span>];
                <b>if</b> (<span class="r952 r">inferenceCandidates</span> == <b>null</b>)
                {
                    <span class="r952 r">inferenceCandidates</span> = <b>new</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;();
                    <a href="#305a1771a95a8653" class="i field">_typeParameterIndexToSetOfInferenceCandidates</a>[<span class="r950 r">parameterType</span>.<span class="i">GenericParameterPosition</span>] = <span class="r952 r">inferenceCandidates</span>;
                }
 
                <span class="r952 r">inferenceCandidates</span>.<span class="i">Add</span>(<span class="r951 r">argumentType</span>);
                <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Inferred {0} =&gt; {1}&quot;</span>, <span class="r950 r">parameterType</span>, <span class="r951 r">argumentType</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r950 r">parameterType</span>.<span class="i">IsArray</span>)
            {
                <b>if</b> (<span class="r951 r">argumentType</span> == <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>if</b> (<span class="r951 r">argumentType</span>.<span class="i">IsArray</span> &amp;&amp; <span class="r950 r">parameterType</span>.<span class="i">GetArrayRank</span>() == <span class="r951 r">argumentType</span>.<span class="i">GetArrayRank</span>())
                {
                    <b>return</b> <a href="#acd2bca2943f5b05" class="k">this</a>.<span class="i">Unify</span>(<span class="r950 r">parameterType</span>.<span class="i">GetElementType</span>(), <span class="r951 r">argumentType</span>.<span class="i">GetElementType</span>());
                }
 
                <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Couldn&#39;t unify array {0} with {1}&quot;</span>, <span class="r950 r">parameterType</span>, <span class="r951 r">argumentType</span>);
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r950 r">parameterType</span>.<span class="i">IsByRef</span>)
            {
                <b>if</b> (<span class="r951 r">argumentType</span>.<span class="i">IsGenericType</span> &amp;&amp; <span class="r951 r">argumentType</span>.<span class="i">GetGenericTypeDefinition</span>() == <b>typeof</b>(<a href="MshReference.cs.html#4533b98946fe4766" class="t t">PSReference</a>&lt;&gt;))
                {
                    <span class="i">Type</span> <span id="r953 rd" class="r953 r">referencedType</span> = <span class="r951 r">argumentType</span>.<span class="i">GetGenericArguments</span>()[0];
                    <b>if</b> (<span class="r953 r">referencedType</span> == <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))
                    {
                        <b>return</b> <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <b>return</b> <a href="#acd2bca2943f5b05" class="k">this</a>.<span class="i">Unify</span>(
                            <span class="r950 r">parameterType</span>.<span class="i">GetElementType</span>(),
                            <span class="r953 r">referencedType</span>);
                    }
                }
                <b>else</b>
                {
                    <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Couldn&#39;t unify reference type {0} with {1}&quot;</span>, <span class="r950 r">parameterType</span>, <span class="r951 r">argumentType</span>);
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>if</b> (<span class="r950 r">parameterType</span>.<span class="i">IsGenericType</span> &amp;&amp; <span class="r950 r">parameterType</span>.<span class="i">GetGenericTypeDefinition</span>() == <b>typeof</b>(<span class="i">Nullable</span>&lt;&gt;))
            {
                <b>if</b> (<span class="r951 r">argumentType</span> == <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>return</b> <a href="#acd2bca2943f5b05" class="k">this</a>.<span class="i">Unify</span>(<span class="r950 r">parameterType</span>.<span class="i">GetGenericArguments</span>()[0], <span class="r951 r">argumentType</span>);
            }
 
            <b>if</b> (<span class="r950 r">parameterType</span>.<span class="i">IsGenericType</span>)
            {
                <b>if</b> (<span class="r951 r">argumentType</span> == <b>typeof</b>(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#83ae667ba929e92f" class="t t">Null</a>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>return</b> <a href="#acd2bca2943f5b05" class="k">this</a>.<a href="#029ec2820c6ee4df" class="i method">UnifyConstructedType</a>(<span class="r950 r">parameterType</span>, <span class="r951 r">argumentType</span>);
            }
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Unrecognized kind of type&quot;</span>);
            <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Unrecognized kind of type: {0}&quot;</span>, <span class="r950 r">parameterType</span>);
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b> <a id="029ec2820c6ee4df" href="../R/029ec2820c6ee4df.html" target="n" data-glyph="76,1" class="i method">UnifyConstructedType</a>(<span class="i">Type</span> <span id="r954 rd" class="r954 r">parameterType</span>, <span class="i">Type</span> <span id="r955 rd" class="r955 r">argumentType</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r954 r">parameterType</span>.<span class="i">IsGenericType</span>, <span class="s">&quot;Caller should verify parameterType.IsGenericType before calling this method&quot;</span>);
 
            <b>if</b> (<a href="#cd359e0d882bf8ee" class="i method">IsEqualGenericTypeDefinition</a>(<span class="r954 r">parameterType</span>, <span class="r955 r">argumentType</span>))
            {
                <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r956 rd" class="r956 r">typeParametersOfParameterType</span> = <span class="r954 r">parameterType</span>.<span class="i">GetGenericArguments</span>();
                <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r957 rd" class="r957 r">typeArgumentsOfArgumentType</span> = <span class="r955 r">argumentType</span>.<span class="i">GetGenericArguments</span>();
                <b>return</b> <a href="#acd2bca2943f5b05" class="k">this</a>.<a href="#6a9116667bb24fa6" class="i method">UnifyMultipleTerms</a>(<span class="r956 r">typeParametersOfParameterType</span>, <span class="r957 r">typeArgumentsOfArgumentType</span>);
            }
 
            <span class="i">Type</span>[] <span id="r958 rd" class="r958 r">interfaces</span> = <span class="r955 r">argumentType</span>.<span class="i">GetInterfaces</span>();
            <b>for</b> (<b>int</b> <span id="r959 rd" class="r959 r">i</span> = 0; <span class="r959 r">i</span> &lt; <span class="r958 r">interfaces</span>.<span class="i">Length</span>; <span class="r959 r">i</span>++)
            {
                <b>if</b> (<a href="#cd359e0d882bf8ee" class="i method">IsEqualGenericTypeDefinition</a>(<span class="r954 r">parameterType</span>, <span class="r958 r">interfaces</span>[<span class="r959 r">i</span>]))
                {
                    <b>return</b> <a href="#029ec2820c6ee4df" class="i method">UnifyConstructedType</a>(<span class="r954 r">parameterType</span>, <span class="r958 r">interfaces</span>[<span class="r959 r">i</span>]);
                }
            }
 
            <span class="i">Type</span> <span id="r960 rd" class="r960 r">baseType</span> = <span class="r955 r">argumentType</span>.<span class="i">BaseType</span>;
            <b>while</b> (<span class="r960 r">baseType</span> != <b>null</b>)
            {
                <b>if</b> (<a href="#cd359e0d882bf8ee" class="i method">IsEqualGenericTypeDefinition</a>(<span class="r954 r">parameterType</span>, <span class="r960 r">baseType</span>))
                {
                    <b>return</b> <a href="#029ec2820c6ee4df" class="i method">UnifyConstructedType</a>(<span class="r954 r">parameterType</span>, <span class="r960 r">baseType</span>);
                }
 
                <span class="r960 r">baseType</span> = <span class="r960 r">baseType</span>.<span class="i">BaseType</span>;
            }
 
            <a href="#2c32176ccf8c1b67" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Attempt to unify different constructed types: {0} and {1}&quot;</span>, <span class="r954 r">parameterType</span>, <span class="r955 r">argumentType</span>);
            <b>return</b> <b>false</b>;
        }
 
        <b>private static bool</b> <a id="cd359e0d882bf8ee" href="../R/cd359e0d882bf8ee.html" target="n" data-glyph="76,1" class="i method">IsEqualGenericTypeDefinition</a>(<span class="i">Type</span> <span id="r961 rd" class="r961 r">parameterType</span>, <span class="i">Type</span> <span id="r962 rd" class="r962 r">argumentType</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r961 r">parameterType</span>.<span class="i">IsGenericType</span>, <span class="s">&quot;Caller should verify parameterType.IsGenericType before calling this method&quot;</span>);
 
            <b>if</b> (!<span class="r962 r">argumentType</span>.<span class="i">IsGenericType</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r961 r">parameterType</span>.<span class="i">GetGenericTypeDefinition</span>() == <span class="r962 r">argumentType</span>.<span class="i">GetGenericTypeDefinition</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
