<!DOCTYPE html>
<html><head><title>CommandInfo.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1004);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandInfo.cs" target="_top">engine\CommandInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">ExceptionServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the types of commands that MSH can execute.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="3699fe79fa6969b5" href="../R/3699fe79fa6969b5.html" target="n" data-glyph="18,0" class="t t"><span id="0343769e77ff4691">CommandTypes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Aliases create a name that refers to other command types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Aliases are only persisted within the execution of a single engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="83aa5e1f88cb9bf5" href="../R/83aa5e1f88cb9bf5.html" target="n" data-glyph="24,1" class="i field">Alias</a> = 0x0001,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Script functions that are defined by a script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Functions are only persisted within the execution of a single engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="8a4bdbbd93f182bf" href="../R/8a4bdbbd93f182bf.html" target="n" data-glyph="24,1" class="i field">Function</a> = 0x0002,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Script filters that are defined by a script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Filters are only persisted within the execution of a single engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="7837d2f5f0343c5e" href="../R/7837d2f5f0343c5e.html" target="n" data-glyph="24,1" class="i field">Filter</a> = 0x0004,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e95f2e5deaaf9b93" href="../R/e95f2e5deaaf9b93.html" target="n" data-glyph="24,1" class="i field">Cmdlet</a> = 0x0008,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An MSH script (*.ps1 file)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5baa5da2219b134a" href="../R/5baa5da2219b134a.html" target="n" data-glyph="24,1" class="i field">ExternalScript</a> = 0x0010,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any existing application (can be console or GUI).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An application can have any extension that can be executed either directly through CreateProcess</span>
        <span class="c">///</span><span class="c"> or indirectly through ShellExecute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="f4fc4c6de9082bc5" href="../R/f4fc4c6de9082bc5.html" target="n" data-glyph="24,1" class="i field">Application</a> = 0x0020,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A script that is built into the runspace configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8324208f5ee6d431" href="../R/8324208f5ee6d431.html" target="n" data-glyph="24,1" class="i field">Script</a> = 0x0040,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2a673544a3a7e93f" href="../R/2a673544a3a7e93f.html" target="n" data-glyph="24,1" class="i field">Configuration</a> = 0x0100,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All possible command types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note, a CommandInfo instance will never specify</span>
        <span class="c">///</span><span class="c"> All as its CommandType but All can be used when filtering the CommandTypes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="d7f466cfbbd45cdb" href="../R/d7f466cfbbd45cdb.html" target="n" data-glyph="24,1" class="i field">All</a> = <a href="#83aa5e1f88cb9bf5" class="i field">Alias</a> | <a href="#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="#7837d2f5f0343c5e" class="i field">Filter</a> | <a href="#e95f2e5deaaf9b93" class="i field">Cmdlet</a> | <a href="#8324208f5ee6d431" class="i field">Script</a> | <a href="#5baa5da2219b134a" class="i field">ExternalScript</a> | <a href="#f4fc4c6de9082bc5" class="i field">Application</a> | <a href="#2a673544a3a7e93f" class="i field">Configuration</a>,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The base class for the information about commands. Contains the basic information about</span>
    <span class="c">///</span><span class="c"> the command, like name and type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="71babe57a99ca852" href="../R/71babe57a99ca852.html" target="n" data-glyph="0,0" class="t t">CommandInfo</a> : <a href="SessionStatePublic.cs.html#4b8be05a8447db04" class="t t">IHasSessionStateEntryVisibility</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the CommandInfo class with the specified name and type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="cf9c3d8288d6464f" href="../R/cf9c3d8288d6464f.html" target="n" data-glyph="74,1" class="t constructor">CommandInfo</a>(<b>string</b> <span id="r0 rd" class="r0 r">name</span>, <a href="#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r1 rd" class="r1 r">type</span>)
        {
            <span class="c">// The name can be empty for functions and filters but it</span>
            <span class="c">// can&#39;t be null</span>
 
            <b>if</b> (<span class="r0 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r0 r">name</span>));
            }
 
            <a href="#02e11b521c500195" class="i property">Name</a> = <span class="r0 r">name</span>;
            <a href="#1aa74ca244a39308" class="i property">CommandType</a> = <span class="r1 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the CommandInfo class with the specified name and type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="88b26f0a008ce786" href="../R/88b26f0a008ce786.html" target="n" data-glyph="74,1" class="t constructor">CommandInfo</a>(<b>string</b> <span id="r2 rd" class="r2 r">name</span>, <a href="#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r3 rd" class="r3 r">type</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r4 rd" class="r4 r">context</span>)
            : <a href="#cf9c3d8288d6464f" class="k">this</a>(<span class="r2 r">name</span>, <span class="r3 r">type</span>)
        {
            <a href="#71babe57a99ca852" class="k">this</a>.<a href="#a17100165b2aaab8" class="i property">Context</a> = <span class="r4 r">context</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a copy constructor, used primarily for get-command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="81917b156d933c53" href="../R/81917b156d933c53.html" target="n" data-glyph="74,1" class="t constructor">CommandInfo</a>(<a href="#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r5 rd" class="r5 r">other</span>)
        {
            <span class="c">// Computed fields not copied:</span>
            <span class="c">// this._externalCommandMetadata = other._externalCommandMetadata;</span>
            <span class="c">// this._moduleName = other._moduleName;</span>
            <span class="c">// this.parameterSets = other.parameterSets;</span>
            <a href="#71babe57a99ca852" class="k">this</a>.<a href="#600591313a158d6c" class="i property">Module</a> = <span class="r5 r">other</span>.<a href="#600591313a158d6c" class="i property">Module</a>;
            <a href="#28a424d5f9cf157d" class="i field">_visibility</a> = <span class="r5 r">other</span>.<a href="#28a424d5f9cf157d" class="i field">_visibility</a>;
            <a href="#9395ca406ce72ac1" class="i property">Arguments</a> = <span class="r5 r">other</span>.<a href="#9395ca406ce72ac1" class="i property">Arguments</a>;
            <a href="#71babe57a99ca852" class="k">this</a>.<a href="#a17100165b2aaab8" class="i property">Context</a> = <span class="r5 r">other</span>.<a href="#a17100165b2aaab8" class="i property">Context</a>;
            <a href="#02e11b521c500195" class="i property">Name</a> = <span class="r5 r">other</span>.<a href="#02e11b521c500195" class="i property">Name</a>;
            <a href="#1aa74ca244a39308" class="i property">CommandType</a> = <span class="r5 r">other</span>.<a href="#1aa74ca244a39308" class="i property">CommandType</a>;
            <a href="#a36968f2b7f2ee64" class="i property">CopiedCommand</a> = <span class="r5 r">other</span>;
            <a href="#71babe57a99ca852" class="k">this</a>.<a href="#8677495d43679110" class="i property">DefiningLanguageMode</a> = <span class="r5 r">other</span>.<a href="#8677495d43679110" class="i property">DefiningLanguageMode</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a copy constructor, used primarily for get-command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="64285758be444b60" href="../R/64285758be444b60.html" target="n" data-glyph="74,1" class="t constructor">CommandInfo</a>(<b>string</b> <span id="r6 rd" class="r6 r">name</span>, <a href="#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r7 rd" class="r7 r">other</span>)
            : <a href="#81917b156d933c53" class="k">this</a>(<span class="r7 r">other</span>)
        {
            <a href="#02e11b521c500195" class="i property">Name</a> = <span class="r6 r">name</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the name of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="02e11b521c500195" href="../R/02e11b521c500195.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>private set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">// Name</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#3699fe79fa6969b5" class="t t">CommandTypes</a> <a id="1aa74ca244a39308" href="../R/1aa74ca244a39308.html" target="n" data-glyph="102,1" class="i property">CommandType</a> { <b>get</b>; <b>private set</b>; } = <a href="#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="#f4fc4c6de9082bc5" class="i field">Application</a>;
 
        <span class="c">// CommandType</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the source of the command (shown by default in Get-Command)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual string</b> <a id="8719bbde220716ba" href="../R/8719bbde220716ba.html" target="n" data-glyph="102,1" class="i property">Source</a> { <b>get</b> { <b>return</b> <a href="#71babe57a99ca852" class="k">this</a>.<a href="#fab1cff11b16805c" class="i property">ModuleName</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the source version (shown by default in Get-Command)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">Version</span> <a id="9136cbee5c1afd92" href="../R/9136cbee5c1afd92.html" target="n" data-glyph="102,1" class="i property">Version</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a68392c924bb1841" class="i field">_version</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
                    {
                        <b>if</b> (<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#bb592ab5243224bb" class="i property">Version</a>.<span class="i">Equals</span>(<b>new</b> <span class="i">Version</span>(0, 0)))
                        {
                            <b>if</b> (<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>.<span class="i">EndsWith</span>(<a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#35afed2e7cb8ba9d" class="i field">PowerShellDataFileExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="c">// Manifest module (.psd1)</span>
                                <a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#86de19074268f803" class="i method">SetVersion</a>(<a href="Modules/ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="Modules/ModuleIntrinsics.cs.html#038de7273b66a98e" class="i method">GetManifestModuleVersion</a>(<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>));
                            }
                            <b>else</b> <b>if</b> (<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>.<span class="i">EndsWith</span>(<a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#8b7b1c77a80f7bf4" class="i field">PowerShellILAssemblyExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                                     <a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>.<span class="i">EndsWith</span>(<a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#b12271d4e9d97dc9" class="i field">PowerShellILExecutableExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="c">// Binary module (.dll or .exe)</span>
                                <a href="#600591313a158d6c" class="i property">Module</a>.<span class="i">SetVersion</span>(<span class="i">AssemblyName</span>.<span class="i">GetAssemblyName</span>(<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>).<span class="i">Version</span>);
                            }
                        }
 
                        <a href="#a68392c924bb1841" class="i field">_version</a> = <a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#bb592ab5243224bb" class="i property">Version</a>;
                    }
                }
 
                <b>return</b> <a href="#a68392c924bb1841" class="i field">_version</a>;
            }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="a68392c924bb1841" href="../R/a68392c924bb1841.html" target="n" data-glyph="46,1" class="i field">_version</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context this command will run in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="a17100165b2aaab8" href="../R/a17100165b2aaab8.html" target="n" data-glyph="104,1" class="i property">Context</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#b63a54597316ed91" class="i field">_context</a>;
            }
 
            <b>set</b>
            {
                <a href="#b63a54597316ed91" class="i field">_context</a> = <b>value</b>;
                <b>if</b> ((<b>value</b> != <b>null</b>) &amp;&amp; !<a href="#71babe57a99ca852" class="k">this</a>.<a href="#8677495d43679110" class="i property">DefiningLanguageMode</a>.<span class="i">HasValue</span>)
                {
                    <a href="#71babe57a99ca852" class="k">this</a>.<a href="#8677495d43679110" class="i property">DefiningLanguageMode</a> = <b>value</b>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>;
                }
            }
        }
 
        <b>private</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="b63a54597316ed91" href="../R/b63a54597316ed91.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The language mode that was in effect when this alias was defined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>? <a id="8677495d43679110" href="../R/8677495d43679110.html" target="n" data-glyph="104,1" class="i property">DefiningLanguageMode</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal virtual</b> <a href="../help/HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="4e5a909d9350b765" href="../R/4e5a909d9350b765.html" target="n" data-glyph="104,1" class="i property">HelpCategory</a>
        {
            <b>get</b> { <b>return</b> <a href="../help/HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="../help/HelpSystem.cs.html#bffe33d47c20ce20" class="i field">None</a>; }
        }
 
        <b>internal</b> <a href="#71babe57a99ca852" class="t t">CommandInfo</a> <a id="a36968f2b7f2ee64" href="../R/a36968f2b7f2ee64.html" target="n" data-glyph="104,1" class="i property">CopiedCommand</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal interface to change the type of a CommandInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">newType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="58580c27d3f7c63b" href="../R/58580c27d3f7c63b.html" target="n" data-glyph="74,1" class="i method">SetCommandType</a>(<a href="#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r8 rd" class="r8 r">newType</span>)
        {
            <a href="#1aa74ca244a39308" class="i property">CommandType</a> = <span class="r8 r">newType</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the definition of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is overridden by derived classes to return specific</span>
        <span class="c">///</span><span class="c"> information for the command type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="a887e8cd226475a7" href="../R/a887e8cd226475a7.html" target="n" data-glyph="102,1" class="i property">Definition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is required for renaming aliases, functions, and filters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">newName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new name for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">newName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="16f61f52a82b9c39" href="../R/16f61f52a82b9c39.html" target="n" data-glyph="74,1" class="i method">Rename</a>(<b>string</b> <span id="r9 rd" class="r9 r">newName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r9 r">newName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r9 r">newName</span>));
            }
 
            <a href="#02e11b521c500195" class="i property">Name</a> = <span class="r9 r">newName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For diagnostic purposes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="c3bac3ed48b7e00e" href="../R/c3bac3ed48b7e00e.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="Modules/ModuleCmdletBase.cs.html#589040fe58a3c16e" class="i method">AddPrefixToCommandName</a>(<a href="#02e11b521c500195" class="i property">Name</a>, <a href="#48e9ebf217764505" class="i property">Prefix</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if the command is to be allowed to be executed by a request</span>
        <span class="c">///</span><span class="c"> external to the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="cb0c02415aeca7d5" href="../R/cb0c02415aeca7d5.html" target="n" data-glyph="102,1" class="i property">Visibility</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a36968f2b7f2ee64" class="i property">CopiedCommand</a> == <b>null</b> ? <a href="#28a424d5f9cf157d" class="i field">_visibility</a> : <a href="#a36968f2b7f2ee64" class="i property">CopiedCommand</a>.<a href="#cb0c02415aeca7d5" class="i property">Visibility</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#a36968f2b7f2ee64" class="i property">CopiedCommand</a> == <b>null</b>)
                {
                    <a href="#28a424d5f9cf157d" class="i field">_visibility</a> = <b>value</b>;
                }
                <b>else</b>
                {
                    <a href="#a36968f2b7f2ee64" class="i property">CopiedCommand</a>.<a href="#cb0c02415aeca7d5" class="i property">Visibility</a> = <b>value</b>;
                }
 
                <b>if</b> (<b>value</b> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a> &amp;&amp; <a href="#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
                {
                    <a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#63ba862d617a4c16" class="i property">ModuleHasPrivateMembers</a> = <b>true</b>;
                }
            }
        }
 
        <b>private</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="28a424d5f9cf157d" href="../R/28a424d5f9cf157d.html" target="n" data-glyph="46,1" class="i field">_visibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a CommandMetadata instance that is never exposed publicly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="6816941cf484edda" href="../R/6816941cf484edda.html" target="n" data-glyph="104,1" class="i property">CommandMetadata</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the syntax of a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual string</b> <a id="dadfecc65f9b7a31" href="../R/dadfecc65f9b7a31.html" target="n" data-glyph="104,1" class="i property">Syntax</a>
        {
            <b>get</b> { <b>return</b> <a href="#a887e8cd226475a7" class="i property">Definition</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module name of this command. It will be empty for commands</span>
        <span class="c">///</span><span class="c"> not imported from either a module or snapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="fab1cff11b16805c" href="../R/fab1cff11b16805c.html" target="n" data-glyph="102,1" class="i property">ModuleName</a>
        {
            <b>get</b>
            {
                <b>string</b> <span id="r10 rd" class="r10 r">moduleName</span> = <b>null</b>;
 
                <b>if</b> (<a href="#600591313a158d6c" class="i property">Module</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>))
                {
                    <span class="r10 r">moduleName</span> = <a href="#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>;
                }
                <b>else</b>
                {
                    <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r11 rd" class="r11 r">cmdlet</span> = <a href="#71babe57a99ca852" class="k">this</a> <b>as</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
                    <b>if</b> (<span class="r11 r">cmdlet</span> != <b>null</b> &amp;&amp; <span class="r11 r">cmdlet</span>.<a href="CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a> != <b>null</b>)
                    {
                        <span class="r10 r">moduleName</span> = <span class="r11 r">cmdlet</span>.<a href="CmdletInfo.cs.html#488654e9de9be82f" class="i property">PSSnapInName</a>;
                    }
                }
 
                <b>if</b> (<span class="r10 r">moduleName</span> == <b>null</b>)
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
                <b>return</b> <span class="r10 r">moduleName</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module that defines this cmdlet. This will be null for commands</span>
        <span class="c">///</span><span class="c"> that are not defined in the context of a module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="600591313a158d6c" href="../R/600591313a158d6c.html" target="n" data-glyph="102,1" class="i property">Module</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The remoting capabilities of this cmdlet, when exposed in a context</span>
        <span class="c">///</span><span class="c"> with ambient remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a> <a id="1fa597ff8d35af84" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RemotingCapability</a>
        {
            <b>get</b>
            {
                <b>try</b>
                {
                    <b>return</b> <a href="#72d05582e4d21281" class="i property">ExternalCommandMetadata</a>.<a href="CommandMetadata.cs.html#20278fb4e2f49bdd" class="i property">RemotingCapability</a>;
                }
                <b>catch</b> (<a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a>)
                {
                    <span class="c">// Thrown on an alias that hasn&#39;t been resolved yet (i.e.: in a module that</span>
                    <span class="c">// hasn&#39;t been loaded.) Assume the default.</span>
                    <b>return</b> <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="remoting/common/misc.cs.html#eba7651d6fd75b39" class="i field">PowerShell</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the command has dynamic parameters, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="2ddc8f9ff0560a66" href="../R/2ddc8f9ff0560a66.html" target="n" data-glyph="104,1" class="i property">ImplementsDynamicParameters</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the MergedCommandParameterMetadata, using any arguments that</span>
        <span class="c">///</span><span class="c"> may have been specified so that dynamic parameters can be determined, if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="7580198ae610451c" href="../R/7580198ae610451c.html" target="n" data-glyph="76,1" class="i method">GetMergedCommandParameterMetadataSafely</a>()
        {
            <b>if</b> (<a href="#b63a54597316ed91" class="i field">_context</a> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r12 rd" class="r12 r">result</span>;
            <b>if</b> (<a href="#b63a54597316ed91" class="i field">_context</a> != <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>())
            {
                <span class="c">// In the normal case, _context is from the thread we&#39;re on, and we won&#39;t get here.</span>
                <span class="c">// But, if it&#39;s not, we can&#39;t safely get the parameter metadata without running on</span>
                <span class="c">// on the correct thread, because that thread may be busy doing something else.</span>
                <span class="c">// One of the things we do here is change the current scope in execution context,</span>
                <span class="c">// that can mess up the runspace our CommandInfo object came from.</span>
 
                <a href="hostifaces/ConnectionBase.cs.html#b5efaa6cd9653c05" class="k">var</a> <span id="r13 rd" class="r13 r">runspace</span> = (<a href="hostifaces/ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>)<a href="#b63a54597316ed91" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>;
                <b>if</b> (<span class="r13 r">runspace</span>.<a href="hostifaces/ConnectionBase.cs.html#f2f3a7f1885fe7ea" class="i method">CanRunActionInCurrentPipeline</a>())
                {
                    <a href="#311a1f1df637a299" class="i method">GetMergedCommandParameterMetadata</a>(<b>out</b> <span class="r12 r">result</span>);
                }
                <b>else</b>
                {
                    <a href="#b63a54597316ed91" class="i field">_context</a>.<a href="ExecutionContext.cs.html#67642aa960214ec5" class="i property">Events</a>.<a href="EventManager.cs.html#b470b6b2fdb01a48" class="i method">SubscribeEvent</a>(
                            <span class="r14 r">source</span>: <b>null</b>,
                            <span class="r15 r">eventName</span>: <a href="EventManager.cs.html#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="EventManager.cs.html#18066019f306f7d1" class="i field">GetCommandInfoParameterMetadata</a>,
                            <span class="r16 r">sourceIdentifier</span>: <a href="EventManager.cs.html#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="EventManager.cs.html#18066019f306f7d1" class="i field">GetCommandInfoParameterMetadata</a>,
                            <span class="r17 r">data</span>: <b>null</b>,
                            <span class="r18 r">handlerDelegate</span>: <b>new</b> <span class="t">PSEventReceivedEventHandler</span>(<a href="#560aee609d7d15d8" class="i method">OnGetMergedCommandParameterMetadataSafelyEventHandler</a>),
                            <span class="r19 r">supportEvent</span>: <b>true</b>,
                            <span class="r20 r">forwardEvent</span>: <b>false</b>,
                            <span class="r21 r">shouldQueueAndProcessInExecutionThread</span>: <b>true</b>,
                            <span class="r22 r">maxTriggerCount</span>: 1);
 
                    <a href="#482559739297fb0c" class="k">var</a> <span id="r23 rd" class="r23 r">eventArgs</span> = <b>new</b> <span class="t">GetMergedCommandParameterMetadataSafelyEventArgs</span>();
 
                    <a href="#b63a54597316ed91" class="i field">_context</a>.<a href="ExecutionContext.cs.html#67642aa960214ec5" class="i property">Events</a>.<a href="EventManager.cs.html#bab599a5805d9aed" class="i method">GenerateEvent</a>(
                        <span class="r24 r">sourceIdentifier</span>: <a href="EventManager.cs.html#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="EventManager.cs.html#18066019f306f7d1" class="i field">GetCommandInfoParameterMetadata</a>,
                        <span class="r25 r">sender</span>: <b>null</b>,
                        <span class="r26 r">args</span>: <b>new</b>[] { <span class="r23 r">eventArgs</span> },
                        <span class="r27 r">extraData</span>: <b>null</b>,
                        <span class="r28 r">processInCurrentThread</span>: <b>true</b>,
                        <span class="r29 r">waitForCompletionInCurrentThread</span>: <b>true</b>);
 
                    <b>if</b> (<span class="r23 r">eventArgs</span>.<a href="#ffabb63d5f10b837" class="i field">Exception</a> != <b>null</b>)
                    {
                        <span class="c">// An exception happened on a different thread, rethrow it here on the correct thread.</span>
                        <span class="r23 r">eventArgs</span>.<a href="#ffabb63d5f10b837" class="i field">Exception</a>.<span class="i">Throw</span>();
                    }
 
                    <b>return</b> <span class="r23 r">eventArgs</span>.<a href="#54310c75c7d01d41" class="i field">Result</a>;
                }
            }
 
            <a href="#311a1f1df637a299" class="i method">GetMergedCommandParameterMetadata</a>(<b>out</b> <span class="r12 r">result</span>);
            <b>return</b> <span class="r12 r">result</span>;
        }
 
        <b>private sealed class</b> <a id="482559739297fb0c" href="../R/482559739297fb0c.html" target="n" data-glyph="4,1" class="t t"><span id="b8e30fe96c32dc0a">GetMergedCommandParameterMetadataSafelyEventArgs</span></a> : <span class="i">EventArgs</span>
        {
            <b>public</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="54310c75c7d01d41" href="../R/54310c75c7d01d41.html" target="n" data-glyph="42,2" class="i field">Result</a>;
            <b>public</b> <span class="i">ExceptionDispatchInfo</span> <a id="ffabb63d5f10b837" href="../R/ffabb63d5f10b837.html" target="n" data-glyph="42,2" class="i field">Exception</a>;
        }
 
        <b>private void</b> <a id="560aee609d7d15d8" href="../R/560aee609d7d15d8.html" target="n" data-glyph="76,1" class="i method">OnGetMergedCommandParameterMetadataSafelyEventHandler</a>(<b>object</b> <span id="r30 rd" class="r30 r">sender</span>, <a href="EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r31 rd" class="r31 r">args</span>)
        {
            <a href="#482559739297fb0c" class="k">var</a> <span id="r32 rd" class="r32 r">eventArgs</span> = <span class="r31 r">args</span>.<a href="EventManager.cs.html#d0726de6cebf6169" class="i property">SourceEventArgs</a> <b>as</b> <a href="#482559739297fb0c" class="t t">GetMergedCommandParameterMetadataSafelyEventArgs</a>;
            <b>if</b> (<span class="r32 r">eventArgs</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="c">// Save the result in our event args as the return value.</span>
                    <a href="#311a1f1df637a299" class="i method">GetMergedCommandParameterMetadata</a>(<b>out</b> <span class="r32 r">eventArgs</span>.<a href="#54310c75c7d01d41" class="i field">Result</a>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r33 rd" class="r33 r">e</span>)
                {
                    <span class="c">// Save the exception so we can throw it on the correct thread.</span>
                    <span class="r32 r">eventArgs</span>.<a href="#ffabb63d5f10b837" class="i field">Exception</a> = <span class="i">ExceptionDispatchInfo</span>.<span class="i">Capture</span>(<span class="r33 r">e</span>);
                }
            }
        }
 
        <b>private void</b> <a id="311a1f1df637a299" href="../R/311a1f1df637a299.html" target="n" data-glyph="76,1" class="i method">GetMergedCommandParameterMetadata</a>(<b>out</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r34 rd" class="r34 r">result</span>)
        {
            <span class="c">// MSFT:652277 - When invoking cmdlets or advanced functions, MyInvocation.MyCommand.Parameters do not contain the dynamic parameters</span>
            <span class="c">// When trying to get parameter metadata for a CommandInfo that has dynamic parameters, a new CommandProcessor will be</span>
            <span class="c">// created out of this CommandInfo and the parameter binding algorithm will be invoked. However, when this happens via</span>
            <span class="c">// &#39;MyInvocation.MyCommand.Parameter&#39;, it&#39;s actually retrieving the parameter metadata of the same cmdlet that is currently</span>
            <span class="c">// running. In this case, information about the specified parameters are not kept around in &#39;MyInvocation.MyCommand&#39;, so</span>
            <span class="c">// going through the binding algorithm again won&#39;t give us the metadata about the dynamic parameters that should have been</span>
            <span class="c">// discovered already.</span>
            <span class="c">// The fix is to check if the CommandInfo is actually representing the currently running cmdlet. If so, the retrieval of parameter</span>
            <span class="c">// metadata actually stems from the running of the same cmdlet. In this case, we can just use the current CommandProcessor to</span>
            <span class="c">// retrieve all bindable parameters, which should include the dynamic parameters that have been discovered already.</span>
            <a href="CommandProcessor.cs.html#35bfa3d4fe5f92fc" class="t t">CommandProcessor</a> <span id="r35 rd" class="r35 r">processor</span>;
            <b>if</b> (<a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> != <b>null</b> &amp;&amp; <a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a> == <a href="#71babe57a99ca852" class="k">this</a>)
            {
                <span class="c">// Accessing the parameters within the invocation of the same cmdlet/advanced function.</span>
                <span class="r35 r">processor</span> = (<a href="CommandProcessor.cs.html#35bfa3d4fe5f92fc" class="t t">CommandProcessor</a>)<a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>;
            }
            <b>else</b>
            {
                <a href="#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a> <span id="r36 rd" class="r36 r">scriptCommand</span> = <a href="#71babe57a99ca852" class="k">this</a> <b>as</b> <a href="#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>;
                <span class="r35 r">processor</span> = <span class="r36 r">scriptCommand</span> != <b>null</b>
                    ? <b>new</b> <a href="CommandProcessor.cs.html#6dbda84e1bbd31ad" class="t constructor">CommandProcessor</a>(<span class="r36 r">scriptCommand</span>, <a href="#b63a54597316ed91" class="i field">_context</a>, <span class="r37 r">useLocalScope</span>: <b>true</b>, <span class="r38 r">fromScriptFile</span>: <b>false</b>,
                        <span class="r39 r">sessionState</span>: <span class="r36 r">scriptCommand</span>.<a href="#753af6705016f48b" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#d25a345294fd74f0" class="i property">SessionStateInternal</a> ?? <a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>)
                    : <b>new</b> <a href="CommandProcessor.cs.html#64adc694daeabdd8" class="t constructor">CommandProcessor</a>((<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>)<a href="#71babe57a99ca852" class="k">this</a>, <a href="#b63a54597316ed91" class="i field">_context</a>) { <a href="CommandProcessorBase.cs.html#d3edce8b26f160da" class="i property">UseLocalScope</a> = <b>true</b> };
 
                <a href="ParameterBinderController.cs.html#9e4e49a03a43c579" class="t t">ParameterBinderController</a>.<a href="ParameterBinderController.cs.html#4bdadb9bbf1443dd" class="i method">AddArgumentsToCommandProcessor</a>(<span class="r35 r">processor</span>, <a href="#9395ca406ce72ac1" class="i property">Arguments</a>);
                <a href="CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r40 rd" class="r40 r">oldCurrentCommandProcessor</span> = <a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>;
                <b>try</b>
                {
                    <a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> = <span class="r35 r">processor</span>;
 
                    <span class="r35 r">processor</span>.<a href="CommandProcessorBase.cs.html#2a4698751cbdab79" class="i method">SetCurrentScopeToExecutionScope</a>();
                    <span class="r35 r">processor</span>.<a href="CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="CmdletParameterBinderController.cs.html#50831ff19421d0e9" class="i method">BindCommandLineParametersNoValidation</a>(<span class="r35 r">processor</span>.<a href="CommandProcessorBase.cs.html#5bfa2b362a5e8358" class="i field">arguments</a>);
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
                {
                    <span class="c">// Ignore the binding exception if no argument is specified</span>
                    <b>if</b> (<span class="r35 r">processor</span>.<a href="CommandProcessorBase.cs.html#5bfa2b362a5e8358" class="i field">arguments</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>throw</b>;
                    }
                }
                <b>finally</b>
                {
                    <a href="#a17100165b2aaab8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> = <span class="r40 r">oldCurrentCommandProcessor</span>;
                    <span class="r35 r">processor</span>.<a href="CommandProcessorBase.cs.html#1a8d2d2aeb322b3b" class="i method">RestorePreviousScope</a>();
                }
            }
 
            <span class="r34 r">result</span> = <span class="r35 r">processor</span>.<a href="CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the parameters for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <a id="47c98606bb00b9ff" href="../R/47c98606bb00b9ff.html" target="n" data-glyph="102,1" class="i property">Parameters</a>
        {
            <b>get</b>
            {
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r41 rd" class="r41 r">result</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <b>if</b> (<a href="#2ddc8f9ff0560a66" class="i property">ImplementsDynamicParameters</a> &amp;&amp; <a href="#a17100165b2aaab8" class="i property">Context</a> != <b>null</b>)
                {
                    <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r42 rd" class="r42 r">merged</span> = <a href="#7580198ae610451c" class="i method">GetMergedCommandParameterMetadataSafely</a>();
 
                    <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r43 rd" class="r43 r">pair</span> <b>in</b> <span class="r42 r">merged</span>.<a href="MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>)
                    {
                        <span class="r41 r">result</span>.<span class="i">Add</span>(<span class="r43 r">pair</span>.<span class="i">Key</span>, <b>new</b> <span class="t">ParameterMetadata</span>(<span class="r43 r">pair</span>.<span class="i">Value</span>.<span class="i">Parameter</span>));
                    }
 
                    <span class="c">// Don&#39;t cache this data...</span>
                    <b>return</b> <span class="r41 r">result</span>;
                }
 
                <b>return</b> <a href="#72d05582e4d21281" class="i property">ExternalCommandMetadata</a>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>;
            }
        }
 
        <b>internal</b> <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="72d05582e4d21281" href="../R/72d05582e4d21281.html" target="n" data-glyph="104,1" class="i property">ExternalCommandMetadata</a>
        {
            <b>get</b> { <b>return</b> <a href="#be719a7fb2df72cd" class="i field">_externalCommandMetadata</a> ??= <b>new</b> <a href="CommandMetadata.cs.html#f5f5067fb7a93f99" class="t constructor">CommandMetadata</a>(<a href="#71babe57a99ca852" class="k">this</a>, <b>true</b>); }
 
            <b>set</b> { <a href="#be719a7fb2df72cd" class="i field">_externalCommandMetadata</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="be719a7fb2df72cd" href="../R/be719a7fb2df72cd.html" target="n" data-glyph="46,1" class="i field">_externalCommandMetadata</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves a full, shortened, or aliased parameter name to the actual</span>
        <span class="c">///</span><span class="c"> cmdlet parameter name, using PowerShell&#39;s standard parameter resolution</span>
        <span class="c">///</span><span class="c"> algorithm.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the parameter to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The parameter that matches this name.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <a id="37f7c5bdf8a33417" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ResolveParameter</a>(<b>string</b> <span id="r44 rd" class="r44 r">name</span>)
        {
            <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r45 rd" class="r45 r">merged</span> = <a href="#7580198ae610451c" class="i method">GetMergedCommandParameterMetadataSafely</a>();
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r46 rd" class="r46 r">result</span> = <span class="r45 r">merged</span>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(<span class="r44 r">name</span>, <b>true</b>, <b>true</b>, <b>null</b>);
            <b>return</b> <a href="#71babe57a99ca852" class="k">this</a>.<a href="#47c98606bb00b9ff" class="i property">Parameters</a>[<span class="r46 r">result</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>];
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the information about the parameters and parameter sets for</span>
        <span class="c">///</span><span class="c"> this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <a id="683b1318ec95988c" href="../R/683b1318ec95988c.html" target="n" data-glyph="102,1" class="i property">ParameterSets</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#f2c7b4e55c925ed7" class="i field">_parameterSets</a> == <b>null</b>)
                {
                    <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <span id="r47 rd" class="r47 r">parameterSetInfo</span> =
                        <a href="#27faad5ba8c6afd6" class="i method">GenerateCommandParameterSetInfo</a>();
 
                    <a href="#f2c7b4e55c925ed7" class="i field">_parameterSets</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt;(<span class="r47 r">parameterSetInfo</span>);
                }
 
                <b>return</b> <a href="#f2c7b4e55c925ed7" class="i field">_parameterSets</a>;
            }
        }
 
        <b>internal</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <a id="f2c7b4e55c925ed7" href="../R/f2c7b4e55c925ed7.html" target="n" data-glyph="44,1" class="i field">_parameterSets</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A possibly incomplete or even incorrect list of types the command could return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public abstract</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <a id="45a989149217e2c6" href="../R/45a989149217e2c6.html" target="n" data-glyph="102,1" class="i property">OutputType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies whether this command was imported from a module or not.</span>
        <span class="c">///</span><span class="c"> This is used in Get-Command to figure out which of the commands in module session state were imported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="bf26634b5d5047e5" href="../R/bf26634b5d5047e5.html" target="n" data-glyph="104,1" class="i property">IsImported</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The prefix that was used when importing this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="48e9ebf217764505" href="../R/48e9ebf217764505.html" target="n" data-glyph="104,1" class="i property">Prefix</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a copy of commandInfo for GetCommandCommand so that we can generate parameter</span>
        <span class="c">///</span><span class="c"> sets based on an argument list (so we can get the dynamic parameters.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#71babe57a99ca852" class="t t">CommandInfo</a> <a id="6ceaaea482e14e93" href="../R/6ceaaea482e14e93.html" target="n" data-glyph="74,1" class="i method">CreateGetCommandCopy</a>(<b>object</b>[] <span id="r48 rd" class="r48 r">argumentList</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates the parameter and parameter set info from the cmdlet metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of CommandParameterSetInfo representing the cmdlet metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type name is invalid or the length of the type name</span>
        <span class="c">///</span><span class="c"> exceeds 1024 characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The caller does not have the required permission to load the assembly</span>
        <span class="c">///</span><span class="c"> or create the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#cde577fa1eaccc35" class="t t">ParsingMetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If more than int.MaxValue parameter-sets are defined for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <a id="27faad5ba8c6afd6" href="../R/27faad5ba8c6afd6.html" target="n" data-glyph="74,1" class="i method">GenerateCommandParameterSetInfo</a>()
        {
            <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <span id="r49 rd" class="r49 r">result</span>;
 
            <b>if</b> (<a href="#bf92c8eba202d917" class="i property">IsGetCommandCopy</a> &amp;&amp; <a href="#2ddc8f9ff0560a66" class="i property">ImplementsDynamicParameters</a>)
            {
                <span class="r49 r">result</span> = <a href="#d644326ad922fdfb" class="i method">GetParameterMetadata</a>(<a href="#6816941cf484edda" class="i property">CommandMetadata</a>, <a href="#7580198ae610451c" class="i method">GetMergedCommandParameterMetadataSafely</a>());
            }
            <b>else</b>
            {
                <span class="r49 r">result</span> = <a href="#2814fad729f7df66" class="i method">GetCacheableMetadata</a>(<a href="#6816941cf484edda" class="i property">CommandMetadata</a>);
            }
 
            <b>return</b> <span class="r49 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether this CmdletInfo instance is a copy used for get-command.</span>
        <span class="c">///</span><span class="c"> If true, and the cmdlet supports dynamic parameters, it means that the dynamic</span>
        <span class="c">///</span><span class="c"> parameter metadata will be merged into the parameter set information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="bf92c8eba202d917" href="../R/bf92c8eba202d917.html" target="n" data-glyph="104,1" class="i property">IsGetCommandCopy</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the command line arguments/parameters that were specified</span>
        <span class="c">///</span><span class="c"> which will allow for the dynamic parameters to be retrieved and their</span>
        <span class="c">///</span><span class="c"> metadata merged into the parameter set information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b>[] <a id="9395ca406ce72ac1" href="../R/9395ca406ce72ac1.html" target="n" data-glyph="104,1" class="i property">Arguments</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <a id="2814fad729f7df66" href="../R/2814fad729f7df66.html" target="n" data-glyph="74,1" class="i method">GetCacheableMetadata</a>(<a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r50 rd" class="r50 r">metadata</span>)
        {
            <b>return</b> <a href="#d644326ad922fdfb" class="i method">GetParameterMetadata</a>(<span class="r50 r">metadata</span>, <span class="r50 r">metadata</span>.<a href="CommandMetadata.cs.html#2949218a02f2a560" class="i property">StaticCommandParameterMetadata</a>);
        }
 
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <a id="d644326ad922fdfb" href="../R/d644326ad922fdfb.html" target="n" data-glyph="74,1" class="i method">GetParameterMetadata</a>(<a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r51 rd" class="r51 r">metadata</span>, <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r52 rd" class="r52 r">parameterMetadata</span>)
        {
            <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt; <span id="r53 rd" class="r53 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="ParameterSetInfo.cs.html#e8ba2c3bb4e8294c" class="t t">CommandParameterSetInfo</a>&gt;();
 
            <b>if</b> (<span class="r52 r">parameterMetadata</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r52 r">parameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a> == 0)
                {
                    <b>const string</b> <span id="r54 rd" class="r54 r">parameterSetName</span> = <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>;
 
                    <span class="r53 r">result</span>.<span class="i">Add</span>(
                        <b>new</b> <span class="t">CommandParameterSetInfo</span>(
                            <span class="r54 r">parameterSetName</span>,
                            <b>false</b>,
                            <b>uint</b>.<span class="i">MaxValue</span>,
                            <span class="r52 r">parameterMetadata</span>));
                }
                <b>else</b>
                {
                    <b>int</b> <span id="r55 rd" class="r55 r">parameterSetCount</span> = <span class="r52 r">parameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a>;
                    <b>for</b> (<b>int</b> <span id="r56 rd" class="r56 r">index</span> = 0; <span class="r56 r">index</span> &lt; <span class="r55 r">parameterSetCount</span>; ++<span class="r56 r">index</span>)
                    {
                        <b>uint</b> <span id="r57 rd" class="r57 r">currentFlagPosition</span> = (<b>uint</b>)0x1 &lt;&lt; <span class="r56 r">index</span>;
 
                        <span class="c">// Get the parameter set name</span>
                        <b>string</b> <span id="r58 rd" class="r58 r">parameterSetName</span> = <span class="r52 r">parameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<span class="r57 r">currentFlagPosition</span>);
 
                        <span class="c">// Is the parameter set the default?</span>
                        <b>bool</b> <span id="r59 rd" class="r59 r">isDefaultParameterSet</span> = (<span class="r57 r">currentFlagPosition</span> &amp; <span class="r51 r">metadata</span>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>) != 0;
 
                        <span class="r53 r">result</span>.<span class="i">Add</span>(
                            <b>new</b> <a href="ParameterSetInfo.cs.html#bb5db897e763689a" class="t constructor">CommandParameterSetInfo</a>(
                                <span class="r58 r">parameterSetName</span>,
                                <span class="r59 r">isDefaultParameterSet</span>,
                                <span class="r57 r">currentFlagPosition</span>,
                                <span class="r52 r">parameterMetadata</span>));
                    }
                }
            }
 
            <b>return</b> <span class="r53 r">result</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, but can be used where a real type</span>
    <span class="c">///</span><span class="c"> might not be available, in which case the name of the type can be used.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="c3ad7c327ac93d6b" href="../R/c3ad7c327ac93d6b.html" target="n" data-glyph="0,0" class="t t">PSTypeName</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is used when the type exists and is currently loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3e527d7630aed690" href="../R/3e527d7630aed690.html" target="n" data-glyph="72,1" class="t constructor">PSTypeName</a>(<span class="i">Type</span> <span id="r60 rd" class="r60 r">type</span>)
        {
            <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <span class="r60 r">type</span>;
            <b>if</b> (<a href="#a0ab94213cfcfffe" class="i field">_type</a> != <b>null</b>)
            {
                <a href="#77cc6b79382c5568" class="i property">Name</a> = <a href="#a0ab94213cfcfffe" class="i field">_type</a>.<span class="i">FullName</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is used when the type may not exist, or is not loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="2523187e7389c7a8" href="../R/2523187e7389c7a8.html" target="n" data-glyph="72,1" class="t constructor">PSTypeName</a>(<b>string</b> <span id="r61 rd" class="r61 r">name</span>)
        {
            <a href="#77cc6b79382c5568" class="i property">Name</a> = <span class="r61 r">name</span>;
            <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is used when the creating a PSObject with a custom typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The real type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="35a51da01062a5d0" href="../R/35a51da01062a5d0.html" target="n" data-glyph="72,1" class="t constructor">PSTypeName</a>(<b>string</b> <span id="r62 rd" class="r62 r">name</span>, <span class="i">Type</span> <span id="r63 rd" class="r63 r">type</span>)
        {
            <a href="#77cc6b79382c5568" class="i property">Name</a> = <span class="r62 r">name</span>;
            <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <span class="r63 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is used when the type is defined in PowerShell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">typeDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type definition from the ast.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c2350d8f7a0200ca" href="../R/c2350d8f7a0200ca.html" target="n" data-glyph="72,1" class="t constructor">PSTypeName</a>(<a href="parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r64 rd" class="r64 r">typeDefinitionAst</span>)
        {
            <b>if</b> (<span class="r64 r">typeDefinitionAst</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r64 r">typeDefinitionAst</span>));
            }
 
            <a href="#9e1b5a33af8c2483" class="i property">TypeDefinitionAst</a> = <span class="r64 r">typeDefinitionAst</span>;
            <a href="#77cc6b79382c5568" class="i property">Name</a> = <span class="r64 r">typeDefinitionAst</span>.<a href="parser/ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor creates a type from a ITypeName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="6d38682bb2f27b26" href="../R/6d38682bb2f27b26.html" target="n" data-glyph="72,1" class="t constructor">PSTypeName</a>(<a href="parser/ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r65 rd" class="r65 r">typeName</span>)
        {
            <b>if</b> (<span class="r65 r">typeName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r65 r">typeName</span>));
            }
 
            <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <span class="r65 r">typeName</span>.<a href="parser/ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
            <b>if</b> (<a href="#a0ab94213cfcfffe" class="i field">_type</a> != <b>null</b>)
            {
                <a href="#77cc6b79382c5568" class="i property">Name</a> = <a href="#a0ab94213cfcfffe" class="i field">_type</a>.<span class="i">FullName</span>;
            }
            <b>else</b>
            {
                <a href="parser/ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r66 rd" class="r66 r">t</span> = <span class="r65 r">typeName</span> <b>as</b> <a href="parser/ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a>;
                <b>if</b> (<span class="r66 r">t</span> != <b>null</b> &amp;&amp; <span class="r66 r">t</span>.<a href="parser/ast.cs.html#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> != <b>null</b>)
                {
                    <a href="#9e1b5a33af8c2483" class="i property">TypeDefinitionAst</a> = <span class="r66 r">t</span>.<a href="parser/ast.cs.html#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a>;
                    <a href="#77cc6b79382c5568" class="i property">Name</a> = <a href="#9e1b5a33af8c2483" class="i property">TypeDefinitionAst</a>.<a href="parser/ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>;
                }
                <b>else</b>
                {
                    <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <b>null</b>;
                    <a href="#77cc6b79382c5568" class="i property">Name</a> = <span class="r65 r">typeName</span>.<a href="parser/ast.cs.html#15c64a580f477707" class="i property">FullName</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the name of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="77cc6b79382c5568" href="../R/77cc6b79382c5568.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the type with metadata, or null if the type is not loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1721:PropertyNamesShouldNotMatchGetMethods&quot;</span>)]
        <b>public</b> <span class="i">Type</span> <a id="df5aa9a70e9b5611" href="../R/df5aa9a70e9b5611.html" target="n" data-glyph="102,1" class="i property">Type</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<a href="#81316812d57353b7" class="i field">_typeWasCalculated</a>)
                {
                    <b>if</b> (<a href="#a0ab94213cfcfffe" class="i field">_type</a> == <b>null</b>)
                    {
                        <b>if</b> (<a href="#9e1b5a33af8c2483" class="i property">TypeDefinitionAst</a> != <b>null</b>)
                        {
                            <a href="#a0ab94213cfcfffe" class="i field">_type</a> = <a href="#9e1b5a33af8c2483" class="i property">TypeDefinitionAst</a>.<a href="parser/ast.cs.html#238185060b3af590" class="i property">Type</a>;
                        }
                        <b>else</b>
                        {
                            <a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#3fb063578567b37c" class="i method">TryResolveType</a>(<a href="#77cc6b79382c5568" class="i property">Name</a>, <b>out</b> <a href="#a0ab94213cfcfffe" class="i field">_type</a>);
                        }
                    }
 
                    <b>if</b> (<a href="#a0ab94213cfcfffe" class="i field">_type</a> == <b>null</b>)
                    {
                        <span class="c">// We ignore the exception.</span>
                        <b>if</b> (<a href="#77cc6b79382c5568" class="i property">Name</a> != <b>null</b> &amp;&amp;
                            <a href="#77cc6b79382c5568" class="i property">Name</a>.<span class="i">StartsWith</span>(<span class="s">&#39;[&#39;</span>) &amp;&amp;
                            <a href="#77cc6b79382c5568" class="i property">Name</a>.<span class="i">EndsWith</span>(<span class="s">&#39;]&#39;</span>))
                        {
                            <b>string</b> <span id="r67 rd" class="r67 r">tmp</span> = <a href="#77cc6b79382c5568" class="i property">Name</a>.<span class="i">Substring</span>(1, <a href="#77cc6b79382c5568" class="i property">Name</a>.<span class="i">Length</span> - 2);
                            <a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#3fb063578567b37c" class="i method">TryResolveType</a>(<span class="r67 r">tmp</span>, <b>out</b> <a href="#a0ab94213cfcfffe" class="i field">_type</a>);
                        }
                    }
 
                    <a href="#81316812d57353b7" class="i field">_typeWasCalculated</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#a0ab94213cfcfffe" class="i field">_type</a>;
            }
        }
 
        <b>private</b> <span class="i">Type</span> <a id="a0ab94213cfcfffe" href="../R/a0ab94213cfcfffe.html" target="n" data-glyph="46,1" class="i field">_type</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a type is defined by PowerShell, the ast for that type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="9e1b5a33af8c2483" href="../R/9e1b5a33af8c2483.html" target="n" data-glyph="102,1" class="i property">TypeDefinitionAst</a> { <b>get</b>; }
 
        <b>private bool</b> <a id="81316812d57353b7" href="../R/81316812d57353b7.html" target="n" data-glyph="46,1" class="i field">_typeWasCalculated</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a String that represents the current PSTypeName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">String that represents the current PSTypeName.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="470d430a6b625f46" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#77cc6b79382c5568" class="i property">Name</a> ?? <b>string</b>.<span class="i">Empty</span>;
        }
    }
 
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;{PSTypeName} {Name}&quot;</span>)]
    <b>internal readonly struct</b> <a id="85ce15321cd9211a" href="../R/85ce15321cd9211a.html" target="n" data-glyph="110,0" class="t t"><span id="d3d2d410b80379f2">PSMemberNameAndType</span></a>
    {
        <b>public readonly string</b> <a id="b5c1d9a4ce1fb239" href="../R/b5c1d9a4ce1fb239.html" target="n" data-glyph="42,1" class="i field">Name</a>;
 
        <b>public readonly</b> <a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <a id="6f28e3992555ebc4" href="../R/6f28e3992555ebc4.html" target="n" data-glyph="42,1" class="i field">PSTypeName</a>;
 
        <b>public readonly object</b> <a id="0a9898c5651e06f8" href="../R/0a9898c5651e06f8.html" target="n" data-glyph="42,1" class="i field">Value</a>;
 
        <b>public</b> <a id="1901992b2fe17740" href="../R/1901992b2fe17740.html" target="n" data-glyph="72,1" class="t constructor">PSMemberNameAndType</a>(<b>string</b> <span id="r68 rd" class="r68 r">name</span>, <a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r69 rd" class="r69 r">typeName</span>, <b>object</b> <span id="r70 rd" class="r70 r">value</span> = <b>null</b>)
        {
            <a href="#b5c1d9a4ce1fb239" class="i field">Name</a> = <span class="r68 r">name</span>;
            <a href="#6f28e3992555ebc4" class="i field">PSTypeName</a> = <span class="r69 r">typeName</span>;
            <a href="#0a9898c5651e06f8" class="i field">Value</a> = <span class="r70 r">value</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents dynamic types such as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> but can be used where a real type might not be available, in which case the name of the type can be used.</span>
    <span class="c">///</span><span class="c"> The type encodes the members of dynamic objects in the type name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="dbabf864ac5b856c" href="../R/dbabf864ac5b856c.html" target="n" data-glyph="2,0" class="t t">PSSyntheticTypeName</a> : <a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a>
    {
        <b>internal static</b> <a href="#dbabf864ac5b856c" class="t t">PSSyntheticTypeName</a> <a id="e55ab3afe7beae24" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Create</a>(<b>string</b> <span id="r71 rd" class="r71 r">typename</span>, <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <span id="r72 rd" class="r72 r">membersTypes</span>) =&gt; <a href="#9a9ca62ea06c2a9d" class="i method">Create</a>(<b>new</b> <a href="#2523187e7389c7a8" class="t constructor">PSTypeName</a>(<span class="r71 r">typename</span>), <span class="r72 r">membersTypes</span>);
 
        <b>internal static</b> <a href="#dbabf864ac5b856c" class="t t">PSSyntheticTypeName</a> <a id="767dc3007a5e01d9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Create</a>(<span class="i">Type</span> <span id="r73 rd" class="r73 r">type</span>, <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <span id="r74 rd" class="r74 r">membersTypes</span>) =&gt; <a href="#9a9ca62ea06c2a9d" class="i method">Create</a>(<b>new</b> <a href="#3e527d7630aed690" class="t constructor">PSTypeName</a>(<span class="r73 r">type</span>), <span class="r74 r">membersTypes</span>);
 
        <b>internal static</b> <a href="#dbabf864ac5b856c" class="t t">PSSyntheticTypeName</a> <a id="9a9ca62ea06c2a9d" href="../R/9a9ca62ea06c2a9d.html" target="n" data-glyph="74,1" class="i method">Create</a>(<a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r75 rd" class="r75 r">typename</span>, <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <span id="r76 rd" class="r76 r">membersTypes</span>)
        {
            <b>var</b> <span id="r77 rd" class="r77 r">typeName</span> = <a href="#b782e0f6e6d6d7c0" class="i method">GetMemberTypeProjection</a>(<span class="r75 r">typename</span>.<a href="#77cc6b79382c5568" class="i property">Name</a>, <span class="r76 r">membersTypes</span>);
            <b>var</b> <span id="r78 rd" class="r78 r">members</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt;();
            <span class="r78 r">members</span>.<span class="i">AddRange</span>(<span class="r76 r">membersTypes</span>);
            <span class="r78 r">members</span>.<span class="i">Sort</span>(<b>static</b> (<span id="r79 rd" class="r79 r">c1</span>, <span id="r80 rd" class="r80 r">c2</span>) =&gt; <b>string</b>.<span class="i">Compare</span>(<span class="r79 r">c1</span>.<span class="i">Name</span>, <span class="r80 r">c2</span>.<span class="i">Name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
            <b>return</b> <b>new</b> <span class="t">PSSyntheticTypeName</span>(<span class="r77 r">typeName</span>, <span class="r75 r">typename</span>.<a href="#df5aa9a70e9b5611" class="i property">Type</a>, <span class="r78 r">members</span>);
        }
 
        <b>private</b> <a id="0a108aed8d77c27b" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">PSSyntheticTypeName</a>(<b>string</b> <span id="r81 rd" class="r81 r">typeName</span>, <span class="i">Type</span> <span id="r82 rd" class="r82 r">type</span>, <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <span id="r83 rd" class="r83 r">membersTypes</span>)
        : <a href="#35a51da01062a5d0" class="k">base</a>(<span class="r81 r">typeName</span>, <span class="r82 r">type</span>)
        {
            <a href="#c75b7eae36ef308e" class="i property">Members</a> = <span class="r83 r">membersTypes</span>;
            <b>if</b> (<span class="r82 r">type</span> != <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>))
            {
                <b>return</b>;
            }
 
            <b>for</b> (<b>int</b> <span id="r84 rd" class="r84 r">i</span> = 0; <span class="r84 r">i</span> &lt; <a href="#c75b7eae36ef308e" class="i property">Members</a>.<span class="i">Count</span>; <span class="r84 r">i</span>++)
            {
                <b>var</b> <span id="r85 rd" class="r85 r">psMemberNameAndType</span> = <a href="#c75b7eae36ef308e" class="i property">Members</a>[<span class="r84 r">i</span>];
                <b>if</b> (<span class="i">IsPSTypeName</span>(<span class="r85 r">psMemberNameAndType</span>))
                {
                    <a href="#c75b7eae36ef308e" class="i property">Members</a>.<span class="i">RemoveAt</span>(<span class="r84 r">i</span>);
                    <b>break</b>;
                }
            }
        }
 
        <b>private static bool</b> <a id="ecdb1d75a37a8e99" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsPSTypeName</a>(<b>in</b> <a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a> <span id="r86 rd" class="r86 r">member</span>) =&gt; <span class="r86 r">member</span>.<a href="#b5c1d9a4ce1fb239" class="i field">Name</a>.<span class="i">Equals</span>(<b>nameof</b>(<a href="#c3ad7c327ac93d6b" class="t t">PSTypeName</a>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private static string</b> <a id="b782e0f6e6d6d7c0" href="../R/b782e0f6e6d6d7c0.html" target="n" data-glyph="76,1" class="i method">GetMemberTypeProjection</a>(<b>string</b> <span id="r87 rd" class="r87 r">typename</span>, <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <span id="r88 rd" class="r88 r">members</span>)
        {
            <b>if</b> (<span class="r87 r">typename</span> == <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">FullName</span>)
            {
                <b>foreach</b> (<b>var</b> <span id="r89 rd" class="r89 r">mem</span> <b>in</b> <span class="r88 r">members</span>)
                {
                    <b>if</b> (<span class="i">IsPSTypeName</span>(<span class="r89 r">mem</span>))
                    {
                        <span class="r87 r">typename</span> = <span class="r89 r">mem</span>.<span class="i">Value</span>.<span class="i">ToString</span>();
                    }
                }
            }
 
            <b>var</b> <span id="r90 rd" class="r90 r">builder</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r87 r">typename</span>, <span class="r88 r">members</span>.<span class="i">Count</span> * 7);
            <span class="r90 r">builder</span>.<span class="i">Append</span>(<span class="s">&#39;#&#39;</span>);
            <b>foreach</b> (<b>var</b> <span id="r91 rd" class="r91 r">m</span> <b>in</b> <span class="r88 r">members</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r92 rd" class="r92 r">m</span> =&gt; <span class="r92 r">m</span>.<span class="i">Name</span>))
            {
                <b>if</b> (!<span class="i">IsPSTypeName</span>(<span class="r91 r">m</span>))
                {
                    <span class="r90 r">builder</span>.<span class="i">Append</span>(<span class="r91 r">m</span>.<span class="i">Name</span>).<span class="i">Append</span>(<span class="s">&#39;:&#39;</span>);
                }
            }
 
            <span class="r90 r">builder</span>.<span class="i">Length</span>--;
            <b>return</b> <span class="r90 r">builder</span>.<span class="i">ToString</span>();
        }
 
        <b>public</b> <span class="i">IList</span>&lt;<a href="#85ce15321cd9211a" class="t t">PSMemberNameAndType</a>&gt; <a id="c75b7eae36ef308e" href="../R/c75b7eae36ef308e.html" target="n" data-glyph="102,1" class="i property">Members</a> { <b>get</b>; }
    }
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>internal interface</b> <a id="2ae2bf5bb21a5a53" href="../R/2ae2bf5bb21a5a53.html" target="n" data-glyph="50,0" class="t t">IScriptCommandInfo</a>
    {
        <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="753af6705016f48b" href="../R/753af6705016f48b.html" target="n" data-glyph="102,1" class="i property">ScriptBlock</a> { <b>get</b>; }
    }
}
</pre></td></tr></table></div></body></html>
