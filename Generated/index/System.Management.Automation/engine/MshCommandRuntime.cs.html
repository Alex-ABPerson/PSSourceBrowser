<!DOCTYPE html>
<html><head><title>MshCommandRuntime.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(3817);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/MshCommandRuntime.cs" target="_top">engine\MshCommandRuntime.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Monad internal implementation of the ICommandRuntime2 interface</span>
    <span class="c">///</span><span class="c"> used for execution in the monad engine environment.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> There will be one instance of this class for each cmdlet added to</span>
    <span class="c">///</span><span class="c"> a pipeline. When the cmdlet calls its WriteObject API, that API will call</span>
    <span class="c">///</span><span class="c"> the WriteObject implementation in this class which, in turn, calls</span>
    <span class="c">///</span><span class="c"> the downstream cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="f9ebe6a3b284ab55" href="../R/f9ebe6a3b284ab55.html" target="n" data-glyph="2,0" class="t t">MshCommandRuntime</a> : <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private_members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets/Set the execution context value for this runtime object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="ef96008a8ef9962a" href="../R/ef96008a8ef9962a.html" target="n" data-glyph="104,1" class="i property">Context</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <a id="a8013d10b683bea8" href="../R/a8013d10b683bea8.html" target="n" data-glyph="46,1" class="i field">_state</a> = <b>null</b>;
        <b>internal</b> <a href="hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a> <a id="bf2192101a5df610" href="../R/bf2192101a5df610.html" target="n" data-glyph="44,1" class="i field">CBhost</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The host object for this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <a id="f8d665e5222369a2" href="../R/f8d665e5222369a2.html" target="n" data-glyph="102,1" class="i property">Host</a> { <b>get</b>; }
 
        <span class="c">// Output pipes.</span>
        <b>private</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="7aa52386cb1f9dfc" href="../R/7aa52386cb1f9dfc.html" target="n" data-glyph="46,1" class="i field">_inputPipe</a>;
        <b>private</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="41f24992471f6094" href="../R/41f24992471f6094.html" target="n" data-glyph="46,1" class="i field">_outputPipe</a>;
        <b>private</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="2a6eccd74ca336be" href="../R/2a6eccd74ca336be.html" target="n" data-glyph="46,1" class="i field">_errorOutputPipe</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsClosed indicates to the Cmdlet whether its upstream partner</span>
        <span class="c">///</span><span class="c"> could still write more data to its incoming queue.</span>
        <span class="c">///</span><span class="c"> Note that there may still be data in the incoming queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1873a5e7c8d36fbc" href="../R/1873a5e7c8d36fbc.html" target="n" data-glyph="104,1" class="i property">IsClosed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if we&#39;re not closed and the input pipe is non-null...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="3d7740144c766c64" href="../R/3d7740144c766c64.html" target="n" data-glyph="104,1" class="i property">IsPipelineInputExpected</a>
        {
            <b>get</b>
            {
                <span class="c">// No objects in the input pipe</span>
                <span class="c">// The pipe is closed. So there can&#39;t be any more object</span>
                <b>if</b> (<a href="#1873a5e7c8d36fbc" class="i property">IsClosed</a> &amp;&amp; (<a href="#7aa52386cb1f9dfc" class="i field">_inputPipe</a> == <b>null</b> || <a href="#7aa52386cb1f9dfc" class="i field">_inputPipe</a>.<a href="Pipe.cs.html#5b6f412d40044f40" class="i property">Empty</a>))
                {
                    <b>return</b> <b>false</b>;
                }
 
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This allows all success output to be set to a variable.  Similar to the way -errorvariable sets</span>
        <span class="c">///</span><span class="c"> all errors to a variable name.  Semantically this is equivalent to :  cmd |set-var varname -passthru</span>
        <span class="c">///</span><span class="c"> but it should be MUCH faster as there is no binding that takes place.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> may not be set to null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="2122ad70cfdf9d78" href="../R/2122ad70cfdf9d78.html" target="n" data-glyph="104,1" class="i property">OutVariable</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">IList</span> <a id="f076b87e1b2bd739" href="../R/f076b87e1b2bd739.html" target="n" data-glyph="104,1" class="i property">OutVarList</a> { <b>get</b> { <b>return</b> <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>; } <b>set</b> { <a href="#68922a3d24ad21f4" class="i field">_outVarList</a> = <b>value</b>; } }
 
        <b>private</b> <span class="i">IList</span> <a id="68922a3d24ad21f4" href="../R/68922a3d24ad21f4.html" target="n" data-glyph="46,1" class="i field">_outVarList</a> = <b>null</b>;
 
        <b>internal</b> <a href="pipeline.cs.html#5e576bcabfa5c82b" class="t t">PipelineProcessor</a> <a id="895cb9f77d1d9539" href="../R/895cb9f77d1d9539.html" target="n" data-glyph="104,1" class="i property">PipelineProcessor</a> { <b>get</b>; <b>set</b>; }
 
        <b>private readonly</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <a id="b81c479750b2b617" href="../R/b81c479750b2b617.html" target="n" data-glyph="46,1" class="i field">_commandInfo</a>;
        <b>private readonly</b> <a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <a id="64fec126736a688e" href="../R/64fec126736a688e.html" target="n" data-glyph="46,1" class="i field">_thisCommand</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private_members
 
        <b>internal</b> <a id="135a26935c7af90a" href="../R/135a26935c7af90a.html" target="n" data-glyph="74,1" class="t constructor">MshCommandRuntime</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r0 rd" class="r0 r">context</span>, <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r1 rd" class="r1 r">commandInfo</span>, <a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <span id="r2 rd" class="r2 r">thisCommand</span>)
        {
            <a href="#ef96008a8ef9962a" class="i property">Context</a> = <span class="r0 r">context</span>;
            <a href="#f8d665e5222369a2" class="i property">Host</a> = <span class="r0 r">context</span>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bf2192101a5df610" class="i field">CBhost</a> = (<a href="hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a>)<span class="r0 r">context</span>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
            <a href="#b81c479750b2b617" class="i field">_commandInfo</a> = <span class="r1 r">commandInfo</span>;
            <a href="#64fec126736a688e" class="i field">_thisCommand</a> = <span class="r2 r">thisCommand</span>;
            <a href="#10aa6c1ae5d83a77" class="i property">LogPipelineExecutionDetail</a> = <a href="#f6ec094c0efefd97" class="i method">InitShouldLogPipelineExecutionDetail</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For diagnostic purposes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="91ccb92d91a9961e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>if</b> (<a href="#b81c479750b2b617" class="i field">_commandInfo</a> != <b>null</b>)
                <b>return</b> <a href="#b81c479750b2b617" class="i field">_commandInfo</a>.<a href="CommandInfo.cs.html#c3bac3ed48b7e00e" class="i method">ToString</a>();
            <b>return</b> <span class="s">&quot;&lt;NullCommandInfo&gt;&quot;</span>; <span class="c">// does not require localization</span>
        }
 
        <b>private</b> <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="89d93f115a105d6f" href="../R/89d93f115a105d6f.html" target="n" data-glyph="46,1" class="i field">_myInvocation</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the invocation data object for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The invocation object for this command.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="414274318fb6cbe1" href="../R/414274318fb6cbe1.html" target="n" data-glyph="104,1" class="i property">MyInvocation</a>
        {
            <b>get</b> { <b>return</b> <a href="#89d93f115a105d6f" class="i field">_myInvocation</a> ??= <a href="#64fec126736a688e" class="i field">_thisCommand</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal helper. Indicates whether stop has been requested on this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="26faf0098cf2f821" href="../R/26faf0098cf2f821.html" target="n" data-glyph="104,1" class="i property">IsStopping</a>
        {
            <b>get</b> { <b>return</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a> != <b>null</b> &amp;&amp; <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#23e1d0b242d467ac" class="i property">Stopping</a>); }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Write
 
        <span class="c">// Trust: WriteObject needs to respect EmitTrustCategory</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the object to the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that needs to be written.  This will be written as</span>
        <span class="c">///</span><span class="c"> a single object, even if it is an enumeration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteObject may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<span class="i">WriteObject</span>(<b>object</b>,<b>bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="d40b398fd675411c" href="../R/d40b398fd675411c.html" target="n" data-glyph="72,1" class="i method">WriteObject</a>(<b>object</b> <span id="r3 rd" class="r3 r">sendToPipeline</span>)
        {
            <span class="c">// This check will be repeated in _WriteObjectSkipAllowCheck,</span>
            <span class="c">// but we want PipelineStoppedException to take precedence</span>
            <span class="c">// over InvalidOperationException if the pipeline has been</span>
            <span class="c">// closed.</span>
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">CORECLR</span>
            <span class="c">// SecurityContext is not supported in CoreCLR</span>
            <a href="#06257d42ee7d97e0" class="i method">DoWriteObject</a>(<span class="r3 r">sendToPipeline</span>);
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">            if (UseSecurityContextRun)
            {
                if (PipelineProcessor == null || PipelineProcessor.SecurityContext == null)
                    throw PSTraceSource.NewInvalidOperationException(PipelineStrings.WriteNotPermitted);
                ContextCallback delegateCallback =
                    new ContextCallback(DoWriteObject);
 
                SecurityContext.Run(
                    PipelineProcessor.SecurityContext.CreateCopy(),
                    delegateCallback,
                    sendToPipeline);
            }
            else
            {
                DoWriteObject(sendToPipeline);
            }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="06257d42ee7d97e0" href="../R/06257d42ee7d97e0.html" target="n" data-glyph="76,1" class="i method">DoWriteObject</a>(<b>object</b> <span id="r4 rd" class="r4 r">sendToPipeline</span>)
        {
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>true</b>);
            <a href="#393b6749b38e4c96" class="i method">_WriteObjectSkipAllowCheck</a>(<span class="r4 r">sendToPipeline</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes one or more objects to the output pipe.</span>
        <span class="c">///</span><span class="c"> If the object is a collection and the enumerateCollection flag</span>
        <span class="c">///</span><span class="c"> is true, the objects in the collection</span>
        <span class="c">///</span><span class="c"> will be written individually.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that needs to be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">enumerateCollection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the collection should be enumerated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteObject may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<span class="i">WriteObject</span>(<b>object</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="5930a3e40208eaf6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WriteObject</a>(<b>object</b> <span id="r5 rd" class="r5 r">sendToPipeline</span>, <b>bool</b> <span id="r6 rd" class="r6 r">enumerateCollection</span>)
        {
            <b>if</b> (!<span class="r6 r">enumerateCollection</span>)
            {
                <a href="#d40b398fd675411c" class="i method">WriteObject</a>(<span class="r5 r">sendToPipeline</span>);
                <b>return</b>;
            }
 
            <span class="c">// This check will be repeated in _WriteObjectsSkipAllowCheck,</span>
            <span class="c">// but we want PipelineStoppedException to take precedence</span>
            <span class="c">// over InvalidOperationException if the pipeline has been</span>
            <span class="c">// closed.</span>
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">CORECLR</span>
            <span class="c">// SecurityContext is not supported in CoreCLR</span>
            <a href="#1201572dc9ba63e2" class="i method">DoWriteEnumeratedObject</a>(<span class="r5 r">sendToPipeline</span>);
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">            if (UseSecurityContextRun)
            {
                if (PipelineProcessor == null || PipelineProcessor.SecurityContext == null)
                    throw PSTraceSource.NewInvalidOperationException(PipelineStrings.WriteNotPermitted);
                ContextCallback delegateCallback =
                    new ContextCallback(DoWriteObjects);
                SecurityContext.Run(
                    PipelineProcessor.SecurityContext.CreateCopy(),
                    delegateCallback,
                    sendToPipeline);
            }
            else
            {
                DoWriteObjects(sendToPipeline);
            }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an object enumerated from a collection to the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerated object that needs to be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1201572dc9ba63e2" href="../R/1201572dc9ba63e2.html" target="n" data-glyph="76,1" class="i method">DoWriteEnumeratedObject</a>(<b>object</b> <span id="r7 rd" class="r7 r">sendToPipeline</span>)
        {
            <span class="c">// NOTICE-2004/06/08-JonN 959638</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>true</b>);
            <a href="#bd3a45a06ef86fc3" class="i method">_EnumerateAndWriteObjectSkipAllowCheck</a>(<span class="r7 r">sendToPipeline</span>);
        }
        <span class="c">// Trust:  public void WriteObject(object sendToPipeline, DataTrustCategory trustCategory);     // enumerateCollection defaults to false</span>
        <span class="c">// Trust:  public void WriteObject(object sendToPipeline, bool enumerateCollection, DataTrustCategory trustCategory);</span>
 
        <span class="c">// Variables needed to generate a unique SourceId for</span>
        <span class="c">// WriteProgress(ProgressRecord).</span>
        <b>private static</b> <span class="i">Int64</span> <a id="686767fa87ba4918" href="../R/686767fa87ba4918.html" target="n" data-glyph="46,1" class="i field">s_lastUsedSourceId</a> <span class="c">/* = 0 */</span>;
        <b>private</b> <span class="i">Int64</span> <a id="d8d3a0919bb0dd76" href="../R/d8d3a0919bb0dd76.html" target="n" data-glyph="46,1" class="i field">_sourceId</a> <span class="c">/* = 0 */</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display progress information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">progressRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Progress information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteProgress may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteProgress to display progress information about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet, when the operation of your Cmdlet</span>
        <span class="c">///</span><span class="c"> could potentially take a long time.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> By default, progress output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> ProgressPreference shell variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="db4330254366f22c" href="../R/db4330254366f22c.html" target="n" data-glyph="72,1" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r8 rd" class="r8 r">progressRecord</span>)
        {
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2e7944dc8af7df10" class="i method">WriteProgress</a>(<span class="r8 r">progressRecord</span>, <b>false</b>);
        }
 
        <b>internal void</b> <a id="2e7944dc8af7df10" href="../R/2e7944dc8af7df10.html" target="n" data-glyph="74,1" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r9 rd" class="r9 r">progressRecord</span>, <b>bool</b> <span id="r10 rd" class="r10 r">overrideInquire</span>)
        {
            <span class="c">// NTRAID#Windows Out Of Band Releases-918023-2005/08/22-JonN</span>
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <span class="c">//</span>
            <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
            <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
            <span class="c">// functions can be called.</span>
            <span class="c">//</span>
            <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
            <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
            <span class="c">// enforce the check again.</span>
            <span class="c">//</span>
            <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
            <span class="c">//</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
            <span class="c">// Bug909439: We need a unique sourceId to send to</span>
            <span class="c">// WriteProgress. The following logic ensures that</span>
            <span class="c">// there is a unique id for each Cmdlet instance.</span>
 
            <b>if</b> (<a href="#d8d3a0919bb0dd76" class="i field">_sourceId</a> == 0)
            {
                <a href="#d8d3a0919bb0dd76" class="i field">_sourceId</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#686767fa87ba4918" class="i field">s_lastUsedSourceId</a>);
            }
 
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#c4196923a568fda6" class="i method">WriteProgress</a>(<a href="#d8d3a0919bb0dd76" class="i field">_sourceId</a>, <span class="r9 r">progressRecord</span>, <span class="r10 r">overrideInquire</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Displays progress output if enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">sourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Identifies which command is reporting progress</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">progressRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Progress status to be displayed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0bfb0f7234330eab" href="../R/0bfb0f7234330eab.html" target="n" data-glyph="72,1" class="i method">WriteProgress</a>(
            <span class="i">Int64</span> <span id="r11 rd" class="r11 r">sourceId</span>,
            <a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r12 rd" class="r12 r">progressRecord</span>)
        {
            <a href="#c4196923a568fda6" class="i method">WriteProgress</a>(<span class="r11 r">sourceId</span>, <span class="r12 r">progressRecord</span>, <b>false</b>);
        }
 
        <b>internal void</b> <a id="c4196923a568fda6" href="../R/c4196923a568fda6.html" target="n" data-glyph="74,1" class="i method">WriteProgress</a>(
                <span class="i">Int64</span> <span id="r13 rd" class="r13 r">sourceId</span>,
                <a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r14 rd" class="r14 r">progressRecord</span>,
                <b>bool</b> <span id="r15 rd" class="r15 r">overrideInquire</span>)
        {
            <b>if</b> (<span class="r14 r">progressRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r14 r">progressRecord</span>));
            }
 
            <b>if</b> (<a href="#f8d665e5222369a2" class="i property">Host</a> == <b>null</b> || <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;No host in CommandBase.WriteProgress()&quot;</span>);
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
            }
 
            <a href="../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a> <span id="r16 rd" class="r16 r">ui</span> = <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> <b>as</b> <a href="../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a>;
 
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r17 rd" class="r17 r">preference</span> = <a href="#42fe333a1829d07d" class="i property">ProgressPreference</a>;
            <b>if</b> (<span class="r15 r">overrideInquire</span> &amp;&amp; <span class="r17 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
            {
                <span class="r17 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
            }
 
            <b>if</b> (<a href="#072937fb54bc15d3" class="i method">WriteHelper_ShouldWrite</a>(
                <span class="r17 r">preference</span>, <a href="#072ae6465bf926af" class="i field">lastProgressContinueStatus</a>))
            {
                <span class="c">// Break into the debugger if requested</span>
                <b>if</b> (<span class="r17 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
                {
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r14 r">progressRecord</span>);
                }
 
                <span class="r16 r">ui</span>.<a href="hostifaces/InternalHostUserInterface.cs.html#5b39fea1a6120e2e" class="i method">WriteProgress</a>(<span class="r13 r">sourceId</span>, <span class="r14 r">progressRecord</span>);
            }
 
            <a href="#072ae6465bf926af" class="i field">lastProgressContinueStatus</a> = <a href="#38b87e47237800fb" class="i method">WriteHelper</a>(
                <b>null</b>,
                <b>null</b>,
                <span class="r17 r">preference</span>,
                <a href="#072ae6465bf926af" class="i field">lastProgressContinueStatus</a>,
                <span class="s">&quot;ProgressPreference&quot;</span>,
                <span class="r14 r">progressRecord</span>.<a href="ProgressRecord.cs.html#4b85501b44d8e997" class="i property">Activity</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display debug information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debug output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteDebug may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteDebug to display debug information on the inner workings</span>
        <span class="c">///</span><span class="c"> of your Cmdlet.  By default, debug output will</span>
        <span class="c">///</span><span class="c"> not be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> DebugPreference shell variable or the -Debug command-line option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="0f260a88aab98713" href="../R/0f260a88aab98713.html" target="n" data-glyph="72,1" class="i method">WriteDebug</a>(<b>string</b> <span id="r18 rd" class="r18 r">text</span>)
        {
            <a href="#c8f51b28a47480d7" class="i method">WriteDebug</a>(<b>new</b> <a href="hostifaces/InformationalRecord.cs.html#e4b0e2a3d91478e0" class="t constructor">DebugRecord</a>(<span class="r18 r">text</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display debug information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c8f51b28a47480d7" href="../R/c8f51b28a47480d7.html" target="n" data-glyph="74,1" class="i method">WriteDebug</a>(<a href="hostifaces/InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a> <span id="r19 rd" class="r19 r">record</span>, <b>bool</b> <span id="r20 rd" class="r20 r">overrideInquire</span> = <b>false</b>)
        {
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r21 rd" class="r21 r">preference</span> = <a href="#cc68451ddea82b1e" class="i property">DebugPreference</a>;
            <b>if</b> (<span class="r20 r">overrideInquire</span> &amp;&amp; <span class="r21 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
                <span class="r21 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <b>if</b> (<a href="#072937fb54bc15d3" class="i method">WriteHelper_ShouldWrite</a>(<span class="r21 r">preference</span>, <a href="#40accafc01e37ecb" class="i field">lastDebugContinueStatus</a>))
            {
                <b>if</b> (<span class="r19 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#73cb41dec061d403" class="i property">InvocationInfo</a> == <b>null</b>)
                {
                    <span class="r19 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#c41e073b367389b4" class="i method">SetInvocationInfo</a>(<a href="#414274318fb6cbe1" class="i property">MyInvocation</a>);
                }
 
                <span class="c">// Break into the debugger if requested</span>
                <b>if</b> (<span class="r21 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
                {
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r19 r">record</span>);
                }
 
                <b>if</b> (<a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#bf2192101a5df610" class="i field">CBhost</a> != <b>null</b> &amp;&amp; <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a> != <b>null</b> &amp;&amp;
                        <a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a>.<a href="Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a>)
                    {
                        <span class="c">// If redirecting to a null pipe, still write to</span>
                        <span class="c">// information buffers.</span>
                        <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#ad07f174321fda9f" class="i method">WriteDebugInfoBuffers</a>(<span class="r19 r">record</span>);
                    }
 
                    <span class="c">// Set WriteStream so that the debug output is formatted correctly.</span>
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r22 rd" class="r22 r">debugWrap</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r19 r">record</span>);
                    <span class="r22 r">debugWrap</span>.<a href="MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a>.<a href="MshObject.cs.html#9b1a014e3b7e9eb3" class="i field">Debug</a>;
 
                    <a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a>.<a href="Pipe.cs.html#f66ebe5942cdceab" class="i method">Add</a>(<span class="r22 r">debugWrap</span>);
                }
                <b>else</b>
                {
                    <span class="c">//</span>
                    <span class="c">// If no pipe, write directly to host.</span>
                    <span class="c">//</span>
                    <b>if</b> (<a href="#f8d665e5222369a2" class="i property">Host</a> == <b>null</b> || <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;No host in CommandBase.WriteDebug()&quot;</span>);
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                    }
 
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">DebugFormatString</span>, <span class="r19 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>));
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#f51c3a2ee76a41c5" class="i method">WriteDebugRecord</a>(<span class="r19 r">record</span>);
                }
            }
 
            <a href="#40accafc01e37ecb" class="i field">lastDebugContinueStatus</a> = <a href="#38b87e47237800fb" class="i method">WriteHelper</a>(
                <b>null</b>,
                <b>null</b>,
                <span class="r21 r">preference</span>,
                <a href="#40accafc01e37ecb" class="i field">lastDebugContinueStatus</a>,
                <span class="s">&quot;DebugPreference&quot;</span>,
                <span class="r19 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display verbose information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Verbose output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteVerbose may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteVerbose to display more detailed information about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet.  By default, verbose output will</span>
        <span class="c">///</span><span class="c"> not be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> VerbosePreference shell variable</span>
        <span class="c">///</span><span class="c"> or the -Verbose and -Debug command-line options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="3646a311080648d6" href="../R/3646a311080648d6.html" target="n" data-glyph="72,1" class="i method">WriteVerbose</a>(<b>string</b> <span id="r23 rd" class="r23 r">text</span>)
        {
            <a href="#f0f5e7bb99e18bae" class="i method">WriteVerbose</a>(<b>new</b> <a href="hostifaces/InformationalRecord.cs.html#edcf8ae61b2e64b0" class="t constructor">VerboseRecord</a>(<span class="r23 r">text</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display verbose information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f0f5e7bb99e18bae" href="../R/f0f5e7bb99e18bae.html" target="n" data-glyph="74,1" class="i method">WriteVerbose</a>(<a href="hostifaces/InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a> <span id="r24 rd" class="r24 r">record</span>, <b>bool</b> <span id="r25 rd" class="r25 r">overrideInquire</span> = <b>false</b>)
        {
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r26 rd" class="r26 r">preference</span> = <a href="#04803c68d94269cc" class="i property">VerbosePreference</a>;
            <b>if</b> (<span class="r25 r">overrideInquire</span> &amp;&amp; <span class="r26 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
                <span class="r26 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <b>if</b> (<a href="#072937fb54bc15d3" class="i method">WriteHelper_ShouldWrite</a>(<span class="r26 r">preference</span>, <a href="#103713ef229b5154" class="i field">lastVerboseContinueStatus</a>))
            {
                <b>if</b> (<span class="r24 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#73cb41dec061d403" class="i property">InvocationInfo</a> == <b>null</b>)
                {
                    <span class="r24 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#c41e073b367389b4" class="i method">SetInvocationInfo</a>(<a href="#414274318fb6cbe1" class="i property">MyInvocation</a>);
                }
 
                <span class="c">// Break into the debugger if requested</span>
                <b>if</b> (<span class="r26 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
                {
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r24 r">record</span>);
                }
 
                <b>if</b> (<a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#bf2192101a5df610" class="i field">CBhost</a> != <b>null</b> &amp;&amp; <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a> != <b>null</b> &amp;&amp;
                        <a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a>.<a href="Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a>)
                    {
                        <span class="c">// If redirecting to a null pipe, still write to</span>
                        <span class="c">// information buffers.</span>
                        <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#a206d5b058fadaf4" class="i method">WriteVerboseInfoBuffers</a>(<span class="r24 r">record</span>);
                    }
 
                    <span class="c">// Add WriteStream so that the verbose output is formatted correctly.</span>
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r27 rd" class="r27 r">verboseWrap</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r24 r">record</span>);
                    <span class="r27 r">verboseWrap</span>.<a href="MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a>.<a href="MshObject.cs.html#74af4733316f3145" class="i field">Verbose</a>;
 
                    <a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a>.<a href="Pipe.cs.html#f66ebe5942cdceab" class="i method">Add</a>(<span class="r27 r">verboseWrap</span>);
                }
                <b>else</b>
                {
                    <span class="c">//</span>
                    <span class="c">// If no pipe, write directly to host.</span>
                    <span class="c">//</span>
                    <b>if</b> (<a href="#f8d665e5222369a2" class="i property">Host</a> == <b>null</b> || <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;No host in CommandBase.WriteVerbose()&quot;</span>);
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                    }
 
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">VerboseFormatString</span>, <span class="r24 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>));
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#a6f4a2302262376d" class="i method">WriteVerboseRecord</a>(<span class="r24 r">record</span>);
                }
            }
 
            <a href="#103713ef229b5154" class="i field">lastVerboseContinueStatus</a> = <a href="#38b87e47237800fb" class="i method">WriteHelper</a>(
                <b>null</b>,
                <b>null</b>,
                <span class="r26 r">preference</span>,
                <a href="#103713ef229b5154" class="i field">lastVerboseContinueStatus</a>,
                <span class="s">&quot;VerbosePreference&quot;</span>,
                <span class="r24 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display warning information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Warning output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteWarning may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteWarning to display warnings about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet.  By default, warning output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> WarningPreference shell variable</span>
        <span class="c">///</span><span class="c"> or the -Verbose and -Debug command-line options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="887abd71350c6e4e" href="../R/887abd71350c6e4e.html" target="n" data-glyph="72,1" class="i method">WriteWarning</a>(<b>string</b> <span id="r28 rd" class="r28 r">text</span>)
        {
            <a href="#9cc8b7d137e9323d" class="i method">WriteWarning</a>(<b>new</b> <a href="hostifaces/InformationalRecord.cs.html#cd27eb702abe7363" class="t constructor">WarningRecord</a>(<span class="r28 r">text</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display warning information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9cc8b7d137e9323d" href="../R/9cc8b7d137e9323d.html" target="n" data-glyph="74,1" class="i method">WriteWarning</a>(<a href="hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a> <span id="r29 rd" class="r29 r">record</span>, <b>bool</b> <span id="r30 rd" class="r30 r">overrideInquire</span> = <b>false</b>)
        {
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r31 rd" class="r31 r">preference</span> = <a href="#b12b6c5f70c4f2b1" class="i property">WarningPreference</a>;
            <b>if</b> (<span class="r30 r">overrideInquire</span> &amp;&amp; <span class="r31 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
                <span class="r31 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <b>if</b> (<a href="#072937fb54bc15d3" class="i method">WriteHelper_ShouldWrite</a>(<span class="r31 r">preference</span>, <a href="#691efe22866c7a2a" class="i field">lastWarningContinueStatus</a>))
            {
                <b>if</b> (<span class="r29 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#73cb41dec061d403" class="i property">InvocationInfo</a> == <b>null</b>)
                {
                    <span class="r29 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#c41e073b367389b4" class="i method">SetInvocationInfo</a>(<a href="#414274318fb6cbe1" class="i property">MyInvocation</a>);
                }
 
                <span class="c">// Break into the debugger if requested</span>
                <b>if</b> (<span class="r31 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
                {
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r29 r">record</span>);
                }
 
                <b>if</b> (<a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#bf2192101a5df610" class="i field">CBhost</a> != <b>null</b> &amp;&amp; <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a> != <b>null</b> &amp;&amp;
                        <a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a>.<a href="Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a>)
                    {
                        <span class="c">// If redirecting to a null pipe, still write to</span>
                        <span class="c">// information buffers.</span>
                        <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#c29b4334d7deeed9" class="i method">WriteWarningInfoBuffers</a>(<span class="r29 r">record</span>);
                    }
 
                    <span class="c">// Add WriteStream so that the warning output is formatted correctly.</span>
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r32 rd" class="r32 r">warningWrap</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r29 r">record</span>);
                    <span class="r32 r">warningWrap</span>.<a href="MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a>.<a href="MshObject.cs.html#6c92852b80d52e75" class="i field">Warning</a>;
 
                    <a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a>.<a href="Pipe.cs.html#d32c1d6bc732e4c3" class="i method">AddWithoutAppendingOutVarList</a>(<span class="r32 r">warningWrap</span>);
                }
                <b>else</b>
                {
                    <span class="c">//</span>
                    <span class="c">// If no pipe, write directly to host.</span>
                    <span class="c">//</span>
                    <b>if</b> (<a href="#f8d665e5222369a2" class="i property">Host</a> == <b>null</b> || <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;No host in CommandBase.WriteWarning()&quot;</span>);
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                    }
 
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">WarningFormatString</span>, <span class="r29 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>));
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#a0c37e8622064bb4" class="i method">WriteWarningRecord</a>(<span class="r29 r">record</span>);
                }
            }
 
            <a href="#de3ae6bdea260603" class="i method">AppendWarningVarList</a>(<span class="r29 r">record</span>);
 
            <a href="#691efe22866c7a2a" class="i field">lastWarningContinueStatus</a> = <a href="#38b87e47237800fb" class="i method">WriteHelper</a>(
                <b>null</b>,
                <b>null</b>,
                <span class="r31 r">preference</span>,
                <a href="#691efe22866c7a2a" class="i field">lastWarningContinueStatus</a>,
                <span class="s">&quot;WarningPreference&quot;</span>,
                <span class="r29 r">record</span>.<a href="hostifaces/InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display tagged object information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="896a3a80d32868f8" href="../R/896a3a80d32868f8.html" target="n" data-glyph="72,1" class="i method">WriteInformation</a>(<a href="InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r33 rd" class="r33 r">informationRecord</span>)
        {
            <a href="#3dd6dedf42396504" class="i method">WriteInformation</a>(<span class="r33 r">informationRecord</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display tagged object information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3dd6dedf42396504" href="../R/3dd6dedf42396504.html" target="n" data-glyph="74,1" class="i method">WriteInformation</a>(<a href="InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r34 rd" class="r34 r">record</span>, <b>bool</b> <span id="r35 rd" class="r35 r">overrideInquire</span> = <b>false</b>)
        {
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r36 rd" class="r36 r">preference</span> = <a href="#8157d9c42d054f98" class="i property">InformationPreference</a>;
            <b>if</b> (<span class="r35 r">overrideInquire</span> &amp;&amp; <span class="r36 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
                <span class="r36 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <span class="c">// Break into the debugger if requested</span>
            <b>if</b> (<span class="r36 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
            {
                <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r34 r">record</span>);
            }
 
            <b>if</b> (<span class="r36 r">preference</span> != <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e7eef70977370b56" class="i field">Ignore</a>)
            {
                <b>if</b> (<a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#bf2192101a5df610" class="i field">CBhost</a> != <b>null</b> &amp;&amp; <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a> != <b>null</b> &amp;&amp;
                        <a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a>.<a href="Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a>)
                    {
                        <span class="c">// If redirecting to a null pipe, still write to</span>
                        <span class="c">// information buffers.</span>
                        <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#ffabc94b49ba6929" class="i method">WriteInformationInfoBuffers</a>(<span class="r34 r">record</span>);
                    }
 
                    <span class="c">// Add WriteStream so that the information output is formatted correctly.</span>
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r37 rd" class="r37 r">informationWrap</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r34 r">record</span>);
                    <span class="r37 r">informationWrap</span>.<a href="MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a>.<a href="MshObject.cs.html#be5bddae0acf5fcc" class="i field">Information</a>;
 
                    <a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a>.<a href="Pipe.cs.html#f66ebe5942cdceab" class="i method">Add</a>(<span class="r37 r">informationWrap</span>);
                }
                <b>else</b>
                {
                    <span class="c">//</span>
                    <span class="c">// If no pipe, write directly to host.</span>
                    <span class="c">//</span>
                    <b>if</b> (<a href="#f8d665e5222369a2" class="i property">Host</a> == <b>null</b> || <a href="#f8d665e5222369a2" class="i property">Host</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
                    {
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#eafc61f0708da78f" class="i method">NewInvalidOperationException</a>(<span class="s">&quot;No host in CommandBase.WriteInformation()&quot;</span>);
                    }
 
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#29a310c654a05b3c" class="i method">WriteInformationRecord</a>(<span class="r34 r">record</span>);
 
                    <b>if</b> ((<span class="r34 r">record</span>.<a href="InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">Contains</span>(<span class="s">&quot;PSHOST&quot;</span>) &amp;&amp; (!<span class="r34 r">record</span>.<a href="InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">Contains</span>(<span class="s">&quot;FORWARDED&quot;</span>)))
                        || (<span class="r36 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>))
                    {
                        <a href="InformationRecord.cs.html#89e69001707e0222" class="t t">HostInformationMessage</a> <span id="r38 rd" class="r38 r">hostOutput</span> = <span class="r34 r">record</span>.<a href="InformationRecord.cs.html#9fb462ecb6288032" class="i property">MessageData</a> <b>as</b> <a href="InformationRecord.cs.html#89e69001707e0222" class="t t">HostInformationMessage</a>;
                        <b>if</b> (<span class="r38 r">hostOutput</span> != <b>null</b>)
                        {
                            <b>string</b> <span id="r39 rd" class="r39 r">message</span> = <span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#515d88994bcfdd53" class="i property">Message</a>;
                            <span class="i">ConsoleColor</span>? <span id="r40 rd" class="r40 r">foregroundColor</span> = <b>null</b>;
                            <span class="i">ConsoleColor</span>? <span id="r41 rd" class="r41 r">backgroundColor</span> = <b>null</b>;
                            <b>bool</b> <span id="r42 rd" class="r42 r">noNewLine</span> = <b>false</b>;
 
                            <b>if</b> (<span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#36d6f079037a63b4" class="i property">ForegroundColor</a>.<span class="i">HasValue</span>)
                            {
                                <span class="r40 r">foregroundColor</span> = <span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#36d6f079037a63b4" class="i property">ForegroundColor</a>.<span class="i">Value</span>;
                            }
 
                            <b>if</b> (<span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#1c41b9e14fba3599" class="i property">BackgroundColor</a>.<span class="i">HasValue</span>)
                            {
                                <span class="r41 r">backgroundColor</span> = <span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#1c41b9e14fba3599" class="i property">BackgroundColor</a>.<span class="i">Value</span>;
                            }
 
                            <b>if</b> (<span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#cbcaaae6d3de38dd" class="i property">NoNewLine</a>.<span class="i">HasValue</span>)
                            {
                                <span class="r42 r">noNewLine</span> = <span class="r38 r">hostOutput</span>.<a href="InformationRecord.cs.html#cbcaaae6d3de38dd" class="i property">NoNewLine</a>.<span class="i">Value</span>;
                            }
 
                            <b>if</b> (<span class="r40 r">foregroundColor</span>.<span class="i">HasValue</span> || <span class="r41 r">backgroundColor</span>.<span class="i">HasValue</span>)
                            {
                                <span class="c">// It is possible for either one or the other to be empty if run from a</span>
                                <span class="c">// non-interactive host, but only one was specified in Write-Host.</span>
                                <span class="c">// So fill them with defaults if they are empty.</span>
                                <b>if</b> (!<span class="r40 r">foregroundColor</span>.<span class="i">HasValue</span>)
                                {
                                    <span class="r40 r">foregroundColor</span> = <span class="i">ConsoleColor</span>.<span class="i">Gray</span>;
                                }
 
                                <b>if</b> (!<span class="r41 r">backgroundColor</span>.<span class="i">HasValue</span>)
                                {
                                    <span class="r41 r">backgroundColor</span> = <span class="i">ConsoleColor</span>.<span class="i">Black</span>;
                                }
 
                                <b>if</b> (<span class="r42 r">noNewLine</span>)
                                {
                                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<span class="i">Write</span>(<span class="r40 r">foregroundColor</span>.<span class="i">Value</span>, <span class="r41 r">backgroundColor</span>.<span class="i">Value</span>, <span class="r39 r">message</span>);
                                }
                                <b>else</b>
                                {
                                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<span class="i">WriteLine</span>(<span class="r40 r">foregroundColor</span>.<span class="i">Value</span>, <span class="r41 r">backgroundColor</span>.<span class="i">Value</span>, <span class="r39 r">message</span>);
                                }
                            }
                            <b>else</b>
                            {
                                <b>if</b> (<span class="r42 r">noNewLine</span>)
                                {
                                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#0e5216d5c450e17c" class="i method">Write</a>(<span class="r39 r">message</span>);
                                }
                                <b>else</b>
                                {
                                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#bc9060913eba3689" class="i method">WriteLine</a>(<span class="r39 r">message</span>);
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/InternalHostUserInterface.cs.html#bc9060913eba3689" class="i method">WriteLine</a>(<span class="r34 r">record</span>.<a href="InformationRecord.cs.html#1d68691bc31a81bd" class="i method">ToString</a>());
                        }
                    }
                }
 
                <span class="c">// Both informational and PSHost-targeted messages are transcribed here.</span>
                <span class="c">// The only difference between these two is that PSHost-targeted messages are transcribed</span>
                <span class="c">// even if InformationAction is SilentlyContinue.</span>
                <b>if</b> (<span class="r34 r">record</span>.<a href="InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">Contains</span>(<span class="s">&quot;PSHOST&quot;</span>) || (<span class="r36 r">preference</span> != <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>))
                {
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<span class="r34 r">record</span>.<a href="InformationRecord.cs.html#1d68691bc31a81bd" class="i method">ToString</a>());
                }
            }
 
            <a href="#a82ea53628bf9b17" class="i method">AppendInformationVarList</a>(<span class="r34 r">record</span>);
 
            <a href="#0fe7bf920638e49e" class="i field">lastInformationContinueStatus</a> = <a href="#38b87e47237800fb" class="i method">WriteHelper</a>(
                <b>null</b>,
                <b>null</b>,
                <span class="r36 r">preference</span>,
                <a href="#0fe7bf920638e49e" class="i field">lastInformationContinueStatus</a>,
                <span class="s">&quot;InformationPreference&quot;</span>,
                <span class="r34 r">record</span>.<a href="InformationRecord.cs.html#1d68691bc31a81bd" class="i method">ToString</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write text into pipeline execution log.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Text to be written to log.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteCommandDetail to write important information about cmdlet execution to</span>
        <span class="c">///</span><span class="c"> pipeline execution log.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If LogPipelineExecutionDetail is turned on, this information will be written</span>
        <span class="c">///</span><span class="c"> to monad log under log category &quot;Pipeline execution detail&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#b2028ee3964807dc" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#31d60f57070e2a28" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#baaf77bfae870779" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="97533a87832a6892" href="../R/97533a87832a6892.html" target="n" data-glyph="72,1" class="i method">WriteCommandDetail</a>(<b>string</b> <span id="r43 rd" class="r43 r">text</span>)
        {
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#16d79ceba031a811" class="i method">LogExecutionInfo</a>(<a href="#64fec126736a688e" class="i field">_thisCommand</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>, <span class="r43 r">text</span>);
        }
 
        <b>internal bool</b> <a id="10aa6c1ae5d83a77" href="../R/10aa6c1ae5d83a77.html" target="n" data-glyph="104,1" class="i property">LogPipelineExecutionDetail</a> { <b>get</b>; } = <b>false</b>;
 
        <b>private bool</b> <a id="f6ec094c0efefd97" href="../R/f6ec094c0efefd97.html" target="n" data-glyph="76,1" class="i method">InitShouldLogPipelineExecutionDetail</a>()
        {
            <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r44 rd" class="r44 r">cmdletInfo</span> = <a href="#b81c479750b2b617" class="i field">_commandInfo</a> <b>as</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
 
            <b>if</b> (<span class="r44 r">cmdletInfo</span> != <b>null</b>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;Add-Type&quot;</span>, <span class="r44 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>if</b> (<span class="r44 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> == <b>null</b> &amp;&amp; <span class="r44 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a> != <b>null</b>)
                {
                    <b>return</b> <span class="r44 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#75aa8a396932903e" class="i property">LogPipelineExecutionDetails</a>;
                }
 
                <b>if</b> (<span class="r44 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a> == <b>null</b> &amp;&amp; <span class="r44 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
                {
                    <b>return</b> <span class="r44 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#6fe1eefd0a6636c9" class="i property">LogPipelineExecutionDetails</a>;
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Logging should be enabled for functions from modules also</span>
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r45 rd" class="r45 r">functionInfo</span> = <a href="#b81c479750b2b617" class="i field">_commandInfo</a> <b>as</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>;
            <b>if</b> (<span class="r45 r">functionInfo</span> != <b>null</b> &amp;&amp; <span class="r45 r">functionInfo</span>.<a href="CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
            {
                <b>return</b> <span class="r45 r">functionInfo</span>.<a href="CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="Modules/PSModuleInfo.cs.html#6fe1eefd0a6636c9" class="i property">LogPipelineExecutionDetails</a>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This allows all success output to be set to a variable, where the variable is reset for each item returned by</span>
        <span class="c">///</span><span class="c"> the cmdlet. Semantically this is equivalent to :  cmd | % { $pipelineVariable = $_; (...) }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="e605459f91bb88dd" href="../R/e605459f91bb88dd.html" target="n" data-glyph="104,1" class="i property">PipelineVariable</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="ec6a1fd82fe72d53" href="../R/ec6a1fd82fe72d53.html" target="n" data-glyph="46,1" class="i field">_pipelineVarReference</a> = <b>null</b>;
 
        <b>internal void</b> <a id="4d16a8f14424404b" href="../R/4d16a8f14424404b.html" target="n" data-glyph="74,1" class="i method">SetupOutVariable</a>()
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>))
            {
                <b>return</b>;
            }
 
            <a href="#18078011300dd272" class="i method">EnsureVariableParameterAllowed</a>();
 
            <span class="c">// Handle the creation of OutVariable in the case of Out-Default specially,</span>
            <span class="c">// as it needs to handle much of its OutVariable support itself.</span>
            <b>if</b> (
                (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>)) &amp;&amp;
                (!(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>.<span class="i">StartsWith</span>(<span class="s">&#39;+&#39;</span>))) &amp;&amp;
                <b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;Out-Default&quot;</span>, <a href="#64fec126736a688e" class="i field">_thisCommand</a>.<a href="CommandBase.cs.html#1f4a1f38862b466a" class="i property">CommandInfo</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<a href="#a8013d10b683bea8" class="i field">_state</a> == <b>null</b>)
                    <a href="#a8013d10b683bea8" class="i field">_state</a> = <b>new</b> <a href="SessionStatePublic.cs.html#45f5fbc7afc57ae4" class="t constructor">SessionState</a>(<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
 
                <span class="i">IList</span> <span id="r46 rd" class="r46 r">oldValue</span> = <b>null</b>;
                <span class="r46 r">oldValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#20b9dd22f81d2a1c" class="i method">GetValue</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>)) <b>as</b> <span class="i">IList</span>;
 
                <a href="#68922a3d24ad21f4" class="i field">_outVarList</a> = <span class="r46 r">oldValue</span> ?? <b>new</b> <span class="i">ArrayList</span>();
 
                <b>if</b> (<a href="#64fec126736a688e" class="i field">_thisCommand</a> <b>is not</b> <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>)
                {
                    <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#f6095cccebfe81e2" class="i field">Output</a>, <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>);
                }
 
                <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<span class="i">Set</span>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>, <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>);
            }
            <b>else</b>
            {
                <a href="#af4d48ce703cfd06" class="i method">SetupVariable</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#f6095cccebfe81e2" class="i field">Output</a>, <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#2122ad70cfdf9d78" class="i property">OutVariable</a>, <b>ref</b> <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>);
            }
        }
 
        <b>internal void</b> <a id="61cb518ce061dd63" href="../R/61cb518ce061dd63.html" target="n" data-glyph="74,1" class="i method">SetupPipelineVariable</a>()
        {
            <span class="c">// This can&#39;t use the common SetupVariable implementation, as this needs to persist for an entire</span>
            <span class="c">// pipeline.</span>
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a>))
            {
                <b>return</b>;
            }
 
            <a href="#18078011300dd272" class="i method">EnsureVariableParameterAllowed</a>();
 
            <b>if</b> (<a href="#a8013d10b683bea8" class="i field">_state</a> == <b>null</b>)
                <a href="#a8013d10b683bea8" class="i field">_state</a> = <b>new</b> <a href="SessionStatePublic.cs.html#45f5fbc7afc57ae4" class="t constructor">SessionState</a>(<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
 
            <span class="c">// Create the pipeline variable</span>
            <a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a> = <b>new</b> <a href="ShellVariable.cs.html#1fae7fd6b1f56e5f" class="t constructor">PSVariable</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a>);
            <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#15bb5031ffe10516" class="i method">Set</a>(<a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a>);
 
            <span class="c">// Get the reference again in case we re-used one from the</span>
            <span class="c">// same scope.</span>
            <a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a> = <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f4f82fae9d4a7f1f" class="i method">Get</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a>);
 
            <b>if</b> (<a href="#64fec126736a688e" class="i field">_thisCommand</a> <b>is not</b> <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a70f5d4297604021" class="i method">SetPipelineVariable</a>(<a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Configures the number of objects to buffer before calling the downstream Cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="a9134b58e3b713f3" href="../R/a9134b58e3b713f3.html" target="n" data-glyph="104,1" class="i property">OutBuffer</a>
        {
            <b>get</b> { <b>return</b> <a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#cb9b892e1f9f06c6" class="i property">OutBufferCount</a>; }
 
            <b>set</b> { <a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#cb9b892e1f9f06c6" class="i property">OutBufferCount</a> = <b>value</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Write
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Should
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ShouldProcess
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype1&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType1 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(filename))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="e22f8c9bf63ad5d6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(<b>string</b> <span id="r47 rd" class="r47 r">target</span>)
        {
            <b>string</b> <span id="r48 rd" class="r48 r">verboseDescription</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ShouldProcessMessage</span>,
                <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                <span class="r47 r">target</span>);
            <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r49 rd" class="r49 r">shouldProcessReason</span>;
            <b>return</b> <a href="#9d8b49c8ce7b35a5" class="i method">DoShouldProcess</a>(<span class="r48 r">verboseDescription</span>, <b>null</b>, <b>null</b>, <b>out</b> <span class="r49 r">shouldProcessReason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify text for both the</span>
        <span class="c">///</span><span class="c"> target resource and the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the action which is being performed. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user. (default is Cmdlet name)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype2&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType2 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(filename, &quot;delete&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="c58fd4a450e374a5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(<b>string</b> <span id="r50 rd" class="r50 r">target</span>, <b>string</b> <span id="r51 rd" class="r51 r">action</span>)
        {
            <b>string</b> <span id="r52 rd" class="r52 r">verboseDescription</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ShouldProcessMessage</span>,
                <span class="r51 r">action</span>,
                <span class="r50 r">target</span>,
                <b>null</b>);
            <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r53 rd" class="r53 r">shouldProcessReason</span>;
            <b>return</b> <a href="#9d8b49c8ce7b35a5" class="i method">DoShouldProcess</a>(<span class="r52 r">verboseDescription</span>, <b>null</b>, <b>null</b>, <b>out</b> <span class="r53 r">shouldProcessReason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify the complete text</span>
        <span class="c">///</span><span class="c"> describing the operation, rather than just the name and action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual description of the action to be performed.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">caption</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype3&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType3 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>, <b>out</b> <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="f48829db34cf6cc4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r54 rd" class="r54 r">verboseDescription</span>,
            <b>string</b> <span id="r55 rd" class="r55 r">verboseWarning</span>,
            <b>string</b> <span id="r56 rd" class="r56 r">caption</span>)
        {
            <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r57 rd" class="r57 r">shouldProcessReason</span>;
            <b>return</b> <a href="#9d8b49c8ce7b35a5" class="i method">DoShouldProcess</a>(
                <span class="r54 r">verboseDescription</span>,
                <span class="r55 r">verboseWarning</span>,
                <span class="r56 r">caption</span>,
                <b>out</b> <span class="r57 r">shouldProcessReason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify the complete text</span>
        <span class="c">///</span><span class="c"> describing the operation, rather than just the name and action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual description of the action to be performed.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">caption</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">shouldProcessReason</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the reason(s) why ShouldProcess returned what it returned.</span>
        <span class="c">///</span><span class="c"> Only the reasons enumerated in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype3&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType3 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     ShouldProcessReason shouldProcessReason;</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;,</span>
        <span class="c">///</span><span class="c">                         out shouldProcessReason))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="6f50549084e3e8e5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r58 rd" class="r58 r">verboseDescription</span>,
            <b>string</b> <span id="r59 rd" class="r59 r">verboseWarning</span>,
            <b>string</b> <span id="r60 rd" class="r60 r">caption</span>,
            <b>out</b> <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r61 rd" class="r61 r">shouldProcessReason</span>)
        {
            <b>return</b> <a href="#9d8b49c8ce7b35a5" class="i method">DoShouldProcess</a>(
                <span class="r58 r">verboseDescription</span>,
                <span class="r59 r">verboseWarning</span>,
                <span class="r60 r">caption</span>,
                <b>out</b> <span class="r61 r">shouldProcessReason</span>);
        }
 
        <b>private bool</b> <a id="5898e9feeb904716" href="../R/5898e9feeb904716.html" target="n" data-glyph="76,1" class="i method">CanShouldProcessAutoConfirm</a>()
        {
            <span class="c">// retrieve ConfirmImpact from commandInfo</span>
            <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r62 rd" class="r62 r">commandMetadata</span> = <a href="#b81c479750b2b617" class="i field">_commandInfo</a>.<a href="CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>;
            <b>if</b> (<span class="r62 r">commandMetadata</span> == <b>null</b>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Expected CommandMetadata&quot;</span>);
                <b>return</b> <b>true</b>;
            }
 
            <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <span id="r63 rd" class="r63 r">cmdletConfirmImpact</span> = <span class="r62 r">commandMetadata</span>.<a href="CommandMetadata.cs.html#94737225e0faa8f9" class="i property">ConfirmImpact</a>;
 
            <span class="c">// compare to ConfirmPreference</span>
            <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <span id="r64 rd" class="r64 r">threshold</span> = <a href="#6268f99d5f6310de" class="i property">ConfirmPreference</a>;
            <b>if</b> ((<span class="r64 r">threshold</span> == <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#5b2b0bf78675f285" class="i field">None</a>) || (<span class="r64 r">threshold</span> &gt; <span class="r63 r">cmdletConfirmImpact</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper function for ShouldProcess APIs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Description of operation, to be printed for Continue or WhatIf</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Warning prompt, to be printed for Inquire</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">shouldProcessReason</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the reason(s) why ShouldProcess returned what it returned.</span>
        <span class="c">///</span><span class="c"> Only the reasons enumerated in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">true iff the action should be performed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="9d8b49c8ce7b35a5" href="../R/9d8b49c8ce7b35a5.html" target="n" data-glyph="76,1" class="i method">DoShouldProcess</a>(
            <b>string</b> <span id="r65 rd" class="r65 r">verboseDescription</span>,
            <b>string</b> <span id="r66 rd" class="r66 r">verboseWarning</span>,
            <b>string</b> <span id="r67 rd" class="r67 r">caption</span>,
            <b>out</b> <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r68 rd" class="r68 r">shouldProcessReason</span>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <span class="r68 r">shouldProcessReason</span> = <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>.<a href="cmdlet.cs.html#401296eb0e0f2185" class="i field">None</a>;
 
            <b>switch</b> (<a href="#6ada5d5719752022" class="i field">lastShouldProcessContinueStatus</a>)
            {
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>:
                    <b>return</b> <b>false</b>;
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>:
                    <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#bbd763fc28e57d9a" class="i property">WhatIf</a>)
            {
                <span class="c">// 2005/05/24 908827</span>
                <span class="c">// WriteDebug/WriteVerbose/WriteProgress/WriteWarning should only be callable from the main thread</span>
                <span class="c">//</span>
                <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
                <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
                <span class="c">// functions can be called.</span>
                <span class="c">//</span>
                <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
                <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
                <span class="c">// enforce the check again.</span>
                <span class="c">//</span>
                <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
                <span class="c">//</span>
                <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
                <span class="r68 r">shouldProcessReason</span> = <a href="cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>.<a href="cmdlet.cs.html#21f7663d1daafa62" class="i field">WhatIf</a>;
                <b>string</b> <span id="r69 rd" class="r69 r">whatIfMessage</span> =
                    <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ShouldProcessWhatIfMessage</span>,
                        <span class="r65 r">verboseDescription</span>);
 
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<span class="r69 r">whatIfMessage</span>);
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#41cef667d4ee22a2" class="i method">WriteLine</a>(<span class="r69 r">whatIfMessage</span>);
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#5898e9feeb904716" class="i method">CanShouldProcessAutoConfirm</a>())
            {
                <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e4eb8be94a708a06" class="i property">Verbose</a>)
                {
                    <span class="c">// 2005/05/24 908827</span>
                    <span class="c">// WriteDebug/WriteVerbose/WriteProgress/WriteWarning should only be callable from the main thread</span>
                    <span class="c">//</span>
                    <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
                    <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
                    <span class="c">// functions can be called.</span>
                    <span class="c">//</span>
                    <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
                    <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
                    <span class="c">// enforce the check again.</span>
                    <span class="c">//</span>
                    <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
                    <span class="c">//</span>
                    <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
                    <a href="#3646a311080648d6" class="i method">WriteVerbose</a>(<span class="r65 r">verboseDescription</span>);
                }
 
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r66 r">verboseWarning</span>))
                <span class="r66 r">verboseWarning</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ShouldProcessWarningFallback</span>,
                    <span class="r65 r">verboseDescription</span>);
 
            <span class="c">// 2005/05/24 908827</span>
            <span class="c">// WriteDebug/WriteVerbose/WriteProgress/WriteWarning should only be callable from the main thread</span>
            <span class="c">//</span>
            <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
            <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
            <span class="c">// functions can be called.</span>
            <span class="c">//</span>
            <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
            <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
            <span class="c">// enforce the check again.</span>
            <span class="c">//</span>
            <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
            <span class="c">//</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
            <a href="#6ada5d5719752022" class="i field">lastShouldProcessContinueStatus</a> = <a href="#6c0c629fc04b03c2" class="i method">InquireHelper</a>(
                <span class="r66 r">verboseWarning</span>,
                <span class="r67 r">caption</span>,
                <b>true</b>,   <span class="c">// allowYesToAll</span>
                <b>true</b>,   <span class="c">// allowNoToAll</span>
                <b>false</b>,  <span class="c">// replaceNoWithHalt</span>
                <b>false</b>   <span class="c">// hasSecurityImpact</span>
                );
 
            <b>switch</b> (<a href="#6ada5d5719752022" class="i field">lastShouldProcessContinueStatus</a>)
            {
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#2d8ea5f9b6f86199" class="i field">No</a>:
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>:
                    <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>internal enum</b> <a id="659a4be3c4062483" href="../R/659a4be3c4062483.html" target="n" data-glyph="20,1" class="t t"><span id="e9630db3515f2911">ShouldProcessPossibleOptimization</span></a>
        {
            <a id="0d67bfee87f23d41" href="../R/0d67bfee87f23d41.html" target="n" data-glyph="24,2" class="i field">AutoYes_CanSkipShouldProcessCall</a>,
            <a id="744516791af813ad" href="../R/744516791af813ad.html" target="n" data-glyph="24,2" class="i field">AutoYes_CanCallShouldProcessAsynchronously</a>,
 
            <a id="9a20eef2c6f14715" href="../R/9a20eef2c6f14715.html" target="n" data-glyph="24,2" class="i field">AutoNo_CanCallShouldProcessAsynchronously</a>,
 
            <a id="a153bdfe6e852d6f" href="../R/a153bdfe6e852d6f.html" target="n" data-glyph="24,2" class="i field">NoOptimizationPossible</a>,
        }
 
        <b>internal</b> <a href="#659a4be3c4062483" class="t t">ShouldProcessPossibleOptimization</a> <a id="f87aa74f22a72647" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CalculatePossibleShouldProcessOptimization</a>()
        {
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bbd763fc28e57d9a" class="i property">WhatIf</a>)
            {
                <b>return</b> <a href="#659a4be3c4062483" class="t t">ShouldProcessPossibleOptimization</a>.<a href="#9a20eef2c6f14715" class="i field">AutoNo_CanCallShouldProcessAsynchronously</a>;
            }
 
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#5898e9feeb904716" class="i method">CanShouldProcessAutoConfirm</a>())
            {
                <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e4eb8be94a708a06" class="i property">Verbose</a>)
                {
                    <b>return</b> <a href="#659a4be3c4062483" class="t t">ShouldProcessPossibleOptimization</a>.<a href="#744516791af813ad" class="i field">AutoYes_CanCallShouldProcessAsynchronously</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <a href="#659a4be3c4062483" class="t t">ShouldProcessPossibleOptimization</a>.<a href="#0d67bfee87f23d41" class="i field">AutoYes_CanSkipShouldProcessCall</a>;
                }
            }
 
            <b>return</b> <a href="#659a4be3c4062483" class="t t">ShouldProcessPossibleOptimization</a>.<a href="#a153bdfe6e852d6f" class="i field">NoOptimizationPossible</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ShouldProcess
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ShouldContinue
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant only offers Yes/No, not YesToAll/NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue should also offer a &quot;bool Force&quot;</span>
        <span class="c">///</span><span class="c"> parameter which bypasses the calls to ShouldContinue</span>
        <span class="c">///</span><span class="c"> and ShouldProcess.</span>
        <span class="c">///</span><span class="c"> If this is not done, it will be difficult to use the Cmdlet</span>
        <span class="c">///</span><span class="c"> from scripts and non-interactive hosts.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue must still verify operations</span>
        <span class="c">///</span><span class="c"> which will make changes using ShouldProcess.</span>
        <span class="c">///</span><span class="c"> This will assure that settings such as -WhatIf work properly.</span>
        <span class="c">///</span><span class="c"> You may call ShouldContinue either before or after ShouldProcess.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets may have different &quot;classes&quot; of confirmations.  For example,</span>
        <span class="c">///</span><span class="c"> &quot;del&quot; confirms whether files in a particular directory should be</span>
        <span class="c">///</span><span class="c"> deleted, whether read-only files should be deleted, etc.</span>
        <span class="c">///</span><span class="c"> Cmdlets can use ShouldContinue to store YesToAll/NoToAll members</span>
        <span class="c">///</span><span class="c"> for each such &quot;class&quot; to keep track of whether the user has</span>
        <span class="c">///</span><span class="c"> confirmed &quot;delete all read-only files&quot; etc.</span>
        <span class="c">///</span><span class="c"> ShouldProcess offers YesToAll/NoToAll automatically,</span>
        <span class="c">///</span><span class="c"> but answering YesToAll or NoToAll applies to all subsequent calls</span>
        <span class="c">///</span><span class="c"> to ShouldProcess for the Cmdlet instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype4&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType4 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 [Parameter]</span>
        <span class="c">///</span><span class="c">                 public SwitchParameter Force</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return force; }</span>
        <span class="c">///</span><span class="c">                     set { force = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private bool force;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         if (IsReadOnly(filename))</span>
        <span class="c">///</span><span class="c">                         {</span>
        <span class="c">///</span><span class="c">                             if (!Force </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> !ShouldContinue(</span>
        <span class="c">///</span><span class="c">                                     string.Format(&quot;File {0} is read-only.  Are you sure you want to delete read-only file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                                     &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                                     )</span>
        <span class="c">///</span><span class="c">                             {</span>
        <span class="c">///</span><span class="c">                                 return;</span>
        <span class="c">///</span><span class="c">                             }</span>
        <span class="c">///</span><span class="c">                         }</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="f2973e006bf5ff39" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(<b>string</b> <span id="r70 rd" class="r70 r">query</span>, <b>string</b> <span id="r71 rd" class="r71 r">caption</span>)
        {
            <b>bool</b> <span id="r72 rd" class="r72 r">yesToAll</span> = <b>false</b>;
            <b>bool</b> <span id="r73 rd" class="r73 r">noToAll</span> = <b>false</b>;
            <b>return</b> <a href="#a0f588788e063776" class="i method">DoShouldContinue</a>(
                <span class="r70 r">query</span>,
                <span class="r71 r">caption</span>,
                <span class="r74 r">hasSecurityImpact</span>: <b>false</b>,
                <span class="r75 r">supportsToAllOptions</span>: <b>false</b>,
                <b>ref</b> <span class="r72 r">yesToAll</span>,
                <b>ref</b> <span class="r73 r">noToAll</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant offers Yes, No, YesToAll and NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">hasSecurityImpact</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the operation being confirmed has a security impact. If specified,</span>
        <span class="c">///</span><span class="c"> the default option selected in the selection menu is &#39;No&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">yesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects YesToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">noToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects NoToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="f3798cae5045c11f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r76 rd" class="r76 r">query</span>, <b>string</b> <span id="r77 rd" class="r77 r">caption</span>, <b>bool</b> <span id="r78 rd" class="r78 r">hasSecurityImpact</span>, <b>ref bool</b> <span id="r79 rd" class="r79 r">yesToAll</span>, <b>ref bool</b> <span id="r80 rd" class="r80 r">noToAll</span>)
        {
            <b>return</b> <a href="#a0f588788e063776" class="i method">DoShouldContinue</a>(<span class="r76 r">query</span>, <span class="r77 r">caption</span>, <span class="r78 r">hasSecurityImpact</span>, <b>true</b>, <b>ref</b> <span class="r79 r">yesToAll</span>, <b>ref</b> <span class="r80 r">noToAll</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant offers Yes, No, YesToAll and NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">yesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects YesToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">noToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects NoToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue should also offer a &quot;bool Force&quot;</span>
        <span class="c">///</span><span class="c"> parameter which bypasses the calls to ShouldContinue</span>
        <span class="c">///</span><span class="c"> and ShouldProcess.</span>
        <span class="c">///</span><span class="c"> If this is not done, it will be difficult to use the Cmdlet</span>
        <span class="c">///</span><span class="c"> from scripts and non-interactive hosts.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue must still verify operations</span>
        <span class="c">///</span><span class="c"> which will make changes using ShouldProcess.</span>
        <span class="c">///</span><span class="c"> This will assure that settings such as -WhatIf work properly.</span>
        <span class="c">///</span><span class="c"> You may call ShouldContinue either before or after ShouldProcess.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets may have different &quot;classes&quot; of confirmations.  For example,</span>
        <span class="c">///</span><span class="c"> &quot;del&quot; confirms whether files in a particular directory should be</span>
        <span class="c">///</span><span class="c"> deleted, whether read-only files should be deleted, etc.</span>
        <span class="c">///</span><span class="c"> Cmdlets can use ShouldContinue to store YesToAll/NoToAll members</span>
        <span class="c">///</span><span class="c"> for each such &quot;class&quot; to keep track of whether the user has</span>
        <span class="c">///</span><span class="c"> confirmed &quot;delete all read-only files&quot; etc.</span>
        <span class="c">///</span><span class="c"> ShouldProcess offers YesToAll/NoToAll automatically,</span>
        <span class="c">///</span><span class="c"> but answering YesToAll or NoToAll applies to all subsequent calls</span>
        <span class="c">///</span><span class="c"> to ShouldProcess for the Cmdlet instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype4&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType5 : PSCmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 [Parameter]</span>
        <span class="c">///</span><span class="c">                 public SwitchParameter Force</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return force; }</span>
        <span class="c">///</span><span class="c">                     set { force = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private bool force;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 private bool yesToAll;</span>
        <span class="c">///</span><span class="c">                 private bool noToAll;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         if (IsReadOnly(filename))</span>
        <span class="c">///</span><span class="c">                         {</span>
        <span class="c">///</span><span class="c">                             if (!Force </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> !ShouldContinue(</span>
        <span class="c">///</span><span class="c">                                     string.Format(&quot;File {0} is read-only.  Are you sure you want to delete read-only file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                                     &quot;Delete file&quot;),</span>
        <span class="c">///</span><span class="c">                                     ref yesToAll,</span>
        <span class="c">///</span><span class="c">                                     ref noToAll</span>
        <span class="c">///</span><span class="c">                                     )</span>
        <span class="c">///</span><span class="c">                             {</span>
        <span class="c">///</span><span class="c">                                 return;</span>
        <span class="c">///</span><span class="c">                             }</span>
        <span class="c">///</span><span class="c">                         }</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="0867777472e77f05" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r81 rd" class="r81 r">query</span>, <b>string</b> <span id="r82 rd" class="r82 r">caption</span>, <b>ref bool</b> <span id="r83 rd" class="r83 r">yesToAll</span>, <b>ref bool</b> <span id="r84 rd" class="r84 r">noToAll</span>)
        {
            <b>return</b> <a href="#a0f588788e063776" class="i method">DoShouldContinue</a>(<span class="r81 r">query</span>, <span class="r82 r">caption</span>, <b>false</b>, <b>true</b>, <b>ref</b> <span class="r83 r">yesToAll</span>, <b>ref</b> <span class="r84 r">noToAll</span>);
        }
 
        <b>private bool</b> <a id="a0f588788e063776" href="../R/a0f588788e063776.html" target="n" data-glyph="76,1" class="i method">DoShouldContinue</a>(
            <b>string</b> <span id="r85 rd" class="r85 r">query</span>,
            <b>string</b> <span id="r86 rd" class="r86 r">caption</span>,
            <b>bool</b> <span id="r74 rd" class="r74 r">hasSecurityImpact</span>,
            <b>bool</b> <span id="r75 rd" class="r75 r">supportsToAllOptions</span>,
            <b>ref bool</b> <span id="r87 rd" class="r87 r">yesToAll</span>,
            <b>ref bool</b> <span id="r88 rd" class="r88 r">noToAll</span>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <span class="c">//</span>
            <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
            <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
            <span class="c">// functions can be called.</span>
            <span class="c">//</span>
            <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
            <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
            <span class="c">// enforce the check again.</span>
            <span class="c">//</span>
            <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
            <span class="c">//</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
            <b>if</b> (<span class="r88 r">noToAll</span>)
                <b>return</b> <b>false</b>;
            <b>else</b> <b>if</b> (<span class="r87 r">yesToAll</span>)
                <b>return</b> <b>true</b>;
 
            <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <span id="r89 rd" class="r89 r">continueStatus</span> = <a href="#6c0c629fc04b03c2" class="i method">InquireHelper</a>(
                <span class="r85 r">query</span>,
                <span class="r86 r">caption</span>,
                <span class="r75 r">supportsToAllOptions</span>, <span class="c">// allowYesToAll</span>
                <span class="r75 r">supportsToAllOptions</span>, <span class="c">// allowNoToAll</span>
                <b>false</b>,                <span class="c">// replaceNoWithHalt</span>
                <span class="r74 r">hasSecurityImpact</span>     <span class="c">// hasSecurityImpact</span>
                );
 
            <b>switch</b> (<span class="r89 r">continueStatus</span>)
            {
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#2d8ea5f9b6f86199" class="i field">No</a>:
                    <b>return</b> <b>false</b>;
 
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>:
                    <span class="r88 r">noToAll</span> = <b>true</b>;
                    <b>return</b> <b>false</b>;
 
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>:
                    <span class="r87 r">yesToAll</span> = <b>true</b>;
                    <b>break</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ShouldContinue
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Should
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Transaction Support
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if a transaction is available for use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="fbc5820bc97eea1e" href="../R/fbc5820bc97eea1e.html" target="n" data-glyph="72,1" class="i method">TransactionAvailable</a>()
        {
            <b>return</b> <a href="#5978ff7ea7c57396" class="i property">UseTransactionFlagSet</a> &amp;&amp; <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#8034b8ed99ff105b" class="i property">HasTransaction</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an object that surfaces the current PowerShell transaction.</span>
        <span class="c">///</span><span class="c"> When this object is disposed, PowerShell resets the active transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../CoreCLR/CorePsStub.cs.html#f4565df9151a2fcf" class="t t">PSTransactionContext</a> <a id="faa63f67e08f0164" href="../R/faa63f67e08f0164.html" target="n" data-glyph="102,1" class="i property">CurrentPSTransaction</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<a href="#fbc5820bc97eea1e" class="i method">TransactionAvailable</a>())
                {
                    <b>string</b> <span id="r90 rd" class="r90 r">error</span> = <b>null</b>;
 
                    <b>if</b> (!<a href="#5978ff7ea7c57396" class="i property">UseTransactionFlagSet</a>)
                        <span class="r90 r">error</span> = <span class="i">TransactionStrings</span>.<span class="i">CmdletRequiresUseTx</span>;
                    <b>else</b>
                        <span class="r90 r">error</span> = <span class="i">TransactionStrings</span>.<span class="i">NoTransactionAvailable</span>;
 
                    <span class="c">// We want to throw in this situation, and want to use a</span>
                    <span class="c">// property because it mimics the C# using(TransactionScope ...) syntax</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> suppress 56503
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r90 r">error</span>);
                }
 
                <b>return</b> <b>new</b> <a href="../CoreCLR/CorePsStub.cs.html#01168f52b9949385" class="t constructor">PSTransactionContext</a>(<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Transaction Support
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Misc
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of ThrowTerminatingError.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error which caused the command to be terminated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> always</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> terminates the command, where</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> allows the command to continue.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The cmdlet can also terminate the command by simply throwing</span>
        <span class="c">///</span><span class="c"> any exception.  When the cmdlet&#39;s implementation of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#f98800b8478b2288" class="i method">ProcessRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#ca41319604ac804f" class="i method">BeginProcessing</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#a5fa661c704b7117" class="i method">EndProcessing</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> throws an exception, the Engine will always catch the exception</span>
        <span class="c">///</span><span class="c"> and report it as a terminating error.</span>
        <span class="c">///</span><span class="c"> However, it is preferred for the cmdlet to call</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> so that the additional information in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> always throws</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> regardless of what error was specified in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">errorRecord</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#f98800b8478b2288" class="i method">ProcessRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>.<span class="i">DoesNotReturn</span>]
        <b>public void</b> <a id="0d11bc69a2d182e7" href="../R/0d11bc69a2d182e7.html" target="n" data-glyph="72,1" class="i method">ThrowTerminatingError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r91 rd" class="r91 r">errorRecord</span>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
            <b>if</b> (<span class="r91 r">errorRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r91 r">errorRecord</span>));
            }
 
            <span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<a href="#414274318fb6cbe1" class="i property">MyInvocation</a>);
 
            <b>if</b> (<span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b>
                &amp;&amp; <span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> != <b>null</b>)
            {
                <span class="i">Exception</span> <span id="r92 rd" class="r92 r">textLookupError</span> = <span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a>;
                <span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> = <b>null</b>;
                <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#1b469b122e173e0c" class="i method">LogCommandHealthEvent</a>(
                    <a href="#ef96008a8ef9962a" class="i property">Context</a>,
                    <span class="r92 r">textLookupError</span>,
                    <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
            }
 
            <span class="c">// This code forces the stack trace and source fields to be populated</span>
            <b>if</b> (<span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>
                &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">StackTrace</span>))
            {
                <b>try</b>
                {
                    <b>throw</b> <span class="r91 r">errorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                    <span class="c">// no need to worry about severe exceptions since</span>
                    <span class="c">// it wasn&#39;t really thrown originally</span>
                }
            }
 
            <a href="../utils/ExecutionExceptions.cs.html#7b242746a433b370" class="t t">CmdletInvocationException</a> <span id="r93 rd" class="r93 r">e</span> =
                <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#442c9ff167794161" class="t constructor">CmdletInvocationException</a>(<span class="r91 r">errorRecord</span>);
 
            <span class="c">// If the error action preference is set to break, break immediately</span>
            <span class="c">// into the debugger</span>
            <b>if</b> (<a href="#0135181adbe24516" class="i property">ErrorAction</a> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
            {
                <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#3e56b2d709de0d80" class="i property">Debugger</a>?.<span class="i">Break</span>(<span class="r93 r">e</span>.<span class="i">InnerException</span> ?? <span class="r93 r">e</span>);
            }
 
            <span class="c">// Code sees only that execution stopped</span>
            <b>throw</b> <span class="i">ManageException</span>(<span class="r93 r">e</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Misc
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Data Merging
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Data streams available for merging.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="8b0e9f05387e62ca" href="../R/8b0e9f05387e62ca.html" target="n" data-glyph="20,1" class="t t"><span id="01d12409ce557193">MergeDataStream</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> No data stream available for merging.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="bc5ddd48254cc0ca" href="../R/bc5ddd48254cc0ca.html" target="n" data-glyph="24,2" class="i field">None</a> = 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> All data streams.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="af1f7e82ab77f81f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">All</a> = 1,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Success output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="8ab59ea31f703b82" href="../R/8ab59ea31f703b82.html" target="n" data-glyph="24,2" class="i field">Output</a> = 2,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Error output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="c86aafab614fa60d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Error</a> = 3,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Warning output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="be915d8d9cae0865" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Warning</a> = 4,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Verbose output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="af22a63da4891ef8" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Verbose</a> = 5,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Debug output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="ede5d9ea97f91ac7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Debug</a> = 6,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Host output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="96a3a98eb0de76d8" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Host</a> = 7,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Information output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="02fc0c9d465bd1d3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Information</a> = 8
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/sets error data stream merge state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#8b0e9f05387e62ca" class="t t">MergeDataStream</a> <a id="ed59e3b00feab7b1" href="../R/ed59e3b00feab7b1.html" target="n" data-glyph="104,1" class="i property">ErrorMergeTo</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method to set data stream merging based on passed in runtime object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">fromRuntime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">MshCommandRuntime object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="85b5a830104aaf06" href="../R/85b5a830104aaf06.html" target="n" data-glyph="74,1" class="i method">SetMergeFromRuntime</a>(<a href="#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r94 rd" class="r94 r">fromRuntime</span>)
        {
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#ed59e3b00feab7b1" class="i property">ErrorMergeTo</a> = <span class="r94 r">fromRuntime</span>.<a href="#ed59e3b00feab7b1" class="i property">ErrorMergeTo</a>;
 
            <b>if</b> (<span class="r94 r">fromRuntime</span>.<a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a> = <span class="r94 r">fromRuntime</span>.<a href="#d00979e144f16d67" class="i property">WarningOutputPipe</a>;
            }
 
            <b>if</b> (<span class="r94 r">fromRuntime</span>.<a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a> = <span class="r94 r">fromRuntime</span>.<a href="#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a>;
            }
 
            <b>if</b> (<span class="r94 r">fromRuntime</span>.<a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a> = <span class="r94 r">fromRuntime</span>.<a href="#e4845e81eb1192a5" class="i property">DebugOutputPipe</a>;
            }
 
            <b>if</b> (<span class="r94 r">fromRuntime</span>.<a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a> = <span class="r94 r">fromRuntime</span>.<a href="#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a>;
            }
        }
 
        <span class="c">//</span>
        <span class="c">// Legacy merge hints.</span>
        <span class="c">//</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Claims the unclaimed error output of all previous commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="2b01b0604d7922fc" href="../R/2b01b0604d7922fc.html" target="n" data-glyph="104,1" class="i property">MergeUnclaimedPreviousErrorResults</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Pipes
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the input pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="2a3306bd1f3917ef" href="../R/2a3306bd1f3917ef.html" target="n" data-glyph="104,1" class="i property">InputPipe</a>
        {
            <b>get</b> { <b>return</b> <a href="#7aa52386cb1f9dfc" class="i field">_inputPipe</a> ??= <b>new</b> <a href="Pipe.cs.html#c1592456b1ff42b5" class="t constructor">Pipe</a>(); }
 
            <b>set</b> { <a href="#7aa52386cb1f9dfc" class="i field">_inputPipe</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="b24610eb88ee27e9" href="../R/b24610eb88ee27e9.html" target="n" data-glyph="104,1" class="i property">OutputPipe</a>
        {
            <b>get</b> { <b>return</b> <a href="#41f24992471f6094" class="i field">_outputPipe</a> ??= <b>new</b> <a href="Pipe.cs.html#c1592456b1ff42b5" class="t constructor">Pipe</a>(); }
 
            <b>set</b> { <a href="#41f24992471f6094" class="i field">_outputPipe</a> = <b>value</b>; }
        }
 
        <b>internal object</b>[] <a id="74283714d72d2821" href="../R/74283714d72d2821.html" target="n" data-glyph="74,1" class="i method">GetResultsAsArray</a>()
        {
            <b>if</b> (<a href="#41f24992471f6094" class="i field">_outputPipe</a> == <b>null</b>)
                <b>return</b> <a href="#493d2fff89fbbf4f" class="i field">StaticEmptyArray</a>;
            <b>return</b> <a href="#41f24992471f6094" class="i field">_outputPipe</a>.<a href="Pipe.cs.html#76ced3054041695b" class="i method">ToArray</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An empty array that is declared statically so we don&#39;t keep</span>
        <span class="c">///</span><span class="c"> allocating them over and over...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly object</b>[] <a id="493d2fff89fbbf4f" href="../R/493d2fff89fbbf4f.html" target="n" data-glyph="44,1" class="i field">StaticEmptyArray</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the error pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="8cfabd8908a77f92" href="../R/8cfabd8908a77f92.html" target="n" data-glyph="104,1" class="i property">ErrorOutputPipe</a>
        {
            <b>get</b> { <b>return</b> <a href="#2a6eccd74ca336be" class="i field">_errorOutputPipe</a> ??= <b>new</b> <a href="Pipe.cs.html#c1592456b1ff42b5" class="t constructor">Pipe</a>(); }
 
            <b>set</b> { <a href="#2a6eccd74ca336be" class="i field">_errorOutputPipe</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the warning output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="d00979e144f16d67" href="../R/d00979e144f16d67.html" target="n" data-glyph="104,1" class="i property">WarningOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the verbose output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="ef3e8731176db1bd" href="../R/ef3e8731176db1bd.html" target="n" data-glyph="104,1" class="i property">VerboseOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the debug output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="e4845e81eb1192a5" href="../R/e4845e81eb1192a5.html" target="n" data-glyph="104,1" class="i property">DebugOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the informational output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="3a61ae91cdf1e0bc" href="../R/3a61ae91cdf1e0bc.html" target="n" data-glyph="104,1" class="i property">InformationOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal helpers
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throws if the pipeline is stopping.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ea515a6e1478133b" href="../R/ea515a6e1478133b.html" target="n" data-glyph="74,1" class="i method">ThrowIfStopping</a>()
        {
            <b>if</b> (<a href="#26faf0098cf2f821" class="i property">IsStopping</a>)
                <b>throw</b> <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throws if the caller is trying to call WriteObject/WriteError</span>
        <span class="c">///</span><span class="c"> from the wrong thread, or not during a call to</span>
        <span class="c">///</span><span class="c"> BeginProcessing/ProcessRecord/EndProcessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e50e33c35e4bce4e" href="../R/e50e33c35e4bce4e.html" target="n" data-glyph="74,1" class="i method">ThrowIfWriteNotPermitted</a>(<b>bool</b> <span id="r95 rd" class="r95 r">needsToWriteToPipeline</span>)
        {
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a> == <b>null</b>
                || <a href="#64fec126736a688e" class="i field">_thisCommand</a> != <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#6eb83c46d576ace3" class="i field">_permittedToWrite</a>
                || <span class="r95 r">needsToWriteToPipeline</span> &amp;&amp; !<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#d6a61a71c7b98f1c" class="i field">_permittedToWriteToPipeline</a>
                || <span class="i">Thread</span>.<span class="i">CurrentThread</span> != <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#6caa26d0d6708358" class="i field">_permittedToWriteThread</a>
               )
            {
                <span class="c">// Only generate these exceptions if a pipeline has already been declared as the &#39;writing&#39; pipeline.</span>
                <span class="c">// Otherwise, these are probably infrastructure messages and can be ignored.</span>
                <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>?.<a href="pipeline.cs.html#6eb83c46d576ace3" class="i field">_permittedToWrite</a> != <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">PipelineStrings</span>.<span class="i">WriteNotPermitted</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WriteObject/WriteObjecs/WriteError are only allowed during this scope.</span>
        <span class="c">///</span><span class="c"> Be sure to use this object only in &quot;using&quot; so that it is reliably</span>
        <span class="c">///</span><span class="c"> disposed and follows stack semantics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">IDisposable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="898174c9e014e567" href="../R/898174c9e014e567.html" target="n" data-glyph="74,1" class="i method">AllowThisCommandToWrite</a>(<b>bool</b> <span id="r96 rd" class="r96 r">permittedToWriteToPipeline</span>)
        {
            <b>return</b> <b>new</b> <a href="#ab9a55f421d3993a" class="t constructor">AllowWrite</a>(<a href="#64fec126736a688e" class="i field">_thisCommand</a>, <span class="r96 r">permittedToWriteToPipeline</span>);
        }
 
        <b>private sealed class</b> <a id="987d39eaeaeaf8ab" href="../R/987d39eaeaeaf8ab.html" target="n" data-glyph="4,1" class="t t">AllowWrite</a> : <span class="i">IDisposable</span>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Begin the scope where WriteObject/WriteError is permitted.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a id="ab9a55f421d3993a" href="../R/ab9a55f421d3993a.html" target="n" data-glyph="74,2" class="t constructor">AllowWrite</a>(<a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <span id="r97 rd" class="r97 r">permittedToWrite</span>, <b>bool</b> <span id="r98 rd" class="r98 r">permittedToWriteToPipeline</span>)
            {
                <b>if</b> (<span class="r97 r">permittedToWrite</span> == <b>null</b>)
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r97 r">permittedToWrite</span>));
                <b>if</b> (!(<span class="r97 r">permittedToWrite</span>.<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> <b>is</b> <a href="#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r99 rd" class="r99 r">mcr</span>))
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;permittedToWrite.CommandRuntime&quot;</span>);
                <a href="#74c6c1ddf469523e" class="i field">_pp</a> = <span class="r99 r">mcr</span>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>;
                <b>if</b> (<a href="#74c6c1ddf469523e" class="i field">_pp</a> == <b>null</b>)
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;permittedToWrite.CommandRuntime.PipelineProcessor&quot;</span>);
                <a href="#a7c73ddd58fd4c6e" class="i field">_wasPermittedToWrite</a> = <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6eb83c46d576ace3" class="i field">_permittedToWrite</a>;
                <a href="#c30a9c38a1423c9f" class="i field">_wasPermittedToWriteToPipeline</a> = <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#d6a61a71c7b98f1c" class="i field">_permittedToWriteToPipeline</a>;
                <a href="#9fc562ba2ff98d23" class="i field">_wasPermittedToWriteThread</a> = <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6caa26d0d6708358" class="i field">_permittedToWriteThread</a>;
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6eb83c46d576ace3" class="i field">_permittedToWrite</a> = <span class="r97 r">permittedToWrite</span>;
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#d6a61a71c7b98f1c" class="i field">_permittedToWriteToPipeline</a> = <span class="r98 r">permittedToWriteToPipeline</span>;
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6caa26d0d6708358" class="i field">_permittedToWriteThread</a> = <span class="i">Thread</span>.<span class="i">CurrentThread</span>;
            }
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> End the scope where WriteObject/WriteError is permitted.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
            <span class="c">///</span><span class="c"> Not a true public, since the class is internal.</span>
            <span class="c">///</span><span class="c"> This is public only due to C# interface rules.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
            <b>public void</b> <a id="b27bd85b62070cbc" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6eb83c46d576ace3" class="i field">_permittedToWrite</a> = <a href="#a7c73ddd58fd4c6e" class="i field">_wasPermittedToWrite</a>;
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#d6a61a71c7b98f1c" class="i field">_permittedToWriteToPipeline</a> = <a href="#c30a9c38a1423c9f" class="i field">_wasPermittedToWriteToPipeline</a>;
                <a href="#74c6c1ddf469523e" class="i field">_pp</a>.<a href="pipeline.cs.html#6caa26d0d6708358" class="i field">_permittedToWriteThread</a> = <a href="#9fc562ba2ff98d23" class="i field">_wasPermittedToWriteThread</a>;
                <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#987d39eaeaeaf8ab" class="k">this</a>);
            }
 
            <span class="c">// There is no finalizer, by design.  This class relies on always</span>
            <span class="c">// being disposed and always following stack semantics.</span>
 
            <b>private readonly</b> <a href="pipeline.cs.html#5e576bcabfa5c82b" class="t t">PipelineProcessor</a> <a id="74c6c1ddf469523e" href="../R/74c6c1ddf469523e.html" target="n" data-glyph="46,2" class="i field">_pp</a> = <b>null</b>;
            <b>private readonly</b> <a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <a id="a7c73ddd58fd4c6e" href="../R/a7c73ddd58fd4c6e.html" target="n" data-glyph="46,2" class="i field">_wasPermittedToWrite</a> = <b>null</b>;
            <b>private readonly bool</b> <a id="c30a9c38a1423c9f" href="../R/c30a9c38a1423c9f.html" target="n" data-glyph="46,2" class="i field">_wasPermittedToWriteToPipeline</a> = <b>false</b>;
            <b>private readonly</b> <span class="i">Thread</span> <a id="9fc562ba2ff98d23" href="../R/9fc562ba2ff98d23.html" target="n" data-glyph="46,2" class="i field">_wasPermittedToWriteThread</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the exception to be returned from</span>
        <span class="c">///</span><span class="c"> PipelineProcessor.SynchronousExecute,</span>
        <span class="c">///</span><span class="c"> and writes it to the error variable.</span>
        <span class="c">///</span><span class="c"> The general pattern is to call</span>
        <span class="c">///</span><span class="c"> throw ManageException(e);</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PipelineStoppedException.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="ac21e463bdb95d02" href="../R/ac21e463bdb95d02.html" target="n" data-glyph="72,1" class="i method">ManageException</a>(<span class="i">Exception</span> <span id="r100 rd" class="r100 r">e</span>)
        {
            <b>if</b> (<span class="r100 r">e</span> == <b>null</b>)
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r100 r">e</span>));
 
            <b>if</b> (<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a> != <b>null</b>)
            {
                <a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#29a9ee363b03e58b" class="i method">RecordFailure</a>(<span class="r100 r">e</span>, <a href="#64fec126736a688e" class="i field">_thisCommand</a>);
            }
 
            <span class="c">// 1021203-2005/05/09-JonN</span>
            <span class="c">// HaltCommandException will cause the command</span>
            <span class="c">// to stop, but not be reported as an error.</span>
            <span class="c">// 913088-2005/06/06</span>
            <span class="c">// PipelineStoppedException should not get added to $Error</span>
            <span class="c">// 2008/06/25 - narrieta: ExistNestedPromptException should not be added to $error either</span>
            <span class="c">// 2019/10/18 - StopUpstreamCommandsException should not be added either</span>
            <b>if</b> (<span class="r100 r">e</span> <b>is not</b> <a href="../utils/ExecutionExceptions.cs.html#ec3d1200bf100d3c" class="t t">HaltCommandException</a>
                &amp;&amp; <span class="r100 r">e</span> <b>is not</b> <a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>
                &amp;&amp; <span class="r100 r">e</span> <b>is not</b> <a href="lang/parserutils.cs.html#714b20adffed66d6" class="t t">ExitNestedPromptException</a>
                &amp;&amp; <span class="r100 r">e</span> <b>is not</b> <a href="lang/parserutils.cs.html#3b761558ff868bf6" class="t t">StopUpstreamCommandsException</a>)
            {
                <b>try</b>
                {
                    <span class="i">AppendErrorToVariables</span>(<span class="r100 r">e</span>);
                }
                <b>catch</b>
                {
                    <span class="c">// Catch all OK, the error variables might be corrupted.</span>
                }
 
                <span class="c">// Log a command health event</span>
 
                <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#1b469b122e173e0c" class="i method">LogCommandHealthEvent</a>(
                    <a href="#ef96008a8ef9962a" class="i property">Context</a>,
                    <span class="r100 r">e</span>,
                    <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
            }
 
            <span class="c">// Upstream Cmdlets see only that execution stopped</span>
            <b>return</b> <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error PSVariable
        <b>private</b> <span class="i">IList</span> <a id="d8e38fb42ce574fc" href="../R/d8e38fb42ce574fc.html" target="n" data-glyph="46,1" class="i field">_errorVarList</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorVariable tells which variable to populate with the errors.</span>
        <span class="c">///</span><span class="c"> Use +varname to append to the variable rather than clearing it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="e49881eb01e6f253" href="../R/e49881eb01e6f253.html" target="n" data-glyph="104,1" class="i property">ErrorVariable</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal void</b> <a id="c74a40a706387e87" href="../R/c74a40a706387e87.html" target="n" data-glyph="74,1" class="i method">SetupErrorVariable</a>()
        {
            <a href="#af4d48ce703cfd06" class="i method">SetupVariable</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#fc0efe5038263e2e" class="i field">Error</a>, <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e49881eb01e6f253" class="i property">ErrorVariable</a>, <b>ref</b> <a href="#d8e38fb42ce574fc" class="i field">_errorVarList</a>);
        }
 
        <b>private void</b> <a id="18078011300dd272" href="../R/18078011300dd272.html" target="n" data-glyph="76,1" class="i method">EnsureVariableParameterAllowed</a>()
        {
            <b>if</b> ((<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>) ||
                (<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#ea8105287b8c6b25" class="i field">RestrictedLanguage</a>))
            {
                <b>throw</b> <a href="lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <b>null</b>, <span class="s">&quot;VariableReferenceNotSupportedInDataSection&quot;</span>,
                    <span class="i">ParserStrings</span>.<span class="i">VariableReferenceNotSupportedInDataSection</span>,
                    <span class="i">ParserStrings</span>.<span class="i">DefaultAllowedVariablesInDataSection</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Append an error to the ErrorVariable if specified, and also to $ERROR.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Exception or ErrorRecord.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> (An error occurred working with the error variable or $ERROR.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="877f409b69c044ab" href="../R/877f409b69c044ab.html" target="n" data-glyph="74,1" class="i method">AppendErrorToVariables</a>(<b>object</b> <span id="r101 rd" class="r101 r">obj</span>)
        {
            <b>if</b> (<span class="r101 r">obj</span> == <b>null</b>)
                <b>return</b>;
 
            <a href="#2170fedd62dc84fc" class="i method">AppendDollarError</a>(<span class="r101 r">obj</span>);
 
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#d6190ce9334ba83f" class="i method">AppendVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#fc0efe5038263e2e" class="i field">Error</a>, <span class="r101 r">obj</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Appends the object to $global:error.  Non-terminating errors</span>
        <span class="c">///</span><span class="c"> are always added (even if they are redirected to another</span>
        <span class="c">///</span><span class="c"> Cmdlet), but terminating errors are only added if they are</span>
        <span class="c">///</span><span class="c"> at the top-level scope (the LocalPipeline scope).</span>
        <span class="c">///</span><span class="c"> We insert at position 0 and delete from position 63.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorRecord or Exception to be written to $global:error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An error occurred accessing $ERROR.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2170fedd62dc84fc" href="../R/2170fedd62dc84fc.html" target="n" data-glyph="76,1" class="i method">AppendDollarError</a>(<b>object</b> <span id="r102 rd" class="r102 r">obj</span>)
        {
            <b>if</b> (<span class="r102 r">obj</span> <b>is</b> <span class="i">Exception</span>)
            {
                <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a> == <b>null</b> || !<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#782af2a0c84b2e7f" class="i property">TopLevel</a>)
                    <b>return</b>; <span class="c">// not outermost scope</span>
            }
 
            <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d09d68410776a624" class="i method">AppendDollarError</a>(<span class="r102 r">obj</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Error PSVariable
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Warning PSVariable
        <b>private</b> <span class="i">IList</span> <a id="741a37a0daa34dd8" href="../R/741a37a0daa34dd8.html" target="n" data-glyph="46,1" class="i field">_warningVarList</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WarningVariable tells which variable to populate with the warnings.</span>
        <span class="c">///</span><span class="c"> Use +varname to append to the variable rather than clearing it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3c116af22745fbdb" href="../R/3c116af22745fbdb.html" target="n" data-glyph="104,1" class="i property">WarningVariable</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal void</b> <a id="13c05bf53bab11fc" href="../R/13c05bf53bab11fc.html" target="n" data-glyph="74,1" class="i method">SetupWarningVariable</a>()
        {
            <a href="#af4d48ce703cfd06" class="i method">SetupVariable</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#5cc4786026261f99" class="i field">Warning</a>, <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#3c116af22745fbdb" class="i property">WarningVariable</a>, <b>ref</b> <a href="#741a37a0daa34dd8" class="i field">_warningVarList</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Append a warning to WarningVariable if specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The warning message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="de3ae6bdea260603" href="../R/de3ae6bdea260603.html" target="n" data-glyph="74,1" class="i method">AppendWarningVarList</a>(<b>object</b> <span id="r103 rd" class="r103 r">obj</span>)
        {
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#d6190ce9334ba83f" class="i method">AppendVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#5cc4786026261f99" class="i field">Warning</a>, <span class="r103 r">obj</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Warning PSVariable
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Information PSVariable
        <b>private</b> <span class="i">IList</span> <a id="7f5e049a057189ef" href="../R/7f5e049a057189ef.html" target="n" data-glyph="46,1" class="i field">_informationVarList</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InformationVariable tells which variable to populate with informational output.</span>
        <span class="c">///</span><span class="c"> Use +varname to append to the variable rather than clearing it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="18b55014aa2ddaf0" href="../R/18b55014aa2ddaf0.html" target="n" data-glyph="104,1" class="i property">InformationVariable</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal void</b> <a id="49ba861a91a757c4" href="../R/49ba861a91a757c4.html" target="n" data-glyph="74,1" class="i method">SetupInformationVariable</a>()
        {
            <a href="#af4d48ce703cfd06" class="i method">SetupVariable</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#4dd342fbd3639cab" class="i field">Information</a>, <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#18b55014aa2ddaf0" class="i property">InformationVariable</a>, <b>ref</b> <a href="#7f5e049a057189ef" class="i field">_informationVarList</a>);
        }
 
        <b>internal void</b> <a id="af4d48ce703cfd06" href="../R/af4d48ce703cfd06.html" target="n" data-glyph="74,1" class="i method">SetupVariable</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a> <span id="r104 rd" class="r104 r">streamKind</span>, <b>string</b> <span id="r105 rd" class="r105 r">variableName</span>, <b>ref</b> <span class="i">IList</span> <span id="r106 rd" class="r106 r">varList</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r105 r">variableName</span>))
            {
                <b>return</b>;
            }
 
            <a href="#18078011300dd272" class="i method">EnsureVariableParameterAllowed</a>();
 
            <b>if</b> (<a href="#a8013d10b683bea8" class="i field">_state</a> == <b>null</b>)
                <a href="#a8013d10b683bea8" class="i field">_state</a> = <b>new</b> <a href="SessionStatePublic.cs.html#45f5fbc7afc57ae4" class="t constructor">SessionState</a>(<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
 
            <b>if</b> (<span class="r105 r">variableName</span>.<span class="i">StartsWith</span>(<span class="s">&#39;+&#39;</span>))
            {
                <span class="r105 r">variableName</span> = <span class="r105 r">variableName</span>.<span class="i">Substring</span>(1);
                <b>object</b> <span id="r107 rd" class="r107 r">oldValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#20b9dd22f81d2a1c" class="i method">GetValue</a>(<span class="r105 r">variableName</span>));
                <span class="r106 r">varList</span> = <span class="r107 r">oldValue</span> <b>as</b> <span class="i">IList</span>;
                <b>if</b> (<span class="r106 r">varList</span> == <b>null</b>)
                {
                    <span class="r106 r">varList</span> = <b>new</b> <span class="i">ArrayList</span>();
 
                    <b>if</b> (<span class="r107 r">oldValue</span> != <b>null</b> &amp;&amp; <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a> != <span class="r107 r">oldValue</span>)
                    {
                        <span class="i">IEnumerable</span> <span id="r108 rd" class="r108 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r107 r">oldValue</span>);
                        <b>if</b> (<span class="r108 r">enumerable</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>object</b> <span id="r109 rd" class="r109 r">o</span> <b>in</b> <span class="r108 r">enumerable</span>)
                            {
                                <span class="r106 r">varList</span>.<span class="i">Add</span>(<span class="r109 r">o</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r106 r">varList</span>.<span class="i">Add</span>(<span class="r107 r">oldValue</span>);
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r106 r">varList</span>.<span class="i">IsFixedSize</span>)
                {
                    <span class="i">ArrayList</span> <span id="r110 rd" class="r110 r">varListNew</span> = <b>new</b> <span class="i">ArrayList</span>();
                    <span class="r110 r">varListNew</span>.<span class="i">AddRange</span>(<span class="r106 r">varList</span>);
                    <span class="r106 r">varList</span> = <span class="r110 r">varListNew</span>;
                }
            }
            <b>else</b>
            {
                <span class="r106 r">varList</span> = <b>new</b> <span class="i">ArrayList</span>();
            }
 
            <b>if</b> (<a href="#64fec126736a688e" class="i field">_thisCommand</a> <b>is not</b> <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<span class="r104 r">streamKind</span>, <span class="r106 r">varList</span>);
            }
 
            <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<span class="i">Set</span>(<span class="r105 r">variableName</span>, <span class="r106 r">varList</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Append a Information to InformationVariable if specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Information message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="a82ea53628bf9b17" href="../R/a82ea53628bf9b17.html" target="n" data-glyph="74,1" class="i method">AppendInformationVarList</a>(<b>object</b> <span id="r111 rd" class="r111 r">obj</span>)
        {
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#d6190ce9334ba83f" class="i method">AppendVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#4dd342fbd3639cab" class="i field">Information</a>, <span class="r111 r">obj</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Information PSVariable
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Write
        <b>internal bool</b> <a id="9b14840835f03a53" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">UseSecurityContextRun</a> = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an object to the output pipe, skipping the ThrowIfWriteNotPermitted check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to write to the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="393b6749b38e4c96" href="../R/393b6749b38e4c96.html" target="n" data-glyph="74,1" class="i method">_WriteObjectSkipAllowCheck</a>(<b>object</b> <span id="r112 rd" class="r112 r">sendToPipeline</span>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <b>if</b> (<a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a> == <span class="r112 r">sendToPipeline</span>)
                <b>return</b>;
 
            <span class="r112 r">sendToPipeline</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#e9d9a7d7ec7be239" class="i method">AsPSObjectOrNull</a>(<span class="r112 r">sendToPipeline</span>);
 
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#f66ebe5942cdceab" class="i method">Add</a>(<span class="r112 r">sendToPipeline</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerates and writes an object to the output pipe, skipping the ThrowIfWriteNotPermitted check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to enumerate and write to the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="bd3a45a06ef86fc3" href="../R/bd3a45a06ef86fc3.html" target="n" data-glyph="74,1" class="i method">_EnumerateAndWriteObjectSkipAllowCheck</a>(<b>object</b> <span id="r113 rd" class="r113 r">sendToPipeline</span>)
        {
            <span class="i">IEnumerable</span> <span id="r114 rd" class="r114 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r113 r">sendToPipeline</span>);
            <b>if</b> (<span class="r114 r">enumerable</span> == <b>null</b>)
            {
                <a href="#393b6749b38e4c96" class="i method">_WriteObjectSkipAllowCheck</a>(<span class="r113 r">sendToPipeline</span>);
                <b>return</b>;
            }
 
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <span class="i">ArrayList</span> <span id="r115 rd" class="r115 r">convertedList</span> = <b>new</b> <span class="i">ArrayList</span>();
            <b>foreach</b> (<b>object</b> <span id="r116 rd" class="r116 r">toConvert</span> <b>in</b> <span class="r114 r">enumerable</span>)
            {
                <b>if</b> (<a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a> == <span class="r116 r">toConvert</span>)
                {
                    <b>continue</b>;
                }
 
                <b>object</b> <span id="r117 rd" class="r117 r">converted</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#e9d9a7d7ec7be239" class="i method">AsPSObjectOrNull</a>(<span class="r116 r">toConvert</span>);
                <span class="r115 r">convertedList</span>.<span class="i">Add</span>(<span class="r117 r">converted</span>);
            }
 
            <span class="c">// Writing normal output with &quot;2&gt;&amp;1&quot;</span>
            <span class="c">// bypasses ErrorActionPreference, as intended.</span>
            <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<span class="i">AddItems</span>(<span class="r115 r">convertedList</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Write
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WriteError
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal variant: Writes the specified error to the error pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do not call WriteError(e.ErrorRecord).</span>
        <span class="c">///</span><span class="c"> The ErrorRecord contained in the ErrorRecord property of</span>
        <span class="c">///</span><span class="c"> an exception which implements IContainsErrorRecord</span>
        <span class="c">///</span><span class="c"> should not be passed directly to WriteError, since it contains</span>
        <span class="c">///</span><span class="c"> a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> rather than the real exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> terminates the command, where</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> allows the command to continue.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9b9a1a457a8a5f1a" href="../R/9b9a1a457a8a5f1a.html" target="n" data-glyph="72,1" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r118 rd" class="r118 r">errorRecord</span>)
        {
            <a href="#21697ad8aff3f0c5" class="i method">WriteError</a>(<span class="r118 r">errorRecord</span>, <b>false</b>);
        }
 
        <b>internal void</b> <a id="21697ad8aff3f0c5" href="../R/21697ad8aff3f0c5.html" target="n" data-glyph="74,1" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r119 rd" class="r119 r">errorRecord</span>, <b>bool</b> <span id="r120 rd" class="r120 r">overrideInquire</span>)
        {
            <span class="c">// This check will be repeated in _WriteErrorSkipAllowCheck,</span>
            <span class="c">// but we want PipelineStoppedException to take precedence</span>
            <span class="c">// over InvalidOperationException if the pipeline has been</span>
            <span class="c">// closed.</span>
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r121 rd" class="r121 r">preference</span> = <a href="#0135181adbe24516" class="i property">ErrorAction</a>;
            <b>if</b> (<span class="r120 r">overrideInquire</span> &amp;&amp; <span class="r121 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>)
            {
                <span class="r121 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
            }
 
            <span class="c">// Break into the debugger if requested</span>
            <b>if</b> (<span class="r121 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>)
            {
                <a href="#bf2192101a5df610" class="i field">CBhost</a>?.<a href="hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>?.<a href="hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>?.<a href="debugger/debugger.cs.html#98454a0ebb421f34" class="i method">Break</a>(<span class="r119 r">errorRecord</span>);
            }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">CORECLR</span>
            <span class="c">// SecurityContext is not supported in CoreCLR</span>
            <span class="i">DoWriteError</span>(<b>new</b> <span class="i">KeyValuePair</span>&lt;<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>, <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>&gt;(<span class="r119 r">errorRecord</span>, <span class="r121 r">preference</span>));
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">            if (UseSecurityContextRun)
            {
                if (PipelineProcessor == null || PipelineProcessor.SecurityContext == null)
                    throw PSTraceSource.NewInvalidOperationException(PipelineStrings.WriteNotPermitted);
                ContextCallback delegateCallback =
                    new ContextCallback(DoWriteError);
 
                SecurityContext.Run(
                    PipelineProcessor.SecurityContext.CreateCopy(),
                    delegateCallback,
                    new KeyValuePair&lt;ErrorRecord, ActionPreference&gt;(errorRecord, preference));
            }
            else
            {
                DoWriteError(new KeyValuePair&lt;ErrorRecord, ActionPreference&gt;(errorRecord, preference));
            }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0108192c436087aa" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DoWriteError</a>(<b>object</b> <span id="r122 rd" class="r122 r">obj</span>)
        {
            <span class="i">KeyValuePair</span>&lt;<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>, <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>&gt; <span id="r123 rd" class="r123 r">pair</span> = (<span class="i">KeyValuePair</span>&lt;<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>, <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>&gt;)<span class="r122 r">obj</span>;
            <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r124 rd" class="r124 r">errorRecord</span> = <span class="r123 r">pair</span>.<span class="i">Key</span>;
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r125 rd" class="r125 r">preference</span> = <span class="r123 r">pair</span>.<span class="i">Value</span>;
            <b>if</b> (<span class="r124 r">errorRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;errorRecord&quot;</span>);
            }
 
            <span class="c">// If this error came from a transacted cmdlet,</span>
            <span class="c">// rollback the transaction</span>
            <b>if</b> (<a href="#84be5d945a0edf7b" class="i property">UseTransaction</a>)
            {
                <b>if</b> (
                   (<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#5e3b48ff3edf5b68" class="i property">RollbackPreference</a> != <a href="../CoreCLR/CorePsStub.cs.html#093dd53b7c8e0582" class="t t">RollbackSeverity</a>.<a href="../CoreCLR/CorePsStub.cs.html#d71031d86dd999ff" class="i field">TerminatingError</a>) &amp;&amp;
                   (<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#5e3b48ff3edf5b68" class="i property">RollbackPreference</a> != <a href="../CoreCLR/CorePsStub.cs.html#093dd53b7c8e0582" class="t t">RollbackSeverity</a>.<a href="../CoreCLR/CorePsStub.cs.html#84ea7205031b0ba6" class="i field">Never</a>))
                {
                    <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#c002f17dda3f7e78" class="i method">Rollback</a>(<b>true</b>);
                }
            }
 
            <span class="c">// 2005/07/14-913791 &quot;write-error output is confusing and misleading&quot;</span>
            <span class="c">// set InvocationInfo to the script not the command</span>
            <b>if</b> (<span class="r124 r">errorRecord</span>.<a href="ErrorPackage.cs.html#b119c9996bde5b66" class="i property">PreserveInvocationInfoOnce</a>)
                <span class="r124 r">errorRecord</span>.<a href="ErrorPackage.cs.html#b119c9996bde5b66" class="i property">PreserveInvocationInfoOnce</a> = <b>false</b>;
            <b>else</b>
                <span class="r124 r">errorRecord</span>.<a href="ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<a href="#414274318fb6cbe1" class="i property">MyInvocation</a>);
 
            <span class="c">// NOTICE-2004/06/08-JonN 959638</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>true</b>);
 
            <a href="#f530015bdc5f7e2d" class="i method">_WriteErrorSkipAllowCheck</a>(<span class="r124 r">errorRecord</span>, <span class="r125 r">preference</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write an error, skipping the ThrowIfWriteNotPermitted check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error record to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">actionPreference</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The configured error action preference.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">isFromNativeStdError</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when this method is called to write from a native command&#39;s stderr stream.</span>
        <span class="c">///</span><span class="c"> When errors are written through a native stderr stream, they do not interact with the error preference system,</span>
        <span class="c">///</span><span class="c"> but must still present as errors in PowerShell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f530015bdc5f7e2d" href="../R/f530015bdc5f7e2d.html" target="n" data-glyph="74,1" class="i method">_WriteErrorSkipAllowCheck</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r126 rd" class="r126 r">errorRecord</span>, <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>? <span id="r127 rd" class="r127 r">actionPreference</span> = <b>null</b>, <b>bool</b> <span id="r128 rd" class="r128 r">isFromNativeStdError</span> = <b>false</b>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <b>if</b> (<span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b>
                &amp;&amp; <span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> != <b>null</b>)
            {
                <span class="i">Exception</span> <span id="r129 rd" class="r129 r">textLookupError</span> = <span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a>;
                <span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> = <b>null</b>;
                <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#1b469b122e173e0c" class="i method">LogCommandHealthEvent</a>(
                    <a href="#ef96008a8ef9962a" class="i property">Context</a>,
                    <span class="r129 r">textLookupError</span>,
                    <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
            }
 
            <b>if</b> (<a href="#10aa6c1ae5d83a77" class="i property">LogPipelineExecutionDetail</a>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#6256b8c3a6666edf" class="i method">LogExecutionError</a>(<a href="#64fec126736a688e" class="i field">_thisCommand</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>, <span class="r126 r">errorRecord</span>);
            }
 
            <b>if</b> (!<span class="r128 r">isFromNativeStdError</span>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#895cb9f77d1d9539" class="i property">PipelineProcessor</a>.<a href="pipeline.cs.html#813a2622f5f1116c" class="i property">ExecutionFailed</a> = <b>true</b>;
 
                <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r130 rd" class="r130 r">preference</span> = <a href="#0135181adbe24516" class="i property">ErrorAction</a>;
                <b>if</b> (<span class="r127 r">actionPreference</span>.<span class="i">HasValue</span>)
                {
                    <span class="r130 r">preference</span> = <span class="r127 r">actionPreference</span>.<span class="i">Value</span>;
                }
 
                <span class="c">// No trace of the error in the &#39;Ignore&#39; case</span>
                <b>if</b> (<span class="r130 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e7eef70977370b56" class="i field">Ignore</a>)
                {
                    <b>return</b>; <span class="c">// do not write or record to output pipe</span>
                }
 
                <span class="c">// 2004/05/26-JonN</span>
                <span class="c">// The object is not written in the SilentlyContinue case</span>
                <b>if</b> (<span class="r130 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>)
                {
                    <a href="#877f409b69c044ab" class="i method">AppendErrorToVariables</a>(<span class="r126 r">errorRecord</span>);
                    <b>return</b>; <span class="c">// do not write to output pipe</span>
                }
 
                <b>if</b> (<a href="#bd8b8348b5160a45" class="i field">lastErrorContinueStatus</a> == <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>)
                {
                    <span class="r130 r">preference</span> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
                }
 
                <b>switch</b> (<span class="r130 r">preference</span>)
                {
                    <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83fefb47b3abc4e7" class="i field">Stop</a>:
                        <a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a> <span id="r131 rd" class="r131 r">e</span> =
                            <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#6ca2b39887d2ac82" class="t constructor">ActionPreferenceStopException</a>(
                                <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>,
                                <span class="r126 r">errorRecord</span>,
                                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ErrorPreferenceStop</span>,
                                                <span class="s">&quot;ErrorActionPreference&quot;</span>,
                                                <span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#cab659be098926dd" class="i method">ToString</a>()));
                        <b>throw</b> <span class="i">ManageException</span>(<span class="r131 r">e</span>);
 
                    <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>:
                        <span class="c">// ignore return value</span>
                        <span class="c">// this will throw if the user chooses not to continue</span>
                        <a href="#bd8b8348b5160a45" class="i field">lastErrorContinueStatus</a> = <a href="#6c0c629fc04b03c2" class="i method">InquireHelper</a>(
                            <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>.<a href="../utils/RuntimeException.cs.html#132c76a836516185" class="i method">RetrieveMessage</a>(<span class="r126 r">errorRecord</span>),
                            <b>null</b>,
                            <b>true</b>,  <span class="c">// allowYesToAll</span>
                            <b>false</b>, <span class="c">// allowNoToAll</span>
                            <b>true</b>,  <span class="c">// replaceNoWithHalt</span>
                            <b>false</b>  <span class="c">// hasSecurityImpact</span>
                        );
                        <b>break</b>;
                }
 
                <a href="#877f409b69c044ab" class="i method">AppendErrorToVariables</a>(<span class="r126 r">errorRecord</span>);
            }
 
            <span class="c">// Add this note property and set its value to true for F&amp;O</span>
            <span class="c">// to decide whether to call WriteErrorLine or WriteLine.</span>
            <span class="c">// We want errors to print in red in both cases.</span>
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r132 rd" class="r132 r">errorWrap</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r126 r">errorRecord</span>);
            <span class="c">// It&#39;s possible we&#39;ve already added the member (this method is recursive sometimes</span>
            <span class="c">// when tracing), so don&#39;t add the member again.</span>
 
            <span class="c">// We don&#39;t add a note property on messages that comes from stderr stream.</span>
            <b>if</b> (!<span class="r128 r">isFromNativeStdError</span>)
            {
                <span class="r132 r">errorWrap</span>.<a href="MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a>.<a href="MshObject.cs.html#af472c29dba3fb51" class="i field">Error</a>;
            }
 
            <span class="c">// 2003/11/19-JonN Previously, PSObject instances in ErrorOutputPipe</span>
            <span class="c">// wrapped the TargetObject and held the CoreException as a note.</span>
            <span class="c">// Now, they wrap the CoreException and hold the TargetObject as a note.</span>
            <b>if</b> (<a href="#ed59e3b00feab7b1" class="i property">ErrorMergeTo</a> != <a href="#8b0e9f05387e62ca" class="t t">MergeDataStream</a>.<a href="#bc5ddd48254cc0ca" class="i field">None</a>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#ed59e3b00feab7b1" class="i property">ErrorMergeTo</a> == <a href="#8b0e9f05387e62ca" class="t t">MergeDataStream</a>.<a href="#8ab59ea31f703b82" class="i field">Output</a>, <span class="s">&quot;Only merging to success output is supported.&quot;</span>);
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#d32c1d6bc732e4c3" class="i method">AddWithoutAppendingOutVarList</a>(<span class="r132 r">errorWrap</span>);
            }
            <b>else</b>
            {
                <span class="c">// If this is an error pipe for a hosting application and we are logging,</span>
                <span class="c">// then create a temporary PowerShell to log the error.</span>
                <b>if</b> (<a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#6694b338e46fdead" class="i property">IsTranscribing</a>)
                {
                    <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#c83a8ec1928e56c7" class="i method">TranscribeError</a>(<a href="#ef96008a8ef9962a" class="i property">Context</a>, <span class="r126 r">errorRecord</span>.<a href="ErrorPackage.cs.html#fd1ac7b3462d4426" class="i property">InvocationInfo</a>, <span class="r132 r">errorWrap</span>);
                }
 
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#8cfabd8908a77f92" class="i property">ErrorOutputPipe</a>.<a href="Pipe.cs.html#d32c1d6bc732e4c3" class="i method">AddWithoutAppendingOutVarList</a>(<span class="r132 r">errorWrap</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> WriteError
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Preference
 
        <span class="c">// These are a set of preference variables which affect the inner</span>
        <span class="c">// workings of the command and when what information will get output.</span>
        <span class="c">// See &quot;User Feedback Mechanisms - Note.doc&quot; for details.</span>
 
        <b>private bool</b> <a id="7629886967dae81d" href="../R/7629886967dae81d.html" target="n" data-glyph="46,1" class="i field">_isConfirmPreferenceCached</a> = <b>false</b>;
        <b>private</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <a id="172d654f17e4119c" href="../R/172d654f17e4119c.html" target="n" data-glyph="46,1" class="i field">_confirmPreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#48990b5efe099274" class="i field">DefaultConfirmPreference</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting controlling behavior of ShouldProcess()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is not an independent parameter, it just emerges from the</span>
        <span class="c">///</span><span class="c"> Verbose, Debug, Confirm, and WhatIf parameters and the</span>
        <span class="c">///</span><span class="c"> $ConfirmPreference shell variable.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> We only read $ConfirmPreference once, then cache the value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <a id="6268f99d5f6310de" href="../R/6268f99d5f6310de.html" target="n" data-glyph="104,1" class="i property">ConfirmPreference</a>
        {
            <b>get</b>
            {
                <span class="c">// WhatIf not relevant, it never gets this far in that case</span>
                <b>if</b> (<a href="#80b115f7d2831129" class="i property">Confirm</a>)
                    <b>return</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#9bb946a0731a8a9e" class="i field">Low</a>;
                <b>if</b> (<a href="#9af4a240e58b55ef" class="i property">Debug</a>)
                {
                    <b>if</b> (<a href="#e98e9c7743290b43" class="i property">IsConfirmFlagSet</a>) <span class="c">// -Debug -Confirm:$false</span>
                        <b>return</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#5b2b0bf78675f285" class="i field">None</a>;
                    <b>return</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#9bb946a0731a8a9e" class="i field">Low</a>;
                }
 
                <b>if</b> (<a href="#e98e9c7743290b43" class="i property">IsConfirmFlagSet</a>) <span class="c">// -Confirm:$false</span>
                    <b>return</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#5b2b0bf78675f285" class="i field">None</a>;
 
                <b>if</b> (!<a href="#7629886967dae81d" class="i field">_isConfirmPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r133 rd" class="r133 r">defaultUsed</span> = <b>false</b>;
                    <a href="#172d654f17e4119c" class="i field">_confirmPreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#be9a95eb1f87eef7" class="i field">ConfirmPreferenceVarPath</a>, <a href="#172d654f17e4119c" class="i field">_confirmPreference</a>, <b>out</b> <span class="r133 r">defaultUsed</span>);
                    <a href="#7629886967dae81d" class="i field">_isConfirmPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#172d654f17e4119c" class="i field">_confirmPreference</a>;
            }
        }
 
        <b>private bool</b> <a id="cf8d9571f7129de0" href="../R/cf8d9571f7129de0.html" target="n" data-glyph="46,1" class="i field">_isDebugPreferenceSet</a> = <b>false</b>;
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="f4256d5b8dbaf359" href="../R/f4256d5b8dbaf359.html" target="n" data-glyph="46,1" class="i field">_debugPreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#b71dc68e025852e1" class="i field">DefaultDebugPreference</a>;
        <b>private bool</b> <a id="ea838998f1ff6863" href="../R/ea838998f1ff6863.html" target="n" data-glyph="46,1" class="i field">_isDebugPreferenceCached</a> = <b>false</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> (get-only) An error occurred accessing $DebugPreference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="cc68451ddea82b1e" href="../R/cc68451ddea82b1e.html" target="n" data-glyph="104,1" class="i property">DebugPreference</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#cf8d9571f7129de0" class="i field">_isDebugPreferenceSet</a>)
                {
                    <b>return</b> <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a>;
                }
 
                <b>if</b> (<a href="#282d7ae011f39952" class="i property">IsDebugFlagSet</a>)
                {
                    <b>return</b> <a href="#9af4a240e58b55ef" class="i property">Debug</a> ? <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a> : <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>;
                }
 
                <b>if</b> (!<a href="#ea838998f1ff6863" class="i field">_isDebugPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r134 rd" class="r134 r">defaultUsed</span> = <b>false</b>;
 
                    <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#55e5d3a56318ad74" class="i field">DebugPreferenceVarPath</a>, <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a>, <b>out</b> <span class="r134 r">defaultUsed</span>);
 
                    <span class="c">// If the host couldn&#39;t prompt for the debug action anyways, change it to &#39;Continue&#39;.</span>
                    <span class="c">// This lets hosts still see debug output without having to implement the prompting logic.</span>
                    <b>if</b> ((<a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>) &amp;&amp; (<a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>))
                    {
                        <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
                    }
 
                    <a href="#ea838998f1ff6863" class="i field">_isDebugPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">ErrorPackage</span>.<span class="i">ActionPreferenceReservedForFutureUseError</span>, <b>value</b>);
                }
 
                <a href="#f4256d5b8dbaf359" class="i field">_debugPreference</a> = <b>value</b>;
                <a href="#cf8d9571f7129de0" class="i field">_isDebugPreferenceSet</a> = <b>true</b>;
            }
        }
 
        <b>private readonly bool</b> <a id="fd0f10690b689c39" href="../R/fd0f10690b689c39.html" target="n" data-glyph="46,1" class="i field">_isVerbosePreferenceCached</a> = <b>false</b>;
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="ff0b0cb3d39f98f2" href="../R/ff0b0cb3d39f98f2.html" target="n" data-glyph="46,1" class="i field">_verbosePreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#bffa8c5f990b643d" class="i field">DefaultVerbosePreference</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An error occurred accessing $VerbosePreference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="04803c68d94269cc" href="../R/04803c68d94269cc.html" target="n" data-glyph="104,1" class="i property">VerbosePreference</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#1e78c373b00f9e54" class="i property">IsVerboseFlagSet</a>)
                {
                    <b>if</b> (<a href="#e4eb8be94a708a06" class="i property">Verbose</a>)
                        <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
                    <b>else</b>
                        <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>;
                }
 
                <b>if</b> (<a href="#9af4a240e58b55ef" class="i property">Debug</a>)
                {
                    <span class="c">// If the host couldn&#39;t prompt for the debug action anyways, use &#39;Continue&#39;.</span>
                    <span class="c">// This lets hosts still see debug output without having to implement the prompting logic.</span>
                    <b>if</b> (<a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a> == <b>null</b>)
                    {
                        <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
                    }
                    <b>else</b>
                    {
                        <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>;
                    }
                }
 
                <b>if</b> (!<a href="#fd0f10690b689c39" class="i field">_isVerbosePreferenceCached</a>)
                {
                    <b>bool</b> <span id="r135 rd" class="r135 r">defaultUsed</span> = <b>false</b>;
                    <a href="#ff0b0cb3d39f98f2" class="i field">_verbosePreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                        <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#4f336924853bb007" class="i field">VerbosePreferenceVarPath</a>,
                        <a href="#ff0b0cb3d39f98f2" class="i field">_verbosePreference</a>,
                        <b>out</b> <span class="r135 r">defaultUsed</span>);
                }
 
                <b>return</b> <a href="#ff0b0cb3d39f98f2" class="i field">_verbosePreference</a>;
            }
        }
 
        <b>internal bool</b> <a id="341d7d562b4842c8" href="../R/341d7d562b4842c8.html" target="n" data-glyph="104,1" class="i property">IsWarningActionSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <b>private readonly bool</b> <a id="b1a6144f524c46f3" href="../R/b1a6144f524c46f3.html" target="n" data-glyph="46,1" class="i field">_isWarningPreferenceCached</a> = <b>false</b>;
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="3d13e5d7f8bdaf31" href="../R/3d13e5d7f8bdaf31.html" target="n" data-glyph="46,1" class="i field">_warningPreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#ce925c70ad875bb8" class="i field">DefaultWarningPreference</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An error occurred accessing $WarningPreference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="b12b6c5f70c4f2b1" href="../R/b12b6c5f70c4f2b1.html" target="n" data-glyph="104,1" class="i property">WarningPreference</a>
        {
            <b>get</b>
            {
                <span class="c">// Setting CommonParameters.WarningAction has highest priority</span>
                <b>if</b> (<a href="#341d7d562b4842c8" class="i property">IsWarningActionSet</a>)
                    <b>return</b> <a href="#3d13e5d7f8bdaf31" class="i field">_warningPreference</a>;
 
                <b>if</b> (<a href="#9af4a240e58b55ef" class="i property">Debug</a>)
                    <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>;
                <b>if</b> (<a href="#e4eb8be94a708a06" class="i property">Verbose</a>)
                    <b>return</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
                <span class="c">// Debug:$false and Verbose:$false ignored</span>
 
                <b>if</b> (!<a href="#b1a6144f524c46f3" class="i field">_isWarningPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r136 rd" class="r136 r">defaultUsed</span> = <b>false</b>;
                    <a href="#3d13e5d7f8bdaf31" class="i field">_warningPreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#b2fbcbd4ab894191" class="i field">WarningPreferenceVarPath</a>, <a href="#3d13e5d7f8bdaf31" class="i field">_warningPreference</a>, <b>out</b> <span class="r136 r">defaultUsed</span>);
                }
 
                <b>return</b> <a href="#3d13e5d7f8bdaf31" class="i field">_warningPreference</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">ErrorPackage</span>.<span class="i">ActionPreferenceReservedForFutureUseError</span>, <b>value</b>);
                }
 
                <a href="#3d13e5d7f8bdaf31" class="i field">_warningPreference</a> = <b>value</b>;
                <a href="#341d7d562b4842c8" class="i property">IsWarningActionSet</a> = <b>true</b>;
            }
        }
 
        <span class="c">// This is used so that people can tell whether the verbose switch</span>
        <span class="c">// was specified.  This is useful in the Cmdlet-calling-Cmdlet case</span>
        <span class="c">// where you&#39;d like the underlying Cmdlet to have the same switches.</span>
        <b>private bool</b> <a id="4bdc8556bf1723ea" href="../R/4bdc8556bf1723ea.html" target="n" data-glyph="46,1" class="i field">_verboseFlag</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Echo tells the command to articulate the actions it performs while executing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="e4eb8be94a708a06" href="../R/e4eb8be94a708a06.html" target="n" data-glyph="104,1" class="i property">Verbose</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4bdc8556bf1723ea" class="i field">_verboseFlag</a>;
            }
 
            <b>set</b>
            {
                <a href="#4bdc8556bf1723ea" class="i field">_verboseFlag</a> = <b>value</b>;
                <a href="#1e78c373b00f9e54" class="i property">IsVerboseFlagSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="1e78c373b00f9e54" href="../R/1e78c373b00f9e54.html" target="n" data-glyph="104,1" class="i property">IsVerboseFlagSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <b>private bool</b> <a id="7d08288fce42f752" href="../R/7d08288fce42f752.html" target="n" data-glyph="46,1" class="i field">_confirmFlag</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm tells the command to ask the admin before performing an action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class ShouldProcessParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="80b115f7d2831129" href="../R/80b115f7d2831129.html" target="n" data-glyph="104,1" class="i property">Confirm</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7d08288fce42f752" class="i field">_confirmFlag</a>;
            }
 
            <b>set</b>
            {
                <a href="#7d08288fce42f752" class="i field">_confirmFlag</a> = <b>value</b>;
                <a href="#e98e9c7743290b43" class="i property">IsConfirmFlagSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="e98e9c7743290b43" href="../R/e98e9c7743290b43.html" target="n" data-glyph="104,1" class="i property">IsConfirmFlagSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <b>private bool</b> <a id="9f78cf9035cd2334" href="../R/9f78cf9035cd2334.html" target="n" data-glyph="46,1" class="i field">_useTransactionFlag</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UseTransaction tells the command to activate the current PowerShell transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class TransactionParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="84be5d945a0edf7b" href="../R/84be5d945a0edf7b.html" target="n" data-glyph="104,1" class="i property">UseTransaction</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9f78cf9035cd2334" class="i field">_useTransactionFlag</a>;
            }
 
            <b>set</b>
            {
                <a href="#9f78cf9035cd2334" class="i field">_useTransactionFlag</a> = <b>value</b>;
                <a href="#5978ff7ea7c57396" class="i property">UseTransactionFlagSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="5978ff7ea7c57396" href="../R/5978ff7ea7c57396.html" target="n" data-glyph="104,1" class="i property">UseTransactionFlagSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <span class="c">// This is used so that people can tell whether the debug switch was specified.  This</span>
        <span class="c">// Is useful in the Cmdlet-calling-Cmdlet case where you&#39;d like the underlying Cmdlet to</span>
        <span class="c">// have the same switches.</span>
        <b>private bool</b> <a id="024fd4f761ed4e7c" href="../R/024fd4f761ed4e7c.html" target="n" data-glyph="46,1" class="i field">_debugFlag</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Debug tell the command system to provide Programmer/Support type messages to understand what is really occuring</span>
        <span class="c">///</span><span class="c"> and give the user the opportunity to stop or debug the situation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9af4a240e58b55ef" href="../R/9af4a240e58b55ef.html" target="n" data-glyph="104,1" class="i property">Debug</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#024fd4f761ed4e7c" class="i field">_debugFlag</a>;
            }
 
            <b>set</b>
            {
                <a href="#024fd4f761ed4e7c" class="i field">_debugFlag</a> = <b>value</b>;
                <a href="#282d7ae011f39952" class="i property">IsDebugFlagSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="282d7ae011f39952" href="../R/282d7ae011f39952.html" target="n" data-glyph="104,1" class="i property">IsDebugFlagSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <b>private bool</b> <a id="411ab96a68cac42a" href="../R/411ab96a68cac42a.html" target="n" data-glyph="46,1" class="i field">_whatIfFlag</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#929c3d342e2d5118" class="i field">DefaultWhatIfPreference</a>;
        <b>private bool</b> <a id="b5c4ca6a5aa0eafb" href="../R/b5c4ca6a5aa0eafb.html" target="n" data-glyph="46,1" class="i field">_isWhatIfPreferenceCached</a> <span class="c">/* = false */</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WhatIf indicates that the command should not</span>
        <span class="c">///</span><span class="c"> perform any changes to persistent state outside Monad.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class ShouldProcessParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="bbd763fc28e57d9a" href="../R/bbd763fc28e57d9a.html" target="n" data-glyph="104,1" class="i property">WhatIf</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<a href="#69835be1216947c1" class="i property">IsWhatIfFlagSet</a> &amp;&amp; !<a href="#b5c4ca6a5aa0eafb" class="i field">_isWhatIfPreferenceCached</a>)
                {
                    <a href="#411ab96a68cac42a" class="i field">_whatIfFlag</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#0aa14c6ccdb7807d" class="i method">GetBooleanPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#5d67e100af05cd0e" class="i field">WhatIfPreferenceVarPath</a>, <a href="#411ab96a68cac42a" class="i field">_whatIfFlag</a>, <b>out _</b>);
                    <a href="#b5c4ca6a5aa0eafb" class="i field">_isWhatIfPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#411ab96a68cac42a" class="i field">_whatIfFlag</a>;
            }
 
            <b>set</b>
            {
                <a href="#411ab96a68cac42a" class="i field">_whatIfFlag</a> = <b>value</b>;
                <a href="#69835be1216947c1" class="i property">IsWhatIfFlagSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="69835be1216947c1" href="../R/69835be1216947c1.html" target="n" data-glyph="104,1" class="i property">IsWhatIfFlagSet</a> { <b>get</b>; <b>private set</b>; }
 
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="9daea790d6fb5222" href="../R/9daea790d6fb5222.html" target="n" data-glyph="46,1" class="i field">_errorAction</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#696119533aff8946" class="i field">DefaultErrorActionPreference</a>;
        <b>private bool</b> <a id="f0a96c704fcf4055" href="../R/f0a96c704fcf4055.html" target="n" data-glyph="46,1" class="i field">_isErrorActionPreferenceCached</a> = <b>false</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorAction tells the command what to do when an error occurs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> (get-only) An error occurred accessing $ErrorAction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a common parameter via class CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="0135181adbe24516" href="../R/0135181adbe24516.html" target="n" data-glyph="104,1" class="i property">ErrorAction</a>
        {
            <b>get</b>
            {
                <span class="c">// Setting CommonParameters.ErrorAction has highest priority</span>
                <b>if</b> (<a href="#4e39bf0444feb43b" class="i property">IsErrorActionSet</a>)
                    <b>return</b> <a href="#9daea790d6fb5222" class="i field">_errorAction</a>;
 
                <b>if</b> (!<a href="#f0a96c704fcf4055" class="i field">_isErrorActionPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r137 rd" class="r137 r">defaultUsed</span> = <b>false</b>;
                    <a href="#9daea790d6fb5222" class="i field">_errorAction</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#8f0a1d2bb6fc8f1c" class="i field">ErrorActionPreferenceVarPath</a>, <a href="#9daea790d6fb5222" class="i field">_errorAction</a>, <b>out</b> <span class="r137 r">defaultUsed</span>);
                    <a href="#f0a96c704fcf4055" class="i field">_isErrorActionPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#9daea790d6fb5222" class="i field">_errorAction</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">ErrorPackage</span>.<span class="i">ActionPreferenceReservedForFutureUseError</span>, <b>value</b>);
                }
 
                <a href="#9daea790d6fb5222" class="i field">_errorAction</a> = <b>value</b>;
                <a href="#4e39bf0444feb43b" class="i property">IsErrorActionSet</a> = <b>true</b>;
            }
        }
 
        <b>internal bool</b> <a id="4e39bf0444feb43b" href="../R/4e39bf0444feb43b.html" target="n" data-glyph="104,1" class="i property">IsErrorActionSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting for displaying ProgressRecords when WriteProgress is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="42fe333a1829d07d" href="../R/42fe333a1829d07d.html" target="n" data-glyph="104,1" class="i property">ProgressPreference</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#0a4a974cdc2aba62" class="i field">_isProgressPreferenceSet</a>)
                    <b>return</b> <a href="#2aa213e4da2f26ca" class="i field">_progressPreference</a>;
 
                <b>if</b> (!<a href="#5974ce8b8ab22f5b" class="i field">_isProgressPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r138 rd" class="r138 r">defaultUsed</span> = <b>false</b>;
                    <a href="#2aa213e4da2f26ca" class="i field">_progressPreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#1180638cc2cd85ea" class="i field">ProgressPreferenceVarPath</a>, <a href="#2aa213e4da2f26ca" class="i field">_progressPreference</a>, <b>out</b> <span class="r138 r">defaultUsed</span>);
                    <a href="#5974ce8b8ab22f5b" class="i field">_isProgressPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#2aa213e4da2f26ca" class="i field">_progressPreference</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">ErrorPackage</span>.<span class="i">ActionPreferenceReservedForFutureUseError</span>, <b>value</b>);
                }
 
                <a href="#2aa213e4da2f26ca" class="i field">_progressPreference</a> = <b>value</b>;
                <a href="#0a4a974cdc2aba62" class="i field">_isProgressPreferenceSet</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="2aa213e4da2f26ca" href="../R/2aa213e4da2f26ca.html" target="n" data-glyph="46,1" class="i field">_progressPreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#336c233a9506636d" class="i field">DefaultProgressPreference</a>;
        <b>private bool</b> <a id="0a4a974cdc2aba62" href="../R/0a4a974cdc2aba62.html" target="n" data-glyph="46,1" class="i field">_isProgressPreferenceSet</a> = <b>false</b>;
        <b>private bool</b> <a id="5974ce8b8ab22f5b" href="../R/5974ce8b8ab22f5b.html" target="n" data-glyph="46,1" class="i field">_isProgressPreferenceCached</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preference setting for displaying InformationRecords when WriteInformation is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="8157d9c42d054f98" href="../R/8157d9c42d054f98.html" target="n" data-glyph="104,1" class="i property">InformationPreference</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#c4e3634c2911287d" class="i property">IsInformationActionSet</a>)
                    <b>return</b> <a href="#db4b3630e8a0729a" class="i field">_informationPreference</a>;
 
                <b>if</b> (!<a href="#4666fa831aeb6615" class="i field">_isInformationPreferenceCached</a>)
                {
                    <b>bool</b> <span id="r139 rd" class="r139 r">defaultUsed</span> = <b>false</b>;
                    <a href="#db4b3630e8a0729a" class="i field">_informationPreference</a> = <a href="#ef96008a8ef9962a" class="i property">Context</a>.<a href="ExecutionContext.cs.html#e66ab93387349c55" class="i method">GetEnumPreference</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#793d57f0df2d9a59" class="i field">InformationPreferenceVarPath</a>, <a href="#db4b3630e8a0729a" class="i field">_informationPreference</a>, <b>out</b> <span class="r139 r">defaultUsed</span>);
                    <a href="#4666fa831aeb6615" class="i field">_isInformationPreferenceCached</a> = <b>true</b>;
                }
 
                <b>return</b> <a href="#db4b3630e8a0729a" class="i field">_informationPreference</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">ErrorPackage</span>.<span class="i">ActionPreferenceReservedForFutureUseError</span>, <b>value</b>);
                }
 
                <a href="#db4b3630e8a0729a" class="i field">_informationPreference</a> = <b>value</b>;
                <a href="#c4e3634c2911287d" class="i property">IsInformationActionSet</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="db4b3630e8a0729a" href="../R/db4b3630e8a0729a.html" target="n" data-glyph="46,1" class="i field">_informationPreference</a> = <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#3968cbd8e157630a" class="i field">DefaultInformationPreference</a>;
 
        <b>internal bool</b> <a id="c4e3634c2911287d" href="../R/c4e3634c2911287d.html" target="n" data-glyph="104,1" class="i property">IsInformationActionSet</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <b>private bool</b> <a id="4666fa831aeb6615" href="../R/4666fa831aeb6615.html" target="n" data-glyph="46,1" class="i field">_isInformationPreferenceCached</a> = <b>false</b>;
 
        <b>internal</b> <a href="UserFeedbackParameters.cs.html#19fbf494d8a3adaf" class="t t">PagingParameters</a> <a id="39271ad4c5d379e3" href="../R/39271ad4c5d379e3.html" target="n" data-glyph="104,1" class="i property">PagingParameters</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Preference
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Continue/Confirm
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helpers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ContinueStatus indicates the last reply from the user</span>
        <span class="c">///</span><span class="c"> whether or not the command should process an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="2c1103689ee3f100" href="../R/2c1103689ee3f100.html" target="n" data-glyph="20,1" class="t t"><span id="7a66bd7d094d5795">ContinueStatus</span></a>
        {
            <a id="70a0aa888602277c" href="../R/70a0aa888602277c.html" target="n" data-glyph="24,2" class="i field">Yes</a>,
            <a id="2d8ea5f9b6f86199" href="../R/2d8ea5f9b6f86199.html" target="n" data-glyph="24,2" class="i field">No</a>,
            <a id="ab98f8097f2d9979" href="../R/ab98f8097f2d9979.html" target="n" data-glyph="24,2" class="i field">YesToAll</a>,
            <a id="4d5114672c2a058f" href="../R/4d5114672c2a058f.html" target="n" data-glyph="24,2" class="i field">NoToAll</a>
        }
 
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="6ada5d5719752022" href="../R/6ada5d5719752022.html" target="n" data-glyph="44,1" class="i field">lastShouldProcessContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="bd8b8348b5160a45" href="../R/bd8b8348b5160a45.html" target="n" data-glyph="44,1" class="i field">lastErrorContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="40accafc01e37ecb" href="../R/40accafc01e37ecb.html" target="n" data-glyph="44,1" class="i field">lastDebugContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="103713ef229b5154" href="../R/103713ef229b5154.html" target="n" data-glyph="44,1" class="i field">lastVerboseContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="691efe22866c7a2a" href="../R/691efe22866c7a2a.html" target="n" data-glyph="44,1" class="i field">lastWarningContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="072ae6465bf926af" href="../R/072ae6465bf926af.html" target="n" data-glyph="44,1" class="i field">lastProgressContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="0fe7bf920638e49e" href="../R/0fe7bf920638e49e.html" target="n" data-glyph="44,1" class="i field">lastInformationContinueStatus</a> = <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Should the verbose/debug/progress message be printed?</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">preference</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">lastContinueStatus</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="072937fb54bc15d3" href="../R/072937fb54bc15d3.html" target="n" data-glyph="74,1" class="i method">WriteHelper_ShouldWrite</a>(
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r140 rd" class="r140 r">preference</span>,
            <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <span id="r141 rd" class="r141 r">lastContinueStatus</span>)
        {
            <a href="#ea515a6e1478133b" class="i method">ThrowIfStopping</a>();
 
            <span class="c">// 2005/05/24 908827</span>
            <span class="c">// WriteDebug/WriteVerbose/WriteProgress/WriteWarning should only be callable from the main thread</span>
            <span class="c">//</span>
            <span class="c">// WriteError/WriteObject have a check that prevents them to be called from outside</span>
            <span class="c">// Begin/Process/End. This is done because the Pipeline needs to be ready before these</span>
            <span class="c">// functions can be called.</span>
            <span class="c">//</span>
            <span class="c">// WriteDebug/Warning/Verbose/Process used to do the same check, even though it is not</span>
            <span class="c">// strictly needed. If we ever implement pipelines for these objects we may need to</span>
            <span class="c">// enforce the check again.</span>
            <span class="c">//</span>
            <span class="c">// See bug 583774 in the Windows 7 database for more details.</span>
            <span class="c">//</span>
            <a href="#e50e33c35e4bce4e" class="i method">ThrowIfWriteNotPermitted</a>(<b>false</b>);
 
            <b>switch</b> (<span class="r141 r">lastContinueStatus</span>)
            {
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>:  <span class="c">// previously answered NoToAll</span>
                    <b>return</b> <b>false</b>;
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>: <span class="c">// previously answered YesToAll</span>
                    <b>return</b> <b>true</b>;
            }
 
            <b>switch</b> (<span class="r140 r">preference</span>)
            {
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e7eef70977370b56" class="i field">Ignore</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>:
                    <b>return</b> <b>false</b>;
 
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83fefb47b3abc4e7" class="i field">Stop</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>:
                    <b>return</b> <b>true</b>;
 
                <b>default</b>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Bad preference value&quot;</span> + <span class="r140 r">preference</span>);
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Complete implementation of WriteDebug/WriteVerbose/WriteProgress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">inquireCaption</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">inquireMessage</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">preference</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">lastContinueStatus</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">preferenceVariableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Did Inquire return YesToAll?.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="38b87e47237800fb" href="../R/38b87e47237800fb.html" target="n" data-glyph="74,1" class="i method">WriteHelper</a>(
            <b>string</b> <span id="r142 rd" class="r142 r">inquireCaption</span>,
            <b>string</b> <span id="r143 rd" class="r143 r">inquireMessage</span>,
            <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r144 rd" class="r144 r">preference</span>,
            <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <span id="r145 rd" class="r145 r">lastContinueStatus</span>,
            <b>string</b> <span id="r146 rd" class="r146 r">preferenceVariableName</span>,
            <b>string</b> <span id="r147 rd" class="r147 r">message</span>)
        {
            <b>switch</b> (<span class="r145 r">lastContinueStatus</span>)
            {
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>:  <span class="c">// previously answered NoToAll</span>
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>;
                <b>case</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>: <span class="c">// previously answered YesToAll</span>
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>;
            }
 
            <b>switch</b> (<span class="r144 r">preference</span>)
            {
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e7eef70977370b56" class="i field">Ignore</a>: <span class="c">// YesToAll</span>
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>:
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#9aa56fcd5aaa3137" class="i field">Break</a>:
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
 
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83fefb47b3abc4e7" class="i field">Stop</a>:
                    <a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a> <span id="r148 rd" class="r148 r">e</span> =
                        <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#e6064d58185288d0" class="t constructor">ActionPreferenceStopException</a>(
                            <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>,
                            <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ErrorPreferenceStop</span>, <span class="r146 r">preferenceVariableName</span>, <span class="r147 r">message</span>));
                    <b>throw</b> <span class="i">ManageException</span>(<span class="r148 r">e</span>);
 
                <b>case</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a>:
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Bad preference value&quot;</span> + <span class="r144 r">preference</span>);
                    <a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a> <span id="r149 rd" class="r149 r">apse</span> =
                        <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#e6064d58185288d0" class="t constructor">ActionPreferenceStopException</a>(
                            <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>,
                            <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">PreferenceInvalid</span>, <span class="r146 r">preferenceVariableName</span>, <span class="r144 r">preference</span>));
                    <b>throw</b> <span class="i">ManageException</span>(<span class="r149 r">apse</span>);
            }
 
            <b>return</b> <a href="#6c0c629fc04b03c2" class="i method">InquireHelper</a>(
                <span class="r143 r">inquireMessage</span>,
                <span class="r142 r">inquireCaption</span>,
                <b>true</b>,  <span class="c">// allowYesToAll</span>
                <b>false</b>, <span class="c">// allowNoToAll</span>
                <b>true</b>,  <span class="c">// replaceNoWithHalt</span>
                <b>false</b>  <span class="c">// hasSecurityImpact</span>
            );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for continue prompt, handles Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">inquireMessage</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">May be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">inquireCaption</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">May be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">allowYesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">allowNoToAll</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">replaceNoWithHalt</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r155 r">hasSecurityImpact</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">User&#39;s selection.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a> <a id="6c0c629fc04b03c2" href="../R/6c0c629fc04b03c2.html" target="n" data-glyph="74,1" class="i method">InquireHelper</a>(
            <b>string</b> <span id="r150 rd" class="r150 r">inquireMessage</span>,
            <b>string</b> <span id="r151 rd" class="r151 r">inquireCaption</span>,
            <b>bool</b> <span id="r152 rd" class="r152 r">allowYesToAll</span>,
            <b>bool</b> <span id="r153 rd" class="r153 r">allowNoToAll</span>,
            <b>bool</b> <span id="r154 rd" class="r154 r">replaceNoWithHalt</span>,
            <b>bool</b> <span id="r155 rd" class="r155 r">hasSecurityImpact</span>
            )
        {
            <span class="i">Collection</span>&lt;<a href="hostifaces/ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt; <span id="r156 rd" class="r156 r">choices</span> =
                <b>new</b> <span class="i">Collection</span>&lt;<a href="hostifaces/ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt;();
            <b>int</b> <span id="r157 rd" class="r157 r">currentOption</span> = 0;
 
            <b>int</b> <span id="r158 rd" class="r158 r">continueOneOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>,
                <span id="r159 rd" class="r159 r">continueAllOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>,
                <span id="r160 rd" class="r160 r">haltOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>,
                <span id="r161 rd" class="r161 r">skipOneOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>,
                <span id="r162 rd" class="r162 r">skipAllOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>,
                <span id="r163 rd" class="r163 r">pauseOption</span> = <span class="i">Int32</span>.<span class="i">MaxValue</span>;
 
            <b>string</b> <span id="r164 rd" class="r164 r">continueOneLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">ContinueOneLabel</span>;
            <b>string</b> <span id="r165 rd" class="r165 r">continueOneHelpMsg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">ContinueOneHelpMessage</span>;
            <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r164 r">continueOneLabel</span>, <span class="r165 r">continueOneHelpMsg</span>));
            <span class="r158 r">continueOneOption</span> = <span class="r157 r">currentOption</span>++;
 
            <b>if</b> (<span class="r152 r">allowYesToAll</span>)
            {
                <b>string</b> <span id="r166 rd" class="r166 r">continueAllLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">ContinueAllLabel</span>;
                <b>string</b> <span id="r167 rd" class="r167 r">continueAllHelpMsg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">ContinueAllHelpMessage</span>;
                <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r166 r">continueAllLabel</span>, <span class="r167 r">continueAllHelpMsg</span>));
                <span class="r159 r">continueAllOption</span> = <span class="r157 r">currentOption</span>++;
            }
 
            <b>if</b> (<span class="r154 r">replaceNoWithHalt</span>)
            {
                <b>string</b> <span id="r168 rd" class="r168 r">haltLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">HaltLabel</span>;
                <b>string</b> <span id="r169 rd" class="r169 r">haltHelpMsg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">HaltHelpMessage</span>;
                <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r168 r">haltLabel</span>, <span class="r169 r">haltHelpMsg</span>));
                <span class="r160 r">haltOption</span> = <span class="r157 r">currentOption</span>++;
            }
            <b>else</b>
            {
                <b>string</b> <span id="r170 rd" class="r170 r">skipOneLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">SkipOneLabel</span>;
                <b>string</b> <span id="r171 rd" class="r171 r">skipOneHelpMsg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">SkipOneHelpMessage</span>;
                <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r170 r">skipOneLabel</span>, <span class="r171 r">skipOneHelpMsg</span>));
                <span class="r161 r">skipOneOption</span> = <span class="r157 r">currentOption</span>++;
            }
 
            <b>if</b> (<span class="r153 r">allowNoToAll</span>)
            {
                <b>string</b> <span id="r172 rd" class="r172 r">skipAllLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">SkipAllLabel</span>;
                <b>string</b> <span id="r173 rd" class="r173 r">skipAllHelpMsg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">SkipAllHelpMessage</span>;
                <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r172 r">skipAllLabel</span>, <span class="r173 r">skipAllHelpMsg</span>));
                <span class="r162 r">skipAllOption</span> = <span class="r157 r">currentOption</span>++;
            }
 
            <span class="c">// Hide the &quot;Suspend&quot; option in the remoting case since that is not supported. If the user chooses</span>
            <span class="c">// Suspend that will produce an error message. Why show the user an option that the user cannot use?</span>
            <span class="c">// Related to bug Win7/116823.</span>
            <b>if</b> (<a href="#1cb7b8c7555cd87e" class="i method">IsSuspendPromptAllowed</a>())
            {
                <b>string</b> <span id="r174 rd" class="r174 r">pauseLabel</span> = <span class="i">CommandBaseStrings</span>.<span class="i">PauseLabel</span>;
                <b>string</b> <span id="r175 rd" class="r175 r">pauseHelpMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">PauseHelpMessage</span>, <span class="s">&quot;exit&quot;</span>);
                <span class="r156 r">choices</span>.<span class="i">Add</span>(<b>new</b> <a href="hostifaces/ChoiceDescription.cs.html#5f2b1cc3ea4f41a7" class="t constructor">ChoiceDescription</a>(<span class="r174 r">pauseLabel</span>, <span class="r175 r">pauseHelpMsg</span>));
                <span class="r163 r">pauseOption</span> = <span class="r157 r">currentOption</span>++;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r150 r">inquireMessage</span>))
            {
                <span class="r150 r">inquireMessage</span> = <span class="i">CommandBaseStrings</span>.<span class="i">ShouldContinuePromptCaption</span>;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r151 r">inquireCaption</span>))
            {
                <span class="r151 r">inquireCaption</span> = <span class="i">CommandBaseStrings</span>.<span class="i">InquireCaptionDefault</span>;
            }
 
            <b>while</b> (<b>true</b>)
            {
                <span class="c">// Transcribe the confirmation message</span>
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<span class="r151 r">inquireCaption</span>);
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<span class="r150 r">inquireMessage</span>);
 
                <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r176 rd" class="r176 r">textChoices</span> = <b>new</b> <span class="i">Text</span>.<span class="i">StringBuilder</span>();
                <b>foreach</b> (<a href="hostifaces/ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a> <span id="r177 rd" class="r177 r">choice</span> <b>in</b> <span class="r156 r">choices</span>)
                {
                    <b>if</b> (<span class="r176 r">textChoices</span>.<span class="i">Length</span> &gt; 0)
                    {
                        <span class="r176 r">textChoices</span>.<span class="i">Append</span>(<span class="s">&quot;  &quot;</span>);
                    }
 
                    <span class="r176 r">textChoices</span>.<span class="i">Append</span>(<span class="r177 r">choice</span>.<a href="hostifaces/ChoiceDescription.cs.html#af282bdfd54e4e02" class="i property">Label</a>);
                }
 
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<span class="i">TranscribeResult</span>(<span class="r176 r">textChoices</span>.<span class="i">ToString</span>());
 
                <b>int</b> <span id="r178 rd" class="r178 r">defaultOption</span> = 0;
                <b>if</b> (<span class="r155 r">hasSecurityImpact</span>)
                {
                    <span class="r178 r">defaultOption</span> = <span class="r161 r">skipOneOption</span>;
                }
 
                <b>int</b> <span id="r179 rd" class="r179 r">response</span> = <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#ca6be5c54f8936b2" class="i method">PromptForChoice</a>(
                    <span class="r151 r">inquireCaption</span>, <span class="r150 r">inquireMessage</span>, <span class="r156 r">choices</span>, <span class="r178 r">defaultOption</span>);
 
                <b>string</b> <span id="r180 rd" class="r180 r">chosen</span> = <span class="r156 r">choices</span>[<span class="r179 r">response</span>].<span class="i">Label</span>;
                <b>int</b> <span id="r181 rd" class="r181 r">labelIndex</span> = <span class="r180 r">chosen</span>.<span class="i">IndexOf</span>(<span class="s">&#39;&amp;&#39;</span>);
                <b>if</b> (<span class="r181 r">labelIndex</span> &gt; -1)
                {
                    <span class="r180 r">chosen</span> = <span class="r180 r">chosen</span>[<span class="r181 r">labelIndex</span> + 1].<span class="i">ToString</span>();
                }
 
                <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#1bea3254cf92b0e3" class="i property">InternalUI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#257416bc2c610658" class="i method">TranscribeResult</a>(<span class="r180 r">chosen</span>);
 
                <b>if</b> (<span class="r158 r">continueOneOption</span> == <span class="r179 r">response</span>)
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#70a0aa888602277c" class="i field">Yes</a>;
                <b>else</b> <b>if</b> (<span class="r159 r">continueAllOption</span> == <span class="r179 r">response</span>)
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#ab98f8097f2d9979" class="i field">YesToAll</a>;
                <b>else</b> <b>if</b> (<span class="r160 r">haltOption</span> == <span class="r179 r">response</span>)
                {
                    <a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a> <span id="r182 rd" class="r182 r">e</span> =
                        <b>new</b> <span class="t">ActionPreferenceStopException</span>(
                            <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>,
                            <span class="i">CommandBaseStrings</span>.<span class="i">InquireHalt</span>);
                    <b>throw</b> <span class="i">ManageException</span>(<span class="r182 r">e</span>);
                }
                <b>else</b> <b>if</b> (<span class="r161 r">skipOneOption</span> == <span class="r179 r">response</span>)
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#2d8ea5f9b6f86199" class="i field">No</a>;
                <b>else</b> <b>if</b> (<span class="r162 r">skipAllOption</span> == <span class="r179 r">response</span>)
                    <b>return</b> <a href="#2c1103689ee3f100" class="t t">ContinueStatus</a>.<a href="#4d5114672c2a058f" class="i field">NoToAll</a>;
                <b>else</b> <b>if</b> (<span class="r163 r">pauseOption</span> == <span class="r179 r">response</span>)
                {
                    <span class="c">// This call returns when the user exits the nested prompt.</span>
                    <a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#008a1c3c3f30cf44" class="i method">EnterNestedPrompt</a>(<a href="#64fec126736a688e" class="i field">_thisCommand</a>);
                    <span class="c">// continue loop</span>
                }
                <b>else</b> <b>if</b> (<span class="r179 r">response</span> == -1)
                {
                    <a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a> <span id="r183 rd" class="r183 r">e</span> =
                        <b>new</b> <span class="t">ActionPreferenceStopException</span>(
                            <a href="#414274318fb6cbe1" class="i property">MyInvocation</a>,
                            <span class="i">CommandBaseStrings</span>.<span class="i">InquireCtrlC</span>);
                    <b>throw</b> <span class="i">ManageException</span>(<span class="r183 r">e</span>);
                }
                <b>else</b>
                {
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;all cases should be checked&quot;</span>);
                    <span class="i">InvalidOperationException</span> <span id="r184 rd" class="r184 r">e</span> =
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                    <b>throw</b> <span class="i">ManageException</span>(<span class="r184 r">e</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if this is being run in the context of a remote host or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="1cb7b8c7555cd87e" href="../R/1cb7b8c7555cd87e.html" target="n" data-glyph="76,1" class="i method">IsSuspendPromptAllowed</a>()
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bf2192101a5df610" class="i field">CBhost</a> != <b>null</b>, <span class="s">&quot;Expected this.CBhost != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a> != <b>null</b>, <span class="s">&quot;Expected this.CBhost.ExternalHost != null&quot;</span>);
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#bf2192101a5df610" class="i field">CBhost</a>.<a href="hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a> <b>is</b> <a href="remoting/server/ServerRemoteHost.cs.html#ecbb655f955c09fc" class="t t">ServerRemoteHost</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Continue/Confirm
 
        <b>internal void</b> <a id="4ddec4b42d084335" href="../R/4ddec4b42d084335.html" target="n" data-glyph="74,1" class="i method">SetVariableListsInPipe</a>()
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#64fec126736a688e" class="i field">_thisCommand</a> <b>is</b> <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>, <span class="s">&quot;this is only done for script cmdlets&quot;</span>);
 
            <b>if</b> (<a href="#68922a3d24ad21f4" class="i field">_outVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#f6095cccebfe81e2" class="i field">Output</a>, <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>);
            }
 
            <b>if</b> (<a href="#d8e38fb42ce574fc" class="i field">_errorVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#fc0efe5038263e2e" class="i field">Error</a>, <a href="#d8e38fb42ce574fc" class="i field">_errorVarList</a>);
            }
 
            <b>if</b> (<a href="#741a37a0daa34dd8" class="i field">_warningVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#5cc4786026261f99" class="i field">Warning</a>, <a href="#741a37a0daa34dd8" class="i field">_warningVarList</a>);
            }
 
            <b>if</b> (<a href="#7f5e049a057189ef" class="i field">_informationVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#67b4fe900c383cd4" class="i method">AddVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#4dd342fbd3639cab" class="i field">Information</a>, <a href="#7f5e049a057189ef" class="i field">_informationVarList</a>);
            }
 
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a> != <b>null</b>)
            {
                <span class="c">// _state can be null if the current script block is dynamicparam, etc.</span>
                <b>if</b> (<a href="#a8013d10b683bea8" class="i field">_state</a> != <b>null</b>)
                {
                    <span class="c">// Create the pipeline variable</span>
                    <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#15bb5031ffe10516" class="i method">Set</a>(<a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a>);
 
                    <span class="c">// Get the reference again in case we re-used one from the</span>
                    <span class="c">// same scope.</span>
                    <a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a> = <a href="#a8013d10b683bea8" class="i field">_state</a>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f4f82fae9d4a7f1f" class="i method">Get</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a>);
                }
 
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a70f5d4297604021" class="i method">SetPipelineVariable</a>(<a href="#ec6a1fd82fe72d53" class="i field">_pipelineVarReference</a>);
            }
        }
 
        <b>internal void</b> <a id="d4d5bbd4ef2bc541" href="../R/d4d5bbd4ef2bc541.html" target="n" data-glyph="74,1" class="i method">RemoveVariableListsInPipe</a>()
        {
            <span class="c">// Diagnostics.Assert(thisCommand is PSScriptCmdlet, &quot;this is only done for script cmdlets&quot;);</span>
 
            <b>if</b> (<a href="#68922a3d24ad21f4" class="i field">_outVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a7aced95b40de013" class="i method">RemoveVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#f6095cccebfe81e2" class="i field">Output</a>, <a href="#68922a3d24ad21f4" class="i field">_outVarList</a>);
            }
 
            <b>if</b> (<a href="#d8e38fb42ce574fc" class="i field">_errorVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a7aced95b40de013" class="i method">RemoveVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#fc0efe5038263e2e" class="i field">Error</a>, <a href="#d8e38fb42ce574fc" class="i field">_errorVarList</a>);
            }
 
            <b>if</b> (<a href="#741a37a0daa34dd8" class="i field">_warningVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a7aced95b40de013" class="i method">RemoveVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#5cc4786026261f99" class="i field">Warning</a>, <a href="#741a37a0daa34dd8" class="i field">_warningVarList</a>);
            }
 
            <b>if</b> (<a href="#7f5e049a057189ef" class="i field">_informationVarList</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#a7aced95b40de013" class="i method">RemoveVariableList</a>(<a href="Pipe.cs.html#30cd58b31f46e170" class="t t">VariableStreamKind</a>.<a href="Pipe.cs.html#4dd342fbd3639cab" class="i field">Information</a>, <a href="#7f5e049a057189ef" class="i field">_informationVarList</a>);
            }
 
            <b>if</b> (<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a> != <b>null</b>)
            {
                <a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#b24610eb88ee27e9" class="i property">OutputPipe</a>.<a href="Pipe.cs.html#30de0282d42a21cf" class="i method">RemovePipelineVariable</a>();
                <span class="c">// &#39;_state&#39; could be null when a &#39;DynamicParam&#39; block runs because the &#39;DynamicParam&#39; block runs in &#39;DoPrepare&#39;,</span>
                <span class="c">// before &#39;PipelineProcessor.SetupParameterVariables&#39; is called, where &#39;_state&#39; is initialized.</span>
                <a href="#a8013d10b683bea8" class="i field">_state</a>?.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#4a190c6550363b73" class="i method">Remove</a>(<a href="#f9ebe6a3b284ab55" class="k">this</a>.<a href="#e605459f91bb88dd" class="i property">PipelineVariable</a>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
