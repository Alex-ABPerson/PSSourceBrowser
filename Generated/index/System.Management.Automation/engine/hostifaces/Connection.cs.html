<!DOCTYPE html>
<html><head><title>Connection.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1891);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/Connection.cs" target="_top">engine\hostifaces\Connection.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Exceptions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Exception thrown when state of the runspace is different from</span>
    <span class="c">///</span><span class="c"> expected state of runspace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="340ccbbd1c6e8b87" href="../../R/340ccbbd1c6e8b87.html" target="n" data-glyph="0,0" class="t t">InvalidRunspaceStateException</a> : <span class="i">SystemException</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of InvalidRunspaceStateException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="fc9543f8f1377b98" href="../../R/fc9543f8f1377b98.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspaceStateException</a>()
        : <b>base</b>
        (
            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">InvalidRunspaceStateGeneral</span>)
        )
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of InvalidRunspaceStateException with a specified error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message that describes the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="15409056950584a1" href="../../R/15409056950584a1.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspaceStateException</a>(<b>string</b> <span id="r0 rd" class="r0 r">message</span>)
        : <b>base</b>(<span class="r0 r">message</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidRunspaceStateException class</span>
        <span class="c">///</span><span class="c"> with a specified error message and a reference to the inner exception</span>
        <span class="c">///</span><span class="c"> that is the cause of this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message that describes the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that is the cause of the current exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="ab819e520b071e30" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspaceStateException</a>(<b>string</b> <span id="r1 rd" class="r1 r">message</span>, <span class="i">Exception</span> <span id="r2 rd" class="r2 r">innerException</span>)
        : <b>base</b>(<span class="r1 r">message</span>, <span class="r2 r">innerException</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidRunspaceStateException</span>
        <span class="c">///</span><span class="c"> with a specified error message and current and expected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The message that describes the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">currentState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current state of runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">expectedState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected states of runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ff1c45fc227fc3d7" href="../../R/ff1c45fc227fc3d7.html" target="n" data-glyph="74,1" class="t constructor">InvalidRunspaceStateException</a>
        (
            <b>string</b> <span id="r3 rd" class="r3 r">message</span>,
            <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r4 rd" class="r4 r">currentState</span>,
            <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r5 rd" class="r5 r">expectedState</span>
        )
        : <b>base</b>(<span class="r3 r">message</span>)
        {
            <a href="#b8f63c2fea2cb78e" class="i field">_expectedState</a> = <span class="r5 r">expectedState</span>;
            <a href="#ca2594e491ba0767" class="i field">_currentState</a> = <span class="r4 r">currentState</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ISerializable Members
 
        <span class="c">// 2005/04/20-JonN No need to implement GetObjectData</span>
        <span class="c">// if all fields are static or [NonSerialized]</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c">  class with serialized data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SerializationInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that holds the serialized object</span>
        <span class="c">///</span><span class="c"> data about the exception being thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">StreamingContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that contains contextual information</span>
        <span class="c">///</span><span class="c"> about the source or destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="8273a731022ae155" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">InvalidRunspaceStateException</a>(<span class="i">SerializationInfo</span> <span id="r6 rd" class="r6 r">info</span>, <span class="i">StreamingContext</span> <span id="r7 rd" class="r7 r">context</span>)
        : <b>base</b>(<span class="r6 r">info</span>, <span class="r7 r">context</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access CurrentState of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This is the state of the runspace when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="ffbdf8c870b07522" href="../../R/ffbdf8c870b07522.html" target="n" data-glyph="102,1" class="i property">CurrentState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ca2594e491ba0767" class="i field">_currentState</a>;
            }
 
            <b>internal set</b>
            {
                <a href="#ca2594e491ba0767" class="i field">_currentState</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Expected state of runspace by the operation which has thrown this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="097b6c06ae0a57c8" href="../../R/097b6c06ae0a57c8.html" target="n" data-glyph="102,1" class="i property">ExpectedState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#b8f63c2fea2cb78e" class="i field">_expectedState</a>;
            }
 
            <b>internal set</b>
            {
                <a href="#b8f63c2fea2cb78e" class="i field">_expectedState</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of the runspace when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="ca2594e491ba0767" href="../../R/ca2594e491ba0767.html" target="n" data-glyph="46,1" class="i field">_currentState</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> States of the runspace expected in method which throws this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="b8f63c2fea2cb78e" href="../../R/b8f63c2fea2cb78e.html" target="n" data-glyph="46,1" class="i field">_expectedState</a> = 0;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exceptions
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace state
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines various states of runspace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="5da9dc65e996a685" href="../../R/5da9dc65e996a685.html" target="n" data-glyph="18,0" class="t t"><span id="4dc259391abfea5b">RunspaceState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Beginning state upon creation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4e82723df10b13f6" href="../../R/4e82723df10b13f6.html" target="n" data-glyph="24,1" class="i field">BeforeOpen</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace is being established.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="3990ad8b3e3feec7" href="../../R/3990ad8b3e3feec7.html" target="n" data-glyph="24,1" class="i field">Opening</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is established and valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9a99efb0eaa3c3db" href="../../R/9a99efb0eaa3c3db.html" target="n" data-glyph="24,1" class="i field">Opened</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is closed or has not been established.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="45de84b67ba18f3f" href="../../R/45de84b67ba18f3f.html" target="n" data-glyph="24,1" class="i field">Closed</a> = 3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is being closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="fb276cb28f922b8e" href="../../R/fb276cb28f922b8e.html" target="n" data-glyph="24,1" class="i field">Closing</a> = 4,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace has been disconnected abnormally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e4c76740d99e58bd" href="../../R/e4c76740d99e58bd.html" target="n" data-glyph="24,1" class="i field">Broken</a> = 5,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is being disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="31c8fe83ad58dbdb" href="../../R/31c8fe83ad58dbdb.html" target="n" data-glyph="24,1" class="i field">Disconnecting</a> = 6,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="0a8fc62a22d129a1" href="../../R/0a8fc62a22d129a1.html" target="n" data-glyph="24,1" class="i field">Disconnected</a> = 7,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace is Connecting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1c027aab2310d438" href="../../R/1c027aab2310d438.html" target="n" data-glyph="24,1" class="i field">Connecting</a> = 8
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> These options control whether a new thread is created when a command is executed within a runspace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="e3e452d2492397a5" href="../../R/e3e452d2492397a5.html" target="n" data-glyph="18,0" class="t t"><span id="e025af12d63d1e86">PSThreadOptions</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use the default options: UseNewThread for local Runspace, ReuseThread for local RunspacePool, server settings for remote Runspace and RunspacePool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="84e3ebfc04cbd4e5" href="../../R/84e3ebfc04cbd4e5.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new thread for each invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9f0b5bad750c94f2" href="../../R/9f0b5bad750c94f2.html" target="n" data-glyph="24,1" class="i field">UseNewThread</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new thread for the first invocation and then re-uses</span>
        <span class="c">///</span><span class="c"> that thread in subsequent invocations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d11fc99ab087227d" href="../../R/d11fc99ab087227d.html" target="n" data-glyph="24,1" class="i field">ReuseThread</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Doesn&#39;t create a new thread; the execution occurs on the</span>
        <span class="c">///</span><span class="c"> thread that calls Invoke.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This option is not valid for asynchronous calls</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="1eea8c0b04b31e81" href="../../R/1eea8c0b04b31e81.html" target="n" data-glyph="24,1" class="i field">UseCurrentThread</a> = 3
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines type which has information about RunspaceState and</span>
    <span class="c">///</span><span class="c"> Exception associated with RunspaceState.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="0cb1ed33bb1d35e3" href="../../R/0cb1ed33bb1d35e3.html" target="n" data-glyph="0,0" class="t t">RunspaceStateInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes not resulting from an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The state of the runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e093e4ce616b2fff" href="../../R/e093e4ce616b2fff.html" target="n" data-glyph="74,1" class="t constructor">RunspaceStateInfo</a>(<a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r8 rd" class="r8 r">state</span>)
            : <a href="#80f3eb369399a1aa" class="k">this</a>(<span class="r8 r">state</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes with an optional error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The state of runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A non-null exception if the state change was</span>
        <span class="c">///</span><span class="c"> caused by an error, otherwise; null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="80f3eb369399a1aa" href="../../R/80f3eb369399a1aa.html" target="n" data-glyph="74,1" class="t constructor">RunspaceStateInfo</a>(<a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r9 rd" class="r9 r">state</span>, <span class="i">Exception</span> <span id="r10 rd" class="r10 r">reason</span>)
            : <b>base</b>()
        {
            <a href="#41627f067662d11c" class="i property">State</a> = <span class="r9 r">state</span>;
            <a href="#c342411ef74d93be" class="i property">Reason</a> = <span class="r10 r">reason</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor to support cloning.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">runspaceStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The source</span>
        <span class="c">///</span><span class="c"> RunspaceStateInfo</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ee18278ed6dec109" href="../../R/ee18278ed6dec109.html" target="n" data-glyph="74,1" class="t constructor">RunspaceStateInfo</a>(<a href="#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <span id="r11 rd" class="r11 r">runspaceStateInfo</span>)
        {
            <a href="#41627f067662d11c" class="i property">State</a> = <span class="r11 r">runspaceStateInfo</span>.<a href="#41627f067662d11c" class="i property">State</a>;
            <a href="#c342411ef74d93be" class="i property">Reason</a> = <span class="r11 r">runspaceStateInfo</span>.<a href="#c342411ef74d93be" class="i property">Reason</a>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The state of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="41627f067662d11c" href="../../R/41627f067662d11c.html" target="n" data-glyph="102,1" class="i property">State</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The reason for the state change, if caused by an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of this property is non-null if the state</span>
        <span class="c">///</span><span class="c"> changed due to an error. Otherwise, the value of this</span>
        <span class="c">///</span><span class="c"> property is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="c342411ef74d93be" href="../../R/c342411ef74d93be.html" target="n" data-glyph="102,1" class="i property">Reason</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override for ToString()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="49c6b1231b98226f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#41627f067662d11c" class="i property">State</a>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clones current object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="d8101f7e931fd53a" href="../../R/d8101f7e931fd53a.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#ee18278ed6dec109" class="t constructor">RunspaceStateInfo</a>(<a href="#0cb1ed33bb1d35e3" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private_fields
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private_fields
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines Event arguments passed to RunspaceStateEvent handler</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="#6866e88f64eb13d6" class="i">StateChanged</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="24ce8f9c69bf1c4a" href="../../R/24ce8f9c69bf1c4a.html" target="n" data-glyph="0,0" class="t t">RunspaceStateEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs RunspaceStateEventArgs using RunspaceStateInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">runspaceStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The information about</span>
        <span class="c">///</span><span class="c"> current state of the runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceStateInfo is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6e0b792adcfea770" href="../../R/6e0b792adcfea770.html" target="n" data-glyph="74,1" class="t constructor">RunspaceStateEventArgs</a>(<a href="#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <span id="r12 rd" class="r12 r">runspaceStateInfo</span>)
        {
            <b>if</b> (<span class="r12 r">runspaceStateInfo</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r12 r">runspaceStateInfo</span>));
            }
 
            <a href="#efb5571439376cca" class="i property">RunspaceStateInfo</a> = <span class="r12 r">runspaceStateInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Information about state of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This value indicates the state of the runspace after the</span>
        <span class="c">///</span><span class="c"> change.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="efb5571439376cca" href="../../R/efb5571439376cca.html" target="n" data-glyph="102,1" class="i property">RunspaceStateInfo</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enum to indicate whether a Runspace is busy or available.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="bd6944cab8dcc583" href="../../R/bd6944cab8dcc583.html" target="n" data-glyph="18,0" class="t t"><span id="ef48722e4650038e">RunspaceAvailability</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Runspace is not been in the Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a5172055c7a11352" href="../../R/a5172055c7a11352.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Runspace is available to execute commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="64bc5c5290cfb16d" href="../../R/64bc5c5290cfb16d.html" target="n" data-glyph="24,1" class="i field">Available</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Runspace is available to execute nested commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7d8f97430ae71e2a" href="../../R/7d8f97430ae71e2a.html" target="n" data-glyph="24,1" class="i field">AvailableForNestedCommand</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Runspace is busy executing a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="aed194b80737a544" href="../../R/aed194b80737a544.html" target="n" data-glyph="24,1" class="i field">Busy</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Applies only to remote runspace case.  The remote runspace</span>
        <span class="c">///</span><span class="c"> is currently in a Debugger Stop mode and requires a debugger</span>
        <span class="c">///</span><span class="c"> SetDebuggerAction() call to continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="244d7672812dd8a9" href="../../R/244d7672812dd8a9.html" target="n" data-glyph="24,1" class="i field">RemoteDebug</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the event arguments passed to the AvailabilityChanged </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="cb349d0617c35bc7" href="../../R/cb349d0617c35bc7.html" target="n" data-glyph="0,0" class="t t">RunspaceAvailabilityEventArgs</a> : <span class="i">EventArgs</span>
    {
        <b>internal</b> <a id="38ab95beeaebfcf6" href="../../R/38ab95beeaebfcf6.html" target="n" data-glyph="74,1" class="t constructor">RunspaceAvailabilityEventArgs</a>(<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r13 rd" class="r13 r">runspaceAvailability</span>)
        {
            <a href="#374d403c14f99b8f" class="i property">RunspaceAvailability</a> = <span class="r13 r">runspaceAvailability</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether the Runspace is available to execute commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="374d403c14f99b8f" href="../../R/374d403c14f99b8f.html" target="n" data-glyph="102,1" class="i property">RunspaceAvailability</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Runspace state
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace capabilities
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines runspace capabilities.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="381534d5ae10528e" href="../../R/381534d5ae10528e.html" target="n" data-glyph="18,0" class="t t"><span id="fc28b856a82e6bf8">RunspaceCapability</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No additional capabilities beyond a default runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9ed1c376ca1193e2" href="../../R/9ed1c376ca1193e2.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace and remoting layer supports disconnect/connect feature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="809b1422aeb42750" href="../../R/809b1422aeb42750.html" target="n" data-glyph="24,1" class="i field">SupportsDisconnect</a> = 0x1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is based on a named pipe transport.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="bbaad78d6b858edf" href="../../R/bbaad78d6b858edf.html" target="n" data-glyph="24,1" class="i field">NamedPipeTransport</a> = 0x2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is based on a VM socket transport.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a7e8e2e8c62058c6" href="../../R/a7e8e2e8c62058c6.html" target="n" data-glyph="24,1" class="i field">VMSocketTransport</a> = 0x4,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is based on SSH transport.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1a92af2f13919c93" href="../../R/1a92af2f13919c93.html" target="n" data-glyph="24,1" class="i field">SSHTransport</a> = 0x8
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Public interface to Msh Runtime. Provides APIs for creating pipelines,</span>
    <span class="c">///</span><span class="c"> access session state etc.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="7e5b8eab1aa16fd7" href="../../R/7e5b8eab1aa16fd7.html" target="n" data-glyph="0,0" class="t t">Runspace</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private static int</b> <a id="53c0d7c65d4e05a2" href="../../R/53c0d7c65d4e05a2.html" target="n" data-glyph="46,1" class="i field">s_globalId</a>;
        <b>private readonly</b> <span class="i">Stack</span>&lt;<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <a id="92adc4130c72b7f5" href="../../R/92adc4130c72b7f5.html" target="n" data-glyph="46,1" class="i field">_runningPowerShells</a>;
        <b>private</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="1830bb0a97962270" href="../../R/1830bb0a97962270.html" target="n" data-glyph="46,1" class="i field">_baseRunningPowerShell</a>;
        <b>private readonly object</b> <a id="fc732403083d9584" href="../../R/fc732403083d9584.html" target="n" data-glyph="46,1" class="i field">_syncObject</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Explicit default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="c3d6a6c5f8f88cce" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">Runspace</a>()
        {
            <span class="c">// Create the default Runspace Id and friendly name.</span>
            <a href="#65a113758fdf9ce2" class="i property">Id</a> = <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#53c0d7c65d4e05a2" class="i field">s_globalId</a>);
            <a href="#c40205e63f7ff911" class="i property">Name</a> = <span class="s">&quot;Runspace&quot;</span> + <a href="#65a113758fdf9ce2" class="i property">Id</a>.<span class="i">ToString</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>);
            <a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a> = <b>new</b> <span class="i">Stack</span>&lt;<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt;();
            <a href="#fc732403083d9584" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
 
            <span class="c">// Keep track of this runspace until it is disposed.</span>
            <b>lock</b> (<a href="#9d51235ffd4ca8b4" class="i field">s_syncObject</a>)
            {
                <a href="#47df08753c3a22f9" class="i field">s_runspaceDictionary</a>.<span class="i">Add</span>(<a href="#65a113758fdf9ce2" class="i property">Id</a>, <b>new</b> <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;(<a href="#7e5b8eab1aa16fd7" class="k">this</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Static Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="6905d42e72ca501d" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">Runspace</a>()
        {
            <a href="#9d51235ffd4ca8b4" class="i field">s_syncObject</a> = <b>new</b> <b>object</b>();
            <a href="#47df08753c3a22f9" class="i field">s_runspaceDictionary</a> = <b>new</b> <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;&gt;();
            <a href="#53c0d7c65d4e05a2" class="i field">s_globalId</a> = 0;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to store Runspace reference on per thread basis. Used by</span>
        <span class="c">///</span><span class="c"> various PowerShell engine features to get access to TypeTable</span>
        <span class="c">///</span><span class="c"> etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">ThreadStatic</span>]
        <b>private static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="fa6d34f5b2bb242a" href="../../R/fa6d34f5b2bb242a.html" target="n" data-glyph="46,1" class="i field">t_threadSpecificDefaultRunspace</a> = <b>null</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the default Runspace used to evaluate scripts.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">The Runspace used to set this property should not be shared between different threads.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="efcd2ba43103de17" href="../../R/efcd2ba43103de17.html" target="n" data-glyph="102,1" class="i property">DefaultRunspace</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fa6d34f5b2bb242a" class="i field">t_threadSpecificDefaultRunspace</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b> || !<b>value</b>.<a href="#4c68376ad8961bec" class="i property">RunspaceIsRemote</a>)
                {
                    <a href="#fa6d34f5b2bb242a" class="i field">t_threadSpecificDefaultRunspace</a> = <b>value</b>;
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">RunspaceNotLocal</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PrimaryRunspace is a runspace that persists for the entire lifetime of the PowerShell session. It is only</span>
        <span class="c">///</span><span class="c"> closed or disposed when the session is ending.  So when the PrimaryRunspace is closing it will trigger on-exit</span>
        <span class="c">///</span><span class="c"> cleanup that includes closing any other local runspaces left open, and will allow the process to exit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="63bc8bc99b4ad382" href="../../R/63bc8bc99b4ad382.html" target="n" data-glyph="104,1" class="i property">PrimaryRunspace</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7bf688d0d0808603" class="i field">s_primaryRunspace</a>;
            }
 
            <b>set</b>
            {
                <b>var</b> <span id="r14 rd" class="r14 r">result</span> = <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;(<b>ref</b> <a href="#7bf688d0d0808603" class="i field">s_primaryRunspace</a>, <b>value</b>, <b>null</b>);
                <b>if</b> (<span class="r14 r">result</span> != <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">PrimaryRunspaceAlreadySet</span>);
                }
            }
        }
 
        <b>private static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="7bf688d0d0808603" href="../../R/7bf688d0d0808603.html" target="n" data-glyph="46,1" class="i field">s_primaryRunspace</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if Runspace.DefaultRunspace can be used to</span>
        <span class="c">///</span><span class="c"> create an instance of the PowerShell class with</span>
        <span class="c">///</span><span class="c"> &#39;UseCurrentRunspace = true&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="1d816371e3cbeae6" href="../../R/1d816371e3cbeae6.html" target="n" data-glyph="102,1" class="i property">CanUseDefaultRunspace</a>
        {
            <span class="c">// can use default runspace in a thread safe manner only if</span>
            <span class="c">// 1. we have a default runspace</span>
            <span class="c">// 2. we recognize the type of current runspace and current pipeline</span>
            <span class="c">// 3. the pipeline executes on the same thread as this method</span>
 
            <span class="c">// we don&#39;t return &quot;true&quot; for</span>
            <span class="c">// 1. we have a default runspace</span>
            <span class="c">// 2. no currently executing pipeline</span>
            <span class="c">// to avoid a race condition where a pipeline is started</span>
            <span class="c">// after this property getter did all the checks</span>
 
            <b>get</b>
            {
                <a href="ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a> <span id="r15 rd" class="r15 r">runspace</span> = <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="#efcd2ba43103de17" class="i property">DefaultRunspace</a> <b>as</b> <a href="ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>;
                <b>if</b> (<span class="r15 r">runspace</span> != <b>null</b>)
                {
                    <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r16 rd" class="r16 r">currentPipeline</span> = <span class="r15 r">runspace</span>.<a href="ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
                    <a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a> <span id="r17 rd" class="r17 r">localPipeline</span> = <span class="r16 r">currentPipeline</span> <b>as</b> <a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>;
                    <b>if</b> ((<span class="r17 r">localPipeline</span> != <b>null</b>) &amp;&amp; (<span class="r17 r">localPipeline</span>.<a href="pipelinebase.cs.html#a5df166266e2f408" class="i property">NestedPipelineExecutionThread</a> != <b>null</b>))
                    {
                        <b>return</b>
                            (<span class="r17 r">localPipeline</span>.<a href="pipelinebase.cs.html#a5df166266e2f408" class="i property">NestedPipelineExecutionThread</a>.<span class="i">ManagedThreadId</span>
                            == <span class="i">Environment</span>.<span class="i">CurrentManagedThreadId</span>);
                    }
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>internal const</b> <span class="i">ApartmentState</span> <a id="8d461e5a29a5440d" href="../../R/8d461e5a29a5440d.html" target="n" data-glyph="8,1" class="i field">DefaultApartmentState</a> = <a href="#7483ec8556438ee9" class="i property">ApartmentState</a>.<span class="i">Unknown</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ApartmentState of the thread used to execute commands within this Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any updates to the value of this property must be done before the Runspace is opened</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An attempt to change this property was made after opening the Runspace</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ApartmentState</span> <a id="7483ec8556438ee9" href="../../R/7483ec8556438ee9.html" target="n" data-glyph="102,1" class="i property">ApartmentState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#9ddc97d4e0241870" class="i field">apartmentState</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="#41627f067662d11c" class="i property">State</a> != <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#4e82723df10b13f6" class="i field">BeforeOpen</a>)
                {
                    <b>throw</b> <b>new</b> <a href="#15409056950584a1" class="t constructor">InvalidRunspaceStateException</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">ChangePropertyAfterOpen</span>));
                }
 
                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#9ddc97d4e0241870" class="i field">apartmentState</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">ApartmentState</span> <a id="9ddc97d4e0241870" href="../../R/9ddc97d4e0241870.html" target="n" data-glyph="46,1" class="i field">apartmentState</a> = <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="#8d461e5a29a5440d" class="i field">DefaultApartmentState</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property determines whether a new thread is create for each invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any updates to the value of this property must be done before the Runspace is opened</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An attempt to change this property was made after opening the Runspace</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The thread options cannot be changed to the requested value</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="bd7dc249cd7abc4e" href="../../R/bd7dc249cd7abc4e.html" target="n" data-glyph="102,1" class="i property">ThreadOptions</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return version of this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i">Version</span> <a id="96542f97313e77ed" href="../../R/96542f97313e77ed.html" target="n" data-glyph="102,1" class="i property">Version</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return whether the Runspace is Remote</span>
        <span class="c">///</span><span class="c"> We can determine this by whether the runspace is an implementation of LocalRunspace</span>
        <span class="c">///</span><span class="c"> or infer it from whether the ConnectionInfo property is null</span>
        <span class="c">///</span><span class="c"> If it happens to be an instance of a LocalRunspace, but has a non-null ConnectionInfo</span>
        <span class="c">///</span><span class="c"> we declare it to be remote.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4c68376ad8961bec" href="../../R/4c68376ad8961bec.html" target="n" data-glyph="102,1" class="i property">RunspaceIsRemote</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7e5b8eab1aa16fd7" class="k">this</a> <b>is not</b> <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> &amp;&amp; <a href="#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a> != <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieve information about current state of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="01b12fbdab6c561a" href="../../R/01b12fbdab6c561a.html" target="n" data-glyph="102,1" class="i property">RunspaceStateInfo</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the current availability of the Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="c8bea13c75bd3198" href="../../R/c8bea13c75bd3198.html" target="n" data-glyph="102,1" class="i property">RunspaceAvailability</a>
        {
            <b>get</b>;
            <b>protected set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState information for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="8f24c824cfe9458d" href="../../R/8f24c824cfe9458d.html" target="n" data-glyph="102,1" class="i property">InitialSessionState</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get unique id for this instance of runspace. It is primarily used</span>
        <span class="c">///</span><span class="c"> for logging purposes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="af7b715fe8b1bee2" href="../../R/af7b715fe8b1bee2.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b>;
 
            <span class="c">// This id is also used to identify proxy and remote runspace objects.</span>
            <span class="c">// We need to set this when reconstructing a remote runspace to connect</span>
            <span class="c">// to an existing remote runspace.</span>
            <b>internal set</b>;
        } = <span class="i">Guid</span>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets execution context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace is not opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="3a36e24a88649363" href="../../R/3a36e24a88649363.html" target="n" data-glyph="104,1" class="i property">ExecutionContext</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ade98325afa63ad9" class="i property">GetExecutionContext</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Skip user profile on engine initialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1f4dff42d55125e7" href="../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">SkipUserProfile</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connection information for remote Runspaces, null for local Runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="7ff4c79fcb624bf1" href="../../R/7ff4c79fcb624bf1.html" target="n" data-glyph="102,1" class="i property">ConnectionInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ConnectionInfo originally supplied by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="a5a0b008965ce85a" href="../../R/a5a0b008965ce85a.html" target="n" data-glyph="102,1" class="i property">OriginalConnectionInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Manager for JobSourceAdapters registered in this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../remoting/client/JobManager.cs.html#d9cecc2436bd3c7d" class="t t">JobManager</a> <a id="9accf990b5cf1268" href="../../R/9accf990b5cf1268.html" target="n" data-glyph="102,1" class="i property">JobManager</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> DisconnectedOn property applies to remote runspaces that have</span>
        <span class="c">///</span><span class="c"> been disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span>? <a id="6c141feecce4dc09" href="../../R/6c141feecce4dc09.html" target="n" data-glyph="102,1" class="i property">DisconnectedOn</a>
        {
            <b>get</b>;
            <b>internal set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExpiresOn property applies to remote runspaces that have been</span>
        <span class="c">///</span><span class="c"> disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span>? <a id="89b751705e0b934c" href="../../R/89b751705e0b934c.html" target="n" data-glyph="102,1" class="i property">ExpiresOn</a>
        {
            <b>get</b>;
            <b>internal set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets a friendly name for the Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c40205e63f7ff911" href="../../R/c40205e63f7ff911.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Runspace Id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="65a113758fdf9ce2" href="../../R/65a113758fdf9ce2.html" target="n" data-glyph="102,1" class="i property">Id</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns protocol version that the remote server uses for PS remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Version</span> <a id="4a6e6e16fd38fa86" href="../../R/4a6e6e16fd38fa86.html" target="n" data-glyph="74,1" class="i method">GetRemoteProtocolVersion</a>()
        {
            <span class="i">Version</span> <span id="r18 rd" class="r18 r">remoteProtocolVersionDeclaredByServer</span>;
            <b>bool</b> <span id="r19 rd" class="r19 r">isServerDeclarationValid</span> = <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>.<span class="i">TryPathGet</span>(
                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#0d77ad561d46f843" class="i method">GetApplicationPrivateData</a>(),
                <b>out</b> <span class="r18 r">remoteProtocolVersionDeclaredByServer</span>,
                <a href="../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>,
                <a href="../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../PSVersionInfo.cs.html#a1769a49a5895018" class="i field">PSRemotingProtocolVersionName</a>);
 
            <b>if</b> (<span class="r19 r">isServerDeclarationValid</span>)
            {
                <b>return</b> <span class="r18 r">remoteProtocolVersionDeclaredByServer</span>;
            }
            <b>else</b>
            {
                <b>return</b> <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#c5be07ec763d4c13" class="i field">ProtocolVersion</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine activity id (for ETW tracing)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Guid</span> <a id="6db529a3f824a5b1" href="../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">EngineActivityId</a> { <b>get</b>; <b>set</b>; } = <span class="i">Guid</span>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a read only runspace dictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">ReadOnlyDictionary</span>&lt;<b>int</b>, <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;&gt; <a id="c77882820ba98c13" href="../../R/c77882820ba98c13.html" target="n" data-glyph="104,1" class="i property">RunspaceDictionary</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#9d51235ffd4ca8b4" class="i field">s_syncObject</a>)
                {
                    <b>return</b> <b>new</b> <span class="i">ReadOnlyDictionary</span>&lt;<b>int</b>, <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;&gt;(<b>new</b> <span class="i">Dictionary</span>&lt;<b>int</b>, <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;&gt;(<a href="#47df08753c3a22f9" class="i field">s_runspaceDictionary</a>));
                }
            }
        }
 
        <b>private static readonly</b> <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">WeakReference</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;&gt; <a id="47df08753c3a22f9" href="../../R/47df08753c3a22f9.html" target="n" data-glyph="46,1" class="i field">s_runspaceDictionary</a>;
        <b>private static readonly object</b> <a id="9d51235ffd4ca8b4" href="../../R/9d51235ffd4ca8b4.html" target="n" data-glyph="46,1" class="i field">s_syncObject</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a read only list of runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IReadOnlyList</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt; <a id="3fd829e0933069ea" href="../../R/3fd829e0933069ea.html" target="n" data-glyph="104,1" class="i property">RunspaceList</a>
        {
            <b>get</b>
            {
                <span class="i">List</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt; <span id="r20 rd" class="r20 r">runspaceList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;();
 
                <b>lock</b> (<a href="#9d51235ffd4ca8b4" class="i field">s_syncObject</a>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r21 rd" class="r21 r">item</span> <b>in</b> <a href="#47df08753c3a22f9" class="i field">s_runspaceDictionary</a>.<span class="i">Values</span>)
                    {
                        <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r22 rd" class="r22 r">runspace</span>;
                        <b>if</b> (<span class="r21 r">item</span>.<span class="i">TryGetTarget</span>(<b>out</b> <span class="r22 r">runspace</span>))
                        {
                            <span class="r20 r">runspaceList</span>.<span class="i">Add</span>(<span class="r22 r">runspace</span>);
                        }
                    }
                }
 
                <b>return</b> <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;(<span class="r20 r">runspaceList</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when RunspaceState changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract event</b> <span class="i">EventHandler</span>&lt;<a href="#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a>&gt; <a id="6866e88f64eb13d6" href="../../R/6866e88f64eb13d6.html" target="n" data-glyph="30,1" class="i">StateChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when the availability of the Runspace changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract event</b> <span class="i">EventHandler</span>&lt;<a href="#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a>&gt; <a id="3cd2a1e80935c2fb" href="../../R/3cd2a1e80935c2fb.html" target="n" data-glyph="30,1" class="i">AvailabilityChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if there are any subscribers to the AvailabilityChanged event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract bool</b> <a id="d6a5f8848cdbcae5" href="../../R/d6a5f8848cdbcae5.html" target="n" data-glyph="104,1" class="i property">HasAvailabilityChangedSubscribers</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the AvailabilityChanged event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected abstract void</b> <a id="64edda76328664b8" href="../../R/64edda76328664b8.html" target="n" data-glyph="75,1" class="i method">OnAvailabilityChanged</a>(<a href="#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a> <span id="r23 rd" class="r23 r">e</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to raise the AvailabilityChanged event when the state of the currently executing pipeline changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The possible pipeline states are</span>
        <span class="c">///</span><span class="c">     NotStarted</span>
        <span class="c">///</span><span class="c">     Running</span>
        <span class="c">///</span><span class="c">     Disconnected</span>
        <span class="c">///</span><span class="c">     Stopping</span>
        <span class="c">///</span><span class="c">     Stopped</span>
        <span class="c">///</span><span class="c">     Completed</span>
        <span class="c">///</span><span class="c">     Failed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="245028b8feaec094" href="../../R/245028b8feaec094.html" target="n" data-glyph="74,1" class="i method">UpdateRunspaceAvailability</a>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r24 rd" class="r24 r">pipelineState</span>, <b>bool</b> <span id="r25 rd" class="r25 r">raiseEvent</span>, <span class="i">Guid</span>? <span id="r26 rd" class="r26 r">cmdInstanceId</span> = <b>null</b>)
        {
            <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r27 rd" class="r27 r">oldAvailability</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>;
 
            <b>switch</b> (<span class="r27 r">oldAvailability</span>)
            {
                <span class="c">// Because of disconnect/connect support runspace availability can now transition</span>
                <span class="c">// in and out of &quot;None&quot; state.</span>
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#a5172055c7a11352" class="i field">None</a>:
                    <b>switch</b> (<span class="r24 r">pipelineState</span>)
                    {
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                            <b>break</b>;
 
                            <span class="c">// Otherwise no change.</span>
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>:
                    <b>switch</b> (<span class="r24 r">pipelineState</span>)
                    {
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                            <b>break</b>;
 
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#a5172055c7a11352" class="i field">None</a>;
                            <b>break</b>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#7d8f97430ae71e2a" class="i field">AvailableForNestedCommand</a>:
                    <b>switch</b> (<span class="r24 r">pipelineState</span>)
                    {
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                            <b>break</b>;
 
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>: <span class="c">// a nested pipeline caused the host to exit nested prompt</span>
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = (<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#9eaabbb739daf5e4" class="i property">InNestedPrompt</a> || (<a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Count</span> &gt; 1)) ?
                                <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#7d8f97430ae71e2a" class="i field">AvailableForNestedCommand</a> : <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>;
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>break</b>; <span class="c">// no change in the availability</span>
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>:
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>:
                    <b>switch</b> (<span class="r24 r">pipelineState</span>)
                    {
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                            <b>if</b> (<span class="r27 r">oldAvailability</span> == <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>)
                            {
                                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>;
                            }
                            <b>else</b>
                            {
                                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#a5172055c7a11352" class="i field">None</a>;
                            }
 
                            <b>break</b>;
 
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#17a7706ccaf63f5c" class="i field">Stopping</a>:
                            <b>break</b>; <span class="c">// no change in the availability</span>
 
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>:
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>:
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>:
                            <b>if</b> (<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#9eaabbb739daf5e4" class="i property">InNestedPrompt</a>
                                || (<a href="#7e5b8eab1aa16fd7" class="k">this</a> <b>is not</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> &amp;&amp; <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../debugger/debugger.cs.html#564232f4b51d11aa" class="i property">InBreakpoint</a>))
                            {
                                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#7d8f97430ae71e2a" class="i field">AvailableForNestedCommand</a>;
                            }
                            <b>else</b>
                            {
                                <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r28 rd" class="r28 r">remoteRunspace</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a> <b>as</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                                <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a> <span id="r29 rd" class="r29 r">remoteDebugger</span> = (<span class="r28 r">remoteRunspace</span> != <b>null</b>) ? <span class="r28 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#8c26a63dda2acb44" class="i property">Debugger</a> <b>as</b> <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a> : <b>null</b>;
                                <span class="i n">Internal</span>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a> <span id="r30 rd" class="r30 r">remoteCommand</span> = <span class="r28 r">remoteRunspace</span>?.<a href="../remoting/client/remoterunspace.cs.html#c7d59b1aea27b0c9" class="i property">RemoteCommand</a>;
                                <b>if</b> (((<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>) || (<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>) ||
                                    ((<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>) &amp;&amp; (<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="#41627f067662d11c" class="i property">State</a> == <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#9a99efb0eaa3c3db" class="i field">Opened</a>)))
                                    &amp;&amp; (<span class="r30 r">remoteCommand</span> != <b>null</b>) &amp;&amp; (<span class="r26 r">cmdInstanceId</span> != <b>null</b>) &amp;&amp; (<span class="r30 r">remoteCommand</span>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1060192c0e7cff3a" class="i property">CommandId</a> == <span class="r26 r">cmdInstanceId</span>))
                                {
                                    <span class="c">// Completed, Failed, and Stopped with Runspace.Opened states are command finish states and we know</span>
                                    <span class="c">// that the command is finished on the server.</span>
                                    <span class="c">// Setting ConnectCommands to null indicates that the runspace is free to run other</span>
                                    <span class="c">// commands.</span>
                                    <span class="r28 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a> = <b>null</b>;
                                    <span class="r30 r">remoteCommand</span> = <b>null</b>;
 
                                    <b>if</b> ((<span class="r29 r">remoteDebugger</span> != <b>null</b>) &amp;&amp; (<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>))
                                    {
                                        <span class="c">// Notify remote debugger of a stop in case the stop occurred while command was in debug stop.</span>
                                        <span class="r29 r">remoteDebugger</span>.<a href="../remoting/client/remoterunspace.cs.html#1bd583216f620d9b" class="i method">OnCommandStopped</a>();
                                    }
                                }
 
                                <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r31 rd" class="r31 r">currentPipeline</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#9db062bececf98bd" class="i method">GetCurrentlyRunningPipeline</a>();
                                <a href="../remoting/client/remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r32 rd" class="r32 r">remotePipeline</span> = <span class="r31 r">currentPipeline</span> <b>as</b> <a href="../remoting/client/remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
                                <span class="i">Guid</span>? <span id="r33 rd" class="r33 r">pipeLineCmdInstance</span> = (<span class="r32 r">remotePipeline</span> != <b>null</b> &amp;&amp; <span class="r32 r">remotePipeline</span>.<a href="../remoting/client/remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a> != <b>null</b>) ? <span class="r32 r">remotePipeline</span>.<a href="../remoting/client/remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="PowerShell.cs.html#d8c9867186529e49" class="i property">InstanceId</a> : (<span class="i">Guid</span>?)<b>null</b>;
                                <b>if</b> (<span class="r31 r">currentPipeline</span> == <b>null</b>)
                                {
                                    <span class="c">// A runspace is available:</span>
                                    <span class="c">//  - if there is no currently running pipeline</span>
                                    <span class="c">//    and for remote runspaces:</span>
                                    <span class="c">//    - if there is no remote command associated with it.</span>
                                    <span class="c">//    - if the remote runspace pool is marked as available for connection.</span>
                                    <b>if</b> (<span class="r30 r">remoteCommand</span> == <b>null</b>)
                                    {
                                        <b>if</b> (<span class="r28 r">remoteRunspace</span> != <b>null</b>)
                                        {
                                            <b>if</b> ((<span class="r29 r">remoteDebugger</span> != <b>null</b>) &amp;&amp; (<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>))
                                            {
                                                <span class="c">// Notify remote debugger of a stop in case the stop occurred while command was in debug stop.</span>
                                                <span class="r29 r">remoteDebugger</span>.<a href="../remoting/client/remoterunspace.cs.html#1bd583216f620d9b" class="i method">OnCommandStopped</a>();
                                            }
 
                                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> =
                                                <span class="r28 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#e9793c4f5c63d814" class="i property">AvailableForConnection</a> ?
                                                <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a> : <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                                        }
                                        <b>else</b>
                                        {
                                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>;
                                        }
                                    }
                                }
                                <b>else</b> <b>if</b> ((<span class="r26 r">cmdInstanceId</span> != <b>null</b>) &amp;&amp; (<span class="r33 r">pipeLineCmdInstance</span> != <b>null</b>) &amp;&amp; (<span class="r26 r">cmdInstanceId</span> == <span class="r33 r">pipeLineCmdInstance</span>))
                                {
                                    <b>if</b> ((<span class="r29 r">remoteDebugger</span> != <b>null</b>) &amp;&amp; (<span class="r24 r">pipelineState</span> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>))
                                    {
                                        <span class="c">// Notify remote debugger of a stop in case the stop occurred while command was in debug stop.</span>
                                        <span class="r29 r">remoteDebugger</span>.<a href="../remoting/client/remoterunspace.cs.html#1bd583216f620d9b" class="i method">OnCommandStopped</a>();
                                    }
 
                                    <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>;
                                }
                                <b>else</b> <span class="c">// a nested pipeline completed, but the parent pipeline is still running</span>
                                {
                                    <b>if</b> (<span class="r27 r">oldAvailability</span> == <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>)
                                    {
                                        <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>;
                                    }
                                    <b>else</b> <b>if</b> ((<span class="r31 r">currentPipeline</span>.<a href="Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>) || (<a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Count</span> &gt; 1))
                                    {
                                        <span class="c">// Either the current pipeline is running or there are other nested commands to run in the Runspace.</span>
                                        <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                                    }
                                    <b>else</b>
                                    {
                                        <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>;
                                    }
                                }
                            }
 
                            <b>break</b>;
 
                        <b>case</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>: <span class="c">// this can happen if a nested pipeline is created without entering a nested prompt</span>
                            <b>break</b>; <span class="c">// no change in the availability</span>
 
                        <b>default</b>:
                            <b>break</b>; <span class="c">// no change in the availability</span>
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid RunspaceAvailability&quot;</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r25 r">raiseEvent</span> &amp;&amp; <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> != <span class="r27 r">oldAvailability</span>)
            {
                <a href="#64edda76328664b8" class="i method">OnAvailabilityChanged</a>(<b>new</b> <a href="#38ab95beeaebfcf6" class="t constructor">RunspaceAvailabilityEventArgs</a>(<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to update the runspace availability when the state of the currently executing PowerShell instance changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The possible invocation states are</span>
        <span class="c">///</span><span class="c">     NotStarted</span>
        <span class="c">///</span><span class="c">     Running</span>
        <span class="c">///</span><span class="c">     Stopping</span>
        <span class="c">///</span><span class="c">     Stopped</span>
        <span class="c">///</span><span class="c">     Completed</span>
        <span class="c">///</span><span class="c">     Failed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e29c803d055e4ad8" href="../../R/e29c803d055e4ad8.html" target="n" data-glyph="74,1" class="i method">UpdateRunspaceAvailability</a>(<a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a> <span id="r34 rd" class="r34 r">invocationState</span>, <b>bool</b> <span id="r35 rd" class="r35 r">raiseEvent</span>, <span class="i">Guid</span> <span id="r36 rd" class="r36 r">cmdInstanceId</span>)
        {
            <b>switch</b> (<span class="r34 r">invocationState</span>)
            {
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#3eb81f39bc769d16" class="i field">NotStarted</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#7142407e9e49cf13" class="i field">Running</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#89ec15a2a933a2b6" class="i field">Completed</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#35065a8449cad351" class="i field">Failed</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#a9d235bf0dc5bfce" class="i field">Stopping</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#17a7706ccaf63f5c" class="i field">Stopping</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#6a6866e7df063875" class="i field">Stopped</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="PowerShell.cs.html#55f5ed5d1c0f010a" class="i field">Disconnected</a>:
                    <span class="i">UpdateRunspaceAvailability</span>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>, <span class="r35 r">raiseEvent</span>, <span class="r36 r">cmdInstanceId</span>);
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid PSInvocationState&quot;</span>);
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to update the runspace availability event when the state of the runspace changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The possible runspace states are:</span>
        <span class="c">///</span><span class="c">     BeforeOpen</span>
        <span class="c">///</span><span class="c">     Opening</span>
        <span class="c">///</span><span class="c">     Opened</span>
        <span class="c">///</span><span class="c">     Closed</span>
        <span class="c">///</span><span class="c">     Closing</span>
        <span class="c">///</span><span class="c">     Broken</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="0c1c7b064191c408" href="../../R/0c1c7b064191c408.html" target="n" data-glyph="75,1" class="i method">UpdateRunspaceAvailability</a>(<a href="#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r37 rd" class="r37 r">runspaceState</span>, <b>bool</b> <span id="r38 rd" class="r38 r">raiseEvent</span>)
        {
            <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r39 rd" class="r39 r">oldAvailability</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>;
            <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r40 rd" class="r40 r">remoteRunspace</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a> <b>as</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
            <span class="i n">Internal</span>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a> <span id="r41 rd" class="r41 r">remoteCommand</span> = <b>null</b>;
            <b>bool</b> <span id="r42 rd" class="r42 r">remoteDebug</span> = <b>false</b>;
 
            <b>if</b> (<span class="r40 r">remoteRunspace</span> != <b>null</b>)
            {
                <span class="r41 r">remoteCommand</span> = <span class="r40 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#c7d59b1aea27b0c9" class="i property">RemoteCommand</a>;
                <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a> <span id="r43 rd" class="r43 r">remoteDebugger</span> = <span class="r40 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#8c26a63dda2acb44" class="i property">Debugger</a> <b>as</b> <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a>;
                <span class="r42 r">remoteDebug</span> = (<span class="r43 r">remoteDebugger</span> != <b>null</b>) &amp;&amp; <span class="r43 r">remoteDebugger</span>.<a href="../remoting/client/remoterunspace.cs.html#70fd830e8344b495" class="i property">IsRemoteDebug</a>;
            }
 
            <b>switch</b> (<span class="r39 r">oldAvailability</span>)
            {
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#a5172055c7a11352" class="i field">None</a>:
                    <b>switch</b> (<span class="r37 r">runspaceState</span>)
                    {
                        <b>case</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#9a99efb0eaa3c3db" class="i field">Opened</a>:
                            <b>if</b> (<span class="r42 r">remoteDebug</span>)
                            {
                                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <span class="i n">Runspaces</span>.<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>;
                            }
                            <b>else</b>
                            {
                                <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = (<span class="r41 r">remoteCommand</span> == <b>null</b> &amp;&amp; <a href="#9db062bececf98bd" class="i method">GetCurrentlyRunningPipeline</a>() == <b>null</b>) ?
                                    <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a> : <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>;
                            }
 
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>break</b>; <span class="c">// no change in the availability</span>
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#64bc5c5290cfb16d" class="i field">Available</a>:
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#7d8f97430ae71e2a" class="i field">AvailableForNestedCommand</a>:
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#244d7672812dd8a9" class="i field">RemoteDebug</a>:
                <b>case</b> <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#aed194b80737a544" class="i field">Busy</a>:
                    <b>switch</b> (<span class="r37 r">runspaceState</span>)
                    {
                        <b>case</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#fb276cb28f922b8e" class="i field">Closing</a>:
                        <b>case</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#45de84b67ba18f3f" class="i field">Closed</a>:
                        <b>case</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#e4c76740d99e58bd" class="i field">Broken</a>:
                        <b>case</b> <a href="#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="#0a8fc62a22d129a1" class="i field">Disconnected</a>:
                            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="#a5172055c7a11352" class="i field">None</a>;
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>break</b>; <span class="c">// no change in the availability</span>
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid RunspaceAvailability&quot;</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r38 r">raiseEvent</span> &amp;&amp; <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> != <span class="r39 r">oldAvailability</span>)
            {
                <a href="#64edda76328664b8" class="i method">OnAvailabilityChanged</a>(<b>new</b> <a href="#38ab95beeaebfcf6" class="t constructor">RunspaceAvailabilityEventArgs</a>(<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to update the runspace availability from Enter/ExitNestedPrompt and the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="222554c22c4a3071" href="../../R/222554c22c4a3071.html" target="n" data-glyph="74,1" class="i method">UpdateRunspaceAvailability</a>(<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r44 rd" class="r44 r">availability</span>, <b>bool</b> <span id="r45 rd" class="r45 r">raiseEvent</span>)
        {
            <a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r46 rd" class="r46 r">oldAvailability</span> = <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>;
 
            <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> = <span class="r44 r">availability</span>;
 
            <b>if</b> (<span class="r45 r">raiseEvent</span> &amp;&amp; <a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> != <span class="r46 r">oldAvailability</span>)
            {
                <a href="#64edda76328664b8" class="i method">OnAvailabilityChanged</a>(<b>new</b> <a href="#38ab95beeaebfcf6" class="t constructor">RunspaceAvailabilityEventArgs</a>(<a href="#7e5b8eab1aa16fd7" class="k">this</a>.<a href="#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the AvailabilityChanged event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d34adcc77325cd0e" href="../../R/d34adcc77325cd0e.html" target="n" data-glyph="74,1" class="i method">RaiseAvailabilityChangedEvent</a>(<a href="#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r47 rd" class="r47 r">availability</span>)
        {
            <a href="#64edda76328664b8" class="i method">OnAvailabilityChanged</a>(<b>new</b> <a href="#38ab95beeaebfcf6" class="t constructor">RunspaceAvailabilityEventArgs</a>(<span class="r47 r">availability</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> events
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public static methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspaces and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> objects associated with each disconnected runspace on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of Runspace objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>[] <a id="70aecb881c9b94a4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRunspaces</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r48 rd" class="r48 r">connectionInfo</span>)
        {
            <b>return</b> <a href="#6cfa88f31c104ee1" class="i method">GetRunspaces</a>(<span class="r48 r">connectionInfo</span>, <b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspaces and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> objects associated with each disconnected runspace on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of Runspace objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>[] <a id="2288c8663703855c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRunspaces</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r49 rd" class="r49 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r50 rd" class="r50 r">host</span>)
        {
            <b>return</b> <a href="#6cfa88f31c104ee1" class="i method">GetRunspaces</a>(<span class="r49 r">connectionInfo</span>, <span class="r50 r">host</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspaces and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> objects associated with each disconnected runspace on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeTable object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of Runspace objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a>[] <a id="6cfa88f31c104ee1" href="../../R/6cfa88f31c104ee1.html" target="n" data-glyph="72,1" class="i method">GetRunspaces</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r51 rd" class="r51 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r52 rd" class="r52 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r53 rd" class="r53 r">typeTable</span>)
        {
            <b>return</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>.<a href="../remoting/client/remoterunspace.cs.html#e1f63f7eb9dcb8c7" class="i method">GetRemoteRunspaces</a>(<span class="r51 r">connectionInfo</span>, <span class="r52 r">host</span>, <span class="r53 r">typeTable</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a single disconnected Runspace object targeted to the remote computer and remote</span>
        <span class="c">///</span><span class="c"> session as specified by the connection, session Id, and command Id parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">sessionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of a disconnected remote session on the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">commandId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional Id of a disconnected command running in the disconnected remote session on the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional TypeTable object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Disconnected runspace corresponding to the provided session Id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="efb6f2f24ee429bd" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRunspace</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r54 rd" class="r54 r">connectionInfo</span>, <span class="i">Guid</span> <span id="r55 rd" class="r55 r">sessionId</span>, <span class="i">Guid</span>? <span id="r56 rd" class="r56 r">commandId</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r57 rd" class="r57 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r58 rd" class="r58 r">typeTable</span>)
        {
            <b>return</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>.<a href="../remoting/client/remoterunspace.cs.html#6b92f18377ef4303" class="i method">GetRemoteRunspace</a>(<span class="r54 r">connectionInfo</span>, <span class="r55 r">sessionId</span>, <span class="r56 r">commandId</span>, <span class="r57 r">host</span>, <span class="r58 r">typeTable</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public Disconnect-Connect methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the remote runspace and any running command from the server</span>
        <span class="c">///</span><span class="c"> machine.  Any data generated by the running command on the server is</span>
        <span class="c">///</span><span class="c"> cached on the server machine.  This runspace object goes to the disconnected</span>
        <span class="c">///</span><span class="c"> state.  This object can be reconnected to the server by calling the</span>
        <span class="c">///</span><span class="c"> Connect() method.</span>
        <span class="c">///</span><span class="c"> If the remote runspace on the server remains disconnected for the IdleTimeout</span>
        <span class="c">///</span><span class="c"> value (as defined in the WSManConnectionInfo object) then it is closed and</span>
        <span class="c">///</span><span class="c"> torn down on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="d77db63e9a8cef01" href="../../R/d77db63e9a8cef01.html" target="n" data-glyph="72,1" class="i method">Disconnect</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the remote runspace and any running command from the server</span>
        <span class="c">///</span><span class="c"> machine.  Any data generated by the running command on the server is</span>
        <span class="c">///</span><span class="c"> cached on the server machine.  This runspace object goes to the disconnected</span>
        <span class="c">///</span><span class="c"> state.  This object can be reconnected to the server by calling the</span>
        <span class="c">///</span><span class="c"> Connect() method.</span>
        <span class="c">///</span><span class="c"> If the remote runspace on the server remains disconnected for the IdleTimeout</span>
        <span class="c">///</span><span class="c"> value (as defined in the WSManConnectionInfo object) then it is closed and</span>
        <span class="c">///</span><span class="c"> torn down on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="a82aa053a9ec12b9" href="../../R/a82aa053a9ec12b9.html" target="n" data-glyph="72,1" class="i method">DisconnectAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace to its remote counterpart synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace object to its corresponding runspace on the target</span>
        <span class="c">///</span><span class="c"> server machine.  The target server machine is identified by the connection</span>
        <span class="c">///</span><span class="c"> object passed in during construction.  The remote runspace is identified</span>
        <span class="c">///</span><span class="c"> by the internal runspace Guid value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="5ab796b4379fd0be" href="../../R/5ab796b4379fd0be.html" target="n" data-glyph="72,1" class="i method">Connect</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects a runspace to its remote counterpart asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace object to its corresponding runspace on the target</span>
        <span class="c">///</span><span class="c"> server machine.  The target server machine is identified by the connection</span>
        <span class="c">///</span><span class="c"> object passed in during construction.  The remote runspace is identified</span>
        <span class="c">///</span><span class="c"> by the internal runspace Guid value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="2628903b4c875458" href="../../R/2628903b4c875458.html" target="n" data-glyph="72,1" class="i method">ConnectAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PipeLine object in the disconnected state for the currently disconnected</span>
        <span class="c">///</span><span class="c"> remote running command associated with this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Pipeline object in disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="2d7cc995dfa514f7" href="../../R/2d7cc995dfa514f7.html" target="n" data-glyph="72,1" class="i method">CreateDisconnectedPipeline</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PowerShell object in the disconnected state for the currently disconnected</span>
        <span class="c">///</span><span class="c"> remote running command associated with this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell object in disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="f49d7fa8285cd9e9" href="../../R/f49d7fa8285cd9e9.html" target="n" data-glyph="72,1" class="i method">CreateDisconnectedPowerShell</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns Runspace capabilities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspaceCapability.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#381534d5ae10528e" class="t t">RunspaceCapability</a> <a id="fe69633e6a064a75" href="../../R/fe69633e6a064a75.html" target="n" data-glyph="72,1" class="i method">GetCapabilities</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Opens the runspace synchronously. Runspace must be opened before it can be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not BeforeOpen</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="61f55439fb78f2fe" href="../../R/61f55439fb78f2fe.html" target="n" data-glyph="72,1" class="i method">Open</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Open the runspace Asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not BeforeOpen</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="858e8bf18cbd4974" href="../../R/858e8bf18cbd4974.html" target="n" data-glyph="72,1" class="i method">OpenAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Close the runspace synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to execute pipelines after a call to close will fail.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is BeforeOpen or Opening</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="e7b6aa3b7b07847b" href="../../R/e7b6aa3b7b07847b.html" target="n" data-glyph="72,1" class="i method">Close</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Close the runspace Asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to execute pipelines after a call to</span>
        <span class="c">///</span><span class="c"> close will fail.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is BeforeOpen or Opening</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="b80600fd33c9653e" href="../../R/b80600fd33c9653e.html" target="n" data-glyph="72,1" class="i method">CloseAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create an empty pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An empty pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="1aec41f4f0133089" href="../../R/1aec41f4f0133089.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a pipeline for specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object for specified command parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="1502e332cc9711dc" href="../../R/1502e332cc9711dc.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>(<b>string</b> <span id="r59 rd" class="r59 r">command</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a pipeline from a command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true command is added to history.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object for specified command parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="03ca63234015a955" href="../../R/03ca63234015a955.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>(<b>string</b> <span id="r60 rd" class="r60 r">command</span>, <b>bool</b> <span id="r61 rd" class="r61 r">addToHistory</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a nested pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Nested pipelines are needed for nested prompt scenario. Nested</span>
        <span class="c">///</span><span class="c"> prompt requires that we execute new pipelines( child pipelines)</span>
        <span class="c">///</span><span class="c"> while current pipeline (lets call it parent pipeline) is blocked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="bd3b155c737daaa9" href="../../R/bd3b155c737daaa9.html" target="n" data-glyph="72,1" class="i method">CreateNestedPipeline</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a nested pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true command is added to history.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with Command specified in commandString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="f2343c85865d3dd2" href="../../R/f2343c85865d3dd2.html" target="n" data-glyph="72,1" class="i method">CreateNestedPipeline</a>(<b>string</b> <span id="r62 rd" class="r62 r">command</span>, <b>bool</b> <span id="r63 rd" class="r63 r">addToHistory</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the currently executing pipeline,  or null if no pipeline is executing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract</b> <a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="9db062bececf98bd" href="../../R/9db062bececf98bd.html" target="n" data-glyph="74,1" class="i method">GetCurrentlyRunningPipeline</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Private data to be used by applications built on top of PowerShell.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Local runspace is created with application private data set to an empty </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Remote runspace gets its application private data from the server (set when creating a remote runspace pool)</span>
        <span class="c">///</span><span class="c"> Calling this method on a remote runspace will block until the data is received from the server.</span>
        <span class="c">///</span><span class="c"> The server will send application private data before reaching </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="RunspacePool.cs.html#13cbf83371c004e0" class="i field">Opened</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> state.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Runspaces that are part of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> inherit application private data from the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="0d77ad561d46f843" href="../../R/0d77ad561d46f843.html" target="n" data-glyph="72,1" class="i method">GetApplicationPrivateData</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A method that runspace pools can use to propagate application private data into runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">applicationPrivateData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal abstract void</b> <a id="29711178c3474b0a" href="../../R/29711178c3474b0a.html" target="n" data-glyph="74,1" class="i method">SetApplicationPrivateData</a>(<a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r64 rd" class="r64 r">applicationPrivateData</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Push a running PowerShell onto the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">ps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6da72b8c11307bb9" href="../../R/6da72b8c11307bb9.html" target="n" data-glyph="74,1" class="i method">PushRunningPowerShell</a>(<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r65 rd" class="r65 r">ps</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r65 r">ps</span> != <b>null</b>, <span class="s">&quot;Caller should not pass in null reference.&quot;</span>);
 
            <b>lock</b> (<a href="#fc732403083d9584" class="i field">_syncObject</a>)
            {
                <a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Push</span>(<span class="r65 r">ps</span>);
 
                <b>if</b> (<a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Count</span> == 1)
                {
                    <a href="#1830bb0a97962270" class="i field">_baseRunningPowerShell</a> = <span class="r65 r">ps</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pop the currently running PowerShell from stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="32999824f64df748" href="../../R/32999824f64df748.html" target="n" data-glyph="74,1" class="i method">PopRunningPowerShell</a>()
        {
            <b>lock</b> (<a href="#fc732403083d9584" class="i field">_syncObject</a>)
            {
                <b>int</b> <span id="r66 rd" class="r66 r">count</span> = <a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Count</span>;
 
                <b>if</b> (<span class="r66 r">count</span> &gt; 0)
                {
                    <b>if</b> (<span class="r66 r">count</span> == 1) { <a href="#1830bb0a97962270" class="i field">_baseRunningPowerShell</a> = <b>null</b>; }
 
                    <b>return</b> <a href="#92adc4130c72b7f5" class="i field">_runningPowerShells</a>.<span class="i">Pop</span>();
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="edb618fe46065750" href="../../R/edb618fe46065750.html" target="n" data-glyph="74,1" class="i method">GetCurrentBasePowerShell</a>()
        {
            <b>return</b> <a href="#1830bb0a97962270" class="i field">_baseRunningPowerShell</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SessionStateProxy
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets session state proxy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#6d877a4c99871852" class="t t">SessionStateProxy</a> <a id="c43f0c90447752e8" href="../../R/c43f0c90447752e8.html" target="n" data-glyph="102,1" class="i property">SessionStateProxy</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1c6db272333043a1" class="i method">GetSessionStateProxy</a>();
            }
        }
 
        <b>internal abstract</b> <a href="#6d877a4c99871852" class="t t">SessionStateProxy</a> <a id="1c6db272333043a1" href="../../R/1c6db272333043a1.html" target="n" data-glyph="74,1" class="i method">GetSessionStateProxy</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SessionStateProxy
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disposes this runspace instance. Dispose will close the runspace if not closed already.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="47cd985e55a9f99c" href="../../R/47cd985e55a9f99c.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#86b34aeb9ee1837f" class="i method">Dispose</a>(<b>true</b>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#7e5b8eab1aa16fd7" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Protected dispose which can be overridden by derived classes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="86b34aeb9ee1837f" href="../../R/86b34aeb9ee1837f.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r67 rd" class="r67 r">disposing</span>)
        {
            <b>lock</b> (<a href="#9d51235ffd4ca8b4" class="i field">s_syncObject</a>)
            {
                <a href="#47df08753c3a22f9" class="i field">s_runspaceDictionary</a>.<span class="i">Remove</span>(<a href="#65a113758fdf9ce2" class="i property">Id</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the execution context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="ade98325afa63ad9" href="../../R/ade98325afa63ad9.html" target="n" data-glyph="104,1" class="i property">GetExecutionContext</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the internal host is in a nested prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract bool</b> <a id="9eaabbb739daf5e4" href="../../R/9eaabbb739daf5e4.html" target="n" data-glyph="104,1" class="i property">InNestedPrompt</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="d6610640d00b19f5" href="../../R/d6610640d00b19f5.html" target="n" data-glyph="102,1" class="i property">Debugger</a>
        {
            <b>get</b>
            {
                <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r68 rd" class="r68 r">context</span> = <a href="#ade98325afa63ad9" class="i property">GetExecutionContext</a>;
                <b>return</b> <span class="r68 r">context</span>?.<a href="../ExecutionContext.cs.html#3e56b2d709de0d80" class="i property">Debugger</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InternalDebugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="6a2e76958c3789aa" href="../../R/6a2e76958c3789aa.html" target="n" data-glyph="104,1" class="i property">InternalDebugger</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the event manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../EventManager.cs.html#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="76f15a0f04e941d7" href="../../R/76f15a0f04e941d7.html" target="n" data-glyph="102,1" class="i property">Events</a>
        {
            <b>get</b>;
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// Transaction Not Supported On CSS</span>
<span class="e">        /// &lt;summary&gt;
        /// Sets the base transaction for the runspace; any transactions created on this runspace will be nested to this instance.
        /// &lt;/summary&gt;
        ///&lt;param name=&quot;transaction&quot;&gt;The base transaction&lt;/param&gt;
        ///&lt;remarks&gt;This overload uses RollbackSeverity.Error; i.e. the transaction will be rolled back automatically on a non-terminating error or worse&lt;/remarks&gt;
        public void SetBaseTransaction(System.Transactions.CommittableTransaction transaction)
        {
            this.ExecutionContext.TransactionManager.SetBaseTransaction(transaction, RollbackSeverity.Error);
        }
 
        /// &lt;summary&gt;
        /// Sets the base transaction for the runspace; any transactions created on this runspace will be nested to this instance.
        /// &lt;/summary&gt;
        ///&lt;param name=&quot;transaction&quot;&gt;The base transaction&lt;/param&gt;
        ///&lt;param name=&quot;severity&quot;&gt;The severity of error that causes PowerShell to automatically rollback the transaction&lt;/param&gt;
        public void SetBaseTransaction(System.Transactions.CommittableTransaction transaction, RollbackSeverity severity)
        {
            this.ExecutionContext.TransactionManager.SetBaseTransaction(transaction, severity);
        }
 
        /// &lt;summary&gt;
        /// Clears the transaction set by SetBaseTransaction()
        /// &lt;/summary&gt;
        public void ClearBaseTransaction()
        {
            this.ExecutionContext.TransactionManager.ClearBaseTransaction();
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the variable table for the runspace to the default state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="e6bf912efd51943c" href="../../R/e6bf912efd51943c.html" target="n" data-glyph="72,1" class="i method">ResetRunspaceState</a>()
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;ResetRunspaceState&quot;</span>);
        }
 
        <span class="c">// Used for pipeline id generation.</span>
        <b>private long</b> <a id="ee06fe51dabed187" href="../../R/ee06fe51dabed187.html" target="n" data-glyph="46,1" class="i field">_pipelineIdSeed</a>;
 
        <span class="c">// Generate pipeline id unique to this runspace</span>
        <b>internal long</b> <a id="c09b3477caeb9033" href="../../R/c09b3477caeb9033.html" target="n" data-glyph="74,1" class="i method">GeneratePipelineId</a>()
        {
            <b>return</b> <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#ee06fe51dabed187" class="i field">_pipelineIdSeed</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class provides subset of functionality provided by</span>
    <span class="c">///</span><span class="c"> session state.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="6d877a4c99871852" href="../../R/6d877a4c99871852.html" target="n" data-glyph="0,0" class="t t">SessionStateProxy</a>
    {
        <b>internal</b> <a id="f52511db8396263f" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">SessionStateProxy</a>()
        {
        }
 
        <b>private readonly</b> <a href="ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a> <a id="be6043f2af9f9cbd" href="../../R/be6043f2af9f9cbd.html" target="n" data-glyph="46,1" class="i field">_runspace</a>;
 
        <b>internal</b> <a id="ee2dd6f050844b6e" href="../../R/ee2dd6f050844b6e.html" target="n" data-glyph="74,1" class="t constructor">SessionStateProxy</a>(<a href="ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a> <span id="r69 rd" class="r69 r">runspace</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r69 r">runspace</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#be6043f2af9f9cbd" class="i field">_runspace</a> = <span class="r69 r">runspace</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set a variable in session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new value of the item being set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="bed15b59c6d427ee" href="../../R/bed15b59c6d427ee.html" target="n" data-glyph="72,1" class="i method">SetVariable</a>(<b>string</b> <span id="r70 rd" class="r70 r">name</span>, <b>object</b> <span id="r71 rd" class="r71 r">value</span>)
        {
            <b>if</b> (<span class="r70 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r70 r">name</span>));
            }
 
            <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#29070ac2e154913a" class="i method">SetVariable</a>(<span class="r70 r">name</span>, <span class="r71 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a variable out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name of variable to look up</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the specified variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual object</b> <a id="924ecee19da69970" href="../../R/924ecee19da69970.html" target="n" data-glyph="72,1" class="i method">GetVariable</a>(<b>string</b> <span id="r72 rd" class="r72 r">name</span>)
        {
            <b>if</b> (<span class="r72 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r72 r">name</span>));
            }
 
            <b>if</b> (<span class="r72 r">name</span>.<span class="i">Equals</span>(<b>string</b>.<span class="i">Empty</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#9ac34d62c60b0a93" class="i method">GetVariable</a>(<span class="r72 r">name</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the list of applications out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="5b568c2081e503bb" href="../../R/5b568c2081e503bb.html" target="n" data-glyph="102,1" class="i property">Applications</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#41f7f36dc9b4f5ce" class="i property">Applications</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the list of scripts out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="67b0b1e17f1b4742" href="../../R/67b0b1e17f1b4742.html" target="n" data-glyph="102,1" class="i property">Scripts</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#fceca1d7d0e9aadb" class="i property">Scripts</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access drives out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../DriveInterfaces.cs.html#af7db3a0f716ab5e" class="t t">DriveManagementIntrinsics</a> <a id="13e62d1b1e5435bb" href="../../R/13e62d1b1e5435bb.html" target="n" data-glyph="102,1" class="i property">Drive</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#975dc2cbb34f3346" class="i property">Drive</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/Set the language mode out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="ccb77bd743e72d6c" href="../../R/ccb77bd743e72d6c.html" target="n" data-glyph="102,1" class="i property">LanguageMode</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#3e01efb312e1de02" class="i property">LanguageMode</a>; }
 
            <b>set</b> { <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#3e01efb312e1de02" class="i property">LanguageMode</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the module info out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1716:IdentifiersShouldNotMatchKeywords&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Shipped this way in V2 before becoming virtual.&quot;</span>)]
        <b>public virtual</b> <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="2310b3a28441f482" href="../../R/2310b3a28441f482.html" target="n" data-glyph="102,1" class="i property">Module</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#3c0917b36b459b23" class="i property">Module</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access paths and locations out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../PathInterfaces.cs.html#2a45e8d71562122c" class="t t">PathIntrinsics</a> <a id="7d2fc73635b4cc4d" href="../../R/7d2fc73635b4cc4d.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#21dfc834a9d0c791" class="i property">PathIntrinsics</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access a provider out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../ProviderInterfaces.cs.html#5df802574bbd2fbe" class="t t">CmdletProviderManagementIntrinsics</a> <a id="0bef6b52a0c3c416" href="../../R/0bef6b52a0c3c416.html" target="n" data-glyph="102,1" class="i property">Provider</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#c9a00561e34ae8f4" class="i property">Provider</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access variables out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../VariableInterfaces.cs.html#a66e215a6e6c92d5" class="t t">PSVariableIntrinsics</a> <a id="b5bceaae9ec5aba0" href="../../R/b5bceaae9ec5aba0.html" target="n" data-glyph="102,1" class="i property">PSVariable</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#bd66404c3b59d900" class="i property">PSVariable</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to build script blocks and execute script out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../MshCmdlet.cs.html#444c098e64ffcf20" class="t t">CommandInvocationIntrinsics</a> <a id="7b4fd642c95f5526" href="../../R/7b4fd642c95f5526.html" target="n" data-glyph="102,1" class="i property">InvokeCommand</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#9e67e5f19e3f3d5d" class="i property">InvokeCommand</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the instance of the provider interface APIs out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../CmdletFamilyProviderInterfaces.cs.html#7e7c55aa110a0320" class="t t">ProviderIntrinsics</a> <a id="ff210deb7e6c57d4" href="../../R/ff210deb7e6c57d4.html" target="n" data-glyph="102,1" class="i property">InvokeProvider</a>
        {
            <b>get</b> { <b>return</b> <a href="#be6043f2af9f9cbd" class="i field">_runspace</a>.<a href="ConnectionBase.cs.html#4d23d466c01a6b9c" class="i property">InvokeProvider</a>; }
        }
    }
}
</pre></td></tr></table></div></body></html>
