<!DOCTYPE html>
<html><head><title>MshHost.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(324);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/MshHost.cs" target="_top">engine\hostifaces\MshHost.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the properties and facilities providing by an application hosting an MSH </span><span class="c">&lt;</span><span class="c">see</span>
    <span class="c">///</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A hosting application derives from this class and</span>
    <span class="c">///</span><span class="c"> overrides the abstract methods and properties.  The hosting application creates an instance of its derived class and</span>
    <span class="c">///</span><span class="c"> passes it to the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> CreateRunspace method.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> From the moment that the instance of the derived class (the &quot;host class&quot;) is passed to CreateRunspace, the MSH runtime</span>
    <span class="c">///</span><span class="c"> can call any of the methods of that class.  The instance must not be destroyed until after the Runspace is closed.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> There is a 1:1 relationship between the instance of the host class and the Runspace instance to which it is passed.  In</span>
    <span class="c">///</span><span class="c"> other words, it is not legal to pass the same instance of the host class to more than one call to CreateRunspace.  (It</span>
    <span class="c">///</span><span class="c"> is perfectly legal to call CreateRunspace more than once, as long as each call is supplied a unique instance of the host</span>
    <span class="c">///</span><span class="c"> class.)</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Methods of the host class can be called by the Runspace or any cmdlet or script executed in that Runspace in any order</span>
    <span class="c">///</span><span class="c"> and from any thread.  It is the responsibility of the hosting application to define the host class methods in a</span>
    <span class="c">///</span><span class="c"> threadsafe fashion.  An implementation of the host class should not depend on method execution order.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The instance of the host class that is passed to a Runspace is exposed by the Runspace to the cmdlets, scripts, and</span>
    <span class="c">///</span><span class="c"> providers that are executed in that Runspace.  Scripts access the host class via the $Host built-in variable.  Cmdlets</span>
    <span class="c">///</span><span class="c"> access the host via the Host property of the Cmdlet base class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostRawUserInterface.cs.html#74913c6687237500" class="t t">PSHostRawUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <b>public abstract class</b> <a id="7b79cd90e035740e" href="../../R/7b79cd90e035740e.html" target="n" data-glyph="0,0" class="t t">PSHost</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The powershell spec states that 128 is the maximum nesting depth.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="c04c519b7fce1f55" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MaximumNestedPromptLevel</a> = 128;
 
        <b>internal static bool</b> <a id="b936eb9e76070724" href="../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">IsStdOutputRedirected</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Protected constructor which does nothing.  Provided per .Net design guidelines section 4.3.1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="b6bd75a81bfe9c38" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">PSHost</a>()
        {
            <span class="c">// do nothing</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the hosting application&#39;s identification in some user-friendly fashion. This name can be referenced by scripts and cmdlets</span>
        <span class="c">///</span><span class="c"> to identify the host that is executing them.  The format of the value is not defined, but a short, simple string is</span>
        <span class="c">///</span><span class="c"> recommended.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In implementing this member, you should return some sort of informative string describing the nature</span>
        <span class="c">///</span><span class="c"> your hosting application. For the default console host shipped by Microsoft this is ConsoleHost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name identifier of the hosting application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">MSH</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         if ($Host.Name -ieq &quot;ConsoleHost&quot;) { write-host &quot;I&#39;m running in the Console Host&quot; }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">MSH</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="be091ea30a661c13" href="../../R/be091ea30a661c13.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the version of the hosting application.  This value should remain invariant for a particular build of the</span>
        <span class="c">///</span><span class="c"> host.  This value may be referenced by scripts and cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When implementing this member, it should return the product version number for the product</span>
        <span class="c">///</span><span class="c"> that is hosting the Monad engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The version number of the hosting application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i">Version</span> <a id="0cc2fd05fb98c219" href="../../R/0cc2fd05fb98c219.html" target="n" data-glyph="102,1" class="i property">Version</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a GUID that uniquely identifies this instance of the host.  The value should remain invariant for the lifetime of</span>
        <span class="c">///</span><span class="c"> this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i">Guid</span> <a id="0ef3ebc6fae0f13d" href="../../R/0ef3ebc6fae0f13d.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the hosting application&#39;s implementation of the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> abstract base class. A host</span>
        <span class="c">///</span><span class="c"> that does not want to support user interaction should return null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A reference to an instance of the hosting application&#39;s implementation of a class derived from</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or null to indicate that user</span>
        <span class="c">///</span><span class="c"> interaction is not supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The implementation of this routine should return an instance of the appropriate</span>
        <span class="c">///</span><span class="c"> implementation of PSHostUserInterface for this application. As an alternative,</span>
        <span class="c">///</span><span class="c"> for simple scenarios, just returning null is sufficient.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <a id="f3c3c89a5e9dd42a" href="../../R/f3c3c89a5e9dd42a.html" target="n" data-glyph="102,1" class="i property">UI</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the host&#39;s culture: the culture that the runspace should use to set the CurrentCulture on new threads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CultureInfo object representing the host&#39;s current culture.  Returning null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace will set the thread current culture to this value each time it starts a pipeline. Thus, cmdlets are</span>
        <span class="c">///</span><span class="c"> encouraged to use Thread.CurrentThread.CurrentCulture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span> <a id="d531244924cf2614" href="../../R/d531244924cf2614.html" target="n" data-glyph="102,1" class="i property">CurrentCulture</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the host&#39;s UI culture: the culture that the runspace and cmdlets should use to do resource loading.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The runspace will set the thread current ui culture to this value each time it starts a pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CultureInfo object representing the host&#39;s current UI culture.  Returning null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span> <a id="0aea5ccb4133325b" href="../../R/0aea5ccb4133325b.html" target="n" data-glyph="102,1" class="i property">CurrentUICulture</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Request by the engine to end the current engine runspace (to shut down and terminate the host&#39;s root runspace).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is called by the engine to request the host shutdown the engine.  This is invoked by the exit keyword</span>
        <span class="c">///</span><span class="c"> or by any other facility by which a runspace instance wishes to be shut down.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> To honor this request, the host should stop accepting and submitting commands to the engine and close the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">exitCode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exit code accompanying the exit keyword. Typically, after exiting a runspace, a host will also terminate. The</span>
        <span class="c">///</span><span class="c"> exitCode parameter can be used to set the host&#39;s process exit code.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="cee507197716baad" href="../../R/cee507197716baad.html" target="n" data-glyph="72,1" class="i method">SetShouldExit</a>(<b>int</b> <span id="r0 rd" class="r0 r">exitCode</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instructs the host to interrupt the currently running pipeline and start a new, &quot;nested&quot; input loop, where an input</span>
        <span class="c">///</span><span class="c"> loop is the cycle of prompt, input, execute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Typically called by the engine in response to some user action that suspends the currently executing pipeline, such</span>
        <span class="c">///</span><span class="c"> as choosing the &quot;suspend&quot; option of a ConfirmProcessing call. Before calling this method, the engine should set</span>
        <span class="c">///</span><span class="c"> various shell variables to the express the state of the interrupted input loop (current pipeline, current object in</span>
        <span class="c">///</span><span class="c"> pipeline, depth of nested input loops, etc.)</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> A non-interactive host may throw a &quot;not implemented&quot; exception here.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the UI property returns null, the engine should not call this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span><span class="c">Was: ExecuteSubShell.  &quot;subshell&quot; implies a new child engine, which is not the case here.  This is called during the</span>
        <span class="c">///</span><span class="c"> interruption of a pipeline to allow nested pipeline(s) to be run as a way to the user to suspend execution while he</span>
        <span class="c">///</span><span class="c"> evaluates other commands.  It does not create a truly new engine instance with new session state.</span><span class="c">--&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#7b79cd90e035740e" class="t t">PSHost</a>.<a href="#2b536a9ba3c83a0b" class="i method">ExitNestedPrompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="eaf1c9286d38d5b7" href="../../R/eaf1c9286d38d5b7.html" target="n" data-glyph="72,1" class="i method">EnterNestedPrompt</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Causes the host to end the currently running input loop.  If the input loop was created by a prior call to</span>
        <span class="c">///</span><span class="c"> EnterNestedPrompt, the enclosing pipeline will be resumed.  If the current input loop is the top-most loop, then the</span>
        <span class="c">///</span><span class="c"> host will act as though SetShouldExit was called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Typically called by the engine in response to some user action that resumes a suspended pipeline, such as with the</span>
        <span class="c">///</span><span class="c"> &#39;continue-command&#39; intrinsic cmdlet. Before calling this method, the engine should clear out the loop-specific</span>
        <span class="c">///</span><span class="c"> variables that were set when the loop was created.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the UI Property returns a null, the engine should not call this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#eaf1c9286d38d5b7" class="i method">EnterNestedPrompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="2b536a9ba3c83a0b" href="../../R/2b536a9ba3c83a0b.html" target="n" data-glyph="72,1" class="i method">ExitNestedPrompt</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to allow the host to pass private data through a Runspace to cmdlets running inside that Runspace&#39;s</span>
        <span class="c">///</span><span class="c"> runspace.  The type and nature of that data is entirely defined by the host, but there are some caveats:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default implementation returns null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the host is using an out-of-process Runspace, then the value of this property is serialized when crossing</span>
        <span class="c">///</span><span class="c"> that process boundary in the same fashion as any object in a pipeline is serialized when crossing process boundaries.</span>
        <span class="c">///</span><span class="c"> In this case, the BaseObject property of the value will be null.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the host is using an in-process Runspace, then the BaseObject property can be a non-null value a live object.</span>
        <span class="c">///</span><span class="c"> No guarantees are made as to the app domain or thread that the BaseObject is accessed if it is accessed in the</span>
        <span class="c">///</span><span class="c"> runspace. No guarantees of threadsafety or reentrancy are made.  The object set in the BaseObject property of</span>
        <span class="c">///</span><span class="c"> the value returned by this method is responsible for ensuring its own threadsafety and re-entrance safety.</span>
        <span class="c">///</span><span class="c"> Note that thread(s) accessing that object may not necessarily be the same from one access to the next.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The return value should have value-semantics: that is, changes to the state of the instance returned are not</span>
        <span class="c">///</span><span class="c"> reflected across processes.  Ex: if a cmdlet reads this property, then changes the state of the result, that</span>
        <span class="c">///</span><span class="c"> change will not be visible to the host if the host is in another process.  Therefore, the implementation of</span>
        <span class="c">///</span><span class="c"> get for this property should always return a unique instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="ab8699cef7eb001a" href="../../R/ab8699cef7eb001a.html" target="n" data-glyph="102,1" class="i property">PrivateData</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by the engine to notify the host that it is about to execute a &quot;legacy&quot; command line application.  A legacy</span>
        <span class="c">///</span><span class="c"> application is defined as a console-mode executable that may do one or more of the following:</span>
        <span class="c">///</span><span class="c"> . reads from stdin</span>
        <span class="c">///</span><span class="c"> . writes to stdout</span>
        <span class="c">///</span><span class="c"> . writes to stderr</span>
        <span class="c">///</span><span class="c"> . uses any of the win32 console APIs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Notifying the host allows the host to do such things as save off any state that might need to be restored when the</span>
        <span class="c">///</span><span class="c"> legacy application terminates, set or remove break handler hooks, redirect stream handles, and so forth.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The engine will always call this method and the NotifyEndApplication method in matching pairs.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The engine may call this method several times in the course of a single pipeline.  For instance, the pipeline:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> foo.exe | bar-cmdlet | baz.exe</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Will result in a sequence of calls similar to the following:</span>
        <span class="c">///</span><span class="c"> NotifyBeginApplication - called once when foo.exe is started</span>
        <span class="c">///</span><span class="c"> NotifyBeginApplication - called once when baz.exe is started</span>
        <span class="c">///</span><span class="c"> NotifyEndApplication - called once when baz.exe terminates</span>
        <span class="c">///</span><span class="c"> NotifyEndApplication - called once when foo.exe terminates</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Note that the order in which the NotifyEndApplication call follows the corresponding call to NotifyBeginApplication</span>
        <span class="c">///</span><span class="c"> with respect to any other call to NotifyBeginApplication is not defined, and should not be depended upon.  In other</span>
        <span class="c">///</span><span class="c"> words, NotifyBeginApplication may be called several times before NotifyEndApplication is called.  The only thing</span>
        <span class="c">///</span><span class="c"> that is guaranteed is that there will be an equal number of calls to NotifyEndApplication as to</span>
        <span class="c">///</span><span class="c"> NotifyBeginApplication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#7b79cd90e035740e" class="t t">PSHost</a>.<a href="#112d71f653f639d8" class="i method">NotifyEndApplication</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="25c3addb5cb5bc7d" href="../../R/25c3addb5cb5bc7d.html" target="n" data-glyph="72,1" class="i method">NotifyBeginApplication</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by the engine to notify the host that the execution of a legacy command has completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#7b79cd90e035740e" class="t t">PSHost</a>.<a href="#25c3addb5cb5bc7d" class="i method">NotifyBeginApplication</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="112d71f653f639d8" href="../../R/112d71f653f639d8.html" target="n" data-glyph="72,1" class="i method">NotifyEndApplication</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by hosting applications to notify PowerShell engine that it is</span>
        <span class="c">///</span><span class="c"> being hosted in a console based application and the Pipeline execution</span>
        <span class="c">///</span><span class="c"> thread should call SetThreadUILanguage(0). This property is currently</span>
        <span class="c">///</span><span class="c"> used by ConsoleHost only and in future releases we may consider</span>
        <span class="c">///</span><span class="c"> exposing this publicly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="f2a6287742d025d0" href="../../R/f2a6287742d025d0.html" target="n" data-glyph="104,1" class="i property">ShouldSetThreadUILanguageToZero</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property enables and disables the host debugger if debugging is supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="53fb0247f55f5206" href="../../R/53fb0247f55f5206.html" target="n" data-glyph="102,1" class="i property">DebuggerEnabled</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>(); }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This interface needs to be implemented by PSHost objects that want to support the PushRunspace</span>
    <span class="c">///</span><span class="c"> and PopRunspace functionality.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="8baf67daeba803e8" href="../../R/8baf67daeba803e8.html" target="n" data-glyph="48,0" class="t t">IHostSupportsInteractiveSession</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by the engine to notify the host that a runspace push has been requested.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#8baf67daeba803e8" class="t t">IHostSupportsInteractiveSession</a>.<a href="#0de7c13b058ff86d" class="i method">PushRunspace</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;runspace&quot;</span>)]
        <b>void</b> <a id="0de7c13b058ff86d" href="../../R/0de7c13b058ff86d.html" target="n" data-glyph="72,1" class="i method">PushRunspace</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r1 rd" class="r1 r">runspace</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by the engine to notify the host that a runspace pop has been requested.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#8baf67daeba803e8" class="t t">IHostSupportsInteractiveSession</a>.<a href="#bfefb28a81efacc0" class="i method">PopRunspace</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>void</b> <a id="bfefb28a81efacc0" href="../../R/bfefb28a81efacc0.html" target="n" data-glyph="72,1" class="i method">PopRunspace</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if a runspace is pushed; false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>bool</b> <a id="dcffa0559e25f71a" href="../../R/dcffa0559e25f71a.html" target="n" data-glyph="102,1" class="i property">IsRunspacePushed</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the current runspace associated with this host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>? <a id="bb0974f45a993c53" href="../../R/bb0974f45a993c53.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
    }
}
</pre></td></tr></table></div></body></html>
