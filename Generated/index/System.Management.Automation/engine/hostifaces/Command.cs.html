<!DOCTYPE html>
<html><head><title>Command.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(903);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/Command.cs" target="_top">engine\hostifaces\Command.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a Command object which can be added to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object</span>
    <span class="c">///</span><span class="c"> for invocation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="b55b68a3bf75e612" href="../../R/b55b68a3bf75e612.html" target="n" data-glyph="0,0" class="t t">Command</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of Command class using specified command parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the command or script contents.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="6c075592cf04e686" href="../../R/6c075592cf04e686.html" target="n" data-glyph="72,1" class="t constructor">Command</a>(<b>string</b> <span id="r0 rd" class="r0 r">command</span>)
            : <a href="#7daa1db0ede574c4" class="k">this</a>(<span class="r0 r">command</span>, <b>false</b>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of Command class using specified command parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command name or script contents.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">isScript</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if this command represents a script, otherwise; false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="12fe527c78833611" href="../../R/12fe527c78833611.html" target="n" data-glyph="72,1" class="t constructor">Command</a>(<b>string</b> <span id="r1 rd" class="r1 r">command</span>, <b>bool</b> <span id="r2 rd" class="r2 r">isScript</span>)
            : <a href="#7daa1db0ede574c4" class="k">this</a>(<span class="r1 r">command</span>, <span class="r2 r">isScript</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command name or script contents.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">isScript</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if this command represents a script, otherwise; false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">useLocalScope</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true local scope is used to run the script command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="7daa1db0ede574c4" href="../../R/7daa1db0ede574c4.html" target="n" data-glyph="72,1" class="t constructor">Command</a>(<b>string</b> <span id="r3 rd" class="r3 r">command</span>, <b>bool</b> <span id="r4 rd" class="r4 r">isScript</span>, <b>bool</b> <span id="r5 rd" class="r5 r">useLocalScope</span>)
        {
            <a href="#02fce76b562e32ef" class="i property">IsEndOfStatement</a> = <b>false</b>;
            <b>if</b> (<span class="r3 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">command</span>));
            }
 
            <a href="#e67df99c50711b7c" class="i property">CommandText</a> = <span class="r3 r">command</span>;
            <a href="#bd862d0956b9d510" class="i property">IsScript</a> = <span class="r4 r">isScript</span>;
            <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> = <span class="r5 r">useLocalScope</span>;
        }
 
        <b>internal</b> <a id="86ebfe098c61baf8" href="../../R/86ebfe098c61baf8.html" target="n" data-glyph="74,1" class="t constructor">Command</a>(<b>string</b> <span id="r6 rd" class="r6 r">command</span>, <b>bool</b> <span id="r7 rd" class="r7 r">isScript</span>, <b>bool</b>? <span id="r8 rd" class="r8 r">useLocalScope</span>)
        {
            <a href="#02fce76b562e32ef" class="i property">IsEndOfStatement</a> = <b>false</b>;
            <b>if</b> (<span class="r6 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r6 r">command</span>));
            }
 
            <a href="#e67df99c50711b7c" class="i property">CommandText</a> = <span class="r6 r">command</span>;
            <a href="#bd862d0956b9d510" class="i property">IsScript</a> = <span class="r7 r">isScript</span>;
            <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> = <span class="r8 r">useLocalScope</span>;
        }
 
        <b>internal</b> <a id="4f147eb3e5cf10da" href="../../R/4f147eb3e5cf10da.html" target="n" data-glyph="74,1" class="t constructor">Command</a>(<b>string</b> <span id="r9 rd" class="r9 r">command</span>, <b>bool</b> <span id="r10 rd" class="r10 r">isScript</span>, <b>bool</b>? <span id="r11 rd" class="r11 r">useLocalScope</span>, <b>bool</b> <span id="r12 rd" class="r12 r">mergeUnclaimedPreviousErrorResults</span>)
            : <a href="#86ebfe098c61baf8" class="k">this</a>(<span class="r9 r">command</span>, <span class="r10 r">isScript</span>, <span class="r11 r">useLocalScope</span>)
        {
            <b>if</b> (<span class="r12 r">mergeUnclaimedPreviousErrorResults</span>)
            {
                <a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a> = <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#4934ee6f6f8db020" class="i field">Error</a> | <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>;
            }
        }
 
        <b>internal</b> <a id="7afd6fbc88a9b688" href="../../R/7afd6fbc88a9b688.html" target="n" data-glyph="74,1" class="t constructor">Command</a>(<a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r13 rd" class="r13 r">commandInfo</span>)
            : <a href="#f980093de79da220" class="k">this</a>(<span class="r13 r">commandInfo</span>, <b>false</b>)
        {
        }
 
        <b>internal</b> <a id="f980093de79da220" href="../../R/f980093de79da220.html" target="n" data-glyph="74,1" class="t constructor">Command</a>(<a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r14 rd" class="r14 r">commandInfo</span>, <b>bool</b> <span id="r15 rd" class="r15 r">isScript</span>)
        {
            <a href="#02fce76b562e32ef" class="i property">IsEndOfStatement</a> = <b>false</b>;
            <a href="#f551626aff1565b2" class="i property">CommandInfo</a> = <span class="r14 r">commandInfo</span>;
            <a href="#e67df99c50711b7c" class="i property">CommandText</a> = <a href="#f551626aff1565b2" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
            <a href="#bd862d0956b9d510" class="i property">IsScript</a> = <span class="r15 r">isScript</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor for clone operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The source </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="3a87a061aa55a857" href="../../R/3a87a061aa55a857.html" target="n" data-glyph="74,1" class="t constructor">Command</a>(<a href="#b55b68a3bf75e612" class="t t">Command</a> <span id="r16 rd" class="r16 r">command</span>)
        {
            <a href="#bd862d0956b9d510" class="i property">IsScript</a> = <span class="r16 r">command</span>.<a href="#bd862d0956b9d510" class="i property">IsScript</a>;
            <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> = <span class="r16 r">command</span>.<a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a>;
            <a href="#e67df99c50711b7c" class="i property">CommandText</a> = <span class="r16 r">command</span>.<a href="#e67df99c50711b7c" class="i property">CommandText</a>;
            <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a> = <span class="r16 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>;
            <a href="#89907492fb67b29a" class="i property">MergeMyResult</a> = <span class="r16 r">command</span>.<a href="#89907492fb67b29a" class="i property">MergeMyResult</a>;
            <a href="#7860e1f22b3003d0" class="i property">MergeToResult</a> = <span class="r16 r">command</span>.<a href="#7860e1f22b3003d0" class="i property">MergeToResult</a>;
            <a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a> = <span class="r16 r">command</span>.<a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a>;
            <a href="#02fce76b562e32ef" class="i property">IsEndOfStatement</a> = <span class="r16 r">command</span>.<a href="#02fce76b562e32ef" class="i property">IsEndOfStatement</a>;
            <a href="#f551626aff1565b2" class="i property">CommandInfo</a> = <span class="r16 r">command</span>.<a href="#f551626aff1565b2" class="i property">CommandInfo</a>;
 
            <b>foreach</b> (<a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a> <span id="r17 rd" class="r17 r">param</span> <b>in</b> <span class="r16 r">command</span>.<a href="#ba1074ca05aadff5" class="i property">Parameters</a>)
            {
                <a href="#ba1074ca05aadff5" class="i property">Parameters</a>.<span class="i">Add</span>(<b>new</b> <a href="Parameter.cs.html#2cdbc5f4adc8e89b" class="t constructor">CommandParameter</a>(<span class="r17 r">param</span>.<a href="Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>, <span class="r17 r">param</span>.<a href="Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>));
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the set of parameters for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property is used to add positional or named parameters to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="Parameter.cs.html#d9a8a30704d0880b" class="t t">CommandParameterCollection</a> <a id="ba1074ca05aadff5" href="../../R/ba1074ca05aadff5.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b>; } = <b>new</b> <a href="Parameter.cs.html#506bed959668442d" class="t constructor">CommandParameterCollection</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access the command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The command name, if </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b55b68a3bf75e612" class="t t">Command</a>.<a href="#bd862d0956b9d510" class="i property">IsScript</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false; otherwise; the script contents</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="e67df99c50711b7c" href="../../R/e67df99c50711b7c.html" target="n" data-glyph="102,1" class="i property">CommandText</a> { <b>get</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access the commandInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The command info object</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <a id="f551626aff1565b2" href="../../R/f551626aff1565b2.html" target="n" data-glyph="104,1" class="i property">CommandInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access the value indicating if this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> represents a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bd862d0956b9d510" href="../../R/bd862d0956b9d510.html" target="n" data-glyph="102,1" class="i property">IsScript</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access the value indicating if LocalScope is to be used for running</span>
        <span class="c">///</span><span class="c"> this script command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">True if this command is a script and localScope is</span>
        <span class="c">///</span><span class="c"> used for executing the script</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This value is always false for non-script commands</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="efceb2bb132a6869" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseLocalScope</a>
        {
            <b>get</b> { <b>return</b> <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> ?? <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the command origin for this command. A command origin</span>
        <span class="c">///</span><span class="c"> of &#39;Runspace&#39; (the default) applies Runspace restrictions to this command.</span>
        <span class="c">///</span><span class="c"> A command origin of &#39;Internal&#39; does not apply runspace restrictions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="73389144dc40bfb1" href="../../R/73389144dc40bfb1.html" target="n" data-glyph="102,1" class="i property">CommandOrigin</a> { <b>get</b>; <b>set</b>; } = <a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access the actual value indicating if LocalScope is to be used for running</span>
        <span class="c">///</span><span class="c"> this script command.  Needed for serialization in remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b>? <a id="b9a9d5d23ce43a10" href="../../R/b9a9d5d23ce43a10.html" target="n" data-glyph="104,1" class="i property">UseLocalScopeNullable</a>
        {
            <b>get</b> { <b>return</b> <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets DollarUnderbar ($_) value to be used with script command.</span>
        <span class="c">///</span><span class="c"> This is used by foreach-object -parallel where each piped input ($_) is associated</span>
        <span class="c">///</span><span class="c"> with a parallel running script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="ea192ad03278e182" href="../../R/ea192ad03278e182.html" target="n" data-glyph="104,1" class="i property">DollarUnderbar</a> { <b>get</b>; <b>set</b>; } = <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if the current command marks the end of a statement (see PowerShell.AddStatement())</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="02fce76b562e32ef" href="../../R/02fce76b562e32ef.html" target="n" data-glyph="102,1" class="i property">IsEndOfStatement</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that is a copy of the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that is a copy of this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#b55b68a3bf75e612" class="t t">Command</a> <a id="66d065d201023e25" href="../../R/66d065d201023e25.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#3a87a061aa55a857" class="t constructor">Command</a>(<a href="#b55b68a3bf75e612" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For diagnostic purposes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="6af552ae199a5ddd" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#e67df99c50711b7c" class="i property">CommandText</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Merge
 
        <b>private</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <a id="13eba083d6f5e79c" href="../../R/13eba083d6f5e79c.html" target="n" data-glyph="46,1" class="i field">_mergeUnclaimedPreviousCommandResults</a> =
            <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets this command as the mergepoint for previous unclaimed</span>
        <span class="c">///</span><span class="c"> commands&#39; results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently only supported operation is to merge</span>
        <span class="c">///</span><span class="c"> Output and Error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently only supported operation is to merge Output and Error.</span>
        <span class="c">///</span><span class="c"> Attempt to set the property to something other than</span>
        <span class="c">///</span><span class="c"> PipelineResultTypes.Error | PipelineResultTypes.Output results</span>
        <span class="c">///</span><span class="c"> in this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <a id="01de6f7802432257" href="../../R/01de6f7802432257.html" target="n" data-glyph="102,1" class="i property">MergeUnclaimedPreviousCommandResults</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
                {
                    <a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a> = <b>value</b>;
                    <b>return</b>;
                }
 
                <b>if</b> (<b>value</b> != (<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#4934ee6f6f8db020" class="i field">Error</a> | <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>))
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
                }
 
                <a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a> = <b>value</b>;
            }
        }
 
        <span class="c">//</span>
        <span class="c">// These properties are kept for backwards compatibility for V2</span>
        <span class="c">// over the wire, which allows merging only for Error stream.</span>
        <span class="c">//</span>
 
        <b>internal</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <a id="89907492fb67b29a" href="../../R/89907492fb67b29a.html" target="n" data-glyph="104,1" class="i property">MergeMyResult</a> { <b>get</b>; <b>private set</b>; } = <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>;
 
        <b>internal</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <a id="7860e1f22b3003d0" href="../../R/7860e1f22b3003d0.html" target="n" data-glyph="104,1" class="i property">MergeToResult</a> { <b>get</b>; <b>private set</b>; } = <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>;
 
        <span class="c">//</span>
        <span class="c">// For V3 we allow merging from all streams except Output.</span>
        <span class="c">//</span>
        <b>internal enum</b> <a id="7447bf2ffcd0f5ff" href="../../R/7447bf2ffcd0f5ff.html" target="n" data-glyph="20,1" class="t t"><span id="889db5b628474c48">MergeType</span></a>
        {
            <a id="f0351b42225398fc" href="../../R/f0351b42225398fc.html" target="n" data-glyph="24,2" class="i field">Error</a> = 0,
            <a id="c62cce2179478af7" href="../../R/c62cce2179478af7.html" target="n" data-glyph="24,2" class="i field">Warning</a> = 1,
            <a id="99a05c7807d39ed0" href="../../R/99a05c7807d39ed0.html" target="n" data-glyph="24,2" class="i field">Verbose</a> = 2,
            <a id="9c7b4a62c9c759de" href="../../R/9c7b4a62c9c759de.html" target="n" data-glyph="24,2" class="i field">Debug</a> = 3,
            <a id="aa0b162b3e80b8e8" href="../../R/aa0b162b3e80b8e8.html" target="n" data-glyph="24,2" class="i field">Information</a> = 4
        }
 
        <b>internal const int</b> <a id="5dc9cadd8422b820" href="../../R/5dc9cadd8422b820.html" target="n" data-glyph="8,1" class="i field">MaxMergeType</a> = (<b>int</b>)(<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a> + 1);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal accessor for _mergeInstructions. It is used by serialization</span>
        <span class="c">///</span><span class="c"> code.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>[] <a id="af5ebbc1aa3253af" href="../../R/af5ebbc1aa3253af.html" target="n" data-glyph="104,1" class="i property">MergeInstructions</a> { <b>get</b>; <b>set</b>; } = <b>new</b> <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>[<a href="#5dc9cadd8422b820" class="i field">MaxMergeType</a>];
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Merges this commands results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">myResult</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline stream to be redirected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">toResult</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline stream in to which myResult is merged</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> myResult parameter is not PipelineResultTypes.Error or</span>
        <span class="c">///</span><span class="c"> toResult parameter is not PipelineResultTypes.Output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently only operation supported is to merge error of command to output of</span>
        <span class="c">///</span><span class="c"> command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="1d4f6e54a09e8991" href="../../R/1d4f6e54a09e8991.html" target="n" data-glyph="72,1" class="i method">MergeMyResults</a>(<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r18 rd" class="r18 r">myResult</span>, <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r19 rd" class="r19 r">toResult</span>)
        {
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a> &amp;&amp; <span class="r19 r">toResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="c">// For V2 backwards compatibility.</span>
                <a href="#89907492fb67b29a" class="i property">MergeMyResult</a> = <span class="r18 r">myResult</span>;
                <a href="#7860e1f22b3003d0" class="i property">MergeToResult</a> = <span class="r19 r">toResult</span>;
 
                <b>for</b> (<b>int</b> <span id="r20 rd" class="r20 r">i</span> = 0; <span class="r20 r">i</span> &lt; <a href="#5dc9cadd8422b820" class="i field">MaxMergeType</a>; ++<span class="r20 r">i</span>)
                {
                    <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[<span class="r20 r">i</span>] = <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>;
                }
 
                <b>return</b>;
            }
 
            <span class="c">// Validate parameters.</span>
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r18 r">myResult</span>), <span class="i">RunspaceStrings</span>.<span class="i">InvalidMyResultError</span>);
            }
 
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#4934ee6f6f8db020" class="i field">Error</a> &amp;&amp; <span class="r19 r">toResult</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r19 r">toResult</span>), <span class="i">RunspaceStrings</span>.<span class="i">InvalidValueToResultError</span>);
            }
 
            <b>if</b> (<span class="r19 r">toResult</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a> &amp;&amp; <span class="r19 r">toResult</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#a6bdd55d71f6bdd5" class="i field">Null</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r19 r">toResult</span>), <span class="i">RunspaceStrings</span>.<span class="i">InvalidValueToResult</span>);
            }
 
            <span class="c">// For V2 backwards compatibility.</span>
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#4934ee6f6f8db020" class="i field">Error</a>)
            {
                <a href="#89907492fb67b29a" class="i property">MergeMyResult</a> = <span class="r18 r">myResult</span>;
                <a href="#7860e1f22b3003d0" class="i property">MergeToResult</a> = <span class="r19 r">toResult</span>;
            }
 
            <span class="c">// Set internal merge instructions.</span>
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#4934ee6f6f8db020" class="i field">Error</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#037d2fe8e28834f2" class="i field">All</a>)
            {
                <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#f0351b42225398fc" class="i field">Error</a>] = <span class="r19 r">toResult</span>;
            }
 
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#937e1151b0e2bd43" class="i field">Warning</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#037d2fe8e28834f2" class="i field">All</a>)
            {
                <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>] = <span class="r19 r">toResult</span>;
            }
 
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#1a8de35fbb318391" class="i field">Verbose</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#037d2fe8e28834f2" class="i field">All</a>)
            {
                <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>] = <span class="r19 r">toResult</span>;
            }
 
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#21306d0f54ddaff1" class="i field">Debug</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#037d2fe8e28834f2" class="i field">All</a>)
            {
                <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>] = <span class="r19 r">toResult</span>;
            }
 
            <b>if</b> (<span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#dc2c3c6901e5d653" class="i field">Information</a> || <span class="r18 r">myResult</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#037d2fe8e28834f2" class="i field">All</a>)
            {
                <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>] = <span class="r19 r">toResult</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set the merge settings on commandProcessor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">commandProcessor</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private
        void</b>
        <a id="243eb0612b26e132" href="../../R/243eb0612b26e132.html" target="n" data-glyph="76,1" class="i method">SetMergeSettingsOnCommandProcessor</a>(<a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r21 rd" class="r21 r">commandProcessor</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r21 r">commandProcessor</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <a href="../MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r22 rd" class="r22 r">mcr</span> = <span class="r21 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#f58ee453ebc82f56" class="i property">Command</a>.<a href="../CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> <b>as</b> <a href="../MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a>;
 
            <b>if</b> (<a href="#13eba083d6f5e79c" class="i field">_mergeUnclaimedPreviousCommandResults</a> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="c">// Currently only merging previous unclaimed error and output is supported.</span>
                <b>if</b> (<span class="r22 r">mcr</span> != <b>null</b>)
                {
                    <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#2b01b0604d7922fc" class="i property">MergeUnclaimedPreviousErrorResults</a> = <b>true</b>;
                }
            }
 
            <span class="c">// Error merge.</span>
            <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#f0351b42225398fc" class="i field">Error</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
            {
                <span class="c">// Currently only merging error with output is supported.</span>
                <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#ed59e3b00feab7b1" class="i property">ErrorMergeTo</a> = <a href="../MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a>.<a href="../MshCommandRuntime.cs.html#8b0e9f05387e62ca" class="t t">MergeDataStream</a>.<a href="../MshCommandRuntime.cs.html#8ab59ea31f703b82" class="i field">Output</a>;
            }
 
            <span class="c">// Warning merge.</span>
            <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r23 rd" class="r23 r">toType</span> = <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>];
            <b>if</b> (<span class="r23 r">toType</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#d00979e144f16d67" class="i property">WarningOutputPipe</a> = <a href="#8cd35ead394421ba" class="i method">GetRedirectionPipe</a>(<span class="r23 r">toType</span>, <span class="r22 r">mcr</span>);
            }
 
            <span class="c">// Verbose merge.</span>
            <span class="r23 r">toType</span> = <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>];
            <b>if</b> (<span class="r23 r">toType</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#ef3e8731176db1bd" class="i property">VerboseOutputPipe</a> = <a href="#8cd35ead394421ba" class="i method">GetRedirectionPipe</a>(<span class="r23 r">toType</span>, <span class="r22 r">mcr</span>);
            }
 
            <span class="c">// Debug merge.</span>
            <span class="r23 r">toType</span> = <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>];
            <b>if</b> (<span class="r23 r">toType</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#e4845e81eb1192a5" class="i property">DebugOutputPipe</a> = <a href="#8cd35ead394421ba" class="i method">GetRedirectionPipe</a>(<span class="r23 r">toType</span>, <span class="r22 r">mcr</span>);
            }
 
            <span class="c">// Information merge.</span>
            <span class="r23 r">toType</span> = <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>];
            <b>if</b> (<span class="r23 r">toType</span> != <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#2176d4a38e55153d" class="i field">None</a>)
            {
                <span class="r22 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#3a61ae91cdf1e0bc" class="i property">InformationOutputPipe</a> = <a href="#8cd35ead394421ba" class="i method">GetRedirectionPipe</a>(<span class="r23 r">toType</span>, <span class="r22 r">mcr</span>);
            }
        }
 
        <b>private static</b> <a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="8cd35ead394421ba" href="../../R/8cd35ead394421ba.html" target="n" data-glyph="76,1" class="i method">GetRedirectionPipe</a>(
            <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r24 rd" class="r24 r">toType</span>,
            <a href="../MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r25 rd" class="r25 r">mcr</span>)
        {
            <b>if</b> (<span class="r24 r">toType</span> == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
            {
                <b>return</b> <span class="r25 r">mcr</span>.<a href="../MshCommandRuntime.cs.html#b24610eb88ee27e9" class="i property">OutputPipe</a>;
            }
 
            <a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <span id="r26 rd" class="r26 r">pipe</span> = <b>new</b> <a href="../Pipe.cs.html#c1592456b1ff42b5" class="t constructor">Pipe</a>();
            <span class="r26 r">pipe</span>.<a href="../Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a> = <b>true</b>;
            <b>return</b> <span class="r26 r">pipe</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Merge
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a CommandProcessorBase for this Command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">executionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b>
        <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a>
        <a id="c1f16b253f32cbe1" href="../../R/c1f16b253f32cbe1.html" target="n" data-glyph="74,1" class="i method">CreateCommandProcessor</a>
        (
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r27 rd" class="r27 r">executionContext</span>,
            <b>bool</b> <span id="r28 rd" class="r28 r">addToHistory</span>,
            <a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r29 rd" class="r29 r">origin</span>
        )
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r27 r">executionContext</span> != <b>null</b>, <span class="s">&quot;Caller should verify the parameters&quot;</span>);
 
            <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r30 rd" class="r30 r">commandProcessorBase</span>;
 
            <b>if</b> (<a href="#bd862d0956b9d510" class="i property">IsScript</a>)
            {
                <b>if</b> ((<span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>) &amp;&amp;
                    (<span class="r29 r">origin</span> == <span class="i n">Automation</span>.<a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a>))
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<a href="#e67df99c50711b7c" class="i property">CommandText</a>, <b>typeof</b>(<a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a>),
                        <b>null</b>, <span class="s">&quot;ScriptsNotAllowed&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">ScriptsNotAllowed</span>);
                }
 
                <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r31 rd" class="r31 r">scriptBlock</span> = <span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#7b897dde7067af78" class="i property">Engine</a>.<a href="../AutomationEngine.cs.html#7f45ac65575c22af" class="i method">ParseScriptBlock</a>(<a href="#e67df99c50711b7c" class="i property">CommandText</a>, <span class="r28 r">addToHistory</span>);
                <b>if</b> (<span class="r29 r">origin</span> == <span class="i n">Automation</span>.<a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
                {
                    <span class="r31 r">scriptBlock</span>.<a href="../lang/scriptblock.cs.html#5e76a9fb0d1a7f12" class="i property">LanguageMode</a> = <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
                }
 
                <span class="c">// If running in restricted language mode, verify that the parse tree represents on legitimate</span>
                <span class="c">// constructions...</span>
                <b>switch</b> (<span class="r31 r">scriptBlock</span>.<a href="../lang/scriptblock.cs.html#5e76a9fb0d1a7f12" class="i property">LanguageMode</a>)
                {
                    <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#ea8105287b8c6b25" class="i field">RestrictedLanguage</a>:
                        <span class="r31 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#ebeb50ec60013521" class="i method">CheckRestrictedLanguage</a>(<b>null</b>, <b>null</b>, <b>false</b>);
                        <b>break</b>;
                    <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>:
                        <span class="c">// Interactive script commands are permitted in this mode.</span>
                        <b>break</b>;
                    <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>:
                        <span class="c">// Constrained Language is checked at runtime.</span>
                        <b>break</b>;
                    <b>default</b>:
                        <span class="c">// This should never happen...</span>
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid language mode was set when building a ScriptCommandProcessor&quot;</span>);
                        <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;Invalid language mode was set when building a ScriptCommandProcessor&quot;</span>);
                }
 
                <b>if</b> (<span class="r31 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>)
                {
                    <a href="../FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r32 rd" class="r32 r">functionInfo</span> = <b>new</b> <span class="t">FunctionInfo</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r31 r">scriptBlock</span>, <span class="r27 r">executionContext</span>);
                    <span class="r30 r">commandProcessorBase</span> = <b>new</b> <span class="t">CommandProcessor</span>(<span class="r32 r">functionInfo</span>, <span class="r27 r">executionContext</span>,
                                                                <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> ?? <b>false</b>, <span class="i">fromScriptFile</span>: <b>false</b>, <span class="i">sessionState</span>: <span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
                }
                <b>else</b>
                {
                    <span class="r30 r">commandProcessorBase</span> = <b>new</b> <span class="t">DlrScriptCommandProcessor</span>(<span class="r31 r">scriptBlock</span>,
                                                                         <span class="r27 r">executionContext</span>, <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a> ?? <b>false</b>,
                                                                         <span class="r29 r">origin</span>,
                                                                         <span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>,
                                                                         <a href="#ea192ad03278e182" class="i property">DollarUnderbar</a>);
                }
            }
            <b>else</b>
            {
                <span class="c">// RestrictedLanguage / NoLanguage do not support dot-sourcing when CommandOrigin is Runspace</span>
                <b>if</b> ((<a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a>.<span class="i">HasValue</span>) &amp;&amp; (!<a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a>.<span class="i">Value</span>))
                {
                    <b>switch</b> (<span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>)
                    {
                        <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#ea8105287b8c6b25" class="i field">RestrictedLanguage</a>:
                        <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>:
                            <b>string</b> <span id="r33 rd" class="r33 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">UseLocalScopeNotAllowed</span>,
                                <span class="s">&quot;UseLocalScope&quot;</span>,
                                <b>nameof</b>(<a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#ea8105287b8c6b25" class="i field">RestrictedLanguage</a>),
                                <b>nameof</b>(<a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>));
                            <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r33 r">message</span>);
                        <b>case</b> <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>:
                            <span class="c">// Interactive script commands are permitted in this mode...</span>
                            <b>break</b>;
                    }
                }
 
                <span class="r30 r">commandProcessorBase</span> = <span class="r27 r">executionContext</span>.<a href="../ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="../CommandDiscovery.cs.html#4d2a4c32a47c20f6" class="i method">LookupCommandProcessor</a>(<a href="#e67df99c50711b7c" class="i property">CommandText</a>, <span class="r29 r">origin</span>, <a href="#1601d492bae1ba1e" class="i field">_useLocalScope</a>);
            }
 
            <a href="Parameter.cs.html#d9a8a30704d0880b" class="t t">CommandParameterCollection</a> <span id="r34 rd" class="r34 r">parameters</span> = <a href="#ba1074ca05aadff5" class="i property">Parameters</a>;
 
            <b>if</b> (<span class="r34 r">parameters</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r35 rd" class="r35 r">isNativeCommand</span> = <span class="r30 r">commandProcessorBase</span> <b>is</b> <a href="../NativeCommandProcessor.cs.html#27173c2526d1ef9a" class="t t">NativeCommandProcessor</a>;
                <b>foreach</b> (<a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a> <span id="r36 rd" class="r36 r">publicParameter</span> <b>in</b> <span class="r34 r">parameters</span>)
                {
                    <a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r37 rd" class="r37 r">internalParameter</span> = <a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a>.<a href="Parameter.cs.html#7c6ba16ec3cc2800" class="i method">ToCommandParameterInternal</a>(<span class="r36 r">publicParameter</span>, <span class="r35 r">isNativeCommand</span>);
                    <span class="r30 r">commandProcessorBase</span>.<a href="../CommandProcessorBase.cs.html#a862b2435f52bbdf" class="i method">AddParameter</a>(<span class="r37 r">internalParameter</span>);
                }
            }
 
            <b>string</b> <span id="r38 rd" class="r38 r">helpTarget</span>;
            <a href="../../help/HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r39 rd" class="r39 r">helpCategory</span>;
            <b>if</b> (<span class="r30 r">commandProcessorBase</span>.<a href="../CommandProcessorBase.cs.html#67dd0c69e6a0187b" class="i method">IsHelpRequested</a>(<b>out</b> <span class="r38 r">helpTarget</span>, <b>out</b> <span class="r39 r">helpCategory</span>))
            {
                <span class="r30 r">commandProcessorBase</span> = <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a>.<a href="../CommandProcessorBase.cs.html#55bbbf951649455b" class="i method">CreateGetHelpCommandProcessor</a>(
                    <span class="r27 r">executionContext</span>,
                    <span class="r38 r">helpTarget</span>,
                    <span class="r39 r">helpCategory</span>);
            }
 
            <span class="c">// Set the merge settings</span>
            <a href="#243eb0612b26e132" class="i method">SetMergeSettingsOnCommandProcessor</a>(<span class="r30 r">commandProcessorBase</span>);
 
            <b>return</b> <span class="r30 r">commandProcessorBase</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private fields
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used for script commands (i.e. _isScript is true). If</span>
        <span class="c">///</span><span class="c"> _useLocalScope is true, script is run in LocalScope.  If</span>
        <span class="c">///</span><span class="c"> null, it was unspecified and a suitable default is used (true</span>
        <span class="c">///</span><span class="c"> for non-script, false for script).  Note that the public</span>
        <span class="c">///</span><span class="c"> property is bool, not bool? (from V1), so it should probably</span>
        <span class="c">///</span><span class="c"> be deprecated, at least for internal use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly bool</b>? <a id="1601d492bae1ba1e" href="../../R/1601d492bae1ba1e.html" target="n" data-glyph="46,1" class="i field">_useLocalScope</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private fields
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serialization / deserialization for remoting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Command object from a PSObject property bag.</span>
        <span class="c">///</span><span class="c"> PSObject has to be in the format returned by ToPSObjectForRemoting method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">commandAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject to rehydrate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command rehydrated from a PSObject property bag</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if the PSObject is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/common/remotingexceptions.cs.html#553740d8dd522b58" class="t t">PSRemotingDataStructureException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the PSObject is not in the expected format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#b55b68a3bf75e612" class="t t">Command</a> <a id="2a6d58e45835343c" href="../../R/2a6d58e45835343c.html" target="n" data-glyph="74,1" class="i method">FromPSObjectForRemoting</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r40 rd" class="r40 r">commandAsPSObject</span>)
        {
            <b>if</b> (<span class="r40 r">commandAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r40 r">commandAsPSObject</span>));
            }
 
            <b>string</b> <span id="r41 rd" class="r41 r">commandText</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#2aa706c78c936e6a" class="i field">CommandText</a>);
            <b>bool</b> <span id="r42 rd" class="r42 r">isScript</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#4b8420282e49d434" class="i field">IsScript</a>);
            <b>bool</b>? <span id="r43 rd" class="r43 r">useLocalScopeNullable</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>?&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#35a31ef797f7538c" class="i field">UseLocalScopeNullable</a>);
            <a href="#b55b68a3bf75e612" class="t t">Command</a> <span id="r44 rd" class="r44 r">command</span> = <b>new</b> <a href="#86ebfe098c61baf8" class="t constructor">Command</a>(<span class="r41 r">commandText</span>, <span class="r42 r">isScript</span>, <span class="r43 r">useLocalScopeNullable</span>);
 
            <span class="c">// For V2 backwards compatibility.</span>
            <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r45 rd" class="r45 r">mergeMyResult</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#2a0e3385b484c5a7" class="i field">MergeMyResult</a>);
            <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a> <span id="r46 rd" class="r46 r">mergeToResult</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#f187c550aefc9058" class="i field">MergeToResult</a>);
            <span class="r44 r">command</span>.<a href="#1d4f6e54a09e8991" class="i method">MergeMyResults</a>(<span class="r45 r">mergeMyResult</span>, <span class="r46 r">mergeToResult</span>);
 
            <span class="r44 r">command</span>.<a href="#01de6f7802432257" class="i property">MergeUnclaimedPreviousCommandResults</a> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9253264d6ae4c3f1" class="i field">MergeUnclaimedPreviousCommandResults</a>);
 
            <span class="c">// V3 merge instructions will not be returned by V2 server and this is expected.</span>
            <b>if</b> (<span class="r40 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#811058afe6db1960" class="i field">MergeError</a>] != <b>null</b>)
            {
                <span class="r44 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#f0351b42225398fc" class="i field">Error</a>] = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#811058afe6db1960" class="i field">MergeError</a>);
            }
 
            <b>if</b> (<span class="r40 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#66c77aeb18296dde" class="i field">MergeWarning</a>] != <b>null</b>)
            {
                <span class="r44 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>] = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#66c77aeb18296dde" class="i field">MergeWarning</a>);
            }
 
            <b>if</b> (<span class="r40 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#3f7c8e7ee1977e7d" class="i field">MergeVerbose</a>] != <b>null</b>)
            {
                <span class="r44 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>] = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#3f7c8e7ee1977e7d" class="i field">MergeVerbose</a>);
            }
 
            <b>if</b> (<span class="r40 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9b3b86a182021d86" class="i field">MergeDebug</a>] != <b>null</b>)
            {
                <span class="r44 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>] = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9b3b86a182021d86" class="i field">MergeDebug</a>);
            }
 
            <b>if</b> (<span class="r40 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3d30fbb16602dfa" class="i field">MergeInformation</a>] != <b>null</b>)
            {
                <span class="r44 r">command</span>.<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>] = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3d30fbb16602dfa" class="i field">MergeInformation</a>);
            }
 
            <b>foreach</b> (<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r47 rd" class="r47 r">parameterAsPSObject</span> <b>in</b> <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r40 r">commandAsPSObject</span>, <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#c3714fc05b2f27f5" class="i field">Parameters</a>))
            {
                <span class="r44 r">command</span>.<a href="#ba1074ca05aadff5" class="i property">Parameters</a>.<span class="i">Add</span>(<a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a>.<a href="Parameter.cs.html#e028c06e96efacb9" class="i method">FromPSObjectForRemoting</a>(<span class="r47 r">parameterAsPSObject</span>));
            }
 
            <b>return</b> <span class="r44 r">command</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns this object as a PSObject property bag</span>
        <span class="c">///</span><span class="c"> that can be used in a remoting protocol data object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">psRPVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell remoting protocol version.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">This object as a PSObject property bag.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="6b5e43f1f3758707" href="../../R/6b5e43f1f3758707.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>(<span class="i">Version</span> <span id="r48 rd" class="r48 r">psRPVersion</span>)
        {
            <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r49 rd" class="r49 r">commandAsPSObject</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#2aa706c78c936e6a" class="i field">CommandText</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#e67df99c50711b7c" class="i property">CommandText</a>));
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#4b8420282e49d434" class="i field">IsScript</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#bd862d0956b9d510" class="i property">IsScript</a>));
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#35a31ef797f7538c" class="i field">UseLocalScopeNullable</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#b9a9d5d23ce43a10" class="i property">UseLocalScopeNullable</a>));
 
            <span class="c">// For V2 backwards compatibility.</span>
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#2a0e3385b484c5a7" class="i field">MergeMyResult</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#89907492fb67b29a" class="i property">MergeMyResult</a>));
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#f187c550aefc9058" class="i field">MergeToResult</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#7860e1f22b3003d0" class="i property">MergeToResult</a>));
 
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9253264d6ae4c3f1" class="i field">MergeUnclaimedPreviousCommandResults</a>, <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#01de6f7802432257" class="i property">MergeUnclaimedPreviousCommandResults</a>));
 
            <b>if</b> (<span class="r48 r">psRPVersion</span> != <b>null</b> &amp;&amp;
                <span class="r48 r">psRPVersion</span> &gt;= <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#a52fd4a38c196083" class="i field">ProtocolVersionWin10RTM</a>)
            {
                <span class="c">// V5 merge instructions</span>
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#811058afe6db1960" class="i field">MergeError</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#f0351b42225398fc" class="i field">Error</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#66c77aeb18296dde" class="i field">MergeWarning</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#3f7c8e7ee1977e7d" class="i field">MergeVerbose</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9b3b86a182021d86" class="i field">MergeDebug</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3d30fbb16602dfa" class="i field">MergeInformation</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>]));
            }
            <b>else</b> <b>if</b> (<span class="r48 r">psRPVersion</span> != <b>null</b> &amp;&amp;
                <span class="r48 r">psRPVersion</span> &gt;= <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#fd42c50dee2d8244" class="i field">ProtocolVersionWin8RTM</a>)
            {
                <span class="c">// V3 merge instructions.</span>
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#811058afe6db1960" class="i field">MergeError</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#f0351b42225398fc" class="i field">Error</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#66c77aeb18296dde" class="i field">MergeWarning</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#3f7c8e7ee1977e7d" class="i field">MergeVerbose</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>]));
                <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#9b3b86a182021d86" class="i field">MergeDebug</a>, <a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>]));
 
                <span class="c">// If they&#39;ve explicitly redirected the Information stream, generate an error. Don&#39;t</span>
                <span class="c">// generate an error if they&#39;ve done &quot;*&quot;, as that makes any new stream a breaking change.</span>
                <b>if</b> ((<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>) &amp;&amp;
                    (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>.<span class="i">Length</span> != <a href="#5dc9cadd8422b820" class="i field">MaxMergeType</a>))
                {
                    <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                        <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">InformationRedirectionNotSupported</span>));
                }
            }
            <b>else</b>
            {
                <span class="c">// If they&#39;ve explicitly redirected an unsupported stream, generate an error. Don&#39;t</span>
                <span class="c">// generate an error if they&#39;ve done &quot;*&quot;, as that makes any new stream a breaking change.</span>
                <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>.<span class="i">Length</span> != <a href="#5dc9cadd8422b820" class="i field">MaxMergeType</a>)
                {
                    <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#c62cce2179478af7" class="i field">Warning</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">WarningRedirectionNotSupported</span>));
                    }
 
                    <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#99a05c7807d39ed0" class="i field">Verbose</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">VerboseRedirectionNotSupported</span>));
                    }
 
                    <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#9c7b4a62c9c759de" class="i field">Debug</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">DebugRedirectionNotSupported</span>));
                    }
 
                    <b>if</b> (<a href="#af5ebbc1aa3253af" class="i property">MergeInstructions</a>[(<b>int</b>)<a href="#7447bf2ffcd0f5ff" class="t t">MergeType</a>.<a href="#aa0b162b3e80b8e8" class="i field">Information</a>] == <a href="#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="#c8d2233323d43e84" class="i field">Output</a>)
                    {
                        <b>throw</b> <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">InformationRedirectionNotSupported</span>));
                    }
                }
            }
 
            <span class="i">List</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r50 rd" class="r50 r">parametersAsListOfPSObjects</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#ba1074ca05aadff5" class="i property">Parameters</a>.<span class="i">Count</span>);
            <b>foreach</b> (<a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a> <span id="r51 rd" class="r51 r">parameter</span> <b>in</b> <a href="#b55b68a3bf75e612" class="k">this</a>.<a href="#ba1074ca05aadff5" class="i property">Parameters</a>)
            {
                <span class="r50 r">parametersAsListOfPSObjects</span>.<span class="i">Add</span>(<span class="r51 r">parameter</span>.<a href="Parameter.cs.html#91811566abc9f928" class="i method">ToPSObjectForRemoting</a>());
            }
 
            <span class="r49 r">commandAsPSObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#c3714fc05b2f27f5" class="i field">Parameters</a>, <span class="r50 r">parametersAsListOfPSObjects</span>));
 
            <b>return</b> <span class="r49 r">commandAsPSObject</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Win Blue Extensions
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// PSMI Not Supported On CSS</span>
<span class="e">        internal CimInstance ToCimInstance()
        {
            CimInstance c = InternalMISerializer.CreateCimInstance(&quot;PS_Command&quot;);
            CimProperty commandTextProperty = InternalMISerializer.CreateCimProperty(&quot;CommandText&quot;,
                                                                                     this.CommandText,
                                                                                     Microsoft.Management.Infrastructure.CimType.String);
            c.CimInstanceProperties.Add(commandTextProperty);
            CimProperty isScriptProperty = InternalMISerializer.CreateCimProperty(&quot;IsScript&quot;,
                                                                                  this.IsScript,
                                                                                  Microsoft.Management.Infrastructure.CimType.Boolean);
            c.CimInstanceProperties.Add(isScriptProperty);
 
            if (this.Parameters != null &amp;&amp; this.Parameters.Count &gt; 0)
            {
                List&lt;CimInstance&gt; parameterInstances = new List&lt;CimInstance&gt;();
                foreach (var p in this.Parameters)
                {
                    parameterInstances.Add(p.ToCimInstance());
                }
 
                if (parameterInstances.Count &gt; 0)
                {
                    CimProperty parametersProperty = InternalMISerializer.CreateCimProperty(&quot;Parameters&quot;,
                                                                                            parameterInstances.ToArray(),
                                                                                            Microsoft.Management.Infrastructure.CimType.ReferenceArray);
                    c.CimInstanceProperties.Add(parametersProperty);
                }
            }
 
            return c;
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Win Blue Extensions
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enum defining the types of streams coming out of a pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="b4c8a564cfb76454" href="../../R/b4c8a564cfb76454.html" target="n" data-glyph="18,0" class="t t"><span id="d44cb338ccdefb1d">PipelineResultTypes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default streaming behavior.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2176d4a38e55153d" href="../../R/2176d4a38e55153d.html" target="n" data-glyph="24,1" class="i field">None</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Success output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c8d2233323d43e84" href="../../R/c8d2233323d43e84.html" target="n" data-glyph="24,1" class="i field">Output</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Error output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4934ee6f6f8db020" href="../../R/4934ee6f6f8db020.html" target="n" data-glyph="24,1" class="i field">Error</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Warning information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="937e1151b0e2bd43" href="../../R/937e1151b0e2bd43.html" target="n" data-glyph="24,1" class="i field">Warning</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verbose information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1a8de35fbb318391" href="../../R/1a8de35fbb318391.html" target="n" data-glyph="24,1" class="i field">Verbose</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Debug information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="21306d0f54ddaff1" href="../../R/21306d0f54ddaff1.html" target="n" data-glyph="24,1" class="i field">Debug</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Information information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="dc2c3c6901e5d653" href="../../R/dc2c3c6901e5d653.html" target="n" data-glyph="24,1" class="i field">Information</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All streams.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="037d2fe8e28834f2" href="../../R/037d2fe8e28834f2.html" target="n" data-glyph="24,1" class="i field">All</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Redirect to nothing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a6bdd55d71f6bdd5" href="../../R/a6bdd55d71f6bdd5.html" target="n" data-glyph="24,1" class="i field">Null</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a collection of Commands. This collection is used by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to define</span>
    <span class="c">///</span><span class="c"> elements of pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8276f51c05ad2fa1" href="../../R/8276f51c05ad2fa1.html" target="n" data-glyph="0,0" class="t t">CommandCollection</a> : <span class="i">Collection</span>&lt;<a href="#b55b68a3bf75e612" class="t t">Command</a>&gt;
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Make the default constructor internal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="0901a086d0d4d603" href="../../R/0901a086d0d4d603.html" target="n" data-glyph="74,1" class="t constructor">CommandCollection</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a new command for given string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="66864c9c0903c153" href="../../R/66864c9c0903c153.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r52 rd" class="r52 r">command</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r52 r">command</span>, <span class="s">&quot;out-default&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#8276f51c05ad2fa1" class="k">this</a>.<a href="#ccd44e7a4c3e0596" class="i method">Add</a>(<span class="r52 r">command</span>, <b>true</b>);
            }
            <b>else</b>
            {
                <a href="#8276f51c05ad2fa1" class="k">this</a>.<span class="i">Add</span>(<b>new</b> <a href="#6c075592cf04e686" class="t constructor">Command</a>(<span class="r52 r">command</span>));
            }
        }
 
        <b>internal void</b> <a id="ccd44e7a4c3e0596" href="../../R/ccd44e7a4c3e0596.html" target="n" data-glyph="74,1" class="i method">Add</a>(<b>string</b> <span id="r53 rd" class="r53 r">command</span>, <b>bool</b> <span id="r54 rd" class="r54 r">mergeUnclaimedPreviousCommandError</span>)
        {
            <a href="#8276f51c05ad2fa1" class="k">this</a>.<span class="i">Add</span>(<b>new</b> <a href="#4f147eb3e5cf10da" class="t constructor">Command</a>(<span class="r53 r">command</span>, <b>false</b>, <b>false</b>, <span class="r54 r">mergeUnclaimedPreviousCommandError</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a new script command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">scriptContents</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Script contents.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> scriptContents is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="78c5b464fbd0645d" href="../../R/78c5b464fbd0645d.html" target="n" data-glyph="72,1" class="i method">AddScript</a>(<b>string</b> <span id="r55 rd" class="r55 r">scriptContents</span>)
        {
            <a href="#8276f51c05ad2fa1" class="k">this</a>.<span class="i">Add</span>(<b>new</b> <a href="#12fe527c78833611" class="t constructor">Command</a>(<span class="r55 r">scriptContents</span>, <b>true</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a new scrip command for given script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">scriptContents</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Script contents.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">useLocalScope</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true local scope is used to run the script command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> scriptContents is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0be808ccdf9effac" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AddScript</a>(<b>string</b> <span id="r56 rd" class="r56 r">scriptContents</span>, <b>bool</b> <span id="r57 rd" class="r57 r">useLocalScope</span>)
        {
            <a href="#8276f51c05ad2fa1" class="k">this</a>.<span class="i">Add</span>(<b>new</b> <a href="#7daa1db0ede574c4" class="t constructor">Command</a>(<span class="r56 r">scriptContents</span>, <b>true</b>, <span class="r57 r">useLocalScope</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the string representation of the command collection to be used for history.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> string representing the command(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="2f29888d02182b59" href="../../R/2f29888d02182b59.html" target="n" data-glyph="74,1" class="i method">GetCommandStringForHistory</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#8276f51c05ad2fa1" class="k">this</a>.<span class="i">Count</span> != 0, <span class="s">&quot;this is called when there is at least one element in the collection&quot;</span>);
            <a href="#b55b68a3bf75e612" class="t t">Command</a> <span id="r58 rd" class="r58 r">firstCommand</span> = <a href="#8276f51c05ad2fa1" class="k">this</a>[0];
            <b>return</b> <span class="r58 r">firstCommand</span>.<a href="#e67df99c50711b7c" class="i property">CommandText</a>;
        }
    }
}
</pre></td></tr></table></div></body></html>
