<!DOCTYPE html>
<html><head><title>MshHostUserInterface.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1335);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/MshHostUserInterface.cs" target="_top">engine\hostifaces\MshHostUserInterface.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Configuration</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the properties and facilities providing by an hosting application deriving from</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that offers dialog-oriented and</span>
    <span class="c">///</span><span class="c"> line-oriented interactive features.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostRawUserInterface.cs.html#74913c6687237500" class="t t">PSHostRawUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <b>public abstract class</b> <a id="3fd0cd9d58631820" href="../../R/3fd0cd9d58631820.html" target="n" data-glyph="0,0" class="t t">PSHostUserInterface</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets hosting application&#39;s implementation of the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostRawUserInterface.cs.html#74913c6687237500" class="t t">PSHostRawUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> abstract base class</span>
        <span class="c">///</span><span class="c"> that implements that class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A reference to an instance of the hosting application&#39;s implementation of a class derived from</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or null to indicate that</span>
        <span class="c">///</span><span class="c"> low-level user interaction is not supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHostRawUserInterface.cs.html#74913c6687237500" class="t t">PSHostRawUserInterface</a> <a id="9f0fd1e53edb6283" href="../../R/9f0fd1e53edb6283.html" target="n" data-glyph="102,1" class="i property">RawUI</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true for hosts that support VT100 like virtual terminals.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="db1bed8dd5c8b0b2" href="../../R/db1bed8dd5c8b0b2.html" target="n" data-glyph="102,1" class="i property">SupportsVirtualTerminal</a> { <b>get</b> { <b>return</b> <b>false</b>; } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Line-oriented interaction
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads characters from the console until a newline (a carriage return) is encountered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters typed by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#924d77aa1733e4af" class="i method">ReadLineAsSecureString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#22ada0187831536b" class="i method">Prompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract string</b> <a id="757513ec6b537932" href="../../R/757513ec6b537932.html" target="n" data-glyph="72,1" class="i method">ReadLine</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as ReadLine, except that the result is a SecureString, and that the input is not echoed to the user while it is</span>
        <span class="c">///</span><span class="c"> collected (or is echoed in some obfuscated way, such as showing a dot for each character).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters typed by the user in an encrypted form.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note that credentials (a user name and password) should be gathered with</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#757513ec6b537932" class="i method">ReadLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#22ada0187831536b" class="i method">Prompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract</b> <span class="i">SecureString</span> <a id="924d77aa1733e4af" href="../../R/924d77aa1733e4af.html" target="n" data-glyph="72,1" class="i method">ReadLineAsSecureString</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes characters to the screen buffer.  Does not append a carriage return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span><span class="c"> Here we choose to just offer string parameters rather than the 18 overloads from TextWriter </span><span class="c">--&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters to be written.  null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#9f8dff5004571391" class="i method">Write</a>(<span class="i">ConsoleColor</span>, <span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">WriteLine</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="49793db835d30773" href="../../R/49793db835d30773.html" target="n" data-glyph="72,1" class="i method">Write</a>(<b>string</b> <span id="r0 rd" class="r0 r">value</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> except that colors can be specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">foregroundColor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The foreground color to display the text with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">backgroundColor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The foreground color to display the text with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters to be written.  null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">WriteLine</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="9f8dff5004571391" href="../../R/9f8dff5004571391.html" target="n" data-glyph="72,1" class="i method">Write</a>(<span class="i">ConsoleColor</span> <span id="r1 rd" class="r1 r">foregroundColor</span>, <span class="i">ConsoleColor</span> <span id="r2 rd" class="r2 r">backgroundColor</span>, <b>string</b> <span id="r3 rd" class="r3 r">value</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default implementation writes a carriage return to the screen buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">Write</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">WriteLine</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="f95b9cbe920380e3" href="../../R/f95b9cbe920380e3.html" target="n" data-glyph="72,1" class="i method">WriteLine</a>()
        {
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes characters to the screen buffer, and appends a carriage return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters to be written.  null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">Write</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">WriteLine</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="41cef667d4ee22a2" href="../../R/41cef667d4ee22a2.html" target="n" data-glyph="72,1" class="i method">WriteLine</a>(<b>string</b> <span id="r4 rd" class="r4 r">value</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> except that colors can be specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">foregroundColor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The foreground color to display the text with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">backgroundColor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The foreground color to display the text with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters to be written.  null is not allowed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">Write</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public virtual void</b> <a id="57a8b9dae9bd5b90" href="../../R/57a8b9dae9bd5b90.html" target="n" data-glyph="72,1" class="i method">WriteLine</a>(<span class="i">ConsoleColor</span> <span id="r5 rd" class="r5 r">foregroundColor</span>, <span class="i">ConsoleColor</span> <span id="r6 rd" class="r6 r">backgroundColor</span>, <b>string</b> <span id="r7 rd" class="r7 r">value</span>)
        {
            <span class="c">// #pragma warning disable 56506</span>
 
            <span class="c">// expressly not checking for value == null so that attempts to write a null cause an exception</span>
 
            <b>if</b> ((<span class="r7 r">value</span> != <b>null</b>) &amp;&amp; (<span class="r7 r">value</span>.<span class="i">Length</span> != 0))
            {
                <a href="#9f8dff5004571391" class="i method">Write</a>(<span class="r5 r">foregroundColor</span>, <span class="r6 r">backgroundColor</span>, <span class="r7 r">value</span>);
            }
 
            <a href="#49793db835d30773" class="i method">Write</a>(<span class="s">&quot;\n&quot;</span>);
 
            <span class="c">// #pragma warning restore 56506</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes a line to the &quot;error display&quot; of the host, as opposed to the &quot;output display,&quot; which is</span>
        <span class="c">///</span><span class="c"> written to by the variants of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">Write</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The characters to be written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#49793db835d30773" class="i method">Write</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">Write</span>(<span class="i n">System</span>.<span class="i">ConsoleColor</span>, <span class="i n">System</span>.<span class="i">ConsoleColor</span>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#f95b9cbe920380e3" class="i method">WriteLine</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#41cef667d4ee22a2" class="i method">WriteLine</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="c90737c2e1ab652f" href="../../R/c90737c2e1ab652f.html" target="n" data-glyph="72,1" class="i method">WriteErrorLine</a>(<b>string</b> <span id="r8 rd" class="r8 r">value</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to display a debugging message</span>
        <span class="c">///</span><span class="c"> to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c3454a9a37eaf706" class="i method">WriteProgress</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#be9a01fd092f8614" class="i method">WriteVerboseLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#1c7bdddbbd1bab31" class="i method">WriteWarningLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="92e834f5f174ffe2" href="../../R/92e834f5f174ffe2.html" target="n" data-glyph="72,1" class="i method">WriteDebugLine</a>(<b>string</b> <span id="r9 rd" class="r9 r">message</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#e3c96c3f4d6c3412" class="i method">WriteProgress</a>(<span class="i">Int64</span>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to display a progress record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">sourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique identifier of the source of the record.  An int64 is used because typically, the &#39;this&#39; pointer of</span>
        <span class="c">///</span><span class="c"> the command from whence the record is originating is used, and that may be from a remote Runspace on a 64-bit</span>
        <span class="c">///</span><span class="c"> machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">record</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The record being reported to the host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#92e834f5f174ffe2" class="i method">WriteDebugLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#be9a01fd092f8614" class="i method">WriteVerboseLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#1c7bdddbbd1bab31" class="i method">WriteWarningLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="c3454a9a37eaf706" href="../../R/c3454a9a37eaf706.html" target="n" data-glyph="72,1" class="i method">WriteProgress</a>(<span class="i">Int64</span> <span id="r10 rd" class="r10 r">sourceId</span>, <a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r11 rd" class="r11 r">record</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to display a verbose processing message to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#92e834f5f174ffe2" class="i method">WriteDebugLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c3454a9a37eaf706" class="i method">WriteProgress</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#1c7bdddbbd1bab31" class="i method">WriteWarningLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="be9a01fd092f8614" href="../../R/be9a01fd092f8614.html" target="n" data-glyph="72,1" class="i method">WriteVerboseLine</a>(<b>string</b> <span id="r12 rd" class="r12 r">message</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to display a warning processing message to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#92e834f5f174ffe2" class="i method">WriteDebugLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c3454a9a37eaf706" class="i method">WriteProgress</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#be9a01fd092f8614" class="i method">WriteVerboseLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract void</b> <a id="1c7bdddbbd1bab31" href="../../R/1c7bdddbbd1bab31.html" target="n" data-glyph="72,1" class="i method">WriteWarningLine</a>(<b>string</b> <span id="r13 rd" class="r13 r">message</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoked by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#f38cc55507c70e22" class="i method">WriteInformation</a>(<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to give the host a chance to intercept</span>
        <span class="c">///</span><span class="c"> informational messages. These should not be displayed to the user by default, but may be useful to display in</span>
        <span class="c">///</span><span class="c"> a separate area of the user interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="2f108cabc6b8ab99" href="../../R/2f108cabc6b8ab99.html" target="n" data-glyph="72,1" class="i method">WriteInformation</a>(<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r14 rd" class="r14 r">record</span>) { }
 
        <span class="c">// Gets the state associated with PowerShell transcription.</span>
        <span class="c">//</span>
        <span class="c">// Ideally, this would be associated with the host instance, but remoting recycles host instances</span>
        <span class="c">// for each command that gets invoked (so that it can keep track of the order of commands and their</span>
        <span class="c">// output.) Therefore, we store this transcription data in the runspace. However, the</span>
        <span class="c">// Runspace.DefaultRunspace property isn&#39;t always available (i.e.: when the pipeline is being set up),</span>
        <span class="c">// so we have to cache it the first time it becomes available.</span>
        <b>private</b> <a href="#173198ea0a1b5a14" class="t t">TranscriptionData</a> <a id="a92735eb4ba13f63" href="../../R/a92735eb4ba13f63.html" target="n" data-glyph="106,1" class="i property">TranscriptionData</a>
        {
            <b>get</b>
            {
                <span class="c">// If we have access to a runspace, use the transcription data for that runspace.</span>
                <span class="c">// This is important when you have multiple runspaces within a host.</span>
                <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r15 rd" class="r15 r">localRunspace</span> = <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> <b>as</b> <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>;
                <b>if</b> (<span class="r15 r">localRunspace</span> != <b>null</b>)
                {
                    <a href="#be07a8d758b548af" class="i field">_volatileTranscriptionData</a> = <span class="r15 r">localRunspace</span>.<a href="LocalConnection.cs.html#45c5866746b6cfad" class="i property">TranscriptionData</a>;
                    <b>if</b> (<a href="#be07a8d758b548af" class="i field">_volatileTranscriptionData</a> != <b>null</b>)
                    {
                        <b>return</b> <a href="#be07a8d758b548af" class="i field">_volatileTranscriptionData</a>;
                    }
                }
 
                <span class="c">// Otherwise, use the last stored transcription data. This will let us transcribe</span>
                <span class="c">// errors where the runspace has gone away.</span>
                <b>if</b> (<a href="#be07a8d758b548af" class="i field">_volatileTranscriptionData</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#be07a8d758b548af" class="i field">_volatileTranscriptionData</a>;
                }
 
                <a href="#173198ea0a1b5a14" class="t t">TranscriptionData</a> <span id="r16 rd" class="r16 r">temporaryTranscriptionData</span> = <b>new</b> <a href="#a1534410fbc69ff6" class="t constructor">TranscriptionData</a>();
                <b>return</b> <span class="r16 r">temporaryTranscriptionData</span>;
            }
        }
 
        <b>private</b> <a href="#173198ea0a1b5a14" class="t t">TranscriptionData</a> <a id="be07a8d758b548af" href="../../R/be07a8d758b548af.html" target="n" data-glyph="46,1" class="i field">_volatileTranscriptionData</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transcribes a command being invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">commandText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The text of the command being invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">invocation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation info of the command being transcribed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="7188fb1935e5bf88" href="../../R/7188fb1935e5bf88.html" target="n" data-glyph="74,1" class="i method">TranscribeCommand</a>(<b>string</b> <span id="r17 rd" class="r17 r">commandText</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r18 rd" class="r18 r">invocation</span>)
        {
            <b>if</b> (<a href="#2bb5722680cacb88" class="i method">ShouldIgnoreCommand</a>(<span class="r17 r">commandText</span>, <span class="r18 r">invocation</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#6694b338e46fdead" class="i property">IsTranscribing</a>)
            {
                <span class="c">// We don&#39;t actually log the output here, because there may be multiple command invocations</span>
                <span class="c">// in a single input - especially in the case of API logging, which logs the command and</span>
                <span class="c">// its parameters as separate calls.</span>
                <span class="c">// Instead, we add this to the &#39;pendingOutput&#39; collection, which we flush when either</span>
                <span class="c">// the command generates output, or when we are told to invoke ignore the next command.</span>
                <b>foreach</b> (<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r19 rd" class="r19 r">transcript</span> <b>in</b> <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Prepend</span>&lt;<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a>&gt;(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>))
                {
                    <b>if</b> (<span class="r19 r">transcript</span> != <b>null</b>)
                    {
                        <b>lock</b> (<span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>)
                        {
                            <b>if</b> (<span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Count</span> == 0)
                            {
                                <b>if</b> (<span class="r19 r">transcript</span>.<a href="#3d17208d7c641ce2" class="i property">IncludeInvocationHeader</a>)
                                {
                                    <span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="s">&quot;**********************&quot;</span>);
                                    <span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(
                                        <b>string</b>.<span class="i">Format</span>(
                                            <span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">CommandStartTime</span>,
                                            <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">ToString</span>(<span class="s">&quot;yyyyMMddHHmmss&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>)));
                                    <span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="s">&quot;**********************&quot;</span>);
                                }
 
                                <span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#deade8d32d146875" class="i property">PromptText</a> + <span class="r17 r">commandText</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r19 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="s">&quot;&gt;&gt; &quot;</span> + <span class="r17 r">commandText</span>);
                            }
                        }
                    }
                }
            }
        }
 
        <b>private bool</b> <a id="2bb5722680cacb88" href="../../R/2bb5722680cacb88.html" target="n" data-glyph="76,1" class="i method">ShouldIgnoreCommand</a>(<b>string</b> <span id="r20 rd" class="r20 r">logElement</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r21 rd" class="r21 r">invocation</span>)
        {
            <b>string</b> <span id="r22 rd" class="r22 r">commandName</span> = <span class="r20 r">logElement</span>;
 
            <b>if</b> (<span class="r21 r">invocation</span> != <b>null</b>)
            {
                <span class="r22 r">commandName</span> = <span class="r21 r">invocation</span>.<a href="../InvocationInfo.cs.html#57f452abf157b50b" class="i property">InvocationName</a>;
 
                <span class="c">// Do not transcribe Out-Default</span>
                <a href="../CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r23 rd" class="r23 r">invocationCmdlet</span> = <span class="r21 r">invocation</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> <b>as</b> <a href="../CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
                <b>if</b> (<span class="r23 r">invocationCmdlet</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r23 r">invocationCmdlet</span>.<a href="../CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a> == <b>typeof</b>(<span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../../FormatAndOutput/out-console/OutConsole.cs.html#c9bb0040912f3314" class="t t">OutDefaultCommand</a>))
                    {
                        <span class="c">// We will ignore transcribing the command itself, but not call the IgnoreCommand() method</span>
                        <span class="c">// (because that will ignore the results)</span>
                        <b>return</b> <b>true</b>;
                    }
                }
 
                <span class="c">// Don&#39;t log internal commands to the transcript.</span>
                <b>if</b> (<span class="r21 r">invocation</span>.<a href="../InvocationInfo.cs.html#02c0f35838462a5e" class="i property">CommandOrigin</a> == <a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
                {
                    <a href="#1b682db62f9ecad5" class="i method">IgnoreCommand</a>(<span class="r20 r">logElement</span>, <span class="r21 r">invocation</span>);
                    <b>return</b> <b>true</b>;
                }
            }
 
            <span class="c">// Don&#39;t log helper commands to the transcript</span>
            <b>string</b>[] <span id="r24 rd" class="r24 r">helperCommands</span> = { <span class="s">&quot;TabExpansion2&quot;</span>, <span class="s">&quot;prompt&quot;</span>, <span class="s">&quot;TabExpansion&quot;</span>, <span class="s">&quot;PSConsoleHostReadline&quot;</span> };
            <b>foreach</b> (<b>string</b> <span id="r25 rd" class="r25 r">helperCommand</span> <b>in</b> <span class="r24 r">helperCommands</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r25 r">helperCommand</span>, <span class="r22 r">commandName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#1b682db62f9ecad5" class="i method">IgnoreCommand</a>(<span class="r20 r">logElement</span>, <span class="r21 r">invocation</span>);
 
                    <span class="c">// Record that this is a helper command. In this case, we ignore even the results</span>
                    <span class="c">// from Out-Default</span>
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a> = <b>true</b>;
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signals that a command being invoked (and its output) should be ignored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">commandText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The text of the command being invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">invocation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation info of the command being transcribed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1b682db62f9ecad5" href="../../R/1b682db62f9ecad5.html" target="n" data-glyph="74,1" class="i method">IgnoreCommand</a>(<b>string</b> <span id="r26 rd" class="r26 r">commandText</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r27 rd" class="r27 r">invocation</span>)
        {
            <a href="#8410249b6597a203" class="i method">TranscribeCommandComplete</a>(<b>null</b>);
 
            <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> == <b>null</b>)
            {
                <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> = <span class="r26 r">commandText</span>;
                <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a> = <b>false</b>;
 
                <b>if</b> ((<span class="r27 r">invocation</span> != <b>null</b>) &amp;&amp; (<span class="r27 r">invocation</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> != <b>null</b>))
                {
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> = <span class="r27 r">invocation</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag to determine whether the host is in &quot;Transcribe Only&quot; mode,</span>
        <span class="c">///</span><span class="c"> so that when content is sent through Out-Default it doesn&#39;t</span>
        <span class="c">///</span><span class="c"> make it to the actual host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0b0a4196ed6cce64" href="../../R/0b0a4196ed6cce64.html" target="n" data-glyph="104,1" class="i property">TranscribeOnly</a> =&gt; <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#9914e03acaaf0c06" class="i field">_transcribeOnlyCount</a>, 0, 0) != 0;
 
        <b>private int</b> <a id="9914e03acaaf0c06" href="../../R/9914e03acaaf0c06.html" target="n" data-glyph="46,1" class="i field">_transcribeOnlyCount</a> = 0;
 
        <b>internal</b> <span class="i">IDisposable</span> <a id="2884bb47531616d1" href="../../R/2884bb47531616d1.html" target="n" data-glyph="74,1" class="i method">SetTranscribeOnly</a>() =&gt; <b>new</b> <a href="#0bf5c44f0a4b0b11" class="t constructor">TranscribeOnlyCookie</a>(<a href="#3fd0cd9d58631820" class="k">this</a>);
 
        <b>private sealed class</b> <a id="307d3c0e7617e30a" href="../../R/307d3c0e7617e30a.html" target="n" data-glyph="4,1" class="t t">TranscribeOnlyCookie</a> : <span class="i">IDisposable</span>
        {
            <b>private readonly</b> <a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <a id="1ac9b2da23311e91" href="../../R/1ac9b2da23311e91.html" target="n" data-glyph="46,2" class="i field">_ui</a>;
            <b>private bool</b> <a id="9eaea3fb3c319783" href="../../R/9eaea3fb3c319783.html" target="n" data-glyph="46,2" class="i field">_disposed</a> = <b>false</b>;
 
            <b>public</b> <a id="0bf5c44f0a4b0b11" href="../../R/0bf5c44f0a4b0b11.html" target="n" data-glyph="72,2" class="t constructor">TranscribeOnlyCookie</a>(<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <span id="r28 rd" class="r28 r">ui</span>)
            {
                <a href="#1ac9b2da23311e91" class="i field">_ui</a> = <span class="r28 r">ui</span>;
                <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#1ac9b2da23311e91" class="i field">_ui</a>.<a href="#9914e03acaaf0c06" class="i field">_transcribeOnlyCount</a>);
            }
 
            <b>public void</b> <a id="08acf9977cde511f" href="../../R/08acf9977cde511f.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <b>if</b> (!<a href="#9eaea3fb3c319783" class="i field">_disposed</a>)
                {
                    <span class="i">Interlocked</span>.<span class="i">Decrement</span>(<b>ref</b> <a href="#1ac9b2da23311e91" class="i field">_ui</a>.<a href="#9914e03acaaf0c06" class="i field">_transcribeOnlyCount</a>);
                    <a href="#9eaea3fb3c319783" class="i field">_disposed</a> = <b>true</b>;
                    <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#307d3c0e7617e30a" class="k">this</a>);
                }
            }
 
            ~<a id="ce5c1874e00a5648" href="../../R/../../0000000000.html" target="n" data-glyph="75,2" class="t method">TranscribeOnlyCookie</a>() =&gt; <a href="#08acf9977cde511f" class="i method">Dispose</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag to determine whether the host is transcribing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6694b338e46fdead" href="../../R/6694b338e46fdead.html" target="n" data-glyph="104,1" class="i property">IsTranscribing</a>
        {
            <b>get</b>
            {
                <a href="#fb238ab4f58c2573" class="i method">CheckSystemTranscript</a>();
                <b>return</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Count</span> &gt; 0) || (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> != <b>null</b>);
            }
        }
 
        <b>private void</b> <a id="fb238ab4f58c2573" href="../../R/fb238ab4f58c2573.html" target="n" data-glyph="76,1" class="i method">CheckSystemTranscript</a>()
        {
            <b>lock</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>)
            {
                <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> == <b>null</b>)
                {
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> = <a href="#84f060f4f67bdc10" class="i method">GetSystemTranscriptOption</a>(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>);
                    <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> != <b>null</b>)
                    {
                        <a href="#cd07807ac59db352" class="i method">LogTranscriptHeader</a>(<b>null</b>, <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>);
                    }
                }
            }
        }
 
        <b>internal void</b> <a id="86f1eacd7ccb763c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">StartTranscribing</a>(<b>string</b> <span id="r29 rd" class="r29 r">path</span>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a> <span id="r30 rd" class="r30 r">senderInfo</span>, <b>bool</b> <span id="r31 rd" class="r31 r">includeInvocationHeader</span>, <b>bool</b> <span id="r32 rd" class="r32 r">useMinimalHeader</span>)
        {
            <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r33 rd" class="r33 r">transcript</span> = <b>new</b> <a href="#d0c5b33e2a1b1b3c" class="t constructor">TranscriptionOption</a>();
            <span class="r33 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a> = <span class="r29 r">path</span>;
            <span class="r33 r">transcript</span>.<a href="#3d17208d7c641ce2" class="i property">IncludeInvocationHeader</a> = <span class="r31 r">includeInvocationHeader</span>;
            <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Add</span>(<span class="r33 r">transcript</span>);
 
            <a href="#cd07807ac59db352" class="i method">LogTranscriptHeader</a>(<span class="r30 r">senderInfo</span>, <span class="r33 r">transcript</span>, <span class="r32 r">useMinimalHeader</span>);
        }
 
        <b>private void</b> <a id="cd07807ac59db352" href="../../R/cd07807ac59db352.html" target="n" data-glyph="76,1" class="i method">LogTranscriptHeader</a>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a> <span id="r34 rd" class="r34 r">senderInfo</span>, <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r35 rd" class="r35 r">transcript</span>, <b>bool</b> <span id="r36 rd" class="r36 r">useMinimalHeader</span> = <b>false</b>)
        {
            <span class="c">// Transcribe the transcript header</span>
            <b>string</b> <span id="r37 rd" class="r37 r">line</span>;
            <b>if</b> (<span class="r36 r">useMinimalHeader</span>)
            {
                <span class="r37 r">line</span> =
                    <b>string</b>.<span class="i">Format</span>(
                        <span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">MinimalTranscriptPrologue</span>,
                        <span class="i">DateTime</span>.<span class="i">Now</span>);
            }
            <b>else</b>
            {
                <b>string</b> <span id="r38 rd" class="r38 r">username</span> = <span class="i">Environment</span>.<span class="i">UserDomainName</span> + <span class="s">&quot;\\&quot;</span> + <span class="i">Environment</span>.<span class="i">UserName</span>;
                <b>string</b> <span id="r39 rd" class="r39 r">runAsUser</span> = <span class="r38 r">username</span>;
 
                <b>if</b> (<span class="r34 r">senderInfo</span> != <b>null</b>)
                {
                    <span class="r38 r">username</span> = <span class="r34 r">senderInfo</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#ac3b737833cbe3e1" class="i property">UserInfo</a>.<a href="../remoting/fanin/PSPrincipal.cs.html#be3c94a41767a974" class="i property">Identity</a>.<a href="../remoting/fanin/PSPrincipal.cs.html#5ec5296e7ff7b744" class="i property">Name</a>;
                }
 
                <span class="c">// Add bits from PSVersionTable</span>
                <span class="i">StringBuilder</span> <span id="r40 rd" class="r40 r">versionInfoFooter</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="i">Hashtable</span> <span id="r41 rd" class="r41 r">versionInfo</span> = <a href="../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../PSVersionInfo.cs.html#79732d42fa2b24db" class="i method">GetPSVersionTable</a>();
                <b>foreach</b> (<b>string</b> <span id="r42 rd" class="r42 r">versionKey</span> <b>in</b> <span class="r41 r">versionInfo</span>.<span class="i">Keys</span>)
                {
                    <b>object</b> <span id="r43 rd" class="r43 r">value</span> = <span class="r41 r">versionInfo</span>[<span class="r42 r">versionKey</span>];
 
                    <b>if</b> (<span class="r43 r">value</span> != <b>null</b>)
                    {
                        <b>var</b> <span id="r44 rd" class="r44 r">arrayValue</span> = <span class="r43 r">value</span> <b>as object</b>[];
                        <b>string</b> <span id="r45 rd" class="r45 r">valueString</span> = <span class="r44 r">arrayValue</span> != <b>null</b> ? <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;, &quot;</span>, <span class="r44 r">arrayValue</span>) : <span class="r43 r">value</span>.<span class="i">ToString</span>();
                        <span class="r40 r">versionInfoFooter</span>.<span class="i">AppendLine</span>(<span class="r42 r">versionKey</span> + <span class="s">&quot;: &quot;</span> + <span class="r45 r">valueString</span>);
                    }
                }
 
                <b>string</b> <span id="r46 rd" class="r46 r">configurationName</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>if</b> (<span class="r34 r">senderInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r34 r">senderInfo</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#6eab5e435b27241d" class="i property">ConfigurationName</a>))
                {
                    <span class="r46 r">configurationName</span> = <span class="r34 r">senderInfo</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#6eab5e435b27241d" class="i property">ConfigurationName</a>;
                }
 
                <span class="r37 r">line</span> =
                    <b>string</b>.<span class="i">Format</span>(
                        <span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">TranscriptPrologue</span>,
                        <span class="i">DateTime</span>.<span class="i">Now</span>,
                        <span class="r38 r">username</span>,
                        <span class="r39 r">runAsUser</span>,
                        <span class="r46 r">configurationName</span>,
                        <span class="i">Environment</span>.<span class="i">MachineName</span>,
                        <span class="i">Environment</span>.<span class="i">OSVersion</span>.<span class="i">VersionString</span>,
                        <b>string</b>.<span class="i">Join</span>(<span class="s">&quot; &quot;</span>, <span class="i">Environment</span>.<span class="i">GetCommandLineArgs</span>()),
                        <span class="i">Environment</span>.<span class="i">ProcessId</span>,
                        <span class="r40 r">versionInfoFooter</span>.<span class="i">ToString</span>().<span class="i">TrimEnd</span>());
            }
 
            <b>lock</b> (<span class="r35 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>)
            {
                <span class="r35 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="r37 r">line</span>);
            }
 
            <a href="#8410249b6597a203" class="i method">TranscribeCommandComplete</a>(<b>null</b>);
        }
 
        <b>internal string</b> <a id="991ec2e3ea01a6a6" href="../../R/991ec2e3ea01a6a6.html" target="n" data-glyph="74,1" class="i method">StopTranscribing</a>()
        {
            <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">HostNotTranscribing</span>);
            }
 
            <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r47 rd" class="r47 r">stoppedTranscript</span> = <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>[<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Count</span> - 1];
            <a href="#261d6f092ee2597e" class="i method">LogTranscriptFooter</a>(<span class="r47 r">stoppedTranscript</span>);
            <span class="r47 r">stoppedTranscript</span>.<a href="#1500c075064d80ec" class="i method">Dispose</a>();
            <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Remove</span>(<span class="r47 r">stoppedTranscript</span>);
 
            <b>return</b> <span class="r47 r">stoppedTranscript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>;
        }
 
        <b>private void</b> <a id="261d6f092ee2597e" href="../../R/261d6f092ee2597e.html" target="n" data-glyph="76,1" class="i method">LogTranscriptFooter</a>(<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r48 rd" class="r48 r">stoppedTranscript</span>)
        {
            <span class="c">// Transcribe the transcript epilogue</span>
            <b>try</b>
            {
                <b>string</b> <span id="r49 rd" class="r49 r">message</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">TranscriptEpilogue</span>, <span class="i">DateTime</span>.<span class="i">Now</span>);
 
                <b>lock</b> (<span class="r48 r">stoppedTranscript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>)
                {
                    <span class="r48 r">stoppedTranscript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="r49 r">message</span>);
                }
 
                <a href="#8410249b6597a203" class="i method">TranscribeCommandComplete</a>(<b>null</b>);
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// Ignoring errors when stopping transcription (i.e.: file in use, access denied)</span>
                <span class="c">// since this is probably handling exactly that error.</span>
            }
        }
 
        <b>internal void</b> <a id="235e1c773fa51f01" href="../../R/235e1c773fa51f01.html" target="n" data-glyph="74,1" class="i method">StopAllTranscribing</a>()
        {
            <a href="#8410249b6597a203" class="i method">TranscribeCommandComplete</a>(<b>null</b>);
 
            <b>while</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#991ec2e3ea01a6a6" class="i method">StopTranscribing</a>();
            }
 
            <b>lock</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>)
            {
                <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> != <b>null</b>)
                {
                    <a href="#261d6f092ee2597e" class="i method">LogTranscriptFooter</a>(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>);
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>.<a href="#1500c075064d80ec" class="i method">Dispose</a>();
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> = <b>null</b>;
 
                    <b>lock</b> (<a href="#e48a0df15b4edb7c" class="i field">s_systemTranscriptLock</a>)
                    {
                        <a href="#59055fde320fcdfb" class="i field">systemTranscript</a> = <b>null</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transcribes the supplied result text to the transcription buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">sourceRunspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace that was used to generate this result, if it is not the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">resultText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The text to be transcribed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="4aa9f1398cea63e7" href="../../R/4aa9f1398cea63e7.html" target="n" data-glyph="74,1" class="i method">TranscribeResult</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r50 rd" class="r50 r">sourceRunspace</span>, <b>string</b> <span id="r51 rd" class="r51 r">resultText</span>)
        {
            <b>if</b> (<a href="#6694b338e46fdead" class="i property">IsTranscribing</a>)
            {
                <span class="c">// If the runspace that this result applies to is not the current runspace, update Runspace.DefaultRunspace</span>
                <span class="c">// so that the transcript paths / etc. will be available to the TranscriptionData accessor.</span>
                <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r52 rd" class="r52 r">originalDefaultRunspace</span> = <b>null</b>;
                <b>if</b> (<span class="r50 r">sourceRunspace</span> != <b>null</b>)
                {
                    <span class="r52 r">originalDefaultRunspace</span> = <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
                    <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r50 r">sourceRunspace</span>;
                }
 
                <b>try</b>
                {
                    <span class="c">// If we&#39;re ignoring a command, ignore its output.</span>
                    <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> != <b>null</b>)
                    {
                        <span class="c">// If we&#39;re ignoring a prompt, capture the value</span>
                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;prompt&quot;</span>, <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#deade8d32d146875" class="i property">PromptText</a> = <span class="r51 r">resultText</span>;
                        }
 
                        <b>return</b>;
                    }
 
                    <span class="r51 r">resultText</span> = <span class="r51 r">resultText</span>.<span class="i">TrimEnd</span>();
 
                    <a href="../../FormatAndOutput/common/StringDecorated.cs.html#c4ddb2a2993f79b9" class="k">var</a> <span id="r53 rd" class="r53 r">text</span> = <b>new</b> <a href="../../FormatAndOutput/common/StringDecorated.cs.html#3833cb3fe7fffe53" class="t constructor">ValueStringDecorated</a>(<span class="r51 r">resultText</span>);
                    <b>if</b> (<span class="r53 r">text</span>.<a href="../../FormatAndOutput/common/StringDecorated.cs.html#93ec27487cb62cf0" class="i property">IsDecorated</a>)
                    {
                        <span class="r51 r">resultText</span> = <span class="r53 r">text</span>.<a href="../../FormatAndOutput/common/StringDecorated.cs.html#5db8a00d8d418e4d" class="i method">ToString</a>(<a href="../../FormatAndOutput/common/PSStyle.cs.html#aaed168a484b0007" class="t t">OutputRendering</a>.<a href="../../FormatAndOutput/common/PSStyle.cs.html#bd2dfddf3028517b" class="i field">PlainText</a>);
                    }
 
                    <b>foreach</b> (<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r54 rd" class="r54 r">transcript</span> <b>in</b> <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Prepend</span>&lt;<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a>&gt;(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>))
                    {
                        <b>if</b> (<span class="r54 r">transcript</span> != <b>null</b>)
                        {
                            <b>lock</b> (<span class="r54 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>)
                            {
                                <span class="r54 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Add</span>(<span class="r51 r">resultText</span>);
                            }
                        }
                    }
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r52 r">originalDefaultRunspace</span> != <b>null</b>)
                    {
                        <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r52 r">originalDefaultRunspace</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transcribes the supplied result text to the transcription buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">resultText</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The text to be transcribed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="257416bc2c610658" href="../../R/257416bc2c610658.html" target="n" data-glyph="74,1" class="i method">TranscribeResult</a>(<b>string</b> <span id="r55 rd" class="r55 r">resultText</span>)
        {
            <a href="#4aa9f1398cea63e7" class="i method">TranscribeResult</a>(<b>null</b>, <span class="r55 r">resultText</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transcribes / records the completion of a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">invocation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="8410249b6597a203" href="../../R/8410249b6597a203.html" target="n" data-glyph="74,1" class="i method">TranscribeCommandComplete</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r56 rd" class="r56 r">invocation</span>)
        {
            <a href="#a47a85045cc463bb" class="i method">FlushPendingOutput</a>();
 
            <b>if</b> (<span class="r56 r">invocation</span> != <b>null</b>)
            {
                <span class="c">// If we&#39;re ignoring a command that was internal, we still want the</span>
                <span class="c">// results of Out-Default. However, if it was a host helper command,</span>
                <span class="c">// ignore all output (including Out-Default)</span>
                <b>string</b> <span id="r57 rd" class="r57 r">commandNameToCheck</span> = <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a>;
                <b>if</b> (<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a>)
                {
                    <span class="r57 r">commandNameToCheck</span> = <span class="s">&quot;Out-Default&quot;</span>;
                }
 
                <span class="c">// If we&#39;re completing a command that we were ignoring, start transcribing results / etc. again.</span>
                <b>if</b> ((<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> != <b>null</b>) &amp;&amp;
                    (<span class="r56 r">invocation</span> != <b>null</b>) &amp;&amp; (<span class="r56 r">invocation</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> != <b>null</b>) &amp;&amp;
                    <b>string</b>.<span class="i">Equals</span>(<span class="r57 r">commandNameToCheck</span>, <span class="r56 r">invocation</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> = <b>null</b>;
                    <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a> = <b>false</b>;
                }
            }
        }
 
        <b>internal void</b> <a id="186e29d2134687da" href="../../R/186e29d2134687da.html" target="n" data-glyph="74,1" class="i method">TranscribePipelineComplete</a>()
        {
            <a href="#a47a85045cc463bb" class="i method">FlushPendingOutput</a>();
 
            <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> = <b>null</b>;
            <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a> = <b>false</b>;
        }
 
        <b>private void</b> <a id="a47a85045cc463bb" href="../../R/a47a85045cc463bb.html" target="n" data-glyph="76,1" class="i method">FlushPendingOutput</a>()
        {
            <b>foreach</b> (<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r58 rd" class="r58 r">transcript</span> <b>in</b> <a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#b8b18d63ad86a940" class="i property">Transcripts</a>.<span class="i">Prepend</span>&lt;<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a>&gt;(<a href="#a92735eb4ba13f63" class="i property">TranscriptionData</a>.<a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a>))
            {
                <b>if</b> (<span class="r58 r">transcript</span> != <b>null</b>)
                {
                    <b>lock</b> (<span class="r58 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>)
                    {
                        <b>if</b> (<span class="r58 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Count</span> == 0)
                        {
                            <b>continue</b>;
                        }
 
                        <b>lock</b> (<span class="r58 r">transcript</span>.<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>)
                        {
                            <b>bool</b> <span id="r59 rd" class="r59 r">alreadyLogging</span> = <span class="r58 r">transcript</span>.<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>.<span class="i">Count</span> &gt; 0;
 
                            <span class="r58 r">transcript</span>.<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>.<span class="i">AddRange</span>(<span class="r58 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>);
                            <span class="r58 r">transcript</span>.<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Clear</span>();
 
                            <span class="c">// If there is already a thread trying to log output, add this output to its buffer</span>
                            <span class="c">// and don&#39;t start a new thread.</span>
                            <b>if</b> (<span class="r59 r">alreadyLogging</span>)
                            {
                                <b>continue</b>;
                            }
                        }
                    }
 
                    <span class="c">// Create the file in the main thread and flush the contents in the background thread.</span>
                    <span class="c">// Transcription should begin only if file generation is successful.</span>
                    <span class="c">// If there is an error in file generation, throw the exception.</span>
                    <b>string</b> <span id="r60 rd" class="r60 r">baseDirectory</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>);
                    <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>) || (<b>string</b>.<span class="i">Equals</span>(<span class="r60 r">baseDirectory</span>, <span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>.<span class="i">TrimEnd</span>(<span class="i">Path</span>.<span class="i">DirectorySeparatorChar</span>), <span class="i">StringComparison</span>.<span class="i">Ordinal</span>)))
                    {
                        <b>string</b> <span id="r61 rd" class="r61 r">errorMessage</span> = <b>string</b>.<span class="i">Format</span>(
                            <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                            <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">InvalidTranscriptFilePath</span>,
                            <span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>);
                        <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r61 r">errorMessage</span>);
                    }
 
                    <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r60 r">baseDirectory</span>))
                    {
                        <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="r60 r">baseDirectory</span>);
                    }
 
                    <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>))
                    {
                        <span class="i">File</span>.<span class="i">Create</span>(<span class="r58 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a>).<span class="i">Dispose</span>();
                    }
 
                    <span class="c">// Do the actual writing in the background so that it doesn&#39;t hold up the UI thread.</span>
                    <span class="i">Task</span> <span id="r62 rd" class="r62 r">writer</span> = <span class="i">Task</span>.<span class="i">Run</span>(() =&gt;
                    {
                        <span class="c">// System transcripts can have high contention. Do exponential back-off on writing</span>
                        <span class="c">// if needed.</span>
                        <b>int</b> <span id="r63 rd" class="r63 r">delay</span> = <b>new</b> <span class="i">Random</span>().<span class="i">Next</span>(10) + 1;
                        <b>bool</b> <span id="r64 rd" class="r64 r">written</span> = <b>false</b>;
 
                        <b>while</b> (!<span class="r64 r">written</span>)
                        {
                            <b>try</b>
                            {
                                <span class="r58 r">transcript</span>.<a href="#8451cd7f2a2f04fb" class="i method">FlushContentToDisk</a>();
                                <span class="r64 r">written</span> = <b>true</b>;
                            }
                            <b>catch</b> (<span class="i">IOException</span>)
                            {
                                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(<span class="r63 r">delay</span>);
                            }
                            <b>catch</b> (<span class="i">UnauthorizedAccessException</span>)
                            {
                                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(<span class="r63 r">delay</span>);
                            }
 
                            <span class="c">// If we are trying to log, but weren&#39;t able too, back of the sleep.</span>
                            <span class="c">// If we&#39;re already sleeping for 1 second between tries, then just continue</span>
                            <span class="c">// at this pace until the write is successful.</span>
                            <b>if</b> (<span class="r63 r">delay</span> &lt; 1000)
                            {
                                <span class="r63 r">delay</span> *= 2;
                            }
                        }
                    });
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Line-oriented interaction
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Dialog-oriented Interaction
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a &#39;dialog&#39; where the user is presented with a number of fields for which to supply values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption to precede or title the prompt.  E.g. &quot;Parameters for get-foo (instance 1 of 2)&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A text description of the set of fields to be prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">descriptions</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array of FieldDescriptions that contain information about each field to be prompted for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Dictionary object with results of prompting.  The keys are the field names from the FieldDescriptions, the values</span>
        <span class="c">///</span><span class="c"> are objects representing the values of the corresponding fields as collected from the user. To the extent possible,</span>
        <span class="c">///</span><span class="c"> the host should return values of the type(s) identified in the FieldDescription.  When that is not possible (for</span>
        <span class="c">///</span><span class="c"> example, the type is not available to the host), the host should return the value as a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#757513ec6b537932" class="i method">ReadLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#924d77aa1733e4af" class="i method">ReadLineAsSecureString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="22ada0187831536b" href="../../R/22ada0187831536b.html" target="n" data-glyph="72,1" class="i method">Prompt</a>(<b>string</b> <span id="r65 rd" class="r65 r">caption</span>, <b>string</b> <span id="r66 rd" class="r66 r">message</span>, <span class="i">Collection</span>&lt;<a href="FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <span id="r67 rd" class="r67 r">descriptions</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prompt for credentials.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span><span class="c">In future, when we have Credential object from the security team,</span>
        <span class="c">///</span><span class="c"> this function will be modified to prompt using secure-path</span>
        <span class="c">///</span><span class="c"> if so configured.</span><span class="c">--&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prompt for credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption for the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description for the credential to be prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the user whose credential is to be prompted for. If set to null or empty</span>
        <span class="c">///</span><span class="c"> string, the function will prompt for user name first.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">targetName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target for which the credential is being collected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User input credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#757513ec6b537932" class="i method">ReadLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#924d77aa1733e4af" class="i method">ReadLineAsSecureString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#22ada0187831536b" class="i method">Prompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract</b> <a href="../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="d007f536e324addc" href="../../R/d007f536e324addc.html" target="n" data-glyph="72,1" class="i method">PromptForCredential</a>(<b>string</b> <span id="r68 rd" class="r68 r">caption</span>, <b>string</b> <span id="r69 rd" class="r69 r">message</span>,
            <b>string</b> <span id="r70 rd" class="r70 r">userName</span>, <b>string</b> <span id="r71 rd" class="r71 r">targetName</span>
        );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prompt for credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption for the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description for the credential to be prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the user whose credential is to be prompted for. If set to null or empty</span>
        <span class="c">///</span><span class="c"> string, the function will prompt for user name first.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">targetName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target for which the credential is being collected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">allowedCredentialTypes</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Types of credential can be supplied by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Options that control the credential gathering UI behavior</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User input credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#757513ec6b537932" class="i method">ReadLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#924d77aa1733e4af" class="i method">ReadLineAsSecureString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#22ada0187831536b" class="i method">Prompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract</b> <a href="../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="c0536df86979d645" href="../../R/c0536df86979d645.html" target="n" data-glyph="72,1" class="i method">PromptForCredential</a>(<b>string</b> <span id="r72 rd" class="r72 r">caption</span>, <b>string</b> <span id="r73 rd" class="r73 r">message</span>,
            <b>string</b> <span id="r74 rd" class="r74 r">userName</span>, <b>string</b> <span id="r75 rd" class="r75 r">targetName</span>, <a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a> <span id="r76 rd" class="r76 r">allowedCredentialTypes</span>,
            <a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a> <span id="r77 rd" class="r77 r">options</span>
        );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Presents a dialog allowing the user to choose an option from a set of options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption to precede or title the prompt.  E.g. &quot;Parameters for get-foo (instance 1 of 2)&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A message that describes what the choice is for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">choices</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An Collection of ChoiceDescription objects that describe each choice.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">defaultChoice</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index of the label in the choices collection element to be presented to the user as the default choice.  -1</span>
        <span class="c">///</span><span class="c"> means &quot;no default&quot;. Must be a valid index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index of the choices element that corresponds to the option selected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#757513ec6b537932" class="i method">ReadLine</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#924d77aa1733e4af" class="i method">ReadLineAsSecureString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#22ada0187831536b" class="i method">Prompt</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#d007f536e324addc" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#c0536df86979d645" class="i method">PromptForCredential</a>(<b>string</b>, <b>string</b>, <b>string</b>, <b>string</b>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#3c8d65daa06090d0" class="t t">PSCredentialTypes</a>, <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Credential.cs.html#2e1ffe5475875565" class="t t">PSCredentialUIOptions</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public abstract int</b> <a id="ca6be5c54f8936b2" href="../../R/ca6be5c54f8936b2.html" target="n" data-glyph="72,1" class="i method">PromptForChoice</a>(<b>string</b> <span id="r78 rd" class="r78 r">caption</span>, <b>string</b> <span id="r79 rd" class="r79 r">message</span>, <span class="i">Collection</span>&lt;<a href="ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt; <span id="r80 rd" class="r80 r">choices</span>, <b>int</b> <span id="r81 rd" class="r81 r">defaultChoice</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Dialog-oriented interaction
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the PSHostUserInterface class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="803b02d35bd51581" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">PSHostUserInterface</a>()
        {
            <a href="#fb238ab4f58c2573" class="i method">CheckSystemTranscript</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper to transcribe an error through formatting and output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Execution Context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">invocation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation info associated with the record.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">errorWrap</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error record.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c83a8ec1928e56c7" href="../../R/c83a8ec1928e56c7.html" target="n" data-glyph="74,1" class="i method">TranscribeError</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r82 rd" class="r82 r">context</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r83 rd" class="r83 r">invocation</span>, <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r84 rd" class="r84 r">errorWrap</span>)
        {
            <span class="r82 r">context</span>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="#8410249b6597a203" class="i method">TranscribeCommandComplete</a>(<span class="r83 r">invocation</span>);
            <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r85 rd" class="r85 r">minimalState</span> = <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#904bc85f721c6764" class="i method">CreateDefault2</a>();
            <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r86 rd" class="r86 r">results</span> = <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="PowerShell.cs.html#f41a8c4815429c5e" class="i method">Create</a>(<span class="r85 r">minimalState</span>).<a href="PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;Out-String&quot;</span>).<span class="i">Invoke</span>(
                <b>new</b> <span class="i">List</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;() { <span class="r84 r">errorWrap</span> });
            <span class="i">TranscribeResult</span>(<span class="r86 r">results</span>[0].<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get Module Logging information from the registry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <a id="84f060f4f67bdc10" href="../../R/84f060f4f67bdc10.html" target="n" data-glyph="74,1" class="i method">GetSystemTranscriptOption</a>(<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r87 rd" class="r87 r">currentTranscript</span>)
        {
            <b>var</b> <span id="r88 rd" class="r88 r">transcription</span> = <a href="../Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../Utils.cs.html#de82c6590fd7de27" class="i field">BypassGroupPolicyCaching</a>
                ? <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#fb031837cf810b13" class="i method">GetPolicySetting</a>&lt;<a href="../PSConfiguration.cs.html#d275218ef3d9ed7d" class="t t">Transcription</a>&gt;(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7a2ef29ad39fd97e" class="i field">SystemWideThenCurrentUserConfig</a>)
                : <a href="#4d7fbf53b84046c8" class="i field">s_transcriptionSettingCache</a>.<span class="i">Value</span>;
 
            <b>if</b> (<span class="r88 r">transcription</span> != <b>null</b>)
            {
                <span class="c">// If we have an existing system transcript for this process, use that.</span>
                <span class="c">// Otherwise, populate the static variable with the result of the group policy setting.</span>
                <span class="c">//</span>
                <span class="c">// This way, multiple runspaces opened by the same process will share the same transcript.</span>
                <b>lock</b> (<a href="#e48a0df15b4edb7c" class="i field">s_systemTranscriptLock</a>)
                {
                    <b>if</b> (<a href="#59055fde320fcdfb" class="i field">systemTranscript</a> == <b>null</b>)
                    {
                        <a href="#59055fde320fcdfb" class="i field">systemTranscript</a> = <a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<span class="i">GetTranscriptOptionFromSettings</span>(<span class="r88 r">transcription</span>, <span class="r87 r">currentTranscript</span>);
                    }
                }
            }
 
            <b>return</b> <a href="#59055fde320fcdfb" class="i field">systemTranscript</a>;
        }
 
        <b>internal static</b> <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <a id="59055fde320fcdfb" href="../../R/59055fde320fcdfb.html" target="n" data-glyph="44,1" class="i field">systemTranscript</a> = <b>null</b>;
        <b>private static readonly object</b> <a id="e48a0df15b4edb7c" href="../../R/e48a0df15b4edb7c.html" target="n" data-glyph="46,1" class="i field">s_systemTranscriptLock</a> = <b>new</b> <b>object</b>();
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<a href="../PSConfiguration.cs.html#d275218ef3d9ed7d" class="t t">Transcription</a>&gt; <a id="4d7fbf53b84046c8" href="../../R/4d7fbf53b84046c8.html" target="n" data-glyph="46,1" class="i field">s_transcriptionSettingCache</a> = <b>new</b> <span class="i">Lazy</span>&lt;<a href="../PSConfiguration.cs.html#d275218ef3d9ed7d" class="t t">Transcription</a>&gt;(
            <b>static</b> () =&gt; <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#fb031837cf810b13" class="i method">GetPolicySetting</a>&lt;<a href="../PSConfiguration.cs.html#d275218ef3d9ed7d" class="t t">Transcription</a>&gt;(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7a2ef29ad39fd97e" class="i field">SystemWideThenCurrentUserConfig</a>),
            <span class="i">isThreadSafe</span>: <b>true</b>);
 
        <b>private static</b> <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <a id="c903b0d0898a434d" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetTranscriptOptionFromSettings</a>(<a href="../PSConfiguration.cs.html#d275218ef3d9ed7d" class="t t">Transcription</a> <span id="r89 rd" class="r89 r">transcriptConfig</span>, <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r90 rd" class="r90 r">currentTranscript</span>)
        {
            <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <span id="r91 rd" class="r91 r">transcript</span> = <b>null</b>;
 
            <b>if</b> (<span class="r89 r">transcriptConfig</span>.<a href="../PSConfiguration.cs.html#b95f4913258ff578" class="i property">EnableTranscripting</a> == <b>true</b>)
            {
                <b>if</b> (<span class="r90 r">currentTranscript</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r90 r">currentTranscript</span>;
                }
 
                <span class="r91 r">transcript</span> = <b>new</b> <a href="#d0c5b33e2a1b1b3c" class="t constructor">TranscriptionOption</a>();
 
                <span class="c">// Pull out the transcript path</span>
                <b>if</b> (<span class="r89 r">transcriptConfig</span>.<a href="../PSConfiguration.cs.html#10bfc69615da1c88" class="i property">OutputDirectory</a> != <b>null</b>)
                {
                    <span class="r91 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a> = <a href="#54d0cfab29661586" class="i method">GetTranscriptPath</a>(<span class="r89 r">transcriptConfig</span>.<a href="../PSConfiguration.cs.html#10bfc69615da1c88" class="i property">OutputDirectory</a>, <b>true</b>);
                }
                <b>else</b>
                {
                    <span class="r91 r">transcript</span>.<a href="#e80bed8679c81604" class="i property">Path</a> = <a href="#d49afe2f04a64869" class="i method">GetTranscriptPath</a>();
                }
 
                <span class="c">// Pull out the &quot;enable invocation header&quot;</span>
                <span class="r91 r">transcript</span>.<a href="#3d17208d7c641ce2" class="i property">IncludeInvocationHeader</a> = <span class="r89 r">transcriptConfig</span>.<a href="../PSConfiguration.cs.html#17c9dbd86d7b8dbf" class="i property">EnableInvocationHeader</a> == <b>true</b>;
            }
 
            <b>return</b> <span class="r91 r">transcript</span>;
        }
 
        <b>internal static string</b> <a id="d49afe2f04a64869" href="../../R/d49afe2f04a64869.html" target="n" data-glyph="74,1" class="i method">GetTranscriptPath</a>()
        {
            <b>string</b> <span id="r92 rd" class="r92 r">baseDirectory</span> = <a href="../../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<span class="i">GetFolderPath</span>(<span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">MyDocuments</span>);
            <b>return</b> <a href="#54d0cfab29661586" class="i method">GetTranscriptPath</a>(<span class="r92 r">baseDirectory</span>, <b>false</b>);
        }
 
        <b>internal static string</b> <a id="54d0cfab29661586" href="../../R/54d0cfab29661586.html" target="n" data-glyph="74,1" class="i method">GetTranscriptPath</a>(<b>string</b> <span id="r93 rd" class="r93 r">baseDirectory</span>, <b>bool</b> <span id="r94 rd" class="r94 r">includeDate</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r93 r">baseDirectory</span>))
            {
                <span class="r93 r">baseDirectory</span> = <a href="../../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<span class="i">GetFolderPath</span>(<span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">MyDocuments</span>);
            }
            <b>else</b>
            {
                <b>if</b> (!<span class="i">Path</span>.<span class="i">IsPathRooted</span>(<span class="r93 r">baseDirectory</span>))
                {
                    <span class="r93 r">baseDirectory</span> = <span class="i">Path</span>.<span class="i">Combine</span>(
                        <a href="../../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<span class="i">GetFolderPath</span>(<span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">MyDocuments</span>),
                        <span class="r93 r">baseDirectory</span>);
                }
            }
 
            <b>if</b> (<span class="r94 r">includeDate</span>)
            {
                <span class="r93 r">baseDirectory</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r93 r">baseDirectory</span>, <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">ToString</span>(<span class="s">&quot;yyyyMMdd&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            }
 
            <span class="c">// transcriptPath includes some randomness so that files can be collected on a central share,</span>
            <span class="c">// and an attacker can&#39;t guess the filename and read the contents if the ACL was poor.</span>
            <span class="c">// After testing, a computer can do about 10,000 remote path tests per second. So 6</span>
            <span class="c">// bytes of randomness (2^48 = 2.8e14) would take an attacker about 891 years to guess</span>
            <span class="c">// a filename (assuming they knew the time the transcript was started).</span>
            <span class="c">// (5 bytes = 3 years, 4 bytes = about a month)</span>
            <b>byte</b>[] <span id="r95 rd" class="r95 r">randomBytes</span> = <b>new</b> <b>byte</b>[6];
            <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">RandomNumberGenerator</span>.<span class="i">Create</span>().<span class="i">GetBytes</span>(<span class="r95 r">randomBytes</span>);
            <b>string</b> <span id="r96 rd" class="r96 r">filename</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">&quot;PowerShell_transcript.{0}.{1}.{2:yyyyMMddHHmmss}.txt&quot;</span>,
                        <span class="i">Environment</span>.<span class="i">MachineName</span>,
                        <span class="i">Convert</span>.<span class="i">ToBase64String</span>(<span class="r95 r">randomBytes</span>).<span class="i">Replace</span>(<span class="s">&#39;/&#39;</span>, <span class="s">&#39;_&#39;</span>),
                        <span class="i">DateTime</span>.<span class="i">Now</span>);
 
            <b>string</b> <span id="r97 rd" class="r97 r">transcriptPath</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">Combine</span>(<span class="r93 r">baseDirectory</span>, <span class="r96 r">filename</span>);
            <b>return</b> <span class="r97 r">transcriptPath</span>;
        }
    }
 
    <span class="c">// Holds runspace-wide transcription data / settings for PowerShell transcription</span>
    <b>internal class</b> <a id="173198ea0a1b5a14" href="../../R/173198ea0a1b5a14.html" target="n" data-glyph="2,0" class="t t">TranscriptionData</a>
    {
        <b>internal</b> <a id="a1534410fbc69ff6" href="../../R/a1534410fbc69ff6.html" target="n" data-glyph="74,1" class="t constructor">TranscriptionData</a>()
        {
            <a href="#b8b18d63ad86a940" class="i property">Transcripts</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a>&gt;();
            <a href="#8d8881b9ecf0ea0f" class="i property">SystemTranscript</a> = <b>null</b>;
            <a href="#4cd412c328e4eff8" class="i property">CommandBeingIgnored</a> = <b>null</b>;
            <a href="#e34b9adae747aac2" class="i property">IsHelperCommand</a> = <b>false</b>;
            <a href="#deade8d32d146875" class="i property">PromptText</a> = <span class="s">&quot;PS&gt;&quot;</span>;
        }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a>&gt; <a id="b8b18d63ad86a940" href="../../R/b8b18d63ad86a940.html" target="n" data-glyph="104,1" class="i property">Transcripts</a> { <b>get</b>; }
 
        <b>internal</b> <a href="#18ddd9f01ca8e0a0" class="t t">TranscriptionOption</a> <a id="8d8881b9ecf0ea0f" href="../../R/8d8881b9ecf0ea0f.html" target="n" data-glyph="104,1" class="i property">SystemTranscript</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal string</b> <a id="4cd412c328e4eff8" href="../../R/4cd412c328e4eff8.html" target="n" data-glyph="104,1" class="i property">CommandBeingIgnored</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="e34b9adae747aac2" href="../../R/e34b9adae747aac2.html" target="n" data-glyph="104,1" class="i property">IsHelperCommand</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal string</b> <a id="deade8d32d146875" href="../../R/deade8d32d146875.html" target="n" data-glyph="104,1" class="i property">PromptText</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">// Holds options for PowerShell transcription</span>
    <b>internal class</b> <a id="18ddd9f01ca8e0a0" href="../../R/18ddd9f01ca8e0a0.html" target="n" data-glyph="2,0" class="t t">TranscriptionOption</a> : <span class="i">IDisposable</span>
    {
        <b>internal</b> <a id="d0c5b33e2a1b1b3c" href="../../R/d0c5b33e2a1b1b3c.html" target="n" data-glyph="74,1" class="t constructor">TranscriptionOption</a>()
        {
            <a href="#d08b64698ee65be3" class="i property">OutputToLog</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path that this transcript is being logged to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="e80bed8679c81604" href="../../R/e80bed8679c81604.html" target="n" data-glyph="104,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any output to log for this transcript.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="d08b64698ee65be3" href="../../R/d08b64698ee65be3.html" target="n" data-glyph="104,1" class="i property">OutputToLog</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any output currently being logged for this transcript.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="d51fca6f703b816e" href="../../R/d51fca6f703b816e.html" target="n" data-glyph="104,1" class="i property">OutputBeingLogged</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether to include time stamp / command separators in</span>
        <span class="c">///</span><span class="c"> transcript output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="3d17208d7c641ce2" href="../../R/3d17208d7c641ce2.html" target="n" data-glyph="104,1" class="i property">IncludeInvocationHeader</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Logs buffered content to disk. We use this instead of File.AppendAllLines</span>
        <span class="c">///</span><span class="c"> so that we don&#39;t need to pay seek penalties all the time, and so that we</span>
        <span class="c">///</span><span class="c"> don&#39;t need append permission to our own files.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="8451cd7f2a2f04fb" href="../../R/8451cd7f2a2f04fb.html" target="n" data-glyph="74,1" class="i method">FlushContentToDisk</a>()
        {
            <b>static</b> <span class="i">Encoding</span> <a id="07d99da3e6200276" href="../../R/07d99da3e6200276.html" target="n" data-glyph="76,2" class="i method">GetPathEncoding</a>(<b>string</b> <span id="r98 rd" class="r98 r">path</span>)
            {
                <b>using</b> <span class="i">StreamReader</span> <span id="r99 rd" class="r99 r">reader</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r98 r">path</span>, <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7a7127f6fafd6bca" class="i field">utf8NoBom</a>, <span class="i">detectEncodingFromByteOrderMarks</span>: <b>true</b>);
                <b>_</b> = <span class="r99 r">reader</span>.<span class="i">Read</span>();
                <b>return</b> <span class="r99 r">reader</span>.<span class="i">CurrentEncoding</span>;
            }
 
            <b>lock</b> (<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>)
            {
                <b>if</b> (!<a href="#f91a5f46809be42f" class="i field">_disposed</a>)
                {
                    <b>if</b> (<a href="#d78eb1a976839a69" class="i field">_contentWriter</a> == <b>null</b>)
                    {
                        <b>try</b>
                        {
                            <b>var</b> <span id="r100 rd" class="r100 r">currentEncoding</span> = <a href="#07d99da3e6200276" class="i method">GetPathEncoding</a>(<a href="#18ddd9f01ca8e0a0" class="k">this</a>.<a href="#e80bed8679c81604" class="i property">Path</a>);
 
                            <span class="c">// Try to first open the file with permissions that will allow us to read from it</span>
                            <span class="c">// later.</span>
                            <a href="#d78eb1a976839a69" class="i field">_contentWriter</a> = <b>new</b> <span class="i">StreamWriter</span>(
                                <b>new</b> <span class="i">FileStream</span>(<a href="#18ddd9f01ca8e0a0" class="k">this</a>.<a href="#e80bed8679c81604" class="i property">Path</a>, <span class="i">FileMode</span>.<span class="i">OpenOrCreate</span>, <span class="i">FileAccess</span>.<span class="i">ReadWrite</span>, <span class="i">FileShare</span>.<span class="i">Read</span>),
                                <span class="r100 r">currentEncoding</span>);
                            <a href="#d78eb1a976839a69" class="i field">_contentWriter</a>.<span class="i">BaseStream</span>.<span class="i">Seek</span>(0, <span class="i">SeekOrigin</span>.<span class="i">End</span>);
                        }
                        <b>catch</b> (<span class="i">IOException</span>)
                        {
                            <span class="c">// If that doesn&#39;t work (i.e.: logging to a tightly-ACL&#39;d share), request fewer</span>
                            <span class="c">// file permissions.</span>
                            <a href="#d78eb1a976839a69" class="i field">_contentWriter</a> = <b>new</b> <span class="i">StreamWriter</span>(
                                <b>new</b> <span class="i">FileStream</span>(<a href="#18ddd9f01ca8e0a0" class="k">this</a>.<a href="#e80bed8679c81604" class="i property">Path</a>, <span class="i">FileMode</span>.<span class="i">Append</span>, <span class="i">FileAccess</span>.<span class="i">Write</span>, <span class="i">FileShare</span>.<span class="i">Read</span>),
                                <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7a7127f6fafd6bca" class="i field">utf8NoBom</a>);
                        }
 
                        <a href="#d78eb1a976839a69" class="i field">_contentWriter</a>.<span class="i">AutoFlush</span> = <b>true</b>;
                    }
 
                    <b>foreach</b> (<b>string</b> <span id="r101 rd" class="r101 r">line</span> <b>in</b> <a href="#18ddd9f01ca8e0a0" class="k">this</a>.<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>)
                    {
                        <a href="#d78eb1a976839a69" class="i field">_contentWriter</a>.<span class="i">WriteLine</span>(<span class="r101 r">line</span>);
                    }
                }
 
                <a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>.<span class="i">Clear</span>();
            }
        }
 
        <b>private</b> <span class="i">StreamWriter</span> <a id="d78eb1a976839a69" href="../../R/d78eb1a976839a69.html" target="n" data-glyph="46,1" class="i field">_contentWriter</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disposes this runspace instance. Dispose will close the runspace if not closed already.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="1500c075064d80ec" href="../../R/1500c075064d80ec.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (<a href="#f91a5f46809be42f" class="i field">_disposed</a>) { <b>return</b>; }
 
            <span class="c">// Wait for any pending output to be flushed to disk so that Stop-Transcript</span>
            <span class="c">// can be trusted to immediately have all content from that session in the file)</span>
            <b>int</b> <span id="r102 rd" class="r102 r">outputWait</span> = 0;
            <b>while</b> (
                (<span class="r102 r">outputWait</span> &lt; 1000) &amp;&amp;
                ((<a href="#d08b64698ee65be3" class="i property">OutputToLog</a>.<span class="i">Count</span> &gt; 0) || (<a href="#d51fca6f703b816e" class="i property">OutputBeingLogged</a>.<span class="i">Count</span> &gt; 0)))
            {
                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(100);
                <span class="r102 r">outputWait</span> += 100;
            }
 
            <b>if</b> (<a href="#d78eb1a976839a69" class="i field">_contentWriter</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="#d78eb1a976839a69" class="i field">_contentWriter</a>.<span class="i">Flush</span>();
                    <a href="#d78eb1a976839a69" class="i field">_contentWriter</a>.<span class="i">Dispose</span>();
                }
                <b>catch</b> (<span class="i">ObjectDisposedException</span>)
                {
                    <span class="c">// Do nothing</span>
                }
                <b>catch</b> (<span class="i">IOException</span>)
                {
                    <span class="c">// Do nothing</span>
                }
 
                <a href="#d78eb1a976839a69" class="i field">_contentWriter</a> = <b>null</b>;
            }
 
            <a href="#f91a5f46809be42f" class="i field">_disposed</a> = <b>true</b>;
        }
 
        <b>private bool</b> <a id="f91a5f46809be42f" href="../../R/f91a5f46809be42f.html" target="n" data-glyph="46,1" class="i field">_disposed</a> = <b>false</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This interface needs to be implemented by PSHost objects that want to support PromptForChoice</span>
    <span class="c">///</span><span class="c"> by giving the user ability to select more than one choice. The PromptForChoice method available</span>
    <span class="c">///</span><span class="c"> in PSHostUserInterface class supports only one choice selection.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="47d463f128d96e29" href="../../R/47d463f128d96e29.html" target="n" data-glyph="48,0" class="t t">IHostUISupportsMultipleChoiceSelection</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Presents a dialog allowing the user to choose options from a set of options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption to precede or title the prompt.  E.g. &quot;Parameters for get-foo (instance 1 of 2)&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A message that describes what the choice is for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">choices</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An Collection of ChoiceDescription objects that describe each choice.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">defaultChoices</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index of the labels in the choices collection element to be presented to the user as</span>
        <span class="c">///</span><span class="c"> the default choice(s).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The indices of the choice elements that corresponds to the options selected. The</span>
        <span class="c">///</span><span class="c"> returned collection may contain duplicates depending on a particular host</span>
        <span class="c">///</span><span class="c"> implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="#3fd0cd9d58631820" class="t t">PSHostUserInterface</a>.<a href="#ca6be5c54f8936b2" class="i method">PromptForChoice</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="i">Collection</span>&lt;<b>int</b>&gt; <a id="bd2f86bb31265d4c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PromptForChoice</a>(<b>string</b>? <span id="r103 rd" class="r103 r">caption</span>, <b>string</b>? <span id="r104 rd" class="r104 r">message</span>,
            <span class="i">Collection</span>&lt;<a href="ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt; <span id="r105 rd" class="r105 r">choices</span>, <span class="i">IEnumerable</span>&lt;<b>int</b>&gt;? <span id="r106 rd" class="r106 r">defaultChoices</span>);
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper methods used by PowerShell&#39;s Hosts: ConsoleHost and InternalHost to process</span>
    <span class="c">///</span><span class="c"> PromptForChoice.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="67cbc0ec2046b78e" href="../../R/67cbc0ec2046b78e.html" target="n" data-glyph="2,0" class="t t">HostUIHelperMethods</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a string of the choices and their hotkeys.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">choices</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">hotkeysAndPlainLabels</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. Cannot process the hot key because a question mark (&quot;?&quot;) cannot be used as a hot key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="3be2039382474d73" href="../../R/3be2039382474d73.html" target="n" data-glyph="74,1" class="i method">BuildHotkeysAndPlainLabels</a>(<span class="i">Collection</span>&lt;<a href="ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt; <span id="r107 rd" class="r107 r">choices</span>,
            <b>out string</b>[,] <span id="r108 rd" class="r108 r">hotkeysAndPlainLabels</span>)
        {
            <span class="c">// we will allocate the result array</span>
            <span class="r108 r">hotkeysAndPlainLabels</span> = <b>new</b> <b>string</b>[2, <span class="r107 r">choices</span>.<span class="i">Count</span>];
 
            <b>for</b> (<b>int</b> <span id="r109 rd" class="r109 r">i</span> = 0; <span class="r109 r">i</span> &lt; <span class="r107 r">choices</span>.<span class="i">Count</span>; ++<span class="r109 r">i</span>)
            {
                <span class="k preprocess">#</span><span class="k preprocess">region</span> SplitLabel
                <span class="r108 r">hotkeysAndPlainLabels</span>[0, <span class="r109 r">i</span>] = <b>string</b>.<span class="i">Empty</span>;
                <b>int</b> <span id="r110 rd" class="r110 r">andPos</span> = <span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">IndexOf</span>(<span class="s">&#39;&amp;&#39;</span>);
                <b>if</b> (<span class="r110 r">andPos</span> &gt;= 0)
                {
                    <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r111 rd" class="r111 r">splitLabel</span> = <b>new</b> <span class="i">Text</span>.<span class="i">StringBuilder</span>(<span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">Substring</span>(0, <span class="r110 r">andPos</span>), <span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">Length</span>);
                    <b>if</b> (<span class="r110 r">andPos</span> + 1 &lt; <span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">Length</span>)
                    {
                        <span class="r111 r">splitLabel</span>.<span class="i">Append</span>(<span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">AsSpan</span>(<span class="r110 r">andPos</span> + 1));
                        <span class="r108 r">hotkeysAndPlainLabels</span>[0, <span class="r109 r">i</span>] = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">TextInfo</span>.<span class="i">ToUpper</span>(<span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>.<span class="i">AsSpan</span>(<span class="r110 r">andPos</span> + 1, 1).<span class="i">Trim</span>().<span class="i">ToString</span>());
                    }
 
                    <span class="r108 r">hotkeysAndPlainLabels</span>[1, <span class="r109 r">i</span>] = <span class="r111 r">splitLabel</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
                }
                <b>else</b>
                {
                    <span class="r108 r">hotkeysAndPlainLabels</span>[1, <span class="r109 r">i</span>] = <span class="r107 r">choices</span>[<span class="r109 r">i</span>].<span class="i">Label</span>;
                }
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SplitLabel
 
                <span class="c">// ? is not localizable</span>
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r108 r">hotkeysAndPlainLabels</span>[0, <span class="r109 r">i</span>], <span class="s">&quot;?&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="i">Exception</span> <span id="r112 rd" class="r112 r">e</span> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(
                        <b>string</b>.<span class="i">Format</span>(<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;choices[{0}].Label&quot;</span>, <span class="r109 r">i</span>),
                        <span class="i">InternalHostUserInterfaceStrings</span>.<span class="i">InvalidChoiceHotKeyError</span>);
                    <b>throw</b> <span class="r112 r">e</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Searches for a corresponding match between the response string and the choices.  A match is either the response</span>
        <span class="c">///</span><span class="c"> string is the full text of the label (sans hotkey marker), or is a hotkey.  Full labels are checked first, and take</span>
        <span class="c">///</span><span class="c"> precedence over hotkey matches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">response</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">choices</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">hotkeysAndPlainLabels</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the index into the choices array matching the response string, or -1 if there is no match.</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="cafed17429a243be" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DetermineChoicePicked</a>(<b>string</b> <span id="r113 rd" class="r113 r">response</span>, <span class="i">Collection</span>&lt;<a href="ChoiceDescription.cs.html#1f38c9f99af41345" class="t t">ChoiceDescription</a>&gt; <span id="r114 rd" class="r114 r">choices</span>, <b>string</b>[,] <span id="r115 rd" class="r115 r">hotkeysAndPlainLabels</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r114 r">choices</span> != <b>null</b>, <span class="s">&quot;choices: expected a value&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r115 r">hotkeysAndPlainLabels</span> != <b>null</b>, <span class="s">&quot;hotkeysAndPlainLabels: expected a value&quot;</span>);
 
            <b>int</b> <span id="r116 rd" class="r116 r">result</span> = -1;
 
            <span class="c">// check the full label first, as this is the least ambiguous</span>
            <b>for</b> (<b>int</b> <span id="r117 rd" class="r117 r">i</span> = 0; <span class="r117 r">i</span> &lt; <span class="r114 r">choices</span>.<span class="i">Count</span>; ++<span class="r117 r">i</span>)
            {
                <span class="c">// pick the one that matches either the hot key or the full label</span>
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r113 r">response</span>, <span class="r115 r">hotkeysAndPlainLabels</span>[1, <span class="r117 r">i</span>], <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>))
                {
                    <span class="r116 r">result</span> = <span class="r117 r">i</span>;
                    <b>break</b>;
                }
            }
 
            <span class="c">// now check the hotkeys</span>
            <b>if</b> (<span class="r116 r">result</span> == -1)
            {
                <b>for</b> (<b>int</b> <span id="r118 rd" class="r118 r">i</span> = 0; <span class="r118 r">i</span> &lt; <span class="r114 r">choices</span>.<span class="i">Count</span>; ++<span class="r118 r">i</span>)
                {
                    <span class="c">// Ignore labels with empty hotkeys</span>
                    <b>if</b> (<span class="r115 r">hotkeysAndPlainLabels</span>[0, <span class="r118 r">i</span>].<span class="i">Length</span> &gt; 0)
                    {
                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r113 r">response</span>, <span class="r115 r">hotkeysAndPlainLabels</span>[0, <span class="r118 r">i</span>], <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>))
                        {
                            <span class="r116 r">result</span> = <span class="r118 r">i</span>;
                            <b>break</b>;
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r116 r">result</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
