<!DOCTYPE html>
<html><head><title>RunspacePool.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1391);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/RunspacePool.cs" target="_top">engine\hostifaces\RunspacePool.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">PSHost</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Exceptions
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Exception thrown when state of the runspace pool is different from</span>
    <span class="c">///</span><span class="c"> expected state of runspace pool.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="741ffc1755303d69" href="../../R/741ffc1755303d69.html" target="n" data-glyph="0,0" class="t t">InvalidRunspacePoolStateException</a> : <span class="i">SystemException</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidRunspacePoolStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="45b13a313eaef3ae" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspacePoolStateException</a>()
        : <b>base</b>
        (
            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspacePoolStrings</span>.<span class="i">InvalidRunspacePoolStateGeneral</span>)
        )
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidRunspacePoolStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="96ff8beac53fead8" href="../../R/96ff8beac53fead8.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspacePoolStateException</a>(<b>string</b> <span id="r0 rd" class="r0 r">message</span>)
            : <b>base</b>(<span class="r0 r">message</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidRunspacePoolStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that is the cause of the current exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="68ef70fa53ef8305" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidRunspacePoolStateException</a>(<b>string</b> <span id="r1 rd" class="r1 r">message</span>, <span class="i">Exception</span> <span id="r2 rd" class="r2 r">innerException</span>)
            : <b>base</b>(<span class="r1 r">message</span>, <span class="r2 r">innerException</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidRunspacePoolStateException</span>
        <span class="c">///</span><span class="c"> with a specified error message and current and expected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The message that describes the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">currentState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current state of runspace pool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">expectedState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected state of the runspace pool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="53060b2dd310e4fc" href="../../R/53060b2dd310e4fc.html" target="n" data-glyph="74,1" class="t constructor">InvalidRunspacePoolStateException</a>
        (
            <b>string</b> <span id="r3 rd" class="r3 r">message</span>,
            <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <span id="r4 rd" class="r4 r">currentState</span>,
            <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <span id="r5 rd" class="r5 r">expectedState</span>
        )
            : <b>base</b>(<span class="r3 r">message</span>)
        {
            <a href="#9629aed321c33b33" class="i field">_expectedState</a> = <span class="r5 r">expectedState</span>;
            <a href="#ac8d50478d5c79c7" class="i field">_currentState</a> = <span class="r4 r">currentState</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ISerializable Members
 
        <span class="c">// No need to implement GetObjectData</span>
        <span class="c">// if all fields are static or [NonSerialized]</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidRunspacePoolStateException</span>
        <span class="c">///</span><span class="c"> class with serialized data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SerializationInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that holds</span>
        <span class="c">///</span><span class="c"> the serialized object data about the exception being thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">StreamingContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that contains</span>
        <span class="c">///</span><span class="c"> contextual information about the source or destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b>
        <a id="30b6fa75c076e3f2" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">InvalidRunspacePoolStateException</a>(<span class="i">SerializationInfo</span> <span id="r6 rd" class="r6 r">info</span>, <span class="i">StreamingContext</span> <span id="r7 rd" class="r7 r">context</span>)
            : <b>base</b>(<span class="r6 r">info</span>, <span class="r7 r">context</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Access CurrentState of the runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the state of the runspace pool when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <a id="064e843993acd110" href="../../R/064e843993acd110.html" target="n" data-glyph="102,1" class="i property">CurrentState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ac8d50478d5c79c7" class="i field">_currentState</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Expected state of runspace pool by the operation which has thrown</span>
        <span class="c">///</span><span class="c"> this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <a id="09cca3afe95cc4ba" href="../../R/09cca3afe95cc4ba.html" target="n" data-glyph="102,1" class="i property">ExpectedState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9629aed321c33b33" class="i field">_expectedState</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the current to an InvalidRunspaceStateException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <a id="aeea64df1e9df609" href="../../R/aeea64df1e9df609.html" target="n" data-glyph="74,1" class="i method">ToInvalidRunspaceStateException</a>()
        {
            <a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <span id="r8 rd" class="r8 r">exception</span> = <b>new</b> <span class="t">InvalidRunspaceStateException</span>(
                <span class="i">RunspaceStrings</span>.<span class="i">InvalidRunspaceStateGeneral</span>,
                <a href="#741ffc1755303d69" class="k">this</a>);
            <span class="r8 r">exception</span>.<a href="Connection.cs.html#ffbdf8c870b07522" class="i property">CurrentState</a> = <a href="#4c8e82b92765d329" class="i method">RunspacePoolStateToRunspaceState</a>(<a href="#741ffc1755303d69" class="k">this</a>.<a href="#064e843993acd110" class="i property">CurrentState</a>);
            <span class="r8 r">exception</span>.<a href="Connection.cs.html#097b6c06ae0a57c8" class="i property">ExpectedState</a> = <a href="#4c8e82b92765d329" class="i method">RunspacePoolStateToRunspaceState</a>(<a href="#741ffc1755303d69" class="k">this</a>.<a href="#09cca3afe95cc4ba" class="i property">ExpectedState</a>);
            <b>return</b> <span class="r8 r">exception</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts a RunspacePoolState to a RunspaceState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="4c8e82b92765d329" href="../../R/4c8e82b92765d329.html" target="n" data-glyph="76,1" class="i method">RunspacePoolStateToRunspaceState</a>(<a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <span id="r9 rd" class="r9 r">state</span>)
        {
            <b>switch</b> (<span class="r9 r">state</span>)
            {
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#66c805b7b59385a4" class="i field">BeforeOpen</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#3403f57e932b5ec3" class="i field">Opening</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#3990ad8b3e3feec7" class="i field">Opening</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#13cbf83371c004e0" class="i field">Opened</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#494904731e18b593" class="i field">Closed</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#2b6027539b9d1816" class="i field">Closing</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#fb276cb28f922b8e" class="i field">Closing</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#48a121178c7c288f" class="i field">Broken</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#91690c7b66b3081a" class="i field">Disconnecting</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#31c8fe83ad58dbdb" class="i field">Disconnecting</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#fb0d368190577383" class="i field">Disconnected</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>;
 
                <b>case</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#332d1241bf520aa3" class="i field">Connecting</a>:
                    <b>return</b> <a href="Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="Connection.cs.html#1c027aab2310d438" class="i field">Connecting</a>;
 
                <b>default</b>:
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Unexpected RunspacePoolState&quot;</span>);
                    <b>return</b> 0;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of the runspace pool when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private readonly</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <a id="ac8d50478d5c79c7" href="../../R/ac8d50478d5c79c7.html" target="n" data-glyph="46,1" class="i field">_currentState</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of the runspace pool expected in method which throws this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private readonly</b> <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <a id="9629aed321c33b33" href="../../R/9629aed321c33b33.html" target="n" data-glyph="46,1" class="i field">_expectedState</a> = 0;
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> State
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines various states of a runspace pool.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="b51dd15975151fb4" href="../../R/b51dd15975151fb4.html" target="n" data-glyph="18,0" class="t t"><span id="ee41193e78291b54">RunspacePoolState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Beginning state upon creation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="66c805b7b59385a4" href="../../R/66c805b7b59385a4.html" target="n" data-glyph="24,1" class="i field">BeforeOpen</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A RunspacePool is being created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="3403f57e932b5ec3" href="../../R/3403f57e932b5ec3.html" target="n" data-glyph="24,1" class="i field">Opening</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool is created and valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="13cbf83371c004e0" href="../../R/13cbf83371c004e0.html" target="n" data-glyph="24,1" class="i field">Opened</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool is closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="494904731e18b593" href="../../R/494904731e18b593.html" target="n" data-glyph="24,1" class="i field">Closed</a> = 3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool is being closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2b6027539b9d1816" href="../../R/2b6027539b9d1816.html" target="n" data-glyph="24,1" class="i field">Closing</a> = 4,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool has been disconnected abnormally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="48a121178c7c288f" href="../../R/48a121178c7c288f.html" target="n" data-glyph="24,1" class="i field">Broken</a> = 5,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool is being disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="91690c7b66b3081a" href="../../R/91690c7b66b3081a.html" target="n" data-glyph="24,1" class="i field">Disconnecting</a> = 6,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool has been disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="fb0d368190577383" href="../../R/fb0d368190577383.html" target="n" data-glyph="24,1" class="i field">Disconnected</a> = 7,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The RunspacePool is being connected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="332d1241bf520aa3" href="../../R/332d1241bf520aa3.html" target="n" data-glyph="24,1" class="i field">Connecting</a> = 8,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to runspacepool state change handlers</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c1948c2f22e6b527" class="t t">RunspacePool</a>.<a href="#e81fb7a9266008ab" class="i">StateChanged</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="ff0d60fc9c4fde6c" href="../../R/ff0d60fc9c4fde6c.html" target="n" data-glyph="0,0" class="t t">RunspacePoolStateChangedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> state to raise the event with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="741cb669ec025fb7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">RunspacePoolStateChangedEventArgs</a>(<a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a> <span id="r10 rd" class="r10 r">state</span>)
        {
            <a href="#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a> = <b>new</b> <a href="../remoting/common/RunspacePoolStateInfo.cs.html#c7dae263df1aded0" class="t constructor">RunspacePoolStateInfo</a>(<span class="r10 r">state</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">stateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="843936ad6bee0e6e" href="../../R/843936ad6bee0e6e.html" target="n" data-glyph="74,1" class="t constructor">RunspacePoolStateChangedEventArgs</a>(<a href="../remoting/common/RunspacePoolStateInfo.cs.html#8b9143609d7a0363" class="t t">RunspacePoolStateInfo</a> <span id="r11 rd" class="r11 r">stateInfo</span>)
        {
            <a href="#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a> = <span class="r11 r">stateInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the stateinfo of RunspacePool when this event occurred.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../remoting/common/RunspacePoolStateInfo.cs.html#8b9143609d7a0363" class="t t">RunspacePoolStateInfo</a> <a id="5c91747fcd8ee469" href="../../R/5c91747fcd8ee469.html" target="n" data-glyph="102,1" class="i property">RunspacePoolStateInfo</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to RunspaceCreated event of RunspacePool.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="63e95a292a76e722" href="../../R/63e95a292a76e722.html" target="n" data-glyph="2,0" class="t t">RunspaceCreatedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a2c40eb236d69276" href="../../R/a2c40eb236d69276.html" target="n" data-glyph="74,1" class="t constructor">RunspaceCreatedEventArgs</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r12 rd" class="r12 r">runspace</span>)
        {
            <a href="#5a5c34cb0339fb34" class="i property">Runspace</a> = <span class="r12 r">runspace</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Properties
 
        <b>internal</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="5a5c34cb0339fb34" href="../../R/5a5c34cb0339fb34.html" target="n" data-glyph="104,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool Availability
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines runspace pool availability.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="a2574df6d6211c0d" href="../../R/a2574df6d6211c0d.html" target="n" data-glyph="18,0" class="t t"><span id="ae2d2d04ad24541b">RunspacePoolAvailability</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePool is not in the Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="080faa50d5a98f5b" href="../../R/080faa50d5a98f5b.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePool is Opened and available to accept commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="80d97f39fbc30ab0" href="../../R/80d97f39fbc30ab0.html" target="n" data-glyph="24,1" class="i field">Available</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePool on the server is connected to another</span>
        <span class="c">///</span><span class="c"> client and is not available to this client for connection</span>
        <span class="c">///</span><span class="c"> or running commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="aea7d508a7416a71" href="../../R/aea7d508a7416a71.html" target="n" data-glyph="24,1" class="i field">Busy</a> = 2
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool Capabilities
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines runspace capabilities.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="ffda42f1dc806629" href="../../R/ffda42f1dc806629.html" target="n" data-glyph="18,0" class="t t"><span id="fc71b03975518174">RunspacePoolCapability</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No additional capabilities beyond a default runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="09eb0969c270accf" href="../../R/09eb0969c270accf.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspacepool and remoting layer supports disconnect/connect feature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="aaf68cbd22defb0d" href="../../R/aaf68cbd22defb0d.html" target="n" data-glyph="24,1" class="i field">SupportsDisconnect</a> = 0x1
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> AsyncResult
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Encapsulated the AsyncResult for pool&#39;s Open/Close async operations.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="bdf2646eeb96a548" href="../../R/bdf2646eeb96a548.html" target="n" data-glyph="2,0" class="t t">RunspacePoolAsyncResult</a> : <a href="AsyncResult.cs.html#f0fde6334f2a46e1" class="t t">AsyncResult</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">ownerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instance Id of the pool creating this instance</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback to call when the async operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A user supplied state to call the &quot;callback&quot; with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">isCalledFromOpenAsync</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if AsyncResult monitors Async Open.</span>
        <span class="c">///</span><span class="c"> false otherwise</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="5858f7ec065f0d15" href="../../R/5858f7ec065f0d15.html" target="n" data-glyph="74,1" class="t constructor">RunspacePoolAsyncResult</a>(<span class="i">Guid</span> <span id="r13 rd" class="r13 r">ownerId</span>, <span class="i">AsyncCallback</span> <span id="r14 rd" class="r14 r">callback</span>, <b>object</b> <span id="r15 rd" class="r15 r">state</span>,
            <b>bool</b> <span id="r16 rd" class="r16 r">isCalledFromOpenAsync</span>)
            : <a href="AsyncResult.cs.html#c77594c9ea75fa31" class="k">base</a>(<span class="r13 r">ownerId</span>, <span class="r14 r">callback</span>, <span class="r15 r">state</span>)
        {
            <a href="#52edc5f43955f90a" class="i property">IsAssociatedWithAsyncOpen</a> = <span class="r16 r">isCalledFromOpenAsync</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if AsyncResult monitors Async Open.</span>
        <span class="c">///</span><span class="c"> false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="52edc5f43955f90a" href="../../R/52edc5f43955f90a.html" target="n" data-glyph="104,1" class="i property">IsAssociatedWithAsyncOpen</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Encapsulated the results of a RunspacePool.BeginGetRunspace method.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="f9f1d68e9fc0927c" href="../../R/f9f1d68e9fc0927c.html" target="n" data-glyph="2,0" class="t t">GetRunspaceAsyncResult</a> : <a href="AsyncResult.cs.html#f0fde6334f2a46e1" class="t t">AsyncResult</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private bool</b> <a id="b0b6d05c553d118a" href="../../R/b0b6d05c553d118a.html" target="n" data-glyph="46,1" class="i field">_isActive</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">ownerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instance Id of the pool creating this instance</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback to call when the async operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A user supplied state to call the &quot;callback&quot; with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="353600984ec20a4b" href="../../R/353600984ec20a4b.html" target="n" data-glyph="74,1" class="t constructor">GetRunspaceAsyncResult</a>(<span class="i">Guid</span> <span id="r17 rd" class="r17 r">ownerId</span>, <span class="i">AsyncCallback</span> <span id="r18 rd" class="r18 r">callback</span>, <b>object</b> <span id="r19 rd" class="r19 r">state</span>)
            : <a href="AsyncResult.cs.html#c77594c9ea75fa31" class="k">base</a>(<span class="r17 r">ownerId</span>, <span class="r18 r">callback</span>, <span class="r19 r">state</span>)
        {
            <a href="#b0b6d05c553d118a" class="i field">_isActive</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods/Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the runspace that is assigned to the async operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This can be null if the async Get operation is not completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="7bcf34c464baed9e" href="../../R/7bcf34c464baed9e.html" target="n" data-glyph="104,1" class="i property">Runspace</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether this operation</span>
        <span class="c">///</span><span class="c"> is active or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="ea99cb2205e6f78b" href="../../R/ea99cb2205e6f78b.html" target="n" data-glyph="104,1" class="i property">IsActive</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="AsyncResult.cs.html#0a8fdbcb807134df" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#b0b6d05c553d118a" class="i field">_isActive</a>;
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="AsyncResult.cs.html#0a8fdbcb807134df" class="i property">SyncObject</a>)
                {
                    <a href="#b0b6d05c553d118a" class="i field">_isActive</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Marks the async operation as completed and releases</span>
        <span class="c">///</span><span class="c"> waiting threads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is not used</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is called from a thread pool thread to release</span>
        <span class="c">///</span><span class="c"> the async operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="50b13122647ab222" href="../../R/50b13122647ab222.html" target="n" data-glyph="74,1" class="i method">DoComplete</a>(<b>object</b> <span id="r20 rd" class="r20 r">state</span>)
        {
            <a href="AsyncResult.cs.html#2d78c0fa1b51bb6e" class="i method">SetAsCompleted</a>(<b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Public interface which supports pooling PowerShell Runspaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="c1948c2f22e6b527" href="../../R/c1948c2f22e6b527.html" target="n" data-glyph="0,0" class="t t">RunspacePool</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private readonly</b> <a href="RunspacePoolInternal.cs.html#f2c8813b33dfca3f" class="t t">RunspacePoolInternal</a> <a id="369bd8e7c4dff9a1" href="../../R/369bd8e7c4dff9a1.html" target="n" data-glyph="46,1" class="i field">_internalPool</a>;
        <b>private readonly object</b> <a id="b5f70126e9b48090" href="../../R/b5f70126e9b48090.html" target="n" data-glyph="46,1" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
 
        <b>private event</b> <span class="i">EventHandler</span>&lt;<a href="#ff0d60fc9c4fde6c" class="t t">RunspacePoolStateChangedEventArgs</a>&gt; <a id="d011932f79ab3411" href="../../R/d011932f79ab3411.html" target="n" data-glyph="34,1" class="i">InternalStateChanged</a> = <b>null</b>;
 
        <b>private event</b> <span class="i">EventHandler</span>&lt;<a href="../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="710fd17d18c6afae" href="../../R/710fd17d18c6afae.html" target="n" data-glyph="34,1" class="i">InternalForwardEvent</a> = <b>null</b>;
 
        <b>private event</b> <span class="i">EventHandler</span>&lt;<a href="#63e95a292a76e722" class="t t">RunspaceCreatedEventArgs</a>&gt; <a id="2cd9e02a8e0c70ab" href="../../R/2cd9e02a8e0c70ab.html" target="n" data-glyph="34,1" class="i">InternalRunspaceCreated</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor which creates a RunspacePool using the</span>
        <span class="c">///</span><span class="c"> supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">configuration</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">minRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The explicit PSHost implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="f263821ceffdba69" href="../../R/f263821ceffdba69.html" target="n" data-glyph="74,1" class="t constructor">RunspacePool</a>(<b>int</b> <span id="r21 rd" class="r21 r">minRunspaces</span>, <b>int</b> <span id="r22 rd" class="r22 r">maxRunspaces</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r23 rd" class="r23 r">host</span>)
        {
            <span class="c">// Currently we support only Local Runspace Pool..</span>
            <span class="c">// this needs to be changed once remote runspace pool</span>
            <span class="c">// is implemented</span>
 
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a> = <b>new</b> <a href="RunspacePoolInternal.cs.html#9a8ea17675409c3f" class="t constructor">RunspacePoolInternal</a>(<span class="r21 r">minRunspaces</span>, <span class="r22 r">maxRunspaces</span>, <span class="r23 r">host</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor which creates a RunspacePool using the</span>
        <span class="c">///</span><span class="c"> supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">initialSessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">minRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState object to use when creating a new Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The explicit PSHost implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> initialSessionState is null.</span>
        <span class="c">///</span><span class="c"> Host is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a6892dc634567919" href="../../R/a6892dc634567919.html" target="n" data-glyph="74,1" class="t constructor">RunspacePool</a>(<b>int</b> <span id="r25 rd" class="r25 r">minRunspaces</span>, <b>int</b> <span id="r26 rd" class="r26 r">maxRunspaces</span>,
            <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r24 rd" class="r24 r">initialSessionState</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r27 rd" class="r27 r">host</span>)
        {
            <span class="c">// Currently we support only Local Runspace Pool..</span>
            <span class="c">// this needs to be changed once remote runspace pool</span>
            <span class="c">// is implemented</span>
 
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a> = <b>new</b> <a href="RunspacePoolInternal.cs.html#7790ba5b4da811ef" class="t constructor">RunspacePoolInternal</a>(<span class="r25 r">minRunspaces</span>,
                <span class="r26 r">maxRunspaces</span>, <span class="r24 r">initialSessionState</span>, <span class="r27 r">host</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a runspace pool object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Min runspaces.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Max runspaces.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">App arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Session name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="3c62d815c5c87586" href="../../R/3c62d815c5c87586.html" target="n" data-glyph="74,1" class="t constructor">RunspacePool</a>(
            <b>int</b> <span id="r28 rd" class="r28 r">minRunspaces</span>,
            <b>int</b> <span id="r29 rd" class="r29 r">maxRunspaces</span>,
            <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r30 rd" class="r30 r">typeTable</span>,
            <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r31 rd" class="r31 r">host</span>,
            <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r32 rd" class="r32 r">applicationArguments</span>,
            <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r33 rd" class="r33 r">connectionInfo</span>,
            <b>string</b> <span id="r34 rd" class="r34 r">name</span> = <b>null</b>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a> = <b>new</b> <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#05ca216b99b11fec" class="t constructor">RemoteRunspacePoolInternal</a>(
                <span class="r28 r">minRunspaces</span>,
                <span class="r29 r">maxRunspaces</span>,
                <span class="r30 r">typeTable</span>,
                <span class="r31 r">host</span>,
                <span class="r32 r">applicationArguments</span>,
                <span class="r33 r">connectionInfo</span>,
                <span class="r34 r">name</span>);
 
            <a href="#6cd4c73a96856bcf" class="i property">IsRemote</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace pool object in a disconnected state that is</span>
        <span class="c">///</span><span class="c"> ready to connect to a remote runspace pool session specified by</span>
        <span class="c">///</span><span class="c"> the instanceId parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">isDisconnected</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates whether the shell/runspace pool is disconnected.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Identifies a remote runspace pool session to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for runspace pool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">connectCommands</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace pool running commands information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection information of remote server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSHost object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeTable used for serialization/deserialization of remote objects.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8bafc0e0064abc11" href="../../R/8bafc0e0064abc11.html" target="n" data-glyph="74,1" class="t constructor">RunspacePool</a>(
            <b>bool</b> <span id="r35 rd" class="r35 r">isDisconnected</span>,
            <span class="i">Guid</span> <span id="r36 rd" class="r36 r">instanceId</span>,
            <b>string</b> <span id="r37 rd" class="r37 r">name</span>,
            <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a>[] <span id="r38 rd" class="r38 r">connectCommands</span>,
            <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r39 rd" class="r39 r">connectionInfo</span>,
            <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r40 rd" class="r40 r">host</span>,
            <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r41 rd" class="r41 r">typeTable</span>)
        {
            <span class="c">// Disconnect-Connect semantics are currently only supported in WSMan transport.</span>
            <b>if</b> (<span class="r39 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
 
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a> = <b>new</b> <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1237b2843c79998f" class="t constructor">RemoteRunspacePoolInternal</a>(<span class="r36 r">instanceId</span>, <span class="r37 r">name</span>, <span class="r35 r">isDisconnected</span>, <span class="r38 r">connectCommands</span>,
                <span class="r39 r">connectionInfo</span>, <span class="r40 r">host</span>, <span class="r41 r">typeTable</span>);
 
            <a href="#6cd4c73a96856bcf" class="i property">IsRemote</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get unique id for this instance of runspace pool. It is primarily used</span>
        <span class="c">///</span><span class="c"> for logging purposes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="d23018748ccb0099" href="../../R/d23018748ccb0099.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#76aedcc22e17e7e5" class="i property">InstanceId</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a boolean which describes if the runspace pool is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="afb84f6f7873e532" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsDisposed</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#7e2a067cc2629817" class="i property">IsDisposed</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets State of the current runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../remoting/common/RunspacePoolStateInfo.cs.html#8b9143609d7a0363" class="t t">RunspacePoolStateInfo</a> <a id="a7f9e215f0cbb1ce" href="../../R/a7f9e215f0cbb1ce.html" target="n" data-glyph="102,1" class="i property">RunspacePoolStateInfo</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#f220504d3677222f" class="i property">RunspacePoolStateInfo</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the InitialSessionState object that this pool uses</span>
        <span class="c">///</span><span class="c"> to create the runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="c9015b9ae57c0705" href="../../R/c9015b9ae57c0705.html" target="n" data-glyph="102,1" class="i property">InitialSessionState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#735288dfc8499543" class="i property">InitialSessionState</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connection information for remote RunspacePools, null for local RunspacePools.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="1be40490ab48aaff" href="../../R/1be40490ab48aaff.html" target="n" data-glyph="102,1" class="i property">ConnectionInfo</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#adecbe65979c4490" class="i property">ConnectionInfo</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies how often unused runspaces are disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="4d6d34ad7c8d4727" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CleanupInterval</a>
        {
            <b>get</b> { <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#fe641c439ba50055" class="i property">CleanupInterval</a>; }
 
            <b>set</b> { <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#fe641c439ba50055" class="i property">CleanupInterval</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns runspace pool availability.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#a2574df6d6211c0d" class="t t">RunspacePoolAvailability</a> <a id="338088353170aaeb" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RunspacePoolAvailability</a>
        {
            <b>get</b> { <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#acd5e3a5040e8caa" class="i property">RunspacePoolAvailability</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when RunspacePoolState changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#ff0d60fc9c4fde6c" class="t t">RunspacePoolStateChangedEventArgs</a>&gt; <a id="e81fb7a9266008ab" href="../../R/e81fb7a9266008ab.html" target="n" data-glyph="30,1" class="i">StateChanged</a>
        {
            <b>add</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <b>bool</b> <span id="r42 rd" class="r42 r">firstEntry</span> = (<a href="#d011932f79ab3411" class="i">InternalStateChanged</a> == <b>null</b>);
                    <a href="#d011932f79ab3411" class="i">InternalStateChanged</a> += <b>value</b>;
                    <b>if</b> (<span class="r42 r">firstEntry</span>)
                    {
                        <span class="c">// call any event handlers on this object, replacing the</span>
                        <span class="c">// internalPool sender with &#39;this&#39; since receivers</span>
                        <span class="c">// are expecting a RunspacePool.</span>
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#f1aec6714a8e699b" class="i">StateChanged</a> += <span class="i">OnStateChanged</span>;
                    }
                }
            }
 
            <b>remove</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <a href="#d011932f79ab3411" class="i">InternalStateChanged</a> -= <b>value</b>;
                    <b>if</b> (<a href="#d011932f79ab3411" class="i">InternalStateChanged</a> == <b>null</b>)
                    {
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#f1aec6714a8e699b" class="i">StateChanged</a> -= <span class="i">OnStateChanged</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle internal Pool state changed events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4ede1f28028004fc" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnStateChanged</a>(<b>object</b> <span id="r43 rd" class="r43 r">source</span>, <a href="#ff0d60fc9c4fde6c" class="t t">RunspacePoolStateChangedEventArgs</a> <span id="r44 rd" class="r44 r">args</span>)
        {
            <b>if</b> (<a href="#1be40490ab48aaff" class="i property">ConnectionInfo</a> <b>is</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a>)
            {
                <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> <span id="r45 rd" class="r45 r">connectionInfo</span> = <a href="#1be40490ab48aaff" class="i property">ConnectionInfo</a> <b>as</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a>;
                <b>if</b> (<span class="r45 r">connectionInfo</span>.<a href="../remoting/common/RunspaceConnectionInfo.cs.html#3700438a1679dca4" class="i property">Process</a> != <b>null</b> &amp;&amp;
                    (<span class="r44 r">args</span>.<a href="#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a>.<a href="../remoting/common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> == <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#13cbf83371c004e0" class="i field">Opened</a> ||
                     <span class="r44 r">args</span>.<a href="#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a>.<a href="../remoting/common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> == <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#48a121178c7c288f" class="i field">Broken</a>))
                {
                    <span class="r45 r">connectionInfo</span>.<a href="../remoting/common/RunspaceConnectionInfo.cs.html#3700438a1679dca4" class="i property">Process</a>.<a href="PowerShellProcessInstance.cs.html#c06727afec38040f" class="i property">RunspacePool</a> = <a href="#c1948c2f22e6b527" class="k">this</a>;
                }
            }
 
            <span class="c">// call any event handlers on this, replacing the</span>
            <span class="c">// internalPool sender with &#39;this&#39; since receivers</span>
            <span class="c">// are expecting a RunspacePool</span>
            <a href="#d011932f79ab3411" class="i">InternalStateChanged</a>.<span class="i">SafeInvoke</span>(<a href="#c1948c2f22e6b527" class="k">this</a>, <span class="r44 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when one of the runspaces in the pool forwards an event to this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="12b18eb6ea299c91" href="../../R/12b18eb6ea299c91.html" target="n" data-glyph="32,1" class="i">ForwardEvent</a>
        {
            <b>add</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <b>bool</b> <span id="r46 rd" class="r46 r">firstEntry</span> = <a href="#710fd17d18c6afae" class="i">InternalForwardEvent</a> == <b>null</b>;
 
                    <a href="#710fd17d18c6afae" class="i">InternalForwardEvent</a> += <b>value</b>;
 
                    <b>if</b> (<span class="r46 r">firstEntry</span>)
                    {
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#1f21f3fbd0dee755" class="i">ForwardEvent</a> += <span class="i">OnInternalPoolForwardEvent</span>;
                    }
                }
            }
 
            <b>remove</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <a href="#710fd17d18c6afae" class="i">InternalForwardEvent</a> -= <b>value</b>;
 
                    <b>if</b> (<a href="#710fd17d18c6afae" class="i">InternalForwardEvent</a> == <b>null</b>)
                    {
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#1f21f3fbd0dee755" class="i">ForwardEvent</a> -= <span class="i">OnInternalPoolForwardEvent</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pass thru of the ForwardEvent event from the internal pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="44aeab686c996be0" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnInternalPoolForwardEvent</a>(<b>object</b> <span id="r47 rd" class="r47 r">sender</span>, <a href="../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r48 rd" class="r48 r">e</span>)
        {
            <a href="#99544839d6b2c0ca" class="i method">OnEventForwarded</a>(<span class="r48 r">e</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the ForwardEvent event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="99544839d6b2c0ca" href="../../R/99544839d6b2c0ca.html" target="n" data-glyph="76,1" class="i method">OnEventForwarded</a>(<a href="../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r49 rd" class="r49 r">e</span>)
        {
            <a href="#710fd17d18c6afae" class="i">InternalForwardEvent</a>?.<span class="i">Invoke</span>(<a href="#c1948c2f22e6b527" class="k">this</a>, <span class="r49 r">e</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when a new Runspace is created by the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="#63e95a292a76e722" class="t t">RunspaceCreatedEventArgs</a>&gt; <a id="fa15860e7d49bbee" href="../../R/fa15860e7d49bbee.html" target="n" data-glyph="32,1" class="i">RunspaceCreated</a>
        {
            <b>add</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <b>bool</b> <span id="r50 rd" class="r50 r">firstEntry</span> = (<a href="#2cd9e02a8e0c70ab" class="i">InternalRunspaceCreated</a> == <b>null</b>);
                    <a href="#2cd9e02a8e0c70ab" class="i">InternalRunspaceCreated</a> += <b>value</b>;
                    <b>if</b> (<span class="r50 r">firstEntry</span>)
                    {
                        <span class="c">// call any event handlers on this object, replacing the</span>
                        <span class="c">// internalPool sender with &#39;this&#39; since receivers</span>
                        <span class="c">// are expecting a RunspacePool.</span>
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#a8982cbf9849c30a" class="i">RunspaceCreated</a> += <span class="i">OnRunspaceCreated</span>;
                    }
                }
            }
 
            <b>remove</b>
            {
                <b>lock</b> (<a href="#b5f70126e9b48090" class="i field">_syncObject</a>)
                {
                    <a href="#2cd9e02a8e0c70ab" class="i">InternalRunspaceCreated</a> -= <b>value</b>;
                    <b>if</b> (<a href="#2cd9e02a8e0c70ab" class="i">InternalRunspaceCreated</a> == <b>null</b>)
                    {
                        <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#a8982cbf9849c30a" class="i">RunspaceCreated</a> -= <span class="i">OnRunspaceCreated</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle internal Pool RunspaceCreated events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2c618b2cd916c497" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnRunspaceCreated</a>(<b>object</b> <span id="r51 rd" class="r51 r">source</span>, <a href="#63e95a292a76e722" class="t t">RunspaceCreatedEventArgs</a> <span id="r52 rd" class="r52 r">args</span>)
        {
            <span class="c">// call any event handlers on this, replacing the</span>
            <span class="c">// internalPool sender with &#39;this&#39; since receivers</span>
            <span class="c">// are expecting a RunspacePool</span>
            <a href="#2cd9e02a8e0c70ab" class="i">InternalRunspaceCreated</a>.<span class="i">SafeInvoke</span>(<a href="#c1948c2f22e6b527" class="k">this</a>, <span class="r52 r">args</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> events
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public static methods.
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspace pools and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> pool objects associated with each disconnected runspace pool on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace pool object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of RunspacePool objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#c1948c2f22e6b527" class="t t">RunspacePool</a>[] <a id="a61ee68e29d17566" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRunspacePools</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r53 rd" class="r53 r">connectionInfo</span>)
        {
            <b>return</b> <a href="#14a3a7cf6e414cad" class="i method">GetRunspacePools</a>(<span class="r53 r">connectionInfo</span>, <b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspace pools and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> pool objects associated with each disconnected runspace pool on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace pool object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of RunspacePool objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#c1948c2f22e6b527" class="t t">RunspacePool</a>[] <a id="ad499b8dcfcf4245" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetRunspacePools</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r54 rd" class="r54 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r55 rd" class="r55 r">host</span>)
        {
            <b>return</b> <a href="#14a3a7cf6e414cad" class="i method">GetRunspacePools</a>(<span class="r54 r">connectionInfo</span>, <span class="r55 r">host</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspace pools and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> pool objects associated with each disconnected runspace pool on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace pool object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeTable object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of RunspacePool objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#c1948c2f22e6b527" class="t t">RunspacePool</a>[] <a id="14a3a7cf6e414cad" href="../../R/14a3a7cf6e414cad.html" target="n" data-glyph="72,1" class="i method">GetRunspacePools</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r56 rd" class="r56 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r57 rd" class="r57 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r58 rd" class="r58 r">typeTable</span>)
        {
            <b>return</b> <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a>.<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#9f0c620f91f8243e" class="i method">GetRemoteRunspacePools</a>(<span class="r56 r">connectionInfo</span>, <span class="r57 r">host</span>, <span class="r58 r">typeTable</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Disconnect-Connect API
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace pool synchronously.  Runspace pool must be in Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="c941ba06f6efbbc1" href="../../R/c941ba06f6efbbc1.html" target="n" data-glyph="72,1" class="i method">Disconnect</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#30fb4a4aedf8c1e2" class="i method">Disconnect</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace pool asynchronously.  Runspace pool must be in Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An AsyncCallback to call once the BeginClose completes.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A user supplied state to call the callback with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IAsyncResult</span> <a id="6d0eed98930ab834" href="../../R/6d0eed98930ab834.html" target="n" data-glyph="72,1" class="i method">BeginDisconnect</a>(<span class="i">AsyncCallback</span> <span id="r59 rd" class="r59 r">callback</span>, <b>object</b> <span id="r60 rd" class="r60 r">state</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#f04c98a53af69486" class="i method">BeginDisconnect</a>(<span class="r59 r">callback</span>, <span class="r60 r">state</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the pending asynchronous BeginDisconnect to complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Asynchronous call result object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="4eb0cc630df047fb" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EndDisconnect</a>(<span class="i">IAsyncResult</span> <span id="r61 rd" class="r61 r">asyncResult</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#e04e9e2454f428dc" class="i method">EndDisconnect</a>(<span class="r61 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace pool synchronously.  Runspace pool must be in disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="cf5c13f99a02f2b1" href="../../R/cf5c13f99a02f2b1.html" target="n" data-glyph="72,1" class="i method">Connect</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#b9ef642f6071d250" class="i method">Connect</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace pool asynchronously.  Runspace pool must be in disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IAsyncResult</span> <a id="ee6829cf26256ff2" href="../../R/ee6829cf26256ff2.html" target="n" data-glyph="72,1" class="i method">BeginConnect</a>(<span class="i">AsyncCallback</span> <span id="r62 rd" class="r62 r">callback</span>, <b>object</b> <span id="r63 rd" class="r63 r">state</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#8b2cac62a57a893d" class="i method">BeginConnect</a>(<span class="r62 r">callback</span>, <span class="r63 r">state</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the pending asynchronous BeginConnect to complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Asynchronous call result object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9b31f905c2dd7512" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EndConnect</a>(<span class="i">IAsyncResult</span> <span id="r64 rd" class="r64 r">asyncResult</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#00a34f42b4e57e9a" class="i method">EndConnect</a>(<span class="r64 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an array of PowerShell objects that are in the Disconnected state for</span>
        <span class="c">///</span><span class="c"> all currently disconnected running commands associated with this runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <a id="cc70bcd264e47279" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateDisconnectedPowerShells</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#db50776271204387" class="i method">CreateDisconnectedPowerShells</a>(<a href="#c1948c2f22e6b527" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns RunspacePool capabilities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspacePoolCapability.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#ffda42f1dc806629" class="t t">RunspacePoolCapability</a> <a id="1b1afe084341b563" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetCapabilities</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#98ac73ae1afb032b" class="i method">GetCapabilities</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public API
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the maximum number of Runspaces that can be active concurrently</span>
        <span class="c">///</span><span class="c"> in the pool. All requests above that number remain queued until</span>
        <span class="c">///</span><span class="c"> runspaces become available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of runspaces in the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the change is successful; otherwise, false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> You cannot set the number of runspaces to a number smaller than</span>
        <span class="c">///</span><span class="c"> the minimum runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="59aa86903613d1b5" href="../../R/59aa86903613d1b5.html" target="n" data-glyph="72,1" class="i method">SetMaxRunspaces</a>(<b>int</b> <span id="r65 rd" class="r65 r">maxRunspaces</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#0a983f97da67824e" class="i method">SetMaxRunspaces</a>(<span class="r65 r">maxRunspaces</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the maximum number of runspaces the pool maintains.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of runspaces in the pool</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="849db6668a9907c9" href="../../R/849db6668a9907c9.html" target="n" data-glyph="72,1" class="i method">GetMaxRunspaces</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#15765c6e67d44ff7" class="i method">GetMaxRunspaces</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the minimum number of Runspaces that the pool maintains</span>
        <span class="c">///</span><span class="c"> in anticipation of new requests.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of runspaces in the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the change is successful; otherwise, false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> You cannot set the number of idle runspaces to a number smaller than</span>
        <span class="c">///</span><span class="c"> 1 or greater than maximum number of active runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="04be81c3d890c8f0" href="../../R/04be81c3d890c8f0.html" target="n" data-glyph="72,1" class="i method">SetMinRunspaces</a>(<b>int</b> <span id="r66 rd" class="r66 r">minRunspaces</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#5ae6fc99b0ac513b" class="i method">SetMinRunspaces</a>(<span class="r66 r">minRunspaces</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the minimum number of runspaces the pool maintains.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of runspaces in the pool</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="567820ee5581ac56" href="../../R/567820ee5581ac56.html" target="n" data-glyph="72,1" class="i method">GetMinRunspaces</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#9495be2d7cb89fd4" class="i method">GetMinRunspaces</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the number of runspaces available at the time of calling</span>
        <span class="c">///</span><span class="c"> this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of available runspace in the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="ba4d8f784e84916d" href="../../R/ba4d8f784e84916d.html" target="n" data-glyph="72,1" class="i method">GetAvailableRunspaces</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#fbb0a49a2955d66e" class="i method">GetAvailableRunspaces</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Opens the runspacepool synchronously. RunspacePool must</span>
        <span class="c">///</span><span class="c"> be opened before it can be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePoolState is not BeforeOpen</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="60da411b81c3454e" href="../../R/60da411b81c3454e.html" target="n" data-glyph="72,1" class="i method">Open</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#019ebd235d9c9768" class="i method">Open</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Opens the RunspacePool asynchronously. RunspacePool must</span>
        <span class="c">///</span><span class="c"> be opened before it can be used.</span>
        <span class="c">///</span><span class="c"> To get the exceptions that might have occurred, call</span>
        <span class="c">///</span><span class="c"> EndOpen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A AsyncCallback to call once the BeginOpen completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A user supplied state to call the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">callback</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An AsyncResult object to monitor the state of the async</span>
        <span class="c">///</span><span class="c"> operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IAsyncResult</span> <a id="ec8a57919fd4239b" href="../../R/ec8a57919fd4239b.html" target="n" data-glyph="72,1" class="i method">BeginOpen</a>(<span class="i">AsyncCallback</span> <span id="r67 rd" class="r67 r">callback</span>, <b>object</b> <span id="r68 rd" class="r68 r">state</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#9d8fd4a2bd24a85c" class="i method">BeginOpen</a>(<span class="r67 r">callback</span>, <span class="r68 r">state</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the pending asynchronous BeginOpen to complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult is a null reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult object was not created by calling BeginOpen</span>
        <span class="c">///</span><span class="c"> on this runspacepool instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePoolState is not BeforeOpen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TODO: Behavior if EndOpen is called multiple times.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3f0b82699f1a6783" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EndOpen</a>(<span class="i">IAsyncResult</span> <span id="r69 rd" class="r69 r">asyncResult</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#526c7cda137675a2" class="i method">EndOpen</a>(<span class="r69 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes the RunspacePool and cleans all the internal</span>
        <span class="c">///</span><span class="c"> resources. This will close all the runspaces in the</span>
        <span class="c">///</span><span class="c"> runspacepool and release all the async operations</span>
        <span class="c">///</span><span class="c"> waiting for a runspace. If the pool is already closed</span>
        <span class="c">///</span><span class="c"> or broken or closing this will just return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot close the RunspacePool because RunspacePool is</span>
        <span class="c">///</span><span class="c"> in Closing state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="1689eedd988353b0" href="../../R/1689eedd988353b0.html" target="n" data-glyph="72,1" class="i method">Close</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#a64850dccc0b72dc" class="i method">Close</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes the RunspacePool asynchronously and cleans all the internal</span>
        <span class="c">///</span><span class="c"> resources. This will close all the runspaces in the</span>
        <span class="c">///</span><span class="c"> runspacepool and release all the async operations</span>
        <span class="c">///</span><span class="c"> waiting for a runspace. If the pool is already closed</span>
        <span class="c">///</span><span class="c"> or broken or closing this will just return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A AsyncCallback to call once the BeginClose completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A user supplied state to call the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">callback</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An AsyncResult object to monitor the state of the async</span>
        <span class="c">///</span><span class="c"> operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IAsyncResult</span> <a id="b435606c04d0d7ab" href="../../R/b435606c04d0d7ab.html" target="n" data-glyph="72,1" class="i method">BeginClose</a>(<span class="i">AsyncCallback</span> <span id="r70 rd" class="r70 r">callback</span>, <b>object</b> <span id="r71 rd" class="r71 r">state</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#49ea97878bcde9c6" class="i method">BeginClose</a>(<span class="r70 r">callback</span>, <span class="r71 r">state</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the pending asynchronous BeginClose to complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult is a null reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult object was not created by calling BeginClose</span>
        <span class="c">///</span><span class="c"> on this runspacepool instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d4e9397647c8d9a0" href="../../R/d4e9397647c8d9a0.html" target="n" data-glyph="72,1" class="i method">EndClose</a>(<span class="i">IAsyncResult</span> <span id="r72 rd" class="r72 r">asyncResult</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#d46d5ac54fd693af" class="i method">EndClose</a>(<span class="r72 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose the current runspacepool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3db8df3e6fc80b2b" href="../../R/3db8df3e6fc80b2b.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#4adfd23f5bdd0610" class="i method">Dispose</a>(<b>true</b>);
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c1948c2f22e6b527" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Private data to be used by applications built on top of PowerShell.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Local runspace pool is created with application private data set to an empty </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Remote runspace pool gets its application private data from the server (when creating the remote runspace pool)</span>
        <span class="c">///</span><span class="c"> Calling this method on a remote runspace pool will block until the data is received from the server.</span>
        <span class="c">///</span><span class="c"> The server will send application private data before reaching </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#13cbf83371c004e0" class="i field">Opened</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> state.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Runspaces that are part of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c1948c2f22e6b527" class="t t">RunspacePool</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> inherit application private data from the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="9e2816b4c51f890c" href="../../R/9e2816b4c51f890c.html" target="n" data-glyph="72,1" class="i method">GetApplicationPrivateData</a>()
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#4915b2d21c0cd306" class="i method">GetApplicationPrivateData</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal API
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property determines whether a new thread is created for each invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any updates to the value of this property must be done before the RunspacePool is opened</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An attempt to change this property was made after opening the RunspacePool</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="4d933f8550b5ef22" href="../../R/4d933f8550b5ef22.html" target="n" data-glyph="102,1" class="i property">ThreadOptions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#3617244356b991d3" class="i property">ThreadOptions</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#c1948c2f22e6b527" class="k">this</a>.<a href="#a7f9e215f0cbb1ce" class="i property">RunspacePoolStateInfo</a>.<a href="../remoting/common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> != <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#66c805b7b59385a4" class="i field">BeforeOpen</a>)
                {
                    <b>throw</b> <b>new</b> <span class="t">InvalidRunspacePoolStateException</span>(<span class="i">RunspacePoolStrings</span>.<span class="i">ChangePropertyAfterOpen</span>);
                }
 
                <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#3617244356b991d3" class="i property">ThreadOptions</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ApartmentState of the thread used to execute commands within this RunspacePool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any updates to the value of this property must be done before the RunspacePool is opened</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An attempt to change this property was made after opening the RunspacePool</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ApartmentState</span> <a id="e96b2efb9719a701" href="../../R/e96b2efb9719a701.html" target="n" data-glyph="102,1" class="i property">ApartmentState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#3f9f0d0f8dd1c807" class="i property">ApartmentState</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#c1948c2f22e6b527" class="k">this</a>.<a href="#a7f9e215f0cbb1ce" class="i property">RunspacePoolStateInfo</a>.<a href="../remoting/common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> != <a href="#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="#66c805b7b59385a4" class="i field">BeforeOpen</a>)
                {
                    <b>throw</b> <b>new</b> <span class="t">InvalidRunspacePoolStateException</span>(<span class="i">RunspacePoolStrings</span>.<span class="i">ChangePropertyAfterOpen</span>);
                }
 
                <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#3f9f0d0f8dd1c807" class="i property">ApartmentState</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets Runspace asynchronously from the runspace pool. The caller</span>
        <span class="c">///</span><span class="c"> will get notified with the runspace using </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">callback</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">callback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A AsyncCallback to call once the runspace is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A user supplied state to call the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">callback</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An IAsyncResult object to track the status of the Async operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IAsyncResult</span> <a id="17b1f7059acbf34f" href="../../R/17b1f7059acbf34f.html" target="n" data-glyph="74,1" class="i method">BeginGetRunspace</a>(
            <span class="i">AsyncCallback</span> <span id="r73 rd" class="r73 r">callback</span>, <b>object</b> <span id="r74 rd" class="r74 r">state</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#e94c3d58c7e5e600" class="i method">BeginGetRunspace</a>(<span class="r73 r">callback</span>, <span class="r74 r">state</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cancels the pending asynchronous BeginGetRunspace operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c229807a7d8dcdbc" href="../../R/c229807a7d8dcdbc.html" target="n" data-glyph="74,1" class="i method">CancelGetRunspace</a>(<span class="i">IAsyncResult</span> <span id="r75 rd" class="r75 r">asyncResult</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#d8b908e34d56c73c" class="i method">CancelGetRunspace</a>(<span class="r75 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the pending asynchronous BeginGetRunspace to complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult is a null reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> asyncResult object was not created by calling BeginGetRunspace</span>
        <span class="c">///</span><span class="c"> on this runspacepool instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspacePoolState is not BeforeOpen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="d4a431395039c1d7" href="../../R/d4a431395039c1d7.html" target="n" data-glyph="74,1" class="i method">EndGetRunspace</a>(<span class="i">IAsyncResult</span> <span id="r76 rd" class="r76 r">asyncResult</span>)
        {
            <b>return</b> <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#49c27bae43d8f47e" class="i method">EndGetRunspace</a>(<span class="r76 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Releases a Runspace to the pool. If pool is closed, this</span>
        <span class="c">///</span><span class="c"> will be a no-op.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace to release to the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">runspace</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot release the runspace to this pool as the runspace</span>
        <span class="c">///</span><span class="c"> doesn&#39;t belong to this pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Only opened runspaces can be released back to the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="eb8b8375fcab8816" href="../../R/eb8b8375fcab8816.html" target="n" data-glyph="74,1" class="i method">ReleaseRunspace</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r77 rd" class="r77 r">runspace</span>)
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#5038a34d88d95f4e" class="i method">ReleaseRunspace</a>(<span class="r77 r">runspace</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether the RunspacePool is a remote one.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6cd4c73a96856bcf" href="../../R/6cd4c73a96856bcf.html" target="n" data-glyph="104,1" class="i property">IsRemote</a> { <b>get</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RemoteRunspacePoolInternal associated with this</span>
        <span class="c">///</span><span class="c"> runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a> <a id="ae1c1c4ae8a5c648" href="../../R/ae1c1c4ae8a5c648.html" target="n" data-glyph="104,1" class="i property">RemoteRunspacePoolInternal</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a> <b>is</b> <a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a>)
                {
                    <b>return</b> (<a href="../remoting/client/RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a>)<a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
        }
 
        <b>internal void</b> <a id="176484eb3e4f94ba" href="../../R/176484eb3e4f94ba.html" target="n" data-glyph="74,1" class="i method">AssertPoolIsOpen</a>()
        {
            <a href="#369bd8e7c4dff9a1" class="i field">_internalPool</a>.<a href="RunspacePoolInternal.cs.html#b6a80051dd5f9b76" class="i method">AssertPoolIsOpen</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
