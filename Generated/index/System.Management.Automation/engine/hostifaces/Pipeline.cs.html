<!DOCTYPE html>
<html><head><title>Pipeline.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(741);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/Pipeline.cs" target="_top">engine\hostifaces\Pipeline.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Exceptions
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines exception which is thrown when state of the pipeline is different</span>
    <span class="c">///</span><span class="c"> from expected state.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="37e03f100f9d822e" href="../../R/37e03f100f9d822e.html" target="n" data-glyph="0,0" class="t t">InvalidPipelineStateException</a> : <span class="i">SystemException</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPipelineStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="632eb6a34574648c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidPipelineStateException</a>()
            : <b>base</b>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">InvalidPipelineStateStateGeneral</span>))
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPipelineStateException class</span>
        <span class="c">///</span><span class="c"> with a specified error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="9199a882b46d7f7b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidPipelineStateException</a>(<b>string</b> <span id="r0 rd" class="r0 r">message</span>)
        : <b>base</b>(<span class="r0 r">message</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPipelineStateException class</span>
        <span class="c">///</span><span class="c"> with a specified error message and a reference to the inner exception that is the cause of this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that is the cause of the current exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="392c0e5418303bc6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidPipelineStateException</a>(<b>string</b> <span id="r1 rd" class="r1 r">message</span>, <span class="i">Exception</span> <span id="r2 rd" class="r2 r">innerException</span>)
        : <b>base</b>(<span class="r1 r">message</span>, <span class="r2 r">innerException</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPipelineStateException and defines value of</span>
        <span class="c">///</span><span class="c"> CurrentState and ExpectedState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">currentState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current state of pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">expectedState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected state of pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="23cc74950974177d" href="../../R/23cc74950974177d.html" target="n" data-glyph="74,1" class="t constructor">InvalidPipelineStateException</a>(<b>string</b> <span id="r3 rd" class="r3 r">message</span>, <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r4 rd" class="r4 r">currentState</span>, <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r5 rd" class="r5 r">expectedState</span>)
        : <b>base</b>(<span class="r3 r">message</span>)
        {
            <a href="#236361fcd237b76c" class="i field">_expectedState</a> = <span class="r5 r">expectedState</span>;
            <a href="#7cd9f74328d42b55" class="i field">_currentState</a> = <span class="r4 r">currentState</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ISerializable Members
 
        <span class="c">// 2005/04/20-JonN No need to implement GetObjectData</span>
        <span class="c">// if all fields are static or [NonSerialized]</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c">  class with serialized data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SerializationInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that holds the serialized object</span>
        <span class="c">///</span><span class="c"> data about the exception being thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">StreamingContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that contains contextual information</span>
        <span class="c">///</span><span class="c"> about the source or destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a id="72d19192eab166d8" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">InvalidPipelineStateException</a>(<span class="i">SerializationInfo</span> <span id="r6 rd" class="r6 r">info</span>, <span class="i">StreamingContext</span> <span id="r7 rd" class="r7 r">context</span>)
        : <b>base</b>(<span class="r6 r">info</span>, <span class="r7 r">context</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets CurrentState of the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <a id="aead7335c1107083" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CurrentState</a>
        {
            <b>get</b> { <b>return</b> <a href="#7cd9f74328d42b55" class="i field">_currentState</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets ExpectedState of the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <a id="9f5cb857e49a1ace" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ExpectedState</a>
        {
            <b>get</b> { <b>return</b> <a href="#236361fcd237b76c" class="i field">_expectedState</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of pipeline when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private readonly</b> <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <a id="7cd9f74328d42b55" href="../../R/7cd9f74328d42b55.html" target="n" data-glyph="46,1" class="i field">_currentState</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> States of the pipeline expected in method which throws this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private readonly</b> <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <a id="236361fcd237b76c" href="../../R/236361fcd237b76c.html" target="n" data-glyph="46,1" class="i field">_expectedState</a> = 0;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exceptions
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PipelineState
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enumerated type defining the state of the Pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="03704abc5975cfc4" href="../../R/03704abc5975cfc4.html" target="n" data-glyph="18,0" class="t t"><span id="4875b159fa8a15c7">PipelineState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has not been started.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="efb1d511bf65892d" href="../../R/efb1d511bf65892d.html" target="n" data-glyph="24,1" class="i field">NotStarted</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline is executing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d0f3cf00cd5762f1" href="../../R/d0f3cf00cd5762f1.html" target="n" data-glyph="24,1" class="i field">Running</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline is stoping execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="17a7706ccaf63f5c" href="../../R/17a7706ccaf63f5c.html" target="n" data-glyph="24,1" class="i field">Stopping</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline is completed due to a stop request.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="76cf7f3120e4f94d" href="../../R/76cf7f3120e4f94d.html" target="n" data-glyph="24,1" class="i field">Stopped</a> = 3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f5734941de01b098" href="../../R/f5734941de01b098.html" target="n" data-glyph="24,1" class="i field">Completed</a> = 4,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline completed abnormally due to an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="425f1d8027f15e68" href="../../R/425f1d8027f15e68.html" target="n" data-glyph="24,1" class="i field">Failed</a> = 5,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline is disconnected from remote running command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="401ea10f45569c67" href="../../R/401ea10f45569c67.html" target="n" data-glyph="24,1" class="i field">Disconnected</a> = 6
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Type which has information about PipelineState and Exception</span>
    <span class="c">///</span><span class="c"> associated with PipelineState.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="62fb09153673bbf3" href="../../R/62fb09153673bbf3.html" target="n" data-glyph="0,0" class="t t">PipelineStateInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes not resulting from an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Execution state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6c6987102e594a17" href="../../R/6c6987102e594a17.html" target="n" data-glyph="74,1" class="t constructor">PipelineStateInfo</a>(<a href="#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r8 rd" class="r8 r">state</span>)
            : <a href="#8a80e8d270916577" class="k">this</a>(<span class="r8 r">state</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes with an optional error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The new state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A non-null exception if the state change was</span>
        <span class="c">///</span><span class="c"> caused by an error,otherwise; null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8a80e8d270916577" href="../../R/8a80e8d270916577.html" target="n" data-glyph="74,1" class="t constructor">PipelineStateInfo</a>(<a href="#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r9 rd" class="r9 r">state</span>, <span class="i">Exception</span> <span id="r10 rd" class="r10 r">reason</span>)
        {
            <a href="#2589f8c7203969a0" class="i property">State</a> = <span class="r9 r">state</span>;
            <a href="#abf480477d10c9b4" class="i property">Reason</a> = <span class="r10 r">reason</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor to support cloning.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">pipelineStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Source information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">throws</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArgumentNullException when </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">pipelineStateInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">throws</span><span class="c">&gt;</span>
        <b>internal</b> <a id="949479ee8aa5578c" href="../../R/949479ee8aa5578c.html" target="n" data-glyph="74,1" class="t constructor">PipelineStateInfo</a>(<a href="#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <span id="r11 rd" class="r11 r">pipelineStateInfo</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r11 r">pipelineStateInfo</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <a href="#2589f8c7203969a0" class="i property">State</a> = <span class="r11 r">pipelineStateInfo</span>.<a href="#2589f8c7203969a0" class="i property">State</a>;
            <a href="#abf480477d10c9b4" class="i property">Reason</a> = <span class="r11 r">pipelineStateInfo</span>.<a href="#abf480477d10c9b4" class="i property">Reason</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The state of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This value indicates the state of the pipeline after the change.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#03704abc5975cfc4" class="t t">PipelineState</a> <a id="2589f8c7203969a0" href="../../R/2589f8c7203969a0.html" target="n" data-glyph="102,1" class="i property">State</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The reason for the state change, if caused by an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of this property is non-null if the state</span>
        <span class="c">///</span><span class="c"> changed due to an error. Otherwise, the value of this</span>
        <span class="c">///</span><span class="c"> property is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="abf480477d10c9b4" href="../../R/abf480477d10c9b4.html" target="n" data-glyph="102,1" class="i property">Reason</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clones this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <a id="7d0ccb2943705d92" href="../../R/7d0ccb2943705d92.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#949479ee8aa5578c" class="t constructor">PipelineStateInfo</a>(<a href="#62fb09153673bbf3" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to PipelineStateEvent handlers</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c607964c20793ea5" class="t t">Pipeline</a>.<a href="#c0baffefeaa75abd" class="i">StateChanged</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="f088a79047187694" href="../../R/f088a79047187694.html" target="n" data-glyph="0,0" class="t t">PipelineStateEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor PipelineStateEventArgs from PipelineStateInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">pipelineStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current state of the</span>
        <span class="c">///</span><span class="c"> pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">throws</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArgumentNullException when </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">pipelineStateInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">throws</span><span class="c">&gt;</span>
        <b>internal</b> <a id="30728553fbee21a5" href="../../R/30728553fbee21a5.html" target="n" data-glyph="74,1" class="t constructor">PipelineStateEventArgs</a>(<a href="#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <span id="r12 rd" class="r12 r">pipelineStateInfo</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r12 r">pipelineStateInfo</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="#90fde3748e993197" class="i property">PipelineStateInfo</a> = <span class="r12 r">pipelineStateInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Info about current state of pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <a id="90fde3748e993197" href="../../R/90fde3748e993197.html" target="n" data-glyph="102,1" class="i property">PipelineStateInfo</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ExecutionState
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a class which can be used to invoke a pipeline of commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="c607964c20793ea5" href="../../R/c607964c20793ea5.html" target="n" data-glyph="0,0" class="t t">Pipeline</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Explicit default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="51363ffeaeaae9e3" href="../../R/51363ffeaeaae9e3.html" target="n" data-glyph="74,1" class="t constructor">Pipeline</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r13 rd" class="r13 r">runspace</span>)
            : <a href="#d4c461de002049eb" class="k">this</a>(<span class="r13 r">runspace</span>, <b>new</b> <a href="Command.cs.html#0901a086d0d4d603" class="t constructor">CommandCollection</a>())
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor to initialize both Runspace and Command to invoke.</span>
        <span class="c">///</span><span class="c"> Caller should make sure that &quot;command&quot; is not null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace to use for the command invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command to Invoke.</span>
        <span class="c">///</span><span class="c"> Caller should make sure that &quot;command&quot; is not null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="d4c461de002049eb" href="../../R/d4c461de002049eb.html" target="n" data-glyph="74,1" class="t constructor">Pipeline</a>(<a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r14 rd" class="r14 r">runspace</span>, <a href="Command.cs.html#8276f51c05ad2fa1" class="t t">CommandCollection</a> <span id="r15 rd" class="r15 r">command</span>)
        {
            <b>if</b> (<span class="r14 r">runspace</span> == <b>null</b>)
            {
                <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r14 r">runspace</span>));
            }
            <span class="c">// This constructor is used only internally.</span>
            <span class="c">// Caller should make sure the input is valid</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r15 r">command</span> != <b>null</b>, <span class="s">&quot;Command cannot be null&quot;</span>);
            <a href="#f221ca76d844add1" class="i property">InstanceId</a> = <span class="r14 r">runspace</span>.<a href="Connection.cs.html#c09b3477caeb9033" class="i method">GeneratePipelineId</a>();
            <a href="#55623b34b6a2a65a" class="i property">Commands</a> = <span class="r15 r">command</span>;
 
            <span class="c">// Reset the AMSI session so that it is re-initialized</span>
            <span class="c">// when the next script block is parsed.</span>
            <a href="../../security/SecuritySupport.cs.html#da6cbabe35a18e75" class="t t">AmsiUtils</a>.<a href="../../security/SecuritySupport.cs.html#82cfb9ada6fe6e60" class="i method">CloseSession</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the runspace this pipeline is created on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="cefa43f64a3ac790" href="../../R/cefa43f64a3ac790.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the property which indicates if this pipeline is nested.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract bool</b> <a id="cabd7078d1f05403" href="../../R/cabd7078d1f05403.html" target="n" data-glyph="102,1" class="i property">IsNested</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the property which indicates if this pipeline is a child pipeline.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> IsChild flag makes it possible for the pipeline to differentiate between</span>
        <span class="c">///</span><span class="c"> a true v1 nested pipeline and the cmdlets calling cmdlets case. See bug</span>
        <span class="c">///</span><span class="c"> 211462.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="b6ebafc40a634046" href="../../R/b6ebafc40a634046.html" target="n" data-glyph="104,1" class="i property">IsChild</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
 
            <b>set</b> { }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets input writer for this pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When the caller calls Input.Write(), the caller writes to the</span>
        <span class="c">///</span><span class="c"> input of the pipeline.  Thus, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Input</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is a PipelineWriter or &quot;thing which can be written to&quot;.</span>
        <span class="c">///</span><span class="c"> Note:Input must be closed after Pipeline.InvokeAsync for InvokeAsync to</span>
        <span class="c">///</span><span class="c"> finish.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <a id="fc605284c85d0dc9" href="../../R/fc605284c85d0dc9.html" target="n" data-glyph="102,1" class="i property">Input</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the output reader for this pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When the caller calls Output.Read(), the caller reads from the</span>
        <span class="c">///</span><span class="c"> output of the pipeline.  Thus, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Output</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is a PipelineReader or &quot;thing which can be read from&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../../utils/IObjectReader.cs.html#6b2221741902f9bd" class="t t">PipelineReader</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="e61d6d76ceba7ad2" href="../../R/e61d6d76ceba7ad2.html" target="n" data-glyph="102,1" class="i property">Output</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the error output reader for this pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When the caller calls Error.Read(), the caller reads from the</span>
        <span class="c">///</span><span class="c"> output of the pipeline.  Thus, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Error</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is a PipelineReader or &quot;thing which can be read from&quot;.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This is the non-terminating error stream from the command.</span>
        <span class="c">///</span><span class="c"> In this release, the objects read from this PipelineReader</span>
        <span class="c">///</span><span class="c"> are PSObjects wrapping ErrorRecords.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../../utils/IObjectReader.cs.html#6b2221741902f9bd" class="t t">PipelineReader</a>&lt;<b>object</b>&gt; <a id="cc6ca02e9720dc4a" href="../../R/cc6ca02e9720dc4a.html" target="n" data-glyph="102,1" class="i property">Error</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets Info about current state of the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This value indicates the state of the pipeline after the change.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <a id="443fd1d03c8335df" href="../../R/443fd1d03c8335df.html" target="n" data-glyph="102,1" class="i property">PipelineStateInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if pipeline execution encountered and error.</span>
        <span class="c">///</span><span class="c"> It will always be true if _reason is non-null</span>
        <span class="c">///</span><span class="c"> since an exception occurred. For other error types,</span>
        <span class="c">///</span><span class="c"> It has to be set manually.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="3a56a8fb6693de23" href="../../R/3a56a8fb6693de23.html" target="n" data-glyph="102,1" class="i property">HadErrors</a>
        {
            <b>get</b> { <b>return</b> <a href="#060c20feb1dd195f" class="i field">_hadErrors</a>; }
        }
 
        <b>private bool</b> <a id="060c20feb1dd195f" href="../../R/060c20feb1dd195f.html" target="n" data-glyph="46,1" class="i field">_hadErrors</a>;
 
        <b>internal void</b> <a id="66aa53c508225fd9" href="../../R/66aa53c508225fd9.html" target="n" data-glyph="74,1" class="i method">SetHadErrors</a>(<b>bool</b> <span id="r16 rd" class="r16 r">status</span>)
        {
            <a href="#060c20feb1dd195f" class="i field">_hadErrors</a> = <a href="#060c20feb1dd195f" class="i field">_hadErrors</a> || <span class="r16 r">status</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the unique identifier for this pipeline. This identifier is unique with in</span>
        <span class="c">///</span><span class="c"> the scope of Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public long</b> <a id="f221ca76d844add1" href="../../R/f221ca76d844add1.html" target="n" data-glyph="102,1" class="i property">InstanceId</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the collection of commands for this pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Command.cs.html#8276f51c05ad2fa1" class="t t">CommandCollection</a> <a id="55623b34b6a2a65a" href="../../R/55623b34b6a2a65a.html" target="n" data-glyph="102,1" class="i property">Commands</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this property is true, SessionState is updated for this</span>
        <span class="c">///</span><span class="c"> pipeline state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="910c9b2fa7c8ddcf" href="../../R/910c9b2fa7c8ddcf.html" target="n" data-glyph="102,1" class="i property">SetPipelineSessionState</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Settings for the pipeline invocation thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="PowerShell.cs.html#ce65c0834aa6f0ea" class="t t">PSInvocationSettings</a> <a id="f37827613834552d" href="../../R/f37827613834552d.html" target="n" data-glyph="104,1" class="i property">InvocationSettings</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this flag is true, the commands in this Pipeline will redirect the global error output pipe</span>
        <span class="c">///</span><span class="c"> (ExecutionContext.ShellFunctionErrorOutputPipe) to the command&#39;s error output pipe.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> When the global error output pipe is not set, $ErrorActionPreference is not checked and all</span>
        <span class="c">///</span><span class="c"> errors are treated as terminating errors.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> On V1, the global error output pipe is redirected to the command&#39;s error output pipe only when</span>
        <span class="c">///</span><span class="c"> it has already been redirected. The command-line host achieves this redirection by merging the</span>
        <span class="c">///</span><span class="c"> error output into the output pipe so it checks $ErrorActionPreference all right. However, when</span>
        <span class="c">///</span><span class="c"> the Pipeline class is used programmatically the global error output pipe is not set and the first</span>
        <span class="c">///</span><span class="c"> error terminates the pipeline.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This flag is used to force the redirection. By default it is false to maintain compatibility with</span>
        <span class="c">///</span><span class="c"> V1, but the V2 hosting interface (PowerShell class) sets this flag to true to ensure the global</span>
        <span class="c">///</span><span class="c"> error output pipe is always set and $ErrorActionPreference when invoking the Pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="b2ec42030f1944f4" href="../../R/b2ec42030f1944f4.html" target="n" data-glyph="104,1" class="i property">RedirectShellErrorOutputPipe</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when Pipeline&#39;s state changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract event</b> <span class="i">EventHandler</span>&lt;<a href="#f088a79047187694" class="t t">PipelineStateEventArgs</a>&gt; <a id="c0baffefeaa75abd" href="../../R/c0baffefeaa75abd.html" target="n" data-glyph="30,1" class="i">StateChanged</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> events
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke the pipeline, synchronously, returning the results as an array of</span>
        <span class="c">///</span><span class="c"> objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If using synchronous invoke, do not close</span>
        <span class="c">///</span><span class="c"> input objectWriter. Synchronous invoke will always close the input</span>
        <span class="c">///</span><span class="c"> objectWriter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No command is added to pipeline</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PipelineState is not NotStarted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) A pipeline is already executing. Pipeline cannot execute</span>
        <span class="c">///</span><span class="c"> concurrently.</span>
        <span class="c">///</span><span class="c"> 2) Attempt is made to invoke a nested pipeline directly. Nested</span>
        <span class="c">///</span><span class="c"> pipeline must be invoked from a running pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Open</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline already disposed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script recursed too deeply into script functions.</span>
        <span class="c">///</span><span class="c"> There is a fixed limit on the depth of recursion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CLR security violation occurred.  Typically, this happens</span>
        <span class="c">///</span><span class="c"> because the current CLR permissions do not allow adequate</span>
        <span class="c">///</span><span class="c"> reflection access to a cmdlet assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline.Invoke can throw a variety of exceptions derived</span>
        <span class="c">///</span><span class="c"> from RuntimeException. The most likely of these exceptions</span>
        <span class="c">///</span><span class="c"> are listed below.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> One of more parameters or parameter values specified for</span>
        <span class="c">///</span><span class="c"> a cmdlet are not valid, or mandatory parameters for a cmdlet</span>
        <span class="c">///</span><span class="c"> were not specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#7b242746a433b370" class="t t">CmdletInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A cmdlet generated a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#f88a59685dc8d13e" class="t t">CmdletProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A provider generated a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline was terminated asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there is an error generating the metadata for dynamic parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="f211da0a5b795e94" href="../../R/f211da0a5b795e94.html" target="n" data-glyph="72,1" class="i method">Invoke</a>()
        {
            <b>return</b> <a href="#37c0ea226e43dccc" class="i method">Invoke</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke the pipeline, synchronously, returning the results as an array of objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">an array of input objects to pass to the pipeline.</span>
        <span class="c">///</span><span class="c"> Array may be empty but may not be null</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array of zero or more result objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If using synchronous exectute, do not close</span>
        <span class="c">///</span><span class="c"> input objectWriter. Synchronous invoke will always close the input</span>
        <span class="c">///</span><span class="c"> objectWriter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No command is added to pipeline</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PipelineState is not NotStarted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) A pipeline is already executing. Pipeline cannot execute</span>
        <span class="c">///</span><span class="c"> concurrently.</span>
        <span class="c">///</span><span class="c"> 2) Attempt is made to invoke a nested pipeline directly. Nested</span>
        <span class="c">///</span><span class="c"> pipeline must be invoked from a running pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Open</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline already disposed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script recursed too deeply into script functions.</span>
        <span class="c">///</span><span class="c"> There is a fixed limit on the depth of recursion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CLR security violation occurred.  Typically, this happens</span>
        <span class="c">///</span><span class="c"> because the current CLR permissions do not allow adequate</span>
        <span class="c">///</span><span class="c"> reflection access to a cmdlet assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline.Invoke can throw a variety of exceptions derived</span>
        <span class="c">///</span><span class="c"> from RuntimeException. The most likely of these exceptions</span>
        <span class="c">///</span><span class="c"> are listed below.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> One of more parameters or parameter values specified for</span>
        <span class="c">///</span><span class="c"> a cmdlet are not valid, or mandatory parameters for a cmdlet</span>
        <span class="c">///</span><span class="c"> were not specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#7b242746a433b370" class="t t">CmdletInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A cmdlet generated a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#f88a59685dc8d13e" class="t t">CmdletProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A provider generated a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline was terminated asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there is an error generating the metadata for dynamic parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="37c0ea226e43dccc" href="../../R/37c0ea226e43dccc.html" target="n" data-glyph="72,1" class="i method">Invoke</a>(<span class="i">IEnumerable</span> <span id="r17 rd" class="r17 r">input</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke the pipeline asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) Results are returned through the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c607964c20793ea5" class="t t">Pipeline</a>.<a href="#e61d6d76ceba7ad2" class="i property">Output</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> reader.</span>
        <span class="c">///</span><span class="c"> 2) When pipeline is invoked using InvokeAsync, invocation doesn&#39;t</span>
        <span class="c">///</span><span class="c"> finish until Input to pipeline is closed. Caller of InvokeAsync must close</span>
        <span class="c">///</span><span class="c"> the input pipe after all input has been written to input pipe. Input pipe</span>
        <span class="c">///</span><span class="c"> is closed by calling Pipeline.Input.Close();</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If you want this pipeline to execute as a standalone command</span>
        <span class="c">///</span><span class="c"> (that is, using command-line parameters only),</span>
        <span class="c">///</span><span class="c"> be sure to call Pipeline.Input.Close() before calling</span>
        <span class="c">///</span><span class="c"> InvokeAsync().  Otherwise, the command will be executed</span>
        <span class="c">///</span><span class="c"> as though it had external input.  If you observe that the</span>
        <span class="c">///</span><span class="c"> command isn&#39;t doing anything, this may be the reason.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No command is added to pipeline</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PipelineState is not NotStarted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) A pipeline is already executing. Pipeline cannot execute</span>
        <span class="c">///</span><span class="c"> concurrently.</span>
        <span class="c">///</span><span class="c"> 2) InvokeAsync is called on nested pipeline. Nested pipeline</span>
        <span class="c">///</span><span class="c"> cannot be executed Asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Open</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline already disposed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="fc9df3c8ea46c0e9" href="../../R/fc9df3c8ea46c0e9.html" target="n" data-glyph="72,1" class="i method">InvokeAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Synchronous call to stop the running pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="f53d09a89971ab39" href="../../R/f53d09a89971ab39.html" target="n" data-glyph="72,1" class="i method">Stop</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Asynchronous call to stop the running pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="112721a0ffd69637" href="../../R/112721a0ffd69637.html" target="n" data-glyph="72,1" class="i method">StopAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c607964c20793ea5" class="t t">Pipeline</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that is a copy of the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c607964c20793ea5" class="t t">Pipeline</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that is a copy of this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#c607964c20793ea5" class="t t">Pipeline</a> <a id="7ec4174e74d1a667" href="../../R/7ec4174e74d1a667.html" target="n" data-glyph="72,1" class="i method">Copy</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects synchronously to a running command on a remote server.</span>
        <span class="c">///</span><span class="c"> The pipeline object must be in the disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A collection of result objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="40961845e80d5e44" href="../../R/40961845e80d5e44.html" target="n" data-glyph="72,1" class="i method">Connect</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects asynchronously to a running command on a remote server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="de906f7748039793" href="../../R/de906f7748039793.html" target="n" data-glyph="72,1" class="i method">ConnectAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the command collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">commands</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command collection to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">called by ClientRemotePipeline</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2efce02cbe3b2d6b" href="../../R/2efce02cbe3b2d6b.html" target="n" data-glyph="74,1" class="i method">SetCommandCollection</a>(<a href="Command.cs.html#8276f51c05ad2fa1" class="t t">CommandCollection</a> <span id="r18 rd" class="r18 r">commands</span>)
        {
            <a href="#55623b34b6a2a65a" class="i property">Commands</a> = <span class="r18 r">commands</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the history string to the one that is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">historyString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">History string to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal abstract void</b> <a id="7faebf4bd8def611" href="../../R/7faebf4bd8def611.html" target="n" data-glyph="74,1" class="i method">SetHistoryString</a>(<b>string</b> <span id="r19 rd" class="r19 r">historyString</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invokes a remote command and immediately disconnects if</span>
        <span class="c">///</span><span class="c"> transport layer supports it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract void</b> <a id="92c10b6e74b3869c" href="../../R/92c10b6e74b3869c.html" target="n" data-glyph="74,1" class="i method">InvokeAsyncAndDisconnect</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remote data drain/block methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Blocks data arriving from remote session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="edfe3fa78612efce" href="../../R/edfe3fa78612efce.html" target="n" data-glyph="74,1" class="i method">SuspendIncomingData</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resumes data arrive from remote session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="eba54449dfca431c" href="../../R/eba54449dfca431c.html" target="n" data-glyph="74,1" class="i method">ResumeIncomingData</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Blocking call that waits until the current remote data</span>
        <span class="c">///</span><span class="c"> queue is empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="f60de8c84957b18a" href="../../R/f60de8c84957b18a.html" target="n" data-glyph="74,1" class="i method">DrainIncomingData</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disposes the pipeline. If pipeline is running, dispose first</span>
        <span class="c">///</span><span class="c"> stops the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="78d9f1f80ba7c462" href="../../R/78d9f1f80ba7c462.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="i">Dispose</span>(!<a href="#b6ebafc40a634046" class="i property">IsChild</a>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c607964c20793ea5" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Protected dispose which can be overridden by derived classes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual
        void</b>
        <a id="a3ed04f9600b5bd2" href="../../R/a3ed04f9600b5bd2.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r20 rd" class="r20 r">disposing</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
}
</pre></td></tr></table></div></body></html>
