<!DOCTYPE html>
<html><head><title>PSCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(545);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/PSCommand.cs" target="_top">engine\hostifaces\PSCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a PowerShell command / script object which can be used with</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="b9f024f73904cf55" href="../../R/b9f024f73904cf55.html" target="n" data-glyph="0,0" class="t t">PSCommand</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Fields
 
        <b>private</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="f35611e27419b773" href="../../R/f35611e27419b773.html" target="n" data-glyph="46,1" class="i field">_owner</a>;
        <b>private</b> <a href="Command.cs.html#8276f51c05ad2fa1" class="t t">CommandCollection</a> <a id="9d2cfcd7906c15b6" href="../../R/9d2cfcd7906c15b6.html" target="n" data-glyph="46,1" class="i field">_commands</a>;
        <b>private</b> <a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <a id="0b3c5c7f57253e2d" href="../../R/0b3c5c7f57253e2d.html" target="n" data-glyph="46,1" class="i field">_currentCommand</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an empty PSCommand; a command or script must be added to this PSCommand before it can be executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="45c724f1a0c9f07a" href="../../R/45c724f1a0c9f07a.html" target="n" data-glyph="72,1" class="t constructor">PSCommand</a>()
        {
            <a href="#75880f0a234b78ed" class="i method">Initialize</a>(<b>null</b>, <b>false</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal copy constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandToClone</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="0a3bdaec647d4523" href="../../R/0a3bdaec647d4523.html" target="n" data-glyph="74,1" class="t constructor">PSCommand</a>(<a href="#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r0 rd" class="r0 r">commandToClone</span>)
        {
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a> = <b>new</b> <a href="Command.cs.html#0901a086d0d4d603" class="t constructor">CommandCollection</a>();
            <b>foreach</b> (<a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r1 rd" class="r1 r">command</span> <b>in</b> <span class="r0 r">commandToClone</span>.<a href="#cc9b22e4391a9870" class="i property">Commands</a>)
            {
                <a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r2 rd" class="r2 r">clone</span> = <span class="r1 r">command</span>.<a href="Command.cs.html#66d065d201023e25" class="i method">Clone</a>();
                <span class="c">// Attach the cloned Command to this instance.</span>
                <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<span class="r2 r">clone</span>);
                <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <span class="r2 r">clone</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PSCommand from the specified command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command object to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="630b26942ccab3f2" href="../../R/630b26942ccab3f2.html" target="n" data-glyph="74,1" class="t constructor">PSCommand</a>(<a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r3 rd" class="r3 r">command</span>)
        {
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <span class="r3 r">command</span>;
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a> = <b>new</b> <a href="Command.cs.html#0901a086d0d4d603" class="t constructor">CommandCollection</a>();
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command / Parameter Construction
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a command to construct a command pipeline.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | sort-object&quot;,</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;).AddCommand(&quot;sort-object&quot;);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> cmdlet is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="2a2b7de6778550bd" href="../../R/2a2b7de6778550bd.html" target="n" data-glyph="72,1" class="i method">AddCommand</a>(<b>string</b> <span id="r4 rd" class="r4 r">command</span>)
        {
            <b>if</b> (<span class="r4 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r4 r">command</span>));
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>new</b> <a href="Command.cs.html#12fe527c78833611" class="t constructor">Command</a>(<span class="r4 r">command</span>, <b>false</b>);
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
 
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a cmdlet to construct a command pipeline.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | sort-object&quot;,</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;).AddCommand(&quot;sort-object&quot;);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">useLocalScope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true local scope is used to run the script command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">cmdlet</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> cmdlet is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="26d5b672ae01a0b6" href="../../R/26d5b672ae01a0b6.html" target="n" data-glyph="72,1" class="i method">AddCommand</a>(<b>string</b> <span id="r5 rd" class="r5 r">cmdlet</span>, <b>bool</b> <span id="r6 rd" class="r6 r">useLocalScope</span>)
        {
            <b>if</b> (<span class="r5 r">cmdlet</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r5 r">cmdlet</span>));
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>new</b> <a href="Command.cs.html#7daa1db0ede574c4" class="t constructor">Command</a>(<span class="r5 r">cmdlet</span>, <b>false</b>, <span class="r6 r">useLocalScope</span>);
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
 
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a piece of script to construct a command pipeline.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | foreach { $_.Name }&quot;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;)</span>
        <span class="c">///</span><span class="c">             .AddScript(&quot;foreach { $_.Name }&quot;, true);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">script</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">script</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread-safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="432fcb03d95e8672" href="../../R/432fcb03d95e8672.html" target="n" data-glyph="72,1" class="i method">AddScript</a>(<b>string</b> <span id="r7 rd" class="r7 r">script</span>)
        {
            <b>if</b> (<span class="r7 r">script</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r7 r">script</span>));
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>new</b> <a href="Command.cs.html#12fe527c78833611" class="t constructor">Command</a>(<span class="r7 r">script</span>, <b>true</b>);
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
 
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a piece of script to construct a command pipeline.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | foreach { $_.Name }&quot;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;)</span>
        <span class="c">///</span><span class="c">             .AddScript(&quot;foreach { $_.Name }&quot;, true);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">script</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">useLocalScope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true local scope is used to run the script command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">script</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread-safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="9e182be21567358b" href="../../R/9e182be21567358b.html" target="n" data-glyph="72,1" class="i method">AddScript</a>(<b>string</b> <span id="r8 rd" class="r8 r">script</span>, <b>bool</b> <span id="r9 rd" class="r9 r">useLocalScope</span>)
        {
            <b>if</b> (<span class="r8 r">script</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r8 r">script</span>));
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>new</b> <a href="Command.cs.html#7daa1db0ede574c4" class="t constructor">Command</a>(<span class="r8 r">script</span>, <b>true</b>, <span class="r9 r">useLocalScope</span>);
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
 
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> element to the current command</span>
        <span class="c">///</span><span class="c"> pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread-safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="7918d4773753829d" href="../../R/7918d4773753829d.html" target="n" data-glyph="72,1" class="i method">AddCommand</a>(<a href="Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r10 rd" class="r10 r">command</span>)
        {
            <b>if</b> (<span class="r10 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r10 r">command</span>));
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <span class="r10 r">command</span>;
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
 
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a parameter to the last added command.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | select-object -property name&quot;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;)</span>
        <span class="c">///</span><span class="c">             .AddCommand(&quot;select-object&quot;)</span>
        <span class="c">///</span><span class="c">             .AddParameter(&quot;property&quot;, &quot;name&quot;);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Value for the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added</span>
        <span class="c">///</span><span class="c"> to the parameter list of the last command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name is non null and name length is zero after trimming whitespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="247ce643c3f840c8" href="../../R/247ce643c3f840c8.html" target="n" data-glyph="72,1" class="i method">AddParameter</a>(<b>string</b> <span id="r11 rd" class="r11 r">parameterName</span>, <b>object</b> <span id="r12 rd" class="r12 r">value</span>)
        {
            <b>if</b> (<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSCommandStrings</span>.<span class="i">ParameterRequiresCommand</span>,
                                                                 <b>new</b> <b>object</b>[] { <span class="s">&quot;PSCommand&quot;</span> });
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>.<a href="Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="r11 r">parameterName</span>, <span class="r12 r">value</span>);
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a switch parameter to the last added command.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | sort-object -descending&quot;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;)</span>
        <span class="c">///</span><span class="c">             .AddCommand(&quot;sort-object&quot;)</span>
        <span class="c">///</span><span class="c">             .AddParameter(&quot;descending&quot;);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added</span>
        <span class="c">///</span><span class="c"> to the parameter list of the last command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name is non null and name length is zero after trimming whitespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="710a1cf55c2033f3" href="../../R/710a1cf55c2033f3.html" target="n" data-glyph="72,1" class="i method">AddParameter</a>(<b>string</b> <span id="r13 rd" class="r13 r">parameterName</span>)
        {
            <b>if</b> (<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSCommandStrings</span>.<span class="i">ParameterRequiresCommand</span>,
                                                                 <b>new</b> <b>object</b>[] { <span class="s">&quot;PSCommand&quot;</span> });
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>.<a href="Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="r13 r">parameterName</span>, <b>true</b>);
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance to the last added command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="36a9df84fd6002ec" href="../../R/36a9df84fd6002ec.html" target="n" data-glyph="74,1" class="i method">AddParameter</a>(<a href="Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a> <span id="r14 rd" class="r14 r">parameter</span>)
        {
            <b>if</b> (<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSCommandStrings</span>.<span class="i">ParameterRequiresCommand</span>,
                                                                 <b>new</b> <b>object</b>[] { <span class="s">&quot;PSCommand&quot;</span> });
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>.<a href="Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<span class="i">Add</span>(<span class="r14 r">parameter</span>);
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an argument to the last added command.</span>
        <span class="c">///</span><span class="c"> For example, to construct a command string &quot;get-process | select-object name&quot;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         PSCommand command = new PSCommand(&quot;get-process&quot;)</span>
        <span class="c">///</span><span class="c">             .AddCommand(&quot;select-object&quot;)</span>
        <span class="c">///</span><span class="c">             .AddArgument(&quot;name&quot;);</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This will add the value &quot;name&quot; to the positional parameter list of &quot;select-object&quot;</span>
        <span class="c">///</span><span class="c"> cmdlet. When the command is invoked, this value will get bound to positional parameter 0</span>
        <span class="c">///</span><span class="c"> of the &quot;select-object&quot; cmdlet which is &quot;Property&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Value for the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSCommand instance parameter value </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">value</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added</span>
        <span class="c">///</span><span class="c"> to the parameter list of the last command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PowerShell.cs.html#2864fc2d24c87a5a" class="t t">InvalidPowerShellStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="3e40ef7faf8a84f1" href="../../R/3e40ef7faf8a84f1.html" target="n" data-glyph="72,1" class="i method">AddArgument</a>(<b>object</b> <span id="r15 rd" class="r15 r">value</span>)
        {
            <b>if</b> (<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSCommandStrings</span>.<span class="i">ParameterRequiresCommand</span>,
                                                                 <b>new</b> <b>object</b>[] { <span class="s">&quot;PSCommand&quot;</span> });
            }
 
            <b>if</b> (<a href="#f35611e27419b773" class="i field">_owner</a> != <b>null</b>)
            {
                <a href="#f35611e27419b773" class="i field">_owner</a>.<a href="PowerShell.cs.html#68c9b1a93a2cdcde" class="i method">AssertChangesAreAccepted</a>();
            }
 
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>.<a href="Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<b>null</b>, <span class="r15 r">value</span>);
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an additional statement for execution</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example,</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         Runspace rs = RunspaceFactory.CreateRunspace();</span>
        <span class="c">///</span><span class="c">         PowerShell ps = PowerShell.Create();</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">         ps.Runspace = rs;</span>
        <span class="c">///</span><span class="c">         ps.AddCommand(&quot;Get-Process&quot;).AddArgument(&quot;idle&quot;);</span>
        <span class="c">///</span><span class="c">         ps.AddStatement().AddCommand(&quot;Get-Service&quot;).AddArgument(&quot;audiosrv&quot;);</span>
        <span class="c">///</span><span class="c">         ps.Invoke();</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PowerShell instance with the items in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">parameters</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> added</span>
        <span class="c">///</span><span class="c"> to the parameter list of the last command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="1543f229ec70367a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AddStatement</a>()
        {
            <b>if</b> (<a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
            }
 
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>[<a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Count</span> - 1].<span class="i">IsEndOfStatement</span> = <b>true</b>;
            <b>return</b> <a href="#b9f024f73904cf55" class="k">this</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties and Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the collection of commands from this PSCommand</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Command.cs.html#8276f51c05ad2fa1" class="t t">CommandCollection</a> <a id="cc9b22e4391a9870" href="../../R/cc9b22e4391a9870.html" target="n" data-glyph="102,1" class="i property">Commands</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PowerShell instance this PSCommand is associated to, or null if it is an standalone command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="c72d40210220cf60" href="../../R/c72d40210220cf60.html" target="n" data-glyph="104,1" class="i property">Owner</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f35611e27419b773" class="i field">_owner</a>;
            }
 
            <b>set</b>
            {
                <a href="#f35611e27419b773" class="i field">_owner</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the command(s).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="15970659c9fe6157" href="../../R/15970659c9fe6157.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Clear</span>();
            <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a shallow copy of the current PSCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A shallow copy of the current PSCommand</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b9f024f73904cf55" class="t t">PSCommand</a> <a id="644d43eece6a0031" href="../../R/644d43eece6a0031.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#0a3bdaec647d4523" class="t constructor">PSCommand</a>(<a href="#b9f024f73904cf55" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes the instance. Called from the constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command to initialize the instance with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">isScript</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is script,</span>
        <span class="c">///</span><span class="c"> false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">useLocalScope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true local scope is used to run the script command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller should check the input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="75880f0a234b78ed" href="../../R/75880f0a234b78ed.html" target="n" data-glyph="76,1" class="i method">Initialize</a>(<b>string</b> <span id="r16 rd" class="r16 r">command</span>, <b>bool</b> <span id="r17 rd" class="r17 r">isScript</span>, <b>bool</b>? <span id="r18 rd" class="r18 r">useLocalScope</span>)
        {
            <a href="#9d2cfcd7906c15b6" class="i field">_commands</a> = <b>new</b> <a href="Command.cs.html#0901a086d0d4d603" class="t constructor">CommandCollection</a>();
 
            <b>if</b> (<span class="r16 r">command</span> != <b>null</b>)
            {
                <a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a> = <b>new</b> <a href="Command.cs.html#86ebfe098c61baf8" class="t constructor">Command</a>(<span class="r16 r">command</span>, <span class="r17 r">isScript</span>, <span class="r18 r">useLocalScope</span>);
                <a href="#9d2cfcd7906c15b6" class="i field">_commands</a>.<span class="i">Add</span>(<a href="#0b3c5c7f57253e2d" class="i field">_currentCommand</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
