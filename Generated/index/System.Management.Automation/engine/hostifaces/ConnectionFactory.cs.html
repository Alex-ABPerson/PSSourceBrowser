<!DOCTYPE html>
<html><head><title>ConnectionFactory.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(609);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/ConnectionFactory.cs" target="_top">engine\hostifaces\ConnectionFactory.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a factory class for creating Runspace objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="c5fbe142e4e21218" href="../../R/c5fbe142e4e21218.html" target="n" data-glyph="0,0" class="t t">RunspaceFactory</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Static constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="082608fa005b1ab6" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">RunspaceFactory</a>()
        {
            <span class="c">// Set ETW activity Id</span>
            <span class="i">Guid</span> <span id="r0 rd" class="r0 r">activityId</span> = <a href="../../utils/tracing/EtwActivity.cs.html#f0b7f321c8221b4f" class="t t">EtwActivity</a>.<a href="../../utils/tracing/EtwActivity.cs.html#1a5096f4a11c2b4b" class="i method">GetActivityId</a>();
 
            <b>if</b> (<span class="r0 r">activityId</span> == <span class="i">Guid</span>.<span class="i">Empty</span>)
            {
                <a href="../../utils/tracing/EtwActivity.cs.html#f0b7f321c8221b4f" class="t t">EtwActivity</a>.<a href="../../utils/tracing/EtwActivity.cs.html#751586094734168b" class="i method">SetActivityId</a>(<a href="../../utils/tracing/EtwActivity.cs.html#f0b7f321c8221b4f" class="t t">EtwActivity</a>.<a href="../../utils/tracing/EtwActivity.cs.html#26cb8756fc40daee" class="i method">CreateActivityId</a>());
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Factory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace using host of type </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="DefaultHost.cs.html#2b6f9e408123458a" class="t t">DefaultHost</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="d1898b5d69d8413b" href="../../R/d1898b5d69d8413b.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>()
        {
            <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r1 rd" class="r1 r">host</span> = <b>new</b> <span class="t">DefaultHost</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
 
            <b>return</b> <a href="#68ee9f57341809d0" class="i method">CreateRunspace</a>(<span class="r1 r">host</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace using specified host. This runspace is created using the</span>
        <span class="c">///</span><span class="c"> configuration information from EntryAssembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The explicit PSHost implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when host is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="68ee9f57341809d0" href="../../R/68ee9f57341809d0.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r2 rd" class="r2 r">host</span>)
        {
            <b>if</b> (<span class="r2 r">host</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">host</span>));
            }
 
            <b>return</b> <b>new</b> <a href="LocalConnection.cs.html#da6cdc117989a1a9" class="t constructor">LocalRunspace</a>(<span class="r2 r">host</span>, <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#212e45c73accc163" class="i method">CreateDefault</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace using </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="DefaultHost.cs.html#2b6f9e408123458a" class="t t">DefaultHost</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState information for the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when initialSessionState is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="19132aa2ac867b76" href="../../R/19132aa2ac867b76.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r3 rd" class="r3 r">initialSessionState</span>)
        {
            <b>if</b> (<span class="r3 r">initialSessionState</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">initialSessionState</span>));
            }
 
            <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r4 rd" class="r4 r">host</span> = <b>new</b> <span class="t">DefaultHost</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
 
            <b>return</b> <a href="#5099763308995719" class="i method">CreateRunspace</a>(<span class="r4 r">host</span>, <span class="r3 r">initialSessionState</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace using specified PSHost and InitialSessionState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host implementation for runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState information for the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when host is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when initialSessionState is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="5099763308995719" href="../../R/5099763308995719.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r5 rd" class="r5 r">host</span>, <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r6 rd" class="r6 r">initialSessionState</span>)
        {
            <b>if</b> (<span class="r5 r">host</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r5 r">host</span>));
            }
 
            <b>if</b> (<span class="r6 r">initialSessionState</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r6 r">initialSessionState</span>));
            }
 
            <b>return</b> <b>new</b> <a href="LocalConnection.cs.html#da6cdc117989a1a9" class="t constructor">LocalRunspace</a>(<span class="r5 r">host</span>, <span class="r6 r">initialSessionState</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a runspace using specified PSHost and InitialSessionState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host implementation for runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState information for the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A runspace object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when host is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when initialSessionState is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>internal static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="3b7a274e8fe5d27d" href="../../R/3b7a274e8fe5d27d.html" target="n" data-glyph="74,1" class="i method">CreateRunspaceFromSessionStateNoClone</a>(<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r7 rd" class="r7 r">host</span>, <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r8 rd" class="r8 r">initialSessionState</span>)
        {
            <b>if</b> (<span class="r7 r">host</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r7 r">host</span>));
            }
 
            <b>if</b> (<span class="r8 r">initialSessionState</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r8 r">initialSessionState</span>));
            }
 
            <b>return</b> <b>new</b> <a href="LocalConnection.cs.html#08737a326e227632" class="t constructor">LocalRunspace</a>(<span class="r7 r">host</span>, <span class="r8 r">initialSessionState</span>, <b>true</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool Factory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool with MaxRunspaces 1 and MinRunspaces 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="a84e8dbc1ac71263" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>()
        {
            <b>return</b> <a href="#5ad8fdc0f9978263" class="i method">CreateRunspacePool</a>(1, 1);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> limits the number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. The minimum pool size is set to </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">minPoolSoze</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspaces that exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="5ad8fdc0f9978263" href="../../R/5ad8fdc0f9978263.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r10 rd" class="r10 r">minRunspaces</span>, <b>int</b> <span id="r9 rd" class="r9 r">maxRunspaces</span>)
        {
            <b>return</b> <a href="#ee5673d4b5391465" class="i method">CreateRunspacePool</a>(<span class="r10 r">minRunspaces</span>, <span class="r9 r">maxRunspaces</span>,
                <b>new</b> <span class="t">DefaultHost</span>
                (
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>
                ));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool using the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">initialSessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The minimum runspaces size is set to 1. The maximum runspaces size is</span>
        <span class="c">///</span><span class="c"> set to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> initialSessionState to use when creating a new</span>
        <span class="c">///</span><span class="c"> Runspace in the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="53c32d02396e9d80" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r11 rd" class="r11 r">initialSessionState</span>)
        {
            <b>return</b> <a href="#2cf4e303c72a33f9" class="i method">CreateRunspacePool</a>(1, 1, <span class="r11 r">initialSessionState</span>,
                <b>new</b> <span class="t">DefaultHost</span>
                (
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>
                ));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool using the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">host</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">minRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The explicit PSHost implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">host</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A local runspacepool instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="ee5673d4b5391465" href="../../R/ee5673d4b5391465.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r13 rd" class="r13 r">minRunspaces</span>, <b>int</b> <span id="r14 rd" class="r14 r">maxRunspaces</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r12 rd" class="r12 r">host</span>)
        {
            <b>return</b> <b>new</b> <a href="RunspacePool.cs.html#f263821ceffdba69" class="t constructor">RunspacePool</a>(<span class="r13 r">minRunspaces</span>, <span class="r14 r">maxRunspaces</span>, <span class="r12 r">host</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool using the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">initialSessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">minRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this pool.</span>
        <span class="c">///</span><span class="c"> Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> initialSessionState to use when creating a new Runspace in the</span>
        <span class="c">///</span><span class="c"> pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The explicit PSHost implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">initialSessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">host</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum runspaces is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="2cf4e303c72a33f9" href="../../R/2cf4e303c72a33f9.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r16 rd" class="r16 r">minRunspaces</span>, <b>int</b> <span id="r17 rd" class="r17 r">maxRunspaces</span>,
            <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r15 rd" class="r15 r">initialSessionState</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r18 rd" class="r18 r">host</span>)
        {
            <b>return</b> <b>new</b> <a href="RunspacePool.cs.html#a6892dc634567919" class="t constructor">RunspacePool</a>(<span class="r16 r">minRunspaces</span>,
                <span class="r17 r">maxRunspaces</span>, <span class="r15 r">initialSessionState</span>, <span class="r18 r">host</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool - remote Factory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool</span>
        <span class="c">///</span><span class="c"> on the specified remote computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> limits the number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. The minimum pool size is set to</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">minPoolSoze</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspace that should exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceConnectionInfo object describing</span>
        <span class="c">///</span><span class="c"> the remote computer on which this runspace pool needs to be</span>
        <span class="c">///</span><span class="c"> created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> connectionInfo is null</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="2f9167468413a5d3" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r20 rd" class="r20 r">minRunspaces</span>,
                                        <b>int</b> <span id="r19 rd" class="r19 r">maxRunspaces</span>, <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r21 rd" class="r21 r">connectionInfo</span>)
        {
            <b>return</b> <a href="#c41e72a7b256d0be" class="i method">CreateRunspacePool</a>(<span class="r20 r">minRunspaces</span>, <span class="r19 r">maxRunspaces</span>, <span class="r21 r">connectionInfo</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool</span>
        <span class="c">///</span><span class="c"> on the specified remote runspace computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> limits the number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. The minimum pool size is set to</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">minPoolSoze</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspace that should exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host associated with this</span>
        <span class="c">///</span><span class="c"> runspace pool</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceConnectionInfo object describing</span>
        <span class="c">///</span><span class="c"> the remote computer on which this runspace pool needs to be</span>
        <span class="c">///</span><span class="c"> created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> connectionInfo is null</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="c41e72a7b256d0be" href="../../R/c41e72a7b256d0be.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r23 rd" class="r23 r">minRunspaces</span>,
            <b>int</b> <span id="r22 rd" class="r22 r">maxRunspaces</span>, <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r25 rd" class="r25 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r24 rd" class="r24 r">host</span>)
        {
            <b>return</b> <a href="#9a4d0ce3eb349078" class="i method">CreateRunspacePool</a>(<span class="r23 r">minRunspaces</span>, <span class="r22 r">maxRunspaces</span>, <span class="r25 r">connectionInfo</span>, <span class="r24 r">host</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool</span>
        <span class="c">///</span><span class="c"> on the specified remote runspace computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> limits the number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. The minimum pool size is set to</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">minPoolSoze</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspace that should exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">typeTable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null no custom serialization/deserialization</span>
        <span class="c">///</span><span class="c"> can be done. Default PowerShell behavior will be used in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host associated with this</span>
        <span class="c">///</span><span class="c"> runspace pool</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceConnectionInfo object describing</span>
        <span class="c">///</span><span class="c"> the remote computer on which this runspace pool needs to be</span>
        <span class="c">///</span><span class="c"> created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> connectionInfo is null</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="9a4d0ce3eb349078" href="../../R/9a4d0ce3eb349078.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r27 rd" class="r27 r">minRunspaces</span>,
            <b>int</b> <span id="r26 rd" class="r26 r">maxRunspaces</span>, <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r30 rd" class="r30 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r29 rd" class="r29 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r28 rd" class="r28 r">typeTable</span>)
        {
            <b>return</b> <a href="#6dc630d15b1e55cc" class="i method">CreateRunspacePool</a>(<span class="r27 r">minRunspaces</span>, <span class="r26 r">maxRunspaces</span>, <span class="r30 r">connectionInfo</span>, <span class="r29 r">host</span>, <span class="r28 r">typeTable</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a RunspacePool</span>
        <span class="c">///</span><span class="c"> on the specified remote runspace computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> limits the number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. The minimum pool size is set to</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">minPoolSoze</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The minimum number of Runspace that should exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum number of Runspaces that can exist in this</span>
        <span class="c">///</span><span class="c"> pool. Should be greater than or equal to 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">typeTable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null no custom serialization/deserialization</span>
        <span class="c">///</span><span class="c"> can be done. Default PowerShell behavior will be used in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host associated with this</span>
        <span class="c">///</span><span class="c"> runspace pool</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../remoting/fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceConnectionInfo object describing</span>
        <span class="c">///</span><span class="c"> the remote computer on which this runspace pool needs to be</span>
        <span class="c">///</span><span class="c"> created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> Minimum Pool size is less than 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> connectionInfo is null</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>public static</b> <a href="RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="6dc630d15b1e55cc" href="../../R/6dc630d15b1e55cc.html" target="n" data-glyph="72,1" class="i method">CreateRunspacePool</a>(<b>int</b> <span id="r32 rd" class="r32 r">minRunspaces</span>,
            <b>int</b> <span id="r31 rd" class="r31 r">maxRunspaces</span>, <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r36 rd" class="r36 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r34 rd" class="r34 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r33 rd" class="r33 r">typeTable</span>, <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r35 rd" class="r35 r">applicationArguments</span>)
        {
            <b>if</b> (<span class="r36 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> &amp;&amp;
                <span class="r36 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> &amp;&amp;
                <span class="r36 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a> &amp;&amp;
                <span class="r36 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#3906a420e89ab01e" class="t t">VMConnectionInfo</a> &amp;&amp;
                <span class="r36 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
 
            <b>if</b> (<span class="r36 r">connectionInfo</span> <b>is</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>)
            {
                <a href="../remoting/commands/remotingcommandutil.cs.html#4c008a65630ba320" class="t t">RemotingCommandUtil</a>.<a href="../remoting/commands/remotingcommandutil.cs.html#f22bbb28211012bd" class="i method">CheckHostRemotingPrerequisites</a>();
            }
 
            <b>return</b> <b>new</b> <a href="RunspacePool.cs.html#3c62d815c5c87586" class="t constructor">RunspacePool</a>(<span class="r32 r">minRunspaces</span>, <span class="r31 r">maxRunspaces</span>, <span class="r33 r">typeTable</span>, <span class="r34 r">host</span>, <span class="r35 r">applicationArguments</span>, <span class="r36 r">connectionInfo</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RunspacePool - remote Factory
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace - Remote Factory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="7efc9e75cdb9fe67" href="../../R/7efc9e75cdb9fe67.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r39 rd" class="r39 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r38 rd" class="r38 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r37 rd" class="r37 r">typeTable</span>)
        {
            <b>return</b> <a href="#282b0fc7cd1a4e59" class="i method">CreateRunspace</a>(<span class="r39 r">connectionInfo</span>, <span class="r38 r">host</span>, <span class="r37 r">typeTable</span>, <b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../remoting/fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="c3cf03d3549f6479" href="../../R/c3cf03d3549f6479.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r42 rd" class="r42 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r41 rd" class="r41 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r40 rd" class="r40 r">typeTable</span>, <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r43 rd" class="r43 r">applicationArguments</span>)
        {
            <b>return</b> <a href="#282b0fc7cd1a4e59" class="i method">CreateRunspace</a>(<span class="r42 r">connectionInfo</span>, <span class="r41 r">host</span>, <span class="r40 r">typeTable</span>, <span class="r43 r">applicationArguments</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../remoting/fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name for remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="282b0fc7cd1a4e59" href="../../R/282b0fc7cd1a4e59.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r44 rd" class="r44 r">connectionInfo</span>, <a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r45 rd" class="r45 r">host</span>, <a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r46 rd" class="r46 r">typeTable</span>, <a href="../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r47 rd" class="r47 r">applicationArguments</span>, <b>string</b> <span id="r48 rd" class="r48 r">name</span>)
        {
            <b>if</b> (<span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> &amp;&amp;
                <span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> &amp;&amp;
                <span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a> &amp;&amp;
                <span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#c9fcf5b14ea1c33c" class="t t">SSHConnectionInfo</a> &amp;&amp;
                <span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#3906a420e89ab01e" class="t t">VMConnectionInfo</a> &amp;&amp;
                <span class="r44 r">connectionInfo</span> <b>is not</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
 
            <b>if</b> (<span class="r44 r">connectionInfo</span> <b>is</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>)
            {
                <a href="../remoting/commands/remotingcommandutil.cs.html#4c008a65630ba320" class="t t">RemotingCommandUtil</a>.<a href="../remoting/commands/remotingcommandutil.cs.html#f22bbb28211012bd" class="i method">CheckHostRemotingPrerequisites</a>();
            }
 
            <b>return</b> <b>new</b> <a href="../remoting/client/remoterunspace.cs.html#926354f3385f000b" class="t constructor">RemoteRunspace</a>(<span class="r46 r">typeTable</span>, <span class="r44 r">connectionInfo</span>, <span class="r45 r">host</span>, <span class="r47 r">applicationArguments</span>, <span class="r48 r">name</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="99a3cfb8040d4105" href="../../R/99a3cfb8040d4105.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r49 rd" class="r49 r">host</span>, <a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r50 rd" class="r50 r">connectionInfo</span>)
        {
            <b>return</b> <a href="#7efc9e75cdb9fe67" class="i method">CreateRunspace</a>(<span class="r50 r">connectionInfo</span>, <span class="r49 r">host</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="ccc2e7c111720418" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateRunspace</a>(<a href="../remoting/common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r51 rd" class="r51 r">connectionInfo</span>)
        {
            <b>return</b> <a href="#99a3cfb8040d4105" class="i method">CreateRunspace</a>(<b>null</b>, <span class="r51 r">connectionInfo</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Runspace - Remote Factory
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> V3 Extensions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="53299186accef159" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOutOfProcessRunspace</a>(<a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r52 rd" class="r52 r">typeTable</span>)
        {
            <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> <span id="r53 rd" class="r53 r">connectionInfo</span> = <b>new</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#b4be2ca19f774eb8" class="t constructor">NewProcessConnectionInfo</a>(<b>null</b>);
 
            <b>return</b> <a href="#7efc9e75cdb9fe67" class="i method">CreateRunspace</a>(<span class="r53 r">connectionInfo</span>, <b>null</b>, <span class="r52 r">typeTable</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">processInstance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="24e7532520325dd8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateOutOfProcessRunspace</a>(<a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r54 rd" class="r54 r">typeTable</span>, <a href="PowerShellProcessInstance.cs.html#85e1d8f342ae7442" class="t t">PowerShellProcessInstance</a> <span id="r55 rd" class="r55 r">processInstance</span>)
        {
            <a href="../remoting/common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> <span id="r56 rd" class="r56 r">connectionInfo</span> = <b>new</b> <a href="../remoting/common/RunspaceConnectionInfo.cs.html#b4be2ca19f774eb8" class="t constructor">NewProcessConnectionInfo</a>(<b>null</b>) { <a href="../remoting/common/RunspaceConnectionInfo.cs.html#3700438a1679dca4" class="i property">Process</a> = <span class="r55 r">processInstance</span> };
 
            <b>return</b> <a href="#7efc9e75cdb9fe67" class="i method">CreateRunspace</a>(<span class="r56 r">connectionInfo</span>, <b>null</b>, <span class="r54 r">typeTable</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> V3 Extensions
    }
}
</pre></td></tr></table></div></body></html>
