<!DOCTYPE html>
<html><head><title>PSDataCollection.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(2165);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/PSDataCollection.cs" target="_top">engine\hostifaces\PSDataCollection.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>; <span class="c">// for fxcop</span>
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DataAddedEventArgs
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to PSDataCollection DataAdded handlers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="7044b5d8986ab72f" href="../../R/7044b5d8986ab72f.html" target="n" data-glyph="0,0" class="t t">DataAddedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell InstanceId which added this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty, if the data is not added by a PowerShell</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Index at which the data is added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="abfd119b0fcf801f" href="../../R/abfd119b0fcf801f.html" target="n" data-glyph="74,1" class="t constructor">DataAddedEventArgs</a>(<span class="i">Guid</span> <span id="r0 rd" class="r0 r">psInstanceId</span>, <b>int</b> <span id="r1 rd" class="r1 r">index</span>)
        {
            <a href="#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a> = <span class="r0 r">psInstanceId</span>;
            <a href="#0ed8637c462f29c7" class="i property">Index</a> = <span class="r1 r">index</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Index at which the data is added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="0ed8637c462f29c7" href="../../R/0ed8637c462f29c7.html" target="n" data-glyph="102,1" class="i property">Index</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell InstanceId which added this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty, if the data is not added by a PowerShell</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="86d3385322bd1ad4" href="../../R/86d3385322bd1ad4.html" target="n" data-glyph="102,1" class="i property">PowerShellInstanceId</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to PSDataCollection DataAdding handlers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="3298844a15d33a53" href="../../R/3298844a15d33a53.html" target="n" data-glyph="0,0" class="t t">DataAddingEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell InstanceId which added this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty, if the data is not added by a PowerShell</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">itemAdded</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The actual item about to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="51c80776dde4212e" href="../../R/51c80776dde4212e.html" target="n" data-glyph="74,1" class="t constructor">DataAddingEventArgs</a>(<span class="i">Guid</span> <span id="r2 rd" class="r2 r">psInstanceId</span>, <b>object</b> <span id="r3 rd" class="r3 r">itemAdded</span>)
        {
            <a href="#87cb2b293fbf148d" class="i property">PowerShellInstanceId</a> = <span class="r2 r">psInstanceId</span>;
            <a href="#0f4cac2293a87d1a" class="i property">ItemAdded</a> = <span class="r3 r">itemAdded</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The item about to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="0f4cac2293a87d1a" href="../../R/0f4cac2293a87d1a.html" target="n" data-glyph="102,1" class="i property">ItemAdded</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell InstanceId which added this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty, if the data is not added by a PowerShell</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="87cb2b293fbf148d" href="../../R/87cb2b293fbf148d.html" target="n" data-glyph="102,1" class="i property">PowerShellInstanceId</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSDataCollection
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">build</span>
    <span class="c">///</span><span class="c"> Thread Safe buffer used with PowerShell Hosting interfaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="52e2b209c10ec0a4" href="../../R/52e2b209c10ec0a4.html" target="n" data-glyph="0,0" class="t t">PSDataCollection</a>&lt;<span id="r4 rd t" class="r4 r t">T</span>&gt; : <span class="i">IList</span>&lt;<span class="r4 r t">T</span>&gt;, <span class="i">ICollection</span>&lt;<span class="r4 r t">T</span>&gt;, <span class="i">IEnumerable</span>&lt;<span class="r4 r t">T</span>&gt;, <span class="i">IList</span>, <span class="i">ICollection</span>, <span class="i">IEnumerable</span>, <span class="i">IDisposable</span>, <span class="i">ISerializable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private readonly</b> <span class="i">IList</span>&lt;<span class="r4 r t">T</span>&gt; <a id="b7ff3e438aae63ed" href="../../R/b7ff3e438aae63ed.html" target="n" data-glyph="46,1" class="i field">_data</a>;
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="1367c13407dbb3df" href="../../R/1367c13407dbb3df.html" target="n" data-glyph="46,1" class="i field">_readWaitHandle</a>;
        <b>private bool</b> <a id="49a4e1dbfdd199fc" href="../../R/49a4e1dbfdd199fc.html" target="n" data-glyph="46,1" class="i field">_isOpen</a> = <b>true</b>;
        <b>private bool</b> <a id="14a62ac30e5c3246" href="../../R/14a62ac30e5c3246.html" target="n" data-glyph="46,1" class="i field">_releaseOnEnumeration</a>;
        <b>private bool</b> <a id="bd1f78c9d9d76e01" href="../../R/bd1f78c9d9d76e01.html" target="n" data-glyph="46,1" class="i field">_isEnumerated</a>;
        <span class="c">// a counter to keep track of active PowerShell instances</span>
        <span class="c">// using this buffer.</span>
        <b>private int</b> <a id="d7acdf85e8961b3e" href="../../R/d7acdf85e8961b3e.html" target="n" data-glyph="46,1" class="i field">_refCount</a>;
 
        <b>private bool</b> <a id="8fa67a7994a3094a" href="../../R/8fa67a7994a3094a.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether the enumerator needs to be blocking</span>
        <span class="c">///</span><span class="c"> by default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="03f0256ad8dadde9" href="../../R/03f0256ad8dadde9.html" target="n" data-glyph="46,1" class="i field">_blockingEnumerator</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether the ref count was incremented when</span>
        <span class="c">///</span><span class="c"> BlockingEnumerator was updated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="2fa0c048085fa912" href="../../R/2fa0c048085fa912.html" target="n" data-glyph="46,1" class="i field">_refCountIncrementedForBlockingEnumerator</a> = <b>false</b>;
 
        <b>private int</b> <a id="74772ad02b64919e" href="../../R/74772ad02b64919e.html" target="n" data-glyph="46,1" class="i field">_countNewData</a> = 0;
        <b>private int</b> <a id="4a6983899d1daf1f" href="../../R/4a6983899d1daf1f.html" target="n" data-glyph="46,1" class="i field">_dataAddedFrequency</a> = 1;
        <b>private</b> <span class="i">Guid</span> <a id="7f26a2363fa0371d" href="../../R/7f26a2363fa0371d.html" target="n" data-glyph="46,1" class="i field">_sourceGuid</a> = <span class="i">Guid</span>.<span class="i">Empty</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="ee85ce3306fe4e5b" href="../../R/ee85ce3306fe4e5b.html" target="n" data-glyph="72,1" class="t constructor">PSDataCollection</a>() : <b>this</b>(<b>new</b> <span class="i">List</span>&lt;<span class="r4 r t">T</span>&gt;())
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PSDataCollection that includes all the items in the IEnumerable and invokes Complete().</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">items</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Items used to initialize the collection</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is useful when the user wants to use an IEnumerable as an input to one of the PowerShell.BeginInvoke overloads.</span>
        <span class="c">///</span><span class="c"> The invocation doesn&#39;t complete until Complete() is called on the PSDataCollection; this constructor does the Complete() on</span>
        <span class="c">///</span><span class="c"> behalf of the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a id="72b350a1a3b093e0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSDataCollection</a>(<span class="i">IEnumerable</span>&lt;<span class="r4 r t">T</span>&gt; <span id="r5 rd" class="r5 r">items</span>) : <b>this</b>(<b>new</b> <span class="i">List</span>&lt;<span class="r4 r t">T</span>&gt;(<span class="r5 r">items</span>))
        {
            <a href="#52e2b209c10ec0a4" class="k">this</a>.<a href="#0a8262d798e33fc6" class="i method">Complete</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance with the specified capacity</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">capacity</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">capacity</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of elements that the new buffer can initially</span>
        <span class="c">///</span><span class="c"> store.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Capacity is the number of elements that the PSDataCollection can</span>
        <span class="c">///</span><span class="c"> store before resizing is required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a id="0a9bfc9a497a920b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSDataCollection</a>(<b>int</b> <span id="r6 rd" class="r6 r">capacity</span>) : <b>this</b>(<b>new</b> <span class="i">List</span>&lt;<span class="r4 r t">T</span>&gt;(<span class="r6 r">capacity</span>))
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> type converters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<b>bool</b> <span id="r7 rd" class="r7 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#286a3bc3025d7c4c" class="i method">CreateAndInitializeFromExplicitValue</a>(<span class="r7 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<b>string</b> <span id="r8 rd" class="r8 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#286a3bc3025d7c4c" class="i method">CreateAndInitializeFromExplicitValue</a>(<span class="r8 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<b>int</b> <span id="r9 rd" class="r9 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#286a3bc3025d7c4c" class="i method">CreateAndInitializeFromExplicitValue</a>(<span class="r9 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<b>byte</b> <span id="r10 rd" class="r10 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#286a3bc3025d7c4c" class="i method">CreateAndInitializeFromExplicitValue</a>(<span class="r10 r">valueToConvert</span>);
        }
 
        <b>private static</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt; <a id="286a3bc3025d7c4c" href="../../R/286a3bc3025d7c4c.html" target="n" data-glyph="76,1" class="i method">CreateAndInitializeFromExplicitValue</a>(<b>object</b> <span id="r11 rd" class="r11 r">valueToConvert</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt; <span id="r12 rd" class="r12 r">psdc</span> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;();
            <span class="r12 r">psdc</span>.<a href="#681501d1e27b76df" class="i method">Add</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<span class="r4 r t">T</span>&gt;(<span class="r11 r">valueToConvert</span>));
            <span class="r12 r">psdc</span>.<a href="#0a8262d798e33fc6" class="i method">Complete</a>();
            <b>return</b> <span class="r12 r">psdc</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<span class="i">Hashtable</span> <span id="r13 rd" class="r13 r">valueToConvert</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt; <span id="r14 rd" class="r14 r">psdc</span> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;();
            <span class="r14 r">psdc</span>.<a href="#681501d1e27b76df" class="i method">Add</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<span class="r4 r t">T</span>&gt;(<span class="r13 r">valueToConvert</span>));
            <span class="r14 r">psdc</span>.<a href="#0a8262d798e33fc6" class="i method">Complete</a>();
            <b>return</b> <span class="r14 r">psdc</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<span class="r4 r t">T</span> <span id="r15 rd" class="r15 r">valueToConvert</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt; <span id="r16 rd" class="r16 r">psdc</span> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;();
            <span class="r16 r">psdc</span>.<a href="#681501d1e27b76df" class="i method">Add</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<span class="r4 r t">T</span>&gt;(<span class="r15 r">valueToConvert</span>));
            <span class="r16 r">psdc</span>.<a href="#0a8262d798e33fc6" class="i method">Complete</a>();
            <b>return</b> <span class="r16 r">psdc</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the argument in a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">arrayToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New collection of value, marked as Complete.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2225:OperatorOverloadsHaveNamedAlternates&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;There are already alternates to the implicit casts, ToXXX and FromXXX methods are unnecessary and redundant&quot;</span>)]
        <b>public static implicit operator</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;(<b>object</b>[] <span id="r17 rd" class="r17 r">arrayToConvert</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt; <span id="r18 rd" class="r18 r">psdc</span> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;();
            <b>if</b> (<span class="r17 r">arrayToConvert</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r19 rd" class="r19 r">ae</span> <b>in</b> <span class="r17 r">arrayToConvert</span>)
                {
                    <span class="r18 r">psdc</span>.<a href="#681501d1e27b76df" class="i method">Add</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<span class="r4 r t">T</span>&gt;(<span class="r19 r">ae</span>));
                }
            }
 
            <span class="r18 r">psdc</span>.<a href="#0a8262d798e33fc6" class="i method">Complete</a>();
            <b>return</b> <span class="r18 r">psdc</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct the DataBuffer using the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">listToUse</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> as the data buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">listToUse</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> buffer where the elements are stored</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Using this constructor will make the data buffer a wrapper on</span>
        <span class="c">///</span><span class="c"> top of the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">listToUse</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, which provides synchronized</span>
        <span class="c">///</span><span class="c"> access.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a id="659c4c13c0945ebf" href="../../R/659c4c13c0945ebf.html" target="n" data-glyph="74,1" class="t constructor">PSDataCollection</a>(<span class="i">IList</span>&lt;<span class="r4 r t">T</span>&gt; <span id="r20 rd" class="r20 r">listToUse</span>)
        {
            <a href="#b7ff3e438aae63ed" class="i field">_data</a> = <span class="r20 r">listToUse</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PSDataCollection from an ISerializable context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The streaming context for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="2377d335221b21b3" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">PSDataCollection</a>(<span class="i">SerializationInfo</span> <span id="r21 rd" class="r21 r">info</span>, <span class="i">StreamingContext</span> <span id="r22 rd" class="r22 r">context</span>)
        {
            <b>if</b> (<span class="r21 r">info</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r21 r">info</span>));
            }
 
            <b>if</b> (!(<span class="r21 r">info</span>.<span class="i">GetValue</span>(<span class="s">&quot;Data&quot;</span>, <b>typeof</b>(<span class="i">IList</span>&lt;<span class="r4 r t">T</span>&gt;)) <b>is</b> <span class="i">IList</span>&lt;<span class="r4 r t">T</span>&gt; <span id="r23 rd" class="r23 r">listToUse</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r21 r">info</span>));
            }
 
            <a href="#b7ff3e438aae63ed" class="i field">_data</a> = <span class="r23 r">listToUse</span>;
 
            <a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a> = <span class="r21 r">info</span>.<span class="i">GetBoolean</span>(<span class="s">&quot;BlockingEnumerator&quot;</span>);
            <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a> = <span class="r21 r">info</span>.<span class="i">GetInt32</span>(<span class="s">&quot;DataAddedCount&quot;</span>);
            <a href="#227dd72a718dff74" class="i property">EnumeratorNeverBlocks</a> = <span class="r21 r">info</span>.<span class="i">GetBoolean</span>(<span class="s">&quot;EnumeratorNeverBlocks&quot;</span>);
            <a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a> = <span class="r21 r">info</span>.<span class="i">GetBoolean</span>(<span class="s">&quot;IsOpen&quot;</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSDataCollection Specific Public Methods / Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event fired when objects are being added to the underlying buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#3298844a15d33a53" class="t t">DataAddingEventArgs</a>&gt; <a id="43aaeadedbd395cd" href="../../R/43aaeadedbd395cd.html" target="n" data-glyph="30,1" class="i">DataAdding</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event fired when objects are done being added to the underlying buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <a id="de98d172ff9dac86" href="../../R/de98d172ff9dac86.html" target="n" data-glyph="30,1" class="i">DataAdded</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event fired when the buffer is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span> <a id="6babaf76cd9d021c" href="../../R/6babaf76cd9d021c.html" target="n" data-glyph="30,1" class="i">Completed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A boolean which determines if the buffer is open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c160386455270a8f" href="../../R/c160386455270a8f.html" target="n" data-glyph="102,1" class="i property">IsOpen</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An int that tells the frequency of Data Added events fired.</span>
        <span class="c">///</span><span class="c"> Raises the DataAdded event only when data has been added a multiple of this many times,</span>
        <span class="c">///</span><span class="c"> or when collection can receive no more data, if further data is added past the last event</span>
        <span class="c">///</span><span class="c"> prior to completion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="9561cde00b0fe6e4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">DataAddedCount</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a>;
            }
 
            <b>set</b>
            {
                <b>bool</b> <span id="r24 rd" class="r24 r">raiseDataAdded</span> = <b>false</b>;
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a> = <b>value</b>;
                    <b>if</b> (<a href="#74772ad02b64919e" class="i field">_countNewData</a> &gt;= <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a>)
                    {
                        <span class="r24 r">raiseDataAdded</span> = <b>true</b>;
                        <a href="#74772ad02b64919e" class="i field">_countNewData</a> = 0;
                    }
                }
 
                <b>if</b> (<span class="r24 r">raiseDataAdded</span>)
                {
                    <span class="c">// We should raise the event outside of the lock</span>
                    <span class="c">// as the call is made into 3rd party code</span>
                    <a href="#88eee4d4db605140" class="i method">RaiseDataAddedEvent</a>(<a href="#be0f3424ead0d009" class="i field">_lastPsInstanceId</a>, <a href="#98a4fb2cf8e7e539" class="i field">_lastIndex</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes all input by default.</span>
        <span class="c">///</span><span class="c"> This is supported only for PSDataCollections of PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bf6ffbbf97d16de4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SerializeInput</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>typeof</b>(<span class="r4 r t">T</span>) != <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>))
                {
                    <span class="c">// If you drop this constraint, GetSerializedInput must be updated.</span>
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">PSDataBufferStrings</span>.<span class="i">SerializationNotSupported</span>);
                }
 
                <a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="f15bd5fefcc7f57b" href="../../R/f15bd5fefcc7f57b.html" target="n" data-glyph="46,1" class="i field">_serializeInput</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether this PSDataCollection was created implicitly in support of</span>
        <span class="c">///</span><span class="c"> data collection (for example, a workflow that wants to capture output but hasn&#39;t</span>
        <span class="c">///</span><span class="c"> provided an instance of the PSDataCollection to capture it with.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="459ab6e0726a89a1" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsAutoGenerated</a>
        {
            <b>get</b>; <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal tag for indicating a source object identifier for this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Guid</span> <a id="3fc5ffd5d13cd3db" href="../../R/3fc5ffd5d13cd3db.html" target="n" data-glyph="104,1" class="i property">SourceId</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#7f26a2363fa0371d" class="i field">_sourceGuid</a>;
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#7f26a2363fa0371d" class="i field">_sourceGuid</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this flag is set to true, the items in the collection will be set to null when it is</span>
        <span class="c">///</span><span class="c"> traversed using a PSDataCollectionEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="964a56f986986159" href="../../R/964a56f986986159.html" target="n" data-glyph="104,1" class="i property">ReleaseOnEnumeration</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#14a62ac30e5c3246" class="i field">_releaseOnEnumeration</a>;
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#14a62ac30e5c3246" class="i field">_releaseOnEnumeration</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This flag is true when the collection has been enumerated at least once by a PSDataCollectionEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="fc975c8dd4d53ae0" href="../../R/fc975c8dd4d53ae0.html" target="n" data-glyph="104,1" class="i property">IsEnumerated</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#bd1f78c9d9d76e01" class="i field">_isEnumerated</a>;
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#bd1f78c9d9d76e01" class="i field">_isEnumerated</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Completes insertions to the buffer.</span>
        <span class="c">///</span><span class="c"> Subsequent Inserts to the buffer will result in an InvalidOperationException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0a8262d798e33fc6" href="../../R/0a8262d798e33fc6.html" target="n" data-glyph="72,1" class="i method">Complete</a>()
        {
            <b>bool</b> <span id="r25 rd" class="r25 r">raiseEvents</span> = <b>false</b>;
            <b>bool</b> <span id="r26 rd" class="r26 r">raiseDataAdded</span> = <b>false</b>;
            <b>try</b>
            {
                <span class="c">// Close the buffer</span>
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>if</b> (<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>)
                    {
                        <a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a> = <b>false</b>;
                        <span class="r25 r">raiseEvents</span> = <b>true</b>;
                        <span class="c">// release any threads to notify an event. Enumerator</span>
                        <span class="c">// blocks on this syncObject.</span>
                        <span class="i">Monitor</span>.<span class="i">PulseAll</span>(<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
 
                        <b>if</b> (<a href="#74772ad02b64919e" class="i field">_countNewData</a> &gt; 0)
                        {
                            <span class="r26 r">raiseDataAdded</span> = <b>true</b>;
                            <a href="#74772ad02b64919e" class="i field">_countNewData</a> = 0;
                        }
                    }
                }
            }
            <b>finally</b>
            {
                <span class="c">// raise the events outside of the lock.</span>
                <b>if</b> (<span class="r25 r">raiseEvents</span>)
                {
                    <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> != <b>null</b>)
                    {
                        <span class="c">// unblock any readers waiting on the handle</span>
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Set</span>();
                    }
 
                    <span class="c">// A temporary variable is used as the Completed may</span>
                    <span class="c">// reach null (because of -=&#39;s) after the null check</span>
                    <a href="#6babaf76cd9d021c" class="i">Completed</a>?.<span class="i">Invoke</span>(<a href="#52e2b209c10ec0a4" class="k">this</a>, <span class="i">EventArgs</span>.<span class="i">Empty</span>);
                }
 
                <b>if</b> (<span class="r26 r">raiseDataAdded</span>)
                {
                    <a href="#88eee4d4db605140" class="i method">RaiseDataAddedEvent</a>(<a href="#be0f3424ead0d009" class="i field">_lastPsInstanceId</a>, <a href="#98a4fb2cf8e7e539" class="i field">_lastIndex</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether the data collection should</span>
        <span class="c">///</span><span class="c"> have a blocking enumerator by default. Currently</span>
        <span class="c">///</span><span class="c"> only when a PowerShell object is associated with</span>
        <span class="c">///</span><span class="c"> the data collection, a reference count is added</span>
        <span class="c">///</span><span class="c"> which causes the enumerator to be blocking. This</span>
        <span class="c">///</span><span class="c"> prevents the use of PSDataCollection without a</span>
        <span class="c">///</span><span class="c"> PowerShell object. This property fixes the same.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="f0c555b53469e3b8" href="../../R/f0c555b53469e3b8.html" target="n" data-glyph="102,1" class="i property">BlockingEnumerator</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a>;
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a> = <b>value</b>;
 
                    <b>if</b> (<a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a>)
                    {
                        <b>if</b> (!<a href="#2fa0c048085fa912" class="i field">_refCountIncrementedForBlockingEnumerator</a>)
                        {
                            <a href="#2fa0c048085fa912" class="i field">_refCountIncrementedForBlockingEnumerator</a> = <b>true</b>;
                            <a href="#20fe51d62499cf69" class="i method">AddRef</a>();
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// TODO: false doesn&#39;t always leading to non-blocking</span>
                        <span class="c">// behavior in an intuitive way. Need to follow up</span>
                        <span class="c">// and fix this</span>
                        <b>if</b> (<a href="#2fa0c048085fa912" class="i field">_refCountIncrementedForBlockingEnumerator</a>)
                        {
                            <a href="#2fa0c048085fa912" class="i field">_refCountIncrementedForBlockingEnumerator</a> = <b>false</b>;
                            <a href="#737fb48bd51a18aa" class="i method">DecrementRef</a>();
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this is set to true, then the enumerator returned from</span>
        <span class="c">///</span><span class="c"> GetEnumerator() will never block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="227dd72a718dff74" href="../../R/227dd72a718dff74.html" target="n" data-glyph="102,1" class="i property">EnumeratorNeverBlocks</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IList Generic Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the element at the specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the element to get or set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> index is less than 0.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> index is equal to or greater than Count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <span class="r4 r t">T</span> <a id="0fbfd44b65c14b0d" href="../../R/0fbfd44b65c14b0d.html" target="n" data-glyph="102,1" class="k">this</a>[<b>int</b> <span id="r27 rd" class="r27 r">index</span>]
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>return</b> <a href="#b7ff3e438aae63ed" class="i field">_data</a>[<span class="r27 r">index</span>];
                }
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>if</b> ((<span class="r27 r">index</span> &lt; 0) || (<span class="r27 r">index</span> &gt;= <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>))
                    {
                        <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r27 r">index</span>), <span class="r27 r">index</span>,
                            <span class="i">PSDataBufferStrings</span>.<span class="i">IndexOutOfRange</span>, 0, <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> - 1);
                    }
 
                    <b>if</b> (<a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a>)
                    {
                        <b>value</b> = (<span class="r4 r t">T</span>)(<b>object</b>)<a href="#7f87663d357194d7" class="i method">GetSerializedObject</a>(<b>value</b>);
                    }
 
                    <a href="#b7ff3e438aae63ed" class="i field">_data</a>[<span class="r27 r">index</span>] = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the index of a specific item in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to locate in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index of item if found in the buffer; otherwise, -1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="476efa72c7fa046c" href="../../R/476efa72c7fa046c.html" target="n" data-glyph="72,1" class="i method">IndexOf</a>(<span class="r4 r t">T</span> <span id="r28 rd" class="r28 r">item</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>return</b> <a href="#31a6b88cd802a47f" class="i method">InternalIndexOf</a>(<span class="r28 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inserts an item to the buffer at the specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index at which item should be inserted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to insert into the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index specified is less than zero or greater</span>
        <span class="c">///</span><span class="c"> than Count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6646165195120a1d" href="../../R/6646165195120a1d.html" target="n" data-glyph="72,1" class="i method">Insert</a>(<b>int</b> <span id="r29 rd" class="r29 r">index</span>, <span class="r4 r t">T</span> <span id="r30 rd" class="r30 r">item</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <span class="i">InternalInsertItem</span>(<span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r29 r">index</span>, <span class="r30 r">item</span>);
            }
 
            <span class="i">RaiseEvents</span>(<span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r29 r">index</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the item at the specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the item to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> index is not a valid index in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="cba7d5244153db55" href="../../R/cba7d5244153db55.html" target="n" data-glyph="72,1" class="i method">RemoveAt</a>(<b>int</b> <span id="r31 rd" class="r31 r">index</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> ((<span class="r31 r">index</span> &lt; 0) || (<span class="r31 r">index</span> &gt;= <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>))
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r31 r">index</span>), <span class="r31 r">index</span>,
                        <span class="i">PSDataBufferStrings</span>.<span class="i">IndexOutOfRange</span>, 0, <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> - 1);
                }
 
                <a href="#accb55df6508c7bc" class="i method">RemoveItem</a>(<span class="r31 r">index</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ICollection Generic Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the number of elements contained in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="e7cb43bbebbb4aca" href="../../R/e7cb43bbebbb4aca.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a> == <b>null</b>)
                        <b>return</b> 0;
                    <b>else</b>
                        <b>return</b> <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating whether the buffer is read-only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d90710764841129a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsReadOnly</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an item to the thread-safe buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> item to add</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="681501d1e27b76df" href="../../R/681501d1e27b76df.html" target="n" data-glyph="72,1" class="i method">Add</a>(<span class="r4 r t">T</span> <span id="r32 rd" class="r32 r">item</span>)
        {
            <span class="i">InternalAdd</span>(<span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r32 r">item</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes all items from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8358de7f8ecc84ec" href="../../R/8358de7f8ecc84ec.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a> != <b>null</b>)
                {
                    <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Clear</span>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether the buffer contains an element with a specific value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to locate in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the element value is found in the buffer; otherwise false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bcdc4f0b5206ca4e" href="../../R/bcdc4f0b5206ca4e.html" target="n" data-glyph="72,1" class="i method">Contains</a>(<span class="r4 r t">T</span> <span id="r33 rd" class="r33 r">item</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> (<a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a>)
                {
                    <span class="r33 r">item</span> = (<span class="r4 r t">T</span>)(<b>object</b>)<a href="#7f87663d357194d7" class="i method">GetSerializedObject</a>(<span class="r33 r">item</span>);
                }
 
                <b>return</b> <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Contains</span>(<span class="r33 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copies the elements of the buffer to a specified array, starting at a particular index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">array</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The destination Array for the elements of type T copied from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">arrayIndex</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index in the array at which copying begins.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> array is multidimensional.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> arrayIndex is equal to or greater than the length of array.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> The number of elements in the source buffer is greater than the</span>
        <span class="c">///</span><span class="c"> available space from arrayIndex to the end of the destination array.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> Type T cannot be cast automatically to the type of the destination array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> array is a null reference</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> arrayIndex is less than 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="dad997b939982ea6" href="../../R/dad997b939982ea6.html" target="n" data-glyph="72,1" class="i method">CopyTo</a>(<span class="r4 r t">T</span>[] <span id="r34 rd" class="r34 r">array</span>, <b>int</b> <span id="r35 rd" class="r35 r">arrayIndex</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">CopyTo</span>(<span class="r34 r">array</span>, <span class="r35 r">arrayIndex</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the first occurrence of a specified item from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to remove from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if item was successfully removed from the buffer; otherwise, false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="1264745b73d22345" href="../../R/1264745b73d22345.html" target="n" data-glyph="72,1" class="i method">Remove</a>(<span class="r4 r t">T</span> <span id="r36 rd" class="r36 r">item</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>int</b> <span id="r37 rd" class="r37 r">index</span> = <a href="#31a6b88cd802a47f" class="i method">InternalIndexOf</a>(<span class="r36 r">item</span>);
                <b>if</b> (<span class="r37 r">index</span> &lt; 0)
                {
                    <b>return</b> <b>false</b>;
                }
 
                <a href="#accb55df6508c7bc" class="i method">RemoveItem</a>(<span class="r37 r">index</span>);
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable Generic Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an enumerator that iterates through the</span>
        <span class="c">///</span><span class="c"> elements of the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An IEnumerator for objects of the type stored in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerator</span>&lt;<span class="r4 r t">T</span>&gt; <a id="fa82432985fff86c" href="../../R/fa82432985fff86c.html" target="n" data-glyph="72,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <b>new</b> <a href="#e55c9c05c9e0d495" class="t constructor">PSDataCollectionEnumerator</a>&lt;<span class="r4 r t">T</span>&gt;(<a href="#52e2b209c10ec0a4" class="k">this</a>, <a href="#227dd72a718dff74" class="i property">EnumeratorNeverBlocks</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IList Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element to the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to add to the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position into which the new element was inserted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>int</b> <span class="i">IList</span>.<a id="bd17a304c376e01c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Add</a>(<b>object</b> <span id="r38 rd" class="r38 r">value</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<span class="r38 r">value</span>);
            <b>int</b> <span id="r39 rd" class="r39 r">index</span> = <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>;
            <span class="i">InternalAdd</span>(<span class="i">Guid</span>.<span class="i">Empty</span>, (<span class="r4 r t">T</span>)<span class="r38 r">value</span>);
            <span class="i">RaiseEvents</span>(<span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r39 r">index</span>);
 
            <b>return</b> <span class="r39 r">index</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether the collection contains an</span>
        <span class="c">///</span><span class="c"> element with a specific value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to locate in the collection</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the element value is found in the collection;</span>
        <span class="c">///</span><span class="c"> otherwise false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>bool</b> <span class="i">IList</span>.<a id="c5a5eda6813fd28c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Contains</a>(<b>object</b> <span id="r40 rd" class="r40 r">value</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<span class="r40 r">value</span>);
            <b>return</b> <a href="#bcdc4f0b5206ca4e" class="i method">Contains</a>((<span class="r4 r t">T</span>)<span class="r40 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the zero-based index of an element in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The element in the buffer whose index is being determined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index of the value if found in the buffer; otherwise, -1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>int</b> <span class="i">IList</span>.<a id="88cf5ef1d156863e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IndexOf</a>(<b>object</b> <span id="r41 rd" class="r41 r">value</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<span class="r41 r">value</span>);
            <b>return</b> <a href="#476efa72c7fa046c" class="i method">IndexOf</a>((<span class="r4 r t">T</span>)<span class="r41 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inserts an object into the buffer at a specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index at which value is to be inserted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to insert into the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> index is not a valid index in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>void</b> <span class="i">IList</span>.<a id="a6741c0985d0696e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Insert</a>(<b>int</b> <span id="r42 rd" class="r42 r">index</span>, <b>object</b> <span id="r43 rd" class="r43 r">value</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<span class="r43 r">value</span>);
            <a href="#6646165195120a1d" class="i method">Insert</a>(<span class="r42 r">index</span>, (<span class="r4 r t">T</span>)<span class="r43 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the first occurrence of a specified object</span>
        <span class="c">///</span><span class="c"> as an element from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to be removed from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>void</b> <span class="i">IList</span>.<a id="253bad658a0a3aad" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Remove</a>(<b>object</b> <span id="r44 rd" class="r44 r">value</span>)
        {
            <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<span class="r44 r">value</span>);
            <a href="#1264745b73d22345" class="i method">Remove</a>((<span class="r4 r t">T</span>)<span class="r44 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value that indicates whether the buffer is fixed in size.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <span class="i">IList</span>.<a id="7433946cc6976478" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">IsFixedSize</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value that indicates whether the buffer is read-only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <span class="i">IList</span>.<a id="1f8b202454072dd2" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">IsReadOnly</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the element at the specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the element to get or set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">IndexOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> index is less than 0.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> index is equal to or greater than Count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>object</b> <span class="i">IList</span>.<a id="3e0fd7f547e9ddee" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="k">this</a>[<b>int</b> <span id="r45 rd" class="r45 r">index</span>]
        {
            <b>get</b>
            {
                <b>return</b> <a href="#52e2b209c10ec0a4" class="k">this</a><a href="#0fbfd44b65c14b0d">[</a><span class="r45 r">index</span>];
            }
 
            <b>set</b>
            {
                <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r4 r t">T</span>&gt;.<a href="#30a18176d7b31bab" class="i method">VerifyValueType</a>(<b>value</b>);
                <a href="#52e2b209c10ec0a4" class="k">this</a><a href="#0fbfd44b65c14b0d">[</a><span class="r45 r">index</span>] = (<span class="r4 r t">T</span>)<b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ICollection Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value that indicates whether the buffer is synchronized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <span class="i">ICollection</span>.<a id="9eb64b9c8e67d99d" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">IsSynchronized</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the object used to synchronize access to the thread-safe buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>object</b> <span class="i">ICollection</span>.<a id="c1ba296faae23bad" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">SyncRoot</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#596a9323fba4a085" class="i property">SyncObject</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copies the elements of the collection to a specified array,</span>
        <span class="c">///</span><span class="c"> starting at a particular index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">array</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The destination Array for the elements of type T copied</span>
        <span class="c">///</span><span class="c"> from the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index in the array at which copying begins.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> array is multidimensional.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> arrayIndex is equal to or greater than the length of array.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> The number of elements in the source buffer is greater than the</span>
        <span class="c">///</span><span class="c"> available space from arrayIndex to the end of the destination array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> array is a null reference</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> arrayIndex is less than 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>void</b> <span class="i">ICollection</span>.<a id="837fd48fe11e9386" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CopyTo</a>(<span class="i">Array</span> <span id="r46 rd" class="r46 r">array</span>, <b>int</b> <span id="r47 rd" class="r47 r">index</span>)
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">CopyTo</span>((<span class="r4 r t">T</span>[])<span class="r46 r">array</span>, <span class="r47 r">index</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an enumerator that iterates through the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An IEnumerator for objects of the type stored in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i">IEnumerator</span> <span class="i">IEnumerable</span>.<a id="6bb4ef85eb03cef6" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <b>new</b> <a href="#e55c9c05c9e0d495" class="t constructor">PSDataCollectionEnumerator</a>&lt;<span class="r4 r t">T</span>&gt;(<a href="#52e2b209c10ec0a4" class="k">this</a>, <a href="#227dd72a718dff74" class="i property">EnumeratorNeverBlocks</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Streaming Behavior
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Makes a shallow copy of all the elements currently in this collection</span>
        <span class="c">///</span><span class="c"> and clears them from this collection. This will not result in a blocking call.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Calling this method might have side effects on the enumerator. When this</span>
        <span class="c">///</span><span class="c"> method is called, the behavior of the enumerator is not defined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A new collection with a copy of all the elements in the current collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<span class="r4 r t">T</span>&gt; <a id="403be942120e2d89" href="../../R/403be942120e2d89.html" target="n" data-glyph="72,1" class="i method">ReadAll</a>()
        {
            <b>return</b> <a href="#dbac5089cef6050c" class="i method">ReadAndRemove</a>(0);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Makes a shallow copy of all the elements currently in this collection</span>
        <span class="c">///</span><span class="c"> and clears them from this collection. This will not result in a blocking call.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Calling this method might have side effects on the enumerator. When this</span>
        <span class="c">///</span><span class="c"> method is called, the behavior of the enumerator is not defined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A new collection with a copy of all the elements in the current collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">readCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Maximum number of elements to read.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<span class="r4 r t">T</span>&gt; <a id="dbac5089cef6050c" href="../../R/dbac5089cef6050c.html" target="n" data-glyph="74,1" class="i method">ReadAndRemove</a>(<b>int</b> <span id="r48 rd" class="r48 r">readCount</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b7ff3e438aae63ed" class="i field">_data</a> != <b>null</b>, <span class="s">&quot;Collection cannot be null&quot;</span>);
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r48 r">readCount</span> &gt;= 0, <span class="s">&quot;ReadCount cannot be negative&quot;</span>);
 
            <b>int</b> <span id="r49 rd" class="r49 r">resolvedReadCount</span> = (<span class="r48 r">readCount</span> &gt; 0 ? <span class="r48 r">readCount</span> : <span class="i">Int32</span>.<span class="i">MaxValue</span>);
 
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <span class="c">// Copy the elements into a new collection</span>
                <span class="c">// and clear.</span>
                <span class="i">Collection</span>&lt;<span class="r4 r t">T</span>&gt; <span id="r50 rd" class="r50 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="r4 r t">T</span>&gt;();
 
                <b>for</b> (<b>int</b> <span id="r51 rd" class="r51 r">i</span> = 0; <span class="r51 r">i</span> &lt; <span class="r49 r">resolvedReadCount</span>; <span class="r51 r">i</span>++)
                {
                    <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="r50 r">result</span>.<span class="i">Add</span>(<a href="#b7ff3e438aae63ed" class="i field">_data</a>[0]);
                        <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">RemoveAt</span>(0);
                    }
                    <b>else</b>
                    {
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> &gt; 0 || !<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>)
                    {
                        <span class="c">// release all the waiting threads.</span>
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Set</span>();
                    }
                    <b>else</b>
                    {
                        <span class="c">// reset the handle so that future</span>
                        <span class="c">// threads will block</span>
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Reset</span>();
                    }
                }
 
                <b>return</b> <span class="r50 r">result</span>;
            }
        }
 
        <b>internal</b> <span class="r4 r t">T</span> <a id="ce4f3793890015ef" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReadAndRemoveAt0</a>()
        {
            <span class="r4 r t">T</span> <span id="r52 rd" class="r52 r">value</span> = <b>default</b>(<span class="r4 r t">T</span>);
 
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a> != <b>null</b> &amp;&amp; <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r52 r">value</span> = <a href="#b7ff3e438aae63ed" class="i field">_data</a>[0];
                    <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">RemoveAt</span>(0);
                }
            }
 
            <b>return</b> <span class="r52 r">value</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Virtual Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inserts an item into the buffer at a specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId of PowerShell instance adding this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty if not initiated by a PowerShell instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the buffer where the object is to be inserted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to be inserted into the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index specified is less than zero or greater</span>
        <span class="c">///</span><span class="c"> than Count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;ps&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;PS signifies PowerShell and is used at many places in the product.&quot;</span>)]
        <b>protected virtual void</b> <a id="ea92469bbe982f86" href="../../R/ea92469bbe982f86.html" target="n" data-glyph="75,1" class="i method">InsertItem</a>(<span class="i">Guid</span> <span id="r53 rd" class="r53 r">psInstanceId</span>, <b>int</b> <span id="r54 rd" class="r54 r">index</span>, <span class="r4 r t">T</span> <span id="r55 rd" class="r55 r">item</span>)
        {
            <a href="#60a5dc41d01c5be0" class="i method">RaiseDataAddingEvent</a>(<span class="r53 r">psInstanceId</span>, <span class="r55 r">item</span>);
 
            <b>if</b> (<a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a>)
            {
                <span class="r55 r">item</span> = (<span class="r4 r t">T</span>)(<b>object</b>)<a href="#7f87663d357194d7" class="i method">GetSerializedObject</a>(<span class="r55 r">item</span>);
            }
 
            <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Insert</span>(<span class="r54 r">index</span>, <span class="r55 r">item</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the item at a specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the buffer where the object is to be removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index specified is less than zero or greater</span>
        <span class="c">///</span><span class="c"> than the number of items in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="accb55df6508c7bc" href="../../R/accb55df6508c7bc.html" target="n" data-glyph="75,1" class="i method">RemoveItem</a>(<b>int</b> <span id="r56 rd" class="r56 r">index</span>)
        {
            <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">RemoveAt</span>(<span class="r56 r">index</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serializable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the ISerializable contract for serializing a PSDataCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The streaming context for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="a219c33cd30caed4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r57 rd" class="r57 r">info</span>, <span class="i">StreamingContext</span> <span id="r58 rd" class="r58 r">context</span>)
        {
            <b>if</b> (<span class="r57 r">info</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r57 r">info</span>));
            }
 
            <span class="r57 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;Data&quot;</span>, <a href="#b7ff3e438aae63ed" class="i field">_data</a>);
            <span class="r57 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;BlockingEnumerator&quot;</span>, <a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a>);
            <span class="r57 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;DataAddedCount&quot;</span>, <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a>);
            <span class="r57 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;EnumeratorNeverBlocks&quot;</span>, <a href="#227dd72a718dff74" class="i property">EnumeratorNeverBlocks</a>);
            <span class="r57 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;IsOpen&quot;</span>, <a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal/Private Methods and Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waitable handle for caller&#39;s to block until new data</span>
        <span class="c">///</span><span class="c"> is added to the underlying buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">WaitHandle</span> <a id="2ab7ec209735b92b" href="../../R/2ab7ec209735b92b.html" target="n" data-glyph="104,1" class="i property">WaitHandle</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                    {
                        <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> == <b>null</b>)
                        {
                            <span class="c">// Create the handle signaled if there are objects in the buffer</span>
                            <span class="c">// or the buffer has been closed.</span>
                            <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> &gt; 0 || !<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Utility method to signal handles and raise events</span>
        <span class="c">///</span><span class="c"> in the consistent order.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell InstanceId which added this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty, if the data is not added by a PowerShell</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Index at which the data is added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2bc662c00dd44444" href="../../R/2bc662c00dd44444.html" target="n" data-glyph="76,1" class="i method">RaiseEvents</a>(<span class="i">Guid</span> <span id="r59 rd" class="r59 r">psInstanceId</span>, <b>int</b> <span id="r60 rd" class="r60 r">index</span>)
        {
            <b>bool</b> <span id="r61 rd" class="r61 r">raiseDataAdded</span> = <b>false</b>;
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> != <b>null</b>)
                {
                    <span class="c">// TODO: Should ObjectDisposedException be caught.</span>
 
                    <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span> &gt; 0 || !<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>)
                    {
                        <span class="c">// release all the waiting threads.</span>
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Set</span>();
                    }
                    <b>else</b>
                    {
                        <span class="c">// reset the handle so that future</span>
                        <span class="c">// threads will block</span>
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Reset</span>();
                    }
                }
                <span class="c">// release any threads to notify an event. Enumerator</span>
                <span class="c">// blocks on this syncObject.</span>
                <span class="i">Monitor</span>.<span class="i">PulseAll</span>(<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
 
                <a href="#74772ad02b64919e" class="i field">_countNewData</a>++;
                <b>if</b> (<a href="#74772ad02b64919e" class="i field">_countNewData</a> &gt;= <a href="#4a6983899d1daf1f" class="i field">_dataAddedFrequency</a> || (<a href="#74772ad02b64919e" class="i field">_countNewData</a> &gt; 0 &amp;&amp; !<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>))
                {
                    <span class="r61 r">raiseDataAdded</span> = <b>true</b>;
                    <a href="#74772ad02b64919e" class="i field">_countNewData</a> = 0;
                }
                <b>else</b>
                {
                    <span class="c">// store information in case _dataAddedFrequency is updated or collection completes</span>
                    <span class="c">// so that event may be raised using last added data.</span>
                    <a href="#be0f3424ead0d009" class="i field">_lastPsInstanceId</a> = <span class="r59 r">psInstanceId</span>;
                    <a href="#98a4fb2cf8e7e539" class="i field">_lastIndex</a> = <span class="r60 r">index</span>;
                }
            }
 
            <b>if</b> (<span class="r61 r">raiseDataAdded</span>)
            {
                <span class="c">// We should raise the event outside of the lock</span>
                <span class="c">// as the call is made into 3rd party code.</span>
                <a href="#88eee4d4db605140" class="i method">RaiseDataAddedEvent</a>(<span class="r59 r">psInstanceId</span>, <span class="r60 r">index</span>);
            }
        }
 
        <b>private</b> <span class="i">Guid</span> <a id="be0f3424ead0d009" href="../../R/be0f3424ead0d009.html" target="n" data-glyph="46,1" class="i field">_lastPsInstanceId</a>;
        <b>private int</b> <a id="98a4fb2cf8e7e539" href="../../R/98a4fb2cf8e7e539.html" target="n" data-glyph="46,1" class="i field">_lastIndex</a>;
 
        <b>private void</b> <a id="60a5dc41d01c5be0" href="../../R/60a5dc41d01c5be0.html" target="n" data-glyph="76,1" class="i method">RaiseDataAddingEvent</a>(<span class="i">Guid</span> <span id="r62 rd" class="r62 r">psInstanceId</span>, <b>object</b> <span id="r63 rd" class="r63 r">itemAdded</span>)
        {
            <span class="c">// A temporary variable is used as the DataAdding may</span>
            <span class="c">// reach null (because of -=&#39;s) after the null check</span>
            <a href="#43aaeadedbd395cd" class="i">DataAdding</a>?.<span class="i">Invoke</span>(<a href="#52e2b209c10ec0a4" class="k">this</a>, <b>new</b> <a href="#51c80776dde4212e" class="t constructor">DataAddingEventArgs</a>(<span class="r62 r">psInstanceId</span>, <span class="r63 r">itemAdded</span>));
        }
 
        <b>private void</b> <a id="88eee4d4db605140" href="../../R/88eee4d4db605140.html" target="n" data-glyph="76,1" class="i method">RaiseDataAddedEvent</a>(<span class="i">Guid</span> <span id="r64 rd" class="r64 r">psInstanceId</span>, <b>int</b> <span id="r65 rd" class="r65 r">index</span>)
        {
            <span class="c">// A temporary variable is used as the DataAdded may</span>
            <span class="c">// reach null (because of -=&#39;s) after the null check</span>
            <a href="#de98d172ff9dac86" class="i">DataAdded</a>?.<span class="i">Invoke</span>(<a href="#52e2b209c10ec0a4" class="k">this</a>, <b>new</b> <a href="#abfd119b0fcf801f" class="t constructor">DataAddedEventArgs</a>(<span class="r64 r">psInstanceId</span>, <span class="r65 r">index</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inserts an item into the buffer at a specified index.</span>
        <span class="c">///</span><span class="c"> The caller should make sure the method call is</span>
        <span class="c">///</span><span class="c"> synchronized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId of PowerShell instance adding this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty if this is not initiated by a PowerShell instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The zero-based index of the buffer where the object is</span>
        <span class="c">///</span><span class="c"> to be inserted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to be inserted into the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index specified is less than zero or greater</span>
        <span class="c">///</span><span class="c"> than Count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9a0790b54c243d3d" href="../../R/9a0790b54c243d3d.html" target="n" data-glyph="76,1" class="i method">InternalInsertItem</a>(<span class="i">Guid</span> <span id="r66 rd" class="r66 r">psInstanceId</span>, <b>int</b> <span id="r67 rd" class="r67 r">index</span>, <span class="r4 r t">T</span> <span id="r68 rd" class="r68 r">item</span>)
        {
            <b>if</b> (!<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSDataBufferStrings</span>.<span class="i">WriteToClosedBuffer</span>);
            }
 
            <a href="#ea92469bbe982f86" class="i method">InsertItem</a>(<span class="r66 r">psInstanceId</span>, <span class="r67 r">index</span>, <span class="r68 r">item</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an item to the thread-safe buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId of PowerShell instance adding this data.</span>
        <span class="c">///</span><span class="c"> Guid.Empty if this is not initiated by a PowerShell instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> item to add</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects cannot be added to a closed buffer.</span>
        <span class="c">///</span><span class="c"> Make sure the buffer is open for Add and Insert</span>
        <span class="c">///</span><span class="c"> operations to succeed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b1b46da97fd47307" href="../../R/b1b46da97fd47307.html" target="n" data-glyph="74,1" class="i method">InternalAdd</a>(<span class="i">Guid</span> <span id="r69 rd" class="r69 r">psInstanceId</span>, <span class="r4 r t">T</span> <span id="r70 rd" class="r70 r">item</span>)
        {
            <span class="c">// should not rely on data.Count in &quot;finally&quot;</span>
            <span class="c">// as another thread might add data</span>
            <b>int</b> <span id="r71 rd" class="r71 r">index</span> = -1;
 
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <span class="c">// Add the item and set to raise events</span>
                <span class="c">// so that events are raised outside of</span>
                <span class="c">// lock.</span>
                <span class="r71 r">index</span> = <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>;
                <a href="#9a0790b54c243d3d" class="i method">InternalInsertItem</a>(<span class="r69 r">psInstanceId</span>, <span class="r71 r">index</span>, <span class="r70 r">item</span>);
            }
 
            <b>if</b> (<span class="r71 r">index</span> &gt; -1)
            {
                <a href="#2bc662c00dd44444" class="i method">RaiseEvents</a>(<span class="r69 r">psInstanceId</span>, <span class="r71 r">index</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the elements of an ICollection to the end of the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId of PowerShell instance adding this data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">collection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ICollection whose elements should be added to the end of</span>
        <span class="c">///</span><span class="c"> the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">collection</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="dde1539fcf09ddba" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">InternalAddRange</a>(<span class="i">Guid</span> <span id="r72 rd" class="r72 r">psInstanceId</span>, <span class="i">ICollection</span> <span id="r73 rd" class="r73 r">collection</span>)
        {
            <b>if</b> (<span class="r73 r">collection</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r73 r">collection</span>));
            }
 
            <b>int</b> <span id="r74 rd" class="r74 r">index</span> = -1;
            <b>bool</b> <span id="r75 rd" class="r75 r">raiseEvents</span> = <b>false</b>;
 
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>if</b> (!<a href="#49a4e1dbfdd199fc" class="i field">_isOpen</a>)
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">PSDataBufferStrings</span>.<span class="i">WriteToClosedBuffer</span>);
                }
 
                <span class="r74 r">index</span> = <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>;
 
                <b>foreach</b> (<b>object</b> <span id="r76 rd" class="r76 r">o</span> <b>in</b> <span class="r73 r">collection</span>)
                {
                    <span class="i">InsertItem</span>(<span class="r72 r">psInstanceId</span>, <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>, (<span class="r4 r t">T</span>)<span class="r76 r">o</span>);
 
                    <span class="c">// set raise events if atleast one item is</span>
                    <span class="c">// added.</span>
                    <span class="r75 r">raiseEvents</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r75 r">raiseEvents</span>)
            {
                <a href="#2bc662c00dd44444" class="i method">RaiseEvents</a>(<span class="r72 r">psInstanceId</span>, <span class="r74 r">index</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Increment counter to keep track of active PowerShell instances</span>
        <span class="c">///</span><span class="c"> using this buffer. This is used only internally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="20fe51d62499cf69" href="../../R/20fe51d62499cf69.html" target="n" data-glyph="74,1" class="i method">AddRef</a>()
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <a href="#d7acdf85e8961b3e" class="i field">_refCount</a>++;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decrement counter to keep track of active PowerShell instances</span>
        <span class="c">///</span><span class="c"> using this buffer. This is used only internally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="737fb48bd51a18aa" href="../../R/737fb48bd51a18aa.html" target="n" data-glyph="74,1" class="i method">DecrementRef</a>()
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#d7acdf85e8961b3e" class="i field">_refCount</a> &gt; 0, <span class="s">&quot;RefCount cannot be &lt;= 0&quot;</span>);
 
                <a href="#d7acdf85e8961b3e" class="i field">_refCount</a>--;
                <b>if</b> (<a href="#d7acdf85e8961b3e" class="i field">_refCount</a> != 0 &amp;&amp; (!<a href="#03f0256ad8dadde9" class="i field">_blockingEnumerator</a> || <a href="#d7acdf85e8961b3e" class="i field">_refCount</a> != 1)) <b>return</b>;
 
                <span class="c">// release threads blocked on waithandle</span>
                <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> != <b>null</b>)
                {
                    <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Set</span>();
                }
 
                <span class="c">// release any threads to notify refCount is 0. Enumerator</span>
                <span class="c">// blocks on this syncObject and it needs to be notified</span>
                <span class="c">// when the count becomes 0.</span>
                <span class="i">Monitor</span>.<span class="i">PulseAll</span>(<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the index of first occurrence of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">item</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> in the buffer.</span>
        <span class="c">///</span><span class="c"> This method is not thread safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to locate in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 0 based index of item if found,</span>
        <span class="c">///</span><span class="c"> -1 otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private int</b> <a id="31a6b88cd802a47f" href="../../R/31a6b88cd802a47f.html" target="n" data-glyph="76,1" class="i method">InternalIndexOf</a>(<span class="r4 r t">T</span> <span id="r77 rd" class="r77 r">item</span>)
        {
            <b>if</b> (<a href="#f15bd5fefcc7f57b" class="i field">_serializeInput</a>)
            {
                <span class="r77 r">item</span> = (<span class="r4 r t">T</span>)(<b>object</b>)<a href="#7f87663d357194d7" class="i method">GetSerializedObject</a>(<span class="r77 r">item</span>);
            }
 
            <b>int</b> <span id="r78 rd" class="r78 r">count</span> = <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Count</span>;
            <b>for</b> (<b>int</b> <span id="r79 rd" class="r79 r">index</span> = 0; <span class="r79 r">index</span> &lt; <span class="r78 r">count</span>; <span class="r79 r">index</span>++)
            {
                <b>if</b> (<b>object</b>.<span class="i">Equals</span>(<a href="#b7ff3e438aae63ed" class="i field">_data</a>[<span class="r79 r">index</span>], <span class="r77 r">item</span>))
                {
                    <b>return</b> <span class="r79 r">index</span>;
                }
            }
 
            <b>return</b> -1;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">value</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is of type T.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Value to verify.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value reference is null.</span>
        <span class="c">///</span><span class="c"> (or)</span>
        <span class="c">///</span><span class="c"> value is not of the correct generic type T for the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="30a18176d7b31bab" href="../../R/30a18176d7b31bab.html" target="n" data-glyph="76,1" class="i method">VerifyValueType</a>(<b>object</b> <span id="r80 rd" class="r80 r">value</span>)
        {
            <b>if</b> (<span class="r80 r">value</span> == <b>null</b>)
            {
                <b>if</b> (<b>typeof</b>(<span class="r4 r t">T</span>).<span class="i">IsValueType</span>)
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<span class="r80 r">value</span>), <span class="i">PSDataBufferStrings</span>.<span class="i">ValueNullReference</span>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r80 r">value</span> <b>is not</b> <span class="r4 r t">T</span>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r80 r">value</span>), <span class="i">PSDataBufferStrings</span>.<span class="i">CannotConvertToGenericType</span>,
                                                         <span class="r80 r">value</span>.<span class="i">GetType</span>().<span class="i">FullName</span>,
                                                         <b>typeof</b>(<span class="r4 r t">T</span>).<span class="i">FullName</span>);
            }
        }
 
        <span class="c">// Serializes an object, as long as it&#39;s not serialized.</span>
        <b>private static</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="7f87663d357194d7" href="../../R/7f87663d357194d7.html" target="n" data-glyph="76,1" class="i method">GetSerializedObject</a>(<b>object</b> <span id="r81 rd" class="r81 r">value</span>)
        {
            <span class="c">// This is a safe cast, as this method is only called with &quot;SerializeInput&quot; is set,</span>
            <span class="c">// and that method throws if the collection type is not PSObject.</span>
            <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r82 rd" class="r82 r">result</span> = <span class="r81 r">value</span> <b>as</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
 
            <span class="c">// Check if serialization would be idempotent</span>
            <b>if</b> (<a href="#e892d58451750387" class="i method">SerializationWouldHaveNoEffect</a>(<span class="r82 r">result</span>))
            {
                <b>return</b> <span class="r82 r">result</span>;
            }
            <b>else</b>
            {
                <b>object</b> <span id="r83 rd" class="r83 r">deserialized</span> = <a href="../serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="../serialization.cs.html#d9210d35690d435f" class="i method">Deserialize</a>(<a href="../serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="../serialization.cs.html#a542e9acc69529dc" class="i method">Serialize</a>(<span class="r81 r">value</span>));
                <b>if</b> (<span class="r83 r">deserialized</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
                <b>else</b>
                {
                    <b>return</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r83 r">deserialized</span>);
                }
            }
        }
 
        <b>private static bool</b> <a id="e892d58451750387" href="../../R/e892d58451750387.html" target="n" data-glyph="76,1" class="i method">SerializationWouldHaveNoEffect</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r84 rd" class="r84 r">result</span>)
        {
            <b>if</b> (<span class="r84 r">result</span> == <b>null</b>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>object</b> <span id="r85 rd" class="r85 r">baseObject</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r84 r">result</span>);
            <b>if</b> (<span class="r85 r">baseObject</span> == <b>null</b>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Check if it&#39;s a primitive known type</span>
            <b>if</b> (<a href="../serialization.cs.html#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">IsPrimitiveKnownType</span>(<span class="r85 r">baseObject</span>.<span class="i">GetType</span>()))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Check if it&#39;s a CIM type</span>
            <b>if</b> (<span class="r85 r">baseObject</span> <b>is</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimInstance</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Check if it&#39;s got &quot;Deserialized&quot; in its type name</span>
            <b>if</b> (<span class="r84 r">result</span>.<a href="../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>[0].<span class="i">StartsWith</span>(<span class="s">&quot;Deserialized&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sync object for this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="596a9323fba4a085" href="../../R/596a9323fba4a085.html" target="n" data-glyph="104,1" class="i property">SyncObject</a> { <b>get</b>; } = <b>new</b> <b>object</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reference count variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="68315a50cebc018a" href="../../R/68315a50cebc018a.html" target="n" data-glyph="104,1" class="i property">RefCount</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d7acdf85e8961b3e" class="i field">_refCount</a>;
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <a href="#d7acdf85e8961b3e" class="i field">_refCount</a> = <b>value</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Idle event
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether or not the collection should pulse idle events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a32b8c985495b0af" href="../../R/a32b8c985495b0af.html" target="n" data-glyph="104,1" class="i property">PulseIdleEvent</a>
        {
            <b>get</b> { <b>return</b> (<a href="#b559750a12dea9d1" class="i">IdleEvent</a> != <b>null</b>); }
        }
 
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<span class="i">EventArgs</span>&gt; <a id="b559750a12dea9d1" href="../../R/b559750a12dea9d1.html" target="n" data-glyph="32,1" class="i">IdleEvent</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Fires an idle event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c84c88ebdb1f1146" href="../../R/c84c88ebdb1f1146.html" target="n" data-glyph="74,1" class="i method">FireIdleEvent</a>()
        {
            <a href="#b559750a12dea9d1" class="i">IdleEvent</a>.<span class="i">SafeInvoke</span>(<a href="#52e2b209c10ec0a4" class="k">this</a>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pulses the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="06dc3c236b950394" href="../../R/06dc3c236b950394.html" target="n" data-glyph="74,1" class="i method">Pulse</a>()
        {
            <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <span class="i">Monitor</span>.<span class="i">PulseAll</span>(<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="17fb91187cc003fd" href="../../R/17fb91187cc003fd.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#ed37c7234910e3fc" class="i method">Dispose</a>(<b>true</b>);
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#52e2b209c10ec0a4" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all the resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, release all managed resources.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="ed37c7234910e3fc" href="../../R/ed37c7234910e3fc.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r86 rd" class="r86 r">disposing</span>)
        {
            <b>if</b> (<span class="r86 r">disposing</span>)
            {
                <b>if</b> (<a href="#8fa67a7994a3094a" class="i field">_isDisposed</a>)
                {
                    <b>return</b>;
                }
 
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>if</b> (<a href="#8fa67a7994a3094a" class="i field">_isDisposed</a>)
                    {
                        <b>return</b>;
                    }
 
                    <a href="#8fa67a7994a3094a" class="i field">_isDisposed</a> = <b>true</b>;
                }
 
                <a href="#0a8262d798e33fc6" class="i method">Complete</a>();
 
                <b>lock</b> (<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
                {
                    <b>if</b> (<a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> != <b>null</b>)
                    {
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a>.<span class="i">Dispose</span>();
                        <a href="#1367c13407dbb3df" class="i field">_readWaitHandle</a> = <b>null</b>;
                    }
 
                    <b>if</b> (<a href="#b7ff3e438aae63ed" class="i field">_data</a> != <b>null</b>)
                    {
                        <a href="#b7ff3e438aae63ed" class="i field">_data</a>.<span class="i">Clear</span>();
                    }
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Overrides
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Interface to support PSDataCollectionEnumerator.</span>
    <span class="c">///</span><span class="c"> Needed to provide a way to get to the non-blocking</span>
    <span class="c">///</span><span class="c"> MoveNext implementation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal interface</b> <a id="f5fb0c031dd75f97" href="../../R/f5fb0c031dd75f97.html" target="n" data-glyph="50,0" class="t t">IBlockingEnumerator</a>&lt;<b>out</b> <span id="r87 rd t" class="r87 r t">T</span>&gt; : <span class="i">IEnumerator</span>&lt;<span class="r87 r t">T</span>&gt;
    {
        <b>bool</b> <a id="715ce037d075bc7f" href="../../R/715ce037d075bc7f.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>(<b>bool</b> <span id="r88 rd" class="r88 r">block</span>);
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSDataCollectionEnumerator
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enumerator for PSDataCollection. This enumerator blocks until</span>
    <span class="c">///</span><span class="c"> either all the PowerShell operations are completed or the</span>
    <span class="c">///</span><span class="c"> PSDataCollection is closed.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="9f9af4f87c578d39" href="../../R/9f9af4f87c578d39.html" target="n" data-glyph="2,0" class="t t">PSDataCollectionEnumerator</a>&lt;<span id="r89 rd t" class="r89 r t">T</span>&gt; : <a href="#f5fb0c031dd75f97" class="t t">IBlockingEnumerator</a>&lt;<span class="r89 r t">T</span>&gt;
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <span class="r89 r t">T</span> <a id="3b37849f4f86decf" href="../../R/3b37849f4f86decf.html" target="n" data-glyph="46,1" class="i field">_currentElement</a>;
        <b>private int</b> <a id="485c3889ee1f94ee" href="../../R/485c3889ee1f94ee.html" target="n" data-glyph="46,1" class="i field">_index</a>;
        <b>private readonly</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r89 r t">T</span>&gt; <a id="d3752653b645b6f0" href="../../R/d3752653b645b6f0.html" target="n" data-glyph="46,1" class="i field">_collToEnumerate</a>;
        <b>private readonly bool</b> <a id="331b891de81765a8" href="../../R/331b891de81765a8.html" target="n" data-glyph="46,1" class="i field">_neverBlock</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">collection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSDataCollection to enumerate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">neverBlock</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Controls if the enumerator is blocking by default or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e55c9c05c9e0d495" href="../../R/e55c9c05c9e0d495.html" target="n" data-glyph="74,1" class="t constructor">PSDataCollectionEnumerator</a>(<a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<span class="r89 r t">T</span>&gt; <span id="r90 rd" class="r90 r">collection</span>, <b>bool</b> <span id="r91 rd" class="r91 r">neverBlock</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r90 r">collection</span> != <b>null</b>,
                <span class="s">&quot;Collection cannot be null&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<span class="r90 r">collection</span>.<a href="#964a56f986986159" class="i property">ReleaseOnEnumeration</a> || !<span class="r90 r">collection</span>.<a href="#fc975c8dd4d53ae0" class="i property">IsEnumerated</a>,
                <span class="s">&quot;shouldn&#39;t enumerate more than once if ReleaseOnEnumeration is true&quot;</span>);
 
            <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a> = <span class="r90 r">collection</span>;
            <a href="#485c3889ee1f94ee" class="i field">_index</a> = 0;
            <a href="#3b37849f4f86decf" class="i field">_currentElement</a> = <b>default</b>(<span class="r89 r t">T</span>);
            <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#fc975c8dd4d53ae0" class="i property">IsEnumerated</a> = <b>true</b>;
            <a href="#331b891de81765a8" class="i field">_neverBlock</a> = <span class="r91 r">neverBlock</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerator Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the element in the collection at the current position</span>
        <span class="c">///</span><span class="c"> of the enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For better performance, this property does not throw an exception</span>
        <span class="c">///</span><span class="c"> if the enumerator is positioned before the first element or after</span>
        <span class="c">///</span><span class="c"> the last element; the value of the property is undefined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="r89 r t">T</span> <span class="i">IEnumerator</span>&lt;<span class="r89 r t">T</span>&gt;.<a id="5cb32a7e57497cc9" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3b37849f4f86decf" class="i field">_currentElement</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the element in the collection at the current position</span>
        <span class="c">///</span><span class="c"> of the enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For better performance, this property does not throw an exception</span>
        <span class="c">///</span><span class="c"> if the enumerator is positioned before the first element or after</span>
        <span class="c">///</span><span class="c"> the last element; the value of the property is undefined.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public object</b> <a id="aad414c629a5004d" href="../../R/aad414c629a5004d.html" target="n" data-glyph="102,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3b37849f4f86decf" class="i field">_currentElement</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Advances the enumerator to the next element in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the enumerator successfully advanced to the next element;</span>
        <span class="c">///</span><span class="c"> otherwise, false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This will block if the original collection is attached to any</span>
        <span class="c">///</span><span class="c"> active PowerShell instances and the original collection is not</span>
        <span class="c">///</span><span class="c"> closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="6ef3ac0fe157db52" href="../../R/6ef3ac0fe157db52.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <b>return</b> <span class="i">MoveNext</span>(!<a href="#331b891de81765a8" class="i field">_neverBlock</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Advances the enumerator to the next element in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the enumerator successfully advanced to the next element;</span>
        <span class="c">///</span><span class="c"> otherwise, false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">block</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True - to block when no elements are available.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="f5eaaf998b260213" href="../../R/f5eaaf998b260213.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>(<b>bool</b> <span id="r92 rd" class="r92 r">block</span>)
        {
            <b>lock</b> (<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#596a9323fba4a085" class="i property">SyncObject</a>)
            {
                <b>while</b> (<b>true</b>)
                {
                    <b>if</b> (<a href="#485c3889ee1f94ee" class="i field">_index</a> &lt; <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#e7cb43bbebbb4aca" class="i property">Count</a>)
                    {
                        <a href="#3b37849f4f86decf" class="i field">_currentElement</a> = <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a><a href="#0fbfd44b65c14b0d">[</a><a href="#485c3889ee1f94ee" class="i field">_index</a>];
                        <b>if</b> (<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#964a56f986986159" class="i property">ReleaseOnEnumeration</a>)
                        {
                            <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a><a href="#0fbfd44b65c14b0d">[</a><a href="#485c3889ee1f94ee" class="i field">_index</a>] = <b>default</b>(<span class="r89 r t">T</span>);
                        }
 
                        <a href="#485c3889ee1f94ee" class="i field">_index</a>++;
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="c">// we have reached the end if either the collection is closed</span>
                    <span class="c">// or no powershell instance is bound to this collection.</span>
                    <b>if</b> ((<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#68315a50cebc018a" class="i property">RefCount</a> == 0) || (!<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#c160386455270a8f" class="i property">IsOpen</a>))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>if</b> (<span class="r92 r">block</span>)
                    {
                        <b>if</b> (<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#a32b8c985495b0af" class="i property">PulseIdleEvent</a>)
                        {
                            <a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#c84c88ebdb1f1146" class="i method">FireIdleEvent</a>();
                            <span class="i">Monitor</span>.<span class="i">Wait</span>(<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// using light-weight monitor to block the current thread instead</span>
                            <span class="c">// of AutoResetEvent. This saves using Kernel objects.</span>
                            <span class="i">Monitor</span>.<span class="i">Wait</span>(<a href="#d3752653b645b6f0" class="i field">_collToEnumerate</a>.<a href="#596a9323fba4a085" class="i property">SyncObject</a>);
                        }
                    }
                    <b>else</b>
                    {
                        <b>return</b> <b>false</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the enumerator to its initial position,</span>
        <span class="c">///</span><span class="c"> which is before the first element in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f6363299c2f887e3" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#3b37849f4f86decf" class="i field">_currentElement</a> = <b>default</b>(<span class="r89 r t">T</span>);
            <a href="#485c3889ee1f94ee" class="i field">_index</a> = 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>void</b> <span class="i">IDisposable</span>.<a id="146edb83fe15cf68" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Dispose</a>()
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class that represents various informational buffers like</span>
    <span class="c">///</span><span class="c"> verbose, debug, warning, progress, information used with command invocation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="b80567add938623b" href="../../R/b80567add938623b.html" target="n" data-glyph="2,0" class="t t">PSInformationalBuffers</a>
    {
        <b>private readonly</b> <span class="i">Guid</span> <a id="1ae3eb87159690cf" href="../../R/1ae3eb87159690cf.html" target="n" data-glyph="46,1" class="i field">_psInstanceId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">psInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Guid of Powershell instance creating this buffers.</span>
        <span class="c">///</span><span class="c"> Whenever an item is added to one of the buffers, this id is</span>
        <span class="c">///</span><span class="c"> used to notify the buffer about the PowerShell instance adding</span>
        <span class="c">///</span><span class="c"> this data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ebe3771b7babbbec" href="../../R/ebe3771b7babbbec.html" target="n" data-glyph="74,1" class="t constructor">PSInformationalBuffers</a>(<span class="i">Guid</span> <span id="r93 rd" class="r93 r">psInstanceId</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r93 r">psInstanceId</span> != <span class="i">Guid</span>.<span class="i">Empty</span>,
                <span class="s">&quot;PowerShell instance id cannot be Guid.Empty&quot;</span>);
 
            <a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a> = <span class="r93 r">psInstanceId</span>;
            <a href="#39b44d8a1ec926ae" class="i field">progress</a> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt;();
            <a href="#147ce785e8086eea" class="i field">verbose</a> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt;();
            <a href="#f470d96f95c79582" class="i field">debug</a> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt;();
            <a href="#d0aa35a60e8f5119" class="i property">Warning</a> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt;();
            <a href="#b9d573be12d08f30" class="i property">Information</a> = <b>new</b> <a href="#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt;();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods / Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A buffer representing Progress record objects of a PowerShell command invocation.</span>
        <span class="c">///</span><span class="c"> Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt; <a id="341f946731d5405f" href="../../R/341f946731d5405f.html" target="n" data-glyph="104,1" class="i property">Progress</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#39b44d8a1ec926ae" class="i field">progress</a>;
            }
 
            <b>set</b>
            {
                <a href="#39b44d8a1ec926ae" class="i field">progress</a> = <b>value</b>;
            }
        }
 
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt; <a id="39b44d8a1ec926ae" href="../../R/39b44d8a1ec926ae.html" target="n" data-glyph="44,1" class="i field">progress</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A buffer representing Verbose objects of a PowerShell command invocation.</span>
        <span class="c">///</span><span class="c"> Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt; <a id="f9d116c8a717eb2e" href="../../R/f9d116c8a717eb2e.html" target="n" data-glyph="104,1" class="i property">Verbose</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#147ce785e8086eea" class="i field">verbose</a>;
            }
 
            <b>set</b>
            {
                <a href="#147ce785e8086eea" class="i field">verbose</a> = <b>value</b>;
            }
        }
 
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt; <a id="147ce785e8086eea" href="../../R/147ce785e8086eea.html" target="n" data-glyph="44,1" class="i field">verbose</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A buffer representing Debug objects of a PowerShell command invocation.</span>
        <span class="c">///</span><span class="c"> Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt; <a id="428f5031eec1ab6d" href="../../R/428f5031eec1ab6d.html" target="n" data-glyph="104,1" class="i property">Debug</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f470d96f95c79582" class="i field">debug</a>;
            }
 
            <b>set</b>
            {
                <a href="#f470d96f95c79582" class="i field">debug</a> = <b>value</b>;
            }
        }
 
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt; <a id="f470d96f95c79582" href="../../R/f470d96f95c79582.html" target="n" data-glyph="44,1" class="i field">debug</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A buffer representing Warning objects of a PowerShell command invocation.</span>
        <span class="c">///</span><span class="c"> Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt; <a id="d0aa35a60e8f5119" href="../../R/d0aa35a60e8f5119.html" target="n" data-glyph="104,1" class="i property">Warning</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A buffer representing Information objects of a PowerShell command invocation.</span>
        <span class="c">///</span><span class="c"> Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt; <a id="b9d573be12d08f30" href="../../R/b9d573be12d08f30.html" target="n" data-glyph="104,1" class="i property">Information</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds item to the progress buffer.</span>
        <span class="c">///</span><span class="c"> The item is added to the buffer along with PowerShell InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="aa3c19985b179abd" href="../../R/aa3c19985b179abd.html" target="n" data-glyph="74,1" class="i method">AddProgress</a>(<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r94 rd" class="r94 r">item</span>)
        {
            <b>if</b> (<a href="#39b44d8a1ec926ae" class="i field">progress</a> != <b>null</b>)
            {
                <a href="#39b44d8a1ec926ae" class="i field">progress</a>.<a href="#b1b46da97fd47307" class="i method">InternalAdd</a>(<a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a>, <span class="r94 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds item to the verbose buffer.</span>
        <span class="c">///</span><span class="c"> The item is added to the buffer along with PowerShell InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ec3de9fc214e0f9a" href="../../R/ec3de9fc214e0f9a.html" target="n" data-glyph="74,1" class="i method">AddVerbose</a>(<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a> <span id="r95 rd" class="r95 r">item</span>)
        {
            <b>if</b> (<a href="#147ce785e8086eea" class="i field">verbose</a> != <b>null</b>)
            {
                <a href="#147ce785e8086eea" class="i field">verbose</a>.<a href="#b1b46da97fd47307" class="i method">InternalAdd</a>(<a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a>, <span class="r95 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds item to the debug buffer.</span>
        <span class="c">///</span><span class="c"> The item is added to the buffer along with PowerShell InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="37771eca1a6570ee" href="../../R/37771eca1a6570ee.html" target="n" data-glyph="74,1" class="i method">AddDebug</a>(<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a> <span id="r96 rd" class="r96 r">item</span>)
        {
            <b>if</b> (<a href="#f470d96f95c79582" class="i field">debug</a> != <b>null</b>)
            {
                <a href="#f470d96f95c79582" class="i field">debug</a>.<a href="#b1b46da97fd47307" class="i method">InternalAdd</a>(<a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a>, <span class="r96 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds item to the warning buffer.</span>
        <span class="c">///</span><span class="c"> The item is added to the buffer along with PowerShell InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3a6800a0b37b69e0" href="../../R/3a6800a0b37b69e0.html" target="n" data-glyph="74,1" class="i method">AddWarning</a>(<a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a> <span id="r97 rd" class="r97 r">item</span>)
        {
            <b>if</b> (<a href="#d0aa35a60e8f5119" class="i property">Warning</a> != <b>null</b>)
            {
                <a href="#d0aa35a60e8f5119" class="i property">Warning</a>.<a href="#b1b46da97fd47307" class="i method">InternalAdd</a>(<a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a>, <span class="r97 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds item to the information buffer.</span>
        <span class="c">///</span><span class="c"> The item is added to the buffer along with PowerShell InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="cfff1673f621713b" href="../../R/cfff1673f621713b.html" target="n" data-glyph="74,1" class="i method">AddInformation</a>(<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r98 rd" class="r98 r">item</span>)
        {
            <b>if</b> (<a href="#b9d573be12d08f30" class="i property">Information</a> != <b>null</b>)
            {
                <a href="#b9d573be12d08f30" class="i property">Information</a>.<a href="#b1b46da97fd47307" class="i method">InternalAdd</a>(<a href="#1ae3eb87159690cf" class="i field">_psInstanceId</a>, <span class="r98 r">item</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
