<!DOCTYPE html>
<html><head><title>History.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1903);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/hostifaces/History.cs" target="_top">engine\hostifaces\History.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains information about a single history entry.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="aa61f1e3135e278f" href="../../R/aa61f1e3135e278f.html" target="n" data-glyph="0,0" class="t t">HistoryInfo</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">pipelineId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of pipeline in which command associated</span>
        <span class="c">///</span><span class="c"> with this history entry is executed</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">cmdline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">status</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Status of pipeline execution.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">startTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">StartTime of execution.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">endTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">EndTime of execution.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6333dc4d5d03dd36" href="../../R/6333dc4d5d03dd36.html" target="n" data-glyph="74,1" class="t constructor">HistoryInfo</a>(<b>long</b> <span id="r0 rd" class="r0 r">pipelineId</span>, <b>string</b> <span id="r1 rd" class="r1 r">cmdline</span>, <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r2 rd" class="r2 r">status</span>, <span class="i">DateTime</span> <span id="r3 rd" class="r3 r">startTime</span>, <span class="i">DateTime</span> <span id="r4 rd" class="r4 r">endTime</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r1 r">cmdline</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="#9df56725a3627aa2" class="i field">_pipelineId</a> = <span class="r0 r">pipelineId</span>;
            <a href="#8a8406b2b45fb781" class="i property">CommandLine</a> = <span class="r1 r">cmdline</span>;
            <a href="#303615db9877f45e" class="i property">ExecutionStatus</a> = <span class="r2 r">status</span>;
            <a href="#164440c04f6e0189" class="i property">StartExecutionTime</a> = <span class="r3 r">startTime</span>;
            <a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a> = <span class="r4 r">endTime</span>;
            <a href="#30c4c35dab843ce6" class="i property">Cleared</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor to support cloning.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">history</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a id="a76ae8509478374f" href="../../R/a76ae8509478374f.html" target="n" data-glyph="76,1" class="t constructor">HistoryInfo</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r5 rd" class="r5 r">history</span>)
        {
            <a href="#576ca37cb614e248" class="i property">Id</a> = <span class="r5 r">history</span>.<a href="#576ca37cb614e248" class="i property">Id</a>;
            <a href="#9df56725a3627aa2" class="i field">_pipelineId</a> = <span class="r5 r">history</span>.<a href="#9df56725a3627aa2" class="i field">_pipelineId</a>;
            <a href="#8a8406b2b45fb781" class="i property">CommandLine</a> = <span class="r5 r">history</span>.<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>;
            <a href="#303615db9877f45e" class="i property">ExecutionStatus</a> = <span class="r5 r">history</span>.<a href="#303615db9877f45e" class="i property">ExecutionStatus</a>;
            <a href="#164440c04f6e0189" class="i property">StartExecutionTime</a> = <span class="r5 r">history</span>.<a href="#164440c04f6e0189" class="i property">StartExecutionTime</a>;
            <a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a> = <span class="r5 r">history</span>.<a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a>;
            <a href="#30c4c35dab843ce6" class="i property">Cleared</a> = <span class="r5 r">history</span>.<a href="#30c4c35dab843ce6" class="i property">Cleared</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id of this history entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public long</b> <a id="576ca37cb614e248" href="../../R/576ca37cb614e248.html" target="n" data-glyph="102,1" class="i property">Id</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CommandLine string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8a8406b2b45fb781" href="../../R/8a8406b2b45fb781.html" target="n" data-glyph="102,1" class="i property">CommandLine</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution status of associated pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <a id="303615db9877f45e" href="../../R/303615db9877f45e.html" target="n" data-glyph="102,1" class="i property">ExecutionStatus</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start time of execution of associated pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span> <a id="164440c04f6e0189" href="../../R/164440c04f6e0189.html" target="n" data-glyph="102,1" class="i property">StartExecutionTime</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> End time of execution of associated pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span> <a id="a6e609990b94c97e" href="../../R/a6e609990b94c97e.html" target="n" data-glyph="102,1" class="i property">EndExecutionTime</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The time it took to execute the associeated pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="85bfa3147df4e954" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Duration</a> =&gt; <a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a> - <a href="#164440c04f6e0189" class="i property">StartExecutionTime</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override for ToString() method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="b39f660efad979ab" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>))
            {
                <b>return</b> <b>base</b>.<span class="i">ToString</span>();
            }
            <b>else</b>
            {
                <b>return</b> <a href="#8a8406b2b45fb781" class="i property">CommandLine</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cleared status of an entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="30c4c35dab843ce6" href="../../R/30c4c35dab843ce6.html" target="n" data-glyph="104,1" class="i property">Cleared</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets Id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ec2f874816810818" href="../../R/ec2f874816810818.html" target="n" data-glyph="74,1" class="i method">SetId</a>(<b>long</b> <span id="r6 rd" class="r6 r">id</span>) =&gt; <a href="#576ca37cb614e248" class="i property">Id</a> = <span class="r6 r">id</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set status.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">status</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0bdbf6b05f6adc16" href="../../R/0bdbf6b05f6adc16.html" target="n" data-glyph="74,1" class="i method">SetStatus</a>(<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r7 rd" class="r7 r">status</span>) =&gt; <a href="#303615db9877f45e" class="i property">ExecutionStatus</a> = <span class="r7 r">status</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set endtime.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">endTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9dd0418e9bc19309" href="../../R/9dd0418e9bc19309.html" target="n" data-glyph="74,1" class="i method">SetEndTime</a>(<span class="i">DateTime</span> <span id="r8 rd" class="r8 r">endTime</span>) =&gt; <a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a> = <span class="r8 r">endTime</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2d245012fa51452e" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetCommand</a>(<b>string</b> <span id="r9 rd" class="r9 r">command</span>) =&gt; <a href="#8a8406b2b45fb781" class="i property">CommandLine</a> = <span class="r9 r">command</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id of the pipeline corresponding to this history entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly long</b> <a id="9df56725a3627aa2" href="../../R/9df56725a3627aa2.html" target="n" data-glyph="46,1" class="i field">_pipelineId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a clone of this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <a id="15f41270aa99ec6d" href="../../R/15f41270aa99ec6d.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#a76ae8509478374f" class="t constructor">HistoryInfo</a>(<a href="#aa61f1e3135e278f" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements history and provides APIs for adding and fetching</span>
    <span class="c">///</span><span class="c"> entries from history.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="388c8ac2f3fdde97" href="../../R/388c8ac2f3fdde97.html" target="n" data-glyph="2,0" class="t t">History</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default history size.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="8a76f4b8b0040aa2" href="../../R/8a76f4b8b0040aa2.html" target="n" data-glyph="8,1" class="i field">DefaultHistorySize</a> = 4096;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs history store.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="88f5f3393b999def" href="../../R/88f5f3393b999def.html" target="n" data-glyph="74,1" class="t constructor">History</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r10 rd" class="r10 r">context</span>)
        {
            <span class="c">// Create history size variable. Add ValidateRangeAttribute to</span>
            <span class="c">// validate the range.</span>
            <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <span id="r11 rd" class="r11 r">attrs</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
            <span class="r11 r">attrs</span>.<span class="i">Add</span>(<b>new</b> <a href="../Attributes.cs.html#1f71b2faa1ad1737" class="t constructor">ValidateRangeAttribute</a>(1, (<b>int</b>)<span class="i">Int16</span>.<span class="i">MaxValue</span>));
            <a href="../ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r12 rd" class="r12 r">historySizeVar</span> = <b>new</b> <a href="../ShellVariable.cs.html#3ac543e1434ca630" class="t constructor">PSVariable</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#9aef43da82b8aa34" class="i field">HistorySize</a>, <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>, <a href="../ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="../ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <span class="r11 r">attrs</span>);
            <span class="r12 r">historySizeVar</span>.<a href="../ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> = <span class="i">SessionStateStrings</span>.<span class="i">MaxHistoryCountDescription</span>;
 
            <span class="r10 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../SessionStateVariableAPIs.cs.html#8dc502ca6f48c743" class="i method">SetVariable</a>(<span class="r12 r">historySizeVar</span>, <b>false</b>, <a href="../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
 
            <a href="#8802d745091b3ab6" class="i field">_capacity</a> = <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>;
            <a href="#ff02f9bb90a3c479" class="i field">_buffer</a> = <b>new</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[<a href="#8802d745091b3ab6" class="i field">_capacity</a>];
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new history entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">pipelineId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">cmdline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">status</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">startTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">endTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">skipIfLocked</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, the entry will not be added when the history is locked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Id for the new created entry. Use this id to fetch the</span>
        <span class="c">///</span><span class="c"> entry. Returns -1 if the entry is not added.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This function is thread safe</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal long</b> <a id="51ba806b689a8f7b" href="../../R/51ba806b689a8f7b.html" target="n" data-glyph="74,1" class="i method">AddEntry</a>(<b>long</b> <span id="r13 rd" class="r13 r">pipelineId</span>, <b>string</b> <span id="r14 rd" class="r14 r">cmdline</span>, <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r15 rd" class="r15 r">status</span>, <span class="i">DateTime</span> <span id="r16 rd" class="r16 r">startTime</span>, <span class="i">DateTime</span> <span id="r17 rd" class="r17 r">endTime</span>, <b>bool</b> <span id="r18 rd" class="r18 r">skipIfLocked</span>)
        {
            <b>if</b> (!<span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Monitor</span>.<span class="i">TryEnter</span>(<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>, <span class="r18 r">skipIfLocked</span> ? 0 : <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Timeout</span>.<span class="i">Infinite</span>))
            {
                <b>return</b> -1;
            }
 
            <b>try</b>
            {
                <a href="#ca16d8c09520f4d0" class="i method">ReallocateBufferIfNeeded</a>();
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r19 rd" class="r19 r">entry</span> = <b>new</b> <a href="#6333dc4d5d03dd36" class="t constructor">HistoryInfo</a>(<span class="r13 r">pipelineId</span>, <span class="r14 r">cmdline</span>, <span class="r15 r">status</span>, <span class="r16 r">startTime</span>, <span class="r17 r">endTime</span>);
                <b>return</b> <a href="#e902b9869c3a3dab" class="i method">Add</a>(<span class="r19 r">entry</span>);
            }
            <b>finally</b>
            {
                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Monitor</span>.<span class="i">Exit</span>(<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Update the history entry corresponding to id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of history entry to be updated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">status</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Status to be updated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">endTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">EndTime to be updated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">skipIfLocked</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, the entry will not be added when the history is locked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b24739fdbe5fdba3" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">UpdateEntry</a>(<b>long</b> <span id="r20 rd" class="r20 r">id</span>, <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r21 rd" class="r21 r">status</span>, <span class="i">DateTime</span> <span id="r22 rd" class="r22 r">endTime</span>, <b>bool</b> <span id="r23 rd" class="r23 r">skipIfLocked</span>)
        {
            <b>if</b> (!<span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Monitor</span>.<span class="i">TryEnter</span>(<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>, <span class="r23 r">skipIfLocked</span> ? 0 : <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Timeout</span>.<span class="i">Infinite</span>))
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r24 rd" class="r24 r">entry</span> = <a href="#161c3fdbb60d74bb" class="i method">CoreGetEntry</a>(<span class="r20 r">id</span>);
                <b>if</b> (<span class="r24 r">entry</span> != <b>null</b>)
                {
                    <span class="r24 r">entry</span>.<a href="#0bdbf6b05f6adc16" class="i method">SetStatus</a>(<span class="r21 r">status</span>);
                    <span class="r24 r">entry</span>.<a href="#9dd0418e9bc19309" class="i method">SetEndTime</a>(<span class="r22 r">endTime</span>);
                }
            }
            <b>finally</b>
            {
                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Monitor</span>.<span class="i">Exit</span>(<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets entry from buffer for given id. This id should be the</span>
        <span class="c">///</span><span class="c"> id returned by Add method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the entry to be fetched.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Entry corresponding to id if it is present else null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <a id="f0ac590fa434cc6a" href="../../R/f0ac590fa434cc6a.html" target="n" data-glyph="74,1" class="i method">GetEntry</a>(<b>long</b> <span id="r25 rd" class="r25 r">id</span>)
        {
            <b>lock</b> (<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>)
            {
                <a href="#ca16d8c09520f4d0" class="i method">ReallocateBufferIfNeeded</a>();
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r26 rd" class="r26 r">entry</span> = <a href="#161c3fdbb60d74bb" class="i method">CoreGetEntry</a>(<span class="r25 r">id</span>);
                <b>if</b> (<span class="r26 r">entry</span> != <b>null</b>)
                    <b>if</b> (!<span class="r26 r">entry</span>.<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                        <b>return</b> <span class="r26 r">entry</span>.<a href="#15f41270aa99ec6d" class="i method">Clone</a>();
 
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get count HistoryEntries.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">newest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">History entries.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <a id="b13fc58471a4745e" href="../../R/b13fc58471a4745e.html" target="n" data-glyph="74,1" class="i method">GetEntries</a>(<b>long</b> <span id="r27 rd" class="r27 r">id</span>, <b>long</b> <span id="r28 rd" class="r28 r">count</span>, <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <span id="r29 rd" class="r29 r">newest</span>)
        {
            <a href="#ca16d8c09520f4d0" class="i method">ReallocateBufferIfNeeded</a>();
 
            <b>if</b> (<span class="r28 r">count</span> &lt; -1)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#3ec1a8e5fa36a1b2" class="i method">NewArgumentOutOfRangeException</a>(<b>nameof</b>(<span class="r28 r">count</span>), <span class="r28 r">count</span>);
            }
 
            <b>if</b> (<span class="r29 r">newest</span>.<a href="../MshCmdlet.cs.html#e9f970ac2bab9866" class="i method">ToString</a>() == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r29 r">newest</span>));
            }
 
            <b>if</b> (<span class="r28 r">count</span> == -1 || <span class="r28 r">count</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a> || <span class="r28 r">count</span> &gt; <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>)
                <span class="r28 r">count</span> = <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>;
 
            <b>if</b> (<span class="r28 r">count</span> == 0 || <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> == 0)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>&gt;();
            }
 
            <b>lock</b> (<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>)
            {
                <span class="c">// Using list instead of an array to store the entries.With array we are getting null values</span>
                <span class="c">// when the historybuffer size is changed</span>
                <span class="i">List</span>&lt;<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>&gt; <span id="r30 rd" class="r30 r">entriesList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>&gt;();
                <b>if</b> (<span class="r27 r">id</span> &gt; 0)
                {
                    <b>long</b> <span id="r31 rd" class="r31 r">firstId</span>, <span id="r32 rd" class="r32 r">baseId</span>;
                    <span class="r32 r">baseId</span> = <span class="r27 r">id</span>;
 
                    <span class="c">// get id,count,newest values</span>
                    <b>if</b> (!<span class="r29 r">newest</span>.<a href="../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                    {
                        <span class="c">// get older entries</span>
 
                        <span class="c">// Calculate the first id (i.e lowest id to fetch)</span>
                        <span class="r31 r">firstId</span> = <span class="r32 r">baseId</span> - <span class="r28 r">count</span> + 1;
 
                        <span class="c">// If first id is less than the lowest id in history store,</span>
                        <span class="c">// assign lowest id as first ID</span>
                        <b>if</b> (<span class="r31 r">firstId</span> &lt; 1)
                        {
                            <span class="r31 r">firstId</span> = 1;
                        }
 
                        <b>for</b> (<b>long</b> <span id="r33 rd" class="r33 r">i</span> = <span class="r32 r">baseId</span>; <span class="r33 r">i</span> &gt;= <span class="r31 r">firstId</span>; --<span class="r33 r">i</span>)
                        {
                            <b>if</b> (<span class="r31 r">firstId</span> &lt;= 1) <b>break</b>;
                            <span class="c">// if entry is null , continue the loop with the next entry</span>
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r33 r">i</span>)] == <b>null</b>) <b>continue</b>;
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r33 r">i</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                            {
                                <span class="c">// we have to clear count entries before an id, so if an entry is null,decrement</span>
                                <span class="c">// first id as long as its is greater than the lowest entry in the buffer.</span>
                                <span class="r31 r">firstId</span>--;
                                <b>continue</b>;
                            }
                        }
 
                        <b>for</b> (<b>long</b> <span id="r34 rd" class="r34 r">i</span> = <span class="r31 r">firstId</span>; <span class="r34 r">i</span> &lt;= <span class="r32 r">baseId</span>; ++<span class="r34 r">i</span>)
                        {
                            <span class="c">// if an entry is null after being cleared by clear-history cmdlet,</span>
                            <span class="c">// continue with the next entry</span>
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r34 r">i</span>)] == <b>null</b> || <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r34 r">i</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                                <b>continue</b>;
                            <span class="r30 r">entriesList</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r34 r">i</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>());
                        }
                    }
                    <b>else</b>
                    { <span class="c">// get latest entries</span>
                        <span class="c">// first id becomes the id +count no of entries from the end of the buffer</span>
                        <span class="r31 r">firstId</span> = <span class="r32 r">baseId</span> + <span class="r28 r">count</span> - 1;
                        <span class="c">// if first id is more than the no of entries in the buffer, first id will be the last entry in the buffer</span>
                        <b>if</b> (<span class="r31 r">firstId</span> &gt;= <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>)
                        {
                            <span class="r31 r">firstId</span> = <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>;
                        }
 
                        <b>for</b> (<b>long</b> <span id="r35 rd" class="r35 r">i</span> = <span class="r32 r">baseId</span>; <span class="r35 r">i</span> &lt;= <span class="r31 r">firstId</span>; <span class="r35 r">i</span>++)
                        {
                            <b>if</b> (<span class="r31 r">firstId</span> &gt;= <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>) <b>break</b>;
                            <span class="c">// if entry is null , continue the loop with the next entry</span>
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r35 r">i</span>)] == <b>null</b>) <b>continue</b>;
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r35 r">i</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                            {
                                <span class="c">// we have to clear count entries before an id, so if an entry is null,increment first id</span>
                                <span class="r31 r">firstId</span>++;
                                <b>continue</b>;
                            }
                        }
 
                        <b>for</b> (<b>long</b> <span id="r36 rd" class="r36 r">i</span> = <span class="r31 r">firstId</span>; <span class="r36 r">i</span> &gt;= <span class="r32 r">baseId</span>; --<span class="r36 r">i</span>)
                        {
                            <span class="c">// if an entry is null after being cleared by clear-history cmdlet,</span>
                            <span class="c">// continue with the next entry</span>
                            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r36 r">i</span>)] == <b>null</b> || <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r36 r">i</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                                <b>continue</b>;
                            <span class="r30 r">entriesList</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r36 r">i</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>());
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="c">// get entries for count,newest</span>
 
                    <b>long</b> <span id="r37 rd" class="r37 r">index</span>, <span id="r38 rd" class="r38 r">SmallestID</span> = 0;
                    <span class="c">// if we change the defaulthistory size and when no of entries exceed the size, then</span>
                    <span class="c">// we need to get the smallest entry in the buffer when we want to clear the oldest entry</span>
                    <span class="c">// eg if size is 5 and then the entries can be 7,6,1,2,3</span>
                    <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                        <span class="r38 r">SmallestID</span> = <a href="#13ff98a254c2fc21" class="i method">SmallestIDinBuffer</a>();
                    <b>if</b> (!<span class="r29 r">newest</span>.<a href="../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                    {
                        <span class="c">// get oldest count entries</span>
                        <span class="r37 r">index</span> = 1;
                        <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                        {
                            <b>if</b> (<a href="#c32419457a577173" class="i field">_countEntriesAdded</a> &gt; <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                                <span class="r37 r">index</span> = <span class="r38 r">SmallestID</span>;
                        }
 
                        <b>for</b> (<b>long</b> <span id="r39 rd" class="r39 r">i</span> = <span class="r28 r">count</span> - 1; <span class="r39 r">i</span> &gt;= 0;)
                        {
                            <b>if</b> (<span class="r37 r">index</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>) <b>break</b>;
                            <b>if</b> ((<span class="r37 r">index</span> &lt;= 0 || <a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>) &gt;= <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>.<span class="i">Length</span>) ||
                                (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>))
                            {
                                <span class="r37 r">index</span>++; <b>continue</b>;
                            }
                            <b>else</b>
                            {
                                <span class="r30 r">entriesList</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>());
                                <span class="r39 r">i</span>--; <span class="r37 r">index</span>++;
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r37 r">index</span> = <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>; <span class="c">//SmallestIDinBuffer</span>
 
                        <b>for</b> (<b>long</b> <span id="r40 rd" class="r40 r">i</span> = <span class="r28 r">count</span> - 1; <span class="r40 r">i</span> &gt;= 0;)
                        {
                            <span class="c">// if an entry is cleared continue to the next entry</span>
                            <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                            {
                                <b>if</b> (<a href="#c32419457a577173" class="i field">_countEntriesAdded</a> &gt; <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                                {
                                    <b>if</b> (<span class="r37 r">index</span> &lt; <span class="r38 r">SmallestID</span>)
                                        <b>break</b>;
                                }
                            }
 
                            <b>if</b> (<span class="r37 r">index</span> &lt; 1) <b>break</b>;
                            <b>if</b> ((<span class="r37 r">index</span> &lt;= 0 || <a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>) &gt;= <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>.<span class="i">Length</span>) ||
                                (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>))
                            { <span class="r37 r">index</span>--; <b>continue</b>; }
                            <b>else</b>
                            {
                                <span class="c">// clone the entry from the history buffer</span>
                                <span class="r30 r">entriesList</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r37 r">index</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>());
                                <span class="r40 r">i</span>--; <span class="r37 r">index</span>--;
                            }
                        }
                    }
                }
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r41 rd" class="r41 r">entries</span> = <b>new</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[<span class="r30 r">entriesList</span>.<span class="i">Count</span>];
                <span class="r30 r">entriesList</span>.<span class="i">CopyTo</span>(<span class="r41 r">entries</span>);
                <b>return</b> <span class="r41 r">entries</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get History Entries based on the WildCard Pattern value.</span>
        <span class="c">///</span><span class="c"> If passed 0, returns all the values, else return on the basis of count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">wildcardpattern</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">newest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <a id="bbdb1ea5a02ea062" href="../../R/bbdb1ea5a02ea062.html" target="n" data-glyph="74,1" class="i method">GetEntries</a>(<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r42 rd" class="r42 r">wildcardpattern</span>, <b>long</b> <span id="r43 rd" class="r43 r">count</span>, <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <span id="r44 rd" class="r44 r">newest</span>)
        {
            <b>lock</b> (<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>)
            {
                <b>if</b> (<span class="r43 r">count</span> &lt; -1)
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#3ec1a8e5fa36a1b2" class="i method">NewArgumentOutOfRangeException</a>(<b>nameof</b>(<span class="r43 r">count</span>), <span class="r43 r">count</span>);
                }
 
                <b>if</b> (<span class="r44 r">newest</span>.<a href="../MshCmdlet.cs.html#e9f970ac2bab9866" class="i method">ToString</a>() == <b>null</b>)
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r44 r">newest</span>));
                }
 
                <b>if</b> (<span class="r43 r">count</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a> || <span class="r43 r">count</span> == -1)
                {
                    <span class="r43 r">count</span> = <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>;
                }
 
                <span class="i">List</span>&lt;<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>&gt; <span id="r45 rd" class="r45 r">cmdlist</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>&gt;();
                <b>long</b> <span id="r46 rd" class="r46 r">SmallestID</span> = 1;
                <span class="c">// if buffersize is changes,Get the smallest entry that&#39;s not cleared in the buffer</span>
                <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                    <span class="r46 r">SmallestID</span> = <a href="#13ff98a254c2fc21" class="i method">SmallestIDinBuffer</a>();
                <b>if</b> (<span class="r43 r">count</span> != 0)
                {
                    <b>if</b> (!<span class="r44 r">newest</span>.<a href="../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                    {
                        <b>long</b> <span id="r47 rd" class="r47 r">id</span> = 1;
                        <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                        {
                            <b>if</b> (<a href="#c32419457a577173" class="i field">_countEntriesAdded</a> &gt; <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                                <span class="r47 r">id</span> = <span class="r46 r">SmallestID</span>;
                        }
 
                        <b>for</b> (<b>long</b> <span id="r48 rd" class="r48 r">i</span> = 0; <span class="r48 r">i</span> &lt;= <span class="r43 r">count</span> - 1;)
                        {
                            <b>if</b> (<span class="r47 r">id</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>) <b>break</b>;
                            <b>if</b> (!<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r47 r">id</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a> &amp;&amp; <span class="r42 r">wildcardpattern</span>.<span class="i">IsMatch</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r47 r">id</span>)].<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>.<span class="i">Trim</span>()))
                            {
                                <span class="r45 r">cmdlist</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r47 r">id</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>()); <span class="r48 r">i</span>++;
                            }
 
                            <span class="r47 r">id</span>++;
                        }
                    }
                    <b>else</b>
                    {
                        <b>long</b> <span id="r49 rd" class="r49 r">id</span> = <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>;
                        <b>for</b> (<b>long</b> <span id="r50 rd" class="r50 r">i</span> = 0; <span class="r50 r">i</span> &lt;= <span class="r43 r">count</span> - 1;)
                        {
                            <span class="c">// if buffersize is changed,we have to loop from max entry to min entry thats not cleared</span>
                            <b>if</b> (<a href="#8802d745091b3ab6" class="i field">_capacity</a> != <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>)
                            {
                                <b>if</b> (<a href="#c32419457a577173" class="i field">_countEntriesAdded</a> &gt; <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                                {
                                    <b>if</b> (<span class="r49 r">id</span> &lt; <span class="r46 r">SmallestID</span>)
                                        <b>break</b>;
                                }
                            }
 
                            <b>if</b> (<span class="r49 r">id</span> &lt; 1) <b>break</b>;
                            <b>if</b> (!<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r49 r">id</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a> &amp;&amp; <span class="r42 r">wildcardpattern</span>.<span class="i">IsMatch</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r49 r">id</span>)].<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>.<span class="i">Trim</span>()))
                            {
                                <span class="r45 r">cmdlist</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r49 r">id</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>()); <span class="r50 r">i</span>++;
                            }
 
                            <span class="r49 r">id</span>--;
                        }
                    }
                }
                <b>else</b>
                {
                    <b>for</b> (<b>long</b> <span id="r51 rd" class="r51 r">i</span> = 1; <span class="r51 r">i</span> &lt;= <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>; <span class="r51 r">i</span>++)
                    {
                        <b>if</b> (!<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r51 r">i</span>)].<a href="#30c4c35dab843ce6" class="i property">Cleared</a> &amp;&amp; <span class="r42 r">wildcardpattern</span>.<span class="i">IsMatch</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r51 r">i</span>)].<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>.<span class="i">Trim</span>()))
                        {
                            <span class="r45 r">cmdlist</span>.<span class="i">Add</span>(<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r51 r">i</span>)].<a href="#15f41270aa99ec6d" class="i method">Clone</a>());
                        }
                    }
                }
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r52 rd" class="r52 r">entries</span> = <b>new</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[<span class="r45 r">cmdlist</span>.<span class="i">Count</span>];
                <span class="r45 r">cmdlist</span>.<span class="i">CopyTo</span>(<span class="r52 r">entries</span>);
                <b>return</b> <span class="r52 r">entries</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the history entry from buffer for a given id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the entry to be Cleared.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Nothing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3f5a9ebac20297a0" href="../../R/3f5a9ebac20297a0.html" target="n" data-glyph="74,1" class="i method">ClearEntry</a>(<b>long</b> <span id="r53 rd" class="r53 r">id</span>)
        {
            <b>lock</b> (<a href="#4ba375b982ebad6d" class="i field">_syncRoot</a>)
            {
                <b>if</b> (<span class="r53 r">id</span> &lt; 0)
                {
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#3ec1a8e5fa36a1b2" class="i method">NewArgumentOutOfRangeException</a>(<b>nameof</b>(<span class="r53 r">id</span>), <span class="r53 r">id</span>);
                }
                <span class="c">// no entries are present to clear</span>
                <b>if</b> (<a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> == 0)
                    <b>return</b>;
 
                <span class="c">// throw an exception if id is out of range</span>
                <b>if</b> (<span class="r53 r">id</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>)
                {
                    <b>return</b>;
                }
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r54 rd" class="r54 r">entry</span> = <a href="#161c3fdbb60d74bb" class="i method">CoreGetEntry</a>(<span class="r53 r">id</span>);
                <b>if</b> (<span class="r54 r">entry</span> != <b>null</b>)
                {
                    <span class="r54 r">entry</span>.<a href="#30c4c35dab843ce6" class="i property">Cleared</a> = <b>true</b>;
                    <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>--;
                }
 
                <b>return</b>;
            }
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> gets the total number of entries added</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">count of total entries added.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="781fac034fbab821" href="../../R/781fac034fbab821.html" target="n" data-glyph="74,1" class="i method">Buffercapacity</a>()
        {
            <b>return</b> <a href="#8802d745091b3ab6" class="i field">_capacity</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an entry to the buffer. If buffer is full, overwrites</span>
        <span class="c">///</span><span class="c"> oldest entry in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns id for the entry. This id should be used to fetch</span>
        <span class="c">///</span><span class="c"> the entry from the buffer.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Id starts from 1 and is incremented by 1 for each new entry</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private long</b> <a id="e902b9869c3a3dab" href="../../R/e902b9869c3a3dab.html" target="n" data-glyph="76,1" class="i method">Add</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r55 rd" class="r55 r">entry</span>)
        {
            <b>if</b> (<span class="r55 r">entry</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r55 r">entry</span>));
            }
 
            <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#f8deedb820a672f4" class="i method">GetIndexForNewEntry</a>()] = <span class="r55 r">entry</span>;
 
            <span class="c">// Increment count of entries added so far</span>
            <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>++;
 
            <span class="c">// Id of an entry in history is same as its number in history store.</span>
            <span class="r55 r">entry</span>.<a href="#ec2f874816810818" class="i method">SetId</a>(<a href="#c32419457a577173" class="i field">_countEntriesAdded</a>);
 
            <span class="c">// Increment count of entries in buffer by 1</span>
            <a href="#1c90e3f396a550ff" class="i method">IncrementCountOfEntriesInBuffer</a>();
 
            <b>return</b> <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets entry from buffer for given id. This id should be the</span>
        <span class="c">///</span><span class="c"> id returned by Add method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the entry to be fetched.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Entry corresponding to id if it is present else null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <a id="161c3fdbb60d74bb" href="../../R/161c3fdbb60d74bb.html" target="n" data-glyph="76,1" class="i method">CoreGetEntry</a>(<b>long</b> <span id="r56 rd" class="r56 r">id</span>)
        {
            <b>if</b> (<span class="r56 r">id</span> &lt;= 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#3ec1a8e5fa36a1b2" class="i method">NewArgumentOutOfRangeException</a>(<b>nameof</b>(<span class="r56 r">id</span>), <span class="r56 r">id</span>);
            }
 
            <b>if</b> (<a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> == 0)
                <b>return</b> <b>null</b>;
            <b>if</b> (<span class="r56 r">id</span> &gt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>)
            {
                <b>return</b> <b>null</b>;
            }
            <span class="c">// if (_buffer[GetIndexFromId(id)].Cleared == false )</span>
            <b>return</b> <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r56 r">id</span>)];
            <span class="c">// else</span>
            <span class="c">//    return null;</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the smallest id in the buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private long</b> <a id="13ff98a254c2fc21" href="../../R/13ff98a254c2fc21.html" target="n" data-glyph="76,1" class="i method">SmallestIDinBuffer</a>()
        {
            <b>long</b> <span id="r57 rd" class="r57 r">minID</span> = 0;
            <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a> == <b>null</b>)
                <b>return</b> <span class="r57 r">minID</span>;
            <b>for</b> (<b>int</b> <span id="r58 rd" class="r58 r">i</span> = 0; <span class="r58 r">i</span> &lt; <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>.<span class="i">Length</span>; <span class="r58 r">i</span>++)
            {
                <span class="c">// assign the first entry in the buffer as min.</span>
                <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r58 r">i</span>] != <b>null</b> &amp;&amp; !<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r58 r">i</span>].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                {
                    <span class="r57 r">minID</span> = <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r58 r">i</span>].<a href="#576ca37cb614e248" class="i property">Id</a>;
                    <b>break</b>;
                }
            }
            <span class="c">// check for the minimum id that is not cleared</span>
            <b>for</b> (<b>int</b> <span id="r59 rd" class="r59 r">i</span> = 0; <span class="r59 r">i</span> &lt; <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>.<span class="i">Length</span>; <span class="r59 r">i</span>++)
            {
                <b>if</b> (<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r59 r">i</span>] != <b>null</b> &amp;&amp; !<a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r59 r">i</span>].<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                    <b>if</b> (<span class="r57 r">minID</span> &gt; <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r59 r">i</span>].<a href="#576ca37cb614e248" class="i property">Id</a>)
                        <span class="r57 r">minID</span> = <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<span class="r59 r">i</span>].<a href="#576ca37cb614e248" class="i property">Id</a>;
            }
 
            <b>return</b> <span class="r57 r">minID</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reallocates the buffer if history size changed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ca16d8c09520f4d0" href="../../R/ca16d8c09520f4d0.html" target="n" data-glyph="76,1" class="i method">ReallocateBufferIfNeeded</a>()
        {
            <span class="c">// Get current value of histoysize variable</span>
            <b>int</b> <span id="r60 rd" class="r60 r">historySize</span> = <a href="#9a8c6eba9c21f6f3" class="i method">GetHistorySize</a>();
 
            <b>if</b> (<span class="r60 r">historySize</span> == <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                <b>return</b>;
 
            <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r61 rd" class="r61 r">tempBuffer</span> = <b>new</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[<span class="r60 r">historySize</span>];
 
            <span class="c">// Calculate number of entries to copy in new buffer.</span>
            <b>int</b> <span id="r62 rd" class="r62 r">numberOfEntries</span> = <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>;
 
            <span class="c">// when buffer size is changed,we have to consider the totalnumber of entries added</span>
            <b>if</b> (<span class="r62 r">numberOfEntries</span> &lt; <a href="#c32419457a577173" class="i field">_countEntriesAdded</a>)
                <span class="r62 r">numberOfEntries</span> = (<b>int</b>)<a href="#c32419457a577173" class="i field">_countEntriesAdded</a>;
 
            <b>if</b> (<a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> &gt; <span class="r60 r">historySize</span>)
                <span class="r62 r">numberOfEntries</span> = <span class="r60 r">historySize</span>;
 
            <b>for</b> (<b>int</b> <span id="r63 rd" class="r63 r">i</span> = <span class="r62 r">numberOfEntries</span>; <span class="r63 r">i</span> &gt; 0; --<span class="r63 r">i</span>)
            {
                <b>long</b> <span id="r64 rd" class="r64 r">nextId</span> = <a href="#c32419457a577173" class="i field">_countEntriesAdded</a> - <span class="r63 r">i</span> + 1;
 
                <span class="r61 r">tempBuffer</span>[<a href="#63fcf04b6d05a963" class="i method">GetIndexFromId</a>(<span class="r64 r">nextId</span>, <span class="r60 r">historySize</span>)] = <a href="#ff02f9bb90a3c479" class="i field">_buffer</a>[<a href="#8f4ef33fe789b897" class="i method">GetIndexFromId</a>(<span class="r64 r">nextId</span>)];
            }
 
            <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> = <span class="r62 r">numberOfEntries</span>;
            <a href="#8802d745091b3ab6" class="i field">_capacity</a> = <span class="r60 r">historySize</span>;
            <a href="#ff02f9bb90a3c479" class="i field">_buffer</a> = <span class="r61 r">tempBuffer</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the index for new entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Index for new entry.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private int</b> <a id="f8deedb820a672f4" href="../../R/f8deedb820a672f4.html" target="n" data-glyph="76,1" class="i method">GetIndexForNewEntry</a>()
        {
            <b>return</b> (<b>int</b>)(<a href="#c32419457a577173" class="i field">_countEntriesAdded</a> % <a href="#8802d745091b3ab6" class="i field">_capacity</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets index in buffer for an entry with given Id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private int</b> <a id="8f4ef33fe789b897" href="../../R/8f4ef33fe789b897.html" target="n" data-glyph="76,1" class="i method">GetIndexFromId</a>(<b>long</b> <span id="r65 rd" class="r65 r">id</span>)
        {
            <b>return</b> (<b>int</b>)((<span class="r65 r">id</span> - 1) % <a href="#8802d745091b3ab6" class="i field">_capacity</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets index in buffer for an entry with given Id using passed in</span>
        <span class="c">///</span><span class="c"> capacity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">capacity</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="63fcf04b6d05a963" href="../../R/63fcf04b6d05a963.html" target="n" data-glyph="76,1" class="i method">GetIndexFromId</a>(<b>long</b> <span id="r66 rd" class="r66 r">id</span>, <b>int</b> <span id="r67 rd" class="r67 r">capacity</span>)
        {
            <b>return</b> (<b>int</b>)((<span class="r66 r">id</span> - 1) % <span class="r67 r">capacity</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Increment number of entries in buffer by 1.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1c90e3f396a550ff" href="../../R/1c90e3f396a550ff.html" target="n" data-glyph="76,1" class="i method">IncrementCountOfEntriesInBuffer</a>()
        {
            <b>if</b> (<a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a> &lt; <a href="#8802d745091b3ab6" class="i field">_capacity</a>)
                <a href="#451c865195e0f686" class="i field">_countEntriesInBuffer</a>++;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the current history size.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="9a8c6eba9c21f6f3" href="../../R/9a8c6eba9c21f6f3.html" target="n" data-glyph="76,1" class="i method">GetHistorySize</a>()
        {
            <b>int</b> <span id="r68 rd" class="r68 r">historySize</span> = 0;
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r69 rd" class="r69 r">executionContext</span> = <a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>object</b> <span id="r70 rd" class="r70 r">obj</span> = <span class="r69 r">executionContext</span>?.<a href="../ExecutionContext.cs.html#3a6f9a48ec862dfb" class="i method">GetVariableValue</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#b97aae1f6c5f76da" class="i field">HistorySizeVarPath</a>);
            <b>if</b> (<span class="r70 r">obj</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r68 r">historySize</span> = (<b>int</b>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r70 r">obj</span>, <b>typeof</b>(<b>int</b>), <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>catch</b> (<span class="i">InvalidCastException</span>)
                { }
            }
 
            <b>if</b> (<span class="r68 r">historySize</span> &lt;= 0)
            {
                <span class="r68 r">historySize</span> = <a href="#8a76f4b8b0040aa2" class="i field">DefaultHistorySize</a>;
            }
 
            <b>return</b> <span class="r68 r">historySize</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <a id="ff02f9bb90a3c479" href="../../R/ff02f9bb90a3c479.html" target="n" data-glyph="46,1" class="i field">_buffer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Capacity of circular buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="8802d745091b3ab6" href="../../R/8802d745091b3ab6.html" target="n" data-glyph="46,1" class="i field">_capacity</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Number of entries in buffer currently.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="451c865195e0f686" href="../../R/451c865195e0f686.html" target="n" data-glyph="46,1" class="i field">_countEntriesInBuffer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Total number of entries added till now including those which have</span>
        <span class="c">///</span><span class="c"> been overwritten after buffer got full. This is also number of</span>
        <span class="c">///</span><span class="c"> last entry added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private long</b> <a id="c32419457a577173" href="../../R/c32419457a577173.html" target="n" data-glyph="46,1" class="i field">_countEntriesAdded</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Private object for synchronization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly object</b> <a id="4ba375b982ebad6d" href="../../R/4ba375b982ebad6d.html" target="n" data-glyph="46,1" class="i field">_syncRoot</a> = <b>new</b> <b>object</b>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the ID of the next history item to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal long</b> <a id="29135ba8df22e381" href="../../R/29135ba8df22e381.html" target="n" data-glyph="74,1" class="i method">GetNextHistoryId</a>()
        {
            <b>return</b> <a href="#c32419457a577173" class="i field">_countEntriesAdded</a> + 1;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> invoke_loop_detection
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a set of HistoryInfo ids which are currently being executed in the</span>
        <span class="c">///</span><span class="c"> pipelines of the Runspace that is holding this &#39;History&#39; instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<b>long</b>&gt; <a id="34f7fd154dec1ee8" href="../../R/34f7fd154dec1ee8.html" target="n" data-glyph="46,1" class="i field">_invokeHistoryIds</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>long</b>&gt;();
 
        <b>internal bool</b> <a id="2278737c352f498a" href="../../R/2278737c352f498a.html" target="n" data-glyph="74,1" class="i method">PresentInInvokeHistoryEntrySet</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r71 rd" class="r71 r">entry</span>)
        {
            <b>return</b> <a href="#34f7fd154dec1ee8" class="i field">_invokeHistoryIds</a>.<span class="i">Contains</span>(<span class="r71 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a>);
        }
 
        <b>internal void</b> <a id="0ed6cd0dbaafd3f3" href="../../R/0ed6cd0dbaafd3f3.html" target="n" data-glyph="74,1" class="i method">AddToInvokeHistoryEntrySet</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r72 rd" class="r72 r">entry</span>)
        {
            <a href="#34f7fd154dec1ee8" class="i field">_invokeHistoryIds</a>.<span class="i">Add</span>(<span class="r72 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a>);
        }
 
        <b>internal void</b> <a id="6a04ea1d7c7a5606" href="../../R/6a04ea1d7c7a5606.html" target="n" data-glyph="74,1" class="i method">RemoveFromInvokeHistoryEntrySet</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r73 rd" class="r73 r">entry</span>)
        {
            <a href="#34f7fd154dec1ee8" class="i field">_invokeHistoryIds</a>.<span class="i">Remove</span>(<span class="r73 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> invoke_loop_detection
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class Implements the get-history command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../utils/Verbs.cs.html#7ee9f5441476f642" class="i field">Get</a>, <span class="s">&quot;History&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096788&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>))]
    <b>public class</b> <a id="ad869538b692aa74" href="../../R/ad869538b692aa74.html" target="n" data-glyph="0,0" class="t t"><span id="428b3c9bd4c57d90">GetHistoryCommand</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ids of entries to display.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private long</b>[] <a id="8f721a0250b15840" href="../../R/8f721a0250b15840.html" target="n" data-glyph="46,1" class="i field">_id</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ids of entries to display.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        [<span class="i">ValidateRangeAttribute</span>((<b>long</b>)1, <b>long</b>.<span class="i">MaxValue</span>)]
        <b>public long</b>[] <a id="b0b9e7e7441b2254" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Id</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8f721a0250b15840" class="i field">_id</a>;
            }
 
            <b>set</b>
            {
                <a href="#8f721a0250b15840" class="i field">_id</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is Count parameter specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="dad262344b0f4933" href="../../R/dad262344b0f4933.html" target="n" data-glyph="46,1" class="i field">_countParameterSpecified</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Count of entries to display. By default, count is the length of the history buffer.</span>
        <span class="c">///</span><span class="c"> So &quot;Get-History&quot; returns all history entries.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="926af9b5e808f95a" href="../../R/926af9b5e808f95a.html" target="n" data-glyph="46,1" class="i field">_count</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No of History Entries (starting from last) that are to be displayed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1)]
        [<span class="i">ValidateRangeAttribute</span>(0, (<b>int</b>)<span class="i">Int16</span>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="4c724d1ec5cc3e5c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#926af9b5e808f95a" class="i field">_count</a>;
            }
 
            <b>set</b>
            {
                <a href="#dad262344b0f4933" class="i field">_countParameterSpecified</a> = <b>true</b>;
                <a href="#926af9b5e808f95a" class="i field">_count</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the Processing() method for show/History command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="a5bf9249c50dd1e3" href="../../R/a5bf9249c50dd1e3.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="#388c8ac2f3fdde97" class="t t">History</a> <span id="r74 rd" class="r74 r">history</span> = ((<a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a>;
 
            <b>if</b> (<a href="#8f721a0250b15840" class="i field">_id</a> != <b>null</b>)
            {
                <b>if</b> (!<a href="#dad262344b0f4933" class="i field">_countParameterSpecified</a>)
                {
                    <span class="c">// If Id parameter is specified and count is not specified,</span>
                    <span class="c">// get history</span>
                    <b>foreach</b> (<b>long</b> <span id="r75 rd" class="r75 r">id</span> <b>in</b> <a href="#8f721a0250b15840" class="i field">_id</a>)
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r75 r">id</span> &gt; 0, <span class="s">&quot;ValidateRangeAttribute should not allow this&quot;</span>);
 
                        <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r76 rd" class="r76 r">entry</span> = <span class="r74 r">history</span>.<a href="#f0ac590fa434cc6a" class="i method">GetEntry</a>(<span class="r75 r">id</span>);
 
                        <b>if</b> (<span class="r76 r">entry</span> != <b>null</b> &amp;&amp; <span class="r76 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a> == <span class="r75 r">id</span>)
                        {
                            <a href="../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r76 r">entry</span>);
                        }
                        <b>else</b>
                        {
                            <span class="i">Exception</span> <span id="r77 rd" class="r77 r">ex</span> =
                                <b>new</b> <span class="i">ArgumentException</span>
                                (
                                    <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoHistoryForId</span>, <span class="r75 r">id</span>)
                                );
 
                            <a href="../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>
                            (
                                <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                                (
                                    <span class="r77 r">ex</span>,
                                    <span class="s">&quot;GetHistoryNoHistoryForId&quot;</span>,
                                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                    <span class="r75 r">id</span>
                                )
                            );
                        }
                    }
                }
                <b>else</b> <b>if</b> (<a href="#8f721a0250b15840" class="i field">_id</a>.<span class="i">Length</span> &gt; 1)
                {
                    <span class="i">Exception</span> <span id="r78 rd" class="r78 r">ex</span> =
                        <b>new</b> <span class="i">ArgumentException</span>
                        (
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoCountWithMultipleIds</span>)
                        );
 
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                    (
                        <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                        (
                            <span class="r78 r">ex</span>,
                            <span class="s">&quot;GetHistoryNoCountWithMultipleIds&quot;</span>,
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#926af9b5e808f95a" class="i field">_count</a>
                        )
                    );
                }
                <b>else</b>
                {
                    <b>long</b> <span id="r79 rd" class="r79 r">id</span> = <a href="#8f721a0250b15840" class="i field">_id</a>[0];
 
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r79 r">id</span> &gt; 0, <span class="s">&quot;ValidateRangeAttribute should not allow this&quot;</span>);
                    <a href="../cmdlet.cs.html#5805a280861be556" class="i method">WriteObject</a>(<span class="r74 r">history</span>.<a href="#b13fc58471a4745e" class="i method">GetEntries</a>(<span class="r79 r">id</span>, <a href="#926af9b5e808f95a" class="i field">_count</a>, <b>false</b>), <b>true</b>);
                }
            }
            <b>else</b>
            {
                <span class="c">// The default value for _count is the size of the history buffer.</span>
                <b>if</b> (!<a href="#dad262344b0f4933" class="i field">_countParameterSpecified</a>)
                {
                    <a href="#926af9b5e808f95a" class="i field">_count</a> = <span class="r74 r">history</span>.<a href="#781fac034fbab821" class="i method">Buffercapacity</a>();
                }
 
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r80 rd" class="r80 r">entries</span> = <span class="r74 r">history</span>.<a href="#b13fc58471a4745e" class="i method">GetEntries</a>(0, <a href="#926af9b5e808f95a" class="i field">_count</a>, <b>true</b>);
                <b>for</b> (<b>long</b> <span id="r81 rd" class="r81 r">i</span> = <span class="r80 r">entries</span>.<span class="i">Length</span> - 1; <span class="r81 r">i</span> &gt;= 0; <span class="r81 r">i</span>--)
                    <a href="../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r80 r">entries</span>[<span class="r81 r">i</span>]);
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements the Invoke-History command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../utils/Verbs.cs.html#1a8e85c66f6fff18" class="t t">VerbsLifecycle</a>.<a href="../../utils/Verbs.cs.html#b5f3af3d6aa6e852" class="i field">Invoke</a>, <span class="s">&quot;History&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096586&quot;</span>)]
    <b>public class</b> <a id="6b13382e767b6a05" href="../../R/6b13382e767b6a05.html" target="n" data-glyph="0,0" class="t t"><span id="c4fae36a60399b3e">InvokeHistoryCommand</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke cmd can execute only one history entry. If multiple</span>
        <span class="c">///</span><span class="c"> ids are provided, we throw error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="33c528a7e94734b1" href="../../R/33c528a7e94734b1.html" target="n" data-glyph="46,1" class="i field">_multipleIdProvided</a>;
        <b>private string</b> <a id="3b92835b814b702b" href="../../R/3b92835b814b702b.html" target="n" data-glyph="46,1" class="i field">_id</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Accepts a string value indicating a previously executed command to</span>
        <span class="c">///</span><span class="c"> re-execute.</span>
        <span class="c">///</span><span class="c"> If string can be parsed to long,</span>
        <span class="c">///</span><span class="c"> it will be used as HistoryId</span>
        <span class="c">///</span><span class="c"> else</span>
        <span class="c">///</span><span class="c"> as a string value indicating a previously executed command to</span>
        <span class="c">///</span><span class="c"> re-execute. This string is the first n characters of the command</span>
        <span class="c">///</span><span class="c"> that is to be re-executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        <b>public string</b> <a id="4430fe91c7af39ac" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Id</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3b92835b814b702b" class="i field">_id</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#3b92835b814b702b" class="i field">_id</a> != <b>null</b>)
                {
                    <span class="c">// Id has been set already.</span>
                    <a href="#33c528a7e94734b1" class="i field">_multipleIdProvided</a> = <b>true</b>;
                }
 
                <a href="#3b92835b814b702b" class="i field">_id</a> = <b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the BeginProcessing() method for eval/History command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="53544e176b34d4a8" href="../../R/53544e176b34d4a8.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// Invoke-history can execute only one command. If multiple</span>
            <span class="c">// ids were provided, throw exception</span>
            <b>if</b> (<a href="#33c528a7e94734b1" class="i field">_multipleIdProvided</a>)
            {
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <b>new</b> <span class="i">ArgumentException</span>(<span class="i">HistoryStrings</span>.<span class="i">InvokeHistoryMultipleCommandsError</span>),
                        <span class="s">&quot;InvokeHistoryMultipleCommandsError&quot;</span>,
                        <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <span class="i">targetObject</span>: <b>null</b>));
            }
 
            <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="k">var</a> <span id="r82 rd" class="r82 r">ctxRunspace</span> = (<a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>;
            <a href="#388c8ac2f3fdde97" class="t t">History</a> <span id="r83 rd" class="r83 r">history</span> = <span class="r82 r">ctxRunspace</span>.<a href="LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r83 r">history</span> != <b>null</b>, <span class="s">&quot;History should be non null&quot;</span>);
 
            <span class="c">// Get the history entry to invoke</span>
            <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r84 rd" class="r84 r">entry</span> = <a href="#8fdd75a599c9c3d2" class="i method">GetHistoryEntryToInvoke</a>(<span class="r83 r">history</span>);
            <b>string</b> <span id="r85 rd" class="r85 r">commandToInvoke</span> = <span class="r84 r">entry</span>.<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>;
 
            <b>if</b> (!<a href="../cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<span class="r85 r">commandToInvoke</span>))
            {
                <b>return</b>;
            }
 
            <span class="c">// Check if there is a loop in invoke-history</span>
            <b>if</b> (<span class="r83 r">history</span>.<a href="#2278737c352f498a" class="i method">PresentInInvokeHistoryEntrySet</a>(<span class="r84 r">entry</span>))
            {
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">HistoryStrings</span>.<span class="i">InvokeHistoryLoopDetected</span>),
                        <span class="s">&quot;InvokeHistoryLoopDetected&quot;</span>,
                        <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                        <span class="i">targetObject</span>: <b>null</b>));
            }
            <b>else</b>
            {
                <span class="r83 r">history</span>.<a href="#0ed6cd0dbaafd3f3" class="i method">AddToInvokeHistoryEntrySet</a>(<span class="r84 r">entry</span>);
            }
 
            <span class="c">// Replace Invoke-History with string which is getting invoked</span>
            <a href="#28c52f9b690766b3" class="i method">ReplaceHistoryString</a>(<span class="r84 r">entry</span>, <span class="r82 r">ctxRunspace</span>);
 
            <b>try</b>
            {
                <span class="c">// Echo command</span>
                <a href="../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>.<a href="MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<a href="MshHostUserInterface.cs.html#41cef667d4ee22a2" class="i method">WriteLine</a>(<span class="r85 r">commandToInvoke</span>);
            }
            <b>catch</b> (<a href="../../utils/HostInterfacesExceptions.cs.html#4b15a598e99c7dd9" class="t t">HostException</a>)
            {
                <span class="c">// when the host is not interactive, HostException is thrown</span>
                <span class="c">// do nothing</span>
            }
 
            <span class="c">// Items invoked as History should act as though they were submitted by the user - so should still come from</span>
            <span class="c">// the runspace itself. For this reason, it is insufficient to just use the InvokeScript method on the Cmdlet class.</span>
            <b>using</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r86 rd" class="r86 r">ps</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>))
            {
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#c97f8d15a2f93e31" class="i method">AddScript</a>(<span class="r85 r">commandToInvoke</span>);
 
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r87 rd" class="r87 r">debugAdded</span> = (<b>object</b> <span id="r88 rd" class="r88 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r89 rd" class="r89 r">e</span>) =&gt; { <a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a> <span id="r90 rd" class="r90 r">record</span> = (<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt;)<span class="r88 r">sender</span>)[<span class="r89 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a>(<span class="r90 r">record</span>.<a href="InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>); };
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r91 rd" class="r91 r">errorAdded</span> = (<b>object</b> <span id="r92 rd" class="r92 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r93 rd" class="r93 r">e</span>) =&gt; { <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r94 rd" class="r94 r">record</span> = (<a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;)<span class="r92 r">sender</span>)[<span class="r93 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r94 r">record</span>); };
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r95 rd" class="r95 r">informationAdded</span> = (<b>object</b> <span id="r96 rd" class="r96 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r97 rd" class="r97 r">e</span>) =&gt; { <a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r98 rd" class="r98 r">record</span> = (<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt;)<span class="r96 r">sender</span>)[<span class="r97 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#f38cc55507c70e22" class="i method">WriteInformation</a>(<span class="r98 r">record</span>); };
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r99 rd" class="r99 r">progressAdded</span> = (<b>object</b> <span id="r100 rd" class="r100 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r101 rd" class="r101 r">e</span>) =&gt; { <a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r102 rd" class="r102 r">record</span> = (<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt;)<span class="r100 r">sender</span>)[<span class="r101 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r102 r">record</span>); };
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r103 rd" class="r103 r">verboseAdded</span> = (<b>object</b> <span id="r104 rd" class="r104 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r105 rd" class="r105 r">e</span>) =&gt; { <a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a> <span id="r106 rd" class="r106 r">record</span> = (<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt;)<span class="r104 r">sender</span>)[<span class="r105 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<span class="r106 r">record</span>.<a href="InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>); };
                <span class="i">EventHandler</span>&lt;<a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a>&gt; <span id="r107 rd" class="r107 r">warningAdded</span> = (<b>object</b> <span id="r108 rd" class="r108 r">sender</span>, <a href="PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r109 rd" class="r109 r">e</span>) =&gt; { <a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a> <span id="r110 rd" class="r110 r">record</span> = (<a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>)((<a href="PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt;)<span class="r108 r">sender</span>)[<span class="r109 r">e</span>.<a href="PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>]; <a href="../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<span class="r110 r">record</span>.<a href="InformationalRecord.cs.html#4b46c95702707b8a" class="i property">Message</a>); };
 
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#96bfebc26e0f381d" class="i property">Debug</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r87 r">debugAdded</span>;
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r91 r">errorAdded</span>;
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#afec31161428f7a7" class="i property">Information</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r95 r">informationAdded</span>;
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#c29a7555dab6febc" class="i property">Progress</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r99 r">progressAdded</span>;
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#8e878317a3e80c79" class="i property">Verbose</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r103 r">verboseAdded</span>;
                <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#a0a7066f9b712955" class="i property">Warning</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="r107 r">warningAdded</span>;
 
                <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r111 rd" class="r111 r">localRunspace</span> = <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> <b>as</b> <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>;
 
                <b>try</b>
                {
                    <span class="c">// Indicate to the system that we are in nested prompt mode, since we are emulating running the command at the prompt.</span>
                    <span class="c">// This ensures that the command being run as nested runs in the correct language mode, because CreatePipelineProcessor()</span>
                    <span class="c">// always forces CommandOrigin to Internal for nested running commands, and Command.CreateCommandProcessor() forces Internal</span>
                    <span class="c">// commands to always run in FullLanguage mode unless in a nested prompt.</span>
                    <b>if</b> (<span class="r111 r">localRunspace</span> != <b>null</b>)
                    {
                        <span class="r111 r">localRunspace</span>.<a href="LocalConnection.cs.html#9b139b376a86595a" class="i property">InInternalNestedPrompt</a> = <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#32c156c0cba25702" class="i property">IsNested</a>;
                    }
 
                    <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r112 rd" class="r112 r">results</span> = <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                    <b>if</b> (<span class="r112 r">results</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="i">WriteObject</span>(<span class="r112 r">results</span>, <b>true</b>);
                    }
                }
                <b>finally</b>
                {
                    <span class="r83 r">history</span>.<a href="#6a04ea1d7c7a5606" class="i method">RemoveFromInvokeHistoryEntrySet</a>(<span class="r84 r">entry</span>);
 
                    <b>if</b> (<span class="r111 r">localRunspace</span> != <b>null</b>)
                    {
                        <span class="r111 r">localRunspace</span>.<a href="LocalConnection.cs.html#9b139b376a86595a" class="i property">InInternalNestedPrompt</a> = <b>false</b>;
                    }
 
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#96bfebc26e0f381d" class="i property">Debug</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r87 r">debugAdded</span>;
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r91 r">errorAdded</span>;
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#afec31161428f7a7" class="i property">Information</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r95 r">informationAdded</span>;
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#c29a7555dab6febc" class="i property">Progress</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r99 r">progressAdded</span>;
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#8e878317a3e80c79" class="i property">Verbose</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r103 r">verboseAdded</span>;
                    <span class="r86 r">ps</span>.<a href="PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="PowerShell.cs.html#a0a7066f9b712955" class="i property">Warning</a>.<a href="PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="r107 r">warningAdded</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper function which gets history entry to invoke.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;It&#39;s ok to use ID in the ArgumentException&quot;</span>)]
        <b>private</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <a id="8fdd75a599c9c3d2" href="../../R/8fdd75a599c9c3d2.html" target="n" data-glyph="76,1" class="i method">GetHistoryEntryToInvoke</a>(<a href="#388c8ac2f3fdde97" class="t t">History</a> <span id="r113 rd" class="r113 r">history</span>)
        {
            <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r114 rd" class="r114 r">entry</span> = <b>null</b>;
 
            <span class="c">// User didn&#39;t specify any input parameter. Invoke the last</span>
            <span class="c">// entry</span>
            <b>if</b> (<a href="#3b92835b814b702b" class="i field">_id</a> == <b>null</b>)
            {
                <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r115 rd" class="r115 r">entries</span> = <span class="r113 r">history</span>.<a href="#b13fc58471a4745e" class="i method">GetEntries</a>(0, 1, <b>true</b>);
 
                <b>if</b> (<span class="r115 r">entries</span>.<span class="i">Length</span> == 1)
                {
                    <span class="r114 r">entry</span> = <span class="r115 r">entries</span>[0];
                }
                <b>else</b>
                {
                    <span class="i">Exception</span> <span id="r116 rd" class="r116 r">ex</span> =
                        <b>new</b> <span class="i">InvalidOperationException</span>
                        (
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoLastHistoryEntryFound</span>)
                        );
 
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                    (
                        <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                        (
                            <span class="r116 r">ex</span>,
                            <span class="s">&quot;InvokeHistoryNoLastHistoryEntryFound&quot;</span>,
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                            <b>null</b>
                        )
                    );
                }
            }
            <b>else</b>
            {
                <span class="c">// Parse input</span>
                <a href="#7ee8bc2eaaeb735a" class="i method">PopulateIdAndCommandLine</a>();
                <span class="c">// User specified a commandline. Get list of all history entries</span>
                <span class="c">// and find latest match</span>
                <b>if</b> (<a href="#5d9f4bf85148472e" class="i field">_commandLine</a> != <b>null</b>)
                {
                    <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <span id="r117 rd" class="r117 r">entries</span> = <span class="r113 r">history</span>.<span class="i">GetEntries</span>(0, -1, <b>false</b>);
 
                    <span class="c">// and search backwards through the entries</span>
                    <b>for</b> (<b>int</b> <span id="r118 rd" class="r118 r">i</span> = <span class="r117 r">entries</span>.<span class="i">Length</span> - 1; <span class="r118 r">i</span> &gt;= 0; <span class="r118 r">i</span>--)
                    {
                        <b>if</b> (<span class="r117 r">entries</span>[<span class="r118 r">i</span>].<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>.<span class="i">StartsWith</span>(<a href="#5d9f4bf85148472e" class="i field">_commandLine</a>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                        {
                            <span class="r114 r">entry</span> = <span class="r117 r">entries</span>[<span class="r118 r">i</span>];
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r114 r">entry</span> == <b>null</b>)
                    {
                        <span class="i">Exception</span> <span id="r119 rd" class="r119 r">ex</span> =
                            <b>new</b> <span class="i">ArgumentException</span>
                            (
                                <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoHistoryForCommandline</span>, <a href="#5d9f4bf85148472e" class="i field">_commandLine</a>)
                            );
 
                        <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                        (
                            <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                            (
                                <span class="r119 r">ex</span>,
                                <span class="s">&quot;InvokeHistoryNoHistoryForCommandline&quot;</span>,
                                <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                <a href="#5d9f4bf85148472e" class="i field">_commandLine</a>
                            )
                        );
                    }
                }
                <b>else</b>
                {
                    <b>if</b> (<a href="#2df34e079f778ab0" class="i field">_historyId</a> &lt;= 0)
                    {
                        <span class="i">Exception</span> <span id="r120 rd" class="r120 r">ex</span> =
                            <b>new</b> <span class="i">ArgumentOutOfRangeException</span>
                            (
                                <span class="s">&quot;Id&quot;</span>,
                                <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">InvalidIdGetHistory</span>, <a href="#2df34e079f778ab0" class="i field">_historyId</a>)
                            );
 
                        <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                        (
                            <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                            (
                                <span class="r120 r">ex</span>,
                                <span class="s">&quot;InvokeHistoryInvalidIdGetHistory&quot;</span>,
                                <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <a href="#2df34e079f778ab0" class="i field">_historyId</a>
                            )
                        );
                    }
                    <b>else</b>
                    {
                        <span class="c">// Retrieve the command at the index we&#39;ve specified</span>
                        <span class="r114 r">entry</span> = <span class="r113 r">history</span>.<a href="#f0ac590fa434cc6a" class="i method">GetEntry</a>(<a href="#2df34e079f778ab0" class="i field">_historyId</a>);
                        <b>if</b> (<span class="r114 r">entry</span> == <b>null</b> || <span class="r114 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a> != <a href="#2df34e079f778ab0" class="i field">_historyId</a>)
                        {
                            <span class="i">Exception</span> <span id="r121 rd" class="r121 r">ex</span> =
                                <b>new</b> <span class="i">ArgumentException</span>
                                (
                                    <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoHistoryForId</span>, <a href="#2df34e079f778ab0" class="i field">_historyId</a>)
                                );
 
                            <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                            (
                                <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                                (
                                    <span class="r121 r">ex</span>,
                                    <span class="s">&quot;InvokeHistoryNoHistoryForId&quot;</span>,
                                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                    <a href="#2df34e079f778ab0" class="i field">_historyId</a>
                                )
                            );
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r114 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id of history entry to execute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private long</b> <a id="2df34e079f778ab0" href="../../R/2df34e079f778ab0.html" target="n" data-glyph="46,1" class="i field">_historyId</a> = -1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Commandline to execute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="5d9f4bf85148472e" href="../../R/5d9f4bf85148472e.html" target="n" data-glyph="46,1" class="i field">_commandLine</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse Id parameter to populate _historyId and _commandLine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="7ee8bc2eaaeb735a" href="../../R/7ee8bc2eaaeb735a.html" target="n" data-glyph="76,1" class="i method">PopulateIdAndCommandLine</a>()
        {
            <b>if</b> (<a href="#3b92835b814b702b" class="i field">_id</a> == <b>null</b>)
                <b>return</b>;
 
            <b>try</b>
            {
                <a href="#2df34e079f778ab0" class="i field">_historyId</a> = (<b>long</b>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<a href="#3b92835b814b702b" class="i field">_id</a>, <b>typeof</b>(<b>long</b>), <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<a href="../ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>)
            {
                <a href="#5d9f4bf85148472e" class="i field">_commandLine</a> = <a href="#3b92835b814b702b" class="i field">_id</a>;
                <b>return</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke-history is replaced in history by the command it executed.</span>
        <span class="c">///</span><span class="c"> This replacement happens only if Invoke-History is single element</span>
        <span class="c">///</span><span class="c"> in the pipeline. If there are more than one element in pipeline</span>
        <span class="c">///</span><span class="c"> (ex A | Invoke-History 2 | B) then we cannot do this replacement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="28c52f9b690766b3" href="../../R/28c52f9b690766b3.html" target="n" data-glyph="76,1" class="i method">ReplaceHistoryString</a>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r122 rd" class="r122 r">entry</span>, <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r123 rd" class="r123 r">localRunspace</span>)
        {
            <a href="LocalPipeline.cs.html#4ecb13103c10f113" class="k">var</a> <span id="r124 rd" class="r124 r">pipeline</span> = (<a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>)<span class="r123 r">localRunspace</span>.<a href="ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
            <b>if</b> (<span class="r124 r">pipeline</span>.<a href="pipelinebase.cs.html#7bfe2846e98bfb41" class="i property">AddToHistory</a>)
            {
                <span class="r124 r">pipeline</span>.<a href="pipelinebase.cs.html#5ed10764070043c2" class="i property">HistoryString</a> = <span class="r122 r">entry</span>.<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>;
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class Implements the add-history command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../utils/Verbs.cs.html#ae1744bf7bfad73f" class="i field">Add</a>, <span class="s">&quot;History&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096479&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>))]
    <b>public class</b> <a id="4f23c3d1eb0a52f1" href="../../R/4f23c3d1eb0a52f1.html" target="n" data-glyph="0,0" class="t t"><span id="25a3ec17dc13f915">AddHistoryCommand</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter specifies the current pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <a id="90da3850220ea3a7" href="../../R/90da3850220ea3a7.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <b>private bool</b> <a id="7902b74e68ae3aad" href="../../R/7902b74e68ae3aad.html" target="n" data-glyph="46,1" class="i field">_passthru</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Boolean that indicates whether history objects should be</span>
        <span class="c">///</span><span class="c"> passed to the next element in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="a87f8b5126b16946" href="../../R/a87f8b5126b16946.html" target="n" data-glyph="102,1" class="i property">Passthru</a>
        {
            <b>get</b> { <b>return</b> <a href="#7902b74e68ae3aad" class="i field">_passthru</a>; }
 
            <b>set</b> { <a href="#7902b74e68ae3aad" class="i field">_passthru</a> = <b>value</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override for BeginProcessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected
        override
        void</b> <a id="29691177c3cdc346" href="../../R/29691177c3cdc346.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <span class="c">// Get currently running pipeline and add history entry for</span>
            <span class="c">// this pipeline.</span>
            <span class="c">// Note:Generally History entry for current pipeline is added</span>
            <span class="c">// on completion of pipeline (See LocalPipeline implementation).</span>
            <span class="c">// However Add-history adds additional entries in to history and</span>
            <span class="c">// additional entries must be added after history for current pipeline.</span>
            <span class="c">// This is done by adding the history entry for current pipeline below.</span>
            <a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a> <span id="r125 rd" class="r125 r">lpl</span> = (<a href="LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>)((<a href="ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>)<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
            <span class="r125 r">lpl</span>.<a href="LocalPipeline.cs.html#408c2ea42954cad4" class="i method">AddHistoryEntryFromAddHistoryCmdlet</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override for ProcessRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected
        override
        void</b> <a id="4d70198270821a12" href="../../R/4d70198270821a12.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="#388c8ac2f3fdde97" class="t t">History</a> <span id="r126 rd" class="r126 r">history</span> = ((<a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r126 r">history</span> != <b>null</b>, <span class="s">&quot;History should be non null&quot;</span>);
 
            <b>if</b> (<a href="#90da3850220ea3a7" class="i property">InputObject</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r127 rd" class="r127 r">input</span> <b>in</b> <a href="#90da3850220ea3a7" class="i property">InputObject</a>)
                {
                    <span class="c">// Wrap the inputobject in PSObject and convert it to</span>
                    <span class="c">// HistoryInfo object.</span>
                    <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r128 rd" class="r128 r">infoToAdd</span> = <a href="#48f643627db70935" class="i method">GetHistoryInfoObject</a>(<span class="r127 r">input</span>);
                    <b>if</b> (<span class="r128 r">infoToAdd</span> != <b>null</b>)
                    {
                        <b>long</b> <span id="r129 rd" class="r129 r">id</span> = <span class="r126 r">history</span>.<a href="#51ba806b689a8f7b" class="i method">AddEntry</a>
                                  (
                                    0,
                                    <span class="r128 r">infoToAdd</span>.<a href="#8a8406b2b45fb781" class="i property">CommandLine</a>,
                                    <span class="r128 r">infoToAdd</span>.<a href="#303615db9877f45e" class="i property">ExecutionStatus</a>,
                                    <span class="r128 r">infoToAdd</span>.<a href="#164440c04f6e0189" class="i property">StartExecutionTime</a>,
                                    <span class="r128 r">infoToAdd</span>.<a href="#a6e609990b94c97e" class="i property">EndExecutionTime</a>,
                                    <b>false</b>
                                  );
 
                        <b>if</b> (<a href="#a87f8b5126b16946" class="i property">Passthru</a>)
                        {
                            <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r130 rd" class="r130 r">infoAdded</span> = <span class="r126 r">history</span>.<a href="#f0ac590fa434cc6a" class="i method">GetEntry</a>(<span class="r129 r">id</span>);
                            <a href="../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r130 r">infoAdded</span>);
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert mshObject that has the properties of an HistoryInfo</span>
        <span class="c">///</span><span class="c"> object in to HistoryInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> mshObject to be converted to HistoryInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> HistoryInfo object if conversion is successful else null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 0162
        <b>private</b>
        <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>
        <a id="48f643627db70935" href="../../R/48f643627db70935.html" target="n" data-glyph="76,1" class="i method">GetHistoryInfoObject</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r131 rd" class="r131 r">mshObject</span>)
        {
            <b>do</b>
            {
                <b>if</b> (<span class="r131 r">mshObject</span> == <b>null</b>)
                {
                    <b>break</b>;
                }
 
                <span class="c">// Read CommandLine property</span>
                <b>if</b> (!(<a href="#77a5b29e4cc9ea82" class="i method">GetPropertyValue</a>(<span class="r131 r">mshObject</span>, <span class="s">&quot;CommandLine&quot;</span>) <b>is string</b> <span id="r132 rd" class="r132 r">commandLine</span>))
                {
                    <b>break</b>;
                }
 
                <span class="c">// Read ExecutionStatus property</span>
                <b>object</b> <span id="r133 rd" class="r133 r">pipelineState</span> = <a href="#77a5b29e4cc9ea82" class="i method">GetPropertyValue</a>(<span class="r131 r">mshObject</span>, <span class="s">&quot;ExecutionStatus&quot;</span>);
                <b>if</b> (<span class="r133 r">pipelineState</span> == <b>null</b> || !<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>&gt;(<span class="r133 r">pipelineState</span>, <b>out</b> <a href="Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r134 rd" class="r134 r">executionStatus</span>))
                {
                    <b>break</b>;
                }
 
                <span class="c">// Read StartExecutionTime property</span>
                <b>object</b> <span id="r135 rd" class="r135 r">temp</span> = <a href="#77a5b29e4cc9ea82" class="i method">GetPropertyValue</a>(<span class="r131 r">mshObject</span>, <span class="s">&quot;StartExecutionTime&quot;</span>);
                <b>if</b> (<span class="r135 r">temp</span> == <b>null</b> || !<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<span class="i">DateTime</span>&gt;(<span class="r135 r">temp</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <b>out</b> <span class="i">DateTime</span> <span id="r136 rd" class="r136 r">startExecutionTime</span>))
                {
                    <b>break</b>;
                }
 
                <span class="c">// Read EndExecutionTime property</span>
                <span class="r135 r">temp</span> = <a href="#77a5b29e4cc9ea82" class="i method">GetPropertyValue</a>(<span class="r131 r">mshObject</span>, <span class="s">&quot;EndExecutionTime&quot;</span>);
                <b>if</b> (<span class="r135 r">temp</span> == <b>null</b> || !<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<span class="i">DateTime</span>&gt;(<span class="r135 r">temp</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <b>out</b> <span class="i">DateTime</span> <span id="r137 rd" class="r137 r">endExecutionTime</span>))
                {
                    <b>break</b>;
                }
 
                <b>return</b> <b>new</b> <a href="#6333dc4d5d03dd36" class="t constructor">HistoryInfo</a>(
                    <span class="r0 r">pipelineId</span>: 0,
                    <span class="r132 r">commandLine</span>,
                    <span class="r134 r">executionStatus</span>,
                    <span class="r136 r">startExecutionTime</span>,
                    <span class="r137 r">endExecutionTime</span>
                );
            } <b>while</b> (<b>false</b>);
 
            <span class="c">// If we are here, an error has occured.</span>
            <span class="i">Exception</span> <span id="r138 rd" class="r138 r">ex</span> =
                <b>new</b> <span class="i">InvalidDataException</span>
                (
                    <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">AddHistoryInvalidInput</span>)
                );
 
            <a href="../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>
            (
                <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                (
                    <span class="r138 r">ex</span>,
                    <span class="s">&quot;AddHistoryInvalidInput&quot;</span>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#c855a7c43559f12f" class="i field">InvalidData</a>,
                    <span class="r131 r">mshObject</span>
                )
            );
 
            <b>return</b> <b>null</b>;
        }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 0162
 
        <b>private static
        object</b>
        <a id="77a5b29e4cc9ea82" href="../../R/77a5b29e4cc9ea82.html" target="n" data-glyph="76,1" class="i method">GetPropertyValue</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r139 rd" class="r139 r">mshObject</span>, <b>string</b> <span id="r140 rd" class="r140 r">propertyName</span>)
        {
            <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r141 rd" class="r141 r">propertyInfo</span> = <span class="r139 r">mshObject</span>.<a href="../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r140 r">propertyName</span>];
            <b>if</b> (<span class="r141 r">propertyInfo</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
            <b>return</b> <span class="r141 r">propertyInfo</span>.<a href="../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
        }
    }
 
    <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This Class implements the Clear History cmdlet</span>
    <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../utils/Verbs.cs.html#5c61f2dee3ea9dbb" class="i field">Clear</a>, <span class="s">&quot;History&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;IDParameter&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096691&quot;</span>)]
    <b>public class</b> <a id="37514fa1ae47fbfb" href="../../R/37514fa1ae47fbfb.html" target="n" data-glyph="0,0" class="t t"><span id="6e4ad6299fce4573">ClearHistoryCommand</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the ID of a command in the session history.Clear history clears the entries</span>
        <span class="c">///</span><span class="c"> wit the specified ID(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;IDParameter&quot;</span>, <a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
           <a href="../Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Specifies the ID of a command in the session history.Clear history clears only the specified command&quot;</span>)]
        [<span class="i">ValidateRangeAttribute</span>((<b>int</b>)1, <b>int</b>.<span class="i">MaxValue</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public int</b>[] <a id="deb578392bb7bc21" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Id</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#47a87aa3a453e8a3" class="i field">_id</a>;
            }
 
            <b>set</b>
            {
                <a href="#47a87aa3a453e8a3" class="i field">_id</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id of a history entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b>[] <a id="47a87aa3a453e8a3" href="../../R/47a87aa3a453e8a3.html" target="n" data-glyph="46,1" class="i field">_id</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command line name of an entry in the session history.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;CommandLineParameter&quot;</span>, <a href="../Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Specifies the name of a command in the session history&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="89aeb46083c33e4e" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CommandLine</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1d041130128e446c" class="i field">_commandline</a>;
            }
 
            <b>set</b>
            {
                <a href="#1d041130128e446c" class="i field">_commandline</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Commandline parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="1d041130128e446c" href="../../R/1d041130128e446c.html" target="n" data-glyph="46,1" class="i field">_commandline</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the specified number of history entries</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>, <a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="../Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Clears the specified number of history entries&quot;</span>)]
        [<span class="i">ValidateRangeAttribute</span>((<b>int</b>)1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="56f219fde820c7bf" href="../../R/56f219fde820c7bf.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#da81ae8ae9397add" class="i field">_count</a>;
            }
 
            <b>set</b>
            {
                <a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a> = <b>true</b>;
                <a href="#da81ae8ae9397add" class="i field">_count</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Count of the history entries.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="da81ae8ae9397add" href="../../R/da81ae8ae9397add.html" target="n" data-glyph="46,1" class="i field">_count</a> = 32;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A boolean variable to indicate if the count parameter specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6f58cadd3cc3c753" href="../../R/6f58cadd3cc3c753.html" target="n" data-glyph="46,1" class="i field">_countParameterSpecified</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies whether new entries to be cleared or the default old ones.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>, <a href="../Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Specifies whether new entries to be cleared or the default old ones.&quot;</span>)]
        <b>public</b> <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f8918d4a8bdc56b3" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Newest</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4cebf1399a7c9793" class="i field">_newest</a>;
            }
 
            <b>set</b>
            {
                <a href="#4cebf1399a7c9793" class="i field">_newest</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Switch parameter on the history entries.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4cebf1399a7c9793" href="../../R/4cebf1399a7c9793.html" target="n" data-glyph="46,1" class="i field">_newest</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overriding Begin Processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e479d20118888915" href="../../R/e479d20118888915.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#032f330dd3b210d5" class="i field">_history</a> = ((<a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="LocalConnection.cs.html#a15c869586f2f866" class="i property">History</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overriding Process Record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="26e9e377d7baeeca" href="../../R/26e9e377d7baeeca.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// case statement to identify the parameter set</span>
            <b>switch</b> (<a href="../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>)
            {
                <b>case</b> <span class="s">&quot;IDParameter&quot;</span>:
                    <a href="#f5883951a7e4c8b2" class="i method">ClearHistoryByID</a>();
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;CommandLineParameter&quot;</span>:
                    <a href="#7b11162c06dfa70a" class="i method">ClearHistoryByCmdLine</a>();
                    <b>break</b>;
                <b>default</b>:
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;Invalid ParameterSet Name&quot;</span>),
                            <span class="s">&quot;Unable to access the session history&quot;</span>, <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>));
                    <b>return</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the session history based on the id parameter</span>
        <span class="c">///</span><span class="c"> takes no parameters</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Nothing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f5883951a7e4c8b2" href="../../R/f5883951a7e4c8b2.html" target="n" data-glyph="76,1" class="i method">ClearHistoryByID</a>()
        {
            <b>if</b> (<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a> &amp;&amp; <a href="#56f219fde820c7bf" class="i property">Count</a> &lt; 0)
            {
                <span class="i">Exception</span> <span id="r142 rd" class="r142 r">ex</span> =
                   <b>new</b> <span class="i">ArgumentException</span>
                   (
                       <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#6dd43165d0b5d92f" class="i method">Format</a>(<span class="s">&quot;HistoryStrings&quot;</span>, <span class="s">&quot;InvalidCountValue&quot;</span>)
                   );
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                (
                    <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                    (
                        <span class="r142 r">ex</span>,
                        <span class="s">&quot;ClearHistoryInvalidCountValue&quot;</span>,
                        <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <a href="#da81ae8ae9397add" class="i field">_count</a>
                    )
                );
            }
            <span class="c">// if id parameter is not present</span>
            <b>if</b> (<a href="#47a87aa3a453e8a3" class="i field">_id</a> != <b>null</b>)
            {
                <span class="c">// if count parameter is not present</span>
                <b>if</b> (!<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a>)
                {
                    <span class="c">// clearing the entry for each id in the id[] parameter.</span>
                    <b>foreach</b> (<b>long</b> <span id="r143 rd" class="r143 r">id</span> <b>in</b> <a href="#47a87aa3a453e8a3" class="i field">_id</a>)
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r143 r">id</span> &gt; 0, <span class="s">&quot;ValidateRangeAttribute should not allow this&quot;</span>);
                        <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r144 rd" class="r144 r">entry</span> = <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#f0ac590fa434cc6a" class="i method">GetEntry</a>(<span class="r143 r">id</span>);
                        <b>if</b> (<span class="r144 r">entry</span> != <b>null</b> &amp;&amp; <span class="r144 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a> == <span class="r143 r">id</span>)
                        {
                            <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#3f5a9ebac20297a0" class="i method">ClearEntry</a>(<span class="r144 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a>);
                        }
                        <b>else</b>
                        {<span class="c">// throw an exception if an entry for an id is not found</span>
                            <span class="i">Exception</span> <span id="r145 rd" class="r145 r">ex</span> =
                                <b>new</b> <span class="i">ArgumentException</span>
                                (
                                    <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoHistoryForId</span>, <span class="r143 r">id</span>)
                                );
                            <a href="../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>
                            (
                                <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                                (
                                    <span class="r145 r">ex</span>,
                                    <span class="s">&quot;GetHistoryNoHistoryForId&quot;</span>,
                                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                    <span class="r143 r">id</span>
                                )
                            );
                        }
                    }
                }
                <b>else</b> <b>if</b> (<a href="#47a87aa3a453e8a3" class="i field">_id</a>.<span class="i">Length</span> &gt; 1)
                {<span class="c">// throwing an exception for invalid parameter combinations</span>
                    <span class="i">Exception</span> <span id="r146 rd" class="r146 r">ex</span> =
                        <b>new</b> <span class="i">ArgumentException</span>
                        (
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoCountWithMultipleIds</span>)
                        );
 
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                    (
                        <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                        (
                            <span class="r146 r">ex</span>,
                            <span class="s">&quot;GetHistoryNoCountWithMultipleIds&quot;</span>,
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#da81ae8ae9397add" class="i field">_count</a>
                        )
                    );
                }
                <b>else</b>
                {<span class="c">// if id,count and newest parameters are present</span>
                    <span class="c">// throw an exception for invalid count values</span>
 
                    <b>long</b> <span id="r147 rd" class="r147 r">id</span> = <a href="#47a87aa3a453e8a3" class="i field">_id</a>[0];
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r147 r">id</span> &gt; 0, <span class="s">&quot;ValidateRangeAttribute should not allow this&quot;</span>);
                    <a href="#b0985d683dc1a658" class="i method">ClearHistoryEntries</a>(<span class="r147 r">id</span>, <a href="#da81ae8ae9397add" class="i field">_count</a>, <b>null</b>, <a href="#4cebf1399a7c9793" class="i field">_newest</a>);
                }
            }
            <b>else</b>
            {
                <span class="c">// confirmation message if all the clearhistory cmdlet is used without any parameters</span>
                <b>if</b> (!<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a>)
                {
                    <b>string</b> <span id="r148 rd" class="r148 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">ClearHistoryWarning</span>, <span class="s">&quot;Warning&quot;</span>); <span class="c">// &quot;The command would clear all the entry(s) from the session history,Are you sure you want to continue ?&quot;;</span>
                    <b>if</b> (!<a href="../cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<span class="r148 r">message</span>))
                    {
                        <b>return</b>;
                    }
 
                    <span class="i">ClearHistoryEntries</span>(0, -1, <b>null</b>, <a href="#4cebf1399a7c9793" class="i field">_newest</a>);
                }
                <b>else</b>
                {
                    <a href="#b0985d683dc1a658" class="i method">ClearHistoryEntries</a>(0, <a href="#da81ae8ae9397add" class="i field">_count</a>, <b>null</b>, <a href="#4cebf1399a7c9793" class="i field">_newest</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the session history based on the Commandline parameter</span>
        <span class="c">///</span><span class="c"> takes no parameters</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Nothing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="7b11162c06dfa70a" href="../../R/7b11162c06dfa70a.html" target="n" data-glyph="76,1" class="i method">ClearHistoryByCmdLine</a>()
        {
            <span class="c">// throw an exception for invalid count values</span>
            <b>if</b> (<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a> &amp;&amp; <a href="#56f219fde820c7bf" class="i property">Count</a> &lt; 0)
            {
                <span class="i">Exception</span> <span id="r149 rd" class="r149 r">ex</span> =
                   <b>new</b> <span class="i">ArgumentException</span>
                   (
                       <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">InvalidCountValue</span>)
                   );
 
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                (
                    <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                    (
                        <span class="r149 r">ex</span>,
                        <span class="s">&quot;ClearHistoryInvalidCountValue&quot;</span>,
                        <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <a href="#da81ae8ae9397add" class="i field">_count</a>
                    )
                );
            }
            <span class="c">// if command line is not present</span>
            <b>if</b> (<a href="#1d041130128e446c" class="i field">_commandline</a> != <b>null</b>)
            {
                <span class="c">// if count parameter is not present</span>
                <b>if</b> (!<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a>)
                {
                    <b>foreach</b> (<b>string</b> <span id="r150 rd" class="r150 r">cmd</span> <b>in</b> <a href="#1d041130128e446c" class="i field">_commandline</a>)
                    {
                        <a href="#b0985d683dc1a658" class="i method">ClearHistoryEntries</a>(0, 1, <span class="r150 r">cmd</span>, <a href="#4cebf1399a7c9793" class="i field">_newest</a>);
                    }
                }
                <b>else</b> <b>if</b> (<a href="#1d041130128e446c" class="i field">_commandline</a>.<span class="i">Length</span> &gt; 1)
                {<span class="c">// throwing exceptions for invalid parameter combinations</span>
                    <span class="i">Exception</span> <span id="r151 rd" class="r151 r">ex</span> =
                        <b>new</b> <span class="i">ArgumentException</span>
                        (
                            <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoCountWithMultipleCmdLine</span>)
                        );
 
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>
                    (
                        <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                        (
                            <span class="r151 r">ex</span>,
                            <span class="s">&quot;NoCountWithMultipleCmdLine &quot;</span>,
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#1d041130128e446c" class="i field">_commandline</a>
                        )
                    );
                }
                <b>else</b>
                {   <span class="c">// if commandline,count and newest parameters are present.</span>
                    <a href="#b0985d683dc1a658" class="i method">ClearHistoryEntries</a>(0, <a href="#da81ae8ae9397add" class="i field">_count</a>, <a href="#1d041130128e446c" class="i field">_commandline</a>[0], <a href="#4cebf1399a7c9793" class="i field">_newest</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the session history based on the input parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the entry to be cleared.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Count of entries to be cleared.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">cmdline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Cmdline string to be cleared.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r155 r">newest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Order of the entries.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Nothing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b0985d683dc1a658" href="../../R/b0985d683dc1a658.html" target="n" data-glyph="76,1" class="i method">ClearHistoryEntries</a>(<b>long</b> <span id="r152 rd" class="r152 r">id</span>, <b>int</b> <span id="r153 rd" class="r153 r">count</span>, <b>string</b> <span id="r154 rd" class="r154 r">cmdline</span>, <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <span id="r155 rd" class="r155 r">newest</span>)
        {
            <span class="c">// if cmdline is null,use default parameter set notion.</span>
            <b>if</b> (<span class="r154 r">cmdline</span> == <b>null</b>)
            {
                <span class="c">// if id is present,clears count entries from id</span>
                <b>if</b> (<span class="r152 r">id</span> &gt; 0)
                {
                    <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r156 rd" class="r156 r">entry</span> = <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#f0ac590fa434cc6a" class="i method">GetEntry</a>(<span class="r152 r">id</span>);
                    <b>if</b> (<span class="r156 r">entry</span> == <b>null</b> || <span class="r156 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a> != <span class="r152 r">id</span>)
                    {
                        <span class="i">Exception</span> <span id="r157 rd" class="r157 r">ex</span> =
                                   <b>new</b> <span class="i">ArgumentException</span>
                                   (
                                       <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HistoryStrings</span>.<span class="i">NoHistoryForId</span>, <span class="r152 r">id</span>)
                                   );
                        <a href="../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>
                        (
                            <b>new</b> <a href="../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>
                            (
                                <span class="r157 r">ex</span>,
                                <span class="s">&quot;GetHistoryNoHistoryForId&quot;</span>,
                                <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                <span class="r152 r">id</span>
                            )
                        );
                    }
 
                    <a href="#7f6f3085a444704a" class="i field">_entries</a> = <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#b13fc58471a4745e" class="i method">GetEntries</a>(<span class="r152 r">id</span>, <span class="r153 r">count</span>, <span class="r155 r">newest</span>);
                }
                <b>else</b>
                {<span class="c">// if only count is present</span>
                    <a href="#7f6f3085a444704a" class="i field">_entries</a> = <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#b13fc58471a4745e" class="i method">GetEntries</a>(0, <span class="r153 r">count</span>, <span class="r155 r">newest</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// creates a wild card pattern</span>
                <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r158 rd" class="r158 r">wildcardpattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r154 r">cmdline</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <span class="c">// count set to zero if not specified.</span>
                <b>if</b> (!<a href="#6f58cadd3cc3c753" class="i field">_countParameterSpecified</a> &amp;&amp; <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r154 r">cmdline</span>))
                {
                    <span class="r153 r">count</span> = 0;
                }
                <span class="c">// Return the matching history entries for the command line parameter</span>
                <span class="c">// if newest id false...gets the oldest entry</span>
                <a href="#7f6f3085a444704a" class="i field">_entries</a> = <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#bbdb1ea5a02ea062" class="i method">GetEntries</a>(<span class="r158 r">wildcardpattern</span>, <span class="r153 r">count</span>, <span class="r155 r">newest</span>);
            }
 
            <span class="c">// Clear the History value.</span>
            <b>foreach</b> (<a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r159 rd" class="r159 r">entry</span> <b>in</b> <a href="#7f6f3085a444704a" class="i field">_entries</a>)
            {
                <b>if</b> (<span class="r159 r">entry</span> != <b>null</b> &amp;&amp; !<span class="r159 r">entry</span>.<a href="#30c4c35dab843ce6" class="i property">Cleared</a>)
                    <a href="#032f330dd3b210d5" class="i field">_history</a>.<a href="#3f5a9ebac20297a0" class="i method">ClearEntry</a>(<span class="r159 r">entry</span>.<a href="#576ca37cb614e248" class="i property">Id</a>);
            }
 
            <b>return</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> History obj.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#388c8ac2f3fdde97" class="t t">History</a> <a id="032f330dd3b210d5" href="../../R/032f330dd3b210d5.html" target="n" data-glyph="46,1" class="i field">_history</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array of historyinfo objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#aa61f1e3135e278f" class="t t">HistoryInfo</a>[] <a id="7f6f3085a444704a" href="../../R/7f6f3085a444704a.html" target="n" data-glyph="46,1" class="i field">_entries</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private
    }
}
</pre></td></tr></table></div></body></html>
