<!DOCTYPE html>
<html><head><title>parserutils.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(2021);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/lang/parserutils.cs" target="_top">engine\lang\parserutils.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Flow Control Exceptions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> FlowControlException, base class for flow control exceptions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="a3a2a71cfea9c3b1" href="../../R/a3a2a71cfea9c3b1.html" target="n" data-glyph="0,0" class="t t">FlowControlException</a> : <span class="i">SystemException</span>
    {
        <b>internal</b> <a id="f37ec88cbe840ee0" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">FlowControlException</a>() { }
 
        <b>internal</b> <a id="c89df5f7607caacb" href="../../R/c89df5f7607caacb.html" target="n" data-glyph="74,1" class="t constructor">FlowControlException</a>(<span class="i">SerializationInfo</span> <span id="r0 rd" class="r0 r">info</span>, <span class="i">StreamingContext</span> <span id="r1 rd" class="r1 r">context</span>)
            : <b>base</b>(<span class="r0 r">info</span>, <span class="r1 r">context</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> LoopFlowException, base class for loop control exceptions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="7aca1395e161031c" href="../../R/7aca1395e161031c.html" target="n" data-glyph="0,0" class="t t">LoopFlowException</a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
        <b>internal</b> <a id="539803fdbb67251f" href="../../R/539803fdbb67251f.html" target="n" data-glyph="74,1" class="t constructor">LoopFlowException</a>(<b>string</b> <span id="r2 rd" class="r2 r">label</span>)
        {
            <a href="#7aca1395e161031c" class="k">this</a>.<a href="#b564fb6e56608a21" class="i property">Label</a> = <span class="r2 r">label</span> ?? <b>string</b>.<span class="i">Empty</span>;
        }
 
        <b>internal</b> <a id="2adb3aa6d45ce05b" href="../../R/2adb3aa6d45ce05b.html" target="n" data-glyph="74,1" class="t constructor">LoopFlowException</a>(<span class="i">SerializationInfo</span> <span id="r3 rd" class="r3 r">info</span>, <span class="i">StreamingContext</span> <span id="r4 rd" class="r4 r">context</span>)
            : <a href="#c89df5f7607caacb" class="k">base</a>(<span class="r3 r">info</span>, <span class="r4 r">context</span>)
        {
        }
 
        <b>internal</b> <a id="19719d18c79b2d9c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">LoopFlowException</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Label, indicates nested loop level affected by exception.</span>
        <span class="c">///</span><span class="c"> No label means most nested loop is affected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b564fb6e56608a21" href="../../R/b564fb6e56608a21.html" target="n" data-glyph="102,1" class="i property">Label</a>
        {
            <b>get</b>;
            <b>internal set</b>;
        }
 
        <b>internal bool</b> <a id="c87d09bfe7c5c8bd" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">MatchLabel</a>(<b>string</b> <span id="r5 rd" class="r5 r">loopLabel</span>)
        {
            <b>return</b> <a href="#c49cfef7c7727d99" class="i method">MatchLoopLabel</a>(<a href="#b564fb6e56608a21" class="i property">Label</a>, <span class="r5 r">loopLabel</span>);
        }
 
        <b>internal static bool</b> <a id="c49cfef7c7727d99" href="../../R/c49cfef7c7727d99.html" target="n" data-glyph="74,1" class="i method">MatchLoopLabel</a>(<b>string</b> <span id="r6 rd" class="r6 r">flowLabel</span>, <b>string</b> <span id="r7 rd" class="r7 r">loopLabel</span>)
        {
            <span class="c">// If the flow statement has no label, it always matches (because it just means, break or continue from</span>
            <span class="c">// the most nested loop.)  Otherwise, compare the labels.</span>
 
            <b>return</b> <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r6 r">flowLabel</span>) || <span class="r6 r">flowLabel</span>.<span class="i">Equals</span>(<span class="r7 r">loopLabel</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Flow control BreakException.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8b17292837a7f9fe" href="../../R/8b17292837a7f9fe.html" target="n" data-glyph="0,0" class="t t">BreakException</a> : <a href="#7aca1395e161031c" class="t t">LoopFlowException</a>
    {
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="8f32ecbb38761c18" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">BreakException</a>(<b>string</b> <span id="r8 rd" class="r8 r">label</span>)
            : <a href="#539803fdbb67251f" class="k">base</a>(<span class="r8 r">label</span>)
        {
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="91b054cbfa815173" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">BreakException</a>() { }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="3952eed55faba094" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">BreakException</a>(<b>string</b> <span id="r9 rd" class="r9 r">label</span>, <span class="i">Exception</span> <span id="r10 rd" class="r10 r">innerException</span>)
            : <a href="#539803fdbb67251f" class="k">base</a>(<span class="r9 r">label</span>)
        {
        }
 
        <b>private</b> <a id="13d57fd11a3c7dee" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">BreakException</a>(<span class="i">SerializationInfo</span> <span id="r11 rd" class="r11 r">info</span>, <span class="i">StreamingContext</span> <span id="r12 rd" class="r12 r">context</span>)
            : <a href="#2adb3aa6d45ce05b" class="k">base</a>(<span class="r11 r">info</span>, <span class="r12 r">context</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Flow control ContinueException.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="bef3416feb6ab79b" href="../../R/bef3416feb6ab79b.html" target="n" data-glyph="0,0" class="t t">ContinueException</a> : <a href="#7aca1395e161031c" class="t t">LoopFlowException</a>
    {
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="3e73baf036acd47d" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ContinueException</a>(<b>string</b> <span id="r13 rd" class="r13 r">label</span>)
            : <a href="#539803fdbb67251f" class="k">base</a>(<span class="r13 r">label</span>)
        {
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="8f25f3cd2c29f0ad" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ContinueException</a>() { }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="f86ae081607c9e01" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ContinueException</a>(<b>string</b> <span id="r14 rd" class="r14 r">label</span>, <span class="i">Exception</span> <span id="r15 rd" class="r15 r">innerException</span>)
            : <a href="#539803fdbb67251f" class="k">base</a>(<span class="r14 r">label</span>)
        {
        }
 
        <b>private</b> <a id="783be1078667e0bf" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">ContinueException</a>(<span class="i">SerializationInfo</span> <span id="r16 rd" class="r16 r">info</span>, <span class="i">StreamingContext</span> <span id="r17 rd" class="r17 r">context</span>)
            : <a href="#2adb3aa6d45ce05b" class="k">base</a>(<span class="r16 r">info</span>, <span class="r17 r">context</span>)
        {
        }
    }
 
    <b>internal class</b> <a id="d6097919ed356bbf" href="../../R/d6097919ed356bbf.html" target="n" data-glyph="2,0" class="t t">ReturnException</a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
        <b>internal</b> <a id="2ca1e3eb897b3f42" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ReturnException</a>(<b>object</b> <span id="r18 rd" class="r18 r">argument</span>)
        {
            <a href="#d6097919ed356bbf" class="k">this</a>.<a href="#3e6a520f9b1d651a" class="i property">Argument</a> = <span class="r18 r">argument</span>;
        }
 
        <b>internal object</b> <a id="3e6a520f9b1d651a" href="../../R/3e6a520f9b1d651a.html" target="n" data-glyph="104,1" class="i property">Argument</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implements the exit keyword.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="79de2587ceb4dc25" href="../../R/79de2587ceb4dc25.html" target="n" data-glyph="0,0" class="t t">ExitException</a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="e341b629da66363d" href="../../R/e341b629da66363d.html" target="n" data-glyph="74,1" class="t constructor">ExitException</a>(<b>object</b> <span id="r19 rd" class="r19 r">argument</span>)
        {
            <a href="#79de2587ceb4dc25" class="k">this</a>.<a href="#d1b0e4525b48e0c9" class="i property">Argument</a> = <span class="r19 r">argument</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="d1b0e4525b48e0c9" href="../../R/d1b0e4525b48e0c9.html" target="n" data-glyph="102,1" class="i property">Argument</a> { <b>get</b>; <b>internal set</b>; }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>internal</b> <a id="4cb1e7e4251d4ea4" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ExitException</a>() { }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1032:ImplementStandardExceptionConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This exception should only be thrown from SMA.dll&quot;</span>)]
        <b>private</b> <a id="28710dbb5ae626b7" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">ExitException</a>(<span class="i">SerializationInfo</span> <span id="r20 rd" class="r20 r">info</span>, <span class="i">StreamingContext</span> <span id="r21 rd" class="r21 r">context</span>)
            : <a href="#c89df5f7607caacb" class="k">base</a>(<span class="r20 r">info</span>, <span class="r21 r">context</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used by InternalHost.ExitNestedPrompt() to pop out of an interpreter level...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="714b20adffed66d6" href="../../R/714b20adffed66d6.html" target="n" data-glyph="2,0" class="t t"><span id="be281838473c1aa9">ExitNestedPromptException</span></a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used by the debugger to terminate the execution of the current command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="4ea179424ce76612" href="../../R/4ea179424ce76612.html" target="n" data-glyph="0,0" class="t t"><span id="2281ecdd28f2c522">TerminateException</span></a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used by Select-Object cmdlet to stop all the upstream cmdlets, but continue</span>
    <span class="c">///</span><span class="c"> executing downstream cmdlets.  The semantics of stopping is intended to mimic</span>
    <span class="c">///</span><span class="c"> a user pressing Ctrl-C [but which only affects upstream cmdlets].</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="3b761558ff868bf6" href="../../R/3b761558ff868bf6.html" target="n" data-glyph="2,0" class="t t">StopUpstreamCommandsException</a> : <a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>
    {
        <b>public</b> <a id="53e5b0ae85924330" href="../../R/53e5b0ae85924330.html" target="n" data-glyph="72,1" class="t constructor">StopUpstreamCommandsException</a>(<a href="../CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a> <span id="r22 rd" class="r22 r">requestingCommand</span>)
        {
            <a href="#3b761558ff868bf6" class="k">this</a>.<a href="#1135dc32e644b9de" class="i property">RequestingCommandProcessor</a> = <span class="r22 r">requestingCommand</span>.<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>;
        }
 
        <b>public</b> <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <a id="1135dc32e644b9de" href="../../R/1135dc32e644b9de.html" target="n" data-glyph="102,1" class="i property">RequestingCommandProcessor</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Flow Control Exceptions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A enum corresponding to the options on the -split operator.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="b52c239d614308bb" href="../../R/b52c239d614308bb.html" target="n" data-glyph="18,0" class="t t"><span id="4b2e2901d3245be1">SplitOptions</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use simple string comparison when evaluating the delimiter.</span>
        <span class="c">///</span><span class="c"> Cannot be used with RegexMatch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="eb959019ed71d2dd" href="../../R/eb959019ed71d2dd.html" target="n" data-glyph="24,1" class="i field">SimpleMatch</a> = 0x01,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use regular expression matching to evaluate the delimiter.</span>
        <span class="c">///</span><span class="c"> This is the default behavior. Cannot be used with SimpleMatch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2d312d1131270031" href="../../R/2d312d1131270031.html" target="n" data-glyph="24,1" class="i field">RegexMatch</a> = 0x02,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CultureInvariant: Ignores cultural differences in language when evaluating the delimiter.</span>
        <span class="c">///</span><span class="c"> Valid only with RegexMatch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="380d2b4639b12799" href="../../R/380d2b4639b12799.html" target="n" data-glyph="24,1" class="i field">CultureInvariant</a> = 0x04,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ignores unescaped whitespace and comments marked with #.</span>
        <span class="c">///</span><span class="c"> Valid only with RegexMatch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Whitespace&quot;</span>)]
        <a id="8df70ea7cc89a6be" href="../../R/8df70ea7cc89a6be.html" target="n" data-glyph="24,1" class="i field">IgnorePatternWhitespace</a> = 0x08,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Regex multiline mode, which recognizes the start and end of lines,</span>
        <span class="c">///</span><span class="c"> as well as the start and end of strings.</span>
        <span class="c">///</span><span class="c"> Valid only with RegexMatch.</span>
        <span class="c">///</span><span class="c"> Singleline is the default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="60c2612f7b9a2826" href="../../R/60c2612f7b9a2826.html" target="n" data-glyph="24,1" class="i field">Multiline</a> = 0x10,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Regex Singleline mode, which recognizes only the start and end of strings.</span>
        <span class="c">///</span><span class="c"> Valid only with RegexMatch.</span>
        <span class="c">///</span><span class="c"> Singleline is the default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b06c26e91e1f28d6" href="../../R/b06c26e91e1f28d6.html" target="n" data-glyph="24,1" class="i field">Singleline</a> = 0x20,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Forces case-insensitive matching, even if -cSplit is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="50822c8a397a179c" href="../../R/50822c8a397a179c.html" target="n" data-glyph="24,1" class="i field">IgnoreCase</a> = 0x40,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ignores non-named match groups, so that only explicit capture groups</span>
        <span class="c">///</span><span class="c"> are returned in the result list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b8391cfa3dea151d" href="../../R/b8391cfa3dea151d.html" target="n" data-glyph="24,1" class="i field">ExplicitCapture</a> = 0x80,
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ParserOps
 
    <b>internal delegate object</b> <a id="71dcc29d908208fe" href="../../R/../../0000000000.html" target="n" data-glyph="14,0" class="t t"><span id="dc62a09a26a68cf7">PowerShellBinaryOperator</span></a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r23 rd" class="r23 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r24 rd" class="r24 r">errorPosition</span>, <b>object</b> <span id="r25 rd" class="r25 r">lval</span>, <b>object</b> <span id="r26 rd" class="r26 r">rval</span>);
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A static class holding various operations specific to the msh interpreter such as</span>
    <span class="c">///</span><span class="c"> various math operations, ToString() and a routine to extract the base object from an</span>
    <span class="c">///</span><span class="c"> PSObject in a canonical fashion.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="c3c23681c37cee0a" href="../../R/c3c23681c37cee0a.html" target="n" data-glyph="2,0" class="t t">ParserOps</a>
    {
        <b>internal const string</b> <a id="f809211b8b82f3f2" href="../../R/f809211b8b82f3f2.html" target="n" data-glyph="8,1" class="i field">MethodNotFoundErrorId</a> = <span class="s">&quot;MethodNotFound&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct the various caching structures used by the runtime routines...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="5691199a0e361036" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">ParserOps</a>()
        {
            <span class="c">// Cache for ints and chars to avoid overhead of boxing every time...</span>
            <b>for</b> (<b>int</b> <span id="r27 rd" class="r27 r">i</span> = 0; <span class="r27 r">i</span> &lt; (<a href="#5ea0a0939cdea063" class="i field">_MaxCache</a> - <a href="#54e47c5c278a117e" class="i field">_MinCache</a>); <span class="r27 r">i</span>++)
            {
                <a href="#bdba0037320584c3" class="i field">s_integerCache</a>[<span class="r27 r">i</span>] = (<b>object</b>)(<span class="r27 r">i</span> + <a href="#54e47c5c278a117e" class="i field">_MinCache</a>);
            }
 
            <b>for</b> (<b>char</b> <span id="r28 rd" class="r28 r">ch</span> = (<b>char</b>)0; <span class="r28 r">ch</span> &lt; 255; <span class="r28 r">ch</span>++)
            {
                <a href="#7bc56f452f6c2727" class="i field">s_chars</a>[<span class="r28 r">ch</span>] = <b>new</b> <b>string</b>(<span class="r28 r">ch</span>, 1);
            }
        }
 
        <b>private const int</b> <a id="54e47c5c278a117e" href="../../R/54e47c5c278a117e.html" target="n" data-glyph="10,1" class="i field">_MinCache</a> = -100;
        <b>private const int</b> <a id="5ea0a0939cdea063" href="../../R/5ea0a0939cdea063.html" target="n" data-glyph="10,1" class="i field">_MaxCache</a> = 1000;
 
        <b>private static readonly object</b>[] <a id="bdba0037320584c3" href="../../R/bdba0037320584c3.html" target="n" data-glyph="46,1" class="i field">s_integerCache</a> = <b>new</b> <b>object</b>[<a href="#5ea0a0939cdea063" class="i field">_MaxCache</a> - <a href="#54e47c5c278a117e" class="i field">_MinCache</a>];
        <b>private static readonly string</b>[] <a id="7bc56f452f6c2727" href="../../R/7bc56f452f6c2727.html" target="n" data-glyph="46,1" class="i field">s_chars</a> = <b>new</b> <b>string</b>[255];
        <b>internal static readonly object</b> <a id="001e66f2c84599d8" href="../../R/001e66f2c84599d8.html" target="n" data-glyph="44,1" class="i field">_TrueObject</a> = (<b>object</b>)<b>true</b>;
        <b>internal static readonly object</b> <a id="31378a9a50c98218" href="../../R/31378a9a50c98218.html" target="n" data-glyph="44,1" class="i field">_FalseObject</a> = (<b>object</b>)<b>false</b>;
 
        <b>internal static string</b> <a id="27265b6f306263a6" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CharToString</a>(<b>char</b> <span id="r29 rd" class="r29 r">ch</span>)
        {
            <b>if</b> (<span class="r29 r">ch</span> &lt; 255) <b>return</b> <a href="#7bc56f452f6c2727" class="i field">s_chars</a>[<span class="r29 r">ch</span>];
            <b>return</b> <b>new</b> <b>string</b>(<span class="r29 r">ch</span>, 1);
        }
 
        <b>internal static object</b> <a id="54fac34e4ea24d13" href="../../R/54fac34e4ea24d13.html" target="n" data-glyph="74,1" class="i method">BoolToObject</a>(<b>bool</b> <span id="r30 rd" class="r30 r">value</span>)
        {
            <b>return</b> <span class="r30 r">value</span> ? <a href="#001e66f2c84599d8" class="i field">_TrueObject</a> : <a href="#31378a9a50c98218" class="i field">_FalseObject</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert an object into an int, avoiding boxing small integers...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The int to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The reference equivalent.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="9f2105ed3e73e957" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IntToObject</a>(<b>int</b> <span id="r31 rd" class="r31 r">value</span>)
        {
            <b>if</b> (<span class="r31 r">value</span> &lt; <a href="#5ea0a0939cdea063" class="i field">_MaxCache</a> &amp;&amp; <span class="r31 r">value</span> &gt;= <a href="#54e47c5c278a117e" class="i field">_MinCache</a>)
            {
                <b>return</b> <a href="#bdba0037320584c3" class="i field">s_integerCache</a>[<span class="r31 r">value</span> - <a href="#54e47c5c278a117e" class="i field">_MinCache</a>];
            }
 
            <b>return</b> (<b>object</b>)<span class="r31 r">value</span>;
        }
 
        <b>internal static</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="f49d09f3854546b1" href="../../R/f49d09f3854546b1.html" target="n" data-glyph="74,1" class="i method">WrappedNumber</a>(<b>object</b> <span id="r32 rd" class="r32 r">data</span>, <b>string</b> <span id="r33 rd" class="r33 r">text</span>)
        {
            <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r34 rd" class="r34 r">wrapped</span> = <b>new</b> <a href="../MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<span class="r32 r">data</span>);
            <span class="r34 r">wrapped</span>.<a href="../MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a> = <span class="r33 r">text</span>;
            <b>return</b> <span class="r34 r">wrapped</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper routine that turns the argument object into an</span>
        <span class="c">///</span><span class="c"> integer. It handles PSObject and conversions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The result could not be represented as an integer.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="d4576285318e98ec" href="../../R/d4576285318e98ec.html" target="n" data-glyph="74,1" class="i method">FixNum</a>(<b>object</b> <span id="r35 rd" class="r35 r">obj</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r36 rd" class="r36 r">errorPosition</span>)
        {
            <span class="r35 r">obj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r35 r">obj</span>);
 
            <b>if</b> (<span class="r35 r">obj</span> == <b>null</b>)
                <b>return</b> 0;
            <b>if</b> (<span class="r35 r">obj</span> <b>is int</b>)
                <b>return</b> (<b>int</b>)<span class="r35 r">obj</span>;
            <b>int</b> <span id="r37 rd" class="r37 r">result</span> = <a href="#e27ca21481dc9c96" class="i method">ConvertTo</a>&lt;<b>int</b>&gt;(<span class="r35 r">obj</span>, <span class="r36 r">errorPosition</span>);
            <b>return</b> <span class="r37 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a helper function for converting an object to a particular type.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> It will throw exception with information about token representing the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r38 r t">T</span> <a id="e27ca21481dc9c96" href="../../R/e27ca21481dc9c96.html" target="n" data-glyph="74,1" class="i method">ConvertTo</a>&lt;<span id="r38 rd t" class="r38 r t">T</span>&gt;(<b>object</b> <span id="r39 rd" class="r39 r">obj</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r40 rd" class="r40 r">errorPosition</span>)
        {
            <span class="r38 r t">T</span> <span id="r41 rd" class="r41 r">result</span>;
 
            <b>try</b>
            {
                <span class="r41 r">result</span> = (<span class="r38 r t">T</span>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r39 r">obj</span>, <b>typeof</b>(<span class="r38 r t">T</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<a href="../ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r42 rd" class="r42 r">mice</span>)
            {
                <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r43 rd" class="r43 r">re</span> = <b>new</b> <span class="t">RuntimeException</span>(<span class="r42 r">mice</span>.<span class="i">Message</span>, <span class="r42 r">mice</span>);
                <span class="r43 r">re</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r40 r">errorPosition</span>));
                <b>throw</b> <span class="r43 r">re</span>;
            }
 
            <b>return</b> <span class="r41 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Private method used to call the op_* operations for the math operators.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">op</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the operation method to perform.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">errorOp</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to use in error messages representing the op.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operation.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An error occurred performing the operation, see inner exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="f7842dc94592a663" href="../../R/f7842dc94592a663.html" target="n" data-glyph="74,1" class="i method">ImplicitOp</a>(<b>object</b> <span id="r44 rd" class="r44 r">lval</span>, <b>object</b> <span id="r45 rd" class="r45 r">rval</span>, <b>string</b> <span id="r46 rd" class="r46 r">op</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r47 rd" class="r47 r">errorPosition</span>, <b>string</b> <span id="r48 rd" class="r48 r">errorOp</span>)
        {
            <span class="c">// Get the base object. At somepoint, we may allow users to dynamically extend</span>
            <span class="c">// the implicit operators at which point, we&#39;ll need to change this to find the</span>
            <span class="c">// extension method...</span>
            <span class="r44 r">lval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r44 r">lval</span>);
            <span class="r45 r">rval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r45 r">rval</span>);
 
            <span class="i">Type</span> <span id="r49 rd" class="r49 r">lvalType</span> = <span class="r44 r">lval</span>?.<span class="i">GetType</span>();
            <span class="i">Type</span> <span id="r50 rd" class="r50 r">rvalType</span> = <span class="r45 r">rval</span>?.<span class="i">GetType</span>();
            <span class="i">Type</span> <span id="r51 rd" class="r51 r">opType</span>;
            <b>if</b> (<span class="r49 r">lvalType</span> == <b>null</b> || (<span class="r49 r">lvalType</span>.<span class="i">IsPrimitive</span>))
            {
                <span class="c">// Prefer the LHS type when looking for the operator, but attempt the right</span>
                <span class="c">// the lhs can&#39;t have an operator.</span>
                <span class="c">//</span>
                <span class="c">// This logic is overly simplified and doesn&#39;t match other languages which</span>
                <span class="c">// would look for overloads in both types, but this logic covers the most common</span>
                <span class="c">// cases.</span>
 
                <span class="r51 r">opType</span> = (<span class="r50 r">rvalType</span> == <b>null</b> || <span class="r50 r">rvalType</span>.<span class="i">IsPrimitive</span>) ? <b>null</b> : <span class="r50 r">rvalType</span>;
            }
            <b>else</b>
            {
                <span class="r51 r">opType</span> = <span class="r49 r">lvalType</span>;
            }
 
            <b>if</b> (<span class="r51 r">opType</span> == <b>null</b>)
            {
                <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r44 r">lval</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r47 r">errorPosition</span>,
                    <span class="s">&quot;NotADefinedOperationForType&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">NotADefinedOperationForType</span>,
                    <span class="r49 r">lvalType</span> == <b>null</b> ? <span class="s">&quot;$null&quot;</span> : <span class="r49 r">lvalType</span>.<span class="i">FullName</span>,
                    <span class="r48 r">errorOp</span>,
                    <span class="r50 r">rvalType</span> == <b>null</b> ? <span class="s">&quot;$null&quot;</span> : <span class="r50 r">rvalType</span>.<span class="i">FullName</span>);
            }
 
            <span class="c">// None of the explicit conversions worked so try and invoke a method instead...</span>
            <b>object</b>[] <span id="r52 rd" class="r52 r">parms</span> = <b>new</b> <b>object</b>[2];
            <span class="r52 r">parms</span>[0] = <span class="r44 r">lval</span>;
            <span class="r52 r">parms</span>[1] = <span class="r45 r">rval</span>;
            <b>return</b> <span class="i">CallMethod</span>(
                <span class="r47 r">errorPosition</span>,
                <span class="r51 r">opType</span>,
                <span class="r46 r">op</span>, <span class="c">/* methodName */</span>
                <b>null</b>, <span class="c">/* invocationConstraints */</span>
                <span class="r52 r">parms</span>,
                <b>true</b>,
                <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>);
        }
 
        [<span class="i">Flags</span>]
        <b>private enum</b> <a id="2578b7def9fc239d" href="../../R/2578b7def9fc239d.html" target="n" data-glyph="22,1" class="t t"><span id="c64a7e0c7708570e">SplitImplOptions</span></a>
        {
            <a id="f0fb4c100f4445a5" href="../../R/f0fb4c100f4445a5.html" target="n" data-glyph="24,2" class="i field">None</a> = 0x00,
            <a id="d9b525241b8b5b33" href="../../R/d9b525241b8b5b33.html" target="n" data-glyph="24,2" class="i field">TrimContent</a> = 0x01,
        }
 
        <b>private static object</b>[] <a id="826c2c5da0b3a72d" href="../../R/826c2c5da0b3a72d.html" target="n" data-glyph="76,1" class="i method">unfoldTuple</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r53 rd" class="r53 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r54 rd" class="r54 r">errorPosition</span>, <b>object</b> <span id="r55 rd" class="r55 r">tuple</span>)
        {
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r56 rd" class="r56 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <span class="i">IEnumerator</span> <span id="r57 rd" class="r57 r">enumerator</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r55 r">tuple</span>);
            <b>if</b> (<span class="r57 r">enumerator</span> != <b>null</b>)
            {
                <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r53 r">context</span>, <span class="r54 r">errorPosition</span>, <span class="r57 r">enumerator</span>))
                {
                    <b>object</b> <span id="r58 rd" class="r58 r">element</span> = <a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#4c90bd640fcb396f" class="i method">Current</a>(<span class="r54 r">errorPosition</span>, <span class="r57 r">enumerator</span>);
                    <span class="r56 r">result</span>.<span class="i">Add</span>(<span class="r58 r">element</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// Not a tuple at all, just a single item. Treat it</span>
                <span class="c">// as a 1-tuple.</span>
                <span class="r56 r">result</span>.<span class="i">Add</span>(<span class="r55 r">tuple</span>);
            }
 
            <b>return</b> <span class="r56 r">result</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">// uses &quot;yield&quot; from C# 2.0, which automatically creates</span>
        <span class="c">// an enumerable out of the loop code. See</span>
        <span class="c">// https://msdn.microsoft.com/msdnmag/issues/04/05/C20/ for</span>
        <span class="c">// more details.</span>
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="17c349722786f2d1" href="../../R/17c349722786f2d1.html" target="n" data-glyph="76,1" class="i method">enumerateContent</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r59 rd" class="r59 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r60 rd" class="r60 r">errorPosition</span>, <a href="#2578b7def9fc239d" class="t t">SplitImplOptions</a> <span id="r61 rd" class="r61 r">implOptions</span>, <b>object</b> <span id="r62 rd" class="r62 r">tuple</span>)
        {
            <span class="i">IEnumerator</span> <span id="r63 rd" class="r63 r">enumerator</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r62 r">tuple</span>) ?? <b>new</b> <b>object</b>[] { <span class="r62 r">tuple</span> }.<span class="i">GetEnumerator</span>();
 
            <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r59 r">context</span>, <span class="r60 r">errorPosition</span>, <span class="r63 r">enumerator</span>))
            {
                <b>string</b> <span id="r64 rd" class="r64 r">strValue</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">ToStringParser</span>(<span class="r59 r">context</span>, <span class="r63 r">enumerator</span>.<span class="i">Current</span>);
                <b>if</b> ((<span class="r61 r">implOptions</span> &amp; <a href="#2578b7def9fc239d" class="t t">SplitImplOptions</a>.<a href="#d9b525241b8b5b33" class="i field">TrimContent</a>) != 0)
                    <span class="r64 r">strValue</span> = <span class="r64 r">strValue</span>.<span class="i">Trim</span>();
 
                <b>yield</b> <b>return</b> <span class="r64 r">strValue</span>;
            }
        }
 
        <b>private static</b> <span class="i">RegexOptions</span> <a id="81ba39e7b2d0d0cf" href="../../R/81ba39e7b2d0d0cf.html" target="n" data-glyph="76,1" class="i method">parseRegexOptions</a>(<a href="#b52c239d614308bb" class="t t">SplitOptions</a> <span id="r65 rd" class="r65 r">options</span>)
        {
            <span class="i">RegexOptions</span> <span id="r66 rd" class="r66 r">result</span> = <span class="i">RegexOptions</span>.<span class="i">None</span>;
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#380d2b4639b12799" class="i field">CultureInvariant</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">CultureInvariant</span>;
            }
 
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#8df70ea7cc89a6be" class="i field">IgnorePatternWhitespace</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">IgnorePatternWhitespace</span>;
            }
 
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#60c2612f7b9a2826" class="i field">Multiline</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">Multiline</span>;
            }
 
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#b06c26e91e1f28d6" class="i field">Singleline</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">Singleline</span>;
            }
 
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#50822c8a397a179c" class="i field">IgnoreCase</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>;
            }
 
            <b>if</b> ((<span class="r65 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#b8391cfa3dea151d" class="i field">ExplicitCapture</a>) != 0)
            {
                <span class="r66 r">result</span> |= <span class="i">RegexOptions</span>.<span class="i">ExplicitCapture</span>;
            }
 
            <b>return</b> <span class="r66 r">result</span>;
        }
 
        <b>internal static object</b> <a id="033573967a7b89fd" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">UnarySplitOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r67 rd" class="r67 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r68 rd" class="r68 r">errorPosition</span>, <b>object</b> <span id="r69 rd" class="r69 r">lval</span>)
        {
            <span class="c">// unary split does a little extra processing to make</span>
            <span class="c">// whitespace processing more convenient. Specifically,</span>
            <span class="c">// it will ignore leading/trailing whitespace.</span>
            <b>return</b> <a href="#7e27c999345689b0" class="i method">SplitOperatorImpl</a>(<span class="r67 r">context</span>, <span class="r68 r">errorPosition</span>, <span class="r69 r">lval</span>, <b>new</b> <b>object</b>[] { <span class="s">@&quot;\s+&quot;</span> }, <a href="#2578b7def9fc239d" class="t t">SplitImplOptions</a>.<a href="#d9b525241b8b5b33" class="i field">TrimContent</a>, <b>false</b>);
        }
 
        <b>internal static object</b> <a id="163c4428ac28c443" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SplitOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r70 rd" class="r70 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r71 rd" class="r71 r">errorPosition</span>, <b>object</b> <span id="r72 rd" class="r72 r">lval</span>, <b>object</b> <span id="r73 rd" class="r73 r">rval</span>, <b>bool</b> <span id="r74 rd" class="r74 r">ignoreCase</span>)
        {
            <b>return</b> <a href="#7e27c999345689b0" class="i method">SplitOperatorImpl</a>(<span class="r70 r">context</span>, <span class="r71 r">errorPosition</span>, <span class="r72 r">lval</span>, <span class="r73 r">rval</span>, <a href="#2578b7def9fc239d" class="t t">SplitImplOptions</a>.<a href="#f0fb4c100f4445a5" class="i field">None</a>, <span class="r74 r">ignoreCase</span>);
        }
 
        <b>private static</b> <span class="i">IReadOnlyList</span>&lt;<b>string</b>&gt; <a id="7e27c999345689b0" href="../../R/7e27c999345689b0.html" target="n" data-glyph="76,1" class="i method">SplitOperatorImpl</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r75 rd" class="r75 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r76 rd" class="r76 r">errorPosition</span>, <b>object</b> <span id="r77 rd" class="r77 r">lval</span>, <b>object</b> <span id="r78 rd" class="r78 r">rval</span>, <a href="#2578b7def9fc239d" class="t t">SplitImplOptions</a> <span id="r79 rd" class="r79 r">implOptions</span>, <b>bool</b> <span id="r80 rd" class="r80 r">ignoreCase</span>)
        {
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r81 rd" class="r81 r">content</span> = <a href="#17c349722786f2d1" class="i method">enumerateContent</a>(<span class="r75 r">context</span>, <span class="r76 r">errorPosition</span>, <span class="r79 r">implOptions</span>, <span class="r77 r">lval</span>);
 
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r82 rd" class="r82 r">predicate</span> = <b>null</b>;
            <b>string</b> <span id="r83 rd" class="r83 r">separatorPattern</span> = <b>null</b>;
            <b>int</b> <span id="r84 rd" class="r84 r">limit</span> = 0;
            <a href="#b52c239d614308bb" class="t t">SplitOptions</a> <span id="r85 rd" class="r85 r">options</span> = 0;
 
            <b>object</b>[] <span id="r86 rd" class="r86 r">args</span> = <a href="#826c2c5da0b3a72d" class="i method">unfoldTuple</a>(<span class="r75 r">context</span>, <span class="r76 r">errorPosition</span>, <span class="r78 r">rval</span>);
            <b>if</b> (<span class="r86 r">args</span>.<span class="i">Length</span> &gt;= 1)
            {
                <span class="r82 r">predicate</span> = <span class="r86 r">args</span>[0] <b>as</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>;
                <b>if</b> (<span class="r82 r">predicate</span> == <b>null</b>)
                {
                    <span class="r83 r">separatorPattern</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r75 r">context</span>, <span class="r86 r">args</span>[0]);
                }
            }
            <b>else</b>
            {
                <span class="c">// The first argument to split is always required.</span>
                <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r78 r">rval</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r76 r">errorPosition</span>,
                    <span class="s">&quot;BadOperatorArgument&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">BadOperatorArgument</span>, <span class="s">&quot;-split&quot;</span>, <span class="r78 r">rval</span>);
            }
 
            <b>if</b> (<span class="r86 r">args</span>.<span class="i">Length</span> &gt;= 2)
                <span class="r84 r">limit</span> = <a href="#d4576285318e98ec" class="i method">FixNum</a>(<span class="r86 r">args</span>[1], <span class="r76 r">errorPosition</span>);
            <b>if</b> (<span class="r86 r">args</span>.<span class="i">Length</span> &gt;= 3 &amp;&amp; <span class="r86 r">args</span>[2] != <b>null</b>)
            {
                <b>string</b> <span id="r87 rd" class="r87 r">args2asString</span> = <span class="r86 r">args</span>[2] <b>as string</b>;
                <b>if</b> (<span class="r87 r">args2asString</span> == <b>null</b> || !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r87 r">args2asString</span>))
                {
                    <span class="r85 r">options</span> = <a href="#e27ca21481dc9c96" class="i method">ConvertTo</a>&lt;<a href="#b52c239d614308bb" class="t t">SplitOptions</a>&gt;(<span class="r86 r">args</span>[2], <span class="r76 r">errorPosition</span>);
                    <b>if</b> (<span class="r82 r">predicate</span> != <b>null</b>)
                    {
                        <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a>),
                            <span class="r76 r">errorPosition</span>, <span class="s">&quot;InvalidSplitOptionWithPredicate&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">InvalidSplitOptionWithPredicate</span>);
                    }
 
                    <b>if</b> (<span class="r80 r">ignoreCase</span> &amp;&amp; (<span class="r85 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#50822c8a397a179c" class="i field">IgnoreCase</a>) == 0)
                    {
                        <span class="r85 r">options</span> |= <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#50822c8a397a179c" class="i field">IgnoreCase</a>;
                    }
                }
            }
            <b>else</b> <b>if</b> (<span class="r80 r">ignoreCase</span>)
            {
                <span class="r85 r">options</span> |= <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#50822c8a397a179c" class="i field">IgnoreCase</a>;
            }
 
            <b>if</b> (<span class="r82 r">predicate</span> == <b>null</b>)
            {
                <b>return</b> <a href="#d41f72d292b07979" class="i method">SplitWithPattern</a>(<span class="r75 r">context</span>, <span class="r76 r">errorPosition</span>, <span class="r81 r">content</span>, <span class="r83 r">separatorPattern</span>, <span class="r84 r">limit</span>, <span class="r85 r">options</span>);
            }
            <b>else</b> <b>if</b> (<span class="r84 r">limit</span> &gt;= 0)
            {
                <b>return</b> <a href="#fd047babf441d40b" class="i method">SplitWithPredicate</a>(<span class="r75 r">context</span>, <span class="r76 r">errorPosition</span>, <span class="r81 r">content</span>, <span class="r82 r">predicate</span>, <span class="r84 r">limit</span>);
            }
            <b>else</b>
            {
                <b>return</b> <a href="#1a4c1640dd265eaf" class="i method">NegativeSplitWithPredicate</a>(<span class="r75 r">context</span>, <span class="r76 r">errorPosition</span>, <span class="r81 r">content</span>, <span class="r82 r">predicate</span>, <span class="r84 r">limit</span>);
            }
        }
 
        <b>private static</b> <span class="i">IReadOnlyList</span>&lt;<b>string</b>&gt; <a id="1a4c1640dd265eaf" href="../../R/1a4c1640dd265eaf.html" target="n" data-glyph="76,1" class="i method">NegativeSplitWithPredicate</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r88 rd" class="r88 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r89 rd" class="r89 r">errorPosition</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r90 rd" class="r90 r">content</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r91 rd" class="r91 r">predicate</span>, <b>int</b> <span id="r92 rd" class="r92 r">limit</span>)
        {
            <b>var</b> <span id="r93 rd" class="r93 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <b>if</b> (<span class="r92 r">limit</span> == -1)
            {
                <span class="c">// If the user just wants 1 string</span>
                <span class="c">// then just return the content</span>
                <b>return</b> <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r90 r">content</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r94 rd" class="r94 r">item</span> <b>in</b> <span class="r90 r">content</span>)
            {
                <b>var</b> <span id="r95 rd" class="r95 r">split</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <span class="c">// Used to traverse through the item</span>
                <b>int</b> <span id="r96 rd" class="r96 r">cursor</span> = <span class="r94 r">item</span>.<span class="i">Length</span> - 1;
 
                <b>int</b> <span id="r97 rd" class="r97 r">subStringLength</span> = 0;
 
                <b>for</b> (<b>int</b> <span id="r98 rd" class="r98 r">charCount</span> = 0; <span class="r98 r">charCount</span> &lt; <span class="r94 r">item</span>.<span class="i">Length</span>; <span class="r98 r">charCount</span>++)
                {
                    <span class="c">// Evaluate the predicate using the character at cursor.</span>
                    <b>object</b> <span id="r99 rd" class="r99 r">predicateResult</span> = <span class="r91 r">predicate</span>.<a href="scriptblock.cs.html#c9191394af92013a" class="i method">DoInvokeReturnAsIs</a>(
                        <span class="r100 r">useLocalScope</span>: <b>true</b>,
                        <span class="r101 r">errorHandlingBehavior</span>: <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="scriptblock.cs.html#df0061919fb37a15" class="i field">WriteToExternalErrorPipe</a>,
                        <span class="r102 r">dollarUnder</span>: <span class="i">CharToString</span>(<span class="r94 r">item</span>[<span class="r96 r">cursor</span>]),
                        <span class="r103 r">input</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="r104 r">scriptThis</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="r105 r">args</span>: <b>new</b> <b>object</b>[] { <span class="r94 r">item</span>, <span class="r96 r">cursor</span> });
 
                    <b>if</b> (!<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#7b42a860769a8de5" class="i method">IsTrue</a>(<span class="r99 r">predicateResult</span>))
                    {
                        <span class="r97 r">subStringLength</span>++;
                        <span class="r96 r">cursor</span> -= 1;
                        <b>continue</b>;
                    }
 
                    <span class="r95 r">split</span>.<span class="i">Add</span>(<span class="r94 r">item</span>.<span class="i">Substring</span>(<span class="r96 r">cursor</span> + 1, <span class="r97 r">subStringLength</span>));
 
                    <span class="r97 r">subStringLength</span> = 0;
 
                    <span class="r96 r">cursor</span> -= 1;
 
                    <b>if</b> (<span class="i n">System</span>.<span class="i">Math</span>.<span class="i">Abs</span>(<span class="r92 r">limit</span>) == (<span class="r95 r">split</span>.<span class="i">Count</span> + 1))
                    {
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r96 r">cursor</span> == -1)
                {
                    <span class="c">// Used when the limit is negative</span>
                    <span class="c">// and the cursor was allowed to go</span>
                    <span class="c">// all the way to the start of the</span>
                    <span class="c">// string.</span>
                    <span class="r95 r">split</span>.<span class="i">Add</span>(<span class="r94 r">item</span>.<span class="i">Substring</span>(0, <span class="r97 r">subStringLength</span>));
                }
                <b>else</b>
                {
                    <span class="c">// Used to get the rest of the string</span>
                    <span class="c">// when using a negative limit and</span>
                    <span class="c">// the cursor doesn&#39;t reach the end</span>
                    <span class="c">// of the string.</span>
                    <span class="r95 r">split</span>.<span class="i">Add</span>(<span class="r94 r">item</span>.<span class="i">Substring</span>(0, <span class="r96 r">cursor</span> + 1));
                }
 
                <span class="r95 r">split</span>.<span class="i">Reverse</span>();
 
                <span class="r93 r">results</span>.<span class="i">AddRange</span>(<span class="r95 r">split</span>);
            }
 
            <b>return</b> <span class="r93 r">results</span>.<span class="i">ToArray</span>();
        }
 
        <b>private static</b> <span class="i">IReadOnlyList</span>&lt;<b>string</b>&gt; <a id="fd047babf441d40b" href="../../R/fd047babf441d40b.html" target="n" data-glyph="76,1" class="i method">SplitWithPredicate</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r106 rd" class="r106 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r107 rd" class="r107 r">errorPosition</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r108 rd" class="r108 r">content</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r109 rd" class="r109 r">predicate</span>, <b>int</b> <span id="r110 rd" class="r110 r">limit</span>)
        {
            <b>var</b> <span id="r111 rd" class="r111 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <b>if</b> (<span class="r110 r">limit</span> == 1)
            {
                <span class="c">// If the user just wants 1 string</span>
                <span class="c">// then just return the content</span>
                <b>return</b> <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r108 r">content</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r112 rd" class="r112 r">item</span> <b>in</b> <span class="r108 r">content</span>)
            {
                <b>var</b> <span id="r113 rd" class="r113 r">split</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <span class="c">// Used to traverse through the item</span>
                <b>int</b> <span id="r114 rd" class="r114 r">cursor</span> = 0;
 
                <span class="c">// This is used to calculate how much to split from item.</span>
                <b>int</b> <span id="r115 rd" class="r115 r">subStringLength</span> = 0;
 
                <b>for</b> (<b>int</b> <span id="r116 rd" class="r116 r">charCount</span> = 0; <span class="r116 r">charCount</span> &lt; <span class="r112 r">item</span>.<span class="i">Length</span>; <span class="r116 r">charCount</span>++)
                {
                    <span class="c">// Evaluate the predicate using the character at cursor.</span>
                    <b>object</b> <span id="r117 rd" class="r117 r">predicateResult</span> = <span class="r109 r">predicate</span>.<a href="scriptblock.cs.html#c9191394af92013a" class="i method">DoInvokeReturnAsIs</a>(
                        <span class="r100 r">useLocalScope</span>: <b>true</b>,
                        <span class="r101 r">errorHandlingBehavior</span>: <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="scriptblock.cs.html#df0061919fb37a15" class="i field">WriteToExternalErrorPipe</a>,
                        <span class="r102 r">dollarUnder</span>: <span class="i">CharToString</span>(<span class="r112 r">item</span>[<span class="r114 r">cursor</span>]),
                        <span class="r103 r">input</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="r104 r">scriptThis</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="r105 r">args</span>: <b>new</b> <b>object</b>[] { <span class="r112 r">item</span>, <span class="r114 r">cursor</span> });
 
                    <span class="c">// If the current character is not a delimiter</span>
                    <span class="c">// then it must be included into a substring.</span>
                    <b>if</b> (!<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#7b42a860769a8de5" class="i method">IsTrue</a>(<span class="r117 r">predicateResult</span>))
                    {
                        <span class="r115 r">subStringLength</span>++;
 
                        <span class="r114 r">cursor</span> += 1;
 
                        <b>continue</b>;
                    }
 
                    <span class="c">// Else, if the character is a delimiter</span>
                    <span class="c">// then add a substring to the split list.</span>
                    <span class="r113 r">split</span>.<span class="i">Add</span>(<span class="r112 r">item</span>.<span class="i">Substring</span>(<span class="r114 r">cursor</span> - <span class="r115 r">subStringLength</span>, <span class="r115 r">subStringLength</span>));
 
                    <span class="r115 r">subStringLength</span> = 0;
 
                    <span class="r114 r">cursor</span> += 1;
 
                    <b>if</b> (<span class="r110 r">limit</span> == (<span class="r113 r">split</span>.<span class="i">Count</span> + 1))
                    {
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r114 r">cursor</span> == <span class="r112 r">item</span>.<span class="i">Length</span>)
                {
                    <span class="c">// Used to get the rest of the string</span>
                    <span class="c">// when the limit is not negative and</span>
                    <span class="c">// the cursor is allowed to make it to</span>
                    <span class="c">// the end of the string.</span>
                    <span class="r113 r">split</span>.<span class="i">Add</span>(<span class="r112 r">item</span>.<span class="i">Substring</span>(<span class="r114 r">cursor</span> - <span class="r115 r">subStringLength</span>, <span class="r115 r">subStringLength</span>));
                }
                <b>else</b>
                {
                    <span class="c">// Used to get the rest of the string</span>
                    <span class="c">// when the limit is not negative and</span>
                    <span class="c">// the cursor is not at the end of the</span>
                    <span class="c">// string.</span>
                    <span class="r113 r">split</span>.<span class="i">Add</span>(<span class="r112 r">item</span>.<span class="i">Substring</span>(<span class="r114 r">cursor</span>, <span class="r112 r">item</span>.<span class="i">Length</span> - <span class="r114 r">cursor</span>));
                }
 
                <span class="r111 r">results</span>.<span class="i">AddRange</span>(<span class="r113 r">split</span>);
            }
 
            <b>return</b> <span class="r111 r">results</span>.<span class="i">ToArray</span>();
        }
 
        <b>private static</b> <span class="i">IReadOnlyList</span>&lt;<b>string</b>&gt; <a id="d41f72d292b07979" href="../../R/d41f72d292b07979.html" target="n" data-glyph="76,1" class="i method">SplitWithPattern</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r118 rd" class="r118 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r119 rd" class="r119 r">errorPosition</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r120 rd" class="r120 r">content</span>, <b>string</b> <span id="r121 rd" class="r121 r">separatorPattern</span>, <b>int</b> <span id="r122 rd" class="r122 r">limit</span>, <a href="#b52c239d614308bb" class="t t">SplitOptions</a> <span id="r123 rd" class="r123 r">options</span>)
        {
            <span class="c">// Default to Regex matching if no match specified.</span>
            <b>if</b> ((<span class="r123 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#eb959019ed71d2dd" class="i field">SimpleMatch</a>) == 0 &amp;&amp;
                (<span class="r123 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#2d312d1131270031" class="i field">RegexMatch</a>) == 0)
            {
                <span class="r123 r">options</span> |= <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#2d312d1131270031" class="i field">RegexMatch</a>;
            }
 
            <b>if</b> ((<span class="r123 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#eb959019ed71d2dd" class="i field">SimpleMatch</a>) != 0)
            {
                <b>if</b> ((<span class="r123 r">options</span> &amp; ~(<a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#eb959019ed71d2dd" class="i field">SimpleMatch</a> | <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#50822c8a397a179c" class="i field">IgnoreCase</a>)) != 0)
                {
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a>),
                        <span class="r119 r">errorPosition</span>, <span class="s">&quot;InvalidSplitOptionCombination&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">InvalidSplitOptionCombination</span>);
                }
            }
 
            <b>if</b> ((<span class="r123 r">options</span> &amp; <a href="#b52c239d614308bb" class="t t">SplitOptions</a>.<a href="#eb959019ed71d2dd" class="i field">SimpleMatch</a>) != 0)
            {
                <span class="r121 r">separatorPattern</span> = <span class="i">Regex</span>.<span class="i">Escape</span>(<span class="r121 r">separatorPattern</span>);
            }
 
            <span class="i">RegexOptions</span> <span id="r124 rd" class="r124 r">regexOptions</span> = <a href="#81ba39e7b2d0d0cf" class="i method">parseRegexOptions</a>(<span class="r123 r">options</span>);
 
            <b>int</b> <span id="r125 rd" class="r125 r">calculatedLimit</span> = <span class="r122 r">limit</span>;
 
            <span class="c">// If the limit is negative then set Regex to read from right to left</span>
            <b>if</b> (<span class="r125 r">calculatedLimit</span> &lt; 0)
            {
                <span class="r124 r">regexOptions</span> |= <span class="i">RegexOptions</span>.<span class="i">RightToLeft</span>;
                <span class="r125 r">calculatedLimit</span> *= -1;
            }
 
            <span class="i">Regex</span> <span id="r126 rd" class="r126 r">regex</span> = <a href="#b8dcd7dc42e75a79" class="i method">NewRegex</a>(<span class="r121 r">separatorPattern</span>, <span class="r124 r">regexOptions</span>);
 
            <b>var</b> <span id="r127 rd" class="r127 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <b>foreach</b> (<b>string</b> <span id="r128 rd" class="r128 r">item</span> <b>in</b> <span class="r120 r">content</span>)
            {
                <b>string</b>[] <span id="r129 rd" class="r129 r">split</span> = <span class="r126 r">regex</span>.<span class="i">Split</span>(<span class="r128 r">item</span>, <span class="r125 r">calculatedLimit</span>);
                <span class="r127 r">results</span>.<span class="i">AddRange</span>(<span class="r129 r">split</span>);
            }
 
            <b>return</b> <span class="r127 r">results</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell unary -join operator...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="e8f8aa35911307cf" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">UnaryJoinOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r130 rd" class="r130 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r131 rd" class="r131 r">errorPosition</span>, <b>object</b> <span id="r132 rd" class="r132 r">lval</span>)
        {
            <b>return</b> <span class="i">JoinOperator</span>(<span class="r130 r">context</span>, <span class="r131 r">errorPosition</span>, <span class="r132 r">lval</span>, <b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell binary -join operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="122f0505379a5966" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">JoinOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r133 rd" class="r133 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r134 rd" class="r134 r">errorPosition</span>, <b>object</b> <span id="r135 rd" class="r135 r">lval</span>, <b>object</b> <span id="r136 rd" class="r136 r">rval</span>)
        {
            <b>string</b> <span id="r137 rd" class="r137 r">separator</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r133 r">context</span>, <span class="r136 r">rval</span>);
 
            <span class="c">// PSObject already has join functionality; just expose it</span>
            <span class="c">// as an operator.</span>
            <span class="i">IEnumerable</span> <span id="r138 rd" class="r138 r">enumerable</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r135 r">lval</span>);
            <b>if</b> (<span class="r138 r">enumerable</span> != <b>null</b>)
            {
                <b>return</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#1576938cd9601319" class="i method">ToStringEnumerable</a>(<span class="r133 r">context</span>, <span class="r138 r">enumerable</span>, <span class="r137 r">separator</span>, <b>null</b>, <b>null</b>);
            }
            <b>else</b>
            {
                <b>return</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r133 r">context</span>, <span class="r135 r">lval</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The implementation of the PowerShell range operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object on which to start.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object on which to stop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The array of objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="adcb6e5441feb781" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RangeOperator</a>(<b>object</b> <span id="r139 rd" class="r139 r">lval</span>, <b>object</b> <span id="r140 rd" class="r140 r">rval</span>)
        {
            <b>var</b> <span id="r141 rd" class="r141 r">lbase</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r139 r">lval</span>);
            <b>var</b> <span id="r142 rd" class="r142 r">rbase</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r140 r">rval</span>);
 
            <span class="c">// If both arguments is [char] type or [string] type with length==1</span>
            <span class="c">// return objects of [char] type.</span>
            <span class="c">// In special case &quot;0&quot;..&quot;9&quot; return objects of [int] type.</span>
            <b>if</b> (<a href="#ce0b078e8df66141" class="i method">AsChar</a>(<span class="r141 r">lbase</span>) <b>is char</b> <span id="r143 rd" class="r143 r">lc</span> &amp;&amp; <a href="#ce0b078e8df66141" class="i method">AsChar</a>(<span class="r142 r">rbase</span>) <b>is char</b> <span id="r144 rd" class="r144 r">rc</span>)
            {
                <b>return</b> <a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>.<a href="../runtime/Operations/NumericOps.cs.html#aba565bda49dbf7d" class="i method">Range</a>(<span class="r143 r">lc</span>, <span class="r144 r">rc</span>);
            }
 
            <span class="c">// As a last resort, the range operator tries to return objects of [int] type.</span>
            <span class="c">//    1..10</span>
            <span class="c">//    &quot;1&quot;..&quot;10&quot;</span>
            <span class="c">//    [int]&quot;1&quot;..[int]&quot;10&quot;</span>
            <b>var</b> <span id="r145 rd" class="r145 r">l</span> = <span class="i">Convert</span>.<span class="i">ToInt32</span>(<span class="r141 r">lbase</span>);
            <b>var</b> <span id="r146 rd" class="r146 r">r</span> = <span class="i">Convert</span>.<span class="i">ToInt32</span>(<span class="r142 r">rbase</span>);
 
            <b>return</b> <a href="../runtime/Operations/NumericOps.cs.html#b02fae75dda9e4ee" class="t t">IntOps</a>.<span class="i">Range</span>(<span class="r145 r">l</span>, <span class="r146 r">r</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The implementation of an enumerator for the PowerShell range operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object on which to start.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r148 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object on which to stop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The enumerator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IEnumerator</span> <a id="9619d2f28c29e727" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetRangeEnumerator</a>(<b>object</b> <span id="r147 rd" class="r147 r">lval</span>, <b>object</b> <span id="r148 rd" class="r148 r">rval</span>)
        {
            <b>var</b> <span id="r149 rd" class="r149 r">lbase</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r147 r">lval</span>);
            <b>var</b> <span id="r150 rd" class="r150 r">rbase</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r148 r">rval</span>);
 
            <span class="c">// If both arguments is [char] type or [string] type with length==1</span>
            <span class="c">// return objects of [char] type.</span>
            <span class="c">// In special case &quot;0&quot;..&quot;9&quot; return objects of [int] type.</span>
            <b>if</b> (<a href="#ce0b078e8df66141" class="i method">AsChar</a>(<span class="r149 r">lbase</span>) <b>is char</b> <span id="r151 rd" class="r151 r">lc</span> &amp;&amp; <a href="#ce0b078e8df66141" class="i method">AsChar</a>(<span class="r150 r">rbase</span>) <b>is char</b> <span id="r152 rd" class="r152 r">rc</span>)
            {
                <b>return</b> <b>new</b> <a href="#1ce4c526982aa14c" class="t constructor">CharRangeEnumerator</a>(<span class="r151 r">lc</span>, <span class="r152 r">rc</span>);
            }
 
            <span class="c">// As a last resort, the range operator tries to return objects of [int] type.</span>
            <span class="c">//    1..10</span>
            <span class="c">//    &quot;1&quot;..&quot;10&quot;</span>
            <span class="c">//    [int]&quot;1&quot;..[int]&quot;10&quot;</span>
            <b>var</b> <span id="r153 rd" class="r153 r">l</span> = <span class="i">Convert</span>.<span class="i">ToInt32</span>(<span class="r149 r">lbase</span>);
            <b>var</b> <span id="r154 rd" class="r154 r">r</span> = <span class="i">Convert</span>.<span class="i">ToInt32</span>(<span class="r150 r">rbase</span>);
 
            <b>return</b> <b>new</b> <span class="t">RangeEnumerator</span>(<span class="r153 r">l</span>, <span class="r154 r">r</span>);
        }
 
        <span class="c">// Help function for Range operator.</span>
        <span class="c">//</span>
        <span class="c">// In common case:</span>
        <span class="c">//      for [char] type</span>
        <span class="c">//      for [string] type and length == 1</span>
        <span class="c">// return objects of [char] type:</span>
        <span class="c">//     [char]&#39;A&#39;..[char]&#39;Z&#39;</span>
        <span class="c">//     [char]&#39;A&#39;..&#39;Z&#39;</span>
        <span class="c">//     [char]&#39;A&#39;..&quot;Z&quot;</span>
        <span class="c">//     &#39;A&#39;..[char]&#39;Z&#39;</span>
        <span class="c">//     &quot;A&quot;..[char]&#39;Z&#39;</span>
        <span class="c">//     &quot;A&quot;..&quot;Z&quot;</span>
        <span class="c">//     [char]&quot;A&quot;..[string]&quot;Z&quot;</span>
        <span class="c">//     &quot;A&quot;..[char]&quot;Z&quot;</span>
        <span class="c">//     [string]&quot;A&quot;..&quot;Z&quot;</span>
        <span class="c">// and so on.</span>
        <span class="c">//</span>
        <span class="c">// In special case:</span>
        <span class="c">//     &quot;0&quot;..&quot;9&quot;</span>
        <span class="c">// return objects of [int] type.</span>
        <b>private static object</b> <a id="ce0b078e8df66141" href="../../R/ce0b078e8df66141.html" target="n" data-glyph="76,1" class="i method">AsChar</a>(<b>object</b> <span id="r155 rd" class="r155 r">obj</span>)
        {
            <b>if</b> (<span class="r155 r">obj</span> <b>is char</b>) <b>return</b> <span class="r155 r">obj</span>;
            <b>if</b> (<span class="r155 r">obj</span> <b>is string</b> <span id="r156 rd" class="r156 r">str</span> &amp;&amp; <span class="r156 r">str</span>.<span class="i">Length</span> == 1 &amp;&amp; !<b>char</b>.<span class="i">IsDigit</span>(<span class="r156 r">str</span>, 0)) <b>return</b> <span class="r156 r">str</span>[0];
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The implementation of the PowerShell -replace operator....</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context in which to evaluate the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r159 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object on which to replace the values.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The replacement description.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r161 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True for -ireplace/-replace, false for -creplace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="6b85add3c097e86d" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReplaceOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r157 rd" class="r157 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r158 rd" class="r158 r">errorPosition</span>, <b>object</b> <span id="r159 rd" class="r159 r">lval</span>, <b>object</b> <span id="r160 rd" class="r160 r">rval</span>, <b>bool</b> <span id="r161 rd" class="r161 r">ignoreCase</span>)
        {
            <b>object</b> <span id="r162 rd" class="r162 r">pattern</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>object</b> <span id="r163 rd" class="r163 r">substitute</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <span class="r160 r">rval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r160 r">rval</span>);
            <span class="i">IList</span> <span id="r164 rd" class="r164 r">rList</span> = <span class="r160 r">rval</span> <b>as</b> <span class="i">IList</span>;
            <b>if</b> (<span class="r164 r">rList</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r164 r">rList</span>.<span class="i">Count</span> &gt; 2)
                {
                    <span class="c">// only allow 1 or 2 arguments to -replace</span>
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r160 r">rval</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r158 r">errorPosition</span>,
                        <span class="s">&quot;BadReplaceArgument&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">BadReplaceArgument</span>, <span class="r158 r">errorPosition</span>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>, <span class="r164 r">rList</span>.<span class="i">Count</span>);
                }
 
                <b>if</b> (<span class="r164 r">rList</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r162 r">pattern</span> = <span class="r164 r">rList</span>[0];
                    <b>if</b> (<span class="r164 r">rList</span>.<span class="i">Count</span> &gt; 1)
                    {
                        <span class="r163 r">substitute</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r164 r">rList</span>[1]);
                    }
                }
            }
            <b>else</b>
            {
                <span class="r162 r">pattern</span> = <span class="r160 r">rval</span>;
            }
 
            <span class="i">RegexOptions</span> <span id="r165 rd" class="r165 r">rreOptions</span> = <span class="i">RegexOptions</span>.<span class="i">None</span>;
 
            <b>if</b> (<span class="r161 r">ignoreCase</span>)
            {
                <span class="r165 r">rreOptions</span> = <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>;
            }
 
            <span class="i">Regex</span> <span id="r166 rd" class="r166 r">rr</span> = <span class="r162 r">pattern</span> <b>as</b> <span class="i">Regex</span>;
            <b>if</b> (<span class="r166 r">rr</span> == <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r166 r">rr</span> = <a href="#b8dcd7dc42e75a79" class="i method">NewRegex</a>((<b>string</b>)<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r157 r">context</span>, <span class="r162 r">pattern</span>), <span class="r165 r">rreOptions</span>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r167 rd" class="r167 r">ae</span>)
                {
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(<span class="r162 r">pattern</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <b>null</b>, <span class="s">&quot;InvalidRegularExpression&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">InvalidRegularExpression</span>, <span class="r167 r">ae</span>, <span class="r162 r">pattern</span>);
                }
            }
 
            <a href="#f5fcab2e6dcc45b0" class="k">var</a> <span id="r168 rd" class="r168 r">replacer</span> = <a href="#f5fcab2e6dcc45b0" class="t t">ReplaceOperatorImpl</a>.<a href="#a9fcd067ab247b2f" class="i method">Create</a>(<span class="r157 r">context</span>, <span class="r166 r">rr</span>, <span class="r163 r">substitute</span>);
            <span class="i">IEnumerator</span> <span id="r169 rd" class="r169 r">list</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r159 r">lval</span>);
            <b>if</b> (<span class="r169 r">list</span> == <b>null</b>)
            {
                <b>string</b> <span id="r170 rd" class="r170 r">lvalString</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r157 r">context</span>, <span class="r159 r">lval</span>) ?? <b>string</b>.<span class="i">Empty</span>;
 
                <b>return</b> <span class="r168 r">replacer</span>.<a href="#86ddad9d2390274c" class="i method">Replace</a>(<span class="r170 r">lvalString</span>);
            }
            <b>else</b>
            {
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r171 rd" class="r171 r">resultList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
                <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r157 r">context</span>, <span class="r158 r">errorPosition</span>, <span class="r169 r">list</span>))
                {
                    <b>string</b> <span id="r172 rd" class="r172 r">lvalString</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r157 r">context</span>, <a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#4c90bd640fcb396f" class="i method">Current</a>(<span class="r158 r">errorPosition</span>, <span class="r169 r">list</span>));
                    <span class="r171 r">resultList</span>.<span class="i">Add</span>(<span class="r168 r">replacer</span>.<a href="#86ddad9d2390274c" class="i method">Replace</a>(<span class="r172 r">lvalString</span>));
                }
 
                <b>return</b> <span class="r171 r">resultList</span>.<span class="i">ToArray</span>();
            }
        }
 
        <b>private struct</b> <a id="f5fcab2e6dcc45b0" href="../../R/f5fcab2e6dcc45b0.html" target="n" data-glyph="112,1" class="t t"><span id="fa263c6f640ecd7d">ReplaceOperatorImpl</span></a>
        {
            <b>public static</b> <a href="#f5fcab2e6dcc45b0" class="t t">ReplaceOperatorImpl</a> <a id="a9fcd067ab247b2f" href="../../R/a9fcd067ab247b2f.html" target="n" data-glyph="72,2" class="i method">Create</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r173 rd" class="r173 r">context</span>, <span class="i">Regex</span> <span id="r174 rd" class="r174 r">regex</span>, <b>object</b> <span id="r175 rd" class="r175 r">substitute</span>)
            {
                <b>return</b> <b>new</b> <a href="#b429eaa7f8199b6c" class="t constructor">ReplaceOperatorImpl</a>(<span class="r173 r">context</span>, <span class="r174 r">regex</span>, <span class="r175 r">substitute</span>);
            }
 
            <b>private readonly</b> <span class="i">Regex</span> <a id="036ca0e565df3e8a" href="../../R/036ca0e565df3e8a.html" target="n" data-glyph="46,2" class="i field">_regex</a>;
            <b>private readonly string</b> <a id="84d1826d22d07395" href="../../R/84d1826d22d07395.html" target="n" data-glyph="46,2" class="i field">_cachedReplacementString</a>;
            <b>private readonly</b> <span class="i">MatchEvaluator</span> <a id="88b68516397c193e" href="../../R/88b68516397c193e.html" target="n" data-glyph="46,2" class="i field">_cachedMatchEvaluator</a>;
 
            <b>private</b> <a id="b429eaa7f8199b6c" href="../../R/b429eaa7f8199b6c.html" target="n" data-glyph="76,2" class="t constructor">ReplaceOperatorImpl</a>(
                <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r176 rd" class="r176 r">context</span>,
                <span class="i">Regex</span> <span id="r177 rd" class="r177 r">regex</span>,
                <b>object</b> <span id="r178 rd" class="r178 r">substitute</span>)
            {
                <a href="#036ca0e565df3e8a" class="i field">_regex</a> = <span class="r177 r">regex</span>;
                <a href="#84d1826d22d07395" class="i field">_cachedReplacementString</a> = <b>null</b>;
                <a href="#88b68516397c193e" class="i field">_cachedMatchEvaluator</a> = <b>null</b>;
 
                <b>switch</b> (<span class="r178 r">substitute</span>)
                {
                    <b>case</b> <b>string</b> <span id="r179 rd" class="r179 r">replacement</span>:
                        <a href="#84d1826d22d07395" class="i field">_cachedReplacementString</a> = <span class="r179 r">replacement</span>;
                        <b>break</b>;
 
                    <b>case</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r180 rd" class="r180 r">sb</span>:
                        <a href="#88b68516397c193e" class="i field">_cachedMatchEvaluator</a> = <a href="#aa45df90a4817494" class="i method">GetMatchEvaluator</a>(<span class="r176 r">context</span>, <span class="r180 r">sb</span>);
                        <b>break</b>;
 
                    <b>case</b> <b>object</b> <span id="r181 rd" class="r181 r">val</span> <b>when</b> <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<span class="r181 r">val</span>, <b>out</b> <a href="#88b68516397c193e" class="i field">_cachedMatchEvaluator</a>):
                        <b>break</b>;
 
                    <b>default</b>:
                        <a href="#84d1826d22d07395" class="i field">_cachedReplacementString</a> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r176 r">context</span>, <span class="r178 r">substitute</span>);
                        <b>break</b>;
                }
            }
 
            <span class="c">// Local helper function to avoid creating an instance of the generated delegate helper class</span>
            <span class="c">// every time &#39;ReplaceOperatorImpl&#39; is invoked.</span>
            <b>private static</b> <span class="i">MatchEvaluator</span> <a id="aa45df90a4817494" href="../../R/aa45df90a4817494.html" target="n" data-glyph="76,2" class="i method">GetMatchEvaluator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r182 rd" class="r182 r">context</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r183 rd" class="r183 r">sb</span>)
            {
                <b>return</b> <span id="r184 rd" class="r184 r">match</span> =&gt;
                {
                    <b>var</b> <span id="r185 rd" class="r185 r">result</span> = <span class="r183 r">sb</span>.<span class="i">DoInvokeReturnAsIs</span>(
                        <span class="i">useLocalScope</span>: <b>false</b>, <span class="c">/* Use current scope to be consistent with &#39;ForEach/Where-Object {}&#39; and &#39;collection.ForEach{}/Where{}&#39; */</span>
                        <span class="i">errorHandlingBehavior</span>: <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="scriptblock.cs.html#5e78734ffe1c6ed3" class="i field">WriteToCurrentErrorPipe</a>,
                        <span class="i">dollarUnder</span>: <span class="r184 r">match</span>,
                        <span class="i">input</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="i">scriptThis</span>: <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                        <span class="i">args</span>: <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;());
 
                    <b>return</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r182 r">context</span>, <span class="r185 r">result</span>);
                };
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> ReplaceOperator implementation.</span>
            <span class="c">///</span><span class="c"> Abstracts away conversion of the optional substitute parameter to either a string or a MatchEvaluator delegate</span>
            <span class="c">///</span><span class="c"> and finally returns the result of the final Regex.Replace operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public object</b> <a id="86ddad9d2390274c" href="../../R/86ddad9d2390274c.html" target="n" data-glyph="72,2" class="i method">Replace</a>(<b>string</b> <span id="r186 rd" class="r186 r">input</span>)
            {
                <b>if</b> (<a href="#84d1826d22d07395" class="i field">_cachedReplacementString</a> <b>is not null</b>)
                {
                    <b>return</b> <a href="#036ca0e565df3e8a" class="i field">_regex</a>.<span class="i">Replace</span>(<span class="r186 r">input</span>, <a href="#84d1826d22d07395" class="i field">_cachedReplacementString</a>);
                }
 
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#88b68516397c193e" class="i field">_cachedMatchEvaluator</a> <b>is not null</b>, <span class="s">&quot;_cachedMatchEvaluator should be not null when code reach here.&quot;</span>);
                <b>return</b> <a href="#036ca0e565df3e8a" class="i field">_regex</a>.<span class="i">Replace</span>(<span class="r186 r">input</span>, <a href="#88b68516397c193e" class="i field">_cachedMatchEvaluator</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell type operators...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">left</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r190 r">right</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="8fbd571b56d4af38" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r187 rd" class="r187 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r188 rd" class="r188 r">errorPosition</span>, <b>object</b> <span id="r189 rd" class="r189 r">left</span>, <b>object</b> <span id="r190 rd" class="r190 r">right</span>)
        {
            <b>object</b> <span id="r191 rd" class="r191 r">lval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r189 r">left</span>);
            <b>object</b> <span id="r192 rd" class="r192 r">rval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r190 r">right</span>);
 
            <span class="i">Type</span> <span id="r193 rd" class="r193 r">rType</span> = <span class="r192 r">rval</span> <b>as</b> <span class="i">Type</span>;
 
            <b>if</b> (<span class="r193 r">rType</span> == <b>null</b>)
            {
                <span class="r193 r">rType</span> = <a href="#e27ca21481dc9c96" class="i method">ConvertTo</a>&lt;<span class="i">Type</span>&gt;(<span class="r192 r">rval</span>, <span class="r188 r">errorPosition</span>);
 
                <b>if</b> (<span class="r193 r">rType</span> == <b>null</b>)
                {
                    <span class="c">// &quot;the right operand of &#39;-is&#39; must be a type&quot;</span>
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r192 r">rval</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r188 r">errorPosition</span>, <span class="s">&quot;IsOperatorRequiresType&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">IsOperatorRequiresType</span>);
                }
            }
 
            <b>if</b> (<span class="r193 r">rType</span> == <b>typeof</b>(<a href="../MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>) &amp;&amp; <span class="r191 r">lval</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r193 r">rType</span>.<span class="i">IsInstanceOfType</span>(((<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r191 r">lval</span>).<a href="../MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>), <span class="s">&quot;Unexpect PSObject&quot;</span>);
                <b>return</b> <a href="#001e66f2c84599d8" class="i field">_TrueObject</a>;
            }
 
            <b>if</b> (<span class="r193 r">rType</span>.<span class="i">Equals</span>(<b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)) &amp;&amp; <span class="r189 r">left</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <b>return</b> <a href="#001e66f2c84599d8" class="i field">_TrueObject</a>;
            }
 
            <b>return</b> <span class="i">BoolToObject</span>(<span class="r193 r">rType</span>.<span class="i">IsInstanceOfType</span>(<span class="r191 r">lval</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell type operators...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">left</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r197 r">right</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="5bd8755a48a4f511" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsNotOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r194 rd" class="r194 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r195 rd" class="r195 r">errorPosition</span>, <b>object</b> <span id="r196 rd" class="r196 r">left</span>, <b>object</b> <span id="r197 rd" class="r197 r">right</span>)
        {
            <b>object</b> <span id="r198 rd" class="r198 r">lval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r196 r">left</span>);
            <b>object</b> <span id="r199 rd" class="r199 r">rval</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r197 r">right</span>);
 
            <span class="i">Type</span> <span id="r200 rd" class="r200 r">rType</span> = <span class="r199 r">rval</span> <b>as</b> <span class="i">Type</span>;
 
            <b>if</b> (<span class="r200 r">rType</span> == <b>null</b>)
            {
                <span class="r200 r">rType</span> = <a href="#e27ca21481dc9c96" class="i method">ConvertTo</a>&lt;<span class="i">Type</span>&gt;(<span class="r199 r">rval</span>, <span class="r195 r">errorPosition</span>);
 
                <b>if</b> (<span class="r200 r">rType</span> == <b>null</b>)
                {
                    <span class="c">// &quot;the right operand of &#39;-is&#39; must be a type&quot;</span>
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r199 r">rval</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r195 r">errorPosition</span>, <span class="s">&quot;IsOperatorRequiresType&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">IsOperatorRequiresType</span>);
                }
            }
 
            <b>if</b> (<span class="r200 r">rType</span> == <b>typeof</b>(<a href="../MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>) &amp;&amp; <span class="r198 r">lval</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r200 r">rType</span>.<span class="i">IsInstanceOfType</span>(((<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r198 r">lval</span>).<a href="../MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>), <span class="s">&quot;Unexpect PSObject&quot;</span>);
                <b>return</b> <a href="#31378a9a50c98218" class="i field">_FalseObject</a>;
            }
 
            <b>if</b> (<span class="r200 r">rType</span>.<span class="i">Equals</span>(<b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)) &amp;&amp; <span class="r196 r">left</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <b>return</b> <a href="#31378a9a50c98218" class="i field">_FalseObject</a>;
            }
 
            <b>return</b> <span class="i">BoolToObject</span>(!<span class="r200 r">rType</span>.<span class="i">IsInstanceOfType</span>(<span class="r198 r">lval</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell -like operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r201 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r204 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">operator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The operator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="9ce46b65dfafa331" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LikeOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r201 rd" class="r201 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r202 rd" class="r202 r">errorPosition</span>, <b>object</b> <span id="r203 rd" class="r203 r">lval</span>, <b>object</b> <span id="r204 rd" class="r204 r">rval</span>, <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r205 rd" class="r205 r">@operator</span>)
        {
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r206 rd" class="r206 r">wcp</span> = <span class="r204 r">rval</span> <b>as</b> <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>;
            <b>if</b> (<span class="r206 r">wcp</span> == <b>null</b>)
            {
                <b>var</b> <span id="r207 rd" class="r207 r">ignoreCase</span> = <span class="r205 r">@operator</span> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#c54e36505d9969ea" class="i field">Ilike</a> || <span class="r205 r">@operator</span> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#0b21ff7aee97bf81" class="i field">Inotlike</a>;
                <span class="r206 r">wcp</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r201 r">context</span>, <span class="r204 r">rval</span>),
                    <span class="r207 r">ignoreCase</span> ? <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> : <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#b202e40981b139f5" class="i field">None</a>);
            }
 
            <b>bool</b> <span id="r208 rd" class="r208 r">notLike</span> = <span class="r205 r">@operator</span> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#0b21ff7aee97bf81" class="i field">Inotlike</a> || <span class="r205 r">@operator</span> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#440a0e98089143a6" class="i field">Cnotlike</a>;
            <span class="i">IEnumerator</span> <span id="r209 rd" class="r209 r">list</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r203 r">lval</span>);
            <b>if</b> (<span class="r209 r">list</span> == <b>null</b>)
            {
                <b>string</b> <span id="r210 rd" class="r210 r">lvalString</span> = <span class="r203 r">lval</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r201 r">context</span>, <span class="r203 r">lval</span>);
 
                <b>return</b> <span class="i">BoolToObject</span>(<span class="r206 r">wcp</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r210 r">lvalString</span>) ^ <span class="r208 r">notLike</span>);
            }
 
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r211 rd" class="r211 r">resultList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r201 r">context</span>, <span class="r202 r">errorPosition</span>, <span class="r209 r">list</span>))
            {
                <b>object</b> <span id="r212 rd" class="r212 r">val</span> = <a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#4c90bd640fcb396f" class="i method">Current</a>(<span class="r202 r">errorPosition</span>, <span class="r209 r">list</span>);
 
                <b>string</b> <span id="r213 rd" class="r213 r">lvalString</span> = <span class="r212 r">val</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r201 r">context</span>, <span class="r212 r">val</span>);
 
                <b>if</b> (<span class="r206 r">wcp</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r213 r">lvalString</span>) ^ <span class="r208 r">notLike</span>)
                {
                    <span class="r211 r">resultList</span>.<span class="i">Add</span>(<span class="r213 r">lvalString</span>);
                }
            }
 
            <b>return</b> <span class="r211 r">resultList</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell -match operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">lval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">rval</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Ignore case?</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">notMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True for -notmatch, false for -match.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="2b954fa03319b51c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">MatchOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r214 rd" class="r214 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r215 rd" class="r215 r">errorPosition</span>, <b>object</b> <span id="r216 rd" class="r216 r">lval</span>, <b>object</b> <span id="r217 rd" class="r217 r">rval</span>, <b>bool</b> <span id="r219 rd" class="r219 r">notMatch</span>, <b>bool</b> <span id="r218 rd" class="r218 r">ignoreCase</span>)
        {
            <span class="i">RegexOptions</span> <span id="r220 rd" class="r220 r">reOptions</span> = <span class="r218 r">ignoreCase</span> ? <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span> : <span class="i">RegexOptions</span>.<span class="i">None</span>;
 
            <span class="c">// if passed an explicit regex, just use it</span>
            <span class="c">// otherwise compile the expression.</span>
            <span class="c">// In this situation, creation of Regex should not fail. We are not</span>
            <span class="c">// processing ArgumentException in this case.</span>
            <span class="i">Regex</span> <span id="r221 rd" class="r221 r">r</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r217 r">rval</span>) <b>as</b> <span class="i">Regex</span>
                ?? <a href="#b8dcd7dc42e75a79" class="i method">NewRegex</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r214 r">context</span>, <span class="r217 r">rval</span>), <span class="r220 r">reOptions</span>);
 
            <span class="i">IEnumerator</span> <span id="r222 rd" class="r222 r">list</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r216 r">lval</span>);
            <b>if</b> (<span class="r222 r">list</span> == <b>null</b>)
            {
                <b>string</b> <span id="r223 rd" class="r223 r">lvalString</span> = <span class="r216 r">lval</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r214 r">context</span>, <span class="r216 r">lval</span>);
 
                <span class="c">// Find a match in the string.</span>
                <span class="i">Match</span> <span id="r224 rd" class="r224 r">m</span> = <span class="r221 r">r</span>.<span class="i">Match</span>(<span class="r223 r">lvalString</span>);
 
                <b>if</b> (<span class="r224 r">m</span>.<span class="i">Success</span>)
                {
                    <span class="i">GroupCollection</span> <span id="r225 rd" class="r225 r">groups</span> = <span class="r224 r">m</span>.<span class="i">Groups</span>;
                    <b>if</b> (<span class="r225 r">groups</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="i">Hashtable</span> <span id="r226 rd" class="r226 r">h</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">CurrentCultureIgnoreCase</span>);
 
                        <b>foreach</b> (<b>string</b> <span id="r227 rd" class="r227 r">groupName</span> <b>in</b> <span class="r221 r">r</span>.<span class="i">GetGroupNames</span>())
                        {
                            <span class="i">Group</span> <span id="r228 rd" class="r228 r">g</span> = <span class="r225 r">groups</span>[<span class="r227 r">groupName</span>];
                            <b>if</b> (<span class="r228 r">g</span>.<span class="i">Success</span>)
                            {
                                <b>int</b> <span id="r229 rd" class="r229 r">keyInt</span>;
 
                                <b>if</b> (<span class="i">Int32</span>.<span class="i">TryParse</span>(<span class="r227 r">groupName</span>, <b>out</b> <span class="r229 r">keyInt</span>))
                                    <span class="r226 r">h</span>.<span class="i">Add</span>(<span class="r229 r">keyInt</span>, <span class="r228 r">g</span>.<span class="i">ToString</span>());
                                <b>else</b>
                                    <span class="r226 r">h</span>.<span class="i">Add</span>(<span class="r227 r">groupName</span>, <span class="r228 r">g</span>.<span class="i">ToString</span>());
                            }
                        }
 
                        <span class="r214 r">context</span>.<span class="i">SetVariable</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#76b9b435260c9fd7" class="i field">MatchesVarPath</a>, <span class="r226 r">h</span>);
                    }
                }
 
                <b>return</b> <span class="i">BoolToObject</span>(<span class="r224 r">m</span>.<span class="i">Success</span> ^ <span class="r219 r">notMatch</span>);
            }
            <b>else</b>
            {
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r230 rd" class="r230 r">resultList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
                <b>int</b> <span id="r231 rd" class="r231 r">check</span> = 0;
 
                <b>try</b>
                {
                    <b>while</b> (<span class="r222 r">list</span>.<span class="i">MoveNext</span>())
                    {
                        <b>object</b> <span id="r232 rd" class="r232 r">val</span> = <span class="r222 r">list</span>.<span class="i">Current</span>;
 
                        <b>string</b> <span id="r233 rd" class="r233 r">lvalString</span> = <span class="r232 r">val</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<span class="r214 r">context</span>, <span class="r232 r">val</span>);
 
                        <span class="c">// Find a single match in the string.</span>
                        <span class="i">Match</span> <span id="r234 rd" class="r234 r">m</span> = <span class="r221 r">r</span>.<span class="i">Match</span>(<span class="r233 r">lvalString</span>);
 
                        <b>if</b> (<span class="r234 r">m</span>.<span class="i">Success</span> ^ <span class="r219 r">notMatch</span>)
                        {
                            <span class="r230 r">resultList</span>.<span class="i">Add</span>(<span class="r232 r">val</span>);
                        }
 
                        <b>if</b> (<span class="r231 r">check</span>++ &gt; 1000)
                        {
                            <span class="c">// Check to see if we&#39;re stopping every one in a while...</span>
                            <b>if</b> (<span class="r214 r">context</span> != <b>null</b> &amp;&amp; <span class="r214 r">context</span>.<a href="../ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                                <b>throw</b> <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
                            <span class="r231 r">check</span> = 0;
                        }
                    }
 
                    <b>return</b> <span class="r230 r">resultList</span>.<span class="i">ToArray</span>();
                }
                <b>catch</b> (<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r235 rd" class="r235 r">e</span>)
                {
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(<span class="r222 r">list</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r215 r">errorPosition</span>, <span class="s">&quot;BadEnumeration&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">BadEnumeration</span>, <span class="r235 r">e</span>, <span class="r235 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <span class="c">// Implementation of the -contains/-in operators and case insensitive variants.</span>
        <b>internal static bool</b> <a id="0afedbc45d31f8d8" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ContainsOperatorCompiled</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r236 rd" class="r236 r">context</span>,
                                                      <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <span class="i">IEnumerator</span>&gt;&gt; <span id="r237 rd" class="r237 r">getEnumeratorSite</span>,
                                                      <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>object</b>, <b>object</b>&gt;&gt; <span id="r238 rd" class="r238 r">comparerSite</span>,
                                                      <b>object</b> <span id="r239 rd" class="r239 r">left</span>,
                                                      <b>object</b> <span id="r240 rd" class="r240 r">right</span>)
        {
            <span class="i">IEnumerator</span> <span id="r241 rd" class="r241 r">list</span> = <span class="r237 r">getEnumeratorSite</span>.<span class="i">Target</span>.<span class="i">Invoke</span>(<span class="r237 r">getEnumeratorSite</span>, <span class="r239 r">left</span>);
            <b>if</b> (<span class="r241 r">list</span> == <b>null</b> || <span class="r241 r">list</span> <b>is</b> <a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#906468b10c209579" class="t t">NonEnumerableObjectEnumerator</a>)
            {
                <b>return</b> (<b>bool</b>)<span class="r238 r">comparerSite</span>.<span class="i">Target</span>.<span class="i">Invoke</span>(<span class="r238 r">comparerSite</span>, <span class="r239 r">left</span>, <span class="r240 r">right</span>);
            }
 
            <b>while</b> (<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#6ced3521138ce182" class="i method">MoveNext</a>(<span class="r236 r">context</span>, <span class="r241 r">list</span>))
            {
                <b>object</b> <span id="r242 rd" class="r242 r">val</span> = <a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#25e919160dd3b048" class="i method">Current</a>(<span class="r241 r">list</span>);
                <b>if</b> ((<b>bool</b>)<span class="r238 r">comparerSite</span>.<span class="i">Target</span>.<span class="i">Invoke</span>(<span class="r238 r">comparerSite</span>, <span class="r242 r">val</span>, <span class="r240 r">right</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implementation of the PowerShell -contains/-notcontains operators (and case sensitive variants)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r245 r">left</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r246 r">right</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Right operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r247 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Ignore case?</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">contains</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True for -contains, false for -notcontains.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result of the operator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="e5fe24f1e6fa55a0" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ContainsOperator</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r243 rd" class="r243 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r244 rd" class="r244 r">errorPosition</span>, <b>object</b> <span id="r245 rd" class="r245 r">left</span>, <b>object</b> <span id="r246 rd" class="r246 r">right</span>, <b>bool</b> <span id="r248 rd" class="r248 r">contains</span>, <b>bool</b> <span id="r247 rd" class="r247 r">ignoreCase</span>)
        {
            <span class="i">IEnumerator</span> <span id="r249 rd" class="r249 r">list</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r245 r">left</span>);
            <b>if</b> (<span class="r249 r">list</span> == <b>null</b>)
            {
                <b>return</b>
                    <a href="#54fac34e4ea24d13" class="i method">BoolToObject</a>(<span class="r248 r">contains</span> ==
                                 <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">Equals</span>(<span class="r245 r">left</span>, <span class="r246 r">right</span>, <span class="r247 r">ignoreCase</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            }
 
            <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r243 r">context</span>, <span class="r244 r">errorPosition</span>, <span class="r249 r">list</span>))
            {
                <b>object</b> <span id="r250 rd" class="r250 r">val</span> = <a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#4c90bd640fcb396f" class="i method">Current</a>(<span class="r244 r">errorPosition</span>, <span class="r249 r">list</span>);
 
                <b>if</b> (<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">Equals</span>(<span class="r250 r">val</span>, <span class="r246 r">right</span>, <span class="r247 r">ignoreCase</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>))
                {
                    <b>return</b> <a href="#54fac34e4ea24d13" class="i method">BoolToObject</a>(<span class="r248 r">contains</span>);
                }
            }
 
            <b>return</b> <span class="i">BoolToObject</span>(!<span class="r248 r">contains</span>);
        }
 
        <b>internal delegate bool</b> <a id="8eac1b9f6689ff65" href="../../R/8eac1b9f6689ff65.html" target="n" data-glyph="14,1" class="t t"><span id="98c3e025d39717ff">CompareDelegate</span></a>(<b>object</b> <span id="r251 rd" class="r251 r">lhs</span>, <b>object</b> <span id="r252 rd" class="r252 r">rhs</span>, <b>bool</b> <span id="r253 rd" class="r253 r">ignoreCase</span>);
 
        <b>internal static object</b> <a id="d1cbf6846f8f5d48" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CompareOperators</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r254 rd" class="r254 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r255 rd" class="r255 r">errorPosition</span>, <b>object</b> <span id="r256 rd" class="r256 r">left</span>, <b>object</b> <span id="r257 rd" class="r257 r">right</span>, <a href="#8eac1b9f6689ff65" class="t t">CompareDelegate</a> <span id="r258 rd" class="r258 r">compareDelegate</span>, <b>bool</b> <span id="r259 rd" class="r259 r">ignoreCase</span>)
        {
            <span class="i">IEnumerator</span> <span id="r260 rd" class="r260 r">list</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r256 r">left</span>);
            <b>if</b> (<span class="r260 r">list</span> == <b>null</b>)
            {
                <b>return</b> <a href="#54fac34e4ea24d13" class="i method">BoolToObject</a>(<span class="r258 r">compareDelegate</span>(<span class="r256 r">left</span>, <span class="r257 r">right</span>, <span class="r259 r">ignoreCase</span>));
            }
 
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r261 rd" class="r261 r">resultList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
            <b>while</b> (<a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#5cba6b6355dba7e3" class="i method">MoveNext</a>(<span class="r254 r">context</span>, <span class="r255 r">errorPosition</span>, <span class="r260 r">list</span>))
            {
                <b>object</b> <span id="r262 rd" class="r262 r">val</span> = <a href="#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="#4c90bd640fcb396f" class="i method">Current</a>(<span class="r255 r">errorPosition</span>, <span class="r260 r">list</span>);
 
                <b>if</b> (<span class="r258 r">compareDelegate</span>(<span class="r262 r">val</span>, <span class="r257 r">right</span>, <span class="r259 r">ignoreCase</span>))
                {
                    <span class="r261 r">resultList</span>.<span class="i">Add</span>(<span class="r262 r">val</span>);
                }
            }
 
            <b>return</b> <span class="r261 r">resultList</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cache regular expressions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">patternString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to find the pattern for.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The options used to create the regex.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New or cached Regex.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Regex</span> <a id="b8dcd7dc42e75a79" href="../../R/b8dcd7dc42e75a79.html" target="n" data-glyph="74,1" class="i method">NewRegex</a>(<b>string</b> <span id="r263 rd" class="r263 r">patternString</span>, <span class="i">RegexOptions</span> <span id="r264 rd" class="r264 r">options</span>)
        {
            <b>var</b> <span id="r265 rd" class="r265 r">subordinateRegexCache</span> = <a href="#7871e8adc582d794" class="i field">s_regexCache</a>.<span class="i">GetOrAdd</span>(<span class="r264 r">options</span>, <a href="#2acefc50f0e20463" class="i field">s_subordinateRegexCacheCreationDelegate</a>);
            <b>if</b> (<span class="r265 r">subordinateRegexCache</span>.<span class="i">TryGetValue</span>(<span class="r263 r">patternString</span>, <b>out</b> <span class="i">Regex</span> <span id="r266 rd" class="r266 r">result</span>))
            {
                <b>return</b> <span class="r266 r">result</span>;
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r265 r">subordinateRegexCache</span>.<span class="i">Count</span> &gt; <a href="#9412251a1d233fea" class="i field">MaxRegexCache</a>)
                {
                    <span class="c">// TODO: it would be useful to get a notice (in telemetry?) if the cache is full.</span>
                    <span class="r265 r">subordinateRegexCache</span>.<span class="i">Clear</span>();
                }
 
                <b>var</b> <span id="r267 rd" class="r267 r">regex</span> = <b>new</b> <span class="i">Regex</span>(<span class="r263 r">patternString</span>, <span class="r264 r">options</span>);
                <b>return</b> <span class="r265 r">subordinateRegexCache</span>.<span class="i">GetOrAdd</span>(<span class="r263 r">patternString</span>, <span class="r267 r">regex</span>);
            }
        }
 
        <b>private static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">RegexOptions</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Regex</span>&gt;&gt; <a id="7871e8adc582d794" href="../../R/7871e8adc582d794.html" target="n" data-glyph="46,1" class="i field">s_regexCache</a> =
            <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">RegexOptions</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Regex</span>&gt;&gt;();
 
        <b>private static readonly</b> <span class="i">Func</span>&lt;<span class="i">RegexOptions</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Regex</span>&gt;&gt; <a id="2acefc50f0e20463" href="../../R/2acefc50f0e20463.html" target="n" data-glyph="46,1" class="i field">s_subordinateRegexCacheCreationDelegate</a> =
            <span id="r268 rd" class="r268 r">key</span> =&gt; <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Regex</span>&gt;(<span class="i">StringComparer</span>.<span class="i">Ordinal</span>);
 
        <b>private const int</b> <a id="9412251a1d233fea" href="../../R/9412251a1d233fea.html" target="n" data-glyph="10,1" class="i field">MaxRegexCache</a> = 1000;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A routine used to advance an enumerator and catch errors that might occur</span>
        <span class="c">///</span><span class="c"> performing the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r269 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context used to see if the pipeline is stopping.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r270 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">enumerator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">THe enumerator to advance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An error occurred moving to the next element in the enumeration.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the move succeeded.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="5cba6b6355dba7e3" href="../../R/5cba6b6355dba7e3.html" target="n" data-glyph="74,1" class="i method">MoveNext</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r269 rd" class="r269 r">context</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r270 rd" class="r270 r">errorPosition</span>, <span class="i">IEnumerator</span> <span id="r271 rd" class="r271 r">enumerator</span>)
        {
            <b>try</b>
            {
                <span class="c">// Check to see if we&#39;re stopping...</span>
                <b>if</b> (<span class="r269 r">context</span> != <b>null</b> &amp;&amp; <span class="r269 r">context</span>.<a href="../ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                    <b>throw</b> <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
 
                <b>return</b> <span class="r271 r">enumerator</span>.<span class="i">MoveNext</span>();
            }
            <b>catch</b> (<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r272 rd" class="r272 r">e</span>)
            {
                <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(<span class="r271 r">enumerator</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <span class="r270 r">errorPosition</span>, <span class="s">&quot;BadEnumeration&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">BadEnumeration</span>, <span class="r272 r">e</span>, <span class="r272 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrapper caller for enumerator.MoveNext - handles and republishes errors...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r273 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">enumerator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The enumerator to read from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="4c90bd640fcb396f" href="../../R/4c90bd640fcb396f.html" target="n" data-glyph="74,1" class="i method">Current</a>(<a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r273 rd" class="r273 r">errorPosition</span>, <span class="i">IEnumerator</span> <span id="r274 rd" class="r274 r">enumerator</span>)
        {
            <b>try</b>
            {
                <b>return</b> <span class="r274 r">enumerator</span>.<span class="i">Current</span>;
            }
            <b>catch</b> (<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r275 rd" class="r275 r">e</span>)
            {
                <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(<span class="r274 r">enumerator</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <span class="r273 r">errorPosition</span>, <span class="s">&quot;BadEnumeration&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">BadEnumeration</span>, <span class="r275 r">e</span>, <span class="r275 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the obj&#39;s type full name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r276 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object we want to retrieve the type&#39;s full name from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The obj&#39;s type full name.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="da07f094dc9766c8" href="../../R/da07f094dc9766c8.html" target="n" data-glyph="74,1" class="i method">GetTypeFullName</a>(<b>object</b> <span id="r276 rd" class="r276 r">obj</span>)
        {
            <b>if</b> (<span class="r276 r">obj</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (!(<span class="r276 r">obj</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r277 rd" class="r277 r">mshObj</span>))
            {
                <b>return</b> <span class="r276 r">obj</span>.<span class="i">GetType</span>().<span class="i">FullName</span>;
            }
 
            <b>if</b> (<span class="r277 r">mshObj</span>.<a href="../MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">FullName</span>;
            }
 
            <b>return</b> <span class="r277 r">mshObj</span>.<a href="../MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>[0];
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Launch a method on an object. This will handle .NET native methods, COM</span>
        <span class="c">///</span><span class="c"> methods and ScriptBlock notes. Native methods currently take precedence over notes...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r278 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object to call the method on. It shouldn&#39;t be an msh object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the method to call.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">invocationConstraints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation constraints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r282 r">paramArray</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to pass to the method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r283 r">callStatic</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Set to true if you want to call a static method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r284 r">valueToSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If not automation null, then this must be a settable property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Wraps the exception returned from the method call.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Internal exception from a flow control statement.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="3b25901a2e036dd7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CallMethod</a>(
            <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r278 rd" class="r278 r">errorPosition</span>,
            <b>object</b> <span id="r279 rd" class="r279 r">target</span>,
            <b>string</b> <span id="r280 rd" class="r280 r">methodName</span>,
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r281 rd" class="r281 r">invocationConstraints</span>,
            <b>object</b>[] <span id="r282 rd" class="r282 r">paramArray</span>,
            <b>bool</b> <span id="r283 rd" class="r283 r">callStatic</span>,
            <b>object</b> <span id="r284 rd" class="r284 r">valueToSet</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r280 r">methodName</span> != <b>null</b>, <span class="s">&quot;methodName was null&quot;</span>);
 
            <a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a> <span id="r285 rd" class="r285 r">targetMethod</span> = <b>null</b>;
            <b>object</b> <span id="r286 rd" class="r286 r">targetBase</span> = <b>null</b>;
            <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r287 rd" class="r287 r">targetAsPSObject</span> = <b>null</b>;
 
            <b>do</b>
            {
                <b>if</b> (<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#cf665fbdc4612d9d" class="i method">IsNull</a>(<span class="r279 r">target</span>))
                {
                    <span class="c">// &quot;you can&#39;t call a method on null&quot;</span>
                    <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r280 r">methodName</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r278 r">errorPosition</span>, <span class="s">&quot;InvokeMethodOnNull&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">InvokeMethodOnNull</span>);
                }
 
                <span class="r286 r">targetBase</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r279 r">target</span>);
                <span class="r287 r">targetAsPSObject</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r279 r">target</span>);
 
                <span class="i">Type</span> <span id="r288 rd" class="r288 r">targetType</span>;
                <b>if</b> (<span class="r283 r">callStatic</span>)
                {
                    <span class="r288 r">targetType</span> = (<span class="i">Type</span>)<span class="r286 r">targetBase</span>;
                }
                <b>else</b>
                {
                    <span class="r288 r">targetType</span> = <span class="r286 r">targetBase</span>.<span class="i">GetType</span>();
                }
 
                <b>if</b> (<span class="r283 r">callStatic</span>)
                {
                    <span class="r285 r">targetMethod</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#ab8f37f21c281edc" class="i method">GetStaticCLRMember</a>(<span class="r279 r">target</span>, <span class="r280 r">methodName</span>) <b>as</b> <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>;
                }
                <b>else</b>
                {
                    <span class="r285 r">targetMethod</span> = <span class="r287 r">targetAsPSObject</span>.<a href="../MshObject.cs.html#56bc82b240e4291b" class="i property">Members</a><a href="../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r280 r">methodName</span>] <b>as</b> <a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>;
                }
 
                <b>if</b> (<span class="r285 r">targetMethod</span> == <b>null</b>)
                {
                    <b>string</b> <span id="r289 rd" class="r289 r">typeFullName</span> = <b>null</b>;
                    <b>if</b> (<span class="r283 r">callStatic</span>)
                    {
                        <span class="r289 r">typeFullName</span> = <span class="r288 r">targetType</span>.<span class="i">FullName</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r289 r">typeFullName</span> = <a href="#da07f094dc9766c8" class="i method">GetTypeFullName</a>(<span class="r279 r">target</span>);
                    }
 
                    <b>if</b> (<span class="r284 r">valueToSet</span> == <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                    {
                        <span class="c">// &quot;[{0}] doesn&#39;t contain a method named &#39;{1}&#39;&quot;</span>
                        <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r280 r">methodName</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r278 r">errorPosition</span>,
                            <a href="#f809211b8b82f3f2" class="i field">MethodNotFoundErrorId</a>, <span class="i">ParserStrings</span>.<span class="i">MethodNotFound</span>, <span class="r289 r">typeFullName</span>, <span class="r280 r">methodName</span>);
                    }
                    <b>else</b>
                    {
                        <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r280 r">methodName</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r278 r">errorPosition</span>,
                            <span class="s">&quot;ParameterizedPropertyAssignmentFailed&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">ParameterizedPropertyAssignmentFailed</span>, <span class="r289 r">typeFullName</span>, <span class="r280 r">methodName</span>);
                    }
                }
            } <b>while</b> (<b>false</b>);
 
            <b>try</b>
            {
                <span class="c">// If there is a property to set, then this is a multi-parameter property assignment</span>
                <span class="c">// not really a method call.</span>
                <b>if</b> (<span class="r284 r">valueToSet</span> != <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                {
                    <b>if</b> (!(<span class="r285 r">targetMethod</span> <b>is</b> <a href="../MshMemberInfo.cs.html#c06615b4d3a255aa" class="t t">PSParameterizedProperty</a> <span id="r290 rd" class="r290 r">propertyToSet</span>))
                    {
                        <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r280 r">methodName</span>, <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r278 r">errorPosition</span>,
                                                                       <span class="s">&quot;ParameterizedPropertyAssignmentFailed&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">ParameterizedPropertyAssignmentFailed</span>, <a href="#da07f094dc9766c8" class="i method">GetTypeFullName</a>(<span class="r279 r">target</span>), <span class="r280 r">methodName</span>);
                    }
 
                    <span class="r290 r">propertyToSet</span>.<a href="../MshMemberInfo.cs.html#b2b8b98e2a7d3564" class="i method">InvokeSet</a>(<span class="r284 r">valueToSet</span>, <span class="r282 r">paramArray</span>);
                    <b>return</b> <span class="r284 r">valueToSet</span>;
                }
                <b>else</b>
                {
                    <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a> <span id="r291 rd" class="r291 r">adaptedMethod</span> = <span class="r285 r">targetMethod</span> <b>as</b> <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>;
                    <b>if</b> (<span class="r291 r">adaptedMethod</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r291 r">adaptedMethod</span>.<a href="../MshMemberInfo.cs.html#d64a5a7a1fb8c17f" class="i method">Invoke</a>(<span class="r281 r">invocationConstraints</span>, <span class="r282 r">paramArray</span>);
                    }
                    <b>else</b>
                    {
                        <b>return</b> <span class="r285 r">targetMethod</span>.<a href="../MshMemberInfo.cs.html#f4f9695891d65945" class="i method">Invoke</a>(<span class="r282 r">paramArray</span>);
                    }
                }
            }
            <b>catch</b> (<a href="../ExtendedTypeSystemException.cs.html#e6dcf9b0f6d4c9f1" class="t t">MethodInvocationException</a> <span id="r292 rd" class="r292 r">mie</span>)
            {
                <b>if</b> (<span class="r292 r">mie</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#fd1ac7b3462d4426" class="i property">InvocationInfo</a> == <b>null</b>)
                    <span class="r292 r">mie</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r278 r">errorPosition</span>));
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r293 rd" class="r293 r">rte</span>)
            {
                <b>if</b> (<span class="r293 r">rte</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#fd1ac7b3462d4426" class="i property">InvocationInfo</a> == <b>null</b>)
                    <span class="r293 r">rte</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r278 r">errorPosition</span>));
                <b>throw</b>;
            }
            <b>catch</b> (<a href="#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r294 rd" class="r294 r">e</span>)
            {
                <span class="c">// Note - we are catching all methods thrown from a method call and wrap them</span>
                <span class="c">// unless they are already RuntimeException. This is ok.</span>
 
                <b>throw</b> <a href="#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionByMessage</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r278 r">errorPosition</span>,
                    <span class="r294 r">e</span>.<span class="i">Message</span>, <span class="s">&quot;MethodInvocationException&quot;</span>, <span class="r294 r">e</span>);
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ParserOps
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RangeEnumerator
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is a simple enumerator class that just enumerates of a range of numbers. It&#39;s used in enumerating</span>
    <span class="c">///</span><span class="c"> elements when the range operator .. is used.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a46bd775cec8106a" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">RangeEnumerator</a> : <span class="i">IEnumerator</span>
    {
        <b>private readonly int</b> <a id="d4cc68f60cccc6c1" href="../../R/d4cc68f60cccc6c1.html" target="n" data-glyph="46,1" class="i field">_lowerBound</a>;
 
        <b>internal int</b> <a id="73354fb41f05b402" href="../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">LowerBound</a>
        {
            <b>get</b> { <b>return</b> <a href="#d4cc68f60cccc6c1" class="i field">_lowerBound</a>; }
        }
 
        <b>private readonly int</b> <a id="54514cc6034bd4cb" href="../../R/54514cc6034bd4cb.html" target="n" data-glyph="46,1" class="i field">_upperBound</a>;
 
        <b>internal int</b> <a id="42e6aeba6d8a58b6" href="../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">UpperBound</a>
        {
            <b>get</b> { <b>return</b> <a href="#54514cc6034bd4cb" class="i field">_upperBound</a>; }
        }
 
        <b>private int</b> <a id="db7f49a31cb1e1b3" href="../../R/db7f49a31cb1e1b3.html" target="n" data-glyph="46,1" class="i field">_current</a>;
 
        <b>object</b> <span class="i">IEnumerator</span>.<a id="c4e718a3db4a1587" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b> { <b>return</b> <a href="#5f1bb24e1a0e1a3b" class="i property">Current</a>; }
        }
 
        <b>public virtual int</b> <a id="5f1bb24e1a0e1a3b" href="../../R/5f1bb24e1a0e1a3b.html" target="n" data-glyph="102,1" class="i property">Current</a>
        {
            <b>get</b> { <b>return</b> <a href="#db7f49a31cb1e1b3" class="i field">_current</a>; }
        }
 
        <b>internal int</b> <a id="b13a64b3ef4e3784" href="../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">CurrentValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#db7f49a31cb1e1b3" class="i field">_current</a>; }
        }
 
        <b>private readonly int</b> <a id="5b48fd5c1dee349e" href="../../R/5b48fd5c1dee349e.html" target="n" data-glyph="46,1" class="i field">_increment</a> = 1;
 
        <b>private bool</b> <a id="1287943520296602" href="../../R/1287943520296602.html" target="n" data-glyph="46,1" class="i field">_firstElement</a> = <b>true</b>;
 
        <b>public</b> <a id="917c9b27d8f4aeb5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">RangeEnumerator</a>(<b>int</b> <span id="r295 rd" class="r295 r">lowerBound</span>, <b>int</b> <span id="r296 rd" class="r296 r">upperBound</span>)
        {
            <a href="#d4cc68f60cccc6c1" class="i field">_lowerBound</a> = <span class="r295 r">lowerBound</span>;
            <a href="#db7f49a31cb1e1b3" class="i field">_current</a> = <a href="#d4cc68f60cccc6c1" class="i field">_lowerBound</a>;
            <a href="#54514cc6034bd4cb" class="i field">_upperBound</a> = <span class="r296 r">upperBound</span>;
            <b>if</b> (<span class="r295 r">lowerBound</span> &gt; <span class="r296 r">upperBound</span>)
                <a href="#5b48fd5c1dee349e" class="i field">_increment</a> = -1;
        }
 
        <b>public void</b> <a id="6e115299cc18a2f0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#db7f49a31cb1e1b3" class="i field">_current</a> = <a href="#d4cc68f60cccc6c1" class="i field">_lowerBound</a>;
            <a href="#1287943520296602" class="i field">_firstElement</a> = <b>true</b>;
        }
 
        <b>public bool</b> <a id="0282c422a32c4655" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <b>if</b> (<a href="#1287943520296602" class="i field">_firstElement</a>)
            {
                <a href="#1287943520296602" class="i field">_firstElement</a> = <b>false</b>;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#db7f49a31cb1e1b3" class="i field">_current</a> == <a href="#54514cc6034bd4cb" class="i field">_upperBound</a>)
                <b>return</b> <b>false</b>;
 
            <a href="#db7f49a31cb1e1b3" class="i field">_current</a> += <a href="#5b48fd5c1dee349e" class="i field">_increment</a>;
            <b>return</b> <b>true</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The simple enumerator class is used for the range operator &#39;..&#39;</span>
    <span class="c">///</span><span class="c"> in expressions like &#39;A&#39;..&#39;B&#39; | ForEach-Object { $_ }</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="9ff50ecc7ed47cc0" href="../../R/9ff50ecc7ed47cc0.html" target="n" data-glyph="2,0" class="t t">CharRangeEnumerator</a> : <span class="i">IEnumerator</span>
    {
        <b>private readonly int</b> <a id="aaade2f063de6c7b" href="../../R/aaade2f063de6c7b.html" target="n" data-glyph="46,1" class="i field">_increment</a> = 1;
 
        <b>private bool</b> <a id="05709679b729fdfd" href="../../R/05709679b729fdfd.html" target="n" data-glyph="46,1" class="i field">_firstElement</a> = <b>true</b>;
 
        <b>public</b> <a id="1ce4c526982aa14c" href="../../R/1ce4c526982aa14c.html" target="n" data-glyph="72,1" class="t constructor">CharRangeEnumerator</a>(<b>char</b> <span id="r297 rd" class="r297 r">lowerBound</span>, <b>char</b> <span id="r298 rd" class="r298 r">upperBound</span>)
        {
            <a href="#7eaf8e9f8c6362e0" class="i property">LowerBound</a> = <span class="r297 r">lowerBound</span>;
            <a href="#e1705a21979f938c" class="i property">Current</a> = <span class="r297 r">lowerBound</span>;
            <a href="#1afcf4225bac162b" class="i property">UpperBound</a> = <span class="r298 r">upperBound</span>;
            <b>if</b> (<span class="r297 r">lowerBound</span> &gt; <span class="r298 r">upperBound</span>)
                <a href="#aaade2f063de6c7b" class="i field">_increment</a> = -1;
        }
 
        <b>object</b> <span class="i">IEnumerator</span>.<a id="32bc391a54f275e6" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b> { <b>return</b> <a href="#e1705a21979f938c" class="i property">Current</a>; }
        }
 
        <b>internal char</b> <a id="7eaf8e9f8c6362e0" href="../../R/7eaf8e9f8c6362e0.html" target="n" data-glyph="104,1" class="i property">LowerBound</a> { <b>get</b>; }
 
        <b>internal char</b> <a id="1afcf4225bac162b" href="../../R/1afcf4225bac162b.html" target="n" data-glyph="104,1" class="i property">UpperBound</a> { <b>get</b>; }
 
        <b>public char</b> <a id="e1705a21979f938c" href="../../R/e1705a21979f938c.html" target="n" data-glyph="102,1" class="i property">Current</a>
        {
            <b>get</b>; <b>private set</b>;
        }
 
        <b>public bool</b> <a id="2801732d5637768f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <b>if</b> (<a href="#05709679b729fdfd" class="i field">_firstElement</a>)
            {
                <a href="#05709679b729fdfd" class="i field">_firstElement</a> = <b>false</b>;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#e1705a21979f938c" class="i property">Current</a> == <a href="#1afcf4225bac162b" class="i property">UpperBound</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="#e1705a21979f938c" class="i property">Current</a> = (<b>char</b>)(<a href="#e1705a21979f938c" class="i property">Current</a> + <a href="#aaade2f063de6c7b" class="i field">_increment</a>);
            <b>return</b> <b>true</b>;
        }
 
        <b>public void</b> <a id="6d6ac26c6a48fe45" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#e1705a21979f938c" class="i property">Current</a> = <a href="#7eaf8e9f8c6362e0" class="i property">LowerBound</a>;
            <a href="#05709679b729fdfd" class="i field">_firstElement</a> = <b>true</b>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RangeEnumerator
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> InterpreterError
    <b>internal static class</b> <a id="c1bdb7faf235a7b7" href="../../R/c1bdb7faf235a7b7.html" target="n" data-glyph="2,0" class="t t">InterpreterError</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new instance of an interpreter exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r299 r">targetObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The target object for this exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r300 r">exceptionType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of exception to build.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">resourceIdAndErrorId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ResourceID to look up template message, and also ErrorID</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource string that holds the error message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Insertion parameters to message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new instance of the specified exception type.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <a id="2c5ce07c0f6ec342" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewInterpreterException</a>(<b>object</b> <span id="r299 rd" class="r299 r">targetObject</span>,
            <span class="i">Type</span> <span id="r300 rd" class="r300 r">exceptionType</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r301 rd" class="r301 r">errorPosition</span>, <b>string</b> <span id="r302 rd" class="r302 r">resourceIdAndErrorId</span>, <b>string</b> <span id="r303 rd" class="r303 r">resourceString</span>, <b>params object</b>[] <span id="r304 rd" class="r304 r">args</span>)
        {
            <b>return</b> <a href="#b91ee5856bb2a1d9" class="i method">NewInterpreterExceptionWithInnerException</a>(<span class="r299 r">targetObject</span>, <span class="r300 r">exceptionType</span>, <span class="r301 r">errorPosition</span>, <span class="r302 r">resourceIdAndErrorId</span>, <span class="r303 r">resourceString</span>, <b>null</b>, <span class="r304 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new instance of an interpreter exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r305 r">targetObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object associated with the problem.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r306 r">exceptionType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of exception to build.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r307 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">resourceIdAndErrorId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ResourceID to look up template message, and also ErrorID</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource string which holds the error message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Inner exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r311 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Insertion parameters to message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New instance of an interpreter exception.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <a id="b91ee5856bb2a1d9" href="../../R/b91ee5856bb2a1d9.html" target="n" data-glyph="74,1" class="i method">NewInterpreterExceptionWithInnerException</a>(<b>object</b> <span id="r305 rd" class="r305 r">targetObject</span>,
            <span class="i">Type</span> <span id="r306 rd" class="r306 r">exceptionType</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r307 rd" class="r307 r">errorPosition</span>, <b>string</b> <span id="r308 rd" class="r308 r">resourceIdAndErrorId</span>, <b>string</b> <span id="r309 rd" class="r309 r">resourceString</span>, <span class="i">Exception</span> <span id="r310 rd" class="r310 r">innerException</span>, <b>params object</b>[] <span id="r311 rd" class="r311 r">args</span>)
        {
            <span class="c">// errToken may be null</span>
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r308 r">resourceIdAndErrorId</span>))
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r308 r">resourceIdAndErrorId</span>));
            <span class="c">// innerException may be null</span>
            <span class="c">// args may be null or empty</span>
 
            <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r312 rd" class="r312 r">rte</span> = <b>null</b>;
 
            <b>try</b>
            {
                <b>string</b> <span id="r313 rd" class="r313 r">message</span>;
                <b>if</b> (<span class="r311 r">args</span> == <b>null</b> || <span class="r311 r">args</span>.<span class="i">Length</span> == 0)
                {
                    <span class="c">// Don&#39;t format in case the string contains literal curly braces</span>
                    <span class="r313 r">message</span> = <span class="r309 r">resourceString</span>;
                }
                <b>else</b>
                {
                    <span class="r313 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r309 r">resourceString</span>, <span class="r311 r">args</span>);
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r313 r">message</span>))
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>,
                        <span class="s">&quot;Could not load text for parser exception &#39;&quot;</span>
                        + <span class="r308 r">resourceIdAndErrorId</span> + <span class="s">&quot;&#39;&quot;</span>);
                    <span class="r312 r">rte</span> = <a href="#d9161824bdd677e5" class="i method">NewBackupInterpreterException</a>(<span class="r306 r">exceptionType</span>, <span class="r307 r">errorPosition</span>, <span class="r308 r">resourceIdAndErrorId</span>, <b>null</b>);
                }
                <b>else</b>
                {
                    <span class="r312 r">rte</span> = <a href="#a7d09277582433d7" class="i method">NewInterpreterExceptionByMessage</a>(<span class="r306 r">exceptionType</span>, <span class="r307 r">errorPosition</span>, <span class="r313 r">message</span>, <span class="r308 r">resourceIdAndErrorId</span>, <span class="r310 r">innerException</span>);
                }
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r314 rd" class="r314 r">e</span>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>,
                    <span class="s">&quot;Could not load text for parser exception &#39;&quot;</span>
                    + <span class="r308 r">resourceIdAndErrorId</span>
                    + <span class="s">&quot;&#39; due to InvalidOperationException &quot;</span> + <span class="r314 r">e</span>.<span class="i">Message</span>);
                <span class="r312 r">rte</span> = <span class="i">NewBackupInterpreterException</span>(<span class="r306 r">exceptionType</span>, <span class="r307 r">errorPosition</span>, <span class="r308 r">resourceIdAndErrorId</span>, <span class="r314 r">e</span>);
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">MissingManifestResourceException</span> <span id="r315 rd" class="r315 r">e</span>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>,
                    <span class="s">&quot;Could not load text for parser exception &#39;&quot;</span>
                    + <span class="r308 r">resourceIdAndErrorId</span>
                    + <span class="s">&quot;&#39; due to MissingManifestResourceException &quot;</span> + <span class="r315 r">e</span>.<span class="i">Message</span>);
                <span class="r312 r">rte</span> = <span class="i">NewBackupInterpreterException</span>(<span class="r306 r">exceptionType</span>, <span class="r307 r">errorPosition</span>, <span class="r308 r">resourceIdAndErrorId</span>, <span class="r315 r">e</span>);
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r316 rd" class="r316 r">e</span>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>,
                    <span class="s">&quot;Could not load text for parser exception &#39;&quot;</span>
                    + <span class="r308 r">resourceIdAndErrorId</span>
                    + <span class="s">&quot;&#39; due to FormatException &quot;</span> + <span class="r316 r">e</span>.<span class="i">Message</span>);
                <span class="r312 r">rte</span> = <span class="i">NewBackupInterpreterException</span>(<span class="r306 r">exceptionType</span>, <span class="r307 r">errorPosition</span>, <span class="r308 r">resourceIdAndErrorId</span>, <span class="r316 r">e</span>);
            }
 
            <span class="r312 r">rte</span>.<a href="../../utils/RuntimeException.cs.html#9b2f142e3fc2e683" class="i method">SetTargetObject</a>(<span class="r305 r">targetObject</span>);
 
            <b>return</b> <span class="r312 r">rte</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new instance of an interpreter exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r317 r">exceptionType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of exception to build.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r318 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to use for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r320 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ErrorID.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r321 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Inner exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New instance of ParseException.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <a id="a7d09277582433d7" href="../../R/a7d09277582433d7.html" target="n" data-glyph="74,1" class="i method">NewInterpreterExceptionByMessage</a>(
            <span class="i">Type</span> <span id="r317 rd" class="r317 r">exceptionType</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r318 rd" class="r318 r">errorPosition</span>, <b>string</b> <span id="r319 rd" class="r319 r">message</span>, <b>string</b> <span id="r320 rd" class="r320 r">errorId</span>, <span class="i">Exception</span> <span id="r321 rd" class="r321 r">innerException</span>)
        {
            <span class="c">// errToken may be null</span>
            <span class="c">// only assert -- be permissive at runtime</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r319 r">message</span>), <span class="s">&quot;message was null or empty&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r320 r">errorId</span>), <span class="s">&quot;errorId was null or empty&quot;</span>);
            <span class="c">// innerException may be null</span>
 
            <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r322 rd" class="r322 r">e</span>;
 
            <span class="c">// Create an instance of the right exception type...</span>
            <b>if</b> (<span class="r317 r">exceptionType</span> == <b>typeof</b>(<a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a>))
            {
                <span class="r322 r">e</span> = <b>new</b> <a href="../../utils/ParserException.cs.html#a29d82ec4d80e228" class="t constructor">ParseException</a>(<span class="r319 r">message</span>, <span class="r320 r">errorId</span>, <span class="r321 r">innerException</span>);
            }
            <b>else</b> <b>if</b> (<span class="r317 r">exceptionType</span> == <b>typeof</b>(<a href="../../utils/ParserException.cs.html#35541cbf972c98ee" class="t t">IncompleteParseException</a>))
            {
                <span class="r322 r">e</span> = <b>new</b> <a href="../../utils/ParserException.cs.html#48bf2d9b98006f33" class="t constructor">IncompleteParseException</a>(<span class="r319 r">message</span>, <span class="r320 r">errorId</span>, <span class="r321 r">innerException</span>);
            }
            <b>else</b>
            {
                <span class="r322 r">e</span> = <b>new</b> <a href="../../utils/RuntimeException.cs.html#e550883d468d8c30" class="t constructor">RuntimeException</a>(<span class="r319 r">message</span>, <span class="r321 r">innerException</span>);
                <span class="r322 r">e</span>.<a href="../../utils/RuntimeException.cs.html#f25affe9a215ccc0" class="i method">SetErrorId</a>(<span class="r320 r">errorId</span>);
                <span class="r322 r">e</span>.<a href="../../utils/RuntimeException.cs.html#fca86db33780c155" class="i method">SetErrorCategory</a>(<a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>);
            }
 
            <span class="c">// Don&#39;t trash the existing InvocationInfo.</span>
            <b>if</b> (<span class="r318 r">errorPosition</span> != <b>null</b>)
                <span class="r322 r">e</span>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r318 r">errorPosition</span>));
            <b>return</b> <span class="r322 r">e</span>;
        }
 
        <b>private static</b> <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <a id="d9161824bdd677e5" href="../../R/d9161824bdd677e5.html" target="n" data-glyph="76,1" class="i method">NewBackupInterpreterException</a>(
            <span class="i">Type</span> <span id="r323 rd" class="r323 r">exceptionType</span>,
            <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r324 rd" class="r324 r">errorPosition</span>,
            <b>string</b> <span id="r325 rd" class="r325 r">errorId</span>,
            <span class="i">Exception</span> <span id="r326 rd" class="r326 r">innerException</span>)
        {
            <b>string</b> <span id="r327 rd" class="r327 r">message</span>;
            <b>if</b> (<span class="r326 r">innerException</span> == <b>null</b>)
            {
                <span class="c">// there is no reason this string lookup should fail</span>
                <span class="r327 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ParserStrings</span>.<span class="i">BackupParserMessage</span>, <span class="r325 r">errorId</span>);
            }
            <b>else</b>
            {
                <span class="c">// there is no reason this string lookup should fail</span>
                <span class="r327 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ParserStrings</span>.<span class="i">BackupParserMessageWithException</span>, <span class="r325 r">errorId</span>, <span class="r326 r">innerException</span>.<span class="i">Message</span>);
            }
 
            <b>return</b> <a href="#a7d09277582433d7" class="i method">NewInterpreterExceptionByMessage</a>(<span class="r323 r">exceptionType</span>, <span class="r324 r">errorPosition</span>, <span class="r327 r">message</span>, <span class="r325 r">errorId</span>, <span class="r326 r">innerException</span>);
        }
 
        <b>internal static void</b> <a id="a9661b706b088f30" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">UpdateExceptionErrorRecordPosition</a>(<span class="i">Exception</span> <span id="r328 rd" class="r328 r">exception</span>, <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r329 rd" class="r329 r">extent</span>)
        {
            <b>if</b> (<span class="r329 r">extent</span> == <b>null</b> || <span class="r329 r">extent</span> == <a href="../parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="../parser/Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>)
            {
                <b>return</b>;
            }
 
            <a href="../ErrorPackage.cs.html#2d342e12f9600886" class="k">var</a> <span id="r330 rd" class="r330 r">icer</span> = <span class="r328 r">exception</span> <b>as</b> <a href="../ErrorPackage.cs.html#2d342e12f9600886" class="t t">IContainsErrorRecord</a>;
            <b>if</b> (<span class="r330 r">icer</span> != <b>null</b>)
            {
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r331 rd" class="r331 r">errorRecord</span> = <span class="r330 r">icer</span>.<a href="../ErrorPackage.cs.html#cef340f272a30c6b" class="i property">ErrorRecord</a>;
                <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="k">var</a> <span id="r332 rd" class="r332 r">invocationInfo</span> = <span class="r331 r">errorRecord</span>.<a href="../ErrorPackage.cs.html#fd1ac7b3462d4426" class="i property">InvocationInfo</a>;
                <b>if</b> (<span class="r332 r">invocationInfo</span> == <b>null</b>)
                {
                    <span class="r331 r">errorRecord</span>.<a href="../ErrorPackage.cs.html#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r329 r">extent</span>));
                }
                <b>else</b> <b>if</b> (<span class="r332 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a> == <b>null</b> || <span class="r332 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a> == <a href="../parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="../parser/Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>)
                {
                    <span class="r332 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a> = <span class="r329 r">extent</span>;
                    <span class="r331 r">errorRecord</span>.<a href="../ErrorPackage.cs.html#f3959861270f09c6" class="i method">LockScriptStackTrace</a>();
                }
            }
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> InterpreterError
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ScriptTrace
    <b>internal static class</b> <a id="4e9954e542a936a8" href="../../R/4e9954e542a936a8.html" target="n" data-glyph="2,0" class="t t">ScriptTrace</a>
    {
        <b>internal static void</b> <a id="a4959ded20ea0c72" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Trace</a>(<b>int</b> <span id="r333 rd" class="r333 r">level</span>, <b>string</b> <span id="r334 rd" class="r334 r">messageId</span>, <b>string</b> <span id="r335 rd" class="r335 r">resourceString</span>, <b>params object</b>[] <span id="r336 rd" class="r336 r">args</span>)
        {
            <span class="c">// Need access to the execution context to see if we should trace. If we</span>
            <span class="c">// can&#39;t get it, then just return...</span>
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r337 rd" class="r337 r">context</span> = <a href="../hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r337 r">context</span> == <b>null</b>)
                <b>return</b>;
            <a href="#34275745bf3269bc" class="i method">Trace</a>(<span class="r337 r">context</span>, <span class="r333 r">level</span>, <span class="r334 r">messageId</span>, <span class="r335 r">resourceString</span>, <span class="r336 r">args</span>);
        }
 
        <b>internal static void</b> <a id="34275745bf3269bc" href="../../R/34275745bf3269bc.html" target="n" data-glyph="74,1" class="i method">Trace</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r338 rd" class="r338 r">context</span>, <b>int</b> <span id="r339 rd" class="r339 r">level</span>, <b>string</b> <span id="r340 rd" class="r340 r">messageId</span>, <b>string</b> <span id="r341 rd" class="r341 r">resourceString</span>, <b>params object</b>[] <span id="r342 rd" class="r342 r">args</span>)
        {
            <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r343 rd" class="r343 r">pref</span> = <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="../CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <b>if</b> (<span class="r338 r">context</span>.<a href="../ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> &gt; <span class="r339 r">level</span>)
            {
                <b>string</b> <span id="r344 rd" class="r344 r">message</span>;
                <b>if</b> (<span class="r342 r">args</span> == <b>null</b> || <span class="r342 r">args</span>.<span class="i">Length</span> == 0)
                {
                    <span class="c">// Don&#39;t format in case the string contains literal curly braces</span>
                    <span class="r344 r">message</span> = <span class="r341 r">resourceString</span>;
                }
                <b>else</b>
                {
                    <span class="r344 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r341 r">resourceString</span>, <span class="r342 r">args</span>);
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r344 r">message</span>))
                {
                    <span class="r344 r">message</span> = <span class="s">&quot;Could not load text for msh script tracing message id &#39;&quot;</span> + <span class="r340 r">messageId</span> + <span class="s">&quot;&#39;&quot;</span>;
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="r344 r">message</span>);
                }
 
                ((<a href="../../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a>)<span class="r338 r">context</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>).<a href="../hostifaces/InternalHostUserInterface.cs.html#a6592058f8a67a4a" class="i method">WriteDebugLine</a>(<span class="r344 r">message</span>, <b>ref</b> <span class="r343 r">pref</span>);
            }
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ScriptTrace
}
</pre></td></tr></table></div></body></html>
