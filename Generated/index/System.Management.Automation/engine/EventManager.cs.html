<!DOCTYPE html>
<html><head><title>EventManager.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(2662);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/EventManager.cs" target="_top">engine\EventManager.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Emit</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the interface to the PowerShell eventing functionality.</span>
    <span class="c">///</span><span class="c">  This class allows you to subscribe to, and receive events.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="0fd88f72d27f82bd" href="../R/0fd88f72d27f82bd.html" target="n" data-glyph="0,0" class="t t"><span id="709189bf03e4def0">PSEventManager</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Sequential event ID</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="a0721e061bc90d78" href="../R/a0721e061bc90d78.html" target="n" data-glyph="46,1" class="i field">_nextEventId</a> = 1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a sequential event ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected int</b> <a id="371a25d6143c3770" href="../R/371a25d6143c3770.html" target="n" data-glyph="75,1" class="i method">GetNextEventId</a>()
        {
            <b>return</b> <a href="#a0721e061bc90d78" class="i field">_nextEventId</a>++;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the interface to the PowerShell event queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#643f66f12c98fa1d" class="t t">PSEventArgsCollection</a> <a id="fc398910d6752597" href="../R/fc398910d6752597.html" target="n" data-glyph="102,1" class="i property">ReceivedEvents</a> { <b>get</b>; } = <b>new</b> <span class="t">PSEventArgsCollection</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the list of event subscribers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="6588fc2123e43a92" href="../R/6588fc2123e43a92.html" target="n" data-glyph="102,1" class="i property">Subscribers</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PowerShell event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any event-specific data associated with the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected abstract</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="72fbdf95724c18ea" href="../R/72fbdf95724c18ea.html" target="n" data-glyph="75,1" class="i method">CreateEvent</a>(<b>string</b> <span id="r0 rd" class="r0 r">sourceIdentifier</span>, <b>object</b> <span id="r1 rd" class="r1 r">sender</span>, <b>object</b>[] <span id="r2 rd" class="r2 r">args</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">extraData</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate a PowerShell event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any event-specific data associated with the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="dfff9a097c10a4e8" href="../R/dfff9a097c10a4e8.html" target="n" data-glyph="72,1" class="i method">GenerateEvent</a>(<b>string</b> <span id="r4 rd" class="r4 r">sourceIdentifier</span>, <b>object</b> <span id="r5 rd" class="r5 r">sender</span>, <b>object</b>[] <span id="r6 rd" class="r6 r">args</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r7 rd" class="r7 r">extraData</span>)
        {
            <b>return</b> <a href="#0fd88f72d27f82bd" class="k">this</a>.<a href="#bab599a5805d9aed" class="i method">GenerateEvent</a>(<span class="r4 r">sourceIdentifier</span>, <span class="r5 r">sender</span>, <span class="r6 r">args</span>, <span class="r7 r">extraData</span>, <b>false</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate a PowerShell event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any event-specific data associated with the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">processInCurrentThread</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the event should be triggered in current thread. False for the event</span>
        <span class="c">///</span><span class="c"> to be triggered in a separate thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">waitForCompletionInCurrentThread</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait for the event and associated action to be processed and completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="bab599a5805d9aed" href="../R/bab599a5805d9aed.html" target="n" data-glyph="72,1" class="i method">GenerateEvent</a>(<b>string</b> <span id="r8 rd" class="r8 r">sourceIdentifier</span>, <b>object</b> <span id="r9 rd" class="r9 r">sender</span>, <b>object</b>[] <span id="r10 rd" class="r10 r">args</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r11 rd" class="r11 r">extraData</span>,
            <b>bool</b> <span id="r12 rd" class="r12 r">processInCurrentThread</span>, <b>bool</b> <span id="r13 rd" class="r13 r">waitForCompletionInCurrentThread</span>)
        {
            <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r14 rd" class="r14 r">newEvent</span> = <a href="#72fbdf95724c18ea" class="i method">CreateEvent</a>(<span class="r8 r">sourceIdentifier</span>, <span class="r9 r">sender</span>, <span class="r10 r">args</span>, <span class="r11 r">extraData</span>);
            <a href="#7e921c8fcd0a9de7" class="i method">ProcessNewEvent</a>(<span class="r14 r">newEvent</span>, <span class="r12 r">processInCurrentThread</span>, <span class="r13 r">waitForCompletionInCurrentThread</span>);
 
            <b>return</b> <span class="r14 r">newEvent</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a forwarded event to the current event manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract void</b> <a id="43c57e3b3c02ba83" href="../R/43c57e3b3c02ba83.html" target="n" data-glyph="74,1" class="i method">AddForwardedEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r15 rd" class="r15 r">forwardedEvent</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;InCurrent&quot;</span>)]
        <b>protected abstract void</b> <a id="55b80771b8239259" href="../R/55b80771b8239259.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r16 rd" class="r16 r">newEvent</span>, <b>bool</b> <span id="r17 rd" class="r17 r">processInCurrentThread</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;InCurrent&quot;</span>)]
        <b>protected internal virtual void</b> <a id="7e921c8fcd0a9de7" href="../R/7e921c8fcd0a9de7.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r18 rd" class="r18 r">newEvent</span>, <b>bool</b> <span id="r19 rd" class="r19 r">processInCurrentThread</span>,
                                                         <b>bool</b> <span id="r20 rd" class="r20 r">waitForCompletionWhenInCurrentThread</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the event subscription that corresponds to an identifier</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The identifier that identifies the source of the events</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <span class="i">IEnumerable</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="2e974e2b72c89066" href="../R/2e974e2b72c89066.html" target="n" data-glyph="72,1" class="i method">GetEventSubscribers</a>(<b>string</b> <span id="r21 rd" class="r21 r">sourceIdentifier</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public abstract</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="fd17e051689f1093" href="../R/fd17e051689f1093.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r22 rd" class="r22 r">source</span>, <b>string</b> <span id="r23 rd" class="r23 r">eventName</span>, <b>string</b> <span id="r24 rd" class="r24 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r25 rd" class="r25 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r26 rd" class="r26 r">action</span>, <b>bool</b> <span id="r27 rd" class="r27 r">supportEvent</span>, <b>bool</b> <span id="r28 rd" class="r28 r">forwardEvent</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public abstract</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="37c01f3ebe8b8f99" href="../R/37c01f3ebe8b8f99.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r29 rd" class="r29 r">source</span>, <b>string</b> <span id="r30 rd" class="r30 r">eventName</span>, <b>string</b> <span id="r31 rd" class="r31 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r32 rd" class="r32 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r33 rd" class="r33 r">action</span>, <b>bool</b> <span id="r34 rd" class="r34 r">supportEvent</span>, <b>bool</b> <span id="r35 rd" class="r35 r">forwardEvent</span>, <b>int</b> <span id="r36 rd" class="r36 r">maxTriggerCount</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public abstract</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="0dae9caf36378620" href="../R/0dae9caf36378620.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r37 rd" class="r37 r">source</span>, <b>string</b> <span id="r38 rd" class="r38 r">eventName</span>, <b>string</b> <span id="r39 rd" class="r39 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r40 rd" class="r40 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r41 rd" class="r41 r">handlerDelegate</span>, <b>bool</b> <span id="r42 rd" class="r42 r">supportEvent</span>, <b>bool</b> <span id="r43 rd" class="r43 r">forwardEvent</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public abstract</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="22c6b49ffb165b20" href="../R/22c6b49ffb165b20.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r44 rd" class="r44 r">source</span>, <b>string</b> <span id="r45 rd" class="r45 r">eventName</span>, <b>string</b> <span id="r46 rd" class="r46 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r47 rd" class="r47 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r48 rd" class="r48 r">handlerDelegate</span>, <b>bool</b> <span id="r49 rd" class="r49 r">supportEvent</span>, <b>bool</b> <span id="r50 rd" class="r50 r">forwardEvent</span>, <b>int</b> <span id="r51 rd" class="r51 r">maxTriggerCount</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">shouldQueueAndProcessInExecutionThread</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True, if the handlerDelegate should be processed in the pipeline execution thread (if possible).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> The default value is zero</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>internal virtual</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="f8460f65b3a5a410" href="../R/f8460f65b3a5a410.html" target="n" data-glyph="74,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r52 rd" class="r52 r">source</span>,
            <b>string</b> <span id="r53 rd" class="r53 r">eventName</span>,
            <b>string</b> <span id="r54 rd" class="r54 r">sourceIdentifier</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r55 rd" class="r55 r">data</span>,
            <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r56 rd" class="r56 r">handlerDelegate</span>,
            <b>bool</b> <span id="r57 rd" class="r57 r">supportEvent</span>,
            <b>bool</b> <span id="r58 rd" class="r58 r">forwardEvent</span>,
            <b>bool</b> <span id="r59 rd" class="r59 r">shouldQueueAndProcessInExecutionThread</span>,
            <b>int</b> <span id="r60 rd" class="r60 r">maxTriggerCount</span> = 0)
        {
            <b>return</b> <a href="#22c6b49ffb165b20" class="i method">SubscribeEvent</a>(<span class="r52 r">source</span>, <span class="r53 r">eventName</span>, <span class="r54 r">sourceIdentifier</span>, <span class="r55 r">data</span>, <span class="r56 r">handlerDelegate</span>, <span class="r57 r">supportEvent</span>, <span class="r58 r">forwardEvent</span>, <span class="r60 r">maxTriggerCount</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unsubscribes from an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">subscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber associated with the event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="66c6cf23c037e49c" href="../R/66c6cf23c037e49c.html" target="n" data-glyph="72,1" class="i method">UnsubscribeEvent</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r61 rd" class="r61 r">subscriber</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event is raised by the event manager to forward events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract event</b> <span class="i">EventHandler</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="e341129bc262ba81" href="../R/e341129bc262ba81.html" target="n" data-glyph="32,1" class="i">ForwardEvent</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation of the PSEventManager for local runspaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="88db4bace82161f0" href="../R/88db4bace82161f0.html" target="n" data-glyph="2,0" class="t t">PSLocalEventManager</a> : <a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>, <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the PSEventManager class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7d7e356843375ef8" href="../R/7d7e356843375ef8.html" target="n" data-glyph="74,1" class="t constructor">PSLocalEventManager</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r62 rd" class="r62 r">context</span>)
        {
            <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>, <span class="i">Delegate</span>&gt;();
            <a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#d9c986f923fe590a" class="i field">_actionQueue</a> = <b>new</b> <span class="i">Queue</span>&lt;<a href="#859782a2e1b81f61" class="t t">EventAction</a>&gt;();
            <a href="#681c0f08ad20aa1a" class="i field">_context</a> = <span class="r62 r">context</span>;
        }
 
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>, <span class="i">Delegate</span>&gt; <a id="3652ea132f6b17e4" href="../R/3652ea132f6b17e4.html" target="n" data-glyph="46,1" class="i field">_eventSubscribers</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;&gt; <a id="cf895bfac7b495d1" href="../R/cf895bfac7b495d1.html" target="n" data-glyph="46,1" class="i field">_engineEventSubscribers</a>;
        <b>private readonly</b> <span class="i">Queue</span>&lt;<a href="#859782a2e1b81f61" class="t t">EventAction</a>&gt; <a id="d9c986f923fe590a" href="../R/d9c986f923fe590a.html" target="n" data-glyph="46,1" class="i field">_actionQueue</a>;
        <b>private readonly</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="681c0f08ad20aa1a" href="../R/681c0f08ad20aa1a.html" target="n" data-glyph="46,1" class="i field">_context</a>;
        <b>private int</b> <a id="232dfa4c64a4a157" href="../R/232dfa4c64a4a157.html" target="n" data-glyph="46,1" class="i field">_nextSubscriptionId</a> = 1;
        <b>private readonly double</b> <a id="be57aa63b95a31bc" href="../R/be57aa63b95a31bc.html" target="n" data-glyph="46,1" class="i field">_throttleLimit</a> = 1;
        <b>private int</b> <a id="ab0563ef68b0587a" href="../R/ab0563ef68b0587a.html" target="n" data-glyph="46,1" class="i field">_throttleChecks</a> = 0;
 
        <span class="c">// The assembly and module to hold our event registrations</span>
        <b>private</b> <span class="i">AssemblyBuilder</span> <a id="1873109f2a9b1af5" href="../R/1873109f2a9b1af5.html" target="n" data-glyph="46,1" class="i field">_eventAssembly</a> = <b>null</b>;
        <b>private</b> <span class="i">ModuleBuilder</span> <a id="6a76a4701ded1358" href="../R/6a76a4701ded1358.html" target="n" data-glyph="46,1" class="i field">_eventModule</a> = <b>null</b>;
        <b>private int</b> <a id="7e5e283d600ec4d7" href="../R/7e5e283d600ec4d7.html" target="n" data-glyph="46,1" class="i field">_typeId</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the list of event subscribers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="2556cfcc281e68ab" href="../R/2556cfcc281e68ab.html" target="n" data-glyph="102,1" class="i property">Subscribers</a>
        {
            <b>get</b>
            {
                <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r63 rd" class="r63 r">subscribers</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
 
                <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
                {
                    <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r64 rd" class="r64 r">currentSubscriber</span> <b>in</b> <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>.<span class="i">Keys</span>)
                    {
                        <span class="r63 r">subscribers</span>.<span class="i">Add</span>(<span class="r64 r">currentSubscriber</span>);
                    }
                }
 
                <b>return</b> <span class="r63 r">subscribers</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="8ce2bd3a7289f055" href="../R/8ce2bd3a7289f055.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r65 rd" class="r65 r">source</span>, <b>string</b> <span id="r66 rd" class="r66 r">eventName</span>, <b>string</b> <span id="r67 rd" class="r67 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r68 rd" class="r68 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r69 rd" class="r69 r">action</span>, <b>bool</b> <span id="r70 rd" class="r70 r">supportEvent</span>, <b>bool</b> <span id="r71 rd" class="r71 r">forwardEvent</span>)
        {
            <b>return</b> <a href="#101a3c99764b52e1" class="i method">SubscribeEvent</a>(<span class="r65 r">source</span>, <span class="r66 r">eventName</span>, <span class="r67 r">sourceIdentifier</span>, <span class="r68 r">data</span>, <span class="r69 r">action</span>, <span class="r70 r">supportEvent</span>, <span class="r71 r">forwardEvent</span>, 0);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="101a3c99764b52e1" href="../R/101a3c99764b52e1.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r72 rd" class="r72 r">source</span>, <b>string</b> <span id="r73 rd" class="r73 r">eventName</span>, <b>string</b> <span id="r74 rd" class="r74 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r75 rd" class="r75 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r76 rd" class="r76 r">action</span>, <b>bool</b> <span id="r77 rd" class="r77 r">supportEvent</span>, <b>bool</b> <span id="r78 rd" class="r78 r">forwardEvent</span>, <b>int</b> <span id="r79 rd" class="r79 r">maxTriggerCount</span>)
        {
            <span class="c">// Record this subscriber. This may just be a registration for engine events.</span>
            <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r80 rd" class="r80 r">subscriber</span> = <b>new</b> <span class="t">PSEventSubscriber</span>(<a href="#681c0f08ad20aa1a" class="i field">_context</a>, <a href="#232dfa4c64a4a157" class="i field">_nextSubscriptionId</a>++, <span class="r72 r">source</span>, <span class="r73 r">eventName</span>, <span class="r74 r">sourceIdentifier</span>, <span class="r76 r">action</span>, <span class="r77 r">supportEvent</span>, <span class="r78 r">forwardEvent</span>, <span class="r79 r">maxTriggerCount</span>);
            <a href="#605e071b4cfc98c4" class="i method">ProcessNewSubscriber</a>(<span class="r80 r">subscriber</span>, <span class="r72 r">source</span>, <span class="r73 r">eventName</span>, <span class="r74 r">sourceIdentifier</span>, <span class="r75 r">data</span>, <span class="r77 r">supportEvent</span>, <span class="r78 r">forwardEvent</span>);
            <span class="r80 r">subscriber</span>.<a href="#e172ff2abcbe0041" class="i method">RegisterJob</a>();
 
            <b>return</b> <span class="r80 r">subscriber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">shouldQueueAndProcessInExecutionThread</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True, if the handlerDelegate should be processed in the pipeline execution thread (if possible).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> The default value is zero</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>internal override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="b470b6b2fdb01a48" href="../R/b470b6b2fdb01a48.html" target="n" data-glyph="74,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r81 rd" class="r81 r">source</span>,
            <b>string</b> <span id="r82 rd" class="r82 r">eventName</span>,
            <b>string</b> <span id="r83 rd" class="r83 r">sourceIdentifier</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r84 rd" class="r84 r">data</span>,
            <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r85 rd" class="r85 r">handlerDelegate</span>,
            <b>bool</b> <span id="r86 rd" class="r86 r">supportEvent</span>,
            <b>bool</b> <span id="r87 rd" class="r87 r">forwardEvent</span>,
            <b>bool</b> <span id="r88 rd" class="r88 r">shouldQueueAndProcessInExecutionThread</span>,
            <b>int</b> <span id="r89 rd" class="r89 r">maxTriggerCount</span> = 0)
        {
            <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r90 rd" class="r90 r">newSubscriber</span> = <a href="#960d5dd731bafeec" class="i method">SubscribeEvent</a>(<span class="r81 r">source</span>, <span class="r82 r">eventName</span>, <span class="r83 r">sourceIdentifier</span>, <span class="r84 r">data</span>, <span class="r85 r">handlerDelegate</span>, <span class="r86 r">supportEvent</span>, <span class="r87 r">forwardEvent</span>, <span class="r89 r">maxTriggerCount</span>);
            <span class="r90 r">newSubscriber</span>.<a href="#0b6d70951efe328d" class="i property">ShouldProcessInExecutionThread</a> = <span class="r88 r">shouldQueueAndProcessInExecutionThread</span>;
            <b>return</b> <span class="r90 r">newSubscriber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="5155852a4cae5c88" href="../R/5155852a4cae5c88.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r91 rd" class="r91 r">source</span>, <b>string</b> <span id="r92 rd" class="r92 r">eventName</span>, <b>string</b> <span id="r93 rd" class="r93 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r94 rd" class="r94 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r95 rd" class="r95 r">handlerDelegate</span>, <b>bool</b> <span id="r96 rd" class="r96 r">supportEvent</span>, <b>bool</b> <span id="r97 rd" class="r97 r">forwardEvent</span>)
        {
            <b>return</b> <a href="#960d5dd731bafeec" class="i method">SubscribeEvent</a>(<span class="r91 r">source</span>, <span class="r92 r">eventName</span>, <span class="r93 r">sourceIdentifier</span>, <span class="r94 r">data</span>, <span class="r95 r">handlerDelegate</span>, <span class="r96 r">supportEvent</span>, <span class="r97 r">forwardEvent</span>, 0);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="960d5dd731bafeec" href="../R/960d5dd731bafeec.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r98 rd" class="r98 r">source</span>, <b>string</b> <span id="r99 rd" class="r99 r">eventName</span>, <b>string</b> <span id="r100 rd" class="r100 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r101 rd" class="r101 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r102 rd" class="r102 r">handlerDelegate</span>, <b>bool</b> <span id="r103 rd" class="r103 r">supportEvent</span>, <b>bool</b> <span id="r104 rd" class="r104 r">forwardEvent</span>, <b>int</b> <span id="r105 rd" class="r105 r">maxTriggerCount</span>)
        {
            <span class="c">// Record this subscriber. This may just be a registration for engine events.</span>
            <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r106 rd" class="r106 r">subscriber</span> = <b>new</b> <span class="t">PSEventSubscriber</span>(<a href="#681c0f08ad20aa1a" class="i field">_context</a>, <a href="#232dfa4c64a4a157" class="i field">_nextSubscriptionId</a>++, <span class="r98 r">source</span>, <span class="r99 r">eventName</span>, <span class="r100 r">sourceIdentifier</span>, <span class="r102 r">handlerDelegate</span>, <span class="r103 r">supportEvent</span>, <span class="r104 r">forwardEvent</span>, <span class="r105 r">maxTriggerCount</span>);
            <a href="#605e071b4cfc98c4" class="i method">ProcessNewSubscriber</a>(<span class="r106 r">subscriber</span>, <span class="r98 r">source</span>, <span class="r99 r">eventName</span>, <span class="r100 r">sourceIdentifier</span>, <span class="r101 r">data</span>, <span class="r103 r">supportEvent</span>, <span class="r104 r">forwardEvent</span>);
            <span class="r106 r">subscriber</span>.<a href="#e172ff2abcbe0041" class="i method">RegisterJob</a>();
 
            <b>return</b> <span class="r106 r">subscriber</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> OnIdleProcessing
 
        <b>private</b> <span class="i">Timer</span> <a id="cb5997755e2f04af" href="../R/cb5997755e2f04af.html" target="n" data-glyph="46,1" class="i field">_timer</a> = <b>null</b>;
        <b>private bool</b> <a id="798c8ee628b7c853" href="../R/798c8ee628b7c853.html" target="n" data-glyph="46,1" class="i field">_timerInitialized</a> = <b>false</b>;
        <b>private bool</b> <a id="17abab18385e3c90" href="../R/17abab18385e3c90.html" target="n" data-glyph="46,1" class="i field">_isTimerActive</a> = <b>false</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> We sample every 100ms to check if the engine is idle (currentlyRunningPipeline == null). If it&#39;s &quot;idle&quot;</span>
        <span class="c">///</span><span class="c"> in four consecutive samples, then we believe it&#39;s actually idle. In this way we can avoid capturing possible</span>
        <span class="c">///</span><span class="c"> pipeline transitions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="99723aca839b066c" href="../R/99723aca839b066c.html" target="n" data-glyph="46,1" class="i field">_consecutiveIdleSamples</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Send on-idle event if the engine is idle. The property &quot;AutoReset&quot; of the timer is always false,</span>
        <span class="c">///</span><span class="c"> so only one handler will be running at anytime. The timer will be enabled again if we can meet</span>
        <span class="c">///</span><span class="c"> the following two conditions.</span>
        <span class="c">///</span><span class="c">   1. No PowerShell.OnIdle event is sent out</span>
        <span class="c">///</span><span class="c">   2. A PowerShell.OnIdle event is sent out, and there are still subscribers to the on-idle event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="521d5a3cbb09be2f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">OnElapsedEvent</a>(<b>object</b> <span id="r107 rd" class="r107 r">source</span>)
        {
            <a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="k">var</a> <span id="r108 rd" class="r108 r">localRunspace</span> = <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a> <b>as</b> <a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>;
 
            <b>if</b> (<span class="r108 r">localRunspace</span> == <b>null</b>)
            {
                <span class="c">// This should never happen, the context should always reference to the local runspace</span>
                <a href="#99723aca839b066c" class="i field">_consecutiveIdleSamples</a> = 0;
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r108 r">localRunspace</span>.<a href="hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>() == <b>null</b>)
            {
                <a href="#99723aca839b066c" class="i field">_consecutiveIdleSamples</a>++;
            }
            <b>else</b>
            {
                <a href="#99723aca839b066c" class="i field">_consecutiveIdleSamples</a> = 0;
            }
 
            <b>if</b> (<a href="#99723aca839b066c" class="i field">_consecutiveIdleSamples</a> == 4)
            {
                <a href="#99723aca839b066c" class="i field">_consecutiveIdleSamples</a> = 0;
                <b>lock</b> (<a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>)
                {
                    <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r109 rd" class="r109 r">subscribers</span> = <b>null</b>;
                    <b>if</b> (<a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>.<span class="i">TryGetValue</span>(<a href="#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="#81d0b6a36f67dda2" class="i field">OnIdle</a>, <b>out</b> <span class="r109 r">subscribers</span>) &amp;&amp; <span class="r109 r">subscribers</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="c">// We send out on-idle event and keep enabling the timer only if there still are subscribers to the on-idle event</span>
                        <span class="i">GenerateEvent</span>(<a href="#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="#81d0b6a36f67dda2" class="i field">OnIdle</a>, <b>null</b>, <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;(), <b>null</b>, <b>false</b>, <b>false</b>);
                        <a href="#de019d2e45b7e054" class="i method">EnableTimer</a>();
                    }
                    <b>else</b>
                    {
                        <a href="#17abab18385e3c90" class="i field">_isTimerActive</a> = <b>false</b>;
                    }
                }
            }
            <b>else</b>
            {
                <a href="#de019d2e45b7e054" class="i method">EnableTimer</a>();
            }
        }
 
        <b>private void</b> <a id="c90c9018dad916d5" href="../R/c90c9018dad916d5.html" target="n" data-glyph="76,1" class="i method">InitializeTimer</a>()
        {
            <b>try</b>
            {
                <a href="#cb5997755e2f04af" class="i field">_timer</a> = <b>new</b> <span class="i">Timer</span>(<span class="i">OnElapsedEvent</span>, <b>null</b>, <span class="i">Timeout</span>.<span class="i">Infinite</span>, <span class="i">Timeout</span>.<span class="i">Infinite</span>);
            }
            <b>catch</b> (<span class="i">ObjectDisposedException</span>)
            {
                <span class="c">// The PSLocalEventManager is disposed, do nothing</span>
            }
        }
 
        <b>private void</b> <a id="de019d2e45b7e054" href="../R/de019d2e45b7e054.html" target="n" data-glyph="76,1" class="i method">EnableTimer</a>()
        {
            <b>try</b>
            {
                <a href="#cb5997755e2f04af" class="i field">_timer</a>.<span class="i">Change</span>(100, <span class="i">Timeout</span>.<span class="i">Infinite</span>);
            }
            <b>catch</b> (<span class="i">ObjectDisposedException</span>)
            {
                <span class="c">// The PSLocalEventManager is disposed, do nothing</span>
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> OnIdleProcessing
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Type</span>&gt; <a id="4a6a58389425b6a0" href="../R/4a6a58389425b6a0.html" target="n" data-glyph="46,1" class="i field">s_generatedEventHandlers</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Type</span>&gt;();
 
        <b>private void</b> <a id="605e071b4cfc98c4" href="../R/605e071b4cfc98c4.html" target="n" data-glyph="76,1" class="i method">ProcessNewSubscriber</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r110 rd" class="r110 r">subscriber</span>, <b>object</b> <span id="r111 rd" class="r111 r">source</span>, <b>string</b> <span id="r112 rd" class="r112 r">eventName</span>, <b>string</b> <span id="r113 rd" class="r113 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r114 rd" class="r114 r">data</span>, <b>bool</b> <span id="r115 rd" class="r115 r">supportEvent</span>, <b>bool</b> <span id="r116 rd" class="r116 r">forwardEvent</span>)
        {
            <span class="i">Delegate</span> <span id="r117 rd" class="r117 r">handlerDelegate</span> = <b>null</b>;
 
            <b>if</b> (<a href="#1873109f2a9b1af5" class="i field">_eventAssembly</a> == <b>null</b>)
            {
                <a href="#1873109f2a9b1af5" class="i field">_eventAssembly</a> = <span class="i">AssemblyBuilder</span>.<span class="i">DefineDynamicAssembly</span>(
                    <b>new</b> <span class="i">AssemblyName</span>(<span class="s">&quot;PSEventHandler&quot;</span>),
                    <span class="i">AssemblyBuilderAccess</span>.<span class="i">Run</span>);
                <a href="#6a76a4701ded1358" class="i field">_eventModule</a> = <a href="#1873109f2a9b1af5" class="i field">_eventAssembly</a>.<span class="i">DefineDynamicModule</span>(<span class="s">&quot;PSGenericEventModule&quot;</span>);
            }
 
            <b>string</b> <span id="r118 rd" class="r118 r">engineEventSourceIdentifier</span> = <b>null</b>;
            <b>bool</b> <span id="r119 rd" class="r119 r">isOnIdleEvent</span> = <b>false</b>;
            <span class="c">// If we are subscribing to an event on an object, generate the supporting delegate</span>
            <span class="c">// for that object.</span>
            <b>if</b> (<span class="r111 r">source</span> != <b>null</b>)
            {
                <span class="c">// If the identifier starts with &quot;PowerShell.&quot;, then it will collide with engine</span>
                <span class="c">// events</span>
                <b>if</b> ((<span class="r113 r">sourceIdentifier</span> != <b>null</b>) &amp;&amp;
                    (<span class="r113 r">sourceIdentifier</span>.<span class="i">StartsWith</span>(<span class="s">&quot;PowerShell.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <b>string</b> <span id="r120 rd" class="r120 r">errorMessage</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">EventingResources</span>.<span class="i">ReservedIdentifier</span>, <span class="r113 r">sourceIdentifier</span>);
 
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r120 r">errorMessage</span>, <b>nameof</b>(<span class="r113 r">sourceIdentifier</span>));
                }
 
                <span class="i">EventInfo</span> <span id="r121 rd" class="r121 r">eventInfo</span> = <b>null</b>;
                <span class="i">Type</span> <span id="r122 rd" class="r122 r">sourceType</span> = <span class="r111 r">source</span> <b>as</b> <span class="i">Type</span> ?? <span class="r111 r">source</span>.<span class="i">GetType</span>();
 
                <span class="c">// PowerShell does not support WinRT events.</span>
                <b>if</b> (<a href="WinRT/IInspectable.cs.html#3ad1214ea747f068" class="t t">WinRTHelper</a>.<a href="WinRT/IInspectable.cs.html#40254edf05e205a3" class="i method">IsWinRTType</a>(<span class="r122 r">sourceType</span>))
                {
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">EventingResources</span>.<span class="i">WinRTEventsNotSupported</span>);
                }
 
                <span class="c">// Retrieve the event from the object</span>
                <b>const</b> <span class="i">BindingFlags</span> <span id="r123 rd" class="r123 r">bindingFlags</span> = <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span>;
                <span class="r121 r">eventInfo</span> = <span class="r122 r">sourceType</span>.<span class="i">GetEvent</span>(<span class="r112 r">eventName</span>, <span class="r123 r">bindingFlags</span>);
 
                <span class="c">// If we can&#39;t find the event, throw an exception</span>
                <b>if</b> (<span class="r121 r">eventInfo</span> == <b>null</b>)
                {
                    <b>string</b> <span id="r124 rd" class="r124 r">errorMessage</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">EventingResources</span>.<span class="i">CouldNotFindEvent</span>, <span class="r112 r">eventName</span>);
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r124 r">errorMessage</span>, <b>nameof</b>(<span class="r112 r">eventName</span>));
                }
 
                <span class="c">// Try to set the EnableRaisingEvents property if it defines one</span>
                <span class="i">PropertyInfo</span> <span id="r125 rd" class="r125 r">eventProperty</span> = <span class="r122 r">sourceType</span>.<span class="i">GetProperty</span>(<span class="s">&quot;EnableRaisingEvents&quot;</span>);
                <b>if</b> (<span class="r125 r">eventProperty</span> != <b>null</b> &amp;&amp; <span class="r125 r">eventProperty</span>.<span class="i">CanWrite</span>)
                {
                    <b>try</b>
                    {
                        <b>object</b> <span id="r126 rd" class="r126 r">targetObject</span> = <span class="r125 r">eventProperty</span>.<span class="i">SetMethod</span>.<span class="i">IsStatic</span> ? <b>null</b> : <span class="r111 r">source</span>;
                        <span class="r125 r">eventProperty</span>.<span class="i">SetValue</span>(<span class="r126 r">targetObject</span>, <b>true</b>);
                    }
                    <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r127 rd" class="r127 r">e</span>)
                    {
                        <b>if</b> (<span class="r127 r">e</span>.<span class="i">InnerException</span> != <b>null</b>)
                        {
                            <b>throw</b> <span class="r127 r">e</span>.<span class="i">InnerException</span>;
                        }
                        <b>else</b>
                        {
                            <b>throw</b>;
                        }
                    }
                }
 
                <span class="c">// Get its invoke method, and register ourselves as a handler</span>
                <span class="i">MethodInfo</span> <span id="r128 rd" class="r128 r">invokeMethod</span> = <span class="r121 r">eventInfo</span>.<span class="i">EventHandlerType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;Invoke&quot;</span>);
 
                <span class="c">// We don&#39;t support non-void delegates, as the user has no way</span>
                <span class="c">// to influence the result. In the .NET Framework, the only</span>
                <span class="c">// events that return values are for extremely advanced scenarios:</span>
                <span class="c">// System.ResolveEventHandler, and System.Reflection.ModuleResolveEventHandler.</span>
                <span class="c">// For these, the Add-Type cmdlet will suffice.</span>
                <b>if</b> (<span class="r128 r">invokeMethod</span>.<span class="i">ReturnType</span> != <b>typeof</b>(<b>void</b>))
                {
                    <b>string</b> <span id="r129 rd" class="r129 r">errorMessage</span> = <span class="i">EventingResources</span>.<span class="i">NonVoidDelegateNotSupported</span>;
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r129 r">errorMessage</span>, <b>nameof</b>(<span class="r112 r">eventName</span>));
                }
 
                <span class="c">// Cache generated event handlers (by type and event name) so that they don&#39;t bloat our</span>
                <span class="c">// working set by recompiling event handlers for the same event.</span>
 
                <b>string</b> <span id="r130 rd" class="r130 r">eventHandlerKey</span> = <span class="r111 r">source</span>.<span class="i">GetType</span>().<span class="i">FullName</span> + <span class="s">&quot;|&quot;</span> + <span class="r112 r">eventName</span>;
                <span class="i">Type</span> <span id="r131 rd" class="r131 r">handlerType</span>;
 
                <b>lock</b> (<a href="#4a6a58389425b6a0" class="i field">s_generatedEventHandlers</a>)
                {
                    <b>if</b> (!<a href="#4a6a58389425b6a0" class="i field">s_generatedEventHandlers</a>.<span class="i">TryGetValue</span>(<span class="r130 r">eventHandlerKey</span>, <b>out</b> <span class="r131 r">handlerType</span>))
                    {
                        <span class="r131 r">handlerType</span> = <a href="#ad589a8e1b6bfe32" class="i method">GenerateEventHandler</a>(<span class="r128 r">invokeMethod</span>);
                        <a href="#4a6a58389425b6a0" class="i field">s_generatedEventHandlers</a>[<span class="r130 r">eventHandlerKey</span>] = <span class="r131 r">handlerType</span>;
                    }
                }
 
                <span class="c">// And create an instance of the type</span>
                <span class="i">ConstructorInfo</span> <span id="r132 rd" class="r132 r">constructor</span> =
                    <span class="r131 r">handlerType</span>.<span class="i">GetConstructor</span>(<b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>), <b>typeof</b>(<b>object</b>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>) });
                <b>object</b> <span id="r133 rd" class="r133 r">handler</span> = <span class="r132 r">constructor</span>.<span class="i">Invoke</span>(<b>new</b> <b>object</b>[] { <a href="#88db4bace82161f0" class="k">this</a>, <span class="r111 r">source</span>, <span class="r113 r">sourceIdentifier</span>, <span class="r114 r">data</span> });
                <span class="i">MethodInfo</span> <span id="r134 rd" class="r134 r">eventDelegate</span> = <span class="r131 r">handlerType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;EventDelegate&quot;</span>, <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
                <span class="r117 r">handlerDelegate</span> = <span class="r134 r">eventDelegate</span>.<span class="i">CreateDelegate</span>(<span class="r121 r">eventInfo</span>.<span class="i">EventHandlerType</span>, <span class="r133 r">handler</span>);
 
                <span class="r121 r">eventInfo</span>.<span class="i">AddEventHandler</span>(<span class="r111 r">source</span>, <span class="r117 r">handlerDelegate</span>);
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="#6788ebc57df8c769" class="i field">EngineEvents</a>.<span class="i">Contains</span>(<span class="r113 r">sourceIdentifier</span>))
                {
                    <span class="r118 r">engineEventSourceIdentifier</span> = <span class="r113 r">sourceIdentifier</span>;
                    <span class="r119 r">isOnIdleEvent</span> = <b>string</b>.<span class="i">Equals</span>(<span class="r118 r">engineEventSourceIdentifier</span>, <a href="#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="#81d0b6a36f67dda2" class="i field">OnIdle</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                }
            }
 
            <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
            {
                <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>[<span class="r110 r">subscriber</span>] = <span class="r117 r">handlerDelegate</span>;
                <b>if</b> (<span class="r118 r">engineEventSourceIdentifier</span> == <b>null</b>)
                {
                    <b>return</b>;
                }
 
                <b>lock</b> (<a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>)
                {
                    <b>if</b> (<span class="r119 r">isOnIdleEvent</span> &amp;&amp; !<a href="#798c8ee628b7c853" class="i field">_timerInitialized</a>)
                    {
                        <a href="#c90c9018dad916d5" class="i method">InitializeTimer</a>();
                        <a href="#798c8ee628b7c853" class="i field">_timerInitialized</a> = <b>true</b>;
                    }
 
                    <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r135 rd" class="r135 r">subscribers</span> = <b>null</b>;
                    <b>if</b> (!<a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>.<span class="i">TryGetValue</span>(<span class="r118 r">engineEventSourceIdentifier</span>, <b>out</b> <span class="r135 r">subscribers</span>))
                    {
                        <span class="r135 r">subscribers</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
                        <a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>.<span class="i">Add</span>(<span class="r118 r">engineEventSourceIdentifier</span>, <span class="r135 r">subscribers</span>);
                    }
 
                    <span class="r135 r">subscribers</span>.<span class="i">Add</span>(<span class="r110 r">subscriber</span>);
 
                    <span class="c">// This subscriber is the only one in the idle event list, we enable the timer</span>
                    <span class="c">// since the subscriber could be the first one.</span>
                    <b>if</b> (<span class="r119 r">isOnIdleEvent</span> &amp;&amp; !<a href="#17abab18385e3c90" class="i field">_isTimerActive</a>)
                    {
                        <a href="#de019d2e45b7e054" class="i method">EnableTimer</a>();
                        <a href="#17abab18385e3c90" class="i field">_isTimerActive</a> = <b>true</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unsubscribes from an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">subscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber associated with the event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="0525d136fda1bef4" href="../R/0525d136fda1bef4.html" target="n" data-glyph="72,1" class="i method">UnsubscribeEvent</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r136 rd" class="r136 r">subscriber</span>)
        {
            <a href="#743658831a409e95" class="i method">UnsubscribeEvent</a>(<span class="r136 r">subscriber</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unsubscribes from an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">subscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber associated with the event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">skipDraining</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if we should skip draining</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="743658831a409e95" href="../R/743658831a409e95.html" target="n" data-glyph="76,1" class="i method">UnsubscribeEvent</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r137 rd" class="r137 r">subscriber</span>, <b>bool</b> <span id="r138 rd" class="r138 r">skipDraining</span>)
        {
            <b>if</b> (<span class="r137 r">subscriber</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r137 r">subscriber</span>));
            }
 
            <span class="i">Delegate</span> <span id="r139 rd" class="r139 r">existingSubscriber</span> = <b>null</b>;
            <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
            {
                <b>if</b> (<span class="r137 r">subscriber</span>.<a href="#303562df58eea458" class="i property">IsBeingUnsubscribed</a> || !<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>.<span class="i">TryGetValue</span>(<span class="r137 r">subscriber</span>, <b>out</b> <span class="r139 r">existingSubscriber</span>))
                {
                    <span class="c">// Already unsubscribed by another thread or the subscriber doesn&#39;t exist</span>
                    <b>return</b>;
                }
 
                <span class="r137 r">subscriber</span>.<a href="#303562df58eea458" class="i property">IsBeingUnsubscribed</a> = <b>true</b>;
            }
 
            <b>if</b> ((<span class="r139 r">existingSubscriber</span> != <b>null</b>) &amp;&amp; (<span class="r137 r">subscriber</span>.<a href="#bb7132b55040cd4a" class="i property">SourceObject</a> != <b>null</b>))
            {
                <span class="c">// Fire the unregistration handler</span>
                <span class="r137 r">subscriber</span>.<a href="#ec59926632364fa6" class="i method">OnPSEventUnsubscribed</a>(<span class="r137 r">subscriber</span>.<a href="#bb7132b55040cd4a" class="i property">SourceObject</a>,
                    <b>new</b> <a href="#d9400c2a9b6867c3" class="t constructor">PSEventUnsubscribedEventArgs</a>(<span class="r137 r">subscriber</span>));
 
                <span class="i">EventInfo</span> <span id="r140 rd" class="r140 r">eventInfo</span> = <b>null</b>;
 
                <span class="i">Type</span> <span id="r141 rd" class="r141 r">sourceType</span> = <span class="r137 r">subscriber</span>.<a href="#bb7132b55040cd4a" class="i property">SourceObject</a> <b>as</b> <span class="i">Type</span> ?? <span class="r137 r">subscriber</span>.<a href="#bb7132b55040cd4a" class="i property">SourceObject</a>.<span class="i">GetType</span>();
 
                <b>const</b> <span class="i">BindingFlags</span> <span id="r142 rd" class="r142 r">bindingFlags</span> = <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span>;
                <span class="r140 r">eventInfo</span> = <span class="r141 r">sourceType</span>.<span class="i">GetEvent</span>(<span class="r137 r">subscriber</span>.<a href="#a13e01df2132579b" class="i property">EventName</a>, <span class="r142 r">bindingFlags</span>);
 
                <b>if</b> ((<span class="r140 r">eventInfo</span> != <b>null</b>) &amp;&amp; (<span class="r139 r">existingSubscriber</span> != <b>null</b>))
                {
                    <span class="r140 r">eventInfo</span>.<span class="i">RemoveEventHandler</span>(<span class="r137 r">subscriber</span>.<a href="#bb7132b55040cd4a" class="i property">SourceObject</a>, <span class="r139 r">existingSubscriber</span>);
                }
            }
 
            <span class="c">// We don&#39;t need to drain pending actions when remove an auto-unregister subscriber</span>
            <span class="c">// from ProcessPendingAction method</span>
            <b>if</b> (!<span class="r138 r">skipDraining</span>)
            {
                <span class="c">// Drain any actions pending for this subscriber</span>
                <a href="#15aa85b30d11d1d1" class="i method">DrainPendingActions</a>(<span class="r137 r">subscriber</span>);
            }
 
            <span class="c">// Stop the job</span>
            <b>if</b> (<span class="r137 r">subscriber</span>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a> != <b>null</b>)
            {
                <span class="r137 r">subscriber</span>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a>.<a href="#b30083f1c788d38c" class="i method">NotifyJobStopped</a>();
            }
 
            <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
            {
                <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>.<span class="i">Remove</span>(<span class="r137 r">subscriber</span>);
                <b>if</b> (<a href="#db3a5a65f2783a2f" class="t t">PSEngineEvent</a>.<a href="#6788ebc57df8c769" class="i field">EngineEvents</a>.<span class="i">Contains</span>(<span class="r137 r">subscriber</span>.<a href="#7bf97d4ae540b725" class="i property">SourceIdentifier</a>))
                {
                    <b>lock</b> (<a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>)
                    {
                        <a href="#cf895bfac7b495d1" class="i field">_engineEventSubscribers</a>[<span class="r137 r">subscriber</span>.<a href="#7bf97d4ae540b725" class="i property">SourceIdentifier</a>].<span class="i">Remove</span>(<span class="r137 r">subscriber</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PowerShell event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any event-specific data associated with the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="30bdfe8a4ec6d004" href="../R/30bdfe8a4ec6d004.html" target="n" data-glyph="75,1" class="i method">CreateEvent</a>(<b>string</b> <span id="r143 rd" class="r143 r">sourceIdentifier</span>, <b>object</b> <span id="r144 rd" class="r144 r">sender</span>, <b>object</b>[] <span id="r145 rd" class="r145 r">args</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r146 rd" class="r146 r">extraData</span>)
        {
            <b>return</b> <b>new</b> <a href="#a900b59b9b50722a" class="t constructor">PSEventArgs</a>(<b>null</b>, <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>.<a href="hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <a href="#371a25d6143c3770" class="i method">GetNextEventId</a>(), <span class="r143 r">sourceIdentifier</span>, <span class="r144 r">sender</span>, <span class="r145 r">args</span>, <span class="r146 r">extraData</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a forwarded event to the current event manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="f5b640da02609e18" href="../R/f5b640da02609e18.html" target="n" data-glyph="74,1" class="i method">AddForwardedEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r147 rd" class="r147 r">forwardedEvent</span>)
        {
            <span class="r147 r">forwardedEvent</span>.<a href="#192b62cb04cdc1cb" class="i property">EventIdentifier</a> = <a href="#371a25d6143c3770" class="i method">GetNextEventId</a>();
 
            <a href="#4c50c036d59aa299" class="i method">ProcessNewEvent</a>(<span class="r147 r">forwardedEvent</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4c50c036d59aa299" href="../R/4c50c036d59aa299.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r148 rd" class="r148 r">newEvent</span>, <b>bool</b> <span id="r149 rd" class="r149 r">processInCurrentThread</span>)
        {
            <a href="#d28b858a4c0b56ef" class="i method">ProcessNewEvent</a>(<span class="r148 r">newEvent</span>, <span class="r149 r">processInCurrentThread</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected internal override void</b> <a id="d28b858a4c0b56ef" href="../R/d28b858a4c0b56ef.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r150 rd" class="r150 r">newEvent</span>,
            <b>bool</b> <span id="r151 rd" class="r151 r">processInCurrentThread</span>,
            <b>bool</b> <span id="r152 rd" class="r152 r">waitForCompletionWhenInCurrentThread</span>)
        {
            <b>if</b> (<span class="r151 r">processInCurrentThread</span>)
            {
                <a href="#4b168b974f39173c" class="i method">ProcessNewEventImplementation</a>(<span class="r150 r">newEvent</span>, <b>true</b>);
                <span class="i">ManualResetEventSlim</span> <span id="r153 rd" class="r153 r">waitHandle</span> = <span class="r150 r">newEvent</span>.<a href="#110ebc38c61b5113" class="i property">EventProcessed</a>;
                <b>if</b> (<span class="r153 r">waitHandle</span> != <b>null</b>)
                {
                    <span class="c">// Win8: 738767 In Win7, the processInCurrentThread parameter was used to be</span>
                    <span class="c">// called processSynchronously. Even though the parameter was called &quot;processSynchronously&quot;,</span>
                    <span class="c">// the event and associated action were not processed synchronously..the event manager</span>
                    <span class="c">// just added the associated action into event queue. The action can get executed at a later</span>
                    <span class="c">// time depending on the throttle checks etc. In Win8, to support routing of ScriptBlock</span>
                    <span class="c">// invocation to the current runspace, we took dependency on eventing infrastructure and</span>
                    <span class="c">// this required ensuring the event and associated action be processed in the current thread</span>
                    <span class="c">// synchronously. The below while loop was added for that (win8: 530495). However, fix for</span>
                    <span class="c">// 530495 resulted in not responding for icm | % { icm } case and dynamic event/subscriptions scenarios.</span>
                    <span class="c">// To overcome that, changed &quot;processSynchronously&quot; parameter to &quot;processInCurrentThread&quot; and added</span>
                    <span class="c">// a new parameter &quot;waitForCompletionWhenInCurrentThread&quot; to trigger blocking for ScriptBlock</span>
                    <span class="c">// case.</span>
                    <b>while</b> (<span class="r152 r">waitForCompletionWhenInCurrentThread</span> &amp;&amp; !<span class="r153 r">waitHandle</span>.<span class="i">Wait</span>(250))
                    {
                        <a href="#88db4bace82161f0" class="k">this</a>.<a href="#2b06c4e89213cb8c" class="i method">ProcessPendingActions</a>();
                    }
 
                    <span class="r153 r">waitHandle</span>.<span class="i">Dispose</span>();
                }
            }
            <b>else</b>
            {
                <span class="i">ThreadPool</span>.<span class="i">QueueUserWorkItem</span>(<b>new</b> <span class="i">WaitCallback</span>((<span id="r154 rd" class="r154 r">_</span>) =&gt; <a href="#4b168b974f39173c" class="i method">ProcessNewEventImplementation</a>(<span class="r150 r">newEvent</span>, <b>false</b>)));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from ProcessNewEvent to actually process the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4b168b974f39173c" href="../R/4b168b974f39173c.html" target="n" data-glyph="76,1" class="i method">ProcessNewEventImplementation</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r155 rd" class="r155 r">newEvent</span>, <b>bool</b> <span id="r156 rd" class="r156 r">processSynchronously</span>)
        {
            <span class="c">// Get the subscriber(s) for this event</span>
            <b>bool</b> <span id="r157 rd" class="r157 r">capturedEvent</span> = <b>false</b>;
            <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r158 rd" class="r158 r">actionsHandledInCurrentThread</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
            <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r159 rd" class="r159 r">subscribersWithoutActionOrHandler</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
            <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r160 rd" class="r160 r">subscriber</span> <b>in</b> <a href="#2b1ebe89472e43df" class="i method">GetEventSubscribers</a>(<span class="r155 r">newEvent</span>.<a href="#d8b1da7bcf77174b" class="i property">SourceIdentifier</a>, <b>true</b>))
            {
                <span class="r155 r">newEvent</span>.<a href="#d46e9434510d399e" class="i property">ForwardEvent</a> = <span class="r160 r">subscriber</span>.<a href="#46a5c6b166a1bd0a" class="i property">ForwardEvent</a>;
 
                <span class="c">// If we found a subscriber and it has an action, queue it up</span>
                <b>if</b> (<span class="r160 r">subscriber</span>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a> != <b>null</b>)
                {
                    <a href="#71e68727e6e52161" class="i method">AddAction</a>(<b>new</b> <a href="#503a109350815231" class="t constructor">EventAction</a>(<span class="r160 r">subscriber</span>, <span class="r155 r">newEvent</span>), <span class="r156 r">processSynchronously</span>);
                    <span class="r157 r">capturedEvent</span> = <b>true</b>;
                }
                <b>else</b> <b>if</b> (<span class="r160 r">subscriber</span>.<a href="#111574d1f8f48930" class="i property">HandlerDelegate</a> != <b>null</b>)
                {
                    <b>if</b> (<span class="r160 r">subscriber</span>.<a href="#0b6d70951efe328d" class="i property">ShouldProcessInExecutionThread</a>)
                    {
                        <a href="#71e68727e6e52161" class="i method">AddAction</a>(<b>new</b> <a href="#503a109350815231" class="t constructor">EventAction</a>(<span class="r160 r">subscriber</span>, <span class="r155 r">newEvent</span>), <span class="r156 r">processSynchronously</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r158 r">actionsHandledInCurrentThread</span>.<span class="i">Add</span>(<span class="r160 r">subscriber</span>);
                    }
 
                    <span class="r157 r">capturedEvent</span> = <b>true</b>;
                }
                <b>else</b>
                {
                    <span class="r159 r">subscribersWithoutActionOrHandler</span>.<span class="i">Add</span>(<span class="r160 r">subscriber</span>);
                }
            }
 
            <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r161 rd" class="r161 r">subscriber</span> <b>in</b> <span class="r158 r">actionsHandledInCurrentThread</span>)
            {
                <span class="r161 r">subscriber</span>.<a href="#111574d1f8f48930" class="i property">HandlerDelegate</a>(<span class="r155 r">newEvent</span>.<a href="#1b4e059cf3c8cdad" class="i property">Sender</a>, <span class="r155 r">newEvent</span>);
                <a href="#23795c8567f65871" class="i method">AutoUnregisterEventIfNecessary</a>(<span class="r161 r">subscriber</span>);
            }
 
            <span class="c">// Otherwise, add it to the queue of unprocessed items, unless we are forwarding the event</span>
            <b>if</b> (!<span class="r157 r">capturedEvent</span>)
            {
                <b>if</b> (<span class="r155 r">newEvent</span>.<a href="#d46e9434510d399e" class="i property">ForwardEvent</a>)
                {
                    <a href="#cc88ca0d9417fa60" class="i method">OnForwardEvent</a>(<span class="r155 r">newEvent</span>);
                }
                <b>else</b>
                {
                    <b>lock</b> (<a href="#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="#80f9d007b76c3b3b" class="i property">SyncRoot</a>)
                    {
                        <a href="#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="#44c940e5e9270cc4" class="i method">Add</a>(<span class="r155 r">newEvent</span>);
                    }
                }
 
                <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r162 rd" class="r162 r">subscriber</span> <b>in</b> <span class="r159 r">subscribersWithoutActionOrHandler</span>)
                {
                    <a href="#23795c8567f65871" class="i method">AutoUnregisterEventIfNecessary</a>(<span class="r162 r">subscriber</span>);
                }
            }
        }
 
        <span class="c">// Add an action to the event queue</span>
        <b>private void</b> <a id="71e68727e6e52161" href="../R/71e68727e6e52161.html" target="n" data-glyph="76,1" class="i method">AddAction</a>(<a href="#859782a2e1b81f61" class="t t">EventAction</a> <span id="r163 rd" class="r163 r">action</span>, <b>bool</b> <span id="r164 rd" class="r164 r">processSynchronously</span>)
        {
            <b>if</b> (<span class="r164 r">processSynchronously</span>)
            {
                <span class="c">// This mutex will get set after the event is processed.</span>
                <span class="r163 r">action</span>.<a href="#b3e8d63110cc6812" class="i property">Args</a>.<a href="#110ebc38c61b5113" class="i property">EventProcessed</a> = <b>new</b> <span class="i">ManualResetEventSlim</span>();
            }
 
            <b>lock</b> (((<span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ICollection</span>)<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>).<span class="i">SyncRoot</span>)
            {
                <span class="c">// If the engine isn&#39;t active, pulse the pipeline.</span>
                <span class="c">// When the engine starts up, it will pick up the pending events</span>
                <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Enqueue</span>(<span class="r163 r">action</span>);
            }
 
            <a href="#762dd5ba20f500fe" class="i method">PulseEngine</a>();
        }
 
        <span class="c">// PowerShell support for async notifications happen through the</span>
        <span class="c">// CheckForInterrupts() method on ParseTreeNode. These are only called when</span>
        <span class="c">// the engine is active (and processing,) so the Pulse() method</span>
        <span class="c">// executes the equivalent of a NOP so that async events</span>
        <span class="c">// can be processed when the engine is idle.</span>
        <b>private void</b> <a id="762dd5ba20f500fe" href="../R/762dd5ba20f500fe.html" target="n" data-glyph="76,1" class="i method">PulseEngine</a>()
        {
            <b>try</b>
            {
                ((<a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="hostifaces/ConnectionBase.cs.html#a4907a23ecb3e997" class="i method">Pulse</a>();
            }
            <b>catch</b> (<span class="i">ObjectDisposedException</span>)
            { }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process any pending actions. The parser calls this method before it executes any</span>
        <span class="c">///</span><span class="c"> parse tree node. If we are processing pending actions, we must block the parser.</span>
        <span class="c">///</span><span class="c"> To prevent starvation of the foreground script, we throttle the number of events</span>
        <span class="c">///</span><span class="c"> that we process while the parser is waiting. If the parser is not waiting, we</span>
        <span class="c">///</span><span class="c"> do not throttle the event processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2b06c4e89213cb8c" href="../R/2b06c4e89213cb8c.html" target="n" data-glyph="74,1" class="i method">ProcessPendingActions</a>()
        {
            <span class="c">// We do this check quickly outside of the lock so that the</span>
            <span class="c">// main-line scenario is as fast as possible.  Also, do the real work</span>
            <span class="c">// in a different method so that this method could be inlined.</span>
            <b>if</b> (<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Count</span> == 0)
                <b>return</b>;
 
            <a href="#2227307f2d3e6c97" class="i method">ProcessPendingActionsImpl</a>();
        }
 
        <b>private void</b> <a id="2227307f2d3e6c97" href="../R/2227307f2d3e6c97.html" target="n" data-glyph="76,1" class="i method">ProcessPendingActionsImpl</a>()
        {
            <span class="c">// Now, process pending actions</span>
            <b>if</b> (<a href="#2db7fe198f49b713" class="i property">IsExecutingEventAction</a>)
                <b>return</b>;
 
            <b>try</b>
            {
                <b>lock</b> (<a href="#cee4212144692678" class="i field">_actionProcessingLock</a>)
                {
                    <b>if</b> (<a href="#2db7fe198f49b713" class="i property">IsExecutingEventAction</a>)
                        <b>return</b>;
 
                    <b>int</b> <span id="r165 rd" class="r165 r">processed</span> = 0;
                    <a href="#ab0563ef68b0587a" class="i field">_throttleChecks</a>++;
                    <a href="#859782a2e1b81f61" class="t t">EventAction</a> <span id="r166 rd" class="r166 r">nextAction</span>;
 
                    <b>while</b> ((<a href="#be57aa63b95a31bc" class="i field">_throttleLimit</a> * <a href="#ab0563ef68b0587a" class="i field">_throttleChecks</a>) &gt;= <span class="r165 r">processed</span>)
                    {
                        <span class="c">// Now, check for (and process) pending actions.</span>
                        <span class="c">// Lock the collection so that it doesn&#39;t change from</span>
                        <span class="c">// beneath us.</span>
                        <b>lock</b> (((<span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ICollection</span>)<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>).<span class="i">SyncRoot</span>)
                        {
                            <b>int</b> <span id="r167 rd" class="r167 r">queueCount</span> = <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Count</span>;
 
                            <span class="c">// Exit if the actions have already been processed</span>
                            <b>if</b> (<span class="r167 r">queueCount</span> == 0)
                                <b>return</b>;
 
                            <span class="r166 r">nextAction</span> = <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Dequeue</span>();
                        }
 
                        <b>bool</b> <span id="r168 rd" class="r168 r">addActionBackToActionQueue</span> = <b>false</b>;
                        <a href="#835f38c037142171" class="i method">InvokeAction</a>(<span class="r166 r">nextAction</span>, <b>out</b> <span class="r168 r">addActionBackToActionQueue</span>);
                        <span class="r165 r">processed</span>++;
 
                        <b>if</b> (!<span class="r168 r">addActionBackToActionQueue</span>)
                        {
                            <a href="#23795c8567f65871" class="i method">AutoUnregisterEventIfNecessary</a>(<span class="r166 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>);
                        }
                    }
 
                    <b>if</b> (<span class="r165 r">processed</span> &gt; 0)
                        <a href="#ab0563ef68b0587a" class="i field">_throttleChecks</a> = 0;
                }
            }
            <b>finally</b>
            {
                <b>if</b> (<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// If we still have work remaining, sleep a bit (to give</span>
                    <span class="c">// other pipelines a chance to interrupt,) and try again.</span>
                    <span class="c">// This is done on another thread, since we own the runspace lock</span>
                    <span class="c">// at this point if we&#39;re being called from the pipeline</span>
                    <span class="c">// teardown event. That can result in starvation of</span>
                    <span class="c">// foreground threads that also want to use the runspace.</span>
                    <span class="i">ThreadPool</span>.<span class="i">QueueUserWorkItem</span>(<b>new</b> <span class="i">WaitCallback</span>(
                        (<span id="r169 rd" class="r169 r">_</span>) =&gt;
                        {
                            <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(100);
                            <a href="#88db4bace82161f0" class="k">this</a>.<a href="#762dd5ba20f500fe" class="i method">PulseEngine</a>();
                        }));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Auto unregister the subscriber if both &#39;RemainingTriggerCount&#39; and &#39;RemainingActionsToProcess&#39; become zero.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="23795c8567f65871" href="../R/23795c8567f65871.html" target="n" data-glyph="76,1" class="i method">AutoUnregisterEventIfNecessary</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r170 rd" class="r170 r">subscriber</span>)
        {
            <b>bool</b> <span id="r171 rd" class="r171 r">removeSubscriber</span> = <b>false</b>;
            <b>if</b> (<span class="r170 r">subscriber</span>.<a href="#7d272be0b7dce73d" class="i property">AutoUnregister</a>)
            {
                <b>lock</b> (<span class="r170 r">subscriber</span>)
                {
                    <span class="r170 r">subscriber</span>.<a href="#2e4be03967a57fa5" class="i property">RemainingActionsToProcess</a>--;
                    <span class="r171 r">removeSubscriber</span> = <span class="r170 r">subscriber</span>.<a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> == 0 &amp;&amp;
                                       <span class="r170 r">subscriber</span>.<a href="#2e4be03967a57fa5" class="i property">RemainingActionsToProcess</a> == 0;
                }
            }
 
            <b>if</b> (<span class="r171 r">removeSubscriber</span>)
            {
                <a href="#743658831a409e95" class="i method">UnsubscribeEvent</a>(<span class="r170 r">subscriber</span>, <b>true</b>);
            }
        }
 
        <b>private readonly object</b> <a id="cee4212144692678" href="../R/cee4212144692678.html" target="n" data-glyph="46,1" class="i field">_actionProcessingLock</a> = <b>new</b> <b>object</b>();
        <b>private</b> <a href="#859782a2e1b81f61" class="t t">EventAction</a> <a id="e074a98454265d4a" href="../R/e074a98454265d4a.html" target="n" data-glyph="46,1" class="i field">_processingAction</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Drain any pending actions for a given subscriber.</span>
        <span class="c">///</span><span class="c"> This is a synchronous (and expensive) operation, but is</span>
        <span class="c">///</span><span class="c"> required so that unregistering for an event / stopping the</span>
        <span class="c">///</span><span class="c"> event job truly discontinues those event arrivals.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="15aa85b30d11d1d1" href="../R/15aa85b30d11d1d1.html" target="n" data-glyph="74,1" class="i method">DrainPendingActions</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r172 rd" class="r172 r">subscriber</span>)
        {
            <span class="c">// We do this check quickly outside of the lock so that the</span>
            <span class="c">// main-line scenario is as fast as possible.</span>
            <b>if</b> (<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Count</span> == 0)
                <b>return</b>;
 
            <span class="c">// Now, process pending actions</span>
            <b>lock</b> (<a href="#cee4212144692678" class="i field">_actionProcessingLock</a>)
            {
                <b>lock</b> (((<span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ICollection</span>)<a href="#d9c986f923fe590a" class="i field">_actionQueue</a>).<span class="i">SyncRoot</span>)
                {
                    <b>int</b> <span id="r173 rd" class="r173 r">queueCount</span> = <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Count</span>;
 
                    <span class="c">// Exit if the actions have already been processed</span>
                    <b>if</b> (<span class="r173 r">queueCount</span> == 0)
                        <b>return</b>;
 
                    <b>bool</b> <span id="r174 rd" class="r174 r">needToScanAgain</span> = <b>false</b>;
 
                    <b>do</b>
                    {
                        <a href="#859782a2e1b81f61" class="t t">EventAction</a>[] <span id="r175 rd" class="r175 r">pendingActions</span> = <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">ToArray</span>();
                        <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Clear</span>();
 
                        <b>foreach</b> (<a href="#859782a2e1b81f61" class="t t">EventAction</a> <span id="r176 rd" class="r176 r">pendingAction</span> <b>in</b> <span class="r175 r">pendingActions</span>)
                        {
                            <span class="c">// Make sure an event action can unregister itself.</span>
                            <b>if</b> ((<span class="r176 r">pendingAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a> == <span class="r172 r">subscriber</span>) &amp;&amp;
                                (<span class="r176 r">pendingAction</span> != <a href="#e074a98454265d4a" class="i field">_processingAction</a>))
                            {
                                <b>while</b> (<a href="#2db7fe198f49b713" class="i property">IsExecutingEventAction</a>)
                                    <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(100);
 
                                <b>bool</b> <span id="r177 rd" class="r177 r">addActionBackToActionQueue</span> = <b>false</b>;
                                <a href="#835f38c037142171" class="i method">InvokeAction</a>(<span class="r176 r">pendingAction</span>, <b>out</b> <span class="r177 r">addActionBackToActionQueue</span>);
 
                                <b>if</b> (<span class="r177 r">addActionBackToActionQueue</span>)
                                {
                                    <span class="r174 r">needToScanAgain</span> = <b>true</b>;
                                }
                            }
                            <b>else</b>
                            {
                                <a href="#d9c986f923fe590a" class="i field">_actionQueue</a>.<span class="i">Enqueue</span>(<span class="r176 r">pendingAction</span>);
                            }
                        }
                    } <b>while</b> (<span class="r174 r">needToScanAgain</span>);
                }
            }
        }
 
        <b>private void</b> <a id="835f38c037142171" href="../R/835f38c037142171.html" target="n" data-glyph="76,1" class="i method">InvokeAction</a>(<a href="#859782a2e1b81f61" class="t t">EventAction</a> <span id="r178 rd" class="r178 r">nextAction</span>, <b>out bool</b> <span id="r179 rd" class="r179 r">addActionBack</span>)
        {
            <b>lock</b> (<a href="#cee4212144692678" class="i field">_actionProcessingLock</a>)
            {
                <a href="#e074a98454265d4a" class="i field">_processingAction</a> = <span class="r178 r">nextAction</span>;
                <span class="r179 r">addActionBack</span> = <b>false</b>;
 
                <span class="c">// Invoke the action in its own session state</span>
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r180 rd" class="r180 r">oldSessionState</span> = <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
                <b>if</b> (<span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a> != <b>null</b>)
                {
                    <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> = <span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a>.<a href="#95fb9d7088541eab" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#d25a345294fd74f0" class="i property">SessionStateInternal</a>;
                }
 
                <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r181 rd" class="r181 r">oldDefault</span> = <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
 
                <b>try</b>
                {
                    <span class="c">// Set the engine&#39;s session state to be</span>
                    <span class="c">// the session state of the action. Also update the default runspace that the</span>
                    <span class="c">// scriptblock will execute under, so that scriptblocks will stay in the same</span>
                    <span class="c">// runspace they were invoked from.</span>
                    <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>;
                    <b>if</b> (<span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a> != <b>null</b>)
                    {
                        <span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a>.<a href="#def1f5e4317f3cc3" class="i method">Invoke</a>(<span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>, <span class="r178 r">nextAction</span>.<a href="#b3e8d63110cc6812" class="i property">Args</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>.<a href="#111574d1f8f48930" class="i property">HandlerDelegate</a>(<span class="r178 r">nextAction</span>.<a href="#58708b3190fa5e3c" class="i property">Sender</a>, <span class="r178 r">nextAction</span>.<a href="#b3e8d63110cc6812" class="i property">Args</a>);
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r182 rd" class="r182 r">e</span>)
                {
                    <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                    <b>if</b> (<span class="r182 r">e</span> <b>is</b> <a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
                    {
                        <span class="c">// Enqueue the action again, as we weren&#39;t able to process it.</span>
                        <span class="c">// It is possible that the PipelineStoppedException gets generated</span>
                        <span class="c">// to interrupt _our_ event, but is much more likely to get generated</span>
                        <span class="c">// when somebody wants to interrupt the pipeline that we are interrupting</span>
                        <span class="c">// (such as a long directory listing.)</span>
                        <a href="#71e68727e6e52161" class="i method">AddAction</a>(<span class="r178 r">nextAction</span>, <span class="r164 r">processSynchronously</span>: <b>false</b>);
                        <span class="r179 r">addActionBack</span> = <b>true</b>;
                    }
                }
                <b>finally</b>
                {
                    <b>var</b> <span id="r183 rd" class="r183 r">eventProcessed</span> = <span class="r178 r">nextAction</span>.<a href="#b3e8d63110cc6812" class="i property">Args</a>.<a href="#110ebc38c61b5113" class="i property">EventProcessed</a>;
                    <b>if</b> (!<span class="r179 r">addActionBack</span> &amp;&amp; <span class="r183 r">eventProcessed</span> != <b>null</b>)
                    {
                        <span class="r183 r">eventProcessed</span>.<span class="i">Set</span>();
                    }
 
                    <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r181 r">oldDefault</span>;
                    <a href="#681c0f08ad20aa1a" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> = <span class="r180 r">oldSessionState</span>;
                    <a href="#e074a98454265d4a" class="i field">_processingAction</a> = <b>null</b>;
                }
            }
        }
 
        <b>internal bool</b> <a id="2db7fe198f49b713" href="../R/2db7fe198f49b713.html" target="n" data-glyph="104,1" class="i property">IsExecutingEventAction</a>
        {
            <b>get</b> { <b>return</b> (<a href="#e074a98454265d4a" class="i field">_processingAction</a> != <b>null</b>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the event subscription that corresponds to an identifier</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The identifier that identifies the source of the events</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">IEnumerable</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="a66bfc1310dd096f" href="../R/a66bfc1310dd096f.html" target="n" data-glyph="72,1" class="i method">GetEventSubscribers</a>(<b>string</b> <span id="r184 rd" class="r184 r">sourceIdentifier</span>)
        {
            <b>return</b> <a href="#2b1ebe89472e43df" class="i method">GetEventSubscribers</a>(<span class="r184 r">sourceIdentifier</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If we add event filter feature in the future, the filtering work should be done in this method,</span>
        <span class="c">///</span><span class="c"> so that we only return a list of subscribers that will be invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerable</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="2b1ebe89472e43df" href="../R/2b1ebe89472e43df.html" target="n" data-glyph="76,1" class="i method">GetEventSubscribers</a>(<b>string</b> <span id="r185 rd" class="r185 r">sourceIdentifier</span>, <b>bool</b> <span id="r186 rd" class="r186 r">forNewEventProcessing</span>)
        {
            <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r187 rd" class="r187 r">returnedSubscribers</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
            <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <span id="r188 rd" class="r188 r">subscribersToBeRemoved</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;();
 
            <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
            {
                <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r189 rd" class="r189 r">currentSubscriber</span> <b>in</b> <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>.<span class="i">Keys</span>)
                {
                    <b>bool</b> <span id="r190 rd" class="r190 r">takeActionForEvent</span> = <b>false</b>;
                    <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r189 r">currentSubscriber</span>.<a href="#7bf97d4ae540b725" class="i property">SourceIdentifier</a>, <span class="r185 r">sourceIdentifier</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<span class="r186 r">forNewEventProcessing</span>)
                        {
                            <span class="c">// The caller tries to process the event</span>
                            <b>if</b> (!<span class="r189 r">currentSubscriber</span>.<a href="#7d272be0b7dce73d" class="i property">AutoUnregister</a> || <span class="r189 r">currentSubscriber</span>.<a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> &gt; 0)
                            {
                                <span class="c">// If we need the event filter feature, it should be added here.</span>
                                <span class="r190 r">takeActionForEvent</span> = <b>true</b>;
                                <span class="r187 r">returnedSubscribers</span>.<span class="i">Add</span>(<span class="r189 r">currentSubscriber</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// The caller tries to get all subscribers for this event but it&#39;s NOT for the event processing purpose</span>
                            <span class="r187 r">returnedSubscribers</span>.<span class="i">Add</span>(<span class="r189 r">currentSubscriber</span>);
                        }
 
                        <span class="c">// Handle auto-unregister subscribers here</span>
                        <b>if</b> (<span class="r186 r">forNewEventProcessing</span> &amp;&amp; <span class="r189 r">currentSubscriber</span>.<a href="#7d272be0b7dce73d" class="i property">AutoUnregister</a> &amp;&amp; <span class="r189 r">currentSubscriber</span>.<a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> &gt; 0)
                        {
                            <b>lock</b> (<span class="r189 r">currentSubscriber</span>)
                            {
                                <span class="r189 r">currentSubscriber</span>.<a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a>--;
                                <span class="c">// For now, &#39;takeActionForEvent&#39; is always True when we get to this point.</span>
                                <span class="c">// But once the event filter feature is added, it could be False when we get to this point.</span>
                                <b>if</b> (<span class="r190 r">takeActionForEvent</span>)
                                {
                                    <span class="r189 r">currentSubscriber</span>.<a href="#2e4be03967a57fa5" class="i property">RemainingActionsToProcess</a>++;
                                }
 
                                <span class="c">// This condition can only happen after the event filter feature is introduced</span>
                                <b>if</b> (<span class="r189 r">currentSubscriber</span>.<a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> == 0 &amp;&amp; <span class="r189 r">currentSubscriber</span>.<a href="#2e4be03967a57fa5" class="i property">RemainingActionsToProcess</a> == 0)
                                {
                                    <span class="r188 r">subscribersToBeRemoved</span>.<span class="i">Add</span>(<span class="r189 r">currentSubscriber</span>);
                                }
                            }
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r188 r">subscribersToBeRemoved</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r191 rd" class="r191 r">subscriber</span> <b>in</b> <span class="r188 r">subscribersToBeRemoved</span>)
                {
                    <a href="#743658831a409e95" class="i method">UnsubscribeEvent</a>(<span class="r191 r">subscriber</span>, <b>true</b>);
                }
            }
 
            <b>return</b> <span class="r187 r">returnedSubscribers</span>;
        }
 
        <span class="c">// Generates a type and method to handle a strongly-typed event from an object</span>
        <span class="c">// The event handler itself does as little as possible, as dynamically emitted IL</span>
        <span class="c">// is error prone and difficult to read. When possible, functionality enhancements</span>
        <span class="c">// should go in the PSEventHandler class, from which every event handler type derives.</span>
        <b>private</b> <span class="i">Type</span> <a id="ad589a8e1b6bfe32" href="../R/ad589a8e1b6bfe32.html" target="n" data-glyph="76,1" class="i method">GenerateEventHandler</a>(<span class="i">MethodInfo</span> <span id="r192 rd" class="r192 r">invokeSignature</span>)
        {
            <b>int</b> <span id="r193 rd" class="r193 r">parameterCount</span> = <span class="r192 r">invokeSignature</span>.<span class="i">GetParameters</span>().<span class="i">Length</span>;
 
            <span class="c">// Define the type that will respond to the event. It</span>
            <span class="c">// derives from PSEventHandler so that complex</span>
            <span class="c">// functionality can go into its base class.</span>
            <span class="i">TypeBuilder</span> <span id="r194 rd" class="r194 r">eventType</span> =
                <a href="#6a76a4701ded1358" class="i field">_eventModule</a>.<span class="i">DefineType</span>(<span class="s">&quot;PSEventHandler_&quot;</span> + <a href="#7e5e283d600ec4d7" class="i field">_typeId</a>, <span class="i">TypeAttributes</span>.<span class="i">Public</span>, <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>));
            <a href="#7e5e283d600ec4d7" class="i field">_typeId</a>++;
 
            <span class="c">// Retrieve the existing constructor</span>
            <span class="i">ConstructorInfo</span> <span id="r195 rd" class="r195 r">existingConstructor</span> =
                <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>).<span class="i">GetConstructor</span>(
                    <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>), <b>typeof</b>(<b>object</b>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>) });
 
            <span class="c">// Define the new constructor</span>
            <span class="c">// public TestEventHandler(PSEventManager eventManager, Object sender, string sourceIdentifier, PSObject extraData)</span>
            <span class="c">// : base(eventManager, sender, sourceIdentifier, extraData)</span>
            <span class="i">ConstructorBuilder</span> <span id="r196 rd" class="r196 r">eventConstructor</span> =
                <span class="r194 r">eventType</span>.<span class="i">DefineConstructor</span>(<span class="i">MethodAttributes</span>.<span class="i">Public</span>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                    <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>), <b>typeof</b>(<b>object</b>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>) });
            <span class="i">ILGenerator</span> <span id="r197 rd" class="r197 r">extendedConstructor</span> = <span class="r196 r">eventConstructor</span>.<span class="i">GetILGenerator</span>();
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_1</span>);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_2</span>);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_3</span>);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg</span>, 4);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Call</span>, <span class="r195 r">existingConstructor</span>);
            <span class="r197 r">extendedConstructor</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
            <span class="c">// Go through each of the parameters in the event signature, and store their types</span>
            <span class="i">Type</span>[] <span id="r198 rd" class="r198 r">parameterTypes</span> = <b>new</b> <span class="i">Type</span>[<span class="r193 r">parameterCount</span>];
            <b>int</b> <span id="r199 rd" class="r199 r">parameterCounter</span> = 0;
            <b>foreach</b> (<span class="i">ParameterInfo</span> <span id="r200 rd" class="r200 r">parameter</span> <b>in</b> <span class="r192 r">invokeSignature</span>.<span class="i">GetParameters</span>())
            {
                <span class="r198 r">parameterTypes</span>[<span class="r199 r">parameterCounter</span>] = <span class="r200 r">parameter</span>.<span class="i">ParameterType</span>;
                <span class="r199 r">parameterCounter</span>++;
            }
 
            <span class="c">// public void EventDelegate(object sender, FileSystemEventArgs e)</span>
            <span class="i">MethodBuilder</span> <span id="r201 rd" class="r201 r">eventMethod</span> = <span class="r194 r">eventType</span>.<span class="i">DefineMethod</span>(<span class="s">&quot;EventDelegate&quot;</span>,
                <span class="i">MethodAttributes</span>.<span class="i">Public</span>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>, <span class="r192 r">invokeSignature</span>.<span class="i">ReturnType</span>, <span class="r198 r">parameterTypes</span>);
 
            <span class="c">// Create new parameters that mimic the parameters of the event method</span>
            <span class="r199 r">parameterCounter</span> = 1;
            <b>foreach</b> (<span class="i">ParameterInfo</span> <span id="r202 rd" class="r202 r">parameter</span> <b>in</b> <span class="r192 r">invokeSignature</span>.<span class="i">GetParameters</span>())
            {
                <span class="i">ParameterBuilder</span> <span id="r203 rd" class="r203 r">builder</span> = <span class="r201 r">eventMethod</span>.<span class="i">DefineParameter</span>(
                    <span class="r199 r">parameterCounter</span>, <span class="r202 r">parameter</span>.<span class="i">Attributes</span>, <span class="r202 r">parameter</span>.<span class="i">Name</span>);
                <span class="r199 r">parameterCounter</span>++;
            }
 
            <span class="i">ILGenerator</span> <span id="r204 rd" class="r204 r">methodContents</span> = <span class="r201 r">eventMethod</span>.<span class="i">GetILGenerator</span>();
 
            <span class="c">// Declare a local variable of the type &#39;object[]&#39; at index 0, say &#39;object[] args&#39;</span>
            <span class="r204 r">methodContents</span>.<span class="i">DeclareLocal</span>(<b>typeof</b>(<b>object</b>[]));
 
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r193 r">parameterCount</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Newarr</span>, <b>typeof</b>(<b>object</b>));
 
            <span class="c">// Store the new array to the local variable &#39;args&#39;</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stloc_0</span>);
 
            <span class="c">// Inline, this converts into a series of setting args[n] to</span>
            <span class="c">// the argument at the same parameter index</span>
            <b>for</b> (<b>int</b> <span id="r205 rd" class="r205 r">counter</span> = 1; <span class="r205 r">counter</span> &lt;= <span class="r193 r">parameterCount</span>; <span class="r205 r">counter</span>++)
            {
                <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc_0</span>);
                <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldc_I4</span>, <span class="r205 r">counter</span> - 1);
                <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg</span>, <span class="r205 r">counter</span>);
 
                <span class="c">// Box the value type if necessary</span>
                <b>if</b> (<span class="r198 r">parameterTypes</span>[<span class="r205 r">counter</span> - 1].<span class="i">IsValueType</span>)
                {
                    <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Box</span>, <span class="r198 r">parameterTypes</span>[<span class="r205 r">counter</span> - 1]);
                }
 
                <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Stelem_Ref</span>);
            }
 
            <span class="c">// Gain access to &quot;this&quot;</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
 
            <span class="c">// Load the &quot;eventManager&quot; private field, and push it onto the stack</span>
            <span class="i">FieldInfo</span> <span id="r206 rd" class="r206 r">eventManagerField</span> = <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>).<span class="i">GetField</span>(<span class="s">&quot;eventManager&quot;</span>,
                <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r206 r">eventManagerField</span>);
 
            <span class="c">// Then the &quot;sourceIdentifier&quot; private field</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
            <span class="i">FieldInfo</span> <span id="r207 rd" class="r207 r">identifierField</span> = <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>).<span class="i">GetField</span>(<span class="s">&quot;sourceIdentifier&quot;</span>,
                <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r207 r">identifierField</span>);
 
            <span class="c">// Then the &quot;sender&quot; private field</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
            <span class="i">FieldInfo</span> <span id="r208 rd" class="r208 r">senderField</span> = <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>).<span class="i">GetField</span>(<span class="s">&quot;sender&quot;</span>,
                <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r208 r">senderField</span>);
 
            <span class="c">// Then push the args variable onto the stack</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldloc_0</span>);
 
            <span class="c">// Then push the &quot;extraData&quot; private field</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
            <span class="i">FieldInfo</span> <span id="r209 rd" class="r209 r">extraDataField</span> = <b>typeof</b>(<a href="#ec3826338c9ee839" class="t t">PSEventHandler</a>).<span class="i">GetField</span>(<span class="s">&quot;extraData&quot;</span>,
                <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldfld</span>, <span class="r209 r">extraDataField</span>);
 
            <span class="c">// Finally, invoke the method</span>
            <span class="i">MethodInfo</span> <span id="r210 rd" class="r210 r">generateEventMethod</span> = <b>typeof</b>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>).<span class="i">GetMethod</span>(
                <b>nameof</b>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>.<span class="i">GenerateEvent</span>),
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>object</b>), <b>typeof</b>(<b>object</b>[]), <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>) });
 
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r210 r">generateEventMethod</span>);
 
            <span class="c">// Discard the return value, and return</span>
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Pop</span>);
            <span class="r204 r">methodContents</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
 
            <b>return</b> <span class="r194 r">eventType</span>.<span class="i">CreateTypeInfo</span>().<span class="i">AsType</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event is raised by the event manager to forward events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="d0d9124a4eabf407" href="../R/d0d9124a4eabf407.html" target="n" data-glyph="32,1" class="i">ForwardEvent</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the ForwardEvent event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="cc88ca0d9417fa60" href="../R/cc88ca0d9417fa60.html" target="n" data-glyph="75,1" class="i method">OnForwardEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r211 rd" class="r211 r">e</span>)
        {
            <a href="#d0d9124a4eabf407" class="i">ForwardEvent</a>?.<span class="i">Invoke</span>(<a href="#88db4bace82161f0" class="k">this</a>, <span class="r211 r">e</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disposes the EventManager class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a60d9ba6a29ad13b" href="../R/a60d9ba6a29ad13b.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#3bcc3be652d4bc42" class="i method">Dispose</a>(<b>true</b>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#88db4bace82161f0" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop the timer if it&#39;s not null.</span>
        <span class="c">///</span><span class="c"> Unsubscribes from all events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether to actually dispose the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3bcc3be652d4bc42" href="../R/3bcc3be652d4bc42.html" target="n" data-glyph="72,1" class="i method">Dispose</a>(<b>bool</b> <span id="r212 rd" class="r212 r">disposing</span>)
        {
            <b>if</b> (<span class="r212 r">disposing</span>)
            {
                <b>lock</b> (<a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>)
                {
                    <b>if</b> (<a href="#cb5997755e2f04af" class="i field">_timer</a> != <b>null</b>)
                    {
                        <a href="#cb5997755e2f04af" class="i field">_timer</a>.<span class="i">Dispose</span>();
                    }
 
                    <b>foreach</b> (<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r213 rd" class="r213 r">currentSubscriber</span> <b>in</b> <a href="#3652ea132f6b17e4" class="i field">_eventSubscribers</a>.<span class="i">Keys</span>.<span class="i">ToArray</span>())
                    {
                        <a href="#0525d136fda1bef4" class="i method">UnsubscribeEvent</a>(<span class="r213 r">currentSubscriber</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finalizes an instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#88db4bace82161f0" class="t t">PSLocalEventManager</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        ~<a id="94c7a6bf97ef26a8" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t method">PSLocalEventManager</a>()
        {
            <a href="#3bcc3be652d4bc42" class="i method">Dispose</a>(<b>false</b>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation of PSEventManager for remote runspaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="027edd8f06b1bbd1" href="../R/027edd8f06b1bbd1.html" target="n" data-glyph="2,0" class="t t">PSRemoteEventManager</a> : <a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Computer on which the event was generated</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly string</b> <a id="c4dc8478182f5161" href="../R/c4dc8478182f5161.html" target="n" data-glyph="46,1" class="i field">_computerName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Runspace on which the event was generated</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Guid</span> <a id="e342230751e45a94" href="../R/e342230751e45a94.html" target="n" data-glyph="46,1" class="i field">_runspaceId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an event manager for the given runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer on which the event was generated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace on which the event was generated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="d82a84754b379863" href="../R/d82a84754b379863.html" target="n" data-glyph="74,1" class="t constructor">PSRemoteEventManager</a>(<b>string</b> <span id="r214 rd" class="r214 r">computerName</span>, <span class="i">Guid</span> <span id="r215 rd" class="r215 r">runspaceId</span>)
        {
            <a href="#c4dc8478182f5161" class="i field">_computerName</a> = <span class="r214 r">computerName</span>;
            <a href="#e342230751e45a94" class="i field">_runspaceId</a> = <span class="r215 r">runspaceId</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the list of event subscribers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="1b56c5352a6ecd44" href="../R/1b56c5352a6ecd44.html" target="n" data-glyph="102,1" class="i property">Subscribers</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PowerShell event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any event-specific data associated with the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="2958b75091667d37" href="../R/2958b75091667d37.html" target="n" data-glyph="75,1" class="i method">CreateEvent</a>(<b>string</b> <span id="r216 rd" class="r216 r">sourceIdentifier</span>, <b>object</b> <span id="r217 rd" class="r217 r">sender</span>, <b>object</b>[] <span id="r218 rd" class="r218 r">args</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r219 rd" class="r219 r">extraData</span>)
        {
            <span class="c">// note that this is a local call, so we use null for the computer name</span>
            <b>return</b> <b>new</b> <a href="#a900b59b9b50722a" class="t constructor">PSEventArgs</a>(<b>null</b>, <a href="#e342230751e45a94" class="i field">_runspaceId</a>, <a href="#371a25d6143c3770" class="i method">GetNextEventId</a>(), <span class="r216 r">sourceIdentifier</span>, <span class="r217 r">sender</span>, <span class="r218 r">args</span>, <span class="r219 r">extraData</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a forwarded event to the current event manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="58de5d4482103840" href="../R/58de5d4482103840.html" target="n" data-glyph="74,1" class="i method">AddForwardedEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r220 rd" class="r220 r">forwardedEvent</span>)
        {
            <span class="r220 r">forwardedEvent</span>.<a href="#192b62cb04cdc1cb" class="i property">EventIdentifier</a> = <a href="#371a25d6143c3770" class="i method">GetNextEventId</a>();
            <span class="r220 r">forwardedEvent</span>.<a href="#d46e9434510d399e" class="i property">ForwardEvent</a> = <b>false</b>;
 
            <span class="c">// The computer name will be null the first time the event is forwarded; in this case we need to override with the</span>
            <span class="c">// remote computer this event manager is associated to. If the event has travelled multiple hops then we do not</span>
            <span class="c">// want to override this value since we want to preserve the original computer.</span>
            <b>if</b> (<span class="r220 r">forwardedEvent</span>.<a href="#2e9010bc7ef36273" class="i property">ComputerName</a> == <b>null</b> || <span class="r220 r">forwardedEvent</span>.<a href="#2e9010bc7ef36273" class="i property">ComputerName</a>.<span class="i">Length</span> == 0)
            {
                <span class="r220 r">forwardedEvent</span>.<a href="#2e9010bc7ef36273" class="i property">ComputerName</a> = <a href="#c4dc8478182f5161" class="i field">_computerName</a>;
                <span class="r220 r">forwardedEvent</span>.<a href="#796c1be2287edf21" class="i property">RunspaceId</a> = <a href="#e342230751e45a94" class="i field">_runspaceId</a>;
            }
 
            <a href="#7558776bbfaad043" class="i method">ProcessNewEvent</a>(<span class="r220 r">forwardedEvent</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="7558776bbfaad043" href="../R/7558776bbfaad043.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r221 rd" class="r221 r">newEvent</span>, <b>bool</b> <span id="r222 rd" class="r222 r">processInCurrentThread</span>)
        {
            <a href="#231224a1ceaef863" class="i method">ProcessNewEvent</a>(<span class="r221 r">newEvent</span>, <span class="r222 r">processInCurrentThread</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Processes new events (which have either been generated by this instance or forwarded to it)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected internal override void</b> <a id="231224a1ceaef863" href="../R/231224a1ceaef863.html" target="n" data-glyph="75,1" class="i method">ProcessNewEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r223 rd" class="r223 r">newEvent</span>,
            <b>bool</b> <span id="r224 rd" class="r224 r">processInCurrentThread</span>, <b>bool</b> <span id="r225 rd" class="r225 r">waitForCompletionInCurrentThread</span>)
        {
            <b>lock</b> (<a href="#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="#80f9d007b76c3b3b" class="i property">SyncRoot</a>)
            {
                <b>if</b> (<span class="r223 r">newEvent</span>.<a href="#d46e9434510d399e" class="i property">ForwardEvent</a>)
                {
                    <a href="#f7525b28ae295168" class="i method">OnForwardEvent</a>(<span class="r223 r">newEvent</span>);
                }
                <b>else</b>
                {
                    <a href="#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="#44c940e5e9270cc4" class="i method">Add</a>(<span class="r223 r">newEvent</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the event subscription that corresponds to an identifier</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The identifier that identifies the source of the events</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">IEnumerable</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt; <a id="2670ebdd5ca6aa76" href="../R/2670ebdd5ca6aa76.html" target="n" data-glyph="72,1" class="i method">GetEventSubscribers</a>(<b>string</b> <span id="r226 rd" class="r226 r">sourceIdentifier</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r232 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r233 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="f8c9fca651d7c89c" href="../R/f8c9fca651d7c89c.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r227 rd" class="r227 r">source</span>, <b>string</b> <span id="r228 rd" class="r228 r">eventName</span>, <b>string</b> <span id="r229 rd" class="r229 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r230 rd" class="r230 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r231 rd" class="r231 r">action</span>, <b>bool</b> <span id="r232 rd" class="r232 r">supportEvent</span>, <b>bool</b> <span id="r233 rd" class="r233 r">forwardEvent</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r235 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r236 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r237 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r238 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r239 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r241 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="38f95ef8bf7baa3b" href="../R/38f95ef8bf7baa3b.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r234 rd" class="r234 r">source</span>, <b>string</b> <span id="r235 rd" class="r235 r">eventName</span>, <b>string</b> <span id="r236 rd" class="r236 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r237 rd" class="r237 r">data</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r238 rd" class="r238 r">action</span>, <b>bool</b> <span id="r239 rd" class="r239 r">supportEvent</span>, <b>bool</b> <span id="r240 rd" class="r240 r">forwardEvent</span>, <b>int</b> <span id="r241 rd" class="r241 r">maxTriggerCount</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r245 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r246 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r247 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="d4d958d1a7e47cf1" href="../R/d4d958d1a7e47cf1.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r242 rd" class="r242 r">source</span>, <b>string</b> <span id="r243 rd" class="r243 r">eventName</span>, <b>string</b> <span id="r244 rd" class="r244 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r245 rd" class="r245 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r246 rd" class="r246 r">handlerDelegate</span>, <b>bool</b> <span id="r247 rd" class="r247 r">supportEvent</span>, <b>bool</b> <span id="r248 rd" class="r248 r">forwardEvent</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribes to an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r249 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source object that defines the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r250 r">eventName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event to subscribe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier to help identify this event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r252 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">handlerDelegate</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r254 r">supportEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any action to be invoked when the event arrives</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r255 r">forwardEvent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether events in this subscriber should be forwarded to the client PowerShell during remote executions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r256 r">maxTriggerCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many times the subscriber should be triggered before auto-unregister it</span>
        <span class="c">///</span><span class="c"> If the value is equal or less than zero, there is no limit on the number of times the event can be triggered without being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2208:InstantiateArgumentExceptionsCorrectly&quot;</span>)]
        <b>public override</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="6c4b57a8da0b738d" href="../R/6c4b57a8da0b738d.html" target="n" data-glyph="72,1" class="i method">SubscribeEvent</a>(<b>object</b> <span id="r249 rd" class="r249 r">source</span>, <b>string</b> <span id="r250 rd" class="r250 r">eventName</span>, <b>string</b> <span id="r251 rd" class="r251 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r252 rd" class="r252 r">data</span>, <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r253 rd" class="r253 r">handlerDelegate</span>, <b>bool</b> <span id="r254 rd" class="r254 r">supportEvent</span>, <b>bool</b> <span id="r255 rd" class="r255 r">forwardEvent</span>, <b>int</b> <span id="r256 rd" class="r256 r">maxTriggerCount</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unsubscribes from an event on an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r257 r">subscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber associated with the event subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="9e05cf2a21d68a84" href="../R/9e05cf2a21d68a84.html" target="n" data-glyph="72,1" class="i method">UnsubscribeEvent</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r257 rd" class="r257 r">subscriber</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="i">EventingResources</span>.<span class="i">RemoteOperationNotSupported</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event is raised by the event manager to forward events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="3fb3c9f7dd81cf43" href="../R/3fb3c9f7dd81cf43.html" target="n" data-glyph="32,1" class="i">ForwardEvent</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the ForwardEvent event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="f7525b28ae295168" href="../R/f7525b28ae295168.html" target="n" data-glyph="75,1" class="i method">OnForwardEvent</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r258 rd" class="r258 r">e</span>)
        {
            <a href="#3fb3c9f7dd81cf43" class="i">ForwardEvent</a>?.<span class="i">Invoke</span>(<a href="#027edd8f06b1bbd1" class="k">this</a>, <span class="r258 r">e</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Constants that represent PowerShell engine events.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">// Note: If you generate a new engine event that happens frequently,</span>
    <span class="c">// (i.e.: variable changes), the user should be required to enable</span>
    <span class="c">// that engine event before they make it into the ReceivedEvents channel.</span>
    <b>public sealed class</b> <a id="db3a5a65f2783a2f" href="../R/db3a5a65f2783a2f.html" target="n" data-glyph="0,0" class="t t">PSEngineEvent</a>
    {
        <b>private</b> <a id="83c74c76787e1ef9" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">PSEngineEvent</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called when the PowerShell engine is exiting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="554cb1de90b6a291" href="../R/554cb1de90b6a291.html" target="n" data-glyph="6,1" class="i field">Exiting</a> = <span class="s">&quot;PowerShell.Exiting&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call when the PowerShell engine is idle.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="81d0b6a36f67dda2" href="../R/81d0b6a36f67dda2.html" target="n" data-glyph="6,1" class="i field">OnIdle</a> = <span class="s">&quot;PowerShell.OnIdle&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called during scriptblock invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="2c9498226a18a30d" href="../R/2c9498226a18a30d.html" target="n" data-glyph="8,1" class="i field">OnScriptBlockInvoke</a> = <span class="s">&quot;PowerShell.OnScriptBlockInvoke&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called during scriptblock invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="18066019f306f7d1" href="../R/18066019f306f7d1.html" target="n" data-glyph="8,1" class="i field">GetCommandInfoParameterMetadata</a> = <span class="s">&quot;PowerShell.GetCommandInfoParameterMetadata&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A HashSet that contains all engine event names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="6788ebc57df8c769" href="../R/6788ebc57df8c769.html" target="n" data-glyph="44,1" class="i field">EngineEvents</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <a href="#554cb1de90b6a291" class="i field">Exiting</a>, <a href="#81d0b6a36f67dda2" class="i field">OnIdle</a>, <a href="#2c9498226a18a30d" class="i field">OnScriptBlockInvoke</a> };
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents a subscriber to an event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b185773a8f107fac" href="../R/b185773a8f107fac.html" target="n" data-glyph="0,0" class="t t">PSEventSubscriber</a> : <span class="i">IEquatable</span>&lt;<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a>&gt;
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the PSEventSubscriber class for a given source object, event name,</span>
        <span class="c">///</span><span class="c"> and optional source identifier.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e804f2fa1f84db45" href="../R/e804f2fa1f84db45.html" target="n" data-glyph="74,1" class="t constructor">PSEventSubscriber</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r259 rd" class="r259 r">context</span>, <b>int</b> <span id="r260 rd" class="r260 r">id</span>, <b>object</b> <span id="r261 rd" class="r261 r">source</span>,
            <b>string</b> <span id="r262 rd" class="r262 r">eventName</span>, <b>string</b> <span id="r263 rd" class="r263 r">sourceIdentifier</span>, <b>bool</b> <span id="r264 rd" class="r264 r">supportEvent</span>, <b>bool</b> <span id="r265 rd" class="r265 r">forwardEvent</span>, <b>int</b> <span id="r266 rd" class="r266 r">maxTriggerCount</span>)
        {
            <a href="#b598d6b716122f19" class="i field">_context</a> = <span class="r259 r">context</span>;
 
            <a href="#770de4e9f80ddcbe" class="i property">SubscriptionId</a> = <span class="r260 r">id</span>;
            <a href="#bb7132b55040cd4a" class="i property">SourceObject</a> = <span class="r261 r">source</span>;
            <a href="#a13e01df2132579b" class="i property">EventName</a> = <span class="r262 r">eventName</span>;
            <a href="#7bf97d4ae540b725" class="i property">SourceIdentifier</a> = <span class="r263 r">sourceIdentifier</span>;
            <a href="#c63335cdce38dea2" class="i property">SupportEvent</a> = <span class="r264 r">supportEvent</span>;
            <a href="#46a5c6b166a1bd0a" class="i property">ForwardEvent</a> = <span class="r265 r">forwardEvent</span>;
 
            <a href="#303562df58eea458" class="i property">IsBeingUnsubscribed</a> = <b>false</b>;
            <a href="#2e4be03967a57fa5" class="i property">RemainingActionsToProcess</a> = 0;
 
            <b>if</b> (<span class="r266 r">maxTriggerCount</span> &lt;= 0)
            {
                <a href="#7d272be0b7dce73d" class="i property">AutoUnregister</a> = <b>false</b>;
                <a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> = -1;
            }
            <b>else</b>
            {
                <a href="#7d272be0b7dce73d" class="i property">AutoUnregister</a> = <b>true</b>;
                <a href="#548b95f6a487dff2" class="i property">RemainingTriggerCount</a> = <span class="r266 r">maxTriggerCount</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the PSEventSubscriber</span>
        <span class="c">///</span><span class="c"> class. Additionally supports an Action scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="235a2836b4a4c061" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PSEventSubscriber</a>(
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r267 rd" class="r267 r">context</span>,
            <b>int</b> <span id="r268 rd" class="r268 r">id</span>,
            <b>object</b> <span id="r269 rd" class="r269 r">source</span>,
            <b>string</b> <span id="r270 rd" class="r270 r">eventName</span>,
            <b>string</b> <span id="r271 rd" class="r271 r">sourceIdentifier</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r272 rd" class="r272 r">action</span>,
            <b>bool</b> <span id="r273 rd" class="r273 r">supportEvent</span>,
            <b>bool</b> <span id="r274 rd" class="r274 r">forwardEvent</span>,
            <b>int</b> <span id="r275 rd" class="r275 r">maxTriggerCount</span>)
            : <a href="#e804f2fa1f84db45" class="k">this</a>(<span class="r267 r">context</span>, <span class="r268 r">id</span>, <span class="r269 r">source</span>, <span class="r270 r">eventName</span>, <span class="r271 r">sourceIdentifier</span>, <span class="r273 r">supportEvent</span>, <span class="r274 r">forwardEvent</span>, <span class="r275 r">maxTriggerCount</span>)
        {
            <span class="c">// Create the bound scriptblock, and job.</span>
            <b>if</b> (<span class="r272 r">action</span> != <b>null</b>)
            {
                <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r276 rd" class="r276 r">newAction</span> = <a href="#8edb895ee2175c91" class="i method">CreateBoundScriptBlock</a>(<span class="r272 r">action</span>);
                <a href="#b778cab7e2ee6ca6" class="i property">Action</a> = <b>new</b> <a href="#aefd958a05f563b6" class="t constructor">PSEventJob</a>(<span class="r267 r">context</span>.<a href="ExecutionContext.cs.html#67642aa960214ec5" class="i property">Events</a>, <a href="#b185773a8f107fac" class="k">this</a>, <span class="r276 r">newAction</span>, <span class="r271 r">sourceIdentifier</span>);
            }
        }
 
        <b>internal void</b> <a id="e172ff2abcbe0041" href="../R/e172ff2abcbe0041.html" target="n" data-glyph="74,1" class="i method">RegisterJob</a>()
        {
            <span class="c">// Add this event subscriber to the job repository if it&#39;s not a support event.</span>
            <b>if</b> (!<a href="#c63335cdce38dea2" class="i property">SupportEvent</a>)
            {
                <b>if</b> (<a href="#b185773a8f107fac" class="k">this</a>.<a href="#b778cab7e2ee6ca6" class="i property">Action</a> != <b>null</b>)
                {
                    <a href="remoting/commands/JobRepository.cs.html#9e5cfbf2cf1e98f1" class="t t">JobRepository</a> <span id="r277 rd" class="r277 r">jobRepository</span> = ((<a href="../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="#b598d6b716122f19" class="i field">_context</a>.<a href="ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="hostifaces/LocalConnection.cs.html#a651816082848dc6" class="i property">JobRepository</a>;
                    <span class="r277 r">jobRepository</span>.<a href="remoting/commands/JobRepository.cs.html#d6dba21c2b5f0712" class="i method">Add</a>(<a href="#b778cab7e2ee6ca6" class="i property">Action</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the PSEventSubscriber</span>
        <span class="c">///</span><span class="c"> class. Additionally supports an Action scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ddb7183cd250bb22" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PSEventSubscriber</a>(
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r278 rd" class="r278 r">context</span>,
            <b>int</b> <span id="r279 rd" class="r279 r">id</span>,
            <b>object</b> <span id="r280 rd" class="r280 r">source</span>,
            <b>string</b> <span id="r281 rd" class="r281 r">eventName</span>,
            <b>string</b> <span id="r282 rd" class="r282 r">sourceIdentifier</span>,
            <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <span id="r283 rd" class="r283 r">handlerDelegate</span>,
            <b>bool</b> <span id="r284 rd" class="r284 r">supportEvent</span>,
            <b>bool</b> <span id="r285 rd" class="r285 r">forwardEvent</span>,
            <b>int</b> <span id="r286 rd" class="r286 r">maxTriggerCount</span>)
            : <a href="#e804f2fa1f84db45" class="k">this</a>(<span class="r278 r">context</span>, <span class="r279 r">id</span>, <span class="r280 r">source</span>, <span class="r281 r">eventName</span>, <span class="r282 r">sourceIdentifier</span>, <span class="r284 r">supportEvent</span>, <span class="r285 r">forwardEvent</span>, <span class="r286 r">maxTriggerCount</span>)
        {
            <a href="#111574d1f8f48930" class="i property">HandlerDelegate</a> = <span class="r283 r">handlerDelegate</span>;
        }
 
        <b>private readonly</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="b598d6b716122f19" href="../R/b598d6b716122f19.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a bound script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="8edb895ee2175c91" href="../R/8edb895ee2175c91.html" target="n" data-glyph="76,1" class="i method">CreateBoundScriptBlock</a>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r287 rd" class="r287 r">scriptAction</span>)
        {
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r288 rd" class="r288 r">newAction</span> = <a href="#b598d6b716122f19" class="i field">_context</a>.<a href="ExecutionContext.cs.html#2d3edf63c7afa4b2" class="i property">Modules</a>.<a href="Modules/ModuleIntrinsics.cs.html#f12a42e3f8d60d63" class="i method">CreateBoundScriptBlock</a>(<a href="#b598d6b716122f19" class="i field">_context</a>, <span class="r287 r">scriptAction</span>, <b>true</b>);
 
            <span class="c">// Create a new Error variable so that it doesn&#39;t pollute the global errors.</span>
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r289 rd" class="r289 r">errorVariable</span> = <b>new</b> <span class="t">PSVariable</span>(<span class="s">&quot;script:Error&quot;</span>, <b>new</b> <span class="i">ArrayList</span>(), <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r290 rd" class="r290 r">sessionState</span> = <span class="r288 r">newAction</span>.<a href="lang/scriptblock.cs.html#d25a345294fd74f0" class="i property">SessionStateInternal</a>;
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r291 rd" class="r291 r">scriptScope</span> = <span class="r290 r">sessionState</span>.<a href="SessionStateScopeAPIs.cs.html#92e44fea6672dfdf" class="i method">GetScopeByID</a>(<span class="s">&quot;script&quot;</span>);
            <span class="r291 r">scriptScope</span>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r289 r">errorVariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r289 r">errorVariable</span>, <b>false</b>, <b>true</b>, <span class="r290 r">sessionState</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
 
            <b>return</b> <span class="r288 r">newAction</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the identifier of this event subscription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="770de4e9f80ddcbe" href="../R/770de4e9f80ddcbe.html" target="n" data-glyph="102,1" class="i property">SubscriptionId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to which this event subscription applies.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="bb7132b55040cd4a" href="../R/bb7132b55040cd4a.html" target="n" data-glyph="102,1" class="i property">SourceObject</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event object to which this event subscription applies.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a13e01df2132579b" href="../R/a13e01df2132579b.html" target="n" data-glyph="102,1" class="i property">EventName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The identifier that identifies the source of these events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="7bf97d4ae540b725" href="../R/7bf97d4ae540b725.html" target="n" data-glyph="102,1" class="i property">SourceIdentifier</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The action invoked when this event arrives.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#ce0fcd992a2c4958" class="t t">PSEventJob</a> <a id="b778cab7e2ee6ca6" href="../R/b778cab7e2ee6ca6.html" target="n" data-glyph="102,1" class="i property">Action</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The delegate invoked when this event arrives.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <a id="111574d1f8f48930" href="../R/111574d1f8f48930.html" target="n" data-glyph="102,1" class="i property">HandlerDelegate</a> { <b>get</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the flag that marks this event as a supporting event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c63335cdce38dea2" href="../R/c63335cdce38dea2.html" target="n" data-glyph="102,1" class="i property">SupportEvent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets whether to forward the event to the PowerShell client during a remote execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="46a5c6b166a1bd0a" href="../R/46a5c6b166a1bd0a.html" target="n" data-glyph="102,1" class="i property">ForwardEvent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets whether the event should be processed in the pipeline execution thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0b6d70951efe328d" href="../R/0b6d70951efe328d.html" target="n" data-glyph="104,1" class="i property">ShouldProcessInExecutionThread</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets whether the event should be unregistered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="7d272be0b7dce73d" href="../R/7d272be0b7dce73d.html" target="n" data-glyph="104,1" class="i property">AutoUnregister</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many new should be added to the action queue.</span>
        <span class="c">///</span><span class="c"> e.g. NumberOfTimesToBeInvoked = 3 means that this subscriber only responses to</span>
        <span class="c">///</span><span class="c"> the first triggered event. So three new actions will be added to the action</span>
        <span class="c">///</span><span class="c"> queue, and the following events will be ignored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="548b95f6a487dff2" href="../R/548b95f6a487dff2.html" target="n" data-glyph="104,1" class="i property">RemainingTriggerCount</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate how many actions from this subscriber should be processed.</span>
        <span class="c">///</span><span class="c"> The method &quot;ProcessPendingAction&quot; will unsubscribe this subscriber</span>
        <span class="c">///</span><span class="c"> if it&#39;s marked as auto-unregister and this property becomes 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="2e4be03967a57fa5" href="../R/2e4be03967a57fa5.html" target="n" data-glyph="104,1" class="i property">RemainingActionsToProcess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if the subscriber is being subscribed by a thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="303562df58eea458" href="../R/303562df58eea458.html" target="n" data-glyph="104,1" class="i property">IsBeingUnsubscribed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event generated when this event subscriber is unregistered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <a href="#3e2c17f1213f1718" class="t t">PSEventUnsubscribedEventHandler</a> <a id="274cfb1d88334bb0" href="../R/274cfb1d88334bb0.html" target="n" data-glyph="30,1" class="i">Unsubscribed</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IComparable&lt;PSEventSubscriber&gt; Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether the specified object is equal to the current object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r292 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object to compare with the current object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if the specified object is equal to the current object;</span>
        <span class="c">///</span><span class="c"> otherwise, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="20b2d63011028891" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r292 rd" class="r292 r">obj</span>)
        {
            <b>return</b> <span class="r292 r">obj</span> <b>is</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r293 rd" class="r293 r">es</span> &amp;&amp; <a href="#5e827df249759771" class="i method">Equals</a>(<span class="r293 r">es</span>);
        }
        
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if two PSEventSubscriber instances are equal</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r294 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSEventSubscriber to which to compare this instance</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="5e827df249759771" href="../R/5e827df249759771.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r294 rd" class="r294 r">other</span>)
        {
            <b>if</b> (<span class="r294 r">other</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> (<b>string</b>.<span class="i">Equals</span>(<a href="#770de4e9f80ddcbe" class="i property">SubscriptionId</a>, <span class="r294 r">other</span>.<a href="#770de4e9f80ddcbe" class="i property">SubscriptionId</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the hashcode that represents this PSEventSubscriber instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override int</b> <a id="aa95c3849812a36a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <a href="#770de4e9f80ddcbe" class="i property">SubscriptionId</a>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal void</b> <a id="ec59926632364fa6" href="../R/ec59926632364fa6.html" target="n" data-glyph="74,1" class="i method">OnPSEventUnsubscribed</a>(<b>object</b> <span id="r295 rd" class="r295 r">sender</span>, <a href="#92ae53c4f85ad828" class="t t">PSEventUnsubscribedEventArgs</a> <span id="r296 rd" class="r296 r">e</span>)
        {
            <a href="#274cfb1d88334bb0" class="i">Unsubscribed</a>?.<a href="#e5b74b5d580f86d2" class="i method">Invoke</a>(<span class="r295 r">sender</span>, <span class="r296 r">e</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The generic event handler from which specific event handlers extend. When possible,</span>
    <span class="c">///</span><span class="c"> add functionality to this class instead of the IL generated by the GenerateEventHandler()</span>
    <span class="c">///</span><span class="c"> method.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1711:IdentifiersShouldNotHaveIncorrectSuffix&quot;</span>)]
    <b>public class</b> <a id="ec3826338c9ee839" href="../R/ec3826338c9ee839.html" target="n" data-glyph="0,0" class="t t">PSEventHandler</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the PsEventHandler class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="6b564f29eb6df6ea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSEventHandler</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the PsEventHandler class for a given</span>
        <span class="c">///</span><span class="c"> event manager, source identifier, and extra data</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r297 r">eventManager</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event manager to which we forward events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r298 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r299 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional subscription identifier that identifies the</span>
        <span class="c">///</span><span class="c"> source of the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r300 r">extraData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="9b52bede0dc74e0f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSEventHandler</a>(<a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a> <span id="r297 rd" class="r297 r">eventManager</span>, <b>object</b> <span id="r298 rd" class="r298 r">sender</span>, <b>string</b> <span id="r299 rd" class="r299 r">sourceIdentifier</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r300 rd" class="r300 r">extraData</span>)
        {
            <a href="#ec3826338c9ee839" class="k">this</a>.<a href="#8009c7af8e45fde9" class="i field">eventManager</a> = <span class="r297 r">eventManager</span>;
            <a href="#ec3826338c9ee839" class="k">this</a>.<a href="#65926a7cf3952d98" class="i field">sender</a> = <span class="r298 r">sender</span>;
            <a href="#ec3826338c9ee839" class="k">this</a>.<a href="#e6f7c67f3748fc0a" class="i field">sourceIdentifier</a> = <span class="r299 r">sourceIdentifier</span>;
            <a href="#ec3826338c9ee839" class="k">this</a>.<a href="#eb2b731798dcb6f9" class="i field">extraData</a> = <span class="r300 r">extraData</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event manager to which we forward events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1051:DoNotDeclareVisibleInstanceFields&quot;</span>)]
        <b>protected</b> <a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="8009c7af8e45fde9" href="../R/8009c7af8e45fde9.html" target="n" data-glyph="45,1" class="i field">eventManager</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The sender of the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1051:DoNotDeclareVisibleInstanceFields&quot;</span>)]
        <b>protected object</b> <a id="65926a7cf3952d98" href="../R/65926a7cf3952d98.html" target="n" data-glyph="45,1" class="i field">sender</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An optional identifier that identifies the source of the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1051:DoNotDeclareVisibleInstanceFields&quot;</span>)]
        <b>protected string</b> <a id="e6f7c67f3748fc0a" href="../R/e6f7c67f3748fc0a.html" target="n" data-glyph="45,1" class="i field">sourceIdentifier</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any additional data you wish to attach to the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1051:DoNotDeclareVisibleInstanceFields&quot;</span>)]
        <b>protected</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="eb2b731798dcb6f9" href="../R/eb2b731798dcb6f9.html" target="n" data-glyph="45,1" class="i field">extraData</a> = <b>null</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event argument associated with the event fired in a remote runspace and forwarded to the current runspace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="41267d30cbe6e005" href="../R/41267d30cbe6e005.html" target="n" data-glyph="0,0" class="t t">ForwardedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <b>internal</b> <a id="473bed1dcb915905" href="../R/473bed1dcb915905.html" target="n" data-glyph="74,1" class="t constructor">ForwardedEventArgs</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r301 rd" class="r301 r">serializedRemoteEventArgs</span>)
        {
            <a href="#f6fcd7c94b277b1b" class="i property">SerializedRemoteEventArgs</a> = <span class="r301 r">serializedRemoteEventArgs</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialized event arguments from the event fired in a remote runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="f6fcd7c94b277b1b" href="../R/f6fcd7c94b277b1b.html" target="n" data-glyph="102,1" class="i property">SerializedRemoteEventArgs</a> { <b>get</b>; }
 
        <b>internal static bool</b> <a id="d450dde690c53a72" href="../R/d450dde690c53a72.html" target="n" data-glyph="74,1" class="i method">IsRemoteSourceEventArgs</a>(<b>object</b> <span id="r302 rd" class="r302 r">argument</span>)
        {
            <b>return</b> <a href="serialization.cs.html#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r302 r">argument</span>, <b>typeof</b>(<span class="i">EventArgs</span>));
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> PowerShell event arguments</span>
    <span class="c">///</span><span class="c"> This class provides a generic wrapper for event arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">event argument type</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="03e55926b6f7cfe0" href="../R/03e55926b6f7cfe0.html" target="n" data-glyph="2,0" class="t t">PSEventArgs</a>&lt;<span id="r303 rd t" class="r303 r t">T</span>&gt; : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="r303 r t">T</span> <a id="cdbb095803b6c0a4" href="../R/cdbb095803b6c0a4.html" target="n" data-glyph="44,1" class="i field">Args</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="93364b791da264c9" href="../R/93364b791da264c9.html" target="n" data-glyph="72,1" class="t constructor">PSEventArgs</a>(<span class="r303 r t">T</span> <span id="r304 rd" class="r304 r">args</span>)
        {
            <a href="#cdbb095803b6c0a4" class="i field">Args</a> = <span class="r304 r">args</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The event arguments associated with an event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="7210411b2f4a8407" href="../R/7210411b2f4a8407.html" target="n" data-glyph="0,0" class="t t">PSEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new instance of the PSEventArgs type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r305 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer on which this event was generated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r306 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace on which this event was generated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r307 r">eventIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The unique identifier of the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">sourceIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The source of the event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">originalArgs</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments associated with the handler of the original event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r311 r">additionalData</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Additional data attached by the user to this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a900b59b9b50722a" href="../R/a900b59b9b50722a.html" target="n" data-glyph="74,1" class="t constructor">PSEventArgs</a>(<b>string</b> <span id="r305 rd" class="r305 r">computerName</span>, <span class="i">Guid</span> <span id="r306 rd" class="r306 r">runspaceId</span>, <b>int</b> <span id="r307 rd" class="r307 r">eventIdentifier</span>, <b>string</b> <span id="r308 rd" class="r308 r">sourceIdentifier</span>, <b>object</b> <span id="r309 rd" class="r309 r">sender</span>, <b>object</b>[] <span id="r310 rd" class="r310 r">originalArgs</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r311 rd" class="r311 r">additionalData</span>)
        {
            <span class="c">// Capture the first EventArgs as SourceEventArgs</span>
            <b>if</b> (<span class="r310 r">originalArgs</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r312 rd" class="r312 r">argument</span> <b>in</b> <span class="r310 r">originalArgs</span>)
                {
                    <span class="i">EventArgs</span> <span id="r313 rd" class="r313 r">sourceEventArgs</span> = <span class="r312 r">argument</span> <b>as</b> <span class="i">EventArgs</span>;
                    <b>if</b> (<span class="r313 r">sourceEventArgs</span> != <b>null</b>)
                    {
                        <a href="#d0726de6cebf6169" class="i property">SourceEventArgs</a> = <span class="r313 r">sourceEventArgs</span>;
                        <b>break</b>;
                    }
 
                    <b>if</b> (<a href="#41267d30cbe6e005" class="t t">ForwardedEventArgs</a>.<a href="#d450dde690c53a72" class="i method">IsRemoteSourceEventArgs</a>(<span class="r312 r">argument</span>))
                    {
                        <a href="#d0726de6cebf6169" class="i property">SourceEventArgs</a> = <b>new</b> <a href="#473bed1dcb915905" class="t constructor">ForwardedEventArgs</a>((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r312 r">argument</span>);
                        <b>break</b>;
                    }
                }
            }
 
            <a href="#2e9010bc7ef36273" class="i property">ComputerName</a> = <span class="r305 r">computerName</span>;
            <a href="#796c1be2287edf21" class="i property">RunspaceId</a> = <span class="r306 r">runspaceId</span>;
            <a href="#192b62cb04cdc1cb" class="i property">EventIdentifier</a> = <span class="r307 r">eventIdentifier</span>;
            <a href="#1b4e059cf3c8cdad" class="i property">Sender</a> = <span class="r309 r">sender</span>;
            <a href="#f366c1fd1503a327" class="i property">SourceArgs</a> = <span class="r310 r">originalArgs</span>;
            <a href="#d8b1da7bcf77174b" class="i property">SourceIdentifier</a> = <span class="r308 r">sourceIdentifier</span>;
            <a href="#b07e8d2c1ab99698" class="i property">TimeGenerated</a> = <span class="i">DateTime</span>.<span class="i">Now</span>;
            <a href="#341469e4b16d1b02" class="i property">MessageData</a> = <span class="r311 r">additionalData</span>;
            <a href="#d46e9434510d399e" class="i property">ForwardEvent</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the name of the computer on which this event was generated; the value of this property is null for events generated on the local machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="2e9010bc7ef36273" href="../R/2e9010bc7ef36273.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the unique identifier of this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>public</b> <span class="i">Guid</span> <a id="796c1be2287edf21" href="../R/796c1be2287edf21.html" target="n" data-glyph="102,1" class="i property">RunspaceId</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the unique identifier of this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="192b62cb04cdc1cb" href="../R/192b62cb04cdc1cb.html" target="n" data-glyph="102,1" class="i property">EventIdentifier</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the object that generated this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="1b4e059cf3c8cdad" href="../R/1b4e059cf3c8cdad.html" target="n" data-glyph="102,1" class="i property">Sender</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the first argument from the original event source that</span>
        <span class="c">///</span><span class="c"> derives from EventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">EventArgs</span> <a id="d0726de6cebf6169" href="../R/d0726de6cebf6169.html" target="n" data-glyph="102,1" class="i property">SourceEventArgs</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the list of arguments captured by the original event source.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="f366c1fd1503a327" href="../R/f366c1fd1503a327.html" target="n" data-glyph="102,1" class="i property">SourceArgs</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the identifier associated with the source of this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d8b1da7bcf77174b" href="../R/d8b1da7bcf77174b.html" target="n" data-glyph="102,1" class="i property">SourceIdentifier</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the time and date that this event was generated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span> <a id="b07e8d2c1ab99698" href="../R/b07e8d2c1ab99698.html" target="n" data-glyph="102,1" class="i property">TimeGenerated</a>
        {
            <span class="c">// internal setter using during deserialization</span>
            <b>get</b>; <b>internal set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the additional user data associated with this event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="341469e4b16d1b02" href="../R/341469e4b16d1b02.html" target="n" data-glyph="102,1" class="i property">MessageData</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets whether to forward the event to the PowerShell client during a remote execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="d46e9434510d399e" href="../R/d46e9434510d399e.html" target="n" data-glyph="104,1" class="i property">ForwardEvent</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When processing synchronous events, this mutex is set so we know when we can safely return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">ManualResetEventSlim</span> <a id="110ebc38c61b5113" href="../R/110ebc38c61b5113.html" target="n" data-glyph="104,1" class="i property">EventProcessed</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The delegate that handles notifications of new events</span>
    <span class="c">///</span><span class="c"> added to the collection.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public delegate void</b> <a id="65fa65b34e81c0ee" href="../R/65fa65b34e81c0ee.html" target="n" data-glyph="12,0" class="t t"><span id="c1dd7581dd30606f">PSEventReceivedEventHandler</span></a>(<b>object</b> <span id="r314 rd" class="r314 r">sender</span>, <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r315 rd" class="r315 r">e</span>);
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The event arguments associated with unsubscribing from an event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="92ae53c4f85ad828" href="../R/92ae53c4f85ad828.html" target="n" data-glyph="0,0" class="t t">PSEventUnsubscribedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new instance of the PSEventUnsubscribedEventArgs type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r316 r">eventSubscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event subscriber being unregistered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="d9400c2a9b6867c3" href="../R/d9400c2a9b6867c3.html" target="n" data-glyph="74,1" class="t constructor">PSEventUnsubscribedEventArgs</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r316 rd" class="r316 r">eventSubscriber</span>)
        {
            <a href="#3169b903bdda5124" class="i property">EventSubscriber</a> = <span class="r316 r">eventSubscriber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event subscriber being unregistered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="3169b903bdda5124" href="../R/3169b903bdda5124.html" target="n" data-glyph="102,1" class="i property">EventSubscriber</a> { <b>get</b>; <b>internal set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The delegate that handles notifications of the event being unsubscribed.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public delegate void</b> <a id="3e2c17f1213f1718" href="../R/3e2c17f1213f1718.html" target="n" data-glyph="12,0" class="t t"><span id="5715d9d007fb0843">PSEventUnsubscribedEventHandler</span></a>(<b>object</b> <span id="r317 rd" class="r317 r">sender</span>, <a href="#92ae53c4f85ad828" class="t t">PSEventUnsubscribedEventArgs</a> <span id="r318 rd" class="r318 r">e</span>);
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class contains the collection of events received by the</span>
    <span class="c">///</span><span class="c"> execution context.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="643f66f12c98fa1d" href="../R/643f66f12c98fa1d.html" target="n" data-glyph="0,0" class="t t"><span id="0348b5658f2267ca">PSEventArgsCollection</span></a> : <span class="i">IEnumerable</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt;
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event generated when a new event is received.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <a href="#65fa65b34e81c0ee" class="t t">PSEventReceivedEventHandler</a> <a id="bce564b5d84fdbcb" href="../R/bce564b5d84fdbcb.html" target="n" data-glyph="30,1" class="i">PSEventReceived</a>;
 
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="381cda5ff00b9f1a" href="../R/381cda5ff00b9f1a.html" target="n" data-glyph="46,1" class="i field">_eventCollection</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add add an event to the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">eventToAdd</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSEventArgs instance that represents this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Don&#39;t add events to the collection directly; use the EventManager instead</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="44c940e5e9270cc4" href="../R/44c940e5e9270cc4.html" target="n" data-glyph="74,1" class="i method">Add</a>(<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r319 rd" class="r319 r">eventToAdd</span>)
        {
            <b>if</b> (<span class="r319 r">eventToAdd</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r319 r">eventToAdd</span>));
            }
 
            <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>.<span class="i">Add</span>(<span class="r319 r">eventToAdd</span>);
 
            <a href="#f0144619f162f98b" class="i method">OnPSEventReceived</a>(<span class="r319 r">eventToAdd</span>.<a href="#1b4e059cf3c8cdad" class="i property">Sender</a>, <span class="r319 r">eventToAdd</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes an item at a specific index from the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="fc5cdb3db9034038" href="../R/fc5cdb3db9034038.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>.<span class="i">Count</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes an item at a specific index from the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0f863fbf0961d6bc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RemoveAt</a>(<b>int</b> <span id="r320 rd" class="r320 r">index</span>)
        {
            <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>.<span class="i">RemoveAt</span>(<span class="r320 r">index</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an item at a specific index from the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="44b7b2b416466d15" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="k">this</a>[<b>int</b> <span id="r321 rd" class="r321 r">index</span>]
        {
            <b>get</b>
            {
                <b>return</b> <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>[<span class="r321 r">index</span>];
            }
        }
 
        <b>private void</b> <a id="f0144619f162f98b" href="../R/f0144619f162f98b.html" target="n" data-glyph="76,1" class="i method">OnPSEventReceived</a>(<b>object</b> <span id="r322 rd" class="r322 r">sender</span>, <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r323 rd" class="r323 r">e</span>)
        {
            <a href="#bce564b5d84fdbcb" class="i">PSEventReceived</a>?.<a href="#6c9e60c0eaade9a7" class="i method">Invoke</a>(<span class="r322 r">sender</span>, <span class="r323 r">e</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the enumerator of this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerator</span>&lt;<a href="#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="3e4760b0d9f3eb55" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>.<span class="i">GetEnumerator</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the enumerator of this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerator</span> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerable</span>.<a id="6fe345f205c3c6a1" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#381cda5ff00b9f1a" class="i field">_eventCollection</a>.<span class="i">GetEnumerator</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the synchronization root for this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="80f9d007b76c3b3b" href="../R/80f9d007b76c3b3b.html" target="n" data-glyph="102,1" class="i property">SyncRoot</a> { <b>get</b>; } = <b>new</b> <b>object</b>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The combination of an event subscriber, and the event that was fired.</span>
    <span class="c">///</span><span class="c"> This is to support the arguments to script blocks that we invoke automatically</span>
    <span class="c">///</span><span class="c"> as a response to some events.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="859782a2e1b81f61" href="../R/859782a2e1b81f61.html" target="n" data-glyph="2,0" class="t t">EventAction</a>
    {
        <b>public</b> <a id="503a109350815231" href="../R/503a109350815231.html" target="n" data-glyph="72,1" class="t constructor">EventAction</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r324 rd" class="r324 r">sender</span>, <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r325 rd" class="r325 r">args</span>)
        {
            <a href="#58708b3190fa5e3c" class="i property">Sender</a> = <span class="r324 r">sender</span>;
            <a href="#b3e8d63110cc6812" class="i property">Args</a> = <span class="r325 r">args</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the sender of this event (the event subscriber)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="58708b3190fa5e3c" href="../R/58708b3190fa5e3c.html" target="n" data-glyph="102,1" class="i property">Sender</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the arguments of this event (the event that was fired)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="b3e8d63110cc6812" href="../R/b3e8d63110cc6812.html" target="n" data-glyph="102,1" class="i property">Args</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A class to give a job-like interface to event actions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ce0fcd992a2c4958" href="../R/ce0fcd992a2c4958.html" target="n" data-glyph="0,0" class="t t">PSEventJob</a> : <a href="remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of the PSEventJob class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r326 r">eventManager</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The event manager that controls the event subscriptions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r327 r">subscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber that generates these actions</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r328 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block invoked for this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r329 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the job</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="aefd958a05f563b6" href="../R/aefd958a05f563b6.html" target="n" data-glyph="72,1" class="t constructor">PSEventJob</a>(
            <a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a> <span id="r326 rd" class="r326 r">eventManager</span>,
            <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r327 rd" class="r327 r">subscriber</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r328 rd" class="r328 r">action</span>,
            <b>string</b> <span id="r329 rd" class="r329 r">name</span>)
            : <b>base</b>(<span class="r328 r">action</span>?.<a href="runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>(), <span class="r329 r">name</span>)
        {
            <b>if</b> (<span class="r326 r">eventManager</span> == <b>null</b>)
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r326 r">eventManager</span>));
            <b>if</b> (<span class="r327 r">subscriber</span> == <b>null</b>)
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r327 r">subscriber</span>));
 
            <a href="remoting/client/Job.cs.html#fd6ecf089f9dc9c7" class="i property">UsesResultsCollection</a> = <b>true</b>;
            <a href="#95fb9d7088541eab" class="i property">ScriptBlock</a> = <span class="r328 r">action</span>;
            <a href="#fb1d6a42ebdd3d92" class="i field">_eventManager</a> = <span class="r326 r">eventManager</span>;
            <a href="#380e5d444d3651cd" class="i field">_subscriber</a> = <span class="r327 r">subscriber</span>;
        }
 
        <b>private readonly</b> <a href="#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="fb1d6a42ebdd3d92" href="../R/fb1d6a42ebdd3d92.html" target="n" data-glyph="46,1" class="i field">_eventManager</a> = <b>null</b>;
        <b>private readonly</b> <a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <a id="380e5d444d3651cd" href="../R/380e5d444d3651cd.html" target="n" data-glyph="46,1" class="i field">_subscriber</a> = <b>null</b>;
        <b>private int</b> <a id="2d34c20b3a1484ce" href="../R/2d34c20b3a1484ce.html" target="n" data-glyph="46,1" class="i field">_highestErrorIndex</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets dynamic module where the action is invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="6e0af698ed5aa976" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Module</a>
        {
            <b>get</b> { <b>return</b> <a href="#95fb9d7088541eab" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#da67b7d69aadb962" class="i property">Module</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="e887c5655b15b82a" href="../R/e887c5655b15b82a.html" target="n" data-glyph="72,1" class="i method">StopJob</a>()
        {
            <a href="#fb1d6a42ebdd3d92" class="i field">_eventManager</a>.<a href="#66c6cf23c037e49c" class="i method">UnsubscribeEvent</a>(<a href="#380e5d444d3651cd" class="i field">_subscriber</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message indicating status of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="49cc3cb03d1b0d35" href="../R/49cc3cb03d1b0d35.html" target="n" data-glyph="102,1" class="i property">StatusMessage</a> { <b>get</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if more data is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This has more data if any of the child jobs have more data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="3b3fdfd8c232b115" href="../R/3b3fdfd8c232b115.html" target="n" data-glyph="102,1" class="i property">HasMoreData</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#17f43a9e07881fd1" class="i field">_moreData</a>;
            }
        }
 
        <b>private bool</b> <a id="17f43a9e07881fd1" href="../R/17f43a9e07881fd1.html" target="n" data-glyph="46,1" class="i field">_moreData</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Location in which this job is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="703b37e833af6fc6" href="../R/703b37e833af6fc6.html" target="n" data-glyph="102,1" class="i property">Location</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scriptblock that defines the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="95fb9d7088541eab" href="../R/95fb9d7088541eab.html" target="n" data-glyph="104,1" class="i property">ScriptBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke the script block</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r330 r">eventSubscriber</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The subscriber that generated this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r331 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context of this event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="def1f5e4317f3cc3" href="../R/def1f5e4317f3cc3.html" target="n" data-glyph="74,1" class="i method">Invoke</a>(<a href="#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r330 rd" class="r330 r">eventSubscriber</span>, <a href="#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r331 rd" class="r331 r">eventArgs</span>)
        {
            <b>if</b> (<a href="remoting/client/Job.cs.html#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="remoting/client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="remoting/client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a>))
                <b>return</b>;
 
            <a href="remoting/client/Job.cs.html#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="remoting/client/Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>);
 
            <span class="c">// Prepare the automatic variables</span>
            <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <span id="r332 rd" class="r332 r">actionState</span> = <a href="#95fb9d7088541eab" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#d25a345294fd74f0" class="i property">SessionStateInternal</a>.<a href="SessionState.cs.html#e8d61ec8e5e7bb28" class="i property">PublicSessionState</a>;
 
            <span class="c">// $psEventSubscriber = The subscriber</span>
            <span class="c">// that generated this event</span>
            <span class="r332 r">actionState</span>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f2dafcc3a1a096b4" class="i method">Set</a>(<span class="s">&quot;eventSubscriber&quot;</span>, <span class="r330 r">eventSubscriber</span>);
            <span class="c">// $psEvent = The extended event information</span>
            <span class="r332 r">actionState</span>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f2dafcc3a1a096b4" class="i method">Set</a>(<span class="s">&quot;event&quot;</span>, <span class="r331 r">eventArgs</span>);
 
            <span class="c">// $sender = $psEvent.Sender</span>
            <span class="r332 r">actionState</span>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f2dafcc3a1a096b4" class="i method">Set</a>(<span class="s">&quot;sender&quot;</span>, <span class="r331 r">eventArgs</span>.<a href="#1b4e059cf3c8cdad" class="i property">Sender</a>);
            <span class="c">// $eventArgs = $psEvent.SourceEventArgs</span>
            <span class="r332 r">actionState</span>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<span class="i">Set</span>(<span class="s">&quot;eventArgs&quot;</span>, <span class="r331 r">eventArgs</span>.<a href="#d0726de6cebf6169" class="i property">SourceEventArgs</a>);
 
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r333 rd" class="r333 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <span class="c">// $args = $psEventArgs.SourceArgs (for PARAM statement)</span>
            <b>try</b>
            {
                <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <span id="r334 rd" class="r334 r">outputPipe</span> = <b>new</b> <a href="Pipe.cs.html#99288ee09b9642bb" class="t constructor">Pipe</a>(<span class="r333 r">results</span>);
                <a href="#95fb9d7088541eab" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#79e4a92eda3f9883" class="i method">InvokeWithPipe</a>(
                    <span class="r335 r">useLocalScope</span>: <b>false</b>,
                    <span class="r336 r">errorHandlingBehavior</span>: <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="lang/scriptblock.cs.html#df0061919fb37a15" class="i field">WriteToExternalErrorPipe</a>,
                    <span class="r337 r">dollarUnder</span>: <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                    <span class="r338 r">input</span>: <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                    <span class="r339 r">scriptThis</span>: <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                    <span class="r340 r">outputPipe</span>: <span class="r334 r">outputPipe</span>,
                    <span class="r341 r">invocationInfo</span>: <b>null</b>,
                    <span class="r342 r">args</span>: <span class="r331 r">eventArgs</span>.<a href="#f366c1fd1503a327" class="i property">SourceArgs</a>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r343 rd" class="r343 r">e</span>)
            {
                <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                <b>if</b> (<span class="r343 r">e</span> <b>is not</b> <a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
                {
                    <a href="#46310897286f4676" class="i method">LogErrorsAndOutput</a>(<span class="r333 r">results</span>, <span class="r332 r">actionState</span>);
                    <a href="remoting/client/Job.cs.html#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="remoting/client/Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>);
                }
 
                <b>throw</b>;
            }
            <span class="c">/*
             * Not clearing the variables because of Win8: 738767 (Event actions no longer have persistent event variables)
             */</span>
 
            <a href="#46310897286f4676" class="i method">LogErrorsAndOutput</a>(<span class="r333 r">results</span>, <span class="r332 r">actionState</span>);
            <a href="#17f43a9e07881fd1" class="i field">_moreData</a> = <b>true</b>;
        }
 
        <b>internal void</b> <a id="b30083f1c788d38c" href="../R/b30083f1c788d38c.html" target="n" data-glyph="74,1" class="i method">NotifyJobStopped</a>()
        {
            <a href="remoting/client/Job.cs.html#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="remoting/client/Job.cs.html#223c91574b18631a" class="i field">Stopped</a>);
            <a href="#17f43a9e07881fd1" class="i field">_moreData</a> = <b>false</b>;
        }
 
        <b>private void</b> <a id="46310897286f4676" href="../R/46310897286f4676.html" target="n" data-glyph="76,1" class="i method">LogErrorsAndOutput</a>(<span class="i">List</span>&lt;<b>object</b>&gt; <span id="r344 rd" class="r344 r">results</span>, <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <span id="r345 rd" class="r345 r">actionState</span>)
        {
            <span class="c">// Add the output to the job</span>
            <b>for</b> (<b>int</b> <span id="r346 rd" class="r346 r">i</span> = 0; <span class="r346 r">i</span> &lt; <span class="r344 r">results</span>.<span class="i">Count</span>; <span class="r346 r">i</span>++)
            {
                <a href="#ce0fcd992a2c4958" class="k">this</a>.<span class="i">WriteObject</span>(<span class="r344 r">results</span>[<span class="r346 r">i</span>]);
            }
 
            <span class="c">// And the errors</span>
            <a href="remoting/client/Job.cs.html#322c09d9eb167da1" class="i property">Error</a>.<a href="hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <b>int</b> <span id="r347 rd" class="r347 r">currentErrorIndex</span> = 0;
            <b>var</b> <span id="r348 rd" class="r348 r">errors</span> = (<span class="i">ArrayList</span>)<span class="r345 r">actionState</span>.<a href="SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="VariableInterfaces.cs.html#f4f82fae9d4a7f1f" class="i method">Get</a>(<span class="s">&quot;error&quot;</span>).<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>;
            <span class="r348 r">errors</span>.<span class="i">Reverse</span>();
 
            <b>for</b> (<b>int</b> <span id="r349 rd" class="r349 r">i</span> = 0; <span class="r349 r">i</span> &lt; <span class="r348 r">errors</span>.<span class="i">Count</span>; <span class="r349 r">i</span>++)
            {
                <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r350 rd" class="r350 r">error</span> = (<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="r348 r">errors</span>[<span class="r349 r">i</span>];
                <b>if</b> (<span class="r347 r">currentErrorIndex</span> == <a href="#2d34c20b3a1484ce" class="i field">_highestErrorIndex</a>)
                {
                    <a href="#ce0fcd992a2c4958" class="k">this</a>.<a href="remoting/client/Job.cs.html#f1efa785e9495a67" class="i method">WriteError</a>(<span class="r350 r">error</span>);
                    <a href="#2d34c20b3a1484ce" class="i field">_highestErrorIndex</a>++;
                }
 
                <span class="r347 r">currentErrorIndex</span>++;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
