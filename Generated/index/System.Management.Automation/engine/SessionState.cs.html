<!DOCTYPE html>
<html><head><title>SessionState.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(545);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/SessionState.cs" target="_top">engine\SessionState.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Holds the state of a Monad Shell session.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1506:AvoidExcessiveClassCoupling&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This is a bridge class between internal classes and a public interface. It requires this much coupling.&quot;</span>)]
    <b>internal sealed</b> <a href="../P/2dc1bd90a8299178.html" target="s" class="k">partial</a> <b>class</b> <a id="2dc1bd90a8299178" href="../R/2dc1bd90a8299178.html" target="n" data-glyph="2,0" class="t t">SessionStateInternal</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the PSTraceSource class used for trace output</span>
        <span class="c">///</span><span class="c"> using &quot;SessionState&quot; as the category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i n">Dbg</span>.<span class="i">TraceSourceAttribute</span>(
             <span class="s">&quot;SessionState&quot;</span>,
             <span class="s">&quot;SessionState Class&quot;</span>)]
        <b>private static readonly</b> <span class="i n">Dbg</span>.<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="9a175ef52dd782b6" href="../R/9a175ef52dd782b6.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> =
            <span class="i n">Dbg</span>.<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;SessionState&quot;</span>,
             <span class="s">&quot;SessionState Class&quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for session state object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context for the runspace to which this session state object belongs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="5ccb828c0af0ef80" href="../R/5ccb828c0af0ef80.html" target="n" data-glyph="74,1" class="t constructor">SessionStateInternal</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r0 rd" class="r0 r">context</span>) : <a href="#bfa6a7a1d31f0eed" class="k">this</a>(<b>null</b>, <b>false</b>, <span class="r0 r">context</span>)
        {
        }
 
        <b>internal</b> <a id="bfa6a7a1d31f0eed" href="../R/bfa6a7a1d31f0eed.html" target="n" data-glyph="74,1" class="t constructor">SessionStateInternal</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r1 rd" class="r1 r">parent</span>, <b>bool</b> <span id="r2 rd" class="r2 r">linkToGlobal</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r3 rd" class="r3 r">context</span>)
        {
            <b>if</b> (<span class="r3 r">context</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">context</span>));
            }
 
            <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a> = <span class="r3 r">context</span>;
 
            <span class="c">// Create the working directory stack. This</span>
            <span class="c">// is used for the pushd and popd commands</span>
 
            <a href="SessionStateLocationAPIs.cs.html#e71c69d08af463d6" class="i field">_workingLocationStack</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Stack</span>&lt;<a href="../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <span class="c">// Conservative choice to limit the Set-Location history in order to limit memory impact in case of a regression.</span>
            <b>const int</b> <span id="r4 rd" class="r4 r">locationHistoryLimit</span> = 20;
            <a href="SessionStateLocationAPIs.cs.html#9de4eb1ca462aa97" class="i field">_setLocationHistory</a> = <b>new</b> <a href="Utils.cs.html#b7824ff6130c3c98" class="t constructor">HistoryStack</a>&lt;<a href="../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>&gt;(<span class="r4 r">locationHistoryLimit</span>);
 
            <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a> = <b>new</b> <a href="SessionStateScope.cs.html#5cb50ac1c5ec03b2" class="t constructor">SessionStateScope</a>(<b>null</b>);
            <a href="SessionStateScopeAPIs.cs.html#59eeece84e54dc1f" class="i property">ModuleScope</a> = <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
            <a href="SessionStateScopeAPIs.cs.html#5dfb91703808fccd" class="i field">_currentScope</a> = <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
 
            <a href="#22ae9da371b8c065" class="i method">InitializeSessionStateInternalSpecialVariables</a>(<b>false</b>);
 
            <span class="c">// Create the push the global scope on as</span>
            <span class="c">// the starting script scope.  That way, if you dot-source a script</span>
            <span class="c">// that uses variables qualified by script: it works.</span>
            <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#3f4dd09980424f44" class="i property">ScriptScope</a> = <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
 
            <b>if</b> (<span class="r1 r">parent</span> != <b>null</b>)
            {
                <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a> = <span class="r1 r">parent</span>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
 
                <span class="c">// Copy the drives and providers from the parent...</span>
                <a href="SessionStateProviderAPIs.cs.html#0ee1668ccac30268" class="i method">CopyProviders</a>(<span class="r1 r">parent</span>);
                <span class="c">// During loading of core modules, providers are not populated.</span>
                <span class="c">// We set the drive information later</span>
                <b>if</b> (<a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a> != <b>null</b> &amp;&amp; <a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> = <span class="r1 r">parent</span>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a>;
                }
 
                <span class="c">// Link it to the global scope...</span>
                <b>if</b> (<span class="r2 r">linkToGlobal</span>)
                {
                    <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a> = <span class="r1 r">parent</span>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>;
                }
            }
            <b>else</b>
            {
                <a href="SessionStateScopeAPIs.cs.html#5dfb91703808fccd" class="i field">_currentScope</a>.<a href="SessionStateScope.cs.html#d10101bbc5961e39" class="i property">LocalsTuple</a> = <a href="runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="runtime/MutableTuple.cs.html#32166b6659de79e2" class="i method">MakeTuple</a>(<a href="parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="parser/Compiler.cs.html#50f3467ff6c08485" class="i field">DottedLocalsTupleType</a>, <a href="parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="parser/Compiler.cs.html#8a3b323becd5e9eb" class="i field">DottedLocalsNameIndexMap</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add any special variables to the session state variable table. This routine</span>
        <span class="c">///</span><span class="c"> must be called at construction time or if the variable table is reset.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="22ae9da371b8c065" href="../R/22ae9da371b8c065.html" target="n" data-glyph="74,1" class="i method">InitializeSessionStateInternalSpecialVariables</a>(<b>bool</b> <span id="r5 rd" class="r5 r">clearVariablesTable</span>)
        {
            <b>if</b> (<span class="r5 r">clearVariablesTable</span>)
            {
                <span class="c">// Clear the variable table</span>
                <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#f3f7c22a2d29d233" class="i property">Variables</a>.<span class="i">Clear</span>();
 
                <span class="c">// Add in the per-scope default variables.</span>
                <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#b885786a79effcb5" class="i method">AddSessionStateScopeDefaultVariables</a>();
            }
 
            <span class="c">// Set variable $Error</span>
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r6 rd" class="r6 r">errorvariable</span> = <b>new</b> <span class="t">PSVariable</span>(<span class="s">&quot;Error&quot;</span>, <b>new</b> <span class="i">ArrayList</span>(), <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>);
            <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r6 r">errorvariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r6 r">errorvariable</span>, <b>false</b>, <b>false</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// Set variable $PSDefaultParameterValues</span>
            <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <span id="r8 rd" class="r8 r">attributes</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
            <span class="r8 r">attributes</span>.<span class="i">Add</span>(<b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="CmdletParameterBinderController.cs.html#4c03f64470bcc0c2" class="t t">DefaultParameterDictionary</a>)));
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r9 rd" class="r9 r">psDefaultParameterValuesVariable</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#498bdcaf135312a2" class="i field">PSDefaultParameterValues</a>,
                                                                         <b>new</b> <a href="CmdletParameterBinderController.cs.html#164c12623948f225" class="t constructor">DefaultParameterDictionary</a>(),
                                                                         <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <span class="r8 r">attributes</span>,
                                                                         <span class="i">RunspaceInit</span>.<span class="i">PSDefaultParameterValuesDescription</span>);
            <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r9 r">psDefaultParameterValuesVariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r9 r">psDefaultParameterValuesVariable</span>, <b>false</b>, <b>false</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provides all the path manipulation and globbing for Monad paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a> <a id="fe703887002b8fc2" href="../R/fe703887002b8fc2.html" target="n" data-glyph="104,1" class="i property">Globber</a>
        {
            <b>get</b> { <b>return</b> <a href="#c1aeeacbe3cca96d" class="i field">_globberPrivate</a> ??= <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>; }
        }
 
        <b>private</b> <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a> <a id="c1aeeacbe3cca96d" href="../R/c1aeeacbe3cca96d.html" target="n" data-glyph="46,1" class="i field">_globberPrivate</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context of the runspace to which this session state object belongs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="3ddff2db6bc01805" href="../R/3ddff2db6bc01805.html" target="n" data-glyph="104,1" class="i property">ExecutionContext</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the public session state facade object for this session state instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <a id="e8d61ec8e5e7bb28" href="../R/e8d61ec8e5e7bb28.html" target="n" data-glyph="104,1" class="i property">PublicSessionState</a>
        {
            <b>get</b> { <b>return</b> <a href="#cb4de37d24ac1947" class="i field">_publicSessionState</a> ??= <b>new</b> <a href="SessionStatePublic.cs.html#45f5fbc7afc57ae4" class="t constructor">SessionState</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>); }
 
            <b>set</b> { <a href="#cb4de37d24ac1947" class="i field">_publicSessionState</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <a id="cb4de37d24ac1947" href="../R/cb4de37d24ac1947.html" target="n" data-glyph="46,1" class="i field">_publicSessionState</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the engine APIs to access providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CmdletFamilyProviderInterfaces.cs.html#7e7c55aa110a0320" class="t t">ProviderIntrinsics</a> <a id="90da109969600d24" href="../R/90da109969600d24.html" target="n" data-glyph="104,1" class="i property">InvokeProvider</a>
        {
            <b>get</b> { <b>return</b> <a href="#2ac04ae268e56cad" class="i field">_invokeProvider</a> ??= <b>new</b> <a href="CmdletFamilyProviderInterfaces.cs.html#19f570e1978a2f92" class="t constructor">ProviderIntrinsics</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>); }
        }
 
        <b>private</b> <a href="CmdletFamilyProviderInterfaces.cs.html#7e7c55aa110a0320" class="t t">ProviderIntrinsics</a> <a id="2ac04ae268e56cad" href="../R/2ac04ae268e56cad.html" target="n" data-glyph="46,1" class="i field">_invokeProvider</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module info object associated with this session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="1900efdc2f293d5a" href="../R/1900efdc2f293d5a.html" target="n" data-glyph="104,1" class="i property">Module</a> { <b>get</b>; <b>set</b>; } = <b>null</b>;
 
        <span class="c">// This is used to maintain the order in which modules were imported.</span>
        <span class="c">// This is used by Get-Command -All to order by last imported</span>
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="99191506d80f52d7" href="../R/99191506d80f52d7.html" target="n" data-glyph="44,1" class="i field">ModuleTableKeys</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The private module table for this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt; <a id="5f2e915b732790bb" href="../R/5f2e915b732790bb.html" target="n" data-glyph="104,1" class="i property">ModuleTable</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/set constraints for this execution environment.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="c13642db000f9224" href="../R/c13642db000f9224.html" target="n" data-glyph="104,1" class="i property">LanguageMode</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>;
            }
 
            <b>set</b>
            {
                <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true the PowerShell debugger will use FullLanguage mode, otherwise it will use the current language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="4118a8d5bc432193" href="../R/4118a8d5bc432193.html" target="n" data-glyph="104,1" class="i property">UseFullLanguageModeInDebugger</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#7a174c9b85c175bf" class="i property">UseFullLanguageModeInDebugger</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of scripts that are allowed to be run. If the name &quot;*&quot;</span>
        <span class="c">///</span><span class="c"> is in the list, then all scripts can be run. (This is the default.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="36447cb8e57fac9f" href="../R/36447cb8e57fac9f.html" target="n" data-glyph="102,1" class="i property">Scripts</a> { <b>get</b>; } = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> });
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> See if a script is allowed to be run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">scriptPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Path to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if script is allowed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="3d4b4539a75c3467" href="../R/3d4b4539a75c3467.html" target="n" data-glyph="74,1" class="i method">CheckScriptVisibility</a>(<b>string</b> <span id="r10 rd" class="r10 r">scriptPath</span>)
        {
            <b>return</b> <a href="#39a94511a126a32d" class="i method">checkPathVisibility</a>(<a href="#36447cb8e57fac9f" class="i property">Scripts</a>, <span class="r10 r">scriptPath</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of applications that are allowed to be run. If the name &quot;*&quot;</span>
        <span class="c">///</span><span class="c"> is in the list, then all applications can be run. (This is the default.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="27ddff158f6adc5b" href="../R/27ddff158f6adc5b.html" target="n" data-glyph="102,1" class="i property">Applications</a> { <b>get</b>; } = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> });
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of functions/filters to export from this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <a id="51f4f7bc9645d49d" href="../R/51f4f7bc9645d49d.html" target="n" data-glyph="104,1" class="i property">ExportedCmdlets</a> { <b>get</b>; } = <b>new</b> <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Defines the default command visibility for this session state. Binding an InitialSessionState instance</span>
        <span class="c">///</span><span class="c"> with private members will set this to Private.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="d788418311c2eafb" href="../R/d788418311c2eafb.html" target="n" data-glyph="44,1" class="i field">DefaultCommandVisibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add an new SessionState cmdlet entry to this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0e6a086b916ccdff" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddSessionStateEntry</a>(<a href="InitialSessionState.cs.html#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r11 rd" class="r11 r">entry</span>)
        {
            <a href="#81d2e0b6e53ec4fa" class="i method">AddSessionStateEntry</a>(<span class="r11 r">entry</span>, <span class="c">/*local*/</span><b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add an new SessionState cmdlet entry to this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">local</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If local, add cmdlet to current scope. Else, add to module scope.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="81d2e0b6e53ec4fa" href="../R/81d2e0b6e53ec4fa.html" target="n" data-glyph="74,1" class="i method">AddSessionStateEntry</a>(<a href="InitialSessionState.cs.html#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r12 rd" class="r12 r">entry</span>, <b>bool</b> <span id="r13 rd" class="r13 r">local</span>)
        {
            <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#6036be498f5847c6" class="i method">AddSessionStateCmdletEntryToCache</a>(<span class="r12 r">entry</span>, <span class="r13 r">local</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add an new SessionState cmdlet entry to this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="fa6382c5e2c3f311" href="../R/fa6382c5e2c3f311.html" target="n" data-glyph="74,1" class="i method">AddSessionStateEntry</a>(<a href="InitialSessionState.cs.html#eac0c2c0c238d4f8" class="t t">SessionStateApplicationEntry</a> <span id="r14 rd" class="r14 r">entry</span>)
        {
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="#27ddff158f6adc5b" class="i property">Applications</a>.<span class="i">Add</span>(<span class="r14 r">entry</span>.<a href="InitialSessionState.cs.html#a3e8a804e4103471" class="i property">Path</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add an new SessionState cmdlet entry to this session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="66e895e0d3b41629" href="../R/66e895e0d3b41629.html" target="n" data-glyph="74,1" class="i method">AddSessionStateEntry</a>(<a href="InitialSessionState.cs.html#12337c12cd2f1655" class="t t">SessionStateScriptEntry</a> <span id="r15 rd" class="r15 r">entry</span>)
        {
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="#36447cb8e57fac9f" class="i property">Scripts</a>.<span class="i">Add</span>(<span class="r15 r">entry</span>.<a href="InitialSessionState.cs.html#115c82d31987b9b7" class="i property">Path</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add the variables that must always be present in a SessionState instance...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="34f35d9e375204aa" href="../R/34f35d9e375204aa.html" target="n" data-glyph="74,1" class="i method">InitializeFixedVariables</a>()
        {
            <span class="c">//</span>
            <span class="c">// BUGBUG</span>
            <span class="c">//</span>
            <span class="c">// String resources for aliases are currently associated with Runspace init</span>
            <span class="c">//</span>
 
            <span class="c">// $Host</span>
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r16 rd" class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#589a8010f920462f" class="i field">Host</a>,
                    <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSHostDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $HOME - indicate where a user&#39;s home directory is located in the file system.</span>
            <span class="c">//    -- %USERPROFILE% on windows</span>
            <span class="c">//    -- %HOME% on unix</span>
            <b>string</b> <span id="r19 rd" class="r19 r">home</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#2ec531e5b2c821e4" class="t t">CommonEnvVariableNames</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#7bda162e9185ce4e" class="i field">Home</a>) ?? <b>string</b>.<span class="i">Empty</span>;
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#583ca1b2b1858349" class="i field">Home</a>,
                    <span class="r19 r">home</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">HOMEDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $ExecutionContext</span>
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#9e7b356a9ae2c07e" class="i field">ExecutionContext</a>,
                    <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#27c4e82ba7216ff8" class="i property">EngineIntrinsics</a>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">ExecutionContextDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $PSVersionTable</span>
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#7cd8f41ba6965d6f" class="i field">PSVersionTable</a>,
                    <a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#79732d42fa2b24db" class="i method">GetPSVersionTable</a>(),
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSVersionTableDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $PSEdition</span>
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#ebd54e5bc2887b94" class="i field">PSEdition</a>,
                    <a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#dbf00405143bed38" class="i field">PSEditionValue</a>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSEditionDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $PID</span>
            <span class="i">Process</span> <span id="r20 rd" class="r20 r">currentProcess</span> = <span class="i">Process</span>.<span class="i">GetCurrentProcess</span>();
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#a168612c1d3f4cf5" class="i field">PID</a>,
                    <span class="r20 r">currentProcess</span>.<span class="i">Id</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PIDDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $PSCulture</span>
            <span class="r16 r">v</span> = <b>new</b> <a href="CultureVariable.cs.html#cb7e6e3cb2b55e63" class="t constructor">PSCultureVariable</a>();
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0c0ff36eb0f81bf6" class="i method">SetVariableForce</a>(<span class="r16 r">v</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>);
 
            <span class="c">// $PSUICulture</span>
            <span class="r16 r">v</span> = <b>new</b> <a href="CultureVariable.cs.html#b13cd3f128688910" class="t constructor">PSUICultureVariable</a>();
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0c0ff36eb0f81bf6" class="i method">SetVariableForce</a>(<span class="r16 r">v</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>);
 
            <span class="c">// $?</span>
            <span class="r16 r">v</span> = <b>new</b> <a href="QuestionMarkVariable.cs.html#994eabaaf999d508" class="t constructor">QuestionMarkVariable</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0c0ff36eb0f81bf6" class="i method">SetVariableForce</a>(<span class="r16 r">v</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>);
 
            <span class="c">// $ShellId - if there is no runspace config, use the default string</span>
            <b>string</b> <span id="r21 rd" class="r21 r">shellId</span> = <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#347758c52bbd3a07" class="i property">ShellID</a>;
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#f3abf3963c9dd524" class="i field">ShellId</a>, <span class="r21 r">shellId</span>,
                   <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">MshShellIdDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $PSHOME</span>
            <b>string</b> <span id="r22 rd" class="r22 r">applicationBase</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#c677cc800603f8f5" class="i property">DefaultPowerShellAppBase</a>;
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#bf07e80b22752c90" class="i field">PSHome</a>, <span class="r22 r">applicationBase</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSHOMEDescription</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
 
            <span class="c">// $EnabledExperimentalFeatures</span>
            <span class="r16 r">v</span> = <b>new</b> <span class="t">PSVariable</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#67d517e03a6b8eae" class="i field">EnabledExperimentalFeatures</a>,
                               <a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#d86cbce56c868d61" class="i field">EnabledExperimentalFeatureNames</a>,
                               <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                               <span class="i">RunspaceInit</span>.<span class="i">EnabledExperimentalFeatures</span>);
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r16 r">v</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r16 r">v</span>, <span class="r17 r">asValue</span>: <b>false</b>, <span class="r18 r">force</span>: <b>true</b>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <span class="r7 r">fastPath</span>: <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check to see if an application is allowed to be run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">applicationPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the application to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if application is permitted.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="8af67aaee1ae5ae4" href="../R/8af67aaee1ae5ae4.html" target="n" data-glyph="74,1" class="i method">CheckApplicationVisibility</a>(<b>string</b> <span id="r23 rd" class="r23 r">applicationPath</span>)
        {
            <b>return</b> <a href="#39a94511a126a32d" class="i method">checkPathVisibility</a>(<a href="#27ddff158f6adc5b" class="i property">Applications</a>, <span class="r23 r">applicationPath</span>);
        }
 
        <b>private static</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="39a94511a126a32d" href="../R/39a94511a126a32d.html" target="n" data-glyph="76,1" class="i method">checkPathVisibility</a>(<span class="i">List</span>&lt;<b>string</b>&gt; <span id="r24 rd" class="r24 r">list</span>, <b>string</b> <span id="r25 rd" class="r25 r">path</span>)
        {
            <b>if</b> (<span class="r24 r">list</span> == <b>null</b> || <span class="r24 r">list</span>.<span class="i">Count</span> == 0) <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r25 r">path</span>)) <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
 
            <b>if</b> (<span class="r24 r">list</span>.<span class="i">Contains</span>(<span class="s">&quot;*&quot;</span>)) <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
            <b>foreach</b> (<b>string</b> <span id="r26 rd" class="r26 r">p</span> <b>in</b> <span class="r24 r">list</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r26 r">p</span>, <span class="r25 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
 
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r26 r">p</span>))
                {
                    <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r27 rd" class="r27 r">pattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r26 r">p</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>if</b> (<span class="r27 r">pattern</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r25 r">path</span>))
                    {
                        <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
                    }
                }
            }
 
            <b>return</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Notification for SessionState to do cleanup</span>
        <span class="c">///</span><span class="c"> before runspace is closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0253fb8c24047450" href="../R/0253fb8c24047450.html" target="n" data-glyph="74,1" class="i method">RunspaceClosingNotification</a>()
        {
            <b>if</b> (<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a> != <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a> &amp;&amp; <a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Remove all providers at the top level...</span>
 
                <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r28 rd" class="r28 r">context</span> = <b>new</b> <a href="../namespaces/CoreCommandContext.cs.html#8a0e078b40b2fd0e" class="t constructor">CmdletProviderContext</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>);
 
                <b>foreach</b> (<b>string</b> <span id="r29 rd" class="r29 r">providerName</span> <b>in</b> <a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a>.<span class="i">Keys</span>)
                {
                    <span class="c">// All errors are ignored.</span>
 
                    <a href="SessionStateProviderAPIs.cs.html#5d394d367dedec84" class="i method">RemoveProvider</a>(<span class="r29 r">providerName</span>, <b>true</b>, <span class="r28 r">context</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Errors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a new instance of a ProviderInvocationException</span>
        <span class="c">///</span><span class="c"> using the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource ID to use as the format message for the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">resourceStr</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the message template string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider information used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that was thrown by the provider. This will be set as</span>
        <span class="c">///</span><span class="c"> the ProviderInvocationException&#39;s InnerException and the message will</span>
        <span class="c">///</span><span class="c"> be used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A new instance of a ProviderInvocationException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wraps </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">e</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in a ProviderInvocationException</span>
        <span class="c">///</span><span class="c"> and then throws it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <a id="5e05fdfeb7c1c1a9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewProviderInvocationException</a>(
            <b>string</b> <span id="r30 rd" class="r30 r">resourceId</span>,
            <b>string</b> <span id="r31 rd" class="r31 r">resourceStr</span>,
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r32 rd" class="r32 r">provider</span>,
            <b>string</b> <span id="r33 rd" class="r33 r">path</span>,
            <span class="i">Exception</span> <span id="r34 rd" class="r34 r">e</span>)
        {
            <b>return</b> <a href="#02e33790af8e1646" class="i method">NewProviderInvocationException</a>(<span class="r30 r">resourceId</span>, <span class="r31 r">resourceStr</span>, <span class="r32 r">provider</span>, <span class="r33 r">path</span>, <span class="r34 r">e</span>, <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a new instance of a ProviderInvocationException</span>
        <span class="c">///</span><span class="c"> using the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource ID to use as the format message for the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">resourceStr</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the message template string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider information used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that was thrown by the provider. This will be set as</span>
        <span class="c">///</span><span class="c"> the ProviderInvocationException&#39;s InnerException and the message will</span>
        <span class="c">///</span><span class="c"> be used when formatting the error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">useInnerExceptionErrorMessage</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the error record from the inner exception will be used if it contains one.</span>
        <span class="c">///</span><span class="c"> If false, the error message specified by the resourceId will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A new instance of a ProviderInvocationException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wraps </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">e</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in a ProviderInvocationException</span>
        <span class="c">///</span><span class="c"> and then throws it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <a id="02e33790af8e1646" href="../R/02e33790af8e1646.html" target="n" data-glyph="74,1" class="i method">NewProviderInvocationException</a>(
            <b>string</b> <span id="r35 rd" class="r35 r">resourceId</span>,
            <b>string</b> <span id="r36 rd" class="r36 r">resourceStr</span>,
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r37 rd" class="r37 r">provider</span>,
            <b>string</b> <span id="r38 rd" class="r38 r">path</span>,
            <span class="i">Exception</span> <span id="r39 rd" class="r39 r">e</span>,
            <b>bool</b> <span id="r40 rd" class="r40 r">useInnerExceptionErrorMessage</span>)
        {
            <span class="c">//  If the innerException was itself thrown by</span>
            <span class="c">//  ProviderBase.ThrowTerminatingError, it is already a</span>
            <span class="c">//  ProviderInvocationException, and we don&#39;t want to</span>
            <span class="c">//  re-wrap it.</span>
            <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r41 rd" class="r41 r">pie</span> = <span class="r39 r">e</span> <b>as</b> <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a>;
            <b>if</b> (<span class="r41 r">pie</span> != <b>null</b>)
            {
                <span class="r41 r">pie</span>.<a href="../utils/SessionStateExceptions.cs.html#90d7226236596e66" class="i field">_providerInfo</a> = <span class="r37 r">provider</span>;
                <b>return</b> <span class="r41 r">pie</span>;
            }
 
            <span class="r41 r">pie</span> = <b>new</b> <a href="../utils/SessionStateExceptions.cs.html#b01b697c81c9e9fd" class="t constructor">ProviderInvocationException</a>(<span class="r35 r">resourceId</span>, <span class="r36 r">resourceStr</span>, <span class="r37 r">provider</span>, <span class="r38 r">path</span>, <span class="r39 r">e</span>, <span class="r40 r">useInnerExceptionErrorMessage</span>);
 
            <span class="c">// Log a provider health event</span>
 
            <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<span class="i">LogProviderHealthEvent</span>(
                <a href="#3ddff2db6bc01805" class="i property">ExecutionContext</a>,
                <span class="r37 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>,
                <span class="r41 r">pie</span>,
                <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
 
            <b>return</b> <span class="r41 r">pie</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Errors
    }
}
</pre></td></tr></table></div></body></html>
