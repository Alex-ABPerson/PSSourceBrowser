<!DOCTYPE html>
<html><head><title>CommandHelpProvider.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1411);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/CommandHelpProvider.cs" target="_top">help\CommandHelpProvider.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Help</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class CommandHelpProvider implement the help provider for commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Command Help information are stored in &#39;help.xml&#39; files. Location of these files</span>
    <span class="c">///</span><span class="c"> can be found from through the engine execution context.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="293d288d50a44dcc" href="../R/293d288d50a44dcc.html" target="n" data-glyph="2,0" class="t t">CommandHelpProvider</a> : <a href="HelpProviderWithCache.cs.html#0636d0d6fc2b7961" class="t t">HelpProviderWithCache</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for CommandHelpProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="844c380086ed3c70" href="../R/844c380086ed3c70.html" target="n" data-glyph="74,1" class="t constructor">CommandHelpProvider</a>(<a href="HelpSystem.cs.html#c115cfdd76399004" class="t t">HelpSystem</a> <span id="r0 rd" class="r0 r">helpSystem</span>) : <a href="HelpProviderWithCache.cs.html#6b18a26581ef8e2b" class="k">base</a>(<span class="r0 r">helpSystem</span>)
        {
            <a href="#13186a061a029685" class="i field">_context</a> = <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#a61b4bce06593834" class="i property">ExecutionContext</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="379d6e61f8644747" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">CommandHelpProvider</a>()
        {
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Diagnostics&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>, <span class="s">&quot;System.Management.Automation.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.ConsoleHost.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;</span>);
            <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>.<span class="i">Add</span>(<span class="s">&quot;Microsoft.WSMan.Management&quot;</span>, <span class="s">&quot;Microsoft.Wsman.Management.dll-Help.xml&quot;</span>);
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="e5d0c8c3de020b71" href="../R/e5d0c8c3de020b71.html" target="n" data-glyph="46,1" class="i field">s_engineModuleHelpFileCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;();
 
        <b>private readonly</b> <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="13186a061a029685" href="../R/13186a061a029685.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Common Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of this provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Name of this provider</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal override string</b> <a id="35047bd7782ed3aa" href="../R/35047bd7782ed3aa.html" target="n" data-glyph="104,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="s">&quot;Command Help Provider&quot;</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help category for this provider, which is a constant: HelpCategory.Command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Help category for this provider</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="1e8646d1877ffe83" href="../R/1e8646d1877ffe83.html" target="n" data-glyph="104,1" class="i property">HelpCategory</a>
        {
            <b>get</b>
            {
                <b>return</b>
                    <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#a1f331dfd578cfe3" class="i field">Alias</a> |
                    <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help Provider Interface
 
        <b>private static void</b> <a id="aefd4f754c41618d" href="../R/aefd4f754c41618d.html" target="n" data-glyph="76,1" class="i method">GetModulePaths</a>(<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r1 rd" class="r1 r">commandInfo</span>, <b>out string</b> <span id="r2 rd" class="r2 r">moduleName</span>, <b>out string</b> <span id="r3 rd" class="r3 r">moduleDir</span>, <b>out string</b> <span id="r4 rd" class="r4 r">nestedModulePath</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r1 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;Caller should verify that commandInfo != null&quot;</span>);
 
            <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r5 rd" class="r5 r">cmdletInfo</span> = <span class="r1 r">commandInfo</span> <b>as</b> <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
            <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a> <span id="r6 rd" class="r6 r">scriptCommandInfo</span> = <span class="r1 r">commandInfo</span> <b>as</b> <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>;
 
            <b>string</b> <span id="r7 rd" class="r7 r">cmdNameWithoutPrefix</span> = <b>null</b>;
            <b>bool</b> <span id="r8 rd" class="r8 r">testWithoutPrefix</span> = <b>false</b>;
 
            <span class="r2 r">moduleName</span> = <b>null</b>;
            <span class="r3 r">moduleDir</span> = <b>null</b>;
            <span class="r4 r">nestedModulePath</span> = <b>null</b>;
 
            <b>if</b> (<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
            {
                <span class="r2 r">moduleName</span> = <span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>;
                <span class="r3 r">moduleDir</span> = <span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>;
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>))
                {
                    <span class="r8 r">testWithoutPrefix</span> = <b>true</b>;
                    <span class="r7 r">cmdNameWithoutPrefix</span> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../engine/Modules/ModuleCmdletBase.cs.html#1b2f60a53340d1d6" class="i method">RemovePrefixFromCommandName</a>(<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>);
                }
 
                <b>if</b> (<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#f1459faf08e930a8" class="i property">NestedModules</a> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r9 rd" class="r9 r">nestedModule</span> <b>in</b> <span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#f1459faf08e930a8" class="i property">NestedModules</a>)
                    {
                        <b>if</b> (<span class="r5 r">cmdletInfo</span> != <b>null</b> &amp;&amp;
                             (<span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#7afed1303b45c0b4" class="i property">ExportedCmdlets</a>.<span class="i">ContainsKey</span>(<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>) ||
                               (<span class="r8 r">testWithoutPrefix</span> &amp;&amp; <span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#7afed1303b45c0b4" class="i property">ExportedCmdlets</a>.<span class="i">ContainsKey</span>(<span class="r7 r">cmdNameWithoutPrefix</span>))))
                        {
                            <span class="r4 r">nestedModulePath</span> = <span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>;
                            <b>break</b>;
                        }
                        <b>else</b> <b>if</b> (<span class="r6 r">scriptCommandInfo</span> != <b>null</b> &amp;&amp;
                                  (<span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#2faddd301cf044c5" class="i property">ExportedFunctions</a>.<span class="i">ContainsKey</span>(<span class="r1 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>) ||
                                    (<span class="r8 r">testWithoutPrefix</span> &amp;&amp; <span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#2faddd301cf044c5" class="i property">ExportedFunctions</a>.<span class="i">ContainsKey</span>(<span class="r7 r">cmdNameWithoutPrefix</span>))))
                        {
                            <span class="r4 r">nestedModulePath</span> = <span class="r9 r">nestedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>;
                            <b>break</b>;
                        }
                    }
                }
            }
        }
 
        <b>private static string</b> <a id="54e4f219b709b893" href="../R/54e4f219b709b893.html" target="n" data-glyph="76,1" class="i method">GetHelpName</a>(<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r10 rd" class="r10 r">commandInfo</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r10 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;Caller should verify that commandInfo != null&quot;</span>);
 
            <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r11 rd" class="r11 r">cmdletInfo</span> = <span class="r10 r">commandInfo</span> <b>as</b> <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
 
            <b>if</b> (<span class="r11 r">cmdletInfo</span> != <b>null</b>)
            {
                <b>return</b> <span class="r11 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#7faf4081836f8538" class="i property">FullName</a>;
            }
 
            <b>return</b> <span class="r10 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
        }
 
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="2eec8ab2feb9cf2f" href="../R/2eec8ab2feb9cf2f.html" target="n" data-glyph="76,1" class="i method">GetHelpInfoFromHelpFile</a>(<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r12 rd" class="r12 r">commandInfo</span>, <b>string</b> <span id="r13 rd" class="r13 r">helpFileToFind</span>, <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r14 rd" class="r14 r">searchPaths</span>, <b>bool</b> <span id="r15 rd" class="r15 r">reportErrors</span>, <b>out string</b> <span id="r16 rd" class="r16 r">helpFile</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r12 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;Caller should verify that commandInfo != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r13 r">helpFileToFind</span> != <b>null</b>, <span class="s">&quot;Caller should verify that helpFileToFind != null&quot;</span>);
 
            <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r17 rd" class="r17 r">cmdletInfo</span> = <span class="r12 r">commandInfo</span> <b>as</b> <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
            <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a> <span id="r18 rd" class="r18 r">scriptCommandInfo</span> = <span class="r12 r">commandInfo</span> <b>as</b> <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>;
 
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r19 rd" class="r19 r">result</span> = <b>null</b>;
 
            <span class="r16 r">helpFile</span> = <a href="MUIFileSearcher.cs.html#b4d5f2ac8ec9ddb2" class="t t">MUIFileSearcher</a>.<a href="MUIFileSearcher.cs.html#8c1adea116d9b741" class="i method">LocateFile</a>(<span class="r13 r">helpFileToFind</span>, <span class="r14 r">searchPaths</span>);
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r16 r">helpFile</span>))
            {
                <b>if</b> (!<a href="#13186854eb95e0df" class="i field">_helpFiles</a>.<span class="i">Contains</span>(<span class="r16 r">helpFile</span>))
                {
                    <b>if</b> (<span class="r17 r">cmdletInfo</span> != <b>null</b>)
                    {
                        <a href="#6951655a0344bd4a" class="i method">LoadHelpFile</a>(<span class="r16 r">helpFile</span>, <span class="r17 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r17 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r15 r">reportErrors</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r18 r">scriptCommandInfo</span> != <b>null</b>)
                    {
                        <a href="#6951655a0344bd4a" class="i method">LoadHelpFile</a>(<span class="r16 r">helpFile</span>, <span class="r16 r">helpFile</span>, <span class="r12 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r15 r">reportErrors</span>);
                    }
                }
 
                <b>if</b> (<span class="r17 r">cmdletInfo</span> != <b>null</b>)
                {
                    <span class="r19 r">result</span> = <a href="#cfd075762e5c2561" class="i method">GetFromCommandCacheOrCmdletInfo</a>(<span class="r17 r">cmdletInfo</span>);
                }
                <b>else</b> <b>if</b> (<span class="r18 r">scriptCommandInfo</span> != <b>null</b>)
                {
                    <span class="r19 r">result</span> = <a href="#97797843daa5dde7" class="i method">GetFromCommandCache</a>(<span class="r16 r">helpFile</span>, <span class="r12 r">commandInfo</span>);
                }
            }
 
            <b>return</b> <span class="r19 r">result</span>;
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA1806:DoNotIgnoreMethodResults&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;TestUri is created only to check for source helpUriFromDotLink errors.&quot;</span>)]
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="3a1b84732bbbbf69" href="../R/3a1b84732bbbbf69.html" target="n" data-glyph="76,1" class="i method">GetHelpInfo</a>(<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r20 rd" class="r20 r">commandInfo</span>, <b>bool</b> <span id="r21 rd" class="r21 r">reportErrors</span>, <b>bool</b> <span id="r22 rd" class="r22 r">searchOnlyContent</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r20 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;Caller should verify that commandInfo != null&quot;</span>);
 
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r23 rd" class="r23 r">result</span> = <b>null</b>; <span class="c">// The help result</span>
            <b>string</b> <span id="r24 rd" class="r24 r">helpFile</span> = <b>null</b>; <span class="c">// The file that contains the help info</span>
            <b>string</b> <span id="r25 rd" class="r25 r">helpUri</span> = <b>null</b>;
            <b>string</b> <span id="r26 rd" class="r26 r">helpUriFromDotLink</span> = <b>null</b>;
 
            <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r27 rd" class="r27 r">cmdletInfo</span> = <span class="r20 r">commandInfo</span> <b>as</b> <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>;
            <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a> <span id="r28 rd" class="r28 r">scriptCommandInfo</span> = <span class="r20 r">commandInfo</span> <b>as</b> <a href="../engine/CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>;
            <a href="../engine/FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r29 rd" class="r29 r">functionInfo</span> = <span class="r20 r">commandInfo</span> <b>as</b> <a href="../engine/FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>;
            <b>bool</b> <span id="r30 rd" class="r30 r">isCmdlet</span> = <span class="r27 r">cmdletInfo</span> != <b>null</b>;
            <b>bool</b> <span id="r31 rd" class="r31 r">isScriptCommand</span> = <span class="r28 r">scriptCommandInfo</span> != <b>null</b>;
            <b>bool</b> <span id="r32 rd" class="r32 r">isFunction</span> = <span class="r29 r">functionInfo</span> != <b>null</b>;
 
            <b>string</b> <span id="r33 rd" class="r33 r">moduleName</span> = <b>null</b>;
            <b>string</b> <span id="r34 rd" class="r34 r">moduleDir</span> = <b>null</b>;
            <b>string</b> <span id="r35 rd" class="r35 r">nestedModulePath</span> = <b>null</b>;
 
            <span class="c">// When InternalTestHooks.BypassOnlineHelpRetrieval is enable, we force get-help to generate a metadata</span>
            <span class="c">// driven object, which includes a helpUri that points to the fwlink defined in the cmdlet code.</span>
            <span class="c">// This means that we are not going to load the help content from the GetFromCommandCache and</span>
            <span class="c">// we are not going to read the help file.</span>
 
            <span class="c">// Only gets help for Cmdlet or script command</span>
            <b>if</b> (!<span class="r30 r">isCmdlet</span> &amp;&amp; !<span class="r31 r">isScriptCommand</span>)
                <b>return</b> <b>null</b>;
 
            <span class="c">// Check if the help of the command is already in the cache.</span>
            <span class="c">// If not, try load the file specified by HelpFile property and retrieve help.</span>
            <b>if</b> (<span class="r30 r">isCmdlet</span> &amp;&amp; !<a href="../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../engine/Utils.cs.html#1ac48e16298071ba" class="i field">BypassOnlineHelpRetrieval</a>)
            {
                <span class="r23 r">result</span> = <a href="#a1bc33f65463410f" class="i method">GetFromCommandCache</a>(<span class="r27 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r27 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r27 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#df15b1b0213102ed" class="i property">HelpCategory</a>);
 
                <b>if</b> (<span class="r23 r">result</span> == <b>null</b>)
                {
                    <span class="c">// Try load the help file specified by CmdletInfo.HelpFile property</span>
                    <span class="r24 r">helpFile</span> = <a href="#076db389e477f6ac" class="i method">FindHelpFile</a>(<span class="r27 r">cmdletInfo</span>);
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">helpFile</span>) &amp;&amp; !<a href="#13186854eb95e0df" class="i field">_helpFiles</a>.<span class="i">Contains</span>(<span class="r24 r">helpFile</span>))
                    {
                        <a href="#6951655a0344bd4a" class="i method">LoadHelpFile</a>(<span class="r24 r">helpFile</span>, <span class="r27 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r27 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r21 r">reportErrors</span>);
                    }
 
                    <span class="r23 r">result</span> = <a href="#cfd075762e5c2561" class="i method">GetFromCommandCacheOrCmdletInfo</a>(<span class="r27 r">cmdletInfo</span>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r32 r">isFunction</span>)
            {
                <span class="c">// Try load the help file specified by FunctionInfo.HelpFile property</span>
                <span class="r24 r">helpFile</span> = <span class="r29 r">functionInfo</span>.<a href="../engine/FunctionInfo.cs.html#55416eb2023dc979" class="i property">HelpFile</a>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">helpFile</span>))
                {
                    <b>if</b> (!<a href="#13186854eb95e0df" class="i field">_helpFiles</a>.<span class="i">Contains</span>(<span class="r24 r">helpFile</span>))
                    {
                        <a href="#6951655a0344bd4a" class="i method">LoadHelpFile</a>(<span class="r24 r">helpFile</span>, <span class="r24 r">helpFile</span>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r21 r">reportErrors</span>);
                    }
 
                    <span class="r23 r">result</span> = <a href="#97797843daa5dde7" class="i method">GetFromCommandCache</a>(<span class="r24 r">helpFile</span>, <span class="r20 r">commandInfo</span>);
                }
            }
 
            <span class="c">// For scripts, try to retrieve the help from the file specified by .ExternalHelp directive</span>
            <b>if</b> (<span class="r23 r">result</span> == <b>null</b> &amp;&amp; <span class="r31 r">isScriptCommand</span>)
            {
                <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r36 rd" class="r36 r">sb</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r36 r">sb</span> = <span class="r28 r">scriptCommandInfo</span>.<a href="../engine/CommandInfo.cs.html#753af6705016f48b" class="i property">ScriptBlock</a>;
                }
                <b>catch</b> (<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>)
                {
                    <span class="c">// parsing errors should not block searching for help</span>
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r36 r">sb</span> != <b>null</b>)
                {
                    <span class="r24 r">helpFile</span> = <b>null</b>;
                    <span class="c">// searchOnlyContent == true means get-help is looking into the content, in this case we dont</span>
                    <span class="c">// want to download the content from the remote machine. Reason: In Exchange scenario there</span>
                    <span class="c">// are ~700 proxy commands, downloading help for all the commands and searching in that</span>
                    <span class="c">// content takes a lot of time (in the order of 30 minutes) for their scenarios.</span>
                    <span class="r23 r">result</span> = <span class="r36 r">sb</span>.<a href="../engine/runtime/CompiledScriptBlock.cs.html#e66fc4ae4110c000" class="i method">GetHelpInfo</a>(<a href="#13186a061a029685" class="i field">_context</a>, <span class="r20 r">commandInfo</span>, <span class="r22 r">searchOnlyContent</span>, <a href="HelpProvider.cs.html#892ebe4ed17c7e10" class="i property">HelpSystem</a>.<a href="HelpSystem.cs.html#30019aef1c7db903" class="i property">ScriptBlockTokenCache</a>,
                        <b>out</b> <span class="r24 r">helpFile</span>, <b>out</b> <span class="r26 r">helpUriFromDotLink</span>);
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r26 r">helpUriFromDotLink</span>))
                    {
                        <b>try</b>
                        {
                            <span class="i">Uri</span> <span id="r37 rd" class="r37 r">testUri</span> = <b>new</b> <span class="i">Uri</span>(<span class="r26 r">helpUriFromDotLink</span>);
                            <span class="r25 r">helpUri</span> = <span class="r26 r">helpUriFromDotLink</span>;
                        }
                        <b>catch</b> (<span class="i">UriFormatException</span>)
                        {
                            <span class="c">// Do not add if helpUriFromDotLink is not a URI</span>
                        }
                    }
 
                    <b>if</b> (<span class="r23 r">result</span> != <b>null</b>)
                    {
                        <span class="i">Uri</span> <span id="r38 rd" class="r38 r">uri</span> = <span class="r23 r">result</span>.<a href="HelpInfo.cs.html#1199a0f2a1354639" class="i method">GetUriForOnlineHelp</a>();
 
                        <b>if</b> (<span class="r38 r">uri</span> != <b>null</b>)
                        {
                            <span class="r25 r">helpUri</span> = <span class="r38 r">uri</span>.<span class="i">ToString</span>();
                        }
                    }
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">helpFile</span>) &amp;&amp; !<a href="../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../engine/Utils.cs.html#1ac48e16298071ba" class="i field">BypassOnlineHelpRetrieval</a>)
                    {
                        <b>if</b> (!<a href="#13186854eb95e0df" class="i field">_helpFiles</a>.<span class="i">Contains</span>(<span class="r24 r">helpFile</span>))
                        {
                            <a href="#6951655a0344bd4a" class="i method">LoadHelpFile</a>(<span class="r24 r">helpFile</span>, <span class="r24 r">helpFile</span>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r21 r">reportErrors</span>);
                        }
 
                        <span class="r23 r">result</span> = <a href="#97797843daa5dde7" class="i method">GetFromCommandCache</a>(<span class="r24 r">helpFile</span>, <span class="r20 r">commandInfo</span>) ?? <span class="r23 r">result</span>;
                    }
                }
            }
 
            <span class="c">// If the above fails to get help, try search for a file called &lt;ModuleName&gt;-Help.xml</span>
            <span class="c">// in the appropriate UI culture subfolder of ModuleBase, and retrieve help</span>
            <span class="c">// If still not able to get help, try search for a file called &lt;NestedModuleName&gt;-Help.xml</span>
            <span class="c">// under the ModuleBase and the NestedModule&#39;s directory, and retrieve help</span>
            <b>if</b> (<span class="r23 r">result</span> == <b>null</b> &amp;&amp; !<a href="../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../engine/Utils.cs.html#1ac48e16298071ba" class="i field">BypassOnlineHelpRetrieval</a>)
            {
                <span class="c">// Get the name and ModuleBase directory of the command&#39;s module</span>
                <span class="c">// and the nested module that implements the command</span>
                <a href="#aefd4f754c41618d" class="i method">GetModulePaths</a>(<span class="r20 r">commandInfo</span>, <b>out</b> <span class="r33 r">moduleName</span>, <b>out</b> <span class="r34 r">moduleDir</span>, <b>out</b> <span class="r35 r">nestedModulePath</span>);
 
                <b>var</b> <span id="r39 rd" class="r39 r">userHomeHelpPath</span> = <a href="HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="HelpUtils.cs.html#7fc28a2723390ba9" class="i method">GetUserHomeHelpSearchPath</a>();
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r40 rd" class="r40 r">searchPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;() { <span class="r39 r">userHomeHelpPath</span> };
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r34 r">moduleDir</span>))
                {
                    <span class="r40 r">searchPaths</span>.<span class="i">Add</span>(<span class="r34 r">moduleDir</span>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r39 r">userHomeHelpPath</span>) &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r33 r">moduleName</span>))
                {
                    <span class="r40 r">searchPaths</span>.<span class="i">Add</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="r39 r">userHomeHelpPath</span>, <span class="r33 r">moduleName</span>));
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r33 r">moduleName</span>) &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r34 r">moduleDir</span>))
                {
                    <span class="c">// Search for &lt;ModuleName&gt;-Help.xml under ModuleBase folder</span>
                    <b>string</b> <span id="r41 rd" class="r41 r">helpFileToFind</span> = <span class="r33 r">moduleName</span> + <span class="s">&quot;-Help.xml&quot;</span>;
                    <span class="r23 r">result</span> = <a href="#2eec8ab2feb9cf2f" class="i method">GetHelpInfoFromHelpFile</a>(<span class="r20 r">commandInfo</span>, <span class="r41 r">helpFileToFind</span>, <span class="r40 r">searchPaths</span>, <span class="r21 r">reportErrors</span>, <b>out</b> <span class="r24 r">helpFile</span>);
                }
 
                <b>if</b> (<span class="r23 r">result</span> == <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r35 r">nestedModulePath</span>))
                {
                    <span class="c">// Search for &lt;NestedModuleName&gt;-Help.xml under both ModuleBase and NestedModule&#39;s directory</span>
                    <span class="r40 r">searchPaths</span>.<span class="i">Add</span>(<span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r35 r">nestedModulePath</span>));
                    <b>string</b> <span id="r42 rd" class="r42 r">helpFileToFind</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r35 r">nestedModulePath</span>) + <span class="s">&quot;-Help.xml&quot;</span>;
                    <span class="r23 r">result</span> = <a href="#2eec8ab2feb9cf2f" class="i method">GetHelpInfoFromHelpFile</a>(<span class="r20 r">commandInfo</span>, <span class="r42 r">helpFileToFind</span>, <span class="r40 r">searchPaths</span>, <span class="r21 r">reportErrors</span>, <b>out</b> <span class="r24 r">helpFile</span>);
                }
            }
 
            <span class="c">// Set the HelpFile property to the file that contains the help content</span>
            <b>if</b> (<span class="r23 r">result</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">helpFile</span>))
            {
                <b>if</b> (<span class="r30 r">isCmdlet</span>)
                {
                    <span class="r27 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#fc12c9efb2e4abe1" class="i property">HelpFile</a> = <span class="r24 r">helpFile</span>;
                }
                <b>else</b> <b>if</b> (<span class="r32 r">isFunction</span>)
                {
                    <span class="r29 r">functionInfo</span>.<a href="../engine/FunctionInfo.cs.html#55416eb2023dc979" class="i property">HelpFile</a> = <span class="r24 r">helpFile</span>;
                }
            }
 
            <span class="c">// If the above fails to get help, construct an HelpInfo object using the syntax and definition of the command</span>
            <b>if</b> (<span class="r23 r">result</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a> == <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a> ||
                    <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a> == <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#8324208f5ee6d431" class="i field">Script</a>)
                {
                    <span class="r23 r">result</span> = <a href="SyntaxHelpInfo.cs.html#8db9be8eada09733" class="t t">SyntaxHelpInfo</a>.<a href="SyntaxHelpInfo.cs.html#1fa3abc2f059d1c2" class="i method">GetHelpInfo</a>(<span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#dadfecc65f9b7a31" class="i property">Syntax</a>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>);
                }
                <b>else</b>
                {
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r43 rd" class="r43 r">helpInfo</span> = <span class="i n">Help</span>.<a href="DefaultCommandHelpObjectBuilder.cs.html#bbd0f41005b5ed8b" class="t t">DefaultCommandHelpObjectBuilder</a>.<a href="DefaultCommandHelpObjectBuilder.cs.html#c1e1fa6d63b93449" class="i method">GetPSObjectFromCmdletInfo</a>(<span class="r20 r">commandInfo</span>);
 
                    <span class="r43 r">helpInfo</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
                    <span class="r43 r">helpInfo</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<a href="DefaultCommandHelpObjectBuilder.cs.html#bbd0f41005b5ed8b" class="t t">DefaultCommandHelpObjectBuilder</a>.<a href="DefaultCommandHelpObjectBuilder.cs.html#cc9aa54ba986945f" class="i field">TypeNameForDefaultHelp</a>);
                    <span class="r43 r">helpInfo</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;CmdletHelpInfo&quot;</span>);
                    <span class="r43 r">helpInfo</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;HelpInfo&quot;</span>);
 
                    <span class="r23 r">result</span> = <b>new</b> <a href="MamlCommandHelpInfo.cs.html#afc833db8ea9ec64" class="t constructor">MamlCommandHelpInfo</a>(<span class="r43 r">helpInfo</span>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>);
                }
            }
 
            <b>if</b> (<span class="r23 r">result</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r31 r">isScriptCommand</span> &amp;&amp; <span class="r23 r">result</span>.<a href="HelpInfo.cs.html#1199a0f2a1354639" class="i method">GetUriForOnlineHelp</a>() == <b>null</b>)
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>))
                    {
                        <a href="DefaultCommandHelpObjectBuilder.cs.html#bbd0f41005b5ed8b" class="t t">DefaultCommandHelpObjectBuilder</a>.<a href="DefaultCommandHelpObjectBuilder.cs.html#51f018a84e4066ef" class="i method">AddRelatedLinksProperties</a>(<span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>);
                    }
                    <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r25 r">helpUri</span>))
                    {
                        <a href="DefaultCommandHelpObjectBuilder.cs.html#bbd0f41005b5ed8b" class="t t">DefaultCommandHelpObjectBuilder</a>.<a href="DefaultCommandHelpObjectBuilder.cs.html#51f018a84e4066ef" class="i method">AddRelatedLinksProperties</a>(<span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>, <span class="r25 r">helpUri</span>);
                    }
                }
 
                <b>if</b> (<span class="r30 r">isCmdlet</span> &amp;&amp; <span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;PSSnapIn&quot;</span>] == <b>null</b>)
                {
                    <span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;PSSnapIn&quot;</span>, <span class="r27 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a>));
                }
 
                <b>if</b> (<span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;ModuleName&quot;</span>] == <b>null</b>)
                {
                    <span class="r23 r">result</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;ModuleName&quot;</span>, <span class="r20 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>));
                }
            }
 
            <b>return</b> <span class="r23 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExactMatchHelp implementation for this help provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExactMatchHelp is overridden instead of DoExactMatchHelp to make sure</span>
        <span class="c">///</span><span class="c"> all help item retrieval will go through command discovery. Because each</span>
        <span class="c">///</span><span class="c"> help file can contain multiple help items for different commands. Directly</span>
        <span class="c">///</span><span class="c"> retrieve help cache can result in a invalid command to contain valid</span>
        <span class="c">///</span><span class="c"> help item. Forcing each ExactMatchHelp to go through command discovery</span>
        <span class="c">///</span><span class="c"> will make sure helpInfo for invalid command will not be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="b0f6cffc62d48510" href="../R/b0f6cffc62d48510.html" target="n" data-glyph="74,1" class="i method">ExactMatchHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r44 rd" class="r44 r">helpRequest</span>)
        {
            <b>int</b> <span id="r45 rd" class="r45 r">countHelpInfosFound</span> = 0;
            <b>string</b> <span id="r46 rd" class="r46 r">target</span> = <span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>;
            <span class="c">// this is for avoiding duplicate result from help output.</span>
            <b>var</b> <span id="r47 rd" class="r47 r">allHelpNames</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <span id="r48 rd" class="r48 r">searcher</span> = <a href="#e63378c7a0df58af" class="i method">GetCommandSearcherForExactMatch</a>(<span class="r46 r">target</span>, <a href="#13186a061a029685" class="i field">_context</a>);
 
            <b>while</b> (<span class="r48 r">searcher</span>.<a href="../engine/CommandSearcher.cs.html#157d1fe83dcb77a7" class="i method">MoveNext</a>())
            {
                <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r49 rd" class="r49 r">current</span> = ((<span class="i">IEnumerator</span>&lt;<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;)<span class="r48 r">searcher</span>).<span class="i">Current</span>;
 
                <b>if</b> (!<a href="../engine/SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#0e40bae2be4870b9" class="i method">IsVisible</a>(<span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a>, <span class="r49 r">current</span>))
                {
                    <span class="c">// this command is not visible to the user (from CommandOrigin) so</span>
                    <span class="c">// dont show help topic for it.</span>
                    <b>continue</b>;
                }
 
                <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r50 rd" class="r50 r">helpInfo</span> = <a href="#3a1b84732bbbbf69" class="i method">GetHelpInfo</a>(<span class="r49 r">current</span>, <b>true</b>, <b>false</b>);
                <b>string</b> <span id="r51 rd" class="r51 r">helpName</span> = <a href="#54e4f219b709b893" class="i method">GetHelpName</a>(<span class="r49 r">current</span>);
 
                <b>if</b> (<span class="r50 r">helpInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r51 r">helpName</span>))
                {
                    <b>if</b> (<span class="r50 r">helpInfo</span>.<a href="HelpInfo.cs.html#7384a8fe26f7190c" class="i property">ForwardHelpCategory</a> == <span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a> &amp;&amp;
                        <span class="r50 r">helpInfo</span>.<a href="HelpInfo.cs.html#d8d6368e29d423e0" class="i property">ForwardTarget</a>.<span class="i">Equals</span>(<span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">CircularDependencyInHelpForwarding</span>);
                    }
 
                    <b>if</b> (<span class="r47 r">allHelpNames</span>.<span class="i">Contains</span>(<span class="r51 r">helpName</span>))
                        <b>continue</b>;
 
                    <b>if</b> (!<a href="#9657110c59e6479a" class="i method">Match</a>(<span class="r50 r">helpInfo</span>, <span class="r44 r">helpRequest</span>, <span class="r49 r">current</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r45 r">countHelpInfosFound</span>++;
                    <span class="r47 r">allHelpNames</span>.<span class="i">Add</span>(<span class="r51 r">helpName</span>);
                    <b>yield</b> <b>return</b> <span class="r50 r">helpInfo</span>;
 
                    <b>if</b> ((<span class="r45 r">countHelpInfosFound</span> &gt;= <span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a>) &amp;&amp; (<span class="r44 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &gt; 0))
                        <b>yield</b> <b>break</b>;
                }
            }
        }
 
        <b>private static string</b> <a id="e9d4b8d24630b9c1" href="../R/e9d4b8d24630b9c1.html" target="n" data-glyph="76,1" class="i method">GetCmdletAssemblyPath</a>(<a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r52 rd" class="r52 r">cmdletInfo</span>)
        {
            <b>if</b> (<span class="r52 r">cmdletInfo</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (<span class="r52 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>return</b> <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r52 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>.<span class="i">Assembly</span>.<span class="i">Location</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a hashtable to track which help files are loaded already.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This will avoid one help file getting loaded again and again.</span>
        <span class="c">///</span><span class="c"> (Which should not happen unless some commandlet is pointing</span>
        <span class="c">///</span><span class="c"> to a help file that actually doesn&#39;t contain the help for it).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Hashtable</span> <a id="13186854eb95e0df" href="../R/13186854eb95e0df.html" target="n" data-glyph="46,1" class="i field">_helpFiles</a> = <b>new</b> <span class="i">Hashtable</span>();
 
        <b>private string</b> <a id="0e874eedb5ccdf81" href="../R/0e874eedb5ccdf81.html" target="n" data-glyph="76,1" class="i method">GetHelpFile</a>(<b>string</b> <span id="r53 rd" class="r53 r">helpFile</span>, <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r54 rd" class="r54 r">cmdletInfo</span>)
        {
            <b>string</b> <span id="r55 rd" class="r55 r">helpFileToLoad</span> = <span class="r53 r">helpFile</span>;
 
            <span class="c">// Get the mshsnapinfo object for this cmdlet.</span>
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r56 rd" class="r56 r">mshSnapInInfo</span> = <span class="r54 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#0720bba6815e5dab" class="i property">PSSnapIn</a>;
 
            <span class="c">// Search fallback</span>
            <span class="c">// 1. If cmdletInfo.HelpFile is a full path to an existing file, directly load that file</span>
            <span class="c">// 2. If PSSnapInInfo exists, then always look in the application base of the mshsnapin</span>
            <span class="c">// Otherwise,</span>
            <span class="c">//    Look in the default search path and cmdlet assembly path</span>
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r57 rd" class="r57 r">searchPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
            <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="r55 r">helpFileToLoad</span>))
            {
                <span class="r55 r">helpFileToLoad</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r55 r">helpFileToLoad</span>);
 
                <b>if</b> (<span class="r56 r">mshSnapInInfo</span> != <b>null</b>)
                {
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r56 r">mshSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>),
                        <span class="s">&quot;Application Base is null or empty.&quot;</span>);
                    <span class="c">// not minishell case..</span>
                    <span class="c">// we have to search only in the application base for a mshsnapin...</span>
                    <span class="c">// if you create an absolute path for helpfile, then MUIFileSearcher</span>
                    <span class="c">// will look only in that path.</span>
 
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<a href="HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="HelpUtils.cs.html#7fc28a2723390ba9" class="i method">GetUserHomeHelpSearchPath</a>());
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<span class="r56 r">mshSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>);
                }
                <b>else</b> <b>if</b> (<span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>) &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>))
                {
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<a href="HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="HelpUtils.cs.html#e8354a01d3357354" class="i method">GetModuleBaseForUserHelp</a>(<span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>, <span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>));
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<span class="r54 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>);
                }
                <b>else</b>
                {
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<a href="HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="HelpUtils.cs.html#7fc28a2723390ba9" class="i method">GetUserHomeHelpSearchPath</a>());
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<a href="HelpProvider.cs.html#eb6486f58989f2cf" class="i method">GetDefaultShellSearchPath</a>());
                    <span class="r57 r">searchPaths</span>.<span class="i">Add</span>(<a href="#e9d4b8d24630b9c1" class="i method">GetCmdletAssemblyPath</a>(<span class="r54 r">cmdletInfo</span>));
                }
            }
            <b>else</b>
            {
                <span class="r55 r">helpFileToLoad</span> = <span class="i">Path</span>.<span class="i">GetFullPath</span>(<span class="r55 r">helpFileToLoad</span>);
            }
 
            <b>string</b> <span id="r58 rd" class="r58 r">location</span> = <a href="MUIFileSearcher.cs.html#b4d5f2ac8ec9ddb2" class="t t">MUIFileSearcher</a>.<a href="MUIFileSearcher.cs.html#8c1adea116d9b741" class="i method">LocateFile</a>(<span class="r55 r">helpFileToLoad</span>, <span class="r57 r">searchPaths</span>);
 
            <span class="c">// let caller take care of getting help info in a different way</span>
            <span class="c">// like &quot;get-command -syntax&quot;</span>
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">location</span>))
            {
                <a href="#eefc53d940d9f558" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Unable to load file {0}&quot;</span>, <span class="r55 r">helpFileToLoad</span>);
            }
 
            <b>return</b> <span class="r58 r">location</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finds a help file associated with the given cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">cmdletInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="076db389e477f6ac" href="../R/076db389e477f6ac.html" target="n" data-glyph="76,1" class="i method">FindHelpFile</a>(<a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r59 rd" class="r59 r">cmdletInfo</span>)
        {
            <b>if</b> (<a href="../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../engine/Utils.cs.html#1ac48e16298071ba" class="i field">BypassOnlineHelpRetrieval</a>)
            {
                <span class="c">// By returning null, we force get-help to generate a metadata driven help object,</span>
                <span class="c">// which includes a helpUri that points to the fwlink defined in the cmdlet code.</span>
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r59 r">cmdletInfo</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r59 r">cmdletInfo</span>));
            }
 
            <span class="c">// Get the help file name from the cmdlet metadata</span>
            <b>string</b> <span id="r60 rd" class="r60 r">helpFile</span> = <span class="r59 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#fc12c9efb2e4abe1" class="i property">HelpFile</a>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r60 r">helpFile</span>))
            {
                <b>if</b> (<span class="r59 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="../engine/InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../engine/InitialSessionState.cs.html#7c1caf70ca3d20ee" class="i method">IsEngineModule</a>(<span class="r59 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>))
                    {
                        <b>return</b> <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">Combine</span>(<span class="r59 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">Name</span>, <a href="#e5d0c8c3de020b71" class="i field">s_engineModuleHelpFileCache</a>[<span class="r59 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a>.<a href="../engine/Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>]);
                    }
                }
 
                <b>return</b> <span class="r60 r">helpFile</span>;
            }
 
            <span class="c">// This is the path to the help file.</span>
            <b>string</b> <span id="r61 rd" class="r61 r">location</span> = <b>null</b>;
 
            <b>if</b> (<span class="r60 r">helpFile</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.ni.dll-Help.xml&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// For PowerShell on OneCore, we ship Ngen binaries. As a result, the name of the assembly now contains &#39;.ni&#39; on it,</span>
                <span class="c">// e.g., &lt;AssemblyName&gt;.ni.dll as supposed to &lt;AssemblyName&gt;.dll.</span>
 
                <span class="c">// When cmdlet metadata is generated for the &#39;HelpFile&#39; field, we use the name assembly and we append &#39;-Help.xml&#39; to it.</span>
                <span class="c">// Because of this, if the cmdlet is part of an Ngen assembly, then &#39;HelpFile&#39; field will be pointing to a help file which does not exist.</span>
                <span class="c">// If this is the case, we remove &#39;.ni&#39; from the help file name and try again.</span>
                <span class="c">// For example:</span>
                <span class="c">// Ngen assembly name: Microsoft.PowerShell.Commands.Management.ni.dll</span>
                <span class="c">// Cmdlet metadata &#39;HelpFile&#39;: Microsoft.PowerShell.Commands.Management.ni.dll-Help.xml</span>
                <span class="c">// Actual help file name: Microsoft.PowerShell.Commands.Management.dll-Help.xml</span>
 
                <span class="c">// Make sure that the assembly name contains more than &#39;.ni.dll&#39;</span>
                <b>string</b> <span id="r62 rd" class="r62 r">assemblyName</span> = <span class="r60 r">helpFile</span>.<span class="i">Replace</span>(<span class="s">&quot;.ni.dll-Help.xml&quot;</span>, <b>string</b>.<span class="i">Empty</span>);
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r62 r">assemblyName</span>))
                {
                    <span class="c">// In the first try, we remove &#39;.ni&#39; from the assembly name and we attempt to find the corresponding help file.</span>
                    <b>string</b> <span id="r63 rd" class="r63 r">helpFileName</span> = <span class="r59 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#fc12c9efb2e4abe1" class="i property">HelpFile</a>.<span class="i">Replace</span>(<span class="s">&quot;.ni.dll-Help.xml&quot;</span>, <span class="s">&quot;.dll-Help.xml&quot;</span>);
                    <span class="r61 r">location</span> = <a href="#0e874eedb5ccdf81" class="i method">GetHelpFile</a>(<span class="r63 r">helpFileName</span>, <span class="r59 r">cmdletInfo</span>);
 
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">location</span>))
                    {
                        <span class="c">// If the help file could not be found, then it is possible that the actual assembly name is something like</span>
                        <span class="c">// &lt;Name&gt;.ni.dll, e.g., MyAssembly.ni.dll, so let&#39;s try to find the original help file in the cmdlet metadata.</span>
                        <span class="r61 r">location</span> = <a href="#0e874eedb5ccdf81" class="i method">GetHelpFile</a>(<span class="r60 r">helpFile</span>, <span class="r59 r">cmdletInfo</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// the assembly name is actually &#39;.ni.dll&#39;.</span>
                    <span class="r61 r">location</span> = <a href="#0e874eedb5ccdf81" class="i method">GetHelpFile</a>(<span class="r60 r">helpFile</span>, <span class="r59 r">cmdletInfo</span>);
                }
            }
            <b>else</b>
            {
                <span class="r61 r">location</span> = <a href="#0e874eedb5ccdf81" class="i method">GetHelpFile</a>(<span class="r60 r">helpFile</span>, <span class="r59 r">cmdletInfo</span>);
            }
 
            <b>return</b> <span class="r61 r">location</span>;
        }
 
        <b>private void</b> <a id="6951655a0344bd4a" href="../R/6951655a0344bd4a.html" target="n" data-glyph="76,1" class="i method">LoadHelpFile</a>(<b>string</b> <span id="r64 rd" class="r64 r">helpFile</span>, <b>string</b> <span id="r65 rd" class="r65 r">helpFileIdentifier</span>, <b>string</b> <span id="r66 rd" class="r66 r">commandName</span>, <b>bool</b> <span id="r67 rd" class="r67 r">reportErrors</span>)
        {
            <span class="i">Exception</span> <span id="r68 rd" class="r68 r">e</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#25805ff65c0dabed" class="i method">LoadHelpFile</a>(<span class="r64 r">helpFile</span>, <span class="r65 r">helpFileIdentifier</span>);
            }
            <b>catch</b> (<span class="i">IOException</span> <span id="r69 rd" class="r69 r">ioException</span>)
            {
                <span class="r68 r">e</span> = <span class="r69 r">ioException</span>;
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span> <span id="r70 rd" class="r70 r">securityException</span>)
            {
                <span class="r68 r">e</span> = <span class="r70 r">securityException</span>;
            }
            <b>catch</b> (<span class="i">XmlException</span> <span id="r71 rd" class="r71 r">xmlException</span>)
            {
                <span class="r68 r">e</span> = <span class="r71 r">xmlException</span>;
            }
            <b>catch</b> (<span class="i">NotSupportedException</span> <span id="r72 rd" class="r72 r">notSupportedException</span>)
            {
                <span class="r68 r">e</span> = <span class="r72 r">notSupportedException</span>;
            }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span> <span id="r73 rd" class="r73 r">unauthorizedAccessException</span>)
            {
                <span class="r68 r">e</span> = <span class="r73 r">unauthorizedAccessException</span>;
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r74 rd" class="r74 r">invalidOperationException</span>)
            {
                <span class="r68 r">e</span> = <span class="r74 r">invalidOperationException</span>;
            }
 
            <b>if</b> (<span class="r67 r">reportErrors</span> &amp;&amp; (<span class="r68 r">e</span> != <b>null</b>))
            {
                <a href="HelpProvider.cs.html#d3f92d7a5e2fe462" class="i method">ReportHelpFileError</a>(<span class="r68 r">e</span>, <span class="r66 r">commandName</span>, <span class="r64 r">helpFile</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Load help file for HelpInfo objects. The HelpInfo objects will be</span>
        <span class="c">///</span><span class="c"> put into help cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. Needs to pay special attention about error handling in this function.</span>
        <span class="c">///</span><span class="c"> Common errors include: file not found and invalid xml. None of these error</span>
        <span class="c">///</span><span class="c"> should cause help search to stop.</span>
        <span class="c">///</span><span class="c"> 2. a helpfile cache is used to avoid same file got loaded again and again.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private void</b> <a id="25805ff65c0dabed" href="../R/25805ff65c0dabed.html" target="n" data-glyph="76,1" class="i method">LoadHelpFile</a>(<b>string</b> <span id="r75 rd" class="r75 r">helpFile</span>, <b>string</b> <span id="r76 rd" class="r76 r">helpFileIdentifier</span>)
        {
            <span class="i">XmlDocument</span> <span id="r77 rd" class="r77 r">doc</span> = <a href="../engine/serialization.cs.html#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="../engine/serialization.cs.html#ee2ec715b80d2059" class="i method">LoadUnsafeXmlDocument</a>(
                <b>new</b> <span class="i">FileInfo</span>(<span class="r75 r">helpFile</span>),
                <b>false</b>, <span class="c">/* ignore whitespace, comments, etc. */</span>
                <b>null</b>); <span class="c">/* default maxCharactersInDocument */</span>
 
            <span class="c">// Add this file into _helpFiles hashtable to prevent it to be loaded again.</span>
            <a href="#13186854eb95e0df" class="i field">_helpFiles</a>[<span class="r75 r">helpFile</span>] = 0;
 
            <span class="i">XmlNode</span> <span id="r78 rd" class="r78 r">helpItemsNode</span> = <b>null</b>;
 
            <b>if</b> (<span class="r77 r">doc</span>.<span class="i">HasChildNodes</span>)
            {
                <b>for</b> (<b>int</b> <span id="r79 rd" class="r79 r">i</span> = 0; <span class="r79 r">i</span> &lt; <span class="r77 r">doc</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span>; <span class="r79 r">i</span>++)
                {
                    <span class="i">XmlNode</span> <span id="r80 rd" class="r80 r">node</span> = <span class="r77 r">doc</span>.<span class="i">ChildNodes</span>[<span class="r79 r">i</span>];
                    <b>if</b> (<span class="r80 r">node</span>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span> &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r80 r">node</span>.<span class="i">LocalName</span>, <span class="s">&quot;helpItems&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r78 r">helpItemsNode</span> = <span class="r80 r">node</span>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r78 r">helpItemsNode</span> == <b>null</b>)
            {
                <a href="#eefc53d940d9f558" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Unable to find &#39;helpItems&#39; element in file {0}&quot;</span>, <span class="r75 r">helpFile</span>);
                <b>return</b>;
            }
 
            <b>bool</b> <span id="r81 rd" class="r81 r">isMaml</span> = <a href="#d04377d4b826550b" class="i method">IsMamlHelp</a>(<span class="r75 r">helpFile</span>, <span class="r78 r">helpItemsNode</span>);
 
            <b>using</b> (<a href="#293d288d50a44dcc" class="k">this</a>.<a href="HelpProvider.cs.html#892ebe4ed17c7e10" class="i property">HelpSystem</a>.<a href="HelpSystem.cs.html#396dc3a6c97f13cf" class="i method">Trace</a>(<span class="r75 r">helpFile</span>))
            {
                <b>if</b> (<span class="r78 r">helpItemsNode</span>.<span class="i">HasChildNodes</span>)
                {
                    <b>for</b> (<b>int</b> <span id="r82 rd" class="r82 r">i</span> = 0; <span class="r82 r">i</span> &lt; <span class="r78 r">helpItemsNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span>; <span class="r82 r">i</span>++)
                    {
                        <span class="i">XmlNode</span> <span id="r83 rd" class="r83 r">node</span> = <span class="r78 r">helpItemsNode</span>.<span class="i">ChildNodes</span>[<span class="r82 r">i</span>];
                        <b>if</b> (<span class="r83 r">node</span>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span> &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r83 r">node</span>.<span class="i">LocalName</span>, <span class="s">&quot;command&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r84 rd" class="r84 r">helpInfo</span> = <b>null</b>;
 
                            <b>if</b> (<span class="r81 r">isMaml</span>)
                            {
                                <span class="r84 r">helpInfo</span> = <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a>.<a href="MamlCommandHelpInfo.cs.html#7ce861fd915e0b8e" class="i method">Load</a>(<span class="r83 r">node</span>, <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a>);
                            }
 
                            <b>if</b> (<span class="r84 r">helpInfo</span> != <b>null</b>)
                            {
                                <a href="#293d288d50a44dcc" class="k">this</a>.<a href="HelpProvider.cs.html#892ebe4ed17c7e10" class="i property">HelpSystem</a>.<a href="HelpSystem.cs.html#4201251702e3040d" class="i method">TraceErrors</a>(<span class="r84 r">helpInfo</span>.<a href="HelpInfo.cs.html#96f0ac6c0dee6ce3" class="i property">Errors</a>);
                                <a href="#24c9333b8ce6956b" class="i method">AddToCommandCache</a>(<span class="r76 r">helpFileIdentifier</span>, <span class="r84 r">helpInfo</span>.<a href="BaseCommandHelpInfo.cs.html#b26bb8edfbc96947" class="i property">Name</a>, <span class="r84 r">helpInfo</span>);
                            }
                        }
 
                        <b>if</b> (<span class="r83 r">node</span>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span> &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r83 r">node</span>.<span class="i">Name</span>, <span class="s">&quot;UserDefinedData&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#8914278532540491" class="t t">UserDefinedHelpData</a> <span id="r85 rd" class="r85 r">userDefinedHelpData</span> = <a href="#8914278532540491" class="t t">UserDefinedHelpData</a>.<a href="#3e54f8c850041590" class="i method">Load</a>(<span class="r83 r">node</span>);
 
                            <a href="#db3ea0c0f644a5e6" class="i method">ProcessUserDefinedHelpData</a>(<span class="r76 r">helpFileIdentifier</span>, <span class="r85 r">userDefinedHelpData</span>);
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process user defined help data by finding the corresponding helpInfo and inserting</span>
        <span class="c">///</span><span class="c"> necessary helpdata info to command help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">mshSnapInId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSSnapIn Name for the current help file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">userDefinedHelpData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="db3ea0c0f644a5e6" href="../R/db3ea0c0f644a5e6.html" target="n" data-glyph="76,1" class="i method">ProcessUserDefinedHelpData</a>(<b>string</b> <span id="r86 rd" class="r86 r">mshSnapInId</span>, <a href="#8914278532540491" class="t t">UserDefinedHelpData</a> <span id="r87 rd" class="r87 r">userDefinedHelpData</span>)
        {
            <b>if</b> (<span class="r87 r">userDefinedHelpData</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r87 r">userDefinedHelpData</span>.<a href="#120c52e9c5362f0c" class="i property">Name</a>))
                <b>return</b>;
 
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r88 rd" class="r88 r">helpInfo</span> = <a href="#a1bc33f65463410f" class="i method">GetFromCommandCache</a>(<span class="r86 r">mshSnapInId</span>, <span class="r87 r">userDefinedHelpData</span>.<a href="#120c52e9c5362f0c" class="i property">Name</a>, <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a>);
 
            <b>if</b> (<span class="r88 r">helpInfo</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (!(<span class="r88 r">helpInfo</span> <b>is</b> <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r89 rd" class="r89 r">commandHelpInfo</span>))
                <b>return</b>;
 
            <span class="r89 r">commandHelpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#ad8b63ce8950741f" class="i method">AddUserDefinedData</a>(<span class="r87 r">userDefinedHelpData</span>);
 
            <b>return</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the HelpInfo object corresponding to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">helpFileIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help file identifier (either name of PSSnapIn or simply full path to help file).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">helpCategory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">HelpInfo object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="a1bc33f65463410f" href="../R/a1bc33f65463410f.html" target="n" data-glyph="76,1" class="i method">GetFromCommandCache</a>(<b>string</b> <span id="r90 rd" class="r90 r">helpFileIdentifier</span>, <b>string</b> <span id="r91 rd" class="r91 r">commandName</span>, <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r92 rd" class="r92 r">helpCategory</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r91 r">commandName</span>), <span class="s">&quot;Cmdlet Name should not be null or empty.&quot;</span>);
 
            <b>string</b> <span id="r93 rd" class="r93 r">key</span> = <span class="r91 r">commandName</span>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r90 r">helpFileIdentifier</span>))
            {
                <span class="r93 r">key</span> = <span class="r90 r">helpFileIdentifier</span> + <span class="s">&quot;\\&quot;</span> + <span class="r93 r">key</span>;
            }
 
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r94 rd" class="r94 r">result</span> = <a href="HelpProviderWithCache.cs.html#5af25209c5aa526c" class="i method">GetCache</a>(<span class="r93 r">key</span>);
 
            <span class="c">// Win8: Win8:477680: When Function/Workflow Use External Help, Category Property is &quot;Cmdlet&quot;</span>
            <b>if</b> ((<span class="r94 r">result</span> != <b>null</b>) &amp;&amp; (<span class="r94 r">result</span>.<a href="HelpInfo.cs.html#1ef71c37a37a1f15" class="i property">HelpCategory</a> != <span class="r92 r">helpCategory</span>))
            {
                <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r95 rd" class="r95 r">original</span> = (<a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a>)<span class="r94 r">result</span>;
                <span class="r94 r">result</span> = <span class="r95 r">original</span>.<a href="MamlCommandHelpInfo.cs.html#da2346c17afa2b7a" class="i method">Copy</a>(<span class="r92 r">helpCategory</span>);
            }
 
            <b>return</b> <span class="r94 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the HelpInfo object corresponding to the CommandInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">helpFileIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help file identifier (simply full path to help file).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">HelpInfo object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="97797843daa5dde7" href="../R/97797843daa5dde7.html" target="n" data-glyph="76,1" class="i method">GetFromCommandCache</a>(<b>string</b> <span id="r96 rd" class="r96 r">helpFileIdentifier</span>, <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r97 rd" class="r97 r">commandInfo</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r97 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;commandInfo cannot be null&quot;</span>);
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r98 rd" class="r98 r">result</span> = <a href="#a1bc33f65463410f" class="i method">GetFromCommandCache</a>(<span class="r96 r">helpFileIdentifier</span>, <span class="r97 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r97 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>);
            <b>if</b> (<span class="r98 r">result</span> == <b>null</b>)
            {
                <span class="c">// check if the command is prefixed and try retrieving help by removing the prefix</span>
                <b>if</b> ((<span class="r97 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>) &amp;&amp; (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r97 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>)))
                {
                    <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r99 rd" class="r99 r">newMamlHelpInfo</span> = <a href="#16e4732b33d7c4d6" class="i method">GetFromCommandCacheByRemovingPrefix</a>(<span class="r96 r">helpFileIdentifier</span>, <span class="r97 r">commandInfo</span>);
                    <b>if</b> (<span class="r99 r">newMamlHelpInfo</span> != <b>null</b>)
                    {
                        <span class="c">// caching the changed help content under the prefixed name for faster</span>
                        <span class="c">// retrieval later.</span>
                        <a href="#24c9333b8ce6956b" class="i method">AddToCommandCache</a>(<span class="r96 r">helpFileIdentifier</span>, <span class="r97 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r99 r">newMamlHelpInfo</span>);
                        <b>return</b> <span class="r99 r">newMamlHelpInfo</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r98 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to get the help for the Cmdlet from cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">cmdletInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> HelpInfo object representing help for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="cfd075762e5c2561" href="../R/cfd075762e5c2561.html" target="n" data-glyph="76,1" class="i method">GetFromCommandCacheOrCmdletInfo</a>(<a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r100 rd" class="r100 r">cmdletInfo</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r100 r">cmdletInfo</span> != <b>null</b>, <span class="s">&quot;cmdletInfo cannot be null&quot;</span>);
            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r101 rd" class="r101 r">result</span> = <a href="#a1bc33f65463410f" class="i method">GetFromCommandCache</a>(<span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r100 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#df15b1b0213102ed" class="i property">HelpCategory</a>);
            <b>if</b> (<span class="r101 r">result</span> == <b>null</b>)
            {
                <span class="c">// check if the command is prefixed and try retrieving help by removing the prefix</span>
                <b>if</b> ((<span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#600591313a158d6c" class="i property">Module</a> != <b>null</b>) &amp;&amp; (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>)))
                {
                    <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r102 rd" class="r102 r">newMamlHelpInfo</span> = <a href="#16e4732b33d7c4d6" class="i method">GetFromCommandCacheByRemovingPrefix</a>(<span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r100 r">cmdletInfo</span>);
 
                    <b>if</b> (<span class="r102 r">newMamlHelpInfo</span> != <b>null</b>)
                    {
                        <span class="c">// Noun exists only for cmdlets...since prefix will change the Noun, updating</span>
                        <span class="c">// the help content accordingly</span>
                        <b>if</b> (<span class="r102 r">newMamlHelpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>] != <b>null</b> &amp;&amp;
                            <span class="r102 r">newMamlHelpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>)
                        {
                            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r103 rd" class="r103 r">commandDetails</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r102 r">newMamlHelpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
                            <b>if</b> (<span class="r103 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Noun&quot;</span>] != <b>null</b>)
                            {
                                <span class="r103 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#52ffbbd5ebd48ac7" class="i method">Remove</a>(<span class="s">&quot;Noun&quot;</span>);
                            }
 
                            <span class="r103 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Noun&quot;</span>, <span class="r100 r">cmdletInfo</span>.<a href="../engine/CmdletInfo.cs.html#00b9559dd9ced386" class="i property">Noun</a>));
                        }
 
                        <span class="c">// caching the changed help content under the prefixed name for faster</span>
                        <span class="c">// retrieval later.</span>
                        <a href="#24c9333b8ce6956b" class="i method">AddToCommandCache</a>(<span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r100 r">cmdletInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r102 r">newMamlHelpInfo</span>);
                        <b>return</b> <span class="r102 r">newMamlHelpInfo</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r101 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to retrieve helpinfo by removing the prefix from the noun portion of a command name.</span>
        <span class="c">///</span><span class="c"> Import-Module and Import-PSSession supports changing the name of a command</span>
        <span class="c">///</span><span class="c"> by suppling a custom prefix. In those cases, the help content is stored by using the</span>
        <span class="c">///</span><span class="c"> original command name (without prefix) as the key.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This method retrieves the help content by suppressing the prefix and then making a copy</span>
        <span class="c">///</span><span class="c"> of the help content + change the name and then returns the copied help content.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">helpIdentifier</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">cmdInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copied help content or null if no help content is found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <a id="16e4732b33d7c4d6" href="../R/16e4732b33d7c4d6.html" target="n" data-glyph="76,1" class="i method">GetFromCommandCacheByRemovingPrefix</a>(<b>string</b> <span id="r104 rd" class="r104 r">helpIdentifier</span>, <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r105 rd" class="r105 r">cmdInfo</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r105 r">cmdInfo</span> != <b>null</b>, <span class="s">&quot;cmdInfo cannot be null&quot;</span>);
 
            <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r106 rd" class="r106 r">result</span> = <b>null</b>;
            <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r107 rd" class="r107 r">originalHelpInfo</span> = <a href="#a1bc33f65463410f" class="i method">GetFromCommandCache</a>(<span class="r104 r">helpIdentifier</span>,
                        <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../engine/Modules/ModuleCmdletBase.cs.html#1b2f60a53340d1d6" class="i method">RemovePrefixFromCommandName</a>(<span class="r105 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r105 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>),
                        <span class="r105 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>) <b>as</b> <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a>;
 
            <b>if</b> (<span class="r107 r">originalHelpInfo</span> != <b>null</b>)
            {
                <span class="r106 r">result</span> = <span class="r107 r">originalHelpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#000b6bcfe9c0b837" class="i method">Copy</a>();
                <span class="c">// command&#39;s name can be changed using -Prefix while importing module.To give better user experience for</span>
                <span class="c">// get-help (on par with get-command), it was decided to use the prefixed command name</span>
                <span class="c">// for the help content.</span>
                <b>if</b> (<span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>] != <b>null</b>)
                {
                    <span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#52ffbbd5ebd48ac7" class="i method">Remove</a>(<span class="s">&quot;Name&quot;</span>);
                }
 
                <span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Name&quot;</span>, <span class="r105 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>));
 
                <b>if</b> (<span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>] != <b>null</b> &amp;&amp;
                    <span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>)
                {
                    <span class="c">// Note we are making a copy of the original instance and updating</span>
                    <span class="c">// it..This is to protect the help content of the original object.</span>
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r108 rd" class="r108 r">commandDetails</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(
                        <span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>).<a href="../engine/MshObject.cs.html#31124c1d85456adb" class="i method">Copy</a>();
 
                    <b>if</b> (<span class="r108 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>] != <b>null</b>)
                    {
                        <span class="r108 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#52ffbbd5ebd48ac7" class="i method">Remove</a>(<span class="s">&quot;Name&quot;</span>);
                    }
 
                    <span class="r108 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Name&quot;</span>, <span class="r105 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>));
 
                    <span class="c">// Note we made the change to a copy..so assigning the copy back to</span>
                    <span class="c">// the help content that is returned to the user.</span>
                    <span class="r106 r">result</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r108 r">commandDetails</span>;
                }
            }
 
            <b>return</b> <span class="r106 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prepends mshsnapin id to the cmdlet name and adds the result to help cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">mshSnapInId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSSnapIn name that this cmdlet belongs to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">cmdletName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the cmdlet.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help object for the cmdlet.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="24c9333b8ce6956b" href="../R/24c9333b8ce6956b.html" target="n" data-glyph="76,1" class="i method">AddToCommandCache</a>(<b>string</b> <span id="r109 rd" class="r109 r">mshSnapInId</span>, <b>string</b> <span id="r110 rd" class="r110 r">cmdletName</span>, <a href="MamlCommandHelpInfo.cs.html#ac118fd2db91ecb8" class="t t">MamlCommandHelpInfo</a> <span id="r111 rd" class="r111 r">helpInfo</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r110 r">cmdletName</span>), <span class="s">&quot;Cmdlet Name should not be null or empty.&quot;</span>);
 
            <b>string</b> <span id="r112 rd" class="r112 r">key</span> = <span class="r110 r">cmdletName</span>;
 
            <span class="c">// Add snapin qualified type name for this command at the top..</span>
            <span class="c">// this will enable customizations of the help object.</span>
            <span class="r111 r">helpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(0, <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                <span class="s">&quot;MamlCommandHelpInfo#{0}#{1}&quot;</span>, <span class="r109 r">mshSnapInId</span>, <span class="r110 r">cmdletName</span>));
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r109 r">mshSnapInId</span>))
            {
                <span class="r112 r">key</span> = <span class="r109 r">mshSnapInId</span> + <span class="s">&quot;\\&quot;</span> + <span class="r112 r">key</span>;
                <span class="c">// Add snapin name to the typenames of this object</span>
                <span class="r111 r">helpInfo</span>.<a href="MamlCommandHelpInfo.cs.html#54021985969b20f8" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(1, <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="s">&quot;MamlCommandHelpInfo#{0}&quot;</span>, <span class="r109 r">mshSnapInId</span>));
            }
 
            <a href="HelpProviderWithCache.cs.html#b8fa9852d6c1e329" class="i method">AddCache</a>(<span class="r112 r">key</span>, <span class="r111 r">helpInfo</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether a HelpItems node indicates that the help content is</span>
        <span class="c">///</span><span class="c"> authored using maml schema.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This covers two cases:</span>
        <span class="c">///</span><span class="c">     a. If the help file has an extension .maml.</span>
        <span class="c">///</span><span class="c">     b. If HelpItems node (which should be the top node of any command help file)</span>
        <span class="c">///</span><span class="c">        has an attribute &quot;schema&quot; with value &quot;maml&quot;, its content is in maml</span>
        <span class="c">///</span><span class="c">        schema.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">helpFile</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">helpItemsNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="d04377d4b826550b" href="../R/d04377d4b826550b.html" target="n" data-glyph="74,1" class="i method">IsMamlHelp</a>(<b>string</b> <span id="r113 rd" class="r113 r">helpFile</span>, <span class="i">XmlNode</span> <span id="r114 rd" class="r114 r">helpItemsNode</span>)
        {
            <b>if</b> (<span class="r113 r">helpFile</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.maml&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<span class="r114 r">helpItemsNode</span>.<span class="i">Attributes</span> == <b>null</b>)
                <b>return</b> <b>false</b>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r115 rd" class="r115 r">attribute</span> <b>in</b> <span class="r114 r">helpItemsNode</span>.<span class="i">Attributes</span>)
            {
                <b>if</b> (<span class="r115 r">attribute</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;schema&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    &amp;&amp; <span class="r115 r">attribute</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;maml&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Search help for a specific target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">searchOnlyContent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, searches for pattern in the help content of all cmdlets.</span>
        <span class="c">///</span><span class="c"> Otherwise, searches for pattern in the cmdlet names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="33186fa21431106c" href="../R/33186fa21431106c.html" target="n" data-glyph="74,1" class="i method">SearchHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r116 rd" class="r116 r">helpRequest</span>, <b>bool</b> <span id="r117 rd" class="r117 r">searchOnlyContent</span>)
        {
            <b>string</b> <span id="r118 rd" class="r118 r">target</span> = <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>;
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r119 rd" class="r119 r">patternList</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <span class="c">// this will be used only when searchOnlyContent == true</span>
            <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r120 rd" class="r120 r">wildCardPattern</span> = <b>null</b>;
            <span class="c">// Decorated Search means that original match target is a target without</span>
            <span class="c">// wildcard patterns. It come here to because exact match was not found</span>
            <span class="c">// and search target will be decorated with wildcard character &#39;*&#39; to</span>
            <span class="c">// search again.</span>
            <b>bool</b> <span id="r121 rd" class="r121 r">decoratedSearch</span> = !<a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>);
 
            <b>if</b> (!<span class="r117 r">searchOnlyContent</span>)
            {
                <b>if</b> (<span class="r121 r">decoratedSearch</span>)
                {
                    <b>if</b> (<span class="r118 r">target</span>.<span class="i">Contains</span>(<a href="../engine/SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../engine/SessionStateStrings.cs.html#54cddae81b4733be" class="i field">CommandVerbNounSeparator</a>))
                    {
                        <span class="r119 r">patternList</span>.<span class="i">Add</span>(<span class="r118 r">target</span> + <span class="s">&quot;*&quot;</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r119 r">patternList</span>.<span class="i">Add</span>(<span class="s">&quot;*&quot;</span> + <span class="r118 r">target</span> + <span class="s">&quot;*&quot;</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="r119 r">patternList</span>.<span class="i">Add</span>(<span class="r118 r">target</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// get help for all cmdlets.</span>
                <span class="r119 r">patternList</span>.<span class="i">Add</span>(<span class="s">&quot;*&quot;</span>);
                <b>string</b> <span id="r122 rd" class="r122 r">searchTarget</span> = <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>;
                <b>if</b> (<span class="r121 r">decoratedSearch</span>)
                {
                    <span class="r122 r">searchTarget</span> = <span class="s">&quot;*&quot;</span> + <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a> + <span class="s">&quot;*&quot;</span>;
                }
 
                <span class="r120 r">wildCardPattern</span> = <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r122 r">searchTarget</span>, <a href="../engine/regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../engine/regex.cs.html#e7978967739ff542" class="i field">Compiled</a> | <a href="../engine/regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../engine/regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            }
 
            <b>int</b> <span id="r123 rd" class="r123 r">countOfHelpInfoObjectsFound</span> = 0;
            <span class="c">// this is for avoiding duplicate result from help output.</span>
            <b>var</b> <span id="r124 rd" class="r124 r">set</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>var</b> <span id="r125 rd" class="r125 r">hiddenCommands</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>string</b> <span id="r126 rd" class="r126 r">pattern</span> <b>in</b> <span class="r119 r">patternList</span>)
            {
                <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <span id="r127 rd" class="r127 r">searcher</span> = <a href="#cd158640af079c66" class="i method">GetCommandSearcherForSearch</a>(<span class="r126 r">pattern</span>, <a href="#13186a061a029685" class="i field">_context</a>);
 
                <b>while</b> (<span class="r127 r">searcher</span>.<a href="../engine/CommandSearcher.cs.html#157d1fe83dcb77a7" class="i method">MoveNext</a>())
                {
                    <b>if</b> (<a href="#13186a061a029685" class="i field">_context</a>.<a href="../engine/ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                    {
                        <b>yield</b> <b>break</b>;
                    }
 
                    <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r128 rd" class="r128 r">current</span> = ((<span class="i">IEnumerator</span>&lt;<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;)<span class="r127 r">searcher</span>).<span class="i">Current</span>;
 
                    <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r129 rd" class="r129 r">helpInfo</span> = <span class="i">GetHelpInfo</span>(<span class="r128 r">current</span>, !<span class="r121 r">decoratedSearch</span>, <span class="r117 r">searchOnlyContent</span>);
                    <b>string</b> <span id="r130 rd" class="r130 r">helpName</span> = <a href="#54e4f219b709b893" class="i method">GetHelpName</a>(<span class="r128 r">current</span>);
 
                    <b>if</b> (<span class="r129 r">helpInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r130 r">helpName</span>))
                    {
                        <b>if</b> (!<a href="../engine/SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#0e40bae2be4870b9" class="i method">IsVisible</a>(<span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a>, <span class="r128 r">current</span>))
                        {
                            <span class="c">// this command is not visible to the user (from CommandOrigin) so</span>
                            <span class="c">// dont show help topic for it.</span>
                            <b>if</b> (!<span class="r125 r">hiddenCommands</span>.<span class="i">Contains</span>(<span class="r130 r">helpName</span>))
                            {
                                <span class="r125 r">hiddenCommands</span>.<span class="i">Add</span>(<span class="r130 r">helpName</span>);
                            }
 
                            <b>continue</b>;
                        }
 
                        <b>if</b> (<span class="r124 r">set</span>.<span class="i">Contains</span>(<span class="r130 r">helpName</span>))
                            <b>continue</b>;
 
                        <span class="c">// filter out the helpInfo object depending on user request</span>
                        <b>if</b> (!<a href="#9657110c59e6479a" class="i method">Match</a>(<span class="r129 r">helpInfo</span>, <span class="r116 r">helpRequest</span>, <span class="r128 r">current</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="c">// Search content</span>
                        <b>if</b> (<span class="r117 r">searchOnlyContent</span> &amp;&amp; (!<span class="r129 r">helpInfo</span>.<a href="HelpInfo.cs.html#30487b4832e23e6a" class="i method">MatchPatternInContent</a>(<span class="r120 r">wildCardPattern</span>)))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="r124 r">set</span>.<span class="i">Add</span>(<span class="r130 r">helpName</span>);
                        <span class="r123 r">countOfHelpInfoObjectsFound</span>++;
                        <b>yield</b> <b>return</b> <span class="r129 r">helpInfo</span>;
 
                        <b>if</b> (<span class="r123 r">countOfHelpInfoObjectsFound</span> &gt;= <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &amp;&amp; <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &gt; 0)
                            <b>yield</b> <b>break</b>;
                    }
                }
 
                <b>if</b> (<a href="#293d288d50a44dcc" class="k">this</a>.<a href="#1e8646d1877ffe83" class="i property">HelpCategory</a> == (<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#a1f331dfd578cfe3" class="i field">Alias</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a>))
                {
                    <b>foreach</b> (<a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r131 rd" class="r131 r">current</span> <b>in</b> <a href="../engine/Modules/ModuleUtils.cs.html#623e3612c4173093" class="t t">ModuleUtils</a>.<a href="../engine/Modules/ModuleUtils.cs.html#c52a8882c52c5570" class="i method">GetMatchingCommands</a>(<span class="r126 r">pattern</span>, <a href="#13186a061a029685" class="i field">_context</a>, <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a>))
                    {
                        <b>if</b> (<a href="#13186a061a029685" class="i field">_context</a>.<a href="../engine/ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                        {
                            <b>yield</b> <b>break</b>;
                        }
 
                        <b>if</b> (!<a href="../engine/SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#0e40bae2be4870b9" class="i method">IsVisible</a>(<span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a>, <span class="r131 r">current</span>))
                        {
                            <span class="c">// this command is not visible to the user (from CommandOrigin) so</span>
                            <span class="c">// dont show help topic for it.</span>
                            <b>continue</b>;
                        }
 
                        <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r132 rd" class="r132 r">helpInfo</span> = <span class="i">GetHelpInfo</span>(<span class="r131 r">current</span>, !<span class="r121 r">decoratedSearch</span>, <span class="r117 r">searchOnlyContent</span>);
                        <b>string</b> <span id="r133 rd" class="r133 r">helpName</span> = <a href="#54e4f219b709b893" class="i method">GetHelpName</a>(<span class="r131 r">current</span>);
 
                        <b>if</b> (<span class="r132 r">helpInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r133 r">helpName</span>))
                        {
                            <b>if</b> (<span class="r124 r">set</span>.<span class="i">Contains</span>(<span class="r133 r">helpName</span>))
                                <b>continue</b>;
 
                            <b>if</b> (<span class="r125 r">hiddenCommands</span>.<span class="i">Contains</span>(<span class="r133 r">helpName</span>))
                                <b>continue</b>;
 
                            <span class="c">// filter out the helpInfo object depending on user request</span>
                            <b>if</b> (!<a href="#9657110c59e6479a" class="i method">Match</a>(<span class="r132 r">helpInfo</span>, <span class="r116 r">helpRequest</span>, <span class="r131 r">current</span>))
                            {
                                <b>continue</b>;
                            }
 
                            <span class="c">// Search content</span>
                            <b>if</b> (<span class="r117 r">searchOnlyContent</span> &amp;&amp; (!<span class="r132 r">helpInfo</span>.<a href="HelpInfo.cs.html#30487b4832e23e6a" class="i method">MatchPatternInContent</a>(<span class="r120 r">wildCardPattern</span>)))
                            {
                                <b>continue</b>;
                            }
 
                            <span class="r124 r">set</span>.<span class="i">Add</span>(<span class="r133 r">helpName</span>);
                            <span class="r123 r">countOfHelpInfoObjectsFound</span>++;
                            <b>yield</b> <b>return</b> <span class="r132 r">helpInfo</span>;
 
                            <b>if</b> (<span class="r123 r">countOfHelpInfoObjectsFound</span> &gt;= <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &amp;&amp; <span class="r116 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &gt; 0)
                                <b>yield</b> <b>break</b>;
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if a helpInfo object matches the component/role/functionality</span>
        <span class="c">///</span><span class="c"> criteria from helpRequest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="9657110c59e6479a" href="../R/9657110c59e6479a.html" target="n" data-glyph="76,1" class="i method">Match</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r134 rd" class="r134 r">helpInfo</span>, <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r135 rd" class="r135 r">helpRequest</span>, <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r136 rd" class="r136 r">commandInfo</span>)
        {
            <b>if</b> (<span class="r135 r">helpRequest</span> == <b>null</b>)
                <b>return</b> <b>true</b>;
 
            <b>if</b> ((<span class="r135 r">helpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a> &amp; <span class="r136 r">commandInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>) == 0)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r134 r">helpInfo</span> <b>is not</b> <a href="BaseCommandHelpInfo.cs.html#f41b1778ad8c8b7f" class="t t">BaseCommandHelpInfo</a>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (!<span class="i">Match</span>(<span class="r134 r">helpInfo</span>.<a href="HelpInfo.cs.html#a97dbc93e494167c" class="i property">Component</a>, <span class="r135 r">helpRequest</span>.<a href="HelpRequest.cs.html#a18e936f9011869b" class="i property">Component</a>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (!<span class="i">Match</span>(<span class="r134 r">helpInfo</span>.<a href="HelpInfo.cs.html#09d2f43bc05c3263" class="i property">Role</a>, <span class="r135 r">helpRequest</span>.<a href="HelpRequest.cs.html#f509e64e40313fa3" class="i property">Role</a>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (!<span class="i">Match</span>(<span class="r134 r">helpInfo</span>.<a href="HelpInfo.cs.html#3c57222fcf922ab5" class="i property">Functionality</a>, <span class="r135 r">helpRequest</span>.<a href="HelpRequest.cs.html#2f01625c790bb86e" class="i property">Functionality</a>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="4db40dd1fd87636b" href="../R/4db40dd1fd87636b.html" target="n" data-glyph="76,1" class="i method">Match</a>(<b>string</b> <span id="r137 rd" class="r137 r">target</span>, <b>string</b> <span id="r138 rd" class="r138 r">pattern</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r138 r">pattern</span>))
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r137 r">target</span>))
                <span class="r137 r">target</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r139 rd" class="r139 r">matcher</span> = <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r138 r">pattern</span>, <a href="../engine/regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../engine/regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>return</b> <span class="r139 r">matcher</span>.<a href="../engine/regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r137 r">target</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">target</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> matches any of the patterns</span>
        <span class="c">///</span><span class="c"> present in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">patterns</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Content to search in.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">patterns</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String patterns to look for.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">target</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains any of the patterns</span>
        <span class="c">///</span><span class="c"> present in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">patterns</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="0f0a638097198c49" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Match</a>(<b>string</b> <span id="r140 rd" class="r140 r">target</span>, <span class="i">ICollection</span>&lt;<b>string</b>&gt; <span id="r141 rd" class="r141 r">patterns</span>)
        {
            <span class="c">// patterns should never be null as shell never accepts</span>
            <span class="c">// empty inputs. Keeping this check as a safe measure.</span>
            <b>if</b> (<span class="r141 r">patterns</span> == <b>null</b> || <span class="r141 r">patterns</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>true</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r142 rd" class="r142 r">pattern</span> <b>in</b> <span class="r141 r">patterns</span>)
            {
                <b>if</b> (<a href="#4db40dd1fd87636b" class="i method">Match</a>(<span class="r140 r">target</span>, <span class="r142 r">pattern</span>))
                {
                    <span class="c">// we have a match so return true</span>
                    <b>return</b> <b>true</b>;
                }
            }
 
            <span class="c">// We dont have a match so far..so return false</span>
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process helpInfo forwarded over from other providers, specificly AliasHelpProvider.</span>
        <span class="c">///</span><span class="c"> This can return more than 1 helpinfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">HelpInfo that is forwarded over.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The result helpInfo objects after processing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="1744282ca431d839" href="../R/1744282ca431d839.html" target="n" data-glyph="74,1" class="i method">ProcessForwardedHelp</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r143 rd" class="r143 r">helpInfo</span>, <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r144 rd" class="r144 r">helpRequest</span>)
        {
            <b>const</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r145 rd" class="r145 r">categoriesHandled</span> = (<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#a1f331dfd578cfe3" class="i field">Alias</a>
                | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#70fbe140cce30289" class="i field">ExternalScript</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#fde1a1e12d52cbf0" class="i field">Filter</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#381b81c9081cf7bc" class="i field">Function</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#0a92357c2fb927c2" class="i field">ScriptCommand</a>);
 
            <b>if</b> ((<span class="r143 r">helpInfo</span>.<a href="HelpInfo.cs.html#1ef71c37a37a1f15" class="i property">HelpCategory</a> &amp; <span class="r145 r">categoriesHandled</span>) != 0)
            {
                <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r146 rd" class="r146 r">commandHelpRequest</span> = <span class="r144 r">helpRequest</span>.<a href="HelpRequest.cs.html#63970c532f23e19f" class="i method">Clone</a>();
                <span class="r146 r">commandHelpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a> = <span class="r143 r">helpInfo</span>.<a href="HelpInfo.cs.html#d8d6368e29d423e0" class="i property">ForwardTarget</a>;
                <span class="r146 r">commandHelpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a> = <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../engine/SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>; <span class="c">// a public command can forward help to a private command</span>
 
                <span class="c">// We may know what category to forward to.  If so, just set it.  If not, look up the</span>
                <span class="c">// command and determine it&#39;s category.  For aliases, we definitely don&#39;t know the category</span>
                <span class="c">// to forward to, so always do the lookup.</span>
                <b>if</b> (<span class="r143 r">helpInfo</span>.<a href="HelpInfo.cs.html#7384a8fe26f7190c" class="i property">ForwardHelpCategory</a> != <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#bffe33d47c20ce20" class="i field">None</a> &amp;&amp; <span class="r143 r">helpInfo</span>.<a href="HelpInfo.cs.html#1ef71c37a37a1f15" class="i property">HelpCategory</a> != <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#a1f331dfd578cfe3" class="i field">Alias</a>)
                {
                    <span class="r146 r">commandHelpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a> = <span class="r143 r">helpInfo</span>.<a href="HelpInfo.cs.html#7384a8fe26f7190c" class="i property">ForwardHelpCategory</a>;
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r147 rd" class="r147 r">targetCommand</span> = <a href="#13186a061a029685" class="i field">_context</a>.<a href="../engine/ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="../engine/CommandDiscovery.cs.html#9e9dd9e6bcc08b40" class="i method">LookupCommandInfo</a>(<span class="r146 r">commandHelpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>);
                        <span class="r146 r">commandHelpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a> = <span class="r147 r">targetCommand</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>;
                    }
                    <b>catch</b> (<a href="../utils/CommandDiscoveryExceptions.cs.html#d61739861b769224" class="t t">CommandNotFoundException</a>)
                    {
                        <span class="c">// ignore errors for aliases pointing to non-existant commands</span>
                    }
                }
 
                <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r148 rd" class="r148 r">helpInfoToReturn</span> <b>in</b> <a href="#b0f6cffc62d48510" class="i method">ExactMatchHelp</a>(<span class="r146 r">commandHelpRequest</span>))
                {
                    <b>yield</b> <b>return</b> <span class="r148 r">helpInfoToReturn</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// command help provider can forward process only an AliasHelpInfo..</span>
                <span class="c">// so returning the original help info here.</span>
                <b>yield</b> <b>return</b> <span class="r143 r">helpInfo</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This will reset the help cache. Normally this corresponds to a</span>
        <span class="c">///</span><span class="c"> help culture change.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="f58a67c96809efcc" href="../R/f58a67c96809efcc.html" target="n" data-glyph="74,1" class="i method">Reset</a>()
        {
            <a href="HelpProviderWithCache.cs.html#0636d0d6fc2b7961" class="k">base</a>.<a href="HelpProviderWithCache.cs.html#9f788f7aeff56931" class="i method">Reset</a>();
 
            <a href="#13186854eb95e0df" class="i field">_helpFiles</a>.<span class="i">Clear</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Extensions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a command searcher used for ExactMatch help lookup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <a id="e63378c7a0df58af" href="../R/e63378c7a0df58af.html" target="n" data-glyph="74,1" class="i method">GetCommandSearcherForExactMatch</a>(<b>string</b> <span id="r149 rd" class="r149 r">commandName</span>, <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r150 rd" class="r150 r">context</span>)
        {
            <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <span id="r151 rd" class="r151 r">searcher</span> = <b>new</b> <a href="../engine/CommandSearcher.cs.html#7c52be99f559c2b3" class="t constructor">CommandSearcher</a>(
                <span class="r149 r">commandName</span>,
                <a href="../engine/CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="../engine/CommandSearcher.cs.html#4a3a990ab3669ccf" class="i field">None</a>,
                <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>,
                <span class="r150 r">context</span>);
 
            <b>return</b> <span class="r151 r">searcher</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a command searcher used for searching help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">pattern</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <a id="cd158640af079c66" href="../R/cd158640af079c66.html" target="n" data-glyph="74,1" class="i method">GetCommandSearcherForSearch</a>(<b>string</b> <span id="r152 rd" class="r152 r">pattern</span>, <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r153 rd" class="r153 r">context</span>)
        {
            <a href="../engine/CommandSearcher.cs.html#b56d4ddadb4e7cd0" class="t t">CommandSearcher</a> <span id="r154 rd" class="r154 r">searcher</span> =
                    <b>new</b> <a href="../engine/CommandSearcher.cs.html#7c52be99f559c2b3" class="t constructor">CommandSearcher</a>(
                        <span class="r152 r">pattern</span>,
                        <a href="../engine/CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="../engine/CommandSearcher.cs.html#038d9150e27f9fdf" class="i field">CommandNameIsPattern</a>,
                        <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>,
                        <span class="r153 r">context</span>);
 
            <b>return</b> <span class="r154 r">searcher</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
 
        [<span class="i">TraceSource</span>(<span class="s">&quot;CommandHelpProvider&quot;</span>, <span class="s">&quot;CommandHelpProvider&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="eefc53d940d9f558" href="../R/eefc53d940d9f558.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;CommandHelpProvider&quot;</span>, <span class="s">&quot;CommandHelpProvider&quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is the class to track the user-defined Help Data which is separate from the</span>
    <span class="c">///</span><span class="c"> commandHelp itself.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Legally, user-defined Help Data should be within the same file as the corresponding</span>
    <span class="c">///</span><span class="c"> commandHelp and it should appear after the commandHelp.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="8914278532540491" href="../R/8914278532540491.html" target="n" data-glyph="2,0" class="t t">UserDefinedHelpData</a>
    {
        <b>private</b> <a id="61efe81fbe3780a4" href="../R/61efe81fbe3780a4.html" target="n" data-glyph="76,1" class="t constructor">UserDefinedHelpData</a>()
        {
        }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="55758c9572a302af" href="../R/55758c9572a302af.html" target="n" data-glyph="104,1" class="i property">Properties</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private string</b> <a id="ad389f40d0fae382" href="../R/ad389f40d0fae382.html" target="n" data-glyph="46,1" class="i field">_name</a> = <b>null</b>;
 
        <b>internal string</b> <a id="120c52e9c5362f0c" href="../R/120c52e9c5362f0c.html" target="n" data-glyph="104,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ad389f40d0fae382" class="i field">_name</a>;
            }
        }
 
        <b>internal static</b> <a href="#8914278532540491" class="t t">UserDefinedHelpData</a> <a id="3e54f8c850041590" href="../R/3e54f8c850041590.html" target="n" data-glyph="74,1" class="i method">Load</a>(<span class="i">XmlNode</span> <span id="r155 rd" class="r155 r">dataNode</span>)
        {
            <b>if</b> (<span class="r155 r">dataNode</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <a href="#8914278532540491" class="t t">UserDefinedHelpData</a> <span id="r156 rd" class="r156 r">userDefinedHelpData</span> = <b>new</b> <a href="#61efe81fbe3780a4" class="t constructor">UserDefinedHelpData</a>();
 
            <b>for</b> (<b>int</b> <span id="r157 rd" class="r157 r">i</span> = 0; <span class="r157 r">i</span> &lt; <span class="r155 r">dataNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span>; <span class="r157 r">i</span>++)
            {
                <span class="i">XmlNode</span> <span id="r158 rd" class="r158 r">node</span> = <span class="r155 r">dataNode</span>.<span class="i">ChildNodes</span>[<span class="r157 r">i</span>];
                <b>if</b> (<span class="r158 r">node</span>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                {
                    <span class="r156 r">userDefinedHelpData</span>.<a href="#55758c9572a302af" class="i property">Properties</a>[<span class="r158 r">node</span>.<span class="i">Name</span>] = <span class="r158 r">node</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>();
                }
            }
 
            <b>string</b> <span id="r159 rd" class="r159 r">name</span>;
            <b>if</b> (!<span class="r156 r">userDefinedHelpData</span>.<a href="#55758c9572a302af" class="i property">Properties</a>.<span class="i">TryGetValue</span>(<span class="s">&quot;name&quot;</span>, <b>out</b> <span class="r159 r">name</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="r156 r">userDefinedHelpData</span>.<a href="#ad389f40d0fae382" class="i field">_name</a> = <span class="r159 r">name</span>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r156 r">userDefinedHelpData</span>.<a href="#120c52e9c5362f0c" class="i property">Name</a>))
                <b>return</b> <b>null</b>;
 
            <b>return</b> <span class="r156 r">userDefinedHelpData</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
