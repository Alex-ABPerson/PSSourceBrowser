<!DOCTYPE html>
<html><head><title>UpdateHelpCommand.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(501);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/UpdateHelpCommand.cs" target="_top">help\UpdateHelpCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Help</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements the Update-Help cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../utils/Verbs.cs.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="../utils/Verbs.cs.html#5890915be1445869" class="i field">Update</a>, <span class="s">&quot;Help&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>,
        <span class="i">SupportsShouldProcess</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096805&quot;</span>)]
    <b>public sealed class</b> <a id="7b2b9f385aa8a162" href="../R/7b2b9f385aa8a162.html" target="n" data-glyph="0,0" class="t t">UpdateHelpCommand</a> : <a href="UpdatableHelpCommandBase.cs.html#79cb20b74e3fc360" class="t t">UpdatableHelpCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="d37eff3243edba98" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">UpdateHelpCommand</a>() : <a href="UpdatableHelpCommandBase.cs.html#0489e45f5e3d3f3b" class="k">base</a>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#2f92978ab0b7f33a" class="i field">UpdateHelpCommand</a>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private bool</b> <a id="48b01f1af32333cb" href="../R/48b01f1af32333cb.html" target="n" data-glyph="46,1" class="i field">_alreadyCheckedOncePerDayPerModule</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the modules to update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Name&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="45a9e3a25c7c4e7d" href="../R/45a9e3a25c7c4e7d.html" target="n" data-glyph="102,1" class="i property">Module</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a3480f2b9a9bbafa" class="i field">_module</a>;
            }
 
            <b>set</b>
            {
                <a href="#a3480f2b9a9bbafa" class="i field">_module</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="a3480f2b9a9bbafa" href="../R/a3480f2b9a9bbafa.html" target="n" data-glyph="46,1" class="i field">_module</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the Module Specifications to update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <a href="../engine/Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[] <a id="2a9dd21c0a242e09" href="../R/2a9dd21c0a242e09.html" target="n" data-glyph="102,1" class="i property">FullyQualifiedModule</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the paths to update from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Path&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="99a02b835d8cedc5" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SourcePath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a6e6ede9db708ec3" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#a6e6ede9db708ec3" class="i field">_path</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="a6e6ede9db708ec3" href="../R/a6e6ede9db708ec3.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the literal path to save updates to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="eec88c2c4b2e42bd" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a6e6ede9db708ec3" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#a6e6ede9db708ec3" class="i field">_path</a> = <b>value</b>;
                <a href="#35e2ebe4069b95a1" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="35e2ebe4069b95a1" href="../R/35e2ebe4069b95a1.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Scans paths recursively.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="35efffc5b8873453" href="../R/35efffc5b8873453.html" target="n" data-glyph="102,1" class="i property">Recurse</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#758642b6630660a9" class="i field">_recurse</a>;
            }
 
            <b>set</b>
            {
                <a href="#758642b6630660a9" class="i field">_recurse</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="758642b6630660a9" href="../R/758642b6630660a9.html" target="n" data-glyph="46,1" class="i field">_recurse</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private bool</b> <a id="a4ad4d6f61f2df5d" href="../R/a4ad4d6f61f2df5d.html" target="n" data-glyph="46,1" class="i field">_isInitialized</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Implementation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Begin processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="a3ee25c2a9668439" href="../R/a3ee25c2a9668439.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (<a href="#a6e6ede9db708ec3" class="i field">_path</a> == <b>null</b>)
            {
                <span class="c">// Pull default source path from GP</span>
                <b>string</b> <span id="r0 rd" class="r0 r">defaultSourcePath</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#2b5a8c37a57e039c" class="i method">GetDefaultSourcePath</a>();
 
                <b>if</b> (<span class="r0 r">defaultSourcePath</span> != <b>null</b>)
                {
                    <a href="#a6e6ede9db708ec3" class="i field">_path</a> = <b>new</b> <b>string</b>[1] { <span class="r0 r">defaultSourcePath</span> };
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Main cmdlet logic.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="869a30883835df24" href="../R/869a30883835df24.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>try</b>
            {
                <span class="c">// Module and FullyQualifiedModule should not be specified at the same time.</span>
                <span class="c">// Throw out terminating error if this is the case.</span>
                <b>if</b> (<a href="#45a9e3a25c7c4e7d" class="i property">Module</a> != <b>null</b> &amp;&amp; <a href="#2a9dd21c0a242e09" class="i property">FullyQualifiedModule</a> != <b>null</b>)
                {
                    <b>string</b> <span id="r1 rd" class="r1 r">errMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">SessionStateStrings</span>.<span class="i">GetContent_TailAndHeadCannotCoexist</span>, <span class="s">&quot;Module&quot;</span>, <span class="s">&quot;FullyQualifiedModule&quot;</span>);
                    <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r2 rd" class="r2 r">error</span> = <b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">InvalidOperationException</span>(<span class="r1 r">errMsg</span>), <span class="s">&quot;ModuleAndFullyQualifiedModuleCannotBeSpecifiedTogether&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <a href="../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r2 r">error</span>);
                }
 
                <b>if</b> (!<a href="#a4ad4d6f61f2df5d" class="i field">_isInitialized</a>)
                {
                    <b>if</b> (<a href="#a6e6ede9db708ec3" class="i field">_path</a> == <b>null</b> &amp;&amp; <a href="#35efffc5b8873453" class="i property">Recurse</a>.<a href="../engine/MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                    {
                        <a href="../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r3 rd" class="r3 r">e</span> = <b>new</b> <a href="../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">CannotSpecifyRecurseWithoutPath</span>));
                        <a href="../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r3 r">e</span>.<a href="../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                    }
 
                    <a href="#a4ad4d6f61f2df5d" class="i field">_isInitialized</a> = <b>true</b>;
                }
 
                <a href="UpdatableHelpCommandBase.cs.html#79cb20b74e3fc360" class="k">base</a>.<span class="i">Process</span>(<a href="#a3480f2b9a9bbafa" class="i field">_module</a>, <a href="#2a9dd21c0a242e09" class="i property">FullyQualifiedModule</a>);
 
                <span class="c">// Reset the per-runspace help cache</span>
                <b>foreach</b> (<a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r4 rd" class="r4 r">provider</span> <b>in</b> <a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../engine/ExecutionContext.cs.html#a86262768086e411" class="i property">HelpSystem</a>.<a href="HelpSystem.cs.html#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>)
                {
                    <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#e5e1815b2bbe03bd" class="i field">_stopping</a>)
                    {
                        <b>break</b>;
                    }
 
                    <span class="r4 r">provider</span>.<a href="HelpProvider.cs.html#48dcb56f654ee03f" class="i method">Reset</a>();
                }
            }
            <b>finally</b>
            {
                <a href="../engine/ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r5 rd" class="r5 r">progress</span> = <b>new</b> <span class="t">ProgressRecord</span>(<a href="UpdatableHelpCommandBase.cs.html#94a0669ad1767b72" class="i field">activityId</a>, <span class="i">HelpDisplayStrings</span>.<span class="i">UpdateProgressActivityForModule</span>, <span class="i">HelpDisplayStrings</span>.<span class="i">UpdateProgressInstalling</span>);
 
                <span class="r5 r">progress</span>.<a href="../engine/ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a> = 100;
                <span class="r5 r">progress</span>.<a href="../engine/ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../engine/ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../engine/ProgressRecord.cs.html#be29e101fe03f5d0" class="i field">Completed</a>;
 
                <a href="../engine/cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r5 r">progress</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process a single module with a given culture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">module</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Module to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">culture</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Culture to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the module has been processed, false if not.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="bb80036665fd472b" href="../R/bb80036665fd472b.html" target="n" data-glyph="74,1" class="i method">ProcessModuleWithCulture</a>(<a href="UpdatableHelpModuleInfo.cs.html#0bb338b0e99e961f" class="t t">UpdatableHelpModuleInfo</a> <span id="r6 rd" class="r6 r">module</span>, <b>string</b> <span id="r7 rd" class="r7 r">culture</span>)
        {
            <a href="UpdatableHelpInfo.cs.html#684ce84072668439" class="t t">UpdatableHelpInfo</a> <span id="r8 rd" class="r8 r">currentHelpInfo</span> = <b>null</b>;
            <a href="UpdatableHelpInfo.cs.html#684ce84072668439" class="t t">UpdatableHelpInfo</a> <span id="r9 rd" class="r9 r">newHelpInfo</span> = <b>null</b>;
            <b>string</b> <span id="r10 rd" class="r10 r">helpInfoUri</span> = <b>null</b>;
 
            <b>string</b> <span id="r11 rd" class="r11 r">moduleBase</span> = <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#2132209225d82256" class="i property">ModuleBase</a>;
 
            <b>if</b> (<a href="#7b2b9f385aa8a162" class="k">this</a>.<a href="UpdatableHelpCommandBase.cs.html#e958d4bed3ac50c9" class="i property">Scope</a> == <a href="UpdatableHelpCommandBase.cs.html#587480438f780046" class="t t">UpdateHelpScope</a>.<a href="UpdatableHelpCommandBase.cs.html#fee0301ec39eec89" class="i field">CurrentUser</a>)
            {
                <span class="r11 r">moduleBase</span> = <a href="HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="HelpUtils.cs.html#e8354a01d3357354" class="i method">GetModuleBaseForUserHelp</a>(<span class="r11 r">moduleBase</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>);
            }
 
            <span class="c">// reading the xml file even if force is specified</span>
            <span class="c">// Reason: we need the current version for ShouldProcess</span>
            <b>string</b> <span id="r12 rd" class="r12 r">xml</span> = <a href="UpdatableHelpSystem.cs.html#ff7dfbcb710dbfc0" class="t t">UpdatableHelpSystem</a>.<a href="UpdatableHelpSystem.cs.html#bd9ab69561594e93" class="i method">LoadStringFromPath</a>(<a href="#7b2b9f385aa8a162" class="k">this</a>,
                 <a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<span class="r11 r">moduleBase</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>()),
                 <b>null</b>);
 
            <b>if</b> (<span class="r12 r">xml</span> != <b>null</b>)
            {
                <span class="c">// constructing the helpinfo object from previous update help log xml..</span>
                <span class="c">// no need to resolve the uri&#39;s in this case.</span>
                <span class="r8 r">currentHelpInfo</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#0ded739dd9a3c366" class="i method">CreateHelpInfo</a>(<span class="r12 r">xml</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>,
                                                             <span class="r13 r">currentCulture</span>: <b>null</b>, <span class="r14 r">pathOverride</span>: <b>null</b>, <span class="r15 r">verbose</span>: <b>false</b>,
                                                             <span class="r16 r">shouldResolveUri</span>: <b>false</b>,
                                                             <span class="c">// ignore validation exception if _force is true</span>
                                                             <span class="r17 r">ignoreValidationException</span>: <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>);
            }
 
            <span class="c">// Don&#39;t update too frequently</span>
            <b>if</b> (!<a href="#48b01f1af32333cb" class="i field">_alreadyCheckedOncePerDayPerModule</a> &amp;&amp; !<span class="i">CheckOncePerDayPerModule</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r11 r">moduleBase</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>(), <span class="i">DateTime</span>.<span class="i">UtcNow</span>, <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <a href="#48b01f1af32333cb" class="i field">_alreadyCheckedOncePerDayPerModule</a> = <b>true</b>;
 
            <b>if</b> (<a href="#a6e6ede9db708ec3" class="i field">_path</a> != <b>null</b>)
            {
                <a href="UpdatableHelpSystem.cs.html#f327345ca73bf3f7" class="t t">UpdatableHelpSystemDrive</a> <span id="r18 rd" class="r18 r">helpInfoDrive</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r19 rd" class="r19 r">resolvedPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
                    <span class="c">// Search for the HelpInfo XML</span>
                    <b>foreach</b> (<b>string</b> <span id="r20 rd" class="r20 r">path</span> <b>in</b> <a href="#a6e6ede9db708ec3" class="i field">_path</a>)
                    {
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r20 r">path</span>))
                        {
                            <a href="../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r21 rd" class="r21 r">e</span> = <b>new</b> <a href="../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathNullOrEmpty</span>));
                            <a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r21 r">e</span>.<a href="../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            <b>return</b> <b>false</b>;
                        }
 
                        <b>try</b>
                        {
                            <b>string</b> <span id="r22 rd" class="r22 r">sourcePath</span> = <span class="r20 r">path</span>;
 
                            <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a> != <b>null</b>)
                            {
                                <a href="UpdatableHelpSystem.cs.html#f327345ca73bf3f7" class="t t">UpdatableHelpSystemDrive</a> <span id="r23 rd" class="r23 r">drive</span> = <b>new</b> <a href="UpdatableHelpSystem.cs.html#5b2e52f1bc7b5c54" class="t constructor">UpdatableHelpSystemDrive</a>(<a href="#7b2b9f385aa8a162" class="k">this</a>, <span class="r20 r">path</span>, <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
                                <span class="r22 r">sourcePath</span> = <span class="r23 r">drive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>;
                            }
 
                            <span class="c">// Expand wildcard characters</span>
                            <b>foreach</b> (<b>string</b> <span id="r24 rd" class="r24 r">tempPath</span> <b>in</b> <a href="UpdatableHelpCommandBase.cs.html#3a6e45bef9b591d0" class="i method">ResolvePath</a>(<span class="r22 r">sourcePath</span>, <a href="#758642b6630660a9" class="i field">_recurse</a>, <a href="#35e2ebe4069b95a1" class="i field">_isLiteralPath</a>))
                            {
                                <span class="r19 r">resolvedPaths</span>.<span class="i">Add</span>(<span class="r24 r">tempPath</span>);
                            }
                        }
                        <b>catch</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/SessionStateExceptions.cs.html#09140e6dc875019b" class="t t">DriveNotFoundException</a> <span id="r25 rd" class="r25 r">e</span>)
                        {
                            <span class="i">ThrowPathMustBeValidContainersException</span>(<span class="r20 r">path</span>, <span class="r25 r">e</span>);
                        }
                        <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a> <span id="r26 rd" class="r26 r">e</span>)
                        {
                            <span class="i">ThrowPathMustBeValidContainersException</span>(<span class="r20 r">path</span>, <span class="r26 r">e</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r19 r">resolvedPaths</span>.<span class="i">Count</span> == 0)
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="c">// Everything in resolvedPaths is a container</span>
                    <b>foreach</b> (<b>string</b> <span id="r27 rd" class="r27 r">resolvedPath</span> <b>in</b> <span class="r19 r">resolvedPaths</span>)
                    {
                        <b>string</b> <span id="r28 rd" class="r28 r">literalPath</span> = <a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<span class="r27 r">resolvedPath</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>());
 
                        <span class="r12 r">xml</span> = <a href="UpdatableHelpSystem.cs.html#ff7dfbcb710dbfc0" class="t t">UpdatableHelpSystem</a>.<a href="UpdatableHelpSystem.cs.html#bd9ab69561594e93" class="i method">LoadStringFromPath</a>(<a href="#7b2b9f385aa8a162" class="k">this</a>, <span class="r28 r">literalPath</span>, <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
 
                        <b>if</b> (<span class="r12 r">xml</span> != <b>null</b>)
                        {
                            <span class="r9 r">newHelpInfo</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#0ded739dd9a3c366" class="i method">CreateHelpInfo</a>(<span class="r12 r">xml</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r7 r">culture</span>, <span class="r27 r">resolvedPath</span>,
                                                                     <span class="r15 r">verbose</span>: <b>false</b>, <span class="r16 r">shouldResolveUri</span>: <b>true</b>, <span class="r17 r">ignoreValidationException</span>: <b>false</b>);
                            <span class="r10 r">helpInfoUri</span> = <span class="r27 r">resolvedPath</span>;
                            <b>break</b>;
                        }
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r29 rd" class="r29 r">e</span>)
                {
                    <b>throw</b> <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;UnableToRetrieveHelpInfoXml&quot;</span>,
                        <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">UnableToRetrieveHelpInfoXml</span>, <span class="r7 r">culture</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#cb0471032395958b" class="i field">ResourceUnavailable</a>,
                        <b>null</b>, <span class="r29 r">e</span>);
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r18 r">helpInfoDrive</span> != <b>null</b>)
                    {
                        <span class="r18 r">helpInfoDrive</span>.<a href="UpdatableHelpSystem.cs.html#1adb22d4df53bf83" class="i method">Dispose</a>();
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">// Form the actual HelpInfo.xml uri</span>
                <span class="r10 r">helpInfoUri</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#b5c02e01b8bcf26c" class="i method">GetHelpInfoUri</a>(<span class="r6 r">module</span>, <b>null</b>).<a href="UpdatableHelpUri.cs.html#6976fa0769b8e72c" class="i property">ResolvedUri</a>;
                <b>string</b> <span id="r30 rd" class="r30 r">uri</span> = <span class="r10 r">helpInfoUri</span> + <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>();
 
                <span class="r9 r">newHelpInfo</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#ea4355c9102de91b" class="i method">GetHelpInfo</a>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#2f92978ab0b7f33a" class="i field">UpdateHelpCommand</a>, <span class="r30 r">uri</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r7 r">culture</span>);
            }
 
            <b>if</b> (<span class="r9 r">newHelpInfo</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;UnableToRetrieveHelpInfoXml&quot;</span>,
                    <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">UnableToRetrieveHelpInfoXml</span>, <span class="r7 r">culture</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#cb0471032395958b" class="i field">ResourceUnavailable</a>,
                    <b>null</b>, <b>null</b>);
            }
 
            <b>bool</b> <span id="r31 rd" class="r31 r">installed</span> = <b>false</b>;
 
            <b>foreach</b> (<a href="UpdatableHelpUri.cs.html#c9285fbfa28e5c83" class="t t">UpdatableHelpUri</a> <span id="r32 rd" class="r32 r">contentUri</span> <b>in</b> <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#5ca12d773273a957" class="i property">HelpContentUriCollection</a>)
            {
                <span class="i">Version</span> <span id="r33 rd" class="r33 r">currentHelpVersion</span> = <span class="r8 r">currentHelpInfo</span>?.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>);
                <b>string</b> <span id="r34 rd" class="r34 r">updateHelpShouldProcessAction</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="i">HelpDisplayStrings</span>.<span class="i">UpdateHelpShouldProcessActionMessage</span>,
                    <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>,
                    (<span class="r33 r">currentHelpVersion</span> != <b>null</b>) ? <span class="r33 r">currentHelpVersion</span>.<span class="i">ToString</span>() : <span class="s">&quot;0.0.0.0&quot;</span>,
                    <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>),
                    <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>);
                <b>if</b> (!<a href="#7b2b9f385aa8a162" class="k">this</a>.<a href="../engine/cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<span class="r34 r">updateHelpShouldProcessAction</span>, <span class="s">&quot;Update-Help&quot;</span>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#5824ed94fc599925" class="i method">IsUnderProductFolder</a>(<span class="r11 r">moduleBase</span>) &amp;&amp; (!<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#7484d766d2be3ec7" class="i method">IsAdministrator</a>()))
                {
                    <b>string</b> <span id="r35 rd" class="r35 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpErrors</span>.<span class="i">UpdatableHelpRequiresElevation</span>);
                    <span class="i">ProcessException</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <b>null</b>, <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;UpdatableHelpSystemRequiresElevation&quot;</span>,
                            <span class="r35 r">message</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>, <b>null</b>));
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (!<a href="UpdatableHelpCommandBase.cs.html#3ad6e24a24a30471" class="i method">IsUpdateNecessary</a>(<span class="r6 r">module</span>, <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a> ? <b>null</b> : <span class="r8 r">currentHelpInfo</span>, <span class="r9 r">newHelpInfo</span>, <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>, <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>))
                {
                    <a href="../engine/cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SuccessfullyUpdatedHelpContent</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="i">HelpDisplayStrings</span>.<span class="i">NewestContentAlreadyInstalled</span>,
                        <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>)));
 
                    <span class="r31 r">installed</span> = <b>true</b>;
                    <b>continue</b>;
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r10 r">helpInfoUri</span> != <b>null</b>, <span class="s">&quot;If we are here, helpInfoUri must not be null&quot;</span>);
 
                        <b>string</b> <span id="r36 rd" class="r36 r">helpContentUri</span> = <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#6976fa0769b8e72c" class="i property">ResolvedUri</a>;
                        <b>string</b> <span id="r37 rd" class="r37 r">xsdPath</span> = <a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#78d6f695d9d21e06" class="i method">GetApplicationBase</a>(<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../engine/ExecutionContext.cs.html#347758c52bbd3a07" class="i property">ShellID</a>), <span class="s">&quot;Schemas\\PSMaml\\maml.xsd&quot;</span>); <span class="c">// TODO: Edit the maml XSDs and change this</span>
 
                        <span class="c">// Gather destination paths</span>
                        <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r38 rd" class="r38 r">destPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
                        <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r11 r">moduleBase</span>))
                        {
                            <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="r11 r">moduleBase</span>);
                        }
 
                        <span class="r38 r">destPaths</span>.<span class="i">Add</span>(<span class="r11 r">moduleBase</span>);
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// Side-By-Side directories are not present in OneCore environments.</span>
<span class="e">                        if (IsSystemModule(module.ModuleName) &amp;&amp; Environment.Is64BitOperatingSystem)
                        {
                            string path = Utils.DefaultPowerShellAppBase.Replace(&quot;System32&quot;, &quot;SysWOW64&quot;);
 
                            destPaths.Add(path);
                        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
                        <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r39 rd" class="r39 r">filesInstalled</span>;
 
                        <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r36 r">helpContentUri</span>))
                        {
                            <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a> != <b>null</b>)
                            {
                                <b>string</b> <span id="r40 rd" class="r40 r">helpContentName</span> = <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#f96e3a6a57050235" class="i method">GetHelpContentName</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>);
                                <b>string</b> <span id="r41 rd" class="r41 r">tempContentPath</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">Path</span>.<span class="i">GetTempPath</span>(), <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="i">Path</span>.<span class="i">GetRandomFileName</span>()));
 
                                <b>try</b>
                                {
                                    <b>using</b> (<a href="UpdatableHelpSystem.cs.html#f327345ca73bf3f7" class="t t">UpdatableHelpSystemDrive</a> <span id="r42 rd" class="r42 r">drive</span> = <b>new</b> <a href="UpdatableHelpSystem.cs.html#5b2e52f1bc7b5c54" class="t constructor">UpdatableHelpSystemDrive</a>(<a href="#7b2b9f385aa8a162" class="k">this</a>, <span class="r36 r">helpContentUri</span>, <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>))
                                    {
                                        <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r41 r">tempContentPath</span>))
                                        {
                                            <span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="r41 r">tempContentPath</span>);
                                        }
 
                                        <a href="../engine/CommandBase.cs.html#0a0ac63de22d06f8" class="i property">InvokeProvider</a>.<a href="../engine/CmdletFamilyProviderInterfaces.cs.html#982f59c2f3f056cc" class="i property">Item</a>.<span class="i">Copy</span>(<b>new</b> <b>string</b>[1] { <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r42 r">drive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>, <span class="r40 r">helpContentName</span>) },
                                            <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r41 r">tempContentPath</span>, <span class="r40 r">helpContentName</span>), <b>false</b>, <a href="../engine/ItemCmdletProviderInterfaces.cs.html#656af2aa3eb70796" class="t t">CopyContainers</a>.<a href="../engine/ItemCmdletProviderInterfaces.cs.html#7dd07e68b5d7556d" class="i field">CopyTargetContainer</a>, <b>true</b>, <b>true</b>);
 
                                        <span class="c">// Local</span>
                                        <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<span class="i">InstallHelpContent</span>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#2f92978ab0b7f33a" class="i field">UpdateHelpCommand</a>, <a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>, <span class="r41 r">tempContentPath</span>,
                                            <span class="r38 r">destPaths</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#f96e3a6a57050235" class="i method">GetHelpContentName</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>),
                                            <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">Path</span>.<span class="i">GetTempPath</span>(), <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="i">Path</span>.<span class="i">GetRandomFileName</span>())),
                                            <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>, <span class="r37 r">xsdPath</span>, <b>out</b> <span class="r39 r">filesInstalled</span>);
                                    }
                                }
                                <b>catch</b> (<span class="i">Exception</span> <span id="r43 rd" class="r43 r">e</span>)
                                {
                                    <b>throw</b> <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;HelpContentNotFound&quot;</span>, <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">HelpContentNotFound</span>),
                                        <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#cb0471032395958b" class="i field">ResourceUnavailable</a>, <b>null</b>, <span class="r43 r">e</span>);
                                }
                            }
                            <b>else</b>
                            {
                                <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<span class="i">InstallHelpContent</span>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#2f92978ab0b7f33a" class="i field">UpdateHelpCommand</a>, <a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>, <span class="r36 r">helpContentUri</span>,
                                    <span class="r38 r">destPaths</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#f96e3a6a57050235" class="i method">GetHelpContentName</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>),
                                    <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">Path</span>.<span class="i">GetTempPath</span>(), <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="i">Path</span>.<span class="i">GetRandomFileName</span>())),
                                    <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>, <span class="r37 r">xsdPath</span>, <b>out</b> <span class="r39 r">filesInstalled</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// Remote</span>
 
                            <span class="c">// Download and install help content</span>
                            <b>if</b> (!<a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#9b19225c01a91656" class="i method">DownloadAndInstallHelpContent</a>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#2f92978ab0b7f33a" class="i field">UpdateHelpCommand</a>, <a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>,
                                <span class="r38 r">destPaths</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#f96e3a6a57050235" class="i method">GetHelpContentName</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>), <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>, <span class="r36 r">helpContentUri</span>, <span class="r37 r">xsdPath</span>, <b>out</b> <span class="r39 r">filesInstalled</span>))
                            {
                                <span class="r31 r">installed</span> = <b>false</b>;
                                <b>continue</b>;
                            }
                        }
 
                        <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<span class="i">GenerateHelpInfo</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#22c35f3b68e99815" class="i property">UnresolvedUri</a>, <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>),
                            <span class="r11 r">moduleBase</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>(), <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>);
 
                        <b>foreach</b> (<b>string</b> <span id="r44 rd" class="r44 r">fileInstalled</span> <b>in</b> <span class="r39 r">filesInstalled</span>)
                        {
                            <a href="../engine/cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SuccessfullyUpdatedHelpContent</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>,
                                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">UpdatedHelpContent</span>, <span class="r44 r">fileInstalled</span>), <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>,
                                <span class="r9 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>)));
                        }
 
                        <a href="UpdatableHelpCommandBase.cs.html#f70107b8fca1aac6" class="i method">LogMessage</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">UpdateHelpCompleted</span>));
 
                        <span class="r31 r">installed</span> = <b>true</b>;
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r45 rd" class="r45 r">e</span>)
                    {
                        <span class="i">ProcessException</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r32 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r45 r">e</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r31 r">installed</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throws PathMustBeValidContainers exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="d08762f70f93d878" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ThrowPathMustBeValidContainersException</a>(<b>string</b> <span id="r46 rd" class="r46 r">path</span>, <span class="i">Exception</span> <span id="r47 rd" class="r47 r">e</span>)
        {
            <b>throw</b> <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;PathMustBeValidContainers&quot;</span>,
                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathMustBeValidContainers</span>, <span class="r46 r">path</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                <b>null</b>, <span class="r47 r">e</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
