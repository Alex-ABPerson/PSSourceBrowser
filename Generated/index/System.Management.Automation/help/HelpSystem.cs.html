<!DOCTYPE html>
<html><head><title>HelpSystem.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(927);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/HelpSystem.cs" target="_top">help\HelpSystem.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Monad help is an architecture made up of three layers:</span>
    <span class="c">///</span><span class="c">     1. At the top is get-help commandlet from where help functionality is accessed.</span>
    <span class="c">///</span><span class="c">     2. At the middle is the help system which collects help objects based on user&#39;s request.</span>
    <span class="c">///</span><span class="c">     3. At the bottom are different help providers which provide help contents for different kinds of information requested.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Class HelpSystem implements the middle layer of Monad Help.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> HelpSystem will provide functionalities in following areas,</span>
    <span class="c">///</span><span class="c">     1. Initialization and management of help providers</span>
    <span class="c">///</span><span class="c">     2. Help engine: this will invoke different providers based on user&#39;s request.</span>
    <span class="c">///</span><span class="c">     3. Help API: this is the API HelpSystem provide to get-help commandlet.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Initialization:</span>
    <span class="c">///</span><span class="c">     Initialization of different help providers needs some context information like &quot;ExecutionContext&quot;</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Help engine:</span>
    <span class="c">///</span><span class="c">     By default, HelpInfo will be retrieved in two phases: exact-match phase and search phase.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Exact-match phase: help providers will be called in appropriate order to retrieve HelpInfo.</span>
    <span class="c">///</span><span class="c">         If a match is found, help engine will stop and return the one and only HelpInfo retrieved.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Search phase: all relevant help providers will be called to retrieve HelpInfo. (Order doesn&#39;t</span>
    <span class="c">///</span><span class="c">         matter in this case) Help engine will not stop until all help providers are called.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Behavior of the help engine can be modified based on Help API parameters in the following ways:</span>
    <span class="c">///</span><span class="c">         1. limit the number of HelpInfo to be returned.</span>
    <span class="c">///</span><span class="c">         2. specify which providers will be used.</span>
    <span class="c">///</span><span class="c">         3. general help info returned in case the search target is empty.</span>
    <span class="c">///</span><span class="c">         4. default help info (or hint) returned in case no match is found.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Help API:</span>
    <span class="c">///</span><span class="c">     The Help API is the function to be called by the Get-Help cmdlet.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     The following information shall be provided in Help API parameters:</span>
    <span class="c">///</span><span class="c">         1. search target: (which can be one or multiple strings)</span>
    <span class="c">///</span><span class="c">         2. help type: to limit the type of help to be searched</span>
    <span class="c">///</span><span class="c">         3. included fields: the fields to be included in the help info</span>
    <span class="c">///</span><span class="c">         4. excluded fields: the fields to be excluded in the help info</span>
    <span class="c">///</span><span class="c">         5. max number of results to be returned</span>
    <span class="c">///</span><span class="c">         6. scoring algorithm for help results</span>
    <span class="c">///</span><span class="c">         7. help reason: help can be directly invoked by end user or as a result of</span>
    <span class="c">///</span><span class="c">             some command syntax error.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     [gxie, 7-25-04]: included fields, excluded fields and help reason will be handled in</span>
    <span class="c">///</span><span class="c">         get-help commandlet.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Help API&#39;s are internal. The only way to access help is by</span>
    <span class="c">///</span><span class="c">     invoking the get-help command.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     To support the scenario of multiple monad engines running in one process, each</span>
    <span class="c">///</span><span class="c">     monad engine is required to have its one help system instance.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Currently each ExecutionContext has a help system instance as its member.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Help Providers:</span>
    <span class="c">///</span><span class="c">     The basic contract for help providers is to provide help based on the</span>
    <span class="c">///</span><span class="c">     search target.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     The result of a help provider invocation can be three things:</span>
    <span class="c">///</span><span class="c">         a. Full help info (in case of an exact-match and a single search result)</span>
    <span class="c">///</span><span class="c">         b. Short help info (in case of multiple search results)</span>
    <span class="c">///</span><span class="c">         c. Partial help info (in case of some cmdlet help info, which</span>
    <span class="c">///</span><span class="c">                                 should be supplemented by provider help info)</span>
    <span class="c">///</span><span class="c">         d. Help forwarding info (in the case of an alias, which will return the target</span>
    <span class="c">///</span><span class="c">                                   for the alias)</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Help providers may need to provide functionality in the following two areas:</span>
    <span class="c">///</span><span class="c">         a. caching and indexing to boost performance</span>
    <span class="c">///</span><span class="c">         b. localization.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="c115cfdd76399004" href="../R/c115cfdd76399004.html" target="n" data-glyph="2,0" class="t t">HelpSystem</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for HelpSystem.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Execution context for this help system.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="2ccb51801367eff2" href="../R/2ccb51801367eff2.html" target="n" data-glyph="74,1" class="t constructor">HelpSystem</a>(<a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r0 rd" class="r0 r">context</span>)
        {
            <b>if</b> (<span class="r0 r">context</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;ExecutionContext&quot;</span>);
            }
 
            <a href="#dfabfb22ff9ca1ae" class="i field">_executionContext</a> = <span class="r0 r">context</span>;
 
            <a href="#b69d39c91162fd07" class="i method">Initialize</a>();
        }
 
        <b>private readonly</b> <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="dfabfb22ff9ca1ae" href="../R/dfabfb22ff9ca1ae.html" target="n" data-glyph="46,1" class="i field">_executionContext</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExecutionContext for the help system. Different help providers</span>
        <span class="c">///</span><span class="c"> will depend on this to retrieve session-related information like</span>
        <span class="c">///</span><span class="c"> session state and command discovery objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="a61b4bce06593834" href="../R/a61b4bce06593834.html" target="n" data-glyph="104,1" class="i property">ExecutionContext</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dfabfb22ff9ca1ae" class="i field">_executionContext</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Progress Callback
 
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="#df62d1444da93907" class="t t">HelpProgressEventArgs</a>&gt; <a id="1f6c5eb9e7ece412" href="../R/1f6c5eb9e7ece412.html" target="n" data-glyph="32,1" class="i">OnProgress</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Initialization
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the help system with an execution context. If the execution context</span>
        <span class="c">///</span><span class="c"> matches the execution context of current singleton HelpSystem object, nothing</span>
        <span class="c">///</span><span class="c"> needs to be done. Otherwise, a new singleton HelpSystem object will be created</span>
        <span class="c">///</span><span class="c"> with the new execution context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b69d39c91162fd07" href="../R/b69d39c91162fd07.html" target="n" data-glyph="74,1" class="i method">Initialize</a>()
        {
            <a href="#d784bc7621ccd27c" class="i field">_verboseHelpErrors</a> = <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../engine/LanguagePrimitives.cs.html#7b42a860769a8de5" class="i method">IsTrue</a>(
                <a href="#dfabfb22ff9ca1ae" class="i field">_executionContext</a>.<a href="../engine/ExecutionContext.cs.html#a3916d7c99d7c52e" class="i method">GetVariableValue</a>(<a href="../engine/SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../engine/SpecialVariables.cs.html#bf4012a436d3482e" class="i field">VerboseHelpErrorsVarPath</a>, <b>false</b>));
            <a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a> = <b>new</b> <a href="HelpErrorTracer.cs.html#1120b62340f7f36d" class="t constructor">HelpErrorTracer</a>(<a href="#c115cfdd76399004" class="k">this</a>);
 
            <a href="#a546f9dc754357c3" class="i method">InitializeHelpProviders</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Initialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help API
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get Help API function. This is the basic form of the Help API using help</span>
        <span class="c">///</span><span class="c"> request.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Variants of this function are defined below, which will create help request</span>
        <span class="c">///</span><span class="c"> object on the fly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">HelpRequest object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array of HelpInfo objects</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="194a8c33215a19e7" href="../R/194a8c33215a19e7.html" target="n" data-glyph="74,1" class="i method">GetHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r1 rd" class="r1 r">helpRequest</span>)
        {
            <b>if</b> (<span class="r1 r">helpRequest</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <span class="r1 r">helpRequest</span>.<a href="HelpRequest.cs.html#66167971af8e7510" class="i method">Validate</a>();
 
            <a href="#3d7b37c936508ab3" class="i method">ValidateHelpCulture</a>();
 
            <b>return</b> <a href="#c115cfdd76399004" class="k">this</a>.<a href="#d39726c0fd03487a" class="i method">DoGetHelp</a>(<span class="r1 r">helpRequest</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Help API
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error Handling
 
        <b>private readonly</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="5575db279dc64ec2" href="../R/5575db279dc64ec2.html" target="n" data-glyph="46,1" class="i field">_lastErrors</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for tracking the last set of errors happened during the help</span>
        <span class="c">///</span><span class="c"> search.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="600b66256f838b9f" href="../R/600b66256f838b9f.html" target="n" data-glyph="104,1" class="i property">LastErrors</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5575db279dc64ec2" class="i field">_lastErrors</a>;
            }
        }
 
        <b>private</b> <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="4401813433a22ed9" href="../R/4401813433a22ed9.html" target="n" data-glyph="46,1" class="i field">_lastHelpCategory</a> = <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="#bffe33d47c20ce20" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the help category to search for help for the last command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">help category to search for help</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="87b14dcb18febf2e" href="../R/87b14dcb18febf2e.html" target="n" data-glyph="104,1" class="i property">LastHelpCategory</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4401813433a22ed9" class="i field">_lastHelpCategory</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Configuration
 
        <b>private bool</b> <a id="d784bc7621ccd27c" href="../R/d784bc7621ccd27c.html" target="n" data-glyph="46,1" class="i field">_verboseHelpErrors</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VerboseHelpErrors is used in the case when end users are interested</span>
        <span class="c">///</span><span class="c"> to know all errors that happened during a help search. This property</span>
        <span class="c">///</span><span class="c"> is false by default.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If this property is turned on (by setting session variable &quot;VerboseHelpError&quot;),</span>
        <span class="c">///</span><span class="c"> following two behaviours will be different,</span>
        <span class="c">///</span><span class="c">     a. Help errors will be written to the error pipeline regardless of the situation.</span>
        <span class="c">///</span><span class="c">        (Normally, help errors will be written to error pipeline if there is no</span>
        <span class="c">///</span><span class="c">         help found and there is no wildcard in help search target).</span>
        <span class="c">///</span><span class="c">     b. Some additional warnings, including MAML processing warnings, will be</span>
        <span class="c">///</span><span class="c">        written to the error pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0fd02dc03c5ba574" href="../R/0fd02dc03c5ba574.html" target="n" data-glyph="104,1" class="i property">VerboseHelpErrors</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d784bc7621ccd27c" class="i field">_verboseHelpErrors</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help Engine
 
        <span class="c">// Cache of search paths that are currently active.</span>
        <span class="c">// This will save a lot time when help providers do their searching</span>
        <b>private</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="7d8d08188fc0454d" href="../R/7d8d08188fc0454d.html" target="n" data-glyph="46,1" class="i field">_searchPaths</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the search paths for external snapins/modules that are currently loaded.</span>
        <span class="c">///</span><span class="c"> If the current shell is single-shell-based, then the returned</span>
        <span class="c">///</span><span class="c"> search path contains all the directories of currently active PSSnapIns/modules.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A collection of strings representing locations.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="5a30a2fc0b0df132" href="../R/5a30a2fc0b0df132.html" target="n" data-glyph="74,1" class="i method">GetSearchPaths</a>()
        {
            <span class="c">// return the cache if already present.</span>
            <b>if</b> (<a href="#7d8d08188fc0454d" class="i field">_searchPaths</a> != <b>null</b>)
            {
                <b>return</b> <a href="#7d8d08188fc0454d" class="i field">_searchPaths</a>;
            }
 
            <a href="#7d8d08188fc0454d" class="i field">_searchPaths</a> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
            <span class="c">// add loaded modules paths to the search path</span>
            <b>if</b> (<a href="#a61b4bce06593834" class="i property">ExecutionContext</a>.<a href="../engine/ExecutionContext.cs.html#2d3edf63c7afa4b2" class="i property">Modules</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r2 rd" class="r2 r">loadedModule</span> <b>in</b> <a href="#a61b4bce06593834" class="i property">ExecutionContext</a>.<a href="../engine/ExecutionContext.cs.html#2d3edf63c7afa4b2" class="i property">Modules</a>.<a href="../engine/Modules/ModuleIntrinsics.cs.html#8fc099ef41b05ce8" class="i property">ModuleTable</a>.<span class="i">Values</span>)
                {
                    <b>if</b> (!<a href="#7d8d08188fc0454d" class="i field">_searchPaths</a>.<span class="i">Contains</span>(<span class="r2 r">loadedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>))
                    {
                        <a href="#7d8d08188fc0454d" class="i field">_searchPaths</a>.<span class="i">Add</span>(<span class="r2 r">loadedModule</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>);
                    }
                }
            }
 
            <b>return</b> <a href="#7d8d08188fc0454d" class="i field">_searchPaths</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get help based on the target, help type, etc</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Help engine retrieve help based on following schemes:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">     1. if the help target is empty, get default help</span>
        <span class="c">///</span><span class="c">     2. if the help target is not a search pattern, try to retrieve exact help</span>
        <span class="c">///</span><span class="c">     3. if help target is a search pattern or step 2 returns no helpInfo, try to search for help</span>
        <span class="c">///</span><span class="c">        (Search for pattern in command name followed by pattern match in help content)</span>
        <span class="c">///</span><span class="c">     4. if step 3 returns exactly one helpInfo object, try to retrieve exact help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An array of HelpInfo objects</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="d39726c0fd03487a" href="../R/d39726c0fd03487a.html" target="n" data-glyph="76,1" class="i method">DoGetHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r3 rd" class="r3 r">helpRequest</span>)
        {
            <a href="#5575db279dc64ec2" class="i field">_lastErrors</a>.<span class="i">Clear</span>();
            <span class="c">// Reset SearchPaths</span>
            <a href="#7d8d08188fc0454d" class="i field">_searchPaths</a> = <b>null</b>;
 
            <a href="#4401813433a22ed9" class="i field">_lastHelpCategory</a> = <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>))
            {
                <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r4 rd" class="r4 r">helpInfo</span> = <a href="#ca4e63a5019c1bd6" class="i method">GetDefaultHelp</a>();
 
                <b>if</b> (<span class="r4 r">helpInfo</span> != <b>null</b>)
                {
                    <b>yield</b> <b>return</b> <span class="r4 r">helpInfo</span>;
                }
 
                <b>yield</b> <b>return</b> <b>null</b>;
            }
            <b>else</b>
            {
                <b>bool</b> <span id="r5 rd" class="r5 r">isMatchFound</span> = <b>false</b>;
                <b>if</b> (!<a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>))
                {
                    <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r6 rd" class="r6 r">helpInfo</span> <b>in</b> <a href="#3247bb3cd6900ebc" class="i method">ExactMatchHelp</a>(<span class="r3 r">helpRequest</span>))
                    {
                        <span class="r5 r">isMatchFound</span> = <b>true</b>;
                        <b>yield</b> <b>return</b> <span class="r6 r">helpInfo</span>;
                    }
                }
 
                <b>if</b> (!<span class="r5 r">isMatchFound</span>)
                {
                    <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r7 rd" class="r7 r">helpInfo</span> <b>in</b> <a href="#315f7a424db2a361" class="i method">SearchHelp</a>(<span class="r3 r">helpRequest</span>))
                    {
                        <span class="r5 r">isMatchFound</span> = <b>true</b>;
                        <b>yield</b> <b>return</b> <span class="r7 r">helpInfo</span>;
                    }
 
                    <b>if</b> (!<span class="r5 r">isMatchFound</span>)
                    {
                        <span class="c">// Throwing an exception here may not be the</span>
                        <span class="c">// best thing to do. Instead we can choose to</span>
                        <span class="c">//    a. give a hint</span>
                        <span class="c">//    b. just silently return an empty search result.</span>
                        <span class="c">// Solution:</span>
                        <span class="c">//    If it is an exact help target, throw an exception.</span>
                        <span class="c">//    Otherwise, return empty result set.</span>
                        <b>if</b> (!<a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>) &amp;&amp; <a href="#c115cfdd76399004" class="k">this</a>.<a href="#600b66256f838b9f" class="i property">LastErrors</a>.<span class="i">Count</span> == 0)
                        {
                            <span class="i">Exception</span> <span id="r8 rd" class="r8 r">e</span> = <b>new</b> <a href="HelpNotFoundException.cs.html#5193e181eaedeadb" class="t constructor">HelpNotFoundException</a>(<span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>);
                            <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r9 rd" class="r9 r">errorRecord</span> = <b>new</b> <a href="../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r8 r">e</span>, <span class="s">&quot;HelpNotFound&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#cb0471032395958b" class="i field">ResourceUnavailable</a>, <b>null</b>);
                            <a href="#c115cfdd76399004" class="k">this</a>.<a href="#600b66256f838b9f" class="i property">LastErrors</a>.<span class="i">Add</span>(<span class="r9 r">errorRecord</span>);
                            <b>yield</b> <b>break</b>;
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get help that exactly matches the target.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the helpInfo returned is not complete, we shall forward the</span>
        <span class="c">///</span><span class="c"> helpInfo object to the appropriate help provider for further processing.</span>
        <span class="c">///</span><span class="c"> (this is implemented by ForwardHelp)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">HelpInfo object retrieved (can be null)</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="3247bb3cd6900ebc" href="../R/3247bb3cd6900ebc.html" target="n" data-glyph="74,1" class="i method">ExactMatchHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r10 rd" class="r10 r">helpRequest</span>)
        {
            <b>bool</b> <span id="r11 rd" class="r11 r">isHelpInfoFound</span> = <b>false</b>;
            <b>for</b> (<b>int</b> <span id="r12 rd" class="r12 r">i</span> = 0; <span class="r12 r">i</span> &lt; <a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>.<span class="i">Count</span>; <span class="r12 r">i</span>++)
            {
                <a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r13 rd" class="r13 r">helpProvider</span> = (<a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a>)<a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>[<span class="r12 r">i</span>];
                <b>if</b> ((<span class="r13 r">helpProvider</span>.<a href="HelpProvider.cs.html#26a2af49a838e231" class="i property">HelpCategory</a> &amp; <span class="r10 r">helpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a>) &gt; 0)
                {
                    <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r14 rd" class="r14 r">helpInfo</span> <b>in</b> <span class="r13 r">helpProvider</span>.<a href="HelpProvider.cs.html#b71d5fe748c7c537" class="i method">ExactMatchHelp</a>(<span class="r10 r">helpRequest</span>))
                    {
                        <span class="r11 r">isHelpInfoFound</span> = <b>true</b>;
                        <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r15 rd" class="r15 r">fwdHelpInfo</span> <b>in</b> <a href="#a07b235da5903d1f" class="i method">ForwardHelp</a>(<span class="r14 r">helpInfo</span>, <span class="r10 r">helpRequest</span>))
                        {
                            <b>yield</b> <b>return</b> <span class="r15 r">fwdHelpInfo</span>;
                        }
                    }
                }
 
                <span class="c">// Bug Win7 737383: Win7 RTM shows both function and cmdlet help when there is</span>
                <span class="c">// function and cmdlet with the same name. So, ignoring the ScriptCommandHelpProvider&#39;s</span>
                <span class="c">// results and going to the CommandHelpProvider for further evaluation.</span>
                <b>if</b> (<span class="r11 r">isHelpInfoFound</span> &amp;&amp; <span class="r13 r">helpProvider</span> <b>is not</b> <a href="ScriptCommandHelpProvider.cs.html#c0a90e66f74a14b1" class="t t">ScriptCommandHelpProvider</a>)
                {
                    <span class="c">// once helpInfo found from a provider..no need to traverse other providers.</span>
                    <b>yield</b> <b>break</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Forward help to the help provider with type forwardHelpCategory.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This is used in the following known scenarios so far</span>
        <span class="c">///</span><span class="c">     1. Alias: helpInfo returned by Alias is not what end user needed.</span>
        <span class="c">///</span><span class="c">               The real help can be retrieved from Command help provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Never returns null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">helpInfos is not null or empty.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="a07b235da5903d1f" href="../R/a07b235da5903d1f.html" target="n" data-glyph="76,1" class="i method">ForwardHelp</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r16 rd" class="r16 r">helpInfo</span>, <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r17 rd" class="r17 r">helpRequest</span>)
        {
            <span class="c">// findout if this helpInfo needs to be processed further..</span>
            <b>if</b> (<span class="r16 r">helpInfo</span>.<a href="HelpInfo.cs.html#7384a8fe26f7190c" class="i property">ForwardHelpCategory</a> == <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="#bffe33d47c20ce20" class="i field">None</a> &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r16 r">helpInfo</span>.<a href="HelpInfo.cs.html#d8d6368e29d423e0" class="i property">ForwardTarget</a>))
            {
                <span class="c">// this helpInfo is final...so store this in result</span>
                <span class="c">// and move on..</span>
                <b>yield</b> <b>return</b> <span class="r16 r">helpInfo</span>;
            }
            <b>else</b>
            {
                <span class="c">// Find out a capable provider to process this request...</span>
                <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r18 rd" class="r18 r">forwardHelpCategory</span> = <span class="r16 r">helpInfo</span>.<a href="HelpInfo.cs.html#7384a8fe26f7190c" class="i property">ForwardHelpCategory</a>;
                <b>bool</b> <span id="r19 rd" class="r19 r">isHelpInfoProcessed</span> = <b>false</b>;
                <b>for</b> (<b>int</b> <span id="r20 rd" class="r20 r">i</span> = 0; <span class="r20 r">i</span> &lt; <a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>.<span class="i">Count</span>; <span class="r20 r">i</span>++)
                {
                    <a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r21 rd" class="r21 r">helpProvider</span> = (<a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a>)<a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>[<span class="r20 r">i</span>];
                    <b>if</b> ((<span class="r21 r">helpProvider</span>.<a href="HelpProvider.cs.html#26a2af49a838e231" class="i property">HelpCategory</a> &amp; <span class="r18 r">forwardHelpCategory</span>) != <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="#bffe33d47c20ce20" class="i field">None</a>)
                    {
                        <span class="r19 r">isHelpInfoProcessed</span> = <b>true</b>;
                        <span class="c">// If this help info is processed by this provider already, break</span>
                        <span class="c">// out of the provider loop...</span>
                        <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r22 rd" class="r22 r">fwdResult</span> <b>in</b> <span class="r21 r">helpProvider</span>.<a href="HelpProvider.cs.html#d865e403914e0eea" class="i method">ProcessForwardedHelp</a>(<span class="r16 r">helpInfo</span>, <span class="r17 r">helpRequest</span>))
                        {
                            <span class="c">// Add each helpinfo to our repository</span>
                            <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r23 rd" class="r23 r">fHelpInfo</span> <b>in</b> <a href="#a07b235da5903d1f" class="i method">ForwardHelp</a>(<span class="r22 r">fwdResult</span>, <span class="r17 r">helpRequest</span>))
                            {
                                <b>yield</b> <b>return</b> <span class="r23 r">fHelpInfo</span>;
                            }
 
                            <span class="c">// get out of the provider loop..</span>
                            <b>yield</b> <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (!<span class="r19 r">isHelpInfoProcessed</span>)
                {
                    <span class="c">// we are here because no help provider processed the helpinfo..</span>
                    <span class="c">// so add this to our repository..</span>
                    <b>yield</b> <b>return</b> <span class="r16 r">helpInfo</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the default help info (normally when help target is empty).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <a id="ca4e63a5019c1bd6" href="../R/ca4e63a5019c1bd6.html" target="n" data-glyph="76,1" class="i method">GetDefaultHelp</a>()
        {
            <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r24 rd" class="r24 r">helpRequest</span> = <b>new</b> <a href="HelpRequest.cs.html#70f61dce8491c9d3" class="t constructor">HelpRequest</a>(<span class="s">&quot;default&quot;</span>, <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="#6d7d14ea3c8577b5" class="i field">DefaultHelp</a>);
            <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r25 rd" class="r25 r">helpInfo</span> <b>in</b> <a href="#3247bb3cd6900ebc" class="i method">ExactMatchHelp</a>(<span class="r24 r">helpRequest</span>))
            {
                <span class="c">// return just the first helpInfo object</span>
                <b>return</b> <span class="r25 r">helpInfo</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get help that exactly match the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">helpRequest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help request object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An IEnumerable of HelpInfo object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <a id="315f7a424db2a361" href="../R/315f7a424db2a361.html" target="n" data-glyph="76,1" class="i method">SearchHelp</a>(<a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r26 rd" class="r26 r">helpRequest</span>)
        {
            <b>int</b> <span id="r27 rd" class="r27 r">countOfHelpInfosFound</span> = 0;
            <b>bool</b> <span id="r28 rd" class="r28 r">searchInHelpContent</span> = <b>false</b>;
            <b>bool</b> <span id="r29 rd" class="r29 r">shouldBreak</span> = <b>false</b>;
 
            <a href="#df62d1444da93907" class="t t">HelpProgressEventArgs</a> <span id="r30 rd" class="r30 r">progress</span> = <b>new</b> <span class="t">HelpProgressEventArgs</span>();
 
            <span class="r30 r">progress</span>.<a href="#1cded888b4ea7c94" class="i property">Activity</a> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SearchingForHelpContent</span>, <span class="r26 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>);
            <span class="r30 r">progress</span>.<a href="#c15feb2b612a055e" class="i property">Completed</a> = <b>false</b>;
            <span class="r30 r">progress</span>.<a href="#7e44d9a1b1953125" class="i property">PercentComplete</a> = 0;
 
            <b>try</b>
            {
                <a href="#1f6c5eb9e7ece412" class="i">OnProgress</a>(<a href="#c115cfdd76399004" class="k">this</a>, <span class="r30 r">progress</span>);
 
                <span class="c">// algorithm:</span>
                <span class="c">// 1. Search for pattern (helpRequest.Target) in command name</span>
                <span class="c">// 2. If Step 1 fails then search for pattern in help content</span>
                <b>do</b>
                {
                    <span class="c">// we should not continue the search loop if we are</span>
                    <span class="c">// searching in the help content (as this is the last step</span>
                    <span class="c">// in our search algorithm).</span>
                    <b>if</b> (<span class="r28 r">searchInHelpContent</span>)
                    {
                        <span class="r29 r">shouldBreak</span> = <b>true</b>;
                    }
 
                    <b>for</b> (<b>int</b> <span id="r31 rd" class="r31 r">i</span> = 0; <span class="r31 r">i</span> &lt; <a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>.<span class="i">Count</span>; <span class="r31 r">i</span>++)
                    {
                        <a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r32 rd" class="r32 r">helpProvider</span> = (<a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a>)<a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>[<span class="r31 r">i</span>];
                        <b>if</b> ((<span class="r32 r">helpProvider</span>.<a href="HelpProvider.cs.html#26a2af49a838e231" class="i property">HelpCategory</a> &amp; <span class="r26 r">helpRequest</span>.<a href="HelpRequest.cs.html#709f3ba20405b66c" class="i property">HelpCategory</a>) &gt; 0)
                        {
                            <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r33 rd" class="r33 r">helpInfo</span> <b>in</b> <span class="r32 r">helpProvider</span>.<a href="HelpProvider.cs.html#9fb0dc88330c46af" class="i method">SearchHelp</a>(<span class="r26 r">helpRequest</span>, <span class="r28 r">searchInHelpContent</span>))
                            {
                                <b>if</b> (<a href="#dfabfb22ff9ca1ae" class="i field">_executionContext</a>.<a href="../engine/ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                                {
                                    <b>yield</b> <b>break</b>;
                                }
 
                                <span class="r27 r">countOfHelpInfosFound</span>++;
                                <b>yield</b> <b>return</b> <span class="r33 r">helpInfo</span>;
 
                                <b>if</b> ((<span class="r27 r">countOfHelpInfosFound</span> &gt;= <span class="r26 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a>) &amp;&amp; (<span class="r26 r">helpRequest</span>.<a href="HelpRequest.cs.html#26eaafae9a0d4749" class="i property">MaxResults</a> &gt; 0))
                                {
                                    <b>yield</b> <b>break</b>;
                                }
                            }
                        }
                    }
 
                    <span class="c">// no need to do help content search once we have some help topics</span>
                    <span class="c">// with command name search.</span>
                    <b>if</b> (<span class="r27 r">countOfHelpInfosFound</span> &gt; 0)
                    {
                        <b>yield</b> <b>break</b>;
                    }
 
                    <span class="c">// appears that we did not find any help matching command names..look for</span>
                    <span class="c">// pattern in help content.</span>
                    <span class="r28 r">searchInHelpContent</span> = <b>true</b>;
 
                    <b>if</b> (<a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="r30 r">progress</span>.<a href="#7e44d9a1b1953125" class="i property">PercentComplete</a> += (100 / <a href="#c115cfdd76399004" class="k">this</a>.<a href="#d2a1ecdb6617d5bf" class="i property">HelpProviders</a>.<span class="i">Count</span>);
                        <a href="#1f6c5eb9e7ece412" class="i">OnProgress</a>(<a href="#c115cfdd76399004" class="k">this</a>, <span class="r30 r">progress</span>);
                    }
                } <b>while</b> (!<span class="r29 r">shouldBreak</span>);
            }
            <b>finally</b>
            {
                <span class="r30 r">progress</span>.<a href="#c15feb2b612a055e" class="i property">Completed</a> = <b>true</b>;
                <span class="r30 r">progress</span>.<a href="#7e44d9a1b1953125" class="i property">PercentComplete</a> = 100;
 
                <a href="#1f6c5eb9e7ece412" class="i">OnProgress</a>(<a href="#c115cfdd76399004" class="k">this</a>, <span class="r30 r">progress</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Help Engine
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help Provider Manager
 
        <b>private readonly</b> <span class="i">ArrayList</span> <a id="bc3eb8698277b217" href="../R/bc3eb8698277b217.html" target="n" data-glyph="46,1" class="i field">_helpProviders</a> = <b>new</b> <span class="i">ArrayList</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the list of help providers initialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">a list of help providers</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">ArrayList</span> <a id="d2a1ecdb6617d5bf" href="../R/d2a1ecdb6617d5bf.html" target="n" data-glyph="104,1" class="i property">HelpProviders</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize help providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently we hardcode the sequence of help provider initialization.</span>
        <span class="c">///</span><span class="c"> In the longer run, we probably will load help providers based on some provider catalog. That</span>
        <span class="c">///</span><span class="c"> will allow new providers to be defined by customer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a546f9dc754357c3" href="../R/a546f9dc754357c3.html" target="n" data-glyph="76,1" class="i method">InitializeHelpProviders</a>()
        {
            <a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r34 rd" class="r34 r">helpProvider</span> = <b>null</b>;
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="AliasHelpProvider.cs.html#b4483f441f210b2b" class="t constructor">AliasHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="ScriptCommandHelpProvider.cs.html#96236c9615a278d8" class="t constructor">ScriptCommandHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="CommandHelpProvider.cs.html#844c380086ed3c70" class="t constructor">CommandHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="ProviderHelpProvider.cs.html#d76c35c2e318ade8" class="t constructor">ProviderHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="PSClassHelpProvider.cs.html#00fa372f8238acb9" class="t constructor">PSClassHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="c">/* TH Bug#3141590 - Disable DscResourceHelp for ClientRTM due to perf issue.
#if !CORECLR // TODO:CORECLR Add this back in once we support Get-DscResource
            helpProvider = new DscResourceHelpProvider(this);
            _helpProviders.Add(helpProvider);
#endif
            */</span>
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="HelpFileHelpProvider.cs.html#681f103a0993414f" class="t constructor">HelpFileHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
 
            <span class="r34 r">helpProvider</span> = <b>new</b> <a href="DefaultHelpProvider.cs.html#81242bc6de4cdaf0" class="t constructor">DefaultHelpProvider</a>(<a href="#c115cfdd76399004" class="k">this</a>);
            <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Add</span>(<span class="r34 r">helpProvider</span>);
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">_HelpProviderReflection</span>
<span class="e">
        // Eventually we will publicize the provider api and initialize
        // help providers using reflection. This is not in v1 right now.
        //
        private static HelpProviderInfo[] _providerInfos = new HelpProviderInfo[]
                            { new HelpProviderInfo(string.Empty, &quot;AliasHelpProvider&quot;, HelpCategory.Alias),
                              new HelpProviderInfo(string.Empty, &quot;CommandHelpProvider&quot;, HelpCategory.Command),
                              new HelpProviderInfo(string.Empty, &quot;ProviderHelpProvider&quot;, HelpCategory.Provider),
                              new HelpProviderInfo(string.Empty, &quot;OverviewHelpProvider&quot;, HelpCategory.Overview),
                              new HelpProviderInfo(string.Empty, &quot;GeneralHelpProvider&quot;, HelpCategory.General),
                              new HelpProviderInfo(string.Empty, &quot;FAQHelpProvider&quot;, HelpCategory.FAQ),
                              new HelpProviderInfo(string.Empty, &quot;GlossaryHelpProvider&quot;, HelpCategory.Glossary),
                              new HelpProviderInfo(string.Empty, &quot;HelpFileHelpProvider&quot;, HelpCategory.HelpFile),
                              new HelpProviderInfo(string.Empty, &quot;DefaultHelpHelpProvider&quot;, HelpCategory.DefaultHelp)
                            };
 
        private void InitializeHelpProviders()
        {
            for (int i = 0; i &lt; _providerInfos.Length; i++)
            {
                HelpProvider helpProvider = GetHelpProvider(_providerInfos[i]);
 
                if (helpProvider != null)
                {
                    helpProvider.Initialize(this._executionContext);
                    _helpProviders.Add(helpProvider);
                }
            }
        }
 
        private HelpProvider GetHelpProvider(HelpProviderInfo providerInfo)
        {
            Assembly providerAssembly = null;
 
            if (string.IsNullOrEmpty(providerInfo.AssemblyName))
            {
                providerAssembly = Assembly.GetExecutingAssembly();
            }
            else
            {
                providerAssembly = Assembly.Load(providerInfo.AssemblyName);
            }
 
            try
            {
                if (providerAssembly != null)
                {
                    HelpProvider helpProvider =
                        (HelpProvider)providerAssembly.CreateInstance(providerInfo.ClassName,
                                                                     false, // don&#39;t ignore case
                                                                     BindingFlags.CreateInstance,
                                                                     null, // use default binder
                                                                     null,
                                                                     null, // use current culture
                                                                     null // no special activation attributes
                                                                    );
 
                    return helpProvider;
                }
            }
            catch (TargetInvocationException e)
            {
                System.Console.WriteLine(e.Message);
                if (e.InnerException != null)
                {
                    System.Console.WriteLine(e.InnerException.Message);
                    System.Console.WriteLine(e.InnerException.StackTrace);
                }
            }
 
            return null;
        }
 
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Help Provider Manager
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help Error Tracer
 
        <b>private</b> <a href="HelpErrorTracer.cs.html#12d044fbf5fed7ec" class="t t">HelpErrorTracer</a> <a id="1bde6987ae7c3720" href="../R/1bde6987ae7c3720.html" target="n" data-glyph="46,1" class="i field">_helpErrorTracer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error tracer for this help system.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="HelpErrorTracer.cs.html#12d044fbf5fed7ec" class="t t">HelpErrorTracer</a> <a id="362c3ba0c75ff6e7" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">HelpErrorTracer</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start a trace frame for a help file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">helpFile</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="396dc3a6c97f13cf" href="../R/396dc3a6c97f13cf.html" target="n" data-glyph="74,1" class="i method">Trace</a>(<b>string</b> <span id="r35 rd" class="r35 r">helpFile</span>)
        {
            <b>if</b> (<a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>return</b> <a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a>.<a href="HelpErrorTracer.cs.html#604439e39231686c" class="i method">Trace</a>(<span class="r35 r">helpFile</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trace an error within a help frame, which is tracked by help tracer itself.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="dd8475532f2a942f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceError</a>(<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r36 rd" class="r36 r">errorRecord</span>)
        {
            <b>if</b> (<a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a> == <b>null</b>)
                <b>return</b>;
 
            <a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a>.<a href="HelpErrorTracer.cs.html#b54ff1c6d0edc0bf" class="i method">TraceError</a>(<span class="r36 r">errorRecord</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trace a collection of errors within a help frame, which is tracked by</span>
        <span class="c">///</span><span class="c"> help tracer itself.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">errorRecords</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="4201251702e3040d" href="../R/4201251702e3040d.html" target="n" data-glyph="74,1" class="i method">TraceErrors</a>(<span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r37 rd" class="r37 r">errorRecords</span>)
        {
            <b>if</b> (<a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a> == <b>null</b> || <span class="r37 r">errorRecords</span> == <b>null</b>)
                <b>return</b>;
 
            <a href="#1bde6987ae7c3720" class="i field">_helpErrorTracer</a>.<a href="HelpErrorTracer.cs.html#636051f8cf63ce1a" class="i method">TraceErrors</a>(<span class="r37 r">errorRecords</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help MUI
 
        <b>private</b> <span class="i">CultureInfo</span> <a id="80025d3a6faaf102" href="../R/80025d3a6faaf102.html" target="n" data-glyph="46,1" class="i field">_culture</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Before each help request is serviced, current thread culture will validate</span>
        <span class="c">///</span><span class="c"> against the current culture of help system. If there is a miss match, each</span>
        <span class="c">///</span><span class="c"> help provider will be notified of the culture change.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="3d7b37c936508ab3" href="../R/3d7b37c936508ab3.html" target="n" data-glyph="76,1" class="i method">ValidateHelpCulture</a>()
        {
            <span class="i">CultureInfo</span> <span id="r38 rd" class="r38 r">culture</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>;
 
            <b>if</b> (<a href="#80025d3a6faaf102" class="i field">_culture</a> == <b>null</b>)
            {
                <a href="#80025d3a6faaf102" class="i field">_culture</a> = <span class="r38 r">culture</span>;
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#80025d3a6faaf102" class="i field">_culture</a>.<span class="i">Equals</span>(<span class="r38 r">culture</span>))
            {
                <b>return</b>;
            }
 
            <a href="#80025d3a6faaf102" class="i field">_culture</a> = <span class="r38 r">culture</span>;
            <a href="#358a8f0e7c914f6b" class="i method">ResetHelpProviders</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset help providers providers. This normally corresponds to help culture change.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Normally help providers will remove cached help content to make sure new help</span>
        <span class="c">///</span><span class="c"> requests will be served with content of right culture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="358a8f0e7c914f6b" href="../R/358a8f0e7c914f6b.html" target="n" data-glyph="74,1" class="i method">ResetHelpProviders</a>()
        {
            <b>if</b> (<a href="#bc3eb8698277b217" class="i field">_helpProviders</a> == <b>null</b>)
                <b>return</b>;
 
            <b>for</b> (<b>int</b> <span id="r39 rd" class="r39 r">i</span> = 0; <span class="r39 r">i</span> &lt; <a href="#bc3eb8698277b217" class="i field">_helpProviders</a>.<span class="i">Count</span>; <span class="r39 r">i</span>++)
            {
                <a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a> <span id="r40 rd" class="r40 r">helpProvider</span> = (<a href="HelpProvider.cs.html#bfddbf70cb682144" class="t t">HelpProvider</a>)<a href="#bc3eb8698277b217" class="i field">_helpProviders</a>[<span class="r39 r">i</span>];
 
                <span class="r40 r">helpProvider</span>.<a href="HelpProvider.cs.html#48dcb56f654ee03f" class="i method">Reset</a>();
            }
 
            <b>return</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ScriptBlock Parse Tokens Caching/Clearing Functionality
 
        <b>private readonly</b> <span class="i">Lazy</span>&lt;<span class="i">Dictionary</span>&lt;<a href="../engine/parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>, <a href="../engine/parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt;&gt; <a id="74cfb4bf3bf556de" href="../R/74cfb4bf3bf556de.html" target="n" data-glyph="46,1" class="i field">_scriptBlockTokenCache</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">Dictionary</span>&lt;<a href="../engine/parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>, <a href="../engine/parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt;&gt;(<span class="i">isThreadSafe</span>: <b>true</b>);
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<a href="../engine/parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>, <a href="../engine/parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt; <a id="30019aef1c7db903" href="../R/30019aef1c7db903.html" target="n" data-glyph="104,1" class="i property">ScriptBlockTokenCache</a>
        {
            <b>get</b> { <b>return</b> <a href="#74cfb4bf3bf556de" class="i field">_scriptBlockTokenCache</a>.<span class="i">Value</span>; }
        }
 
        <b>internal void</b> <a id="6809697a2b1ff7fb" href="../R/6809697a2b1ff7fb.html" target="n" data-glyph="74,1" class="i method">ClearScriptBlockTokenCache</a>()
        {
            <b>if</b> (<a href="#74cfb4bf3bf556de" class="i field">_scriptBlockTokenCache</a>.<span class="i">IsValueCreated</span>)
            {
                <a href="#74cfb4bf3bf556de" class="i field">_scriptBlockTokenCache</a>.<span class="i">Value</span>.<span class="i">Clear</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Help progress info.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="df62d1444da93907" href="../R/df62d1444da93907.html" target="n" data-glyph="2,0" class="t t"><span id="8db316651bd30ba5">HelpProgressEventArgs</span></a> : <span class="i">EventArgs</span>
    {
        <b>internal bool</b> <a id="c15feb2b612a055e" href="../R/c15feb2b612a055e.html" target="n" data-glyph="104,1" class="i property">Completed</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal string</b> <a id="1cded888b4ea7c94" href="../R/1cded888b4ea7c94.html" target="n" data-glyph="104,1" class="i property">Activity</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal int</b> <a id="7e44d9a1b1953125" href="../R/7e44d9a1b1953125.html" target="n" data-glyph="104,1" class="i property">PercentComplete</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is the structure to keep track of HelpProvider Info.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="e6546358fbbe9d8a" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">HelpProviderInfo</a>
    {
        <b>internal string</b> <a id="ac4283cb7735ed12" href="../R/ac4283cb7735ed12.html" target="n" data-glyph="44,1" class="i field">AssemblyName</a> = <b>string</b>.<span class="i">Empty</span>;
        <b>internal string</b> <a id="232dfe0f41e43aab" href="../R/232dfe0f41e43aab.html" target="n" data-glyph="44,1" class="i field">ClassName</a> = <b>string</b>.<span class="i">Empty</span>;
        <b>internal</b> <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="8afcc784dfc96c9b" href="../R/8afcc784dfc96c9b.html" target="n" data-glyph="44,1" class="i field">HelpCategory</a> = <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="#bffe33d47c20ce20" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">assemblyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Assembly that contains this help provider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The class that implements this help provider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">helpCategory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Help category of this help provider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="92145b30f9542737" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">HelpProviderInfo</a>(<b>string</b> <span id="r41 rd" class="r41 r">assemblyName</span>, <b>string</b> <span id="r42 rd" class="r42 r">className</span>, <a href="#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r43 rd" class="r43 r">helpCategory</span>)
        {
            <a href="#e6546358fbbe9d8a" class="k">this</a>.<a href="#ac4283cb7735ed12" class="i field">AssemblyName</a> = <span class="r41 r">assemblyName</span>;
            <a href="#e6546358fbbe9d8a" class="k">this</a>.<a href="#232dfe0f41e43aab" class="i field">ClassName</a> = <span class="r42 r">className</span>;
            <a href="#e6546358fbbe9d8a" class="k">this</a>.<a href="#8afcc784dfc96c9b" class="i field">HelpCategory</a> = <span class="r43 r">helpCategory</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Help categories.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="5ad0a796ad0d8ceb" href="../R/5ad0a796ad0d8ceb.html" target="n" data-glyph="20,0" class="t t"><span id="d5fc37f7743fd78f">HelpCategory</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Undefined help category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="bffe33d47c20ce20" href="../R/bffe33d47c20ce20.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Alias help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a1f331dfd578cfe3" href="../R/a1f331dfd578cfe3.html" target="n" data-glyph="24,1" class="i field">Alias</a> = 0x01,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlet help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e963f9f2b0c66907" href="../R/e963f9f2b0c66907.html" target="n" data-glyph="24,1" class="i field">Cmdlet</a> = 0x02,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provider help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="645bba4656668151" href="../R/645bba4656668151.html" target="n" data-glyph="24,1" class="i field">Provider</a> = 0x04,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> General keyword help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8631528eed8537c8" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">General</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FAQ&#39;s.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="37932774512beca8" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">FAQ</a> = 0x20,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Glossary and term definitions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f7fce9080b7aa96f" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Glossary</a> = 0x40,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help that is contained in help file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="03e639448a4d115a" href="../R/03e639448a4d115a.html" target="n" data-glyph="24,1" class="i field">HelpFile</a> = 0x80,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help from a script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="0a92357c2fb927c2" href="../R/0a92357c2fb927c2.html" target="n" data-glyph="24,1" class="i field">ScriptCommand</a> = 0x100,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for a function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="381b81c9081cf7bc" href="../R/381b81c9081cf7bc.html" target="n" data-glyph="24,1" class="i field">Function</a> = 0x200,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for a filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="fde1a1e12d52cbf0" href="../R/fde1a1e12d52cbf0.html" target="n" data-glyph="24,1" class="i field">Filter</a> = 0x400,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for an external script (i.e. for a *.ps1 file)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="70fbe140cce30289" href="../R/70fbe140cce30289.html" target="n" data-glyph="24,1" class="i field">ExternalScript</a> = 0x800,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All help categories.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5d0649f256dff321" href="../R/5d0649f256dff321.html" target="n" data-glyph="24,1" class="i field">All</a> = 0xFFFFF,
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default Help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="6d7d14ea3c8577b5" href="../R/6d7d14ea3c8577b5.html" target="n" data-glyph="24,1" class="i field">DefaultHelp</a> = 0x1000,
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for a Configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="10f71224f93d9c50" href="../R/10f71224f93d9c50.html" target="n" data-glyph="24,1" class="i field">Configuration</a> = 0x4000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for DSC Resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d3751097a49f23ba" href="../R/d3751097a49f23ba.html" target="n" data-glyph="24,1" class="i field">DscResource</a> = 0x8000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help for PS Classes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7bb25d622372bc6c" href="../R/7bb25d622372bc6c.html" target="n" data-glyph="24,1" class="i field">Class</a> = 0x10000
    }
}
</pre></td></tr></table></div></body></html>
