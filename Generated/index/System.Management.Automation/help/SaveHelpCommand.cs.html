<!DOCTYPE html>
<html><head><title>SaveHelpCommand.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(520);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/SaveHelpCommand.cs" target="_top">help\SaveHelpCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Help</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements the Save-Help cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../utils/Verbs.cs.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="../utils/Verbs.cs.html#b3744c3705e95630" class="i field">Save</a>, <span class="s">&quot;Help&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#9a5fcbf4e57fe29a" class="t t">SaveHelpCommand</a>.<a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096794&quot;</span>)]
    <b>public sealed class</b> <a id="9a5fcbf4e57fe29a" href="../R/9a5fcbf4e57fe29a.html" target="n" data-glyph="0,0" class="t t">SaveHelpCommand</a> : <a href="UpdatableHelpCommandBase.cs.html#79cb20b74e3fc360" class="t t">UpdatableHelpCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="aa39e8918ccfeaa8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SaveHelpCommand</a>() : <a href="UpdatableHelpCommandBase.cs.html#0489e45f5e3d3f3b" class="k">base</a>(<a href="UpdatableHelpSystem.cs.html#b7afdb3d5001b455" class="t t">UpdatableHelpCommandType</a>.<a href="UpdatableHelpSystem.cs.html#d908ac21195a9b38" class="i field">SaveHelpCommand</a>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private bool</b> <a id="da899cadf38aaad7" href="../R/da899cadf38aaad7.html" target="n" data-glyph="46,1" class="i field">_alreadyCheckedOncePerDayPerModule</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the paths to save updates to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Path&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="16ddbd9db70ac0bd" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">DestinationPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#21d4e3c14e4f436d" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#21d4e3c14e4f436d" class="i field">_path</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="21d4e3c14e4f436d" href="../R/21d4e3c14e4f436d.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the literal path to save updates to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="4b11aa09b448222b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#21d4e3c14e4f436d" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#21d4e3c14e4f436d" class="i field">_path</a> = <b>value</b>;
                <a href="#f4cbd3627d21799f" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="f4cbd3627d21799f" href="../R/f4cbd3627d21799f.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the modules to update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>)]
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Name&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">ArgumentToModuleTransformationAttribute</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>[] <a id="53abf98bc22b2818" href="../R/53abf98bc22b2818.html" target="n" data-glyph="102,1" class="i property">Module</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the Module Specifications to update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#59cab8195cd20940" class="i field">PathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="UpdatableHelpCommandBase.cs.html#4c8673a047b016e1" class="i field">LiteralPathParameterSetName</a>, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <a href="../engine/Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[] <a id="cc47b7d1d08591d1" href="../R/cc47b7d1d08591d1.html" target="n" data-glyph="102,1" class="i property">FullyQualifiedModule</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Implementation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5e77b92162baeda5" href="../R/5e77b92162baeda5.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>try</b>
            {
                <span class="c">// Module and FullyQualifiedModule should not be specified at the same time.</span>
                <span class="c">// Throw out terminating error if this is the case.</span>
                <b>if</b> (<a href="#53abf98bc22b2818" class="i property">Module</a> != <b>null</b> &amp;&amp; <a href="#cc47b7d1d08591d1" class="i property">FullyQualifiedModule</a> != <b>null</b>)
                {
                    <b>string</b> <span id="r0 rd" class="r0 r">errMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">SessionStateStrings</span>.<span class="i">GetContent_TailAndHeadCannotCoexist</span>, <span class="s">&quot;Module&quot;</span>, <span class="s">&quot;FullyQualifiedModule&quot;</span>);
                    <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r1 rd" class="r1 r">error</span> = <b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">InvalidOperationException</span>(<span class="r0 r">errMsg</span>), <span class="s">&quot;ModuleAndFullyQualifiedModuleCannotBeSpecifiedTogether&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <a href="../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r1 r">error</span>);
                }
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r2 rd" class="r2 r">moduleNames</span> = <b>null</b>;
                <span class="i">List</span>&lt;<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt; <span id="r3 rd" class="r3 r">moduleInfos</span> = <b>null</b>;
 
                <b>if</b> (<a href="#53abf98bc22b2818" class="i property">Module</a> != <b>null</b>)
                {
                    <span class="r2 r">moduleNames</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                    <span class="r3 r">moduleInfos</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt;();
 
                    <b>foreach</b> (<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r4 rd" class="r4 r">moduleInfo</span> <b>in</b> <a href="#53abf98bc22b2818" class="i property">Module</a>)
                    {
                        <span class="c">// WinBlue: 268863</span>
                        <span class="c">// this check will cover the cases where</span>
                        <span class="c">// user supplied just name with -Module parameter.</span>
                        <span class="c">// In other cases, user must have supplied either</span>
                        <span class="c">// PSModuleInfo or Deserialized PSModuleInfo</span>
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r4 r">moduleInfo</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>))
                        {
                            <span class="r2 r">moduleNames</span>.<span class="i">Add</span>(<span class="r4 r">moduleInfo</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>);
                        }
                        <b>else</b>
                        {
                            <span class="r3 r">moduleInfos</span>.<span class="i">Add</span>(<span class="r4 r">moduleInfo</span>);
                        }
                    }
                }
 
                <a href="UpdatableHelpCommandBase.cs.html#79cb20b74e3fc360" class="k">base</a>.<span class="i">Process</span>(<span class="r2 r">moduleNames</span>, <a href="#cc47b7d1d08591d1" class="i property">FullyQualifiedModule</a>);
                <a href="UpdatableHelpCommandBase.cs.html#79cb20b74e3fc360" class="k">base</a>.<span class="i">Process</span>(<span class="r3 r">moduleInfos</span>);
            }
            <b>finally</b>
            {
                <a href="../engine/ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r5 rd" class="r5 r">progress</span> = <b>new</b> <span class="t">ProgressRecord</span>(<a href="UpdatableHelpCommandBase.cs.html#94a0669ad1767b72" class="i field">activityId</a>, <span class="i">HelpDisplayStrings</span>.<span class="i">SaveProgressActivityForModule</span>, <span class="i">HelpDisplayStrings</span>.<span class="i">UpdateProgressInstalling</span>);
 
                <span class="r5 r">progress</span>.<a href="../engine/ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a> = 100;
                <span class="r5 r">progress</span>.<a href="../engine/ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../engine/ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../engine/ProgressRecord.cs.html#be29e101fe03f5d0" class="i field">Completed</a>;
 
                <a href="../engine/cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r5 r">progress</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process a single module with a given culture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">module</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Module to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">culture</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Culture to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the module has been processed, false if not.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="19960545b06060e2" href="../R/19960545b06060e2.html" target="n" data-glyph="74,1" class="i method">ProcessModuleWithCulture</a>(<a href="UpdatableHelpModuleInfo.cs.html#0bb338b0e99e961f" class="t t">UpdatableHelpModuleInfo</a> <span id="r6 rd" class="r6 r">module</span>, <b>string</b> <span id="r7 rd" class="r7 r">culture</span>)
        {
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r8 rd" class="r8 r">resolvedPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
            <span class="c">// Search for the HelpInfo XML</span>
            <b>foreach</b> (<b>string</b> <span id="r9 rd" class="r9 r">path</span> <b>in</b> <a href="#21d4e3c14e4f436d" class="i field">_path</a>)
            {
                <a href="UpdatableHelpSystem.cs.html#f327345ca73bf3f7" class="t t">UpdatableHelpSystemDrive</a> <span id="r10 rd" class="r10 r">helpInfoDrive</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r9 r">path</span>))
                    {
                        <a href="../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r11 rd" class="r11 r">e</span> = <b>new</b> <a href="../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathNullOrEmpty</span>));
                        <a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r11 r">e</span>.<a href="../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>string</b> <span id="r12 rd" class="r12 r">destPath</span> = <span class="r9 r">path</span>;
 
                    <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r9 r">path</span>.<span class="i">Contains</span>(<span class="s">&#39;*&#39;</span>))
                        {
                            <span class="c">// Deal with wildcards</span>
 
                            <b>int</b> <span id="r13 rd" class="r13 r">index</span> = <span class="r9 r">path</span>.<span class="i">IndexOf</span>(<span class="s">&#39;*&#39;</span>);
 
                            <b>if</b> (<span class="r13 r">index</span> == 0)
                            {
                                <b>throw</b> <b>new</b> <span class="t">UpdatableHelpSystemException</span>(<span class="s">&quot;PathMustBeValidContainers&quot;</span>,
                                    <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathMustBeValidContainers</span>, <span class="r9 r">path</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                    <b>null</b>, <b>new</b> <a href="../utils/SessionStateExceptions.cs.html#fd86a88f915cae0c" class="t constructor">ItemNotFoundException</a>());
                            }
                            <b>else</b>
                            {
                                <b>int</b> <span id="r14 rd" class="r14 r">i</span> = <span class="r13 r">index</span>;
                                <b>for</b> (; <span class="r14 r">i</span> &gt;= 0; <span class="r14 r">i</span>--)
                                {
                                    <b>if</b> (<span class="r9 r">path</span>[<span class="r14 r">i</span>].<span class="i">Equals</span>(<span class="s">&#39;/&#39;</span>) || <span class="r9 r">path</span>[<span class="r14 r">i</span>].<span class="i">Equals</span>(<span class="s">&#39;\\&#39;</span>))
                                    {
                                        <b>break</b>;
                                    }
                                }
 
                                <b>if</b> (<span class="r14 r">i</span> == 0)
                                {
                                    <b>throw</b> <b>new</b> <span class="t">UpdatableHelpSystemException</span>(<span class="s">&quot;PathMustBeValidContainers&quot;</span>,
                                        <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathMustBeValidContainers</span>, <span class="r9 r">path</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                        <b>null</b>, <b>new</b> <a href="../utils/SessionStateExceptions.cs.html#fd86a88f915cae0c" class="t constructor">ItemNotFoundException</a>());
                                }
 
                                <span class="r10 r">helpInfoDrive</span> = <b>new</b> <span class="t">UpdatableHelpSystemDrive</span>(<a href="#9a5fcbf4e57fe29a" class="k">this</a>, <span class="r9 r">path</span>.<span class="i">Substring</span>(0, <span class="r14 r">i</span>), <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
                                <span class="r12 r">destPath</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r10 r">helpInfoDrive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>, <span class="r9 r">path</span>.<span class="i">Substring</span>(<span class="r14 r">i</span> + 1, <span class="r9 r">path</span>.<span class="i">Length</span> - (<span class="r14 r">i</span> + 1)));
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r10 r">helpInfoDrive</span> = <b>new</b> <a href="UpdatableHelpSystem.cs.html#5b2e52f1bc7b5c54" class="t constructor">UpdatableHelpSystemDrive</a>(<a href="#9a5fcbf4e57fe29a" class="k">this</a>, <span class="r9 r">path</span>, <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
                            <span class="r12 r">destPath</span> = <span class="r10 r">helpInfoDrive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>;
                        }
                    }
 
                    <b>if</b> (<a href="#f4cbd3627d21799f" class="i field">_isLiteralPath</a>)
                    {
                        <b>string</b> <span id="r15 rd" class="r15 r">destinationPath</span> = <a href="../engine/CommandBase.cs.html#a9974dcdcf6c3d5c" class="i method">GetUnresolvedProviderPathFromPSPath</a>(<span class="r12 r">destPath</span>);
                        <b>if</b> (!<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r15 r">destinationPath</span>))
                        {
                            <b>throw</b> <b>new</b> <span class="t">UpdatableHelpSystemException</span>(<span class="s">&quot;PathMustBeValidContainers&quot;</span>,
                                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathMustBeValidContainers</span>, <span class="r9 r">path</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <b>null</b>, <b>new</b> <a href="../utils/SessionStateExceptions.cs.html#fd86a88f915cae0c" class="t constructor">ItemNotFoundException</a>());
                        }
 
                        <span class="r8 r">resolvedPaths</span>.<span class="i">Add</span>(<span class="r15 r">destinationPath</span>);
                    }
                    <b>else</b>
                    {
                        <b>try</b>
                        {
                            <span class="c">// Expand wildcard characters</span>
                            <b>foreach</b> (<b>string</b> <span id="r16 rd" class="r16 r">tempPath</span> <b>in</b> <a href="UpdatableHelpCommandBase.cs.html#3a6e45bef9b591d0" class="i method">ResolvePath</a>(<span class="r12 r">destPath</span>, <b>false</b>, <b>false</b>))
                            {
                                <span class="r8 r">resolvedPaths</span>.<span class="i">Add</span>(<span class="r16 r">tempPath</span>);
                            }
                        }
                        <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a> <span id="r17 rd" class="r17 r">e</span>)
                        {
                            <b>throw</b> <b>new</b> <span class="t">UpdatableHelpSystemException</span>(<span class="s">&quot;PathMustBeValidContainers&quot;</span>,
                                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">PathMustBeValidContainers</span>, <span class="r9 r">path</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>, <span class="r17 r">e</span>);
                        }
                    }
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r10 r">helpInfoDrive</span> != <b>null</b>)
                    {
                        <span class="r10 r">helpInfoDrive</span>.<a href="UpdatableHelpSystem.cs.html#1adb22d4df53bf83" class="i method">Dispose</a>();
                    }
                }
            }
 
            <b>if</b> (<span class="r8 r">resolvedPaths</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>bool</b> <span id="r18 rd" class="r18 r">installed</span> = <b>false</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r19 rd" class="r19 r">path</span> <b>in</b> <span class="r8 r">resolvedPaths</span>)
            {
                <a href="UpdatableHelpInfo.cs.html#684ce84072668439" class="t t">UpdatableHelpInfo</a> <span id="r20 rd" class="r20 r">currentHelpInfo</span> = <b>null</b>;
                <a href="UpdatableHelpInfo.cs.html#684ce84072668439" class="t t">UpdatableHelpInfo</a> <span id="r21 rd" class="r21 r">newHelpInfo</span> = <b>null</b>;
                <b>string</b> <span id="r22 rd" class="r22 r">helpInfoUri</span> = <b>null</b>;
 
                <span class="c">// if -force is specified, no need to read from the current HelpInfo.xml file</span>
                <span class="c">// because it won&#39;t be used for checking &quot;IsUpdateNecessary&quot;</span>
                <b>string</b> <span id="r23 rd" class="r23 r">xml</span> = <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>
                                 ? <b>null</b>
                                 : <a href="UpdatableHelpSystem.cs.html#ff7dfbcb710dbfc0" class="t t">UpdatableHelpSystem</a>.<a href="UpdatableHelpSystem.cs.html#bd9ab69561594e93" class="i method">LoadStringFromPath</a>(<a href="#9a5fcbf4e57fe29a" class="k">this</a>,
                                                                          <a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<span class="r19 r">path</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>()),
                                                                          <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
 
                <b>if</b> (<span class="r23 r">xml</span> != <b>null</b>)
                {
                    <span class="c">// constructing the helpinfo object from previous update help log xml..</span>
                    <span class="c">// no need to resolve the uri&#39;s in this case.</span>
                    <span class="r20 r">currentHelpInfo</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#0ded739dd9a3c366" class="i method">CreateHelpInfo</a>(<span class="r23 r">xml</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>,
                                                                 <span class="r24 r">currentCulture</span>: <b>null</b>, <span class="r25 r">pathOverride</span>: <b>null</b>, <span class="r26 r">verbose</span>: <b>false</b>,
                                                                 <span class="r27 r">shouldResolveUri</span>: <b>false</b>, <span class="r28 r">ignoreValidationException</span>: <b>false</b>);
                }
 
                <span class="c">// Don&#39;t update too frequently</span>
                <b>if</b> (!<a href="#da899cadf38aaad7" class="i field">_alreadyCheckedOncePerDayPerModule</a> &amp;&amp; !<span class="i">CheckOncePerDayPerModule</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r19 r">path</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>(), <span class="i">DateTime</span>.<span class="i">UtcNow</span>, <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <a href="#da899cadf38aaad7" class="i field">_alreadyCheckedOncePerDayPerModule</a> = <b>true</b>;
 
                <span class="c">// Form the actual HelpInfo.xml uri</span>
                <span class="r22 r">helpInfoUri</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#b5c02e01b8bcf26c" class="i method">GetHelpInfoUri</a>(<span class="r6 r">module</span>, <b>null</b>).<a href="UpdatableHelpUri.cs.html#6976fa0769b8e72c" class="i property">ResolvedUri</a>;
                <b>string</b> <span id="r29 rd" class="r29 r">uri</span> = <span class="r22 r">helpInfoUri</span> + <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>();
 
                <span class="r21 r">newHelpInfo</span> = <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#ea4355c9102de91b" class="i method">GetHelpInfo</a>(<a href="UpdatableHelpCommandBase.cs.html#90cd2ea8949909c7" class="i field">_commandType</a>, <span class="r29 r">uri</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r7 r">culture</span>);
 
                <b>if</b> (<span class="r21 r">newHelpInfo</span> == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <a href="UpdatableHelpSystem.cs.html#d9d267438abfd2d5" class="t constructor">UpdatableHelpSystemException</a>(<span class="s">&quot;UnableToRetrieveHelpInfoXml&quot;</span>,
                        <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">UnableToRetrieveHelpInfoXml</span>, <span class="r7 r">culture</span>), <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#cb0471032395958b" class="i field">ResourceUnavailable</a>,
                        <b>null</b>, <b>null</b>);
                }
 
                <b>string</b> <span id="r30 rd" class="r30 r">tempPath</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="i">Path</span>.<span class="i">GetTempPath</span>(), <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="i">Path</span>.<span class="i">GetTempFileName</span>()));
                <b>foreach</b> (<a href="UpdatableHelpUri.cs.html#c9285fbfa28e5c83" class="t t">UpdatableHelpUri</a> <span id="r31 rd" class="r31 r">contentUri</span> <b>in</b> <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#5ca12d773273a957" class="i property">HelpContentUriCollection</a>)
                {
                    <b>if</b> (!<a href="UpdatableHelpCommandBase.cs.html#3ad6e24a24a30471" class="i method">IsUpdateNecessary</a>(<span class="r6 r">module</span>, <span class="r20 r">currentHelpInfo</span>, <span class="r21 r">newHelpInfo</span>, <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>, <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>))
                    {
                        <a href="../engine/cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SuccessfullyUpdatedHelpContent</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="i">HelpDisplayStrings</span>.<span class="i">NewestContentAlreadyDownloaded</span>,
                            <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>)));
 
                        <span class="r18 r">installed</span> = <b>true</b>;
                        <b>continue</b>;
                    }
                    <b>else</b>
                    {
                        <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r22 r">helpInfoUri</span> != <b>null</b>, <span class="s">&quot;If we are here, helpInfoUri must not be null&quot;</span>);
 
                        <b>string</b> <span id="r32 rd" class="r32 r">helpContentUri</span> = <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#6976fa0769b8e72c" class="i property">ResolvedUri</a>;
                        <b>string</b> <span id="r33 rd" class="r33 r">helpContentName</span> = <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#f96e3a6a57050235" class="i method">GetHelpContentName</a>(<span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>);
 
                        <a href="UpdatableHelpSystem.cs.html#f327345ca73bf3f7" class="t t">UpdatableHelpSystemDrive</a> <span id="r34 rd" class="r34 r">helpContentDrive</span> = <b>null</b>;
 
                        <b>try</b>
                        {
                            <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r32 r">helpContentUri</span>))
                            {
                                <span class="i">File</span>.<span class="i">Copy</span>(<a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<span class="r32 r">helpContentUri</span>, <span class="r33 r">helpContentName</span>),
                                    <a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../engine/PathInterfaces.cs.html#a5d9d04e03d07f5f" class="i method">Combine</a>(<span class="r19 r">path</span>, <span class="r33 r">helpContentName</span>), <b>true</b>);
                            }
                            <b>else</b>
                            {
                                <span class="c">// Remote</span>
 
                                <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a> != <b>null</b>)
                                {
                                    <b>try</b>
                                    {
                                        <span class="r34 r">helpContentDrive</span> = <b>new</b> <a href="UpdatableHelpSystem.cs.html#5b2e52f1bc7b5c54" class="t constructor">UpdatableHelpSystemDrive</a>(<a href="#9a5fcbf4e57fe29a" class="k">this</a>, <span class="r19 r">path</span>, <a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a>);
 
                                        <b>if</b> (!<a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#fc40125d6edd6b21" class="i method">DownloadHelpContent</a>(<a href="UpdatableHelpCommandBase.cs.html#90cd2ea8949909c7" class="i field">_commandType</a>, <span class="r30 r">tempPath</span>, <span class="r32 r">helpContentUri</span>, <span class="r33 r">helpContentName</span>, <span class="r7 r">culture</span>))
                                        {
                                            <span class="r18 r">installed</span> = <b>false</b>;
                                            <b>continue</b>;
                                        }
 
                                        <a href="../engine/CommandBase.cs.html#0a0ac63de22d06f8" class="i property">InvokeProvider</a>.<a href="../engine/CmdletFamilyProviderInterfaces.cs.html#982f59c2f3f056cc" class="i property">Item</a>.<a href="../engine/ItemCmdletProviderInterfaces.cs.html#91e3f28d060f9f2c" class="i method">Copy</a>(<b>new</b> <b>string</b>[1] { <span class="r30 r">tempPath</span> }, <span class="r34 r">helpContentDrive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>, <b>true</b>, <a href="../engine/ItemCmdletProviderInterfaces.cs.html#656af2aa3eb70796" class="t t">CopyContainers</a>.<a href="../engine/ItemCmdletProviderInterfaces.cs.html#978f020df8a63d2d" class="i field">CopyChildrenOfTargetContainer</a>,
                                            <b>true</b>, <b>true</b>);
                                    }
                                    <b>catch</b> (<span class="i">Exception</span> <span id="r35 rd" class="r35 r">e</span>)
                                    {
                                        <span class="i">ProcessException</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r35 r">e</span>);
                                        <span class="r18 r">installed</span> = <b>false</b>;
                                        <b>continue</b>;
                                    }
                                }
                                <b>else</b>
                                {
                                    <b>if</b> (!<a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<a href="UpdatableHelpSystem.cs.html#fc40125d6edd6b21" class="i method">DownloadHelpContent</a>(<a href="UpdatableHelpCommandBase.cs.html#90cd2ea8949909c7" class="i field">_commandType</a>, <span class="r19 r">path</span>, <span class="r32 r">helpContentUri</span>, <span class="r33 r">helpContentName</span>, <span class="r7 r">culture</span>))
                                    {
                                        <span class="r18 r">installed</span> = <b>false</b>;
                                        <b>continue</b>;
                                    }
                                }
                            }
 
                            <b>if</b> (<a href="UpdatableHelpCommandBase.cs.html#f99f89620adc4b4f" class="i field">_credential</a> != <b>null</b>)
                            {
                                <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<span class="i">GenerateHelpInfo</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#22c35f3b68e99815" class="i property">UnresolvedUri</a>, <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>), <span class="r30 r">tempPath</span>,
                                    <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>(), <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>);
 
                                <a href="../engine/CommandBase.cs.html#0a0ac63de22d06f8" class="i property">InvokeProvider</a>.<a href="../engine/CmdletFamilyProviderInterfaces.cs.html#982f59c2f3f056cc" class="i property">Item</a>.<span class="i">Copy</span>(<b>new</b> <b>string</b>[1] { <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r30 r">tempPath</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>()) }, <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r34 r">helpContentDrive</span>.<a href="UpdatableHelpSystem.cs.html#3fd116f1dacd3485" class="i property">DriveName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>()), <b>false</b>,
                                    <a href="../engine/ItemCmdletProviderInterfaces.cs.html#656af2aa3eb70796" class="t t">CopyContainers</a>.<a href="../engine/ItemCmdletProviderInterfaces.cs.html#7dd07e68b5d7556d" class="i field">CopyTargetContainer</a>, <b>true</b>, <b>true</b>);
                            }
                            <b>else</b>
                            {
                                <a href="UpdatableHelpCommandBase.cs.html#49a8dda97a1f2696" class="i field">_helpSystem</a>.<span class="i">GenerateHelpInfo</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#5103a754e325b007" class="i property">ModuleGuid</a>, <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#22c35f3b68e99815" class="i property">UnresolvedUri</a>, <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>), <span class="r19 r">path</span>,
                                    <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#1df58c70df082339" class="i method">GetHelpInfoName</a>(), <a href="UpdatableHelpCommandBase.cs.html#4454dd4f337e4b4a" class="i field">_force</a>);
                            }
 
                            <a href="../engine/cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SuccessfullyUpdatedHelpContent</span>, <span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>,
                                <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SavedHelpContent</span>, <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">Combine</span>(<span class="r19 r">path</span>, <span class="r33 r">helpContentName</span>)), <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>,
                                <span class="r21 r">newHelpInfo</span>.<a href="UpdatableHelpInfo.cs.html#192ce6d1d83d23b0" class="i method">GetCultureVersion</a>(<span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>)));
 
                            <a href="UpdatableHelpCommandBase.cs.html#f70107b8fca1aac6" class="i method">LogMessage</a>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">HelpDisplayStrings</span>.<span class="i">SaveHelpCompleted</span>, <span class="r19 r">path</span>));
                        }
                        <b>catch</b> (<span class="i">Exception</span> <span id="r36 rd" class="r36 r">e</span>)
                        {
                            <span class="i">ProcessException</span>(<span class="r6 r">module</span>.<a href="UpdatableHelpModuleInfo.cs.html#7d948238a883032c" class="i property">ModuleName</a>, <span class="r31 r">contentUri</span>.<a href="UpdatableHelpUri.cs.html#2545dc9fe292cbf9" class="i property">Culture</a>.<span class="i">Name</span>, <span class="r36 r">e</span>);
                        }
                        <b>finally</b>
                        {
                            <b>if</b> (<span class="r34 r">helpContentDrive</span> != <b>null</b>)
                            {
                                <span class="r34 r">helpContentDrive</span>.<a href="UpdatableHelpSystem.cs.html#1adb22d4df53bf83" class="i method">Dispose</a>();
                            }
                        }
                    }
                }
 
                <span class="r18 r">installed</span> = <b>true</b>;
            }
 
            <b>return</b> <span class="r18 r">installed</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <b>internal sealed class</b> <a id="f824d2feea842464" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="2b41311f62a6da87">ArgumentToModuleTransformationAttribute</span></a> : <a href="../engine/Attributes.cs.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a>
    {
        <b>public override object</b> <a id="8e7758e9ce4bab97" href="../R/8e7758e9ce4bab97.html" target="n" data-glyph="72,1" class="i method">Transform</a>(<a href="../engine/EngineIntrinsics.cs.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <span id="r37 rd" class="r37 r">engineIntrinsics</span>, <b>object</b> <span id="r38 rd" class="r38 r">inputData</span>)
        {
            <b>object</b> <span id="r39 rd" class="r39 r">argument</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r38 r">inputData</span>);
 
            <span class="c">// deal with scalar string argument</span>
            <b>var</b> <span id="r40 rd" class="r40 r">strArg</span> = <span class="r39 r">argument</span> <b>as string</b>;
            <b>if</b> (<span class="r40 r">strArg</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="../engine/Modules/PSModuleInfo.cs.html#82c685f79205f6f4" class="t constructor">PSModuleInfo</a>(<span class="r41 r">name</span>: <span class="r40 r">strArg</span>, <span class="r42 r">path</span>: <b>null</b>, <span class="r43 r">context</span>: <b>null</b>, <span class="r44 r">sessionState</span>: <b>null</b>);
            }
 
            <span class="c">// deal with IList argument</span>
            <span class="i">IList</span> <span id="r45 rd" class="r45 r">iListArg</span> = <a href="../engine/ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="../engine/ParameterBinderBase.cs.html#e3143cf69b7ef81f" class="i method">GetIList</a>(<span class="r39 r">argument</span>);
            <b>if</b> (<span class="r45 r">iListArg</span> != <b>null</b> &amp;&amp; <span class="r45 r">iListArg</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>int</b> <span id="r46 rd" class="r46 r">elementCount</span> = <span class="r45 r">iListArg</span>.<span class="i">Count</span>;
                <b>int</b> <span id="r47 rd" class="r47 r">targetIndex</span> = 0;
                <b>var</b> <span id="r48 rd" class="r48 r">target</span> = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<b>typeof</b>(<b>object</b>), <span class="r46 r">elementCount</span>);
 
                <b>foreach</b> (<b>object</b> <span id="r49 rd" class="r49 r">element</span> <b>in</b> <span class="r45 r">iListArg</span>)
                {
                    <b>var</b> <span id="r50 rd" class="r50 r">elementValue</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r49 r">element</span>);
 
                    <b>if</b> (<span class="r50 r">elementValue</span> <b>is</b> <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>)
                    {
                        <span class="r48 r">target</span>.<span class="i">SetValue</span>(<span class="r50 r">elementValue</span>, <span class="r47 r">targetIndex</span>++);
                    }
                    <b>else</b> <b>if</b> (<span class="r50 r">elementValue</span> <b>is string</b>)
                    {
                        <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="k">var</a> <span id="r51 rd" class="r51 r">elementAsModuleObj</span> = <b>new</b> <a href="../engine/Modules/PSModuleInfo.cs.html#82c685f79205f6f4" class="t constructor">PSModuleInfo</a>(<span class="r41 r">name</span>: (<b>string</b>)<span class="r50 r">elementValue</span>, <span class="r42 r">path</span>: <b>null</b>, <span class="r43 r">context</span>: <b>null</b>, <span class="r44 r">sessionState</span>: <b>null</b>);
                        <span class="r48 r">target</span>.<span class="i">SetValue</span>(<span class="r51 r">elementAsModuleObj</span>, <span class="r47 r">targetIndex</span>++);
                    }
                    <b>else</b>
                    {
                        <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r52 rd" class="r52 r">elementValueModuleInfo</span> = <b>null</b>;
                        <b>if</b> (<a href="#99d1231bd82e7989" class="i method">TryConvertFromDeserializedModuleInfo</a>(<span class="r50 r">elementValue</span>, <b>out</b> <span class="r52 r">elementValueModuleInfo</span>))
                        {
                            <span class="r48 r">target</span>.<span class="i">SetValue</span>(<span class="r52 r">elementValueModuleInfo</span>, <span class="r47 r">targetIndex</span>++);
                        }
                        <b>else</b>
                        {
                            <span class="r48 r">target</span>.<span class="i">SetValue</span>(<span class="r49 r">element</span>, <span class="r47 r">targetIndex</span>++);
                        }
                    }
                }
 
                <b>return</b> <span class="r48 r">target</span>;
            }
 
            <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r53 rd" class="r53 r">moduleInfo</span> = <b>null</b>;
            <b>if</b> (<a href="#99d1231bd82e7989" class="i method">TryConvertFromDeserializedModuleInfo</a>(<span class="r38 r">inputData</span>, <b>out</b> <span class="r53 r">moduleInfo</span>))
            {
                <b>return</b> <span class="r53 r">moduleInfo</span>;
            }
 
            <b>return</b> <span class="r38 r">inputData</span>;
        }
 
        <b>private static bool</b> <a id="99d1231bd82e7989" href="../R/99d1231bd82e7989.html" target="n" data-glyph="76,1" class="i method">TryConvertFromDeserializedModuleInfo</a>(<b>object</b> <span id="r54 rd" class="r54 r">inputData</span>, <b>out</b> <a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r55 rd" class="r55 r">moduleInfo</span>)
        {
            <span class="r55 r">moduleInfo</span> = <b>null</b>;
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r56 rd" class="r56 r">pso</span> = <span class="r54 r">inputData</span> <b>as</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<a href="../engine/serialization.cs.html#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r56 r">pso</span>, <b>typeof</b>(<a href="../engine/Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>)))
            {
                <b>string</b> <span id="r57 rd" class="r57 r">moduleName</span>;
                <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../engine/LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<b>string</b>&gt;(<span class="r56 r">pso</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>out</b> <span class="r57 r">moduleName</span>);
 
                <span class="i">Guid</span> <span id="r58 rd" class="r58 r">moduleGuid</span>;
                <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../engine/LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<span class="i">Guid</span>&gt;(<span class="r56 r">pso</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Guid&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>out</b> <span class="r58 r">moduleGuid</span>);
 
                <span class="i">Version</span> <span id="r59 rd" class="r59 r">moduleVersion</span>;
                <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../engine/LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<span class="i">Version</span>&gt;(<span class="r56 r">pso</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Version&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>out</b> <span class="r59 r">moduleVersion</span>);
 
                <b>string</b> <span id="r60 rd" class="r60 r">helpInfoUri</span>;
                <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../engine/LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<b>string</b>&gt;(<span class="r56 r">pso</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;HelpInfoUri&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>out</b> <span class="r60 r">helpInfoUri</span>);
 
                <span class="r55 r">moduleInfo</span> = <b>new</b> <a href="../engine/Modules/PSModuleInfo.cs.html#82c685f79205f6f4" class="t constructor">PSModuleInfo</a>(<span class="r41 r">name</span>: <span class="r57 r">moduleName</span>, <span class="r42 r">path</span>: <b>null</b>, <span class="r43 r">context</span>: <b>null</b>, <span class="r44 r">sessionState</span>: <b>null</b>);
                <span class="r55 r">moduleInfo</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#4b6e2a1b9b5b92c2" class="i method">SetGuid</a>(<span class="r58 r">moduleGuid</span>);
                <span class="r55 r">moduleInfo</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#86de19074268f803" class="i method">SetVersion</a>(<span class="r59 r">moduleVersion</span>);
                <span class="r55 r">moduleInfo</span>.<a href="../engine/Modules/PSModuleInfo.cs.html#c345165f675110e2" class="i method">SetHelpInfoUri</a>(<span class="r60 r">helpInfoUri</span>);
                <span class="c">// setting the base to temp directory as this is a deserialized</span>
                <span class="c">// module info.</span>
                <span class="r55 r">moduleInfo</span>.<span class="i">SetModuleBase</span>(<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetTempPath</span>());
 
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
    }
}
</pre></td></tr></table></div></body></html>
