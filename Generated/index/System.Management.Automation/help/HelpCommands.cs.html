<!DOCTYPE html>
<html><head><title>HelpCommands.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(895);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/HelpCommands.cs" target="_top">help\HelpCommands.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Help</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements get-help command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../utils/Verbs.cs.html#7ee9f5441476f642" class="i field">Get</a>, <span class="s">&quot;Help&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;AllUsersView&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096483&quot;</span>)]
    <b>public sealed class</b> <a id="eb5836f612b480de" href="../R/eb5836f612b480de.html" target="n" data-glyph="0,0" class="t t">GetHelpCommand</a> : <a href="../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help Views.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="b13b543a3c15aab2" href="../R/b13b543a3c15aab2.html" target="n" data-glyph="20,1" class="t t"><span id="20567b609ea6ef81">HelpView</span></a>
        {
            <a id="b940b73d7a310834" href="../R/b940b73d7a310834.html" target="n" data-glyph="24,2" class="i field">Default</a> = 0x00, <span class="c">// Default View</span>
            <a id="080d1f1555bf8ae9" href="../R/080d1f1555bf8ae9.html" target="n" data-glyph="24,2" class="i field">DetailedView</a> = 0x01,
            <a id="ea6a52a59d75030b" href="../R/ea6a52a59d75030b.html" target="n" data-glyph="24,2" class="i field">FullView</a> = 0x02,
            <a id="7b44b41e9c5c1533" href="../R/7b44b41e9c5c1533.html" target="n" data-glyph="24,2" class="i field">ExamplesView</a> = 0x03
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor for the GetHelpCommand class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="b07c5baae368885b" href="../R/b07c5baae368885b.html" target="n" data-glyph="72,1" class="t constructor">GetHelpCommand</a>()
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Target to search for help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../engine/Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public string</b> <a id="92d813bec3b58b0e" href="../R/92d813bec3b58b0e.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Path to provider location that user is curious about.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b> <a id="f1779bc36f7d6114" href="../R/f1779bc36f7d6114.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of help categories to search for help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateSet</span>(
            <span class="s">&quot;Alias&quot;</span>, <span class="s">&quot;Cmdlet&quot;</span>, <span class="s">&quot;Provider&quot;</span>, <span class="s">&quot;General&quot;</span>, <span class="s">&quot;FAQ&quot;</span>, <span class="s">&quot;Glossary&quot;</span>, <span class="s">&quot;HelpFile&quot;</span>, <span class="s">&quot;ScriptCommand&quot;</span>, <span class="s">&quot;Function&quot;</span>, <span class="s">&quot;Filter&quot;</span>, <span class="s">&quot;ExternalScript&quot;</span>, <span class="s">&quot;All&quot;</span>, <span class="s">&quot;DefaultHelp&quot;</span>, <span class="s">&quot;DscResource&quot;</span>, <span class="s">&quot;Class&quot;</span>, <span class="s">&quot;Configuration&quot;</span>,
             <a href="../engine/Attributes.cs.html#90833178fccd6012" class="i property">IgnoreCase</a> = <b>true</b>)]
        <b>public string</b>[] <a id="0ce5a0f2b4820267" href="../R/0ce5a0f2b4820267.html" target="n" data-glyph="102,1" class="i property">Category</a> { <b>get</b>; <b>set</b>; }
 
        <b>private readonly string</b> <a id="475d96807aac73f4" href="../R/475d96807aac73f4.html" target="n" data-glyph="46,1" class="i field">_provider</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Changes the view of HelpObject returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently we support following views:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> 1. Reminder (Default - Experienced User)</span>
        <span class="c">///</span><span class="c"> 2. Detailed (Beginner - Beginning User)</span>
        <span class="c">///</span><span class="c"> 3. Full     (All Users)</span>
        <span class="c">///</span><span class="c"> 4. Examples</span>
        <span class="c">///</span><span class="c"> 5. Parameters</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Currently we support these views only for Cmdlets.</span>
        <span class="c">///</span><span class="c"> A SnapIn developer can however change these views.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;DetailedView&quot;</span>, <a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="87cd4b7fab2fd1e8" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Detailed</a>
        {
            <b>set</b>
            {
                <b>if</b> (<b>value</b>.<a href="../engine/MshCmdlet.cs.html#1292a5d1a1a3e8e8" class="i method">ToBool</a>())
                {
                    <a href="#d71f02a86800cc78" class="i field">_viewTokenToAdd</a> = <a href="#b13b543a3c15aab2" class="t t">HelpView</a>.<a href="#080d1f1555bf8ae9" class="i field">DetailedView</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Changes the view of HelpObject returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently we support following views:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> 1. Reminder (Default - Experienced User)</span>
        <span class="c">///</span><span class="c"> 2. Detailed (Beginner - Beginning User)</span>
        <span class="c">///</span><span class="c"> 3. Full     (All Users)</span>
        <span class="c">///</span><span class="c"> 4. Examples</span>
        <span class="c">///</span><span class="c"> 5. Parameters</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Currently we support these views only for Cmdlets.</span>
        <span class="c">///</span><span class="c"> A SnapIn developer can however change these views.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;AllUsersView&quot;</span>)]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9219d467b38baacf" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Full</a>
        {
            <b>set</b>
            {
                <b>if</b> (<b>value</b>.<a href="../engine/MshCmdlet.cs.html#1292a5d1a1a3e8e8" class="i method">ToBool</a>())
                {
                    <a href="#d71f02a86800cc78" class="i field">_viewTokenToAdd</a> = <a href="#b13b543a3c15aab2" class="t t">HelpView</a>.<a href="#ea6a52a59d75030b" class="i field">FullView</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Changes the view of HelpObject returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently we support following views:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> 1. Reminder (Default - Experienced User)</span>
        <span class="c">///</span><span class="c"> 2. Detailed (Beginner - Beginning User)</span>
        <span class="c">///</span><span class="c"> 3. Full     (All Users)</span>
        <span class="c">///</span><span class="c"> 4. Examples</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Currently we support these views only for Cmdlets.</span>
        <span class="c">///</span><span class="c"> A SnapIn developer can however change these views.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Examples&quot;</span>, <a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8e7adca3fb1e390d" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Examples</a>
        {
            <b>set</b>
            {
                <b>if</b> (<b>value</b>.<a href="../engine/MshCmdlet.cs.html#1292a5d1a1a3e8e8" class="i method">ToBool</a>())
                {
                    <a href="#d71f02a86800cc78" class="i field">_viewTokenToAdd</a> = <a href="#b13b543a3c15aab2" class="t t">HelpView</a>.<a href="#7b44b41e9c5c1533" class="i field">ExamplesView</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Support WildCard strings as supported by WildcardPattern class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Parameters&quot;</span>, <a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public string</b>[] <a id="cfcf86d02234054a" href="../R/cfcf86d02234054a.html" target="n" data-glyph="102,1" class="i property">Parameter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets list of Component&#39;s to search on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b>[] <a id="351516b42029e2d0" href="../R/351516b42029e2d0.html" target="n" data-glyph="102,1" class="i property">Component</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets list of Functionality&#39;s to search on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b>[] <a id="569b93699d877f15" href="../R/569b93699d877f15.html" target="n" data-glyph="102,1" class="i property">Functionality</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets list of Role&#39;s to search on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b>[] <a id="6ac28c075ebaaf13" href="../R/6ac28c075ebaaf13.html" target="n" data-glyph="102,1" class="i property">Role</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter,if true, will direct get-help cmdlet to</span>
        <span class="c">///</span><span class="c"> navigate to a URL (stored in the command MAML file under</span>
        <span class="c">///</span><span class="c"> the uri node).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Online&quot;</span>, <a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="d7e9bd3687791104" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Online</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#85ac89b42c239d77" class="i field">_showOnlineHelp</a>;
            }
 
            <b>set</b>
            {
                <a href="#85ac89b42c239d77" class="i field">_showOnlineHelp</a> = <b>value</b>;
                <b>if</b> (<a href="#85ac89b42c239d77" class="i field">_showOnlineHelp</a>)
                {
                    <a href="#ed9870df48b3fa67" class="i method">VerifyParameterForbiddenInRemoteRunspace</a>(<a href="#eb5836f612b480de" class="k">this</a>, <span class="s">&quot;Online&quot;</span>);
                }
            }
        }
 
        <b>private bool</b> <a id="85ac89b42c239d77" href="../R/85ac89b42c239d77.html" target="n" data-glyph="46,1" class="i field">_showOnlineHelp</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <b>private</b> <a href="../utils/GraphicalHostReflectionWrapper.cs.html#beaa4eda2ac5bdab" class="t t">GraphicalHostReflectionWrapper</a> <a id="2fb2aa4343172da0" href="../R/2fb2aa4343172da0.html" target="n" data-glyph="46,1" class="i field">graphicalHostReflectionWrapper</a>;
        <b>private bool</b> <a id="fa3b0fe5b5c28080" href="../R/fa3b0fe5b5c28080.html" target="n" data-glyph="46,1" class="i field">showWindow</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether the help should be displayed in a separate window.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../engine/Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ShowWindow&quot;</span>, <a href="../engine/Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="740fd3c3af7c9dad" href="../R/740fd3c3af7c9dad.html" target="n" data-glyph="102,1" class="i property">ShowWindow</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fa3b0fe5b5c28080" class="i field">showWindow</a>;
            }
 
            <b>set</b>
            {
                <a href="#fa3b0fe5b5c28080" class="i field">showWindow</a> = <b>value</b>;
                <b>if</b> (<a href="#fa3b0fe5b5c28080" class="i field">showWindow</a>)
                {
                    <a href="#ed9870df48b3fa67" class="i method">VerifyParameterForbiddenInRemoteRunspace</a>(<a href="#eb5836f612b480de" class="k">this</a>, <span class="s">&quot;ShowWindow&quot;</span>);
                }
            }
        }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">// The following variable controls the view.</span>
        <b>private</b> <a href="#b13b543a3c15aab2" class="t t">HelpView</a> <a id="d71f02a86800cc78" href="../R/d71f02a86800cc78.html" target="n" data-glyph="46,1" class="i field">_viewTokenToAdd</a> = <a href="#b13b543a3c15aab2" class="t t">HelpView</a>.<a href="#b940b73d7a310834" class="i field">Default</a>;
 
        <b>private readonly</b> <span class="i">Stopwatch</span> <a id="edaa28517e3988fa" href="../R/edaa28517e3988fa.html" target="n" data-glyph="46,1" class="i field">_timer</a> = <b>new</b> <span class="i">Stopwatch</span>();
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">LEGACYTELEMETRY</span>
<span class="e">        private bool _updatedHelp;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet API implementation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the BeginProcessing() method for get-help command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="83bd86b619d6bcb7" href="../R/83bd86b619d6bcb7.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#edaa28517e3988fa" class="i field">_timer</a>.<span class="i">Start</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the ProcessRecord() method for get-help command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="a1362723b4d88bbf" href="../R/a1362723b4d88bbf.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="HelpSystem.cs.html#c115cfdd76399004" class="t t">HelpSystem</a> <span id="r0 rd" class="r0 r">helpSystem</span> = <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../engine/ExecutionContext.cs.html#a86262768086e411" class="i property">HelpSystem</a>;
            <b>try</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                <b>if</b> (<a href="#eb5836f612b480de" class="k">this</a>.<a href="#740fd3c3af7c9dad" class="i property">ShowWindow</a>)
                {
                    <a href="#eb5836f612b480de" class="k">this</a>.<a href="#2fb2aa4343172da0" class="i field">graphicalHostReflectionWrapper</a> = <a href="../utils/GraphicalHostReflectionWrapper.cs.html#beaa4eda2ac5bdab" class="t t">GraphicalHostReflectionWrapper</a>.<a href="../utils/GraphicalHostReflectionWrapper.cs.html#a34be61b6817736f" class="i method">GetGraphicalHostReflectionWrapper</a>(<a href="#eb5836f612b480de" class="k">this</a>, <span class="s">&quot;Microsoft.PowerShell.Commands.Internal.HelpWindowHelper&quot;</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#1f6c5eb9e7ece412" class="i">OnProgress</a> += <span class="i">HelpSystem_OnProgress</span>;
 
                <b>bool</b> <span id="r1 rd" class="r1 r">failed</span> = <b>false</b>;
                <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r2 rd" class="r2 r">helpCategory</span> = <a href="#e067bfcee80f69d9" class="i method">ToHelpCategory</a>(<a href="#0ce5a0f2b4820267" class="i property">Category</a>, <b>ref</b> <span class="r1 r">failed</span>);
 
                <b>if</b> (<span class="r1 r">failed</span>)
                    <b>return</b>;
 
                <span class="c">// Validate input parameters</span>
                <a href="#02a74a10519da348" class="i method">ValidateAndThrowIfError</a>(<span class="r2 r">helpCategory</span>);
 
                <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r3 rd" class="r3 r">helpRequest</span> = <b>new</b> <a href="HelpRequest.cs.html#70f61dce8491c9d3" class="t constructor">HelpRequest</a>(<a href="#eb5836f612b480de" class="k">this</a>.<a href="#92d813bec3b58b0e" class="i property">Name</a>, <span class="r2 r">helpCategory</span>);
 
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#86df5029ee4bf1a7" class="i property">Provider</a> = <a href="#475d96807aac73f4" class="i field">_provider</a>;
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#a18e936f9011869b" class="i property">Component</a> = <a href="#351516b42029e2d0" class="i property">Component</a>;
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#f509e64e40313fa3" class="i property">Role</a> = <a href="#6ac28c075ebaaf13" class="i property">Role</a>;
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#2f01625c790bb86e" class="i property">Functionality</a> = <a href="#569b93699d877f15" class="i property">Functionality</a>;
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#953d844df2595ba0" class="i property">ProviderContext</a> = <b>new</b> <a href="ProviderContext.cs.html#55b0365ce72b7f15" class="t constructor">ProviderContext</a>(
                    <a href="#eb5836f612b480de" class="k">this</a>.<a href="#f1779bc36f7d6114" class="i property">Path</a>,
                    <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../engine/ExecutionContext.cs.html#7b897dde7067af78" class="i property">Engine</a>.<a href="../engine/AutomationEngine.cs.html#985843f55ae6567f" class="i property">Context</a>,
                    <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>);
                <span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a> = <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../engine/InvocationInfo.cs.html#02c0f35838462a5e" class="i property">CommandOrigin</a>;
 
                <span class="c">// the idea is to use yield statement in the help lookup to speed up</span>
                <span class="c">// perceived user experience....So HelpSystem.GetHelp returns an</span>
                <span class="c">// IEnumerable..</span>
                <span class="i">IEnumerable</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt; <span id="r4 rd" class="r4 r">helpInfos</span> = <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#194a8c33215a19e7" class="i method">GetHelp</a>(<span class="r3 r">helpRequest</span>);
                <span class="c">// HelpCommand acts differently when there is just one help object and when</span>
                <span class="c">// there are more than one object...so handling this behavior through</span>
                <span class="c">// some variables.</span>
                <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r5 rd" class="r5 r">firstHelpInfoObject</span> = <b>null</b>;
                <b>int</b> <span id="r6 rd" class="r6 r">countOfHelpInfos</span> = 0;
                <b>foreach</b> (<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r7 rd" class="r7 r">helpInfo</span> <b>in</b> <span class="r4 r">helpInfos</span>)
                {
                    <span class="c">// honor Ctrl-C from user.</span>
                    <b>if</b> (<a href="../engine/CommandBase.cs.html#5f88a0f944bebc93" class="i property">IsStopping</a>)
                    {
                        <b>return</b>;
                    }
 
                    <b>if</b> (<span class="r6 r">countOfHelpInfos</span> == 0)
                    {
                        <span class="r5 r">firstHelpInfoObject</span> = <span class="r7 r">helpInfo</span>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// write first help object only once.</span>
                        <b>if</b> (<span class="r5 r">firstHelpInfoObject</span> != <b>null</b>)
                        {
                            <a href="#31fc7fddb685107e" class="i method">WriteObjectsOrShowOnlineHelp</a>(<span class="r5 r">firstHelpInfoObject</span>, <b>false</b>);
                            <span class="r5 r">firstHelpInfoObject</span> = <b>null</b>;
                        }
 
                        <a href="#31fc7fddb685107e" class="i method">WriteObjectsOrShowOnlineHelp</a>(<span class="r7 r">helpInfo</span>, <b>false</b>);
                    }
 
                    <span class="r6 r">countOfHelpInfos</span>++;
                }
 
                <a href="#edaa28517e3988fa" class="i field">_timer</a>.<span class="i">Stop</span>();
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">LEGACYTELEMETRY</span>
<span class="e">                if (!string.IsNullOrEmpty(Name))
                    Microsoft.PowerShell.Telemetry.Internal.TelemetryAPI.ReportGetHelpTelemetry(Name, countOfHelpInfos, _timer.ElapsedMilliseconds, _updatedHelp);
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <span class="c">// Write full help as there is only one help info object</span>
                <b>if</b> (<span class="r6 r">countOfHelpInfos</span> == 1)
                {
                    <a href="#31fc7fddb685107e" class="i method">WriteObjectsOrShowOnlineHelp</a>(<span class="r5 r">firstHelpInfoObject</span>, <b>true</b>);
                }
                <b>else</b> <b>if</b> (<a href="#85ac89b42c239d77" class="i field">_showOnlineHelp</a> &amp;&amp; (<span class="r6 r">countOfHelpInfos</span> &gt; 1))
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">MultipleOnlineTopicsNotSupported</span>, <span class="s">&quot;Online&quot;</span>);
                }
 
                <span class="c">// show errors only if there is no wildcard search or VerboseHelpErrors is true.</span>
                <b>if</b> (((<span class="r6 r">countOfHelpInfos</span> == 0) &amp;&amp; (!<a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r3 r">helpRequest</span>.<a href="HelpRequest.cs.html#fb17dcc446c6c966" class="i property">Target</a>)))
                    || <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#0fd02dc03c5ba574" class="i property">VerboseHelpErrors</a>)
                {
                    <span class="c">// Check if there is any error happened. If yes,</span>
                    <span class="c">// pipe out errors.</span>
                    <b>if</b> (<span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#600b66256f838b9f" class="i property">LastErrors</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>foreach</b> (<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r8 rd" class="r8 r">errorRecord</span> <b>in</b> <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#600b66256f838b9f" class="i property">LastErrors</a>)
                        {
                            <a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r8 r">errorRecord</span>);
                        }
                    }
                }
            }
            <b>finally</b>
            {
                <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#1f6c5eb9e7ece412" class="i">OnProgress</a> -= <span class="i">HelpSystem_OnProgress</span>;
                <a href="#eba5fedb7ea5303d" class="i method">HelpSystem_OnComplete</a>();
 
                <span class="c">// finally clear the ScriptBlockAst -&gt; Token[] cache</span>
                <span class="r0 r">helpSystem</span>.<a href="HelpSystem.cs.html#6809697a2b1ff7fb" class="i method">ClearScriptBlockTokenCache</a>();
            }
        }
 
        <b>private</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="e067bfcee80f69d9" href="../R/e067bfcee80f69d9.html" target="n" data-glyph="76,1" class="i method">ToHelpCategory</a>(<b>string</b>[] <span id="r9 rd" class="r9 r">category</span>, <b>ref bool</b> <span id="r10 rd" class="r10 r">failed</span>)
        {
            <b>if</b> (<span class="r9 r">category</span> == <b>null</b> || <span class="r9 r">category</span>.<span class="i">Length</span> == 0)
                <b>return</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#bffe33d47c20ce20" class="i field">None</a>;
 
            <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r11 rd" class="r11 r">helpCategory</span> = <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#bffe33d47c20ce20" class="i field">None</a>;
 
            <span class="r10 r">failed</span> = <b>false</b>;
 
            <b>for</b> (<b>int</b> <span id="r12 rd" class="r12 r">i</span> = 0; <span class="r12 r">i</span> &lt; <span class="r9 r">category</span>.<span class="i">Length</span>; <span class="r12 r">i</span>++)
            {
                <b>try</b>
                {
                    <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r13 rd" class="r13 r">temp</span> = (<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>)<span class="i">Enum</span>.<span class="i">Parse</span>(<b>typeof</b>(<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>), <span class="r9 r">category</span>[<span class="r12 r">i</span>], <b>true</b>);
 
                    <span class="r11 r">helpCategory</span> |= <span class="r13 r">temp</span>;
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r14 rd" class="r14 r">argumentException</span>)
                {
                    <span class="i">Exception</span> <span id="r15 rd" class="r15 r">e</span> = <b>new</b> <span class="t">HelpCategoryInvalidException</span>(<span class="r9 r">category</span>[<span class="r12 r">i</span>], <span class="r14 r">argumentException</span>);
                    <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r16 rd" class="r16 r">errorRecord</span> = <b>new</b> <a href="../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r15 r">e</span>, <span class="s">&quot;InvalidHelpCategory&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>);
                    <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r16 r">errorRecord</span>);
 
                    <span class="r10 r">failed</span> = <b>true</b>;
                }
            }
 
            <b>return</b> <span class="r11 r">helpCategory</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Change </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">originalHelpObject</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> as per user request.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This method creates a new type to the existing typenames</span>
        <span class="c">///</span><span class="c"> depending on Detailed,Full,Example parameters and adds this</span>
        <span class="c">///</span><span class="c"> new type(s) to the top of the list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">originalHelpObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Full help object to transform.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Transformed help object with new TypeNames.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If Detailed and Full are not specified, nothing is changed.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="791d2d89f49cf4b1" href="../R/791d2d89f49cf4b1.html" target="n" data-glyph="76,1" class="i method">TransformView</a>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r17 rd" class="r17 r">originalHelpObject</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r17 r">originalHelpObject</span> != <b>null</b>,
                <span class="s">&quot;HelpObject should not be null&quot;</span>);
 
            <b>if</b> (<a href="#d71f02a86800cc78" class="i field">_viewTokenToAdd</a> == <a href="#b13b543a3c15aab2" class="t t">HelpView</a>.<a href="#b940b73d7a310834" class="i field">Default</a>)
            {
                <a href="#8a7a95a62ed25451" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Detailed, Full, Examples are not selected. Constructing default view.&quot;</span>);
                <b>return</b> <span class="r17 r">originalHelpObject</span>;
            }
 
            <b>string</b> <span id="r18 rd" class="r18 r">tokenToAdd</span> = <a href="#d71f02a86800cc78" class="i field">_viewTokenToAdd</a>.<span class="i">ToString</span>();
            <span class="c">// We are changing the types without modifying the original object.</span>
            <span class="c">// The contract between help command and helpsystem does not</span>
            <span class="c">// allow us to modify returned help objects.</span>
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r19 rd" class="r19 r">objectToReturn</span> = <span class="r17 r">originalHelpObject</span>.<a href="../engine/MshObject.cs.html#31124c1d85456adb" class="i method">Copy</a>();
            <span class="r19 r">objectToReturn</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
 
            <b>if</b> (<span class="r17 r">originalHelpObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Count</span> == 0)
            {
                <b>string</b> <span id="r20 rd" class="r20 r">typeToAdd</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;HelpInfo#{0}&quot;</span>, <span class="r18 r">tokenToAdd</span>);
                <span class="r19 r">objectToReturn</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r20 r">typeToAdd</span>);
            }
            <b>else</b>
            {
                <span class="c">// User request at the top..</span>
                <b>foreach</b> (<b>string</b> <span id="r21 rd" class="r21 r">typeName</span> <b>in</b> <span class="r17 r">originalHelpObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>)
                {
                    <span class="c">// dont add new types for System.String and System.Object..</span>
                    <span class="c">// as they are handled differently for F&amp;0..(bug935095)</span>
                    <b>if</b> (<span class="r21 r">typeName</span>.<span class="i">ToLowerInvariant</span>().<span class="i">Equals</span>(<span class="s">&quot;system.string&quot;</span>) ||
                        <span class="r21 r">typeName</span>.<span class="i">ToLowerInvariant</span>().<span class="i">Equals</span>(<span class="s">&quot;system.object&quot;</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>string</b> <span id="r22 rd" class="r22 r">typeToAdd</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}#{1}&quot;</span>, <span class="r21 r">typeName</span>, <span class="r18 r">tokenToAdd</span>);
                    <a href="#8a7a95a62ed25451" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Adding type {0}&quot;</span>, <span class="r22 r">typeToAdd</span>);
                    <span class="r19 r">objectToReturn</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r22 r">typeToAdd</span>);
                }
 
                <span class="c">// Existing typenames at the bottom..</span>
                <b>foreach</b> (<b>string</b> <span id="r23 rd" class="r23 r">typeName</span> <b>in</b> <span class="r17 r">originalHelpObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>)
                {
                    <a href="#8a7a95a62ed25451" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Adding type {0}&quot;</span>, <span class="r23 r">typeName</span>);
                    <span class="r19 r">objectToReturn</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r23 r">typeName</span>);
                }
            }
 
            <b>return</b> <span class="r19 r">objectToReturn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter info for patterns identified by Parameter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">HelpInfo object to look for the parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of parameter infos.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <a id="183e0b5b261448a0" href="../R/183e0b5b261448a0.html" target="n" data-glyph="76,1" class="i method">GetParameterInfo</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r24 rd" class="r24 r">helpInfo</span>)
        {
            <span class="i">List</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r25 rd" class="r25 r">parameterInfosList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<a href="#cfcf86d02234054a" class="i property">Parameter</a>.<span class="i">Length</span>);
 
            <b>foreach</b> (<b>var</b> <span id="r26 rd" class="r26 r">parameter</span> <b>in</b> <a href="#cfcf86d02234054a" class="i property">Parameter</a>)
            {
                <b>foreach</b> (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="k">var</a> <span id="r27 rd" class="r27 r">parameterInfo</span> <b>in</b> <span class="r24 r">helpInfo</span>.<a href="HelpInfo.cs.html#8b44f931c5251bd8" class="i method">GetParameter</a>(<span class="r26 r">parameter</span>))
                {
                    <span class="r25 r">parameterInfosList</span>.<span class="i">Add</span>(<span class="r27 r">parameterInfo</span>);
                }
            }
 
            <b>return</b> <span class="r25 r">parameterInfosList</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter info for patterns identified by Parameter property.</span>
        <span class="c">///</span><span class="c"> Writes the parameter info(s) to the output stream. An error is thrown</span>
        <span class="c">///</span><span class="c"> if a parameter with a given pattern is not found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">helpInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">HelpInfo Object to look for the parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b72a6ca7e4ae8fca" href="../R/b72a6ca7e4ae8fca.html" target="n" data-glyph="76,1" class="i method">GetAndWriteParameterInfo</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r28 rd" class="r28 r">helpInfo</span>)
        {
            <a href="#8a7a95a62ed25451" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Searching parameters for {0}&quot;</span>, <span class="r28 r">helpInfo</span>.<a href="HelpInfo.cs.html#aa468d431e2dc4d7" class="i property">Name</a>);
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <span id="r29 rd" class="r29 r">pInfos</span> = <a href="#183e0b5b261448a0" class="i method">GetParameterInfo</a>(<span class="r28 r">helpInfo</span>);
 
            <b>if</b> ((<span class="r29 r">pInfos</span> == <b>null</b>) || (<span class="r29 r">pInfos</span>.<span class="i">Length</span> == 0))
            {
                <span class="i">Exception</span> <span id="r30 rd" class="r30 r">innerException</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Parameter&quot;</span>,
                    <span class="i">HelpErrors</span>.<span class="i">NoParmsFound</span>, <a href="#cfcf86d02234054a" class="i property">Parameter</a>);
                <a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <a href="../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r30 r">innerException</span>, <span class="s">&quot;NoParmsFound&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r28 r">helpInfo</span>));
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r31 rd" class="r31 r">pInfo</span> <b>in</b> <span class="r29 r">pInfos</span>)
                {
                    <a href="../engine/cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r31 r">pInfo</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates input parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">cat</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Category specified by the user.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the request cant be serviced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="02a74a10519da348" href="../R/02a74a10519da348.html" target="n" data-glyph="76,1" class="i method">ValidateAndThrowIfError</a>(<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r32 rd" class="r32 r">cat</span>)
        {
            <b>if</b> (<span class="r32 r">cat</span> == <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#bffe33d47c20ce20" class="i field">None</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// categories that support -Parameter, -Role, -Functionality, -Component parameters</span>
            <b>const</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r33 rd" class="r33 r">supportedCategories</span> =
                <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#a1f331dfd578cfe3" class="i field">Alias</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#70fbe140cce30289" class="i field">ExternalScript</a> |
                <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#fde1a1e12d52cbf0" class="i field">Filter</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#381b81c9081cf7bc" class="i field">Function</a> | <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#0a92357c2fb927c2" class="i field">ScriptCommand</a>;
 
            <b>if</b> ((<span class="r32 r">cat</span> &amp; <span class="r33 r">supportedCategories</span>) == 0)
            {
                <b>if</b> (<a href="#cfcf86d02234054a" class="i property">Parameter</a> != <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Parameter&quot;</span>,
                        <span class="i">HelpErrors</span>.<span class="i">ParamNotSupported</span>, <span class="s">&quot;-Parameter&quot;</span>);
                }
 
                <b>if</b> (<a href="#351516b42029e2d0" class="i property">Component</a> != <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Component&quot;</span>,
                        <span class="i">HelpErrors</span>.<span class="i">ParamNotSupported</span>, <span class="s">&quot;-Component&quot;</span>);
                }
 
                <b>if</b> (<a href="#6ac28c075ebaaf13" class="i property">Role</a> != <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Role&quot;</span>,
                        <span class="i">HelpErrors</span>.<span class="i">ParamNotSupported</span>, <span class="s">&quot;-Role&quot;</span>);
                }
 
                <b>if</b> (<a href="#569b93699d877f15" class="i property">Functionality</a> != <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Functionality&quot;</span>,
                        <span class="i">HelpErrors</span>.<span class="i">ParamNotSupported</span>, <span class="s">&quot;-Functionality&quot;</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method used to Write the help object onto the output</span>
        <span class="c">///</span><span class="c"> stream or show online help (URI extracted from the HelpInfo)</span>
        <span class="c">///</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="31fc7fddb685107e" href="../R/31fc7fddb685107e.html" target="n" data-glyph="76,1" class="i method">WriteObjectsOrShowOnlineHelp</a>(<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r34 rd" class="r34 r">helpInfo</span>, <b>bool</b> <span id="r35 rd" class="r35 r">showFullHelp</span>)
        {
            <b>if</b> (<span class="r34 r">helpInfo</span> != <b>null</b>)
            {
                <span class="c">// online help can be showed only if showFullHelp is true..</span>
                <span class="c">// showFullHelp will be false when the help tries to display multiple help topics..</span>
                <span class="c">// -Online should not work when multiple help topics are displayed.</span>
                <b>if</b> (<span class="r35 r">showFullHelp</span> &amp;&amp; <a href="#85ac89b42c239d77" class="i field">_showOnlineHelp</a>)
                {
                    <b>bool</b> <span id="r36 rd" class="r36 r">onlineUriFound</span> = <b>false</b>;
                    <span class="c">// show online help</span>
                    <a href="#8a7a95a62ed25451" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Preparing to show help online.&quot;</span>);
                    <span class="i">Uri</span> <span id="r37 rd" class="r37 r">onlineUri</span> = <span class="r34 r">helpInfo</span>.<a href="HelpInfo.cs.html#1199a0f2a1354639" class="i method">GetUriForOnlineHelp</a>();
                    <b>if</b> (<span class="r37 r">onlineUri</span> != <b>null</b>)
                    {
                        <span class="r36 r">onlineUriFound</span> = <b>true</b>;
                        <a href="#04b772d6d2f1fc24" class="i method">LaunchOnlineHelp</a>(<span class="r37 r">onlineUri</span>);
                        <b>return</b>;
                    }
 
                    <b>if</b> (!<span class="r36 r">onlineUriFound</span>)
                    {
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">NoURIFound</span>);
                    }
                }
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                <b>else</b> <b>if</b> (<span class="r35 r">showFullHelp</span> &amp;&amp; <a href="#740fd3c3af7c9dad" class="i property">ShowWindow</a>)
                {
                    <a href="#2fb2aa4343172da0" class="i field">graphicalHostReflectionWrapper</a>.<a href="../utils/GraphicalHostReflectionWrapper.cs.html#6e85f5fb240f62d7" class="i method">CallStaticMethod</a>(<span class="s">&quot;ShowHelpWindow&quot;</span>, <span class="r34 r">helpInfo</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>, <a href="#eb5836f612b480de" class="k">this</a>);
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <b>else</b>
                {
                    <span class="c">// show inline help</span>
                    <b>if</b> (<span class="r35 r">showFullHelp</span>)
                    {
                        <b>if</b> (<a href="#cfcf86d02234054a" class="i property">Parameter</a> != <b>null</b>)
                        {
                            <a href="#b72a6ca7e4ae8fca" class="i method">GetAndWriteParameterInfo</a>(<span class="r34 r">helpInfo</span>);
                        }
                        <b>else</b>
                        {
                            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r38 rd" class="r38 r">objectToReturn</span> = <a href="#791d2d89f49cf4b1" class="i method">TransformView</a>(<span class="r34 r">helpInfo</span>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>);
                            <span class="r38 r">objectToReturn</span>.<a href="../engine/MshObject.cs.html#46fe0e4bd3e1bb79" class="i property">IsHelpObject</a> = <b>true</b>;
                            <a href="../engine/cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r38 r">objectToReturn</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<a href="#cfcf86d02234054a" class="i property">Parameter</a> != <b>null</b>)
                        {
                            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <span id="r39 rd" class="r39 r">pInfos</span> = <a href="#183e0b5b261448a0" class="i method">GetParameterInfo</a>(<span class="r34 r">helpInfo</span>);
 
                            <b>if</b> ((<span class="r39 r">pInfos</span> == <b>null</b>) || (<span class="r39 r">pInfos</span>.<span class="i">Length</span> == 0))
                            {
                                <b>return</b>;
                            }
                        }
 
                        <a href="../engine/cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r34 r">helpInfo</span>.<a href="HelpInfo.cs.html#9df2dd4c986684c9" class="i property">ShortHelp</a>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Opens the Uri. System&#39;s default application will be used</span>
        <span class="c">///</span><span class="c"> to show the uri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">uriToLaunch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="04b772d6d2f1fc24" href="../R/04b772d6d2f1fc24.html" target="n" data-glyph="76,1" class="i method">LaunchOnlineHelp</a>(<span class="i">Uri</span> <span id="r40 rd" class="r40 r">uriToLaunch</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r40 r">uriToLaunch</span> != <b>null</b>, <span class="s">&quot;uriToLaunch should not be null&quot;</span>);
 
            <b>if</b> (!<span class="r40 r">uriToLaunch</span>.<span class="i">Scheme</span>.<span class="i">Equals</span>(<span class="s">&quot;http&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                !<span class="r40 r">uriToLaunch</span>.<span class="i">Scheme</span>.<span class="i">Equals</span>(<span class="s">&quot;https&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">ProtocolNotSupported</span>,
                    <span class="r40 r">uriToLaunch</span>.<span class="i">ToString</span>(),
                    <span class="s">&quot;http&quot;</span>,
                    <span class="s">&quot;https&quot;</span>);
            }
 
            <span class="c">// we use this test hook is to avoid actually calling out to another process</span>
            <b>if</b> (<a href="../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../engine/Utils.cs.html#1ac48e16298071ba" class="i field">BypassOnlineHelpRetrieval</a>)
            {
                <a href="#eb5836f612b480de" class="k">this</a>.<span class="i">WriteObject</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">HelpDisplayStrings</span>.<span class="i">OnlineHelpUri</span>, <span class="r40 r">uriToLaunch</span>.<span class="i">OriginalString</span>));
                <b>return</b>;
            }
 
            <span class="i">Exception</span> <span id="r41 rd" class="r41 r">exception</span> = <b>null</b>;
            <b>bool</b> <span id="r42 rd" class="r42 r">wrapCaughtException</span> = <b>true</b>;
            <b>try</b>
            {
                <a href="#eb5836f612b480de" class="k">this</a>.<span class="i">WriteVerbose</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">HelpDisplayStrings</span>.<span class="i">OnlineHelpUri</span>, <span class="r40 r">uriToLaunch</span>.<span class="i">OriginalString</span>));
                <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Process</span> <span id="r43 rd" class="r43 r">browserProcess</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Process</span>();
 
                <b>if</b> (<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#38977c53f94fb1a0" class="i property">IsNanoServer</a> || <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#aa5ad57a38d993ae" class="i property">IsIoT</a>)
                {
                    <span class="c">// We cannot open the URL in browser on headless SKUs.</span>
                    <span class="r42 r">wrapCaughtException</span> = <b>false</b>;
                    <span class="r41 r">exception</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">CannotLaunchURI</span>, <span class="r40 r">uriToLaunch</span>.<span class="i">OriginalString</span>);
                }
                <b>else</b>
                {
                    <span class="r43 r">browserProcess</span>.<span class="i">StartInfo</span>.<span class="i">FileName</span> = <span class="r40 r">uriToLaunch</span>.<span class="i">OriginalString</span>;
                    <span class="r43 r">browserProcess</span>.<span class="i">StartInfo</span>.<span class="i">UseShellExecute</span> = <b>true</b>;
                    <span class="r43 r">browserProcess</span>.<span class="i">Start</span>();
                }
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r44 rd" class="r44 r">ioe</span>)
            {
                <span class="r41 r">exception</span> = <span class="r44 r">ioe</span>;
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">ComponentModel</span>.<span class="i">Win32Exception</span> <span id="r45 rd" class="r45 r">we</span>)
            {
                <span class="r41 r">exception</span> = <span class="r45 r">we</span>;
            }
 
            <b>if</b> (<span class="r41 r">exception</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r42 r">wrapCaughtException</span>)
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="r41 r">exception</span>, <span class="i">HelpErrors</span>.<span class="i">CannotLaunchURI</span>, <span class="r40 r">uriToLaunch</span>.<span class="i">OriginalString</span>);
                <b>else</b>
                    <b>throw</b> <span class="r41 r">exception</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private void</b> <a id="501f426b15135681" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HelpSystem_OnProgress</a>(<b>object</b> <span id="r46 rd" class="r46 r">sender</span>, <a href="HelpSystem.cs.html#df62d1444da93907" class="t t">HelpProgressEventArgs</a> <span id="r47 rd" class="r47 r">arg</span>)
        {
            <a href="../engine/ProgressRecord.cs.html#d79b27687c6ed8c8" class="k">var</a> <span id="r48 rd" class="r48 r">record</span> = <b>new</b> <a href="../engine/ProgressRecord.cs.html#fc5a01f49984a3f9" class="t constructor">ProgressRecord</a>(0, <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/CommandBase.cs.html#1f4a1f38862b466a" class="i property">CommandInfo</a>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r47 r">arg</span>.<a href="HelpSystem.cs.html#1cded888b4ea7c94" class="i property">Activity</a>)
            {
                <a href="../engine/ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a> = <span class="r47 r">arg</span>.<a href="HelpSystem.cs.html#7e44d9a1b1953125" class="i property">PercentComplete</a>
            };
 
            <a href="../engine/cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r48 r">record</span>);
        }
 
        <b>private void</b> <a id="eba5fedb7ea5303d" href="../R/eba5fedb7ea5303d.html" target="n" data-glyph="76,1" class="i method">HelpSystem_OnComplete</a>()
        {
            <a href="../engine/ProgressRecord.cs.html#d79b27687c6ed8c8" class="k">var</a> <span id="r49 rd" class="r49 r">record</span> = <b>new</b> <a href="../engine/ProgressRecord.cs.html#fc5a01f49984a3f9" class="t constructor">ProgressRecord</a>(0, <a href="#eb5836f612b480de" class="k">this</a>.<a href="../engine/CommandBase.cs.html#1f4a1f38862b466a" class="i property">CommandInfo</a>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="s">&quot;Completed&quot;</span>)
            {
                <a href="../engine/ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../engine/ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../engine/ProgressRecord.cs.html#be29e101fe03f5d0" class="i field">Completed</a>
            };
 
            <a href="../engine/cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r49 r">record</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods for verification of parameters against NoLanguage mode
 
        <b>internal static void</b> <a id="ed9870df48b3fa67" href="../R/ed9870df48b3fa67.html" target="n" data-glyph="74,1" class="i method">VerifyParameterForbiddenInRemoteRunspace</a>(<a href="../engine/cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r50 rd" class="r50 r">cmdlet</span>, <b>string</b> <span id="r51 rd" class="r51 r">parameterName</span>)
        {
            <b>if</b> (<a href="../engine/NativeCommandProcessor.cs.html#27173c2526d1ef9a" class="t t">NativeCommandProcessor</a>.<a href="../engine/NativeCommandProcessor.cs.html#20e4f9ea3187f2d9" class="i property">IsServerSide</a>)
            {
                <b>string</b> <span id="r52 rd" class="r52 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">CommandBaseStrings</span>.<span class="i">ParameterNotValidInRemoteRunspace</span>,
                    <span class="r50 r">cmdlet</span>.<a href="../engine/CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>.<a href="../engine/InvocationInfo.cs.html#57f452abf157b50b" class="i property">InvocationName</a>,
                    <span class="r51 r">parameterName</span>);
                <span class="i">Exception</span> <span id="r53 rd" class="r53 r">e</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r52 r">message</span>);
                <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r54 rd" class="r54 r">errorRecord</span> = <b>new</b> <a href="../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r53 r">e</span>, <span class="s">&quot;ParameterNotValidInRemoteRunspace&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>);
                <span class="r50 r">cmdlet</span>.<a href="../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r54 r">errorRecord</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> trace
 
        [<span class="i">TraceSourceAttribute</span>(<span class="s">&quot;GetHelpCommand &quot;</span>, <span class="s">&quot;GetHelpCommand &quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="8a7a95a62ed25451" href="../R/8a7a95a62ed25451.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;GetHelpCommand &quot;</span>, <span class="s">&quot;GetHelpCommand &quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper methods used as powershell extension from a types file.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="25b01c5d9cf1d574" href="../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">GetHelpCodeMethods</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether the default runspace associated with the current thread has the standard Get-Help cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">return</span><span class="c">&gt;</span><span class="c">True if Get-Help is found, false otherwise.</span><span class="c">&lt;/</span><span class="c">return</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="fada1d11cb1ccd41" href="../R/fada1d11cb1ccd41.html" target="n" data-glyph="76,1" class="i method">DoesCurrentRunspaceIncludeCoreHelpCmdlet</a>()
        {
            <a href="../engine/InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r55 rd" class="r55 r">iss</span> = <a href="../engine/hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../engine/hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../engine/hostifaces/Connection.cs.html#8f24c824cfe9458d" class="i property">InitialSessionState</a>;
            <b>if</b> (<span class="r55 r">iss</span> <b>is null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">Collection</span>&lt;<a href="../engine/InitialSessionState.cs.html#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt; <span id="r56 rd" class="r56 r">getHelpEntries</span> = <span class="r55 r">iss</span>.<a href="../engine/InitialSessionState.cs.html#2d45d0b0db0079ba" class="i property">Commands</a><a href="../engine/InitialSessionState.cs.html#8a6a2b8d34f0d716">[</a><span class="s">&quot;Get-Help&quot;</span>];
            <a href="../engine/InitialSessionState.cs.html#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a> <span id="r57 rd" class="r57 r">getHelpEntry</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r58 rd" class="r58 r">i</span> = 0; <span class="r58 r">i</span> &lt; <span class="r56 r">getHelpEntries</span>.<span class="i">Count</span>; ++<span class="r58 r">i</span>)
            {
                <b>if</b> (<span class="r56 r">getHelpEntries</span>[<span class="r58 r">i</span>].<span class="i">Visibility</span> <b>is not</b> <a href="../engine/SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="../engine/SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
                {
                    <b>continue</b>;
                }
 
                <span class="c">// If we have multiple entries for Get-Help,</span>
                <span class="c">// our assumption is that the standard Get-Help is not available.</span>
                <b>if</b> (<span class="r57 r">getHelpEntry</span> <b>is not null</b>)
                {
                    <b>return</b> <b>false</b>;
                }
 
                <span class="r57 r">getHelpEntry</span> = <span class="r56 r">getHelpEntries</span>[<span class="r58 r">i</span>];
            }
 
            <b>return</b> <span class="r57 r">getHelpEntry</span> <b>is</b> <a href="../engine/InitialSessionState.cs.html#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r59 rd" class="r59 r">getHelpCmdlet</span>
                &amp;&amp; <span class="r59 r">getHelpCmdlet</span>.<a href="../engine/InitialSessionState.cs.html#41fc8f2889edf406" class="i property">ImplementingType</a> == <b>typeof</b>(<a href="#eb5836f612b480de" class="t t">GetHelpCommand</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the HelpUri given a CommandInfo instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">commandInfoPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CommandInfo instance wrapped as PSObject</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> null if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">commandInfoPSObject</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a CommandInfo type.</span>
        <span class="c">///</span><span class="c"> null if HelpUri could not be retrieved either from CommandMetadata or</span>
        <span class="c">///</span><span class="c"> help content.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1055:UriReturnValuesShouldNotBeStrings&quot;</span>)]
        <b>public static string</b> <a id="116585cd1c5a6a3d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHelpUri</a>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r60 rd" class="r60 r">commandInfoPSObject</span>)
        {
            <b>if</b> (<span class="r60 r">commandInfoPSObject</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r61 rd" class="r61 r">cmdInfo</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r60 r">commandInfoPSObject</span>) <b>as</b> <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
            <span class="c">// GetHelpUri helper method is expected to be used only by System.Management.Automation.CommandInfo</span>
            <span class="c">// objects from types.ps1xml</span>
            <b>if</b> ((<span class="r61 r">cmdInfo</span> == <b>null</b>) || (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>)))
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <span class="c">// The type checking is needed to avoid a try..catch exception block as</span>
            <span class="c">// the CommandInfo.CommandMetadata throws an InvalidOperationException</span>
            <span class="c">// instead of returning null.</span>
            <b>if</b> ((<span class="r61 r">cmdInfo</span> <b>is</b> <a href="../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>) || (<span class="r61 r">cmdInfo</span> <b>is</b> <a href="../engine/FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>) ||
                (<span class="r61 r">cmdInfo</span> <b>is</b> <a href="../engine/ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a>) || (<span class="r61 r">cmdInfo</span> <b>is</b> <a href="../engine/ScriptInfo.cs.html#0ebcce9a1485125a" class="t t">ScriptInfo</a>))
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>))
                {
                    <b>return</b> <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>;
                }
            }
 
            <a href="../engine/AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r62 rd" class="r62 r">aliasInfo</span> = <span class="r61 r">cmdInfo</span> <b>as</b> <a href="../engine/AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>;
            <b>if</b> ((<span class="r62 r">aliasInfo</span> != <b>null</b>) &amp;&amp;
                (<span class="r62 r">aliasInfo</span>.<a href="../engine/CommandInfo.cs.html#72d05582e4d21281" class="i property">ExternalCommandMetadata</a> != <b>null</b>) &amp;&amp;
                (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r62 r">aliasInfo</span>.<a href="../engine/CommandInfo.cs.html#72d05582e4d21281" class="i property">ExternalCommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>)))
            {
                <b>return</b> <span class="r62 r">aliasInfo</span>.<a href="../engine/CommandInfo.cs.html#72d05582e4d21281" class="i property">ExternalCommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>;
            }
 
            <span class="c">// if everything else fails..depend on Get-Help infrastructure to get us the Uri.</span>
            <b>string</b> <span id="r63 rd" class="r63 r">cmdName</span> = <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>))
            {
                <span class="r63 r">cmdName</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                        <span class="s">&quot;{0}\\{1}&quot;</span>, <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>);
            }
 
            <b>if</b> (<a href="#fada1d11cb1ccd41" class="i method">DoesCurrentRunspaceIncludeCoreHelpCmdlet</a>())
            {
                <span class="c">// Win8: 651300 if core get-help is present in the runspace (and it is the only get-help command), use</span>
                <span class="c">// help system directly and avoid perf penalty.</span>
                <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r64 rd" class="r64 r">currentContext</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="../engine/hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../engine/hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
                <b>if</b> ((<span class="r64 r">currentContext</span> != <b>null</b>) &amp;&amp; (<span class="r64 r">currentContext</span>.<a href="../engine/ExecutionContext.cs.html#a86262768086e411" class="i property">HelpSystem</a> != <b>null</b>))
                {
                    <a href="HelpRequest.cs.html#761f9f174720770b" class="t t">HelpRequest</a> <span id="r65 rd" class="r65 r">helpRequest</span> = <b>new</b> <a href="HelpRequest.cs.html#70f61dce8491c9d3" class="t constructor">HelpRequest</a>(<span class="r63 r">cmdName</span>, <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>);
                    <span class="r65 r">helpRequest</span>.<a href="HelpRequest.cs.html#953d844df2595ba0" class="i property">ProviderContext</a> = <b>new</b> <span class="t">ProviderContext</span>(
                        <b>string</b>.<span class="i">Empty</span>,
                        <span class="r64 r">currentContext</span>,
                        <span class="r64 r">currentContext</span>.<a href="../engine/ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>);
                    <span class="r65 r">helpRequest</span>.<a href="HelpRequest.cs.html#971cc7841ce2f191" class="i property">CommandOrigin</a> = <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../engine/SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a>;
                    <b>foreach</b> (
                        <span class="i">Uri</span> <span id="r66 rd" class="r66 r">result</span> <b>in</b>
                            <span class="r64 r">currentContext</span>.<a href="../engine/ExecutionContext.cs.html#a86262768086e411" class="i property">HelpSystem</a>.<a href="HelpSystem.cs.html#3247bb3cd6900ebc" class="i method">ExactMatchHelp</a>(<span class="r65 r">helpRequest</span>).<span class="i">Select</span>(
                                <span id="r67 rd" class="r67 r">helpInfo</span> =&gt; <span class="r67 r">helpInfo</span>.<span class="i">GetUriForOnlineHelp</span>()).<span class="i">Where</span>(<b>static</b> <span id="r68 rd" class="r68 r">result</span> =&gt; <span class="r68 r">result</span> != <b>null</b>))
                    {
                        <b>return</b> <span class="r66 r">result</span>.<span class="i">OriginalString</span>;
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">// win8: 546025. Using Get-Help as command, instead of calling HelpSystem.ExactMatchHelp</span>
                <span class="c">// for the following reasons:</span>
                <span class="c">// 1. Exchange creates proxies for Get-Command and Get-Help in their scenario</span>
                <span class="c">// 2. This method is primarily used to get uri faster while serializing the CommandInfo objects (from Get-Command)</span>
                <span class="c">// 3. Exchange uses Get-Help proxy to not call Get-Help cmdlet at-all while serializing CommandInfo objects</span>
                <span class="c">// 4. Using HelpSystem directly will not allow Get-Help proxy to do its job.</span>
                <a href="../engine/hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r69 rd" class="r69 r">getHelpPS</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../engine/hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../engine/hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../engine/hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../engine/hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>)
                    .<a href="../engine/hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;get-help&quot;</span>)
                    .<a href="../engine/hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r63 r">cmdName</span>)
                    .<span class="i">AddParameter</span>(<span class="s">&quot;Category&quot;</span>, <span class="r61 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#4e5a909d9350b765" class="i property">HelpCategory</a>.<span class="i">ToString</span>());
                <b>try</b>
                {
                    <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r70 rd" class="r70 r">helpInfos</span> = <span class="r69 r">getHelpPS</span>.<a href="../engine/hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
 
                    <b>if</b> (<span class="r70 r">helpInfos</span> != <b>null</b>)
                    {
                        <b>for</b> (<b>int</b> <span id="r71 rd" class="r71 r">index</span> = 0; <span class="r71 r">index</span> &lt; <span class="r70 r">helpInfos</span>.<span class="i">Count</span>; <span class="r71 r">index</span>++)
                        {
                            <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a> <span id="r72 rd" class="r72 r">helpInfo</span>;
                            <b>if</b> (<a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>&gt;(<span class="r70 r">helpInfos</span>[<span class="r71 r">index</span>], <b>out</b> <span class="r72 r">helpInfo</span>))
                            {
                                <span class="i">Uri</span> <span id="r73 rd" class="r73 r">result</span> = <span class="r72 r">helpInfo</span>.<a href="HelpInfo.cs.html#1199a0f2a1354639" class="i method">GetUriForOnlineHelp</a>();
                                <b>if</b> (<span class="r73 r">result</span> != <b>null</b>)
                                {
                                    <b>return</b> <span class="r73 r">result</span>.<span class="i">OriginalString</span>;
                                }
                            }
                            <b>else</b>
                            {
                                <span class="i">Uri</span> <span id="r74 rd" class="r74 r">result</span> = <a href="BaseCommandHelpInfo.cs.html#f41b1778ad8c8b7f" class="t t">BaseCommandHelpInfo</a>.<span class="i">GetUriFromCommandPSObject</span>(<span class="r70 r">helpInfos</span>[<span class="r71 r">index</span>]);
                                <b>return</b> (<span class="r74 r">result</span> != <b>null</b>) ? <span class="r74 r">result</span>.<span class="i">OriginalString</span> : <b>string</b>.<span class="i">Empty</span>;
                            }
                        }
                    }
                }
                <b>finally</b>
                {
                    <span class="r69 r">getHelpPS</span>.<a href="../engine/hostifaces/PowerShell.cs.html#18cbb6bfae891ee7" class="i method">Dispose</a>();
                }
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
