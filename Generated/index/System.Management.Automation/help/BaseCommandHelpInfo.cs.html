<!DOCTYPE html>
<html><head><title>BaseCommandHelpInfo.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(497);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/BaseCommandHelpInfo.cs" target="_top">help\BaseCommandHelpInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class BaseCommandHelpInfo provides common functionality for</span>
    <span class="c">///</span><span class="c"> extracting information from FullHelp property.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="f41b1778ad8c8b7f" href="../R/f41b1778ad8c8b7f.html" target="n" data-glyph="2,0" class="t t">BaseCommandHelpInfo</a> : <a href="HelpInfo.cs.html#d64eccc845958c22" class="t t">HelpInfo</a>
    {
        <b>internal</b> <a id="fd1197f87f8fcc25" href="../R/fd1197f87f8fcc25.html" target="n" data-glyph="74,1" class="t constructor">BaseCommandHelpInfo</a>(<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <span id="r0 rd" class="r0 r">helpCategory</span>)
            : <a href="HelpInfo.cs.html#70b9cd215a8a6b75" class="k">base</a>()
        {
            <a href="#e8214cd2bfe2c12b" class="i property">HelpCategory</a> = <span class="r0 r">helpCategory</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Basic Help Properties
 
        <b>internal</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b5fc80f4dc79c45e" href="../R/b5fc80f4dc79c45e.html" target="n" data-glyph="104,1" class="i property">Details</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a> == <b>null</b>)
                    <b>return</b> <b>null</b>;
 
                <b>if</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>] == <b>null</b> ||
                    <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>return</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Details&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Name of command</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal override string</b> <a id="b26bb8edfbc96947" href="../R/b26bb8edfbc96947.html" target="n" data-glyph="104,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1 rd" class="r1 r">commandDetails</span> = <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="#b5fc80f4dc79c45e" class="i property">Details</a>;
                <b>if</b> (<span class="r1 r">commandDetails</span> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>if</b> (<span class="r1 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>] == <b>null</b> ||
                    <span class="r1 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>string</b> <span id="r2 rd" class="r2 r">name</span> = <span class="r1 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Name&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                <b>if</b> (<span class="r2 r">name</span> == <b>null</b>)
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
                <b>return</b> <span class="r2 r">name</span>.<span class="i">Trim</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Synopsis for this command help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Synopsis for this command help</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal override string</b> <a id="53eba99fbba774dd" href="../R/53eba99fbba774dd.html" target="n" data-glyph="104,1" class="i property">Synopsis</a>
        {
            <b>get</b>
            {
                <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">commandDetails</span> = <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="#b5fc80f4dc79c45e" class="i property">Details</a>;
                <b>if</b> (<span class="r3 r">commandDetails</span> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>if</b> (<span class="r3 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>] == <b>null</b> ||
                    <span class="r3 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>object</b>[] <span id="r4 rd" class="r4 r">synopsisItems</span> = (<b>object</b>[])<a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                    <span class="r3 r">commandDetails</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>,
                    <b>typeof</b>(<b>object</b>[]),
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <b>if</b> (<span class="r4 r">synopsisItems</span> == <b>null</b> || <span class="r4 r">synopsisItems</span>.<span class="i">Length</span> == 0)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r5 rd" class="r5 r">firstSynopsisItem</span> = <span class="r4 r">synopsisItems</span>[0] == <b>null</b> ? <b>null</b> : <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r4 r">synopsisItems</span>[0]);
                <b>if</b> (<span class="r5 r">firstSynopsisItem</span> == <b>null</b> ||
                    <span class="r5 r">firstSynopsisItem</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>] == <b>null</b> ||
                    <span class="r5 r">firstSynopsisItem</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>string</b> <span id="r6 rd" class="r6 r">synopsis</span> = <span class="r5 r">firstSynopsisItem</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                <b>if</b> (<span class="r6 r">synopsis</span> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>return</b> <span class="r6 r">synopsis</span>.<span class="i">Trim</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help category for this command help, which is constantly HelpCategory.Command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Help category for this command help</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a> <a id="e8214cd2bfe2c12b" href="../R/e8214cd2bfe2c12b.html" target="n" data-glyph="104,1" class="i property">HelpCategory</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the Uri used by get-help cmdlet to show help</span>
        <span class="c">///</span><span class="c"> online. Returns only the first uri found under</span>
        <span class="c">///</span><span class="c"> RelatedLinks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Null if no Uri is specified by the helpinfo or a</span>
        <span class="c">///</span><span class="c"> valid Uri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specified Uri is not valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">Uri</span> <a id="da38f636253f98cf" href="../R/da38f636253f98cf.html" target="n" data-glyph="74,1" class="i method">GetUriForOnlineHelp</a>()
        {
            <span class="i">Uri</span> <span id="r7 rd" class="r7 r">result</span> = <b>null</b>;
            <span class="i">UriFormatException</span> <span id="r8 rd" class="r8 r">uriFormatException</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r7 r">result</span> = <a href="#66e8a6dc1dac4d7a" class="i method">GetUriFromCommandPSObject</a>(<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>);
                <b>if</b> (<span class="r7 r">result</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r7 r">result</span>;
                }
            }
            <b>catch</b> (<span class="i">UriFormatException</span> <span id="r9 rd" class="r9 r">urie</span>)
            {
                <span class="r8 r">uriFormatException</span> = <span class="r9 r">urie</span>;
            }
            <span class="c">// else get uri from CommandInfo HelpUri attribute</span>
            <span class="r7 r">result</span> = <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="#1336d9eacb88038e" class="i method">LookupUriFromCommandInfo</a>();
            <b>if</b> (<span class="r7 r">result</span> != <b>null</b>)
            {
                <b>return</b> <span class="r7 r">result</span>;
            }
            <b>else</b> <b>if</b> (<span class="r8 r">uriFormatException</span> != <b>null</b>)
            {
                <b>throw</b> <span class="r8 r">uriFormatException</span>;
            }
 
            <b>return</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="k">base</a>.<a href="HelpInfo.cs.html#1199a0f2a1354639" class="i method">GetUriForOnlineHelp</a>();
        }
 
        <b>internal</b> <span class="i">Uri</span> <a id="1336d9eacb88038e" href="../R/1336d9eacb88038e.html" target="n" data-glyph="74,1" class="i method">LookupUriFromCommandInfo</a>()
        {
            <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r10 rd" class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>;
            <b>switch</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="#e8214cd2bfe2c12b" class="i property">HelpCategory</a>)
            {
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#e963f9f2b0c66907" class="i field">Cmdlet</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>;
                    <b>break</b>;
 
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#381b81c9081cf7bc" class="i field">Function</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>;
                    <b>break</b>;
 
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#0a92357c2fb927c2" class="i field">ScriptCommand</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#8324208f5ee6d431" class="i field">Script</a>;
                    <b>break</b>;
 
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#70fbe140cce30289" class="i field">ExternalScript</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
                    <b>break</b>;
 
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#fde1a1e12d52cbf0" class="i field">Filter</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#7837d2f5f0343c5e" class="i field">Filter</a>;
                    <b>break</b>;
 
                <b>case</b> <span class="i n">Automation</span>.<a href="HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>.<a href="HelpSystem.cs.html#10f71224f93d9c50" class="i field">Configuration</a>:
                    <span class="r10 r">cmdTypesToLookFor</span> = <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#2a673544a3a7e93f" class="i field">Configuration</a>;
                    <b>break</b>;
 
                <b>default</b>:
                    <b>return</b> <b>null</b>;
            }
 
            <b>string</b> <span id="r11 rd" class="r11 r">commandName</span> = <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="#b26bb8edfbc96947" class="i property">Name</a>;
            <b>string</b> <span id="r12 rd" class="r12 r">moduleName</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;ModuleName&quot;</span>] != <b>null</b>)
            {
                <a href="../engine/MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r13 rd" class="r13 r">moduleNameNP</span> = <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;ModuleName&quot;</span>] <b>as</b> <a href="../engine/MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a>;
                <b>if</b> (<span class="r13 r">moduleNameNP</span> != <b>null</b>)
                {
                    <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<b>string</b>&gt;(<span class="r13 r">moduleNameNP</span>.<a href="../engine/MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                                            <b>out</b> <span class="r12 r">moduleName</span>);
                }
            }
 
            <b>string</b> <span id="r14 rd" class="r14 r">commandToSearch</span> = <span class="r11 r">commandName</span>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r12 r">moduleName</span>))
            {
                <span class="r14 r">commandToSearch</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="s">&quot;{0}\\{1}&quot;</span>, <span class="r12 r">moduleName</span>, <span class="r11 r">commandName</span>);
            }
 
            <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r15 rd" class="r15 r">context</span> = <a href="../engine/hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../engine/hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r15 r">context</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>try</b>
            {
                <a href="../engine/CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r16 rd" class="r16 r">cmdInfo</span> = <b>null</b>;
 
                <b>if</b> (<span class="r10 r">cmdTypesToLookFor</span> == <a href="../engine/CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../engine/CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>)
                {
                    <span class="r16 r">cmdInfo</span> = <span class="r15 r">context</span>.<a href="../engine/ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#236f6ceba41f8f3e" class="i property">InvokeCommand</a>.<a href="../engine/MshCmdlet.cs.html#f14de699060a0394" class="i method">GetCmdlet</a>(<span class="r14 r">commandToSearch</span>);
                }
                <b>else</b>
                {
                    <span class="r16 r">cmdInfo</span> = <span class="r15 r">context</span>.<a href="../engine/ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../engine/SessionStatePublic.cs.html#236f6ceba41f8f3e" class="i property">InvokeCommand</a>.<a href="../engine/MshCmdlet.cs.html#1414c8a83e415e8c" class="i method">GetCommands</a>(<span class="r14 r">commandToSearch</span>, <span class="r10 r">cmdTypesToLookFor</span>, <b>false</b>).<span class="i">FirstOrDefault</span>();
                }
 
                <b>if</b> ((<span class="r16 r">cmdInfo</span> == <b>null</b>) || (<span class="r16 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a> == <b>null</b>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r17 rd" class="r17 r">uriString</span> = <span class="r16 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r17 r">uriString</span>))
                {
                    <b>if</b> (!<span class="i n">System</span>.<span class="i">Uri</span>.<span class="i">IsWellFormedUriString</span>(<span class="r17 r">uriString</span>, <span class="i">UriKind</span>.<span class="i">RelativeOrAbsolute</span>))
                    {
                        <span class="c">// WinBlue: 545315 Online help links are broken with localized help</span>
                        <span class="c">// Example: https://go.microsoft.com/fwlink/?LinkID=113324 (moglicherwei se auf Englisch)</span>
                        <span class="c">// Split the string based on &lt;s&gt; (space). We decided to go with this approach as</span>
                        <span class="c">// UX localization authors use spaces. Correctly extracting only the wellformed URI</span>
                        <span class="c">// is out-of-scope for this fix.</span>
                        <b>string</b>[] <span id="r18 rd" class="r18 r">tempUriSplitArray</span> = <span class="r17 r">uriString</span>.<span class="i">Split</span>(<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../engine/Utils.cs.html#ae9efc7d00636f59" class="i field">Space</a>);
                        <span class="r17 r">uriString</span> = <span class="r18 r">tempUriSplitArray</span>[0];
                    }
 
                    <b>try</b>
                    {
                        <b>return</b> <b>new</b> <span class="i n">System</span>.<span class="i">Uri</span>(<span class="r17 r">uriString</span>);
                        <span class="c">// return only the first Uri (ignore other uris)</span>
                    }
                    <b>catch</b> (<span class="i">UriFormatException</span>)
                    {
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">InvalidURI</span>,
                                                                         <span class="r16 r">cmdInfo</span>.<a href="../engine/CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../engine/CommandMetadata.cs.html#5396c381060eb27f" class="i property">HelpUri</a>);
                    }
                }
            }
            <b>catch</b> (<a href="../utils/CommandDiscoveryExceptions.cs.html#d61739861b769224" class="t t">CommandNotFoundException</a>)
            {
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <span class="i">Uri</span> <a id="66e8a6dc1dac4d7a" href="../R/66e8a6dc1dac4d7a.html" target="n" data-glyph="74,1" class="i method">GetUriFromCommandPSObject</a>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r19 rd" class="r19 r">commandFullHelp</span>)
        {
            <span class="c">// this object knows Maml format...</span>
            <span class="c">// So retrieve Uri information as per the format..</span>
            <b>if</b> ((<span class="r19 r">commandFullHelp</span> == <b>null</b>) ||
                (<span class="r19 r">commandFullHelp</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;relatedLinks&quot;</span>] == <b>null</b>) ||
                (<span class="r19 r">commandFullHelp</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;relatedLinks&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
            {
                <span class="c">// return the default..</span>
                <b>return</b> <b>null</b>;
            }
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r20 rd" class="r20 r">relatedLinks</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r19 r">commandFullHelp</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;relatedLinks&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            <b>if</b> (<span class="r20 r">relatedLinks</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;navigationLink&quot;</span>] == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>object</b>[] <span id="r21 rd" class="r21 r">navigationLinks</span> = (<b>object</b>[])<a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                <span class="r20 r">relatedLinks</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;navigationLink&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>,
                <b>typeof</b>(<b>object</b>[]),
                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            <b>foreach</b> (<b>object</b> <span id="r22 rd" class="r22 r">navigationLinkAsObject</span> <b>in</b> <span class="r21 r">navigationLinks</span>)
            {
                <b>if</b> (<span class="r22 r">navigationLinkAsObject</span> == <b>null</b>)
                {
                    <b>continue</b>;
                }
 
                <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r23 rd" class="r23 r">navigationLink</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r22 r">navigationLinkAsObject</span>);
                <a href="../engine/MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r24 rd" class="r24 r">uriNP</span> = <span class="r23 r">navigationLink</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;uri&quot;</span>] <b>as</b> <a href="../engine/MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a>;
                <b>if</b> (<span class="r24 r">uriNP</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r25 rd" class="r25 r">uriString</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<b>string</b>&gt;(<span class="r24 r">uriNP</span>.<a href="../engine/MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r25 r">uriString</span>);
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r25 r">uriString</span>))
                    {
                        <b>if</b> (!<span class="i n">System</span>.<span class="i">Uri</span>.<span class="i">IsWellFormedUriString</span>(<span class="r25 r">uriString</span>, <span class="i">UriKind</span>.<span class="i">RelativeOrAbsolute</span>))
                        {
                            <span class="c">// WinBlue: 545315 Online help links are broken with localized help</span>
                            <span class="c">// Example: https://go.microsoft.com/fwlink/?LinkID=113324 (moglicherwei se auf Englisch)</span>
                            <span class="c">// Split the string based on &lt;s&gt; (space). We decided to go with this approach as</span>
                            <span class="c">// UX localization authors use spaces. Correctly extracting only the wellformed URI</span>
                            <span class="c">// is out-of-scope for this fix.</span>
                            <b>string</b>[] <span id="r26 rd" class="r26 r">tempUriSplitArray</span> = <span class="r25 r">uriString</span>.<span class="i">Split</span>(<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../engine/Utils.cs.html#ae9efc7d00636f59" class="i field">Space</a>);
                            <span class="r25 r">uriString</span> = <span class="r26 r">tempUriSplitArray</span>[0];
                        }
 
                        <b>try</b>
                        {
                            <b>return</b> <b>new</b> <span class="i n">System</span>.<span class="i">Uri</span>(<span class="r25 r">uriString</span>);
                            <span class="c">// return only the first Uri (ignore other uris)</span>
                        }
                        <b>catch</b> (<span class="i">UriFormatException</span>)
                        {
                            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">HelpErrors</span>.<span class="i">InvalidURI</span>, <span class="r25 r">uriString</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if help content in help info matches the</span>
        <span class="c">///</span><span class="c"> pattern contained in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">pattern</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The underlying code will usually run pattern.IsMatch() on</span>
        <span class="c">///</span><span class="c"> content it wants to search.</span>
        <span class="c">///</span><span class="c"> Cmdlet help info looks for pattern in Synopsis and</span>
        <span class="c">///</span><span class="c"> DetailedDescription.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">pattern</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="5030bf4be8af6ce2" href="../R/5030bf4be8af6ce2.html" target="n" data-glyph="74,1" class="i method">MatchPatternInContent</a>(<a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r27 rd" class="r27 r">pattern</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r27 r">pattern</span> != <b>null</b>, <span class="s">&quot;pattern cannot be null&quot;</span>);
 
            <b>string</b> <span id="r28 rd" class="r28 r">synopsis</span> = <a href="#53eba99fbba774dd" class="i property">Synopsis</a>;
            <b>string</b> <span id="r29 rd" class="r29 r">detailedDescription</span> = <a href="#ec6f90f40b357ca5" class="i property">DetailedDescription</a>;
 
            <b>if</b> (<span class="r28 r">synopsis</span> == <b>null</b>)
            {
                <span class="r28 r">synopsis</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (<span class="r29 r">detailedDescription</span> == <b>null</b>)
            {
                <span class="r29 r">detailedDescription</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>return</b> <span class="r27 r">pattern</span>.<a href="../engine/regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r28 r">synopsis</span>) || <span class="r27 r">pattern</span>.<a href="../engine/regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r29 r">detailedDescription</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns help information for a parameter(s) identified by pattern.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">pattern</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pattern to search for parameters.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A collection of parameters that match pattern.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <a id="b5447c57146bba4a" href="../R/b5447c57146bba4a.html" target="n" data-glyph="74,1" class="i method">GetParameter</a>(<b>string</b> <span id="r30 rd" class="r30 r">pattern</span>)
        {
            <span class="c">// this object knows Maml format...</span>
            <span class="c">// So retrieve parameter information as per the format..</span>
            <b>if</b> ((<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a> == <b>null</b>) ||
                (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;parameters&quot;</span>] == <b>null</b>) ||
                (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;parameters&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
            {
                <span class="c">// return the default..</span>
                <b>return</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="k">base</a>.<a href="HelpInfo.cs.html#8b44f931c5251bd8" class="i method">GetParameter</a>(<span class="r30 r">pattern</span>);
            }
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r31 rd" class="r31 r">prmts</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;parameters&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
 
            <b>if</b> (<span class="r31 r">prmts</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;parameter&quot;</span>] == <b>null</b>)
            {
                <b>return</b> <a href="HelpInfo.cs.html#d64eccc845958c22" class="k">base</a>.<a href="HelpInfo.cs.html#8b44f931c5251bd8" class="i method">GetParameter</a>(<span class="r30 r">pattern</span>);
            }
 
            <span class="c">// The Maml format simplifies array fields containing only one object</span>
            <span class="c">// by transforming them into the objects themselves. To ensure the consistency</span>
            <span class="c">// of the help command result we change it back into an array.</span>
            <b>var</b> <span id="r32 rd" class="r32 r">param</span> = <span class="r31 r">prmts</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;parameter&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <span id="r33 rd" class="r33 r">paramAsPSObjArray</span> = <b>new</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[1];
 
            <b>if</b> (<span class="r32 r">param</span> <b>is</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r34 rd" class="r34 r">paramPSObj</span>)
            {
                <span class="r33 r">paramAsPSObjArray</span>[0] = <span class="r34 r">paramPSObj</span>;
            }
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <span id="r35 rd" class="r35 r">prmtArray</span> = (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[])<a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                <span class="r33 r">paramAsPSObjArray</span>[0] != <b>null</b> ? <span class="r33 r">paramAsPSObjArray</span> : <span class="r32 r">param</span>,
                <b>typeof</b>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[]),
                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r30 r">pattern</span>))
            {
                <b>return</b> <span class="r35 r">prmtArray</span>;
            }
 
            <span class="i">List</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r36 rd" class="r36 r">returnList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
            <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r37 rd" class="r37 r">matcher</span> = <a href="../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../engine/regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r30 r">pattern</span>, <a href="../engine/regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../engine/regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>foreach</b> (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r38 rd" class="r38 r">prmtr</span> <b>in</b> <span class="r35 r">prmtArray</span>)
            {
                <b>if</b> ((<span class="r38 r">prmtr</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;name&quot;</span>] == <b>null</b>) || (<span class="r38 r">prmtr</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;name&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
                {
                    <b>continue</b>;
                }
 
                <b>string</b> <span id="r39 rd" class="r39 r">prmName</span> = <span class="r38 r">prmtr</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;name&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                <b>if</b> (<span class="r37 r">matcher</span>.<a href="../engine/regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r39 r">prmName</span>))
                {
                    <span class="r36 r">returnList</span>.<span class="i">Add</span>(<span class="r38 r">prmtr</span>);
                }
            }
 
            <b>return</b> <span class="r36 r">returnList</span>.<span class="i">ToArray</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet Help specific Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Detailed Description string of this cmdlet help info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="ec6f90f40b357ca5" href="../R/ec6f90f40b357ca5.html" target="n" data-glyph="104,1" class="i property">DetailedDescription</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a> == <b>null</b>)
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
                <b>if</b> (<a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>] == <b>null</b> ||
                    <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>object</b>[] <span id="r40 rd" class="r40 r">descriptionItems</span> = (<b>object</b>[])<a href="../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                    <a href="#f41b1778ad8c8b7f" class="k">this</a>.<a href="HelpInfo.cs.html#d097355e320548de" class="i property">FullHelp</a>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Description&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>,
                    <b>typeof</b>(<b>object</b>[]),
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <b>if</b> (<span class="r40 r">descriptionItems</span> == <b>null</b> || <span class="r40 r">descriptionItems</span>.<span class="i">Length</span> == 0)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <span class="c">// I think every cmdlet description should atleast have 400 characters...</span>
                <span class="c">// so starting with this assumption..I did an average of all the cmdlet</span>
                <span class="c">// help content available at the time of writing this code and came up</span>
                <span class="c">// with this number.</span>
                <span class="i">StringBuilder</span> <span id="r41 rd" class="r41 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>(400);
                <b>foreach</b> (<b>object</b> <span id="r42 rd" class="r42 r">descriptionItem</span> <b>in</b> <span class="r40 r">descriptionItems</span>)
                {
                    <b>if</b> (<span class="r42 r">descriptionItem</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r43 rd" class="r43 r">descriptionObject</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r42 r">descriptionItem</span>);
                    <b>if</b> ((<span class="r43 r">descriptionObject</span> == <b>null</b>) ||
                        (<span class="r43 r">descriptionObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>] == <b>null</b>) ||
                        (<span class="r43 r">descriptionObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>string</b> <span id="r44 rd" class="r44 r">text</span> = <span class="r43 r">descriptionObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../engine/MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Text&quot;</span>].<a href="../engine/MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                    <span class="r41 r">result</span>.<span class="i">Append</span>(<span class="r44 r">text</span>);
                    <span class="r41 r">result</span>.<span class="i">Append</span>(<span class="i">Environment</span>.<span class="i">NewLine</span>);
                }
 
                <b>return</b> <span class="r41 r">result</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
