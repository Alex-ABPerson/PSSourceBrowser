<!DOCTYPE html>
<html><head><title>MamlNode.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1253);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/help/MamlNode.cs" target="_top">help\MamlNode.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> MamlNode is an xml node in MAML schema. Maml schema includes formatting oriented tags like para, list</span>
    <span class="c">///</span><span class="c"> etc, which needs to be taken care of during display. As a result, xml node in Maml schema can&#39;t be</span>
    <span class="c">///</span><span class="c"> converted into PSObject directly with XmlNodeAdapter.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> MamlNode class provides logic in converting formatting tags into the format acceptable by monad format</span>
    <span class="c">///</span><span class="c"> and output engine.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Following three kinds of formating tags are supported per our agreement with Maml team,</span>
    <span class="c">///</span><span class="c">     1. para,</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             para text here</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     2. list,</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">list</span> <span class="c">class</span><span class="c">=</span><span class="c">&quot;</span><span class="c">ordered|unordered</span><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                     listItem Text here</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     3. definition list,</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">definitionList</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                     definition term text here</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                         definition text here</span>
    <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">definitionList</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> After processing, content of these three tags will be converted into textItem and its derivations,</span>
    <span class="c">///</span><span class="c">     1. para =&gt; paraTextItem</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">textItem</span> <span class="c">class</span><span class="c">=</span><span class="c">&quot;</span><span class="c">paraTextItem</span><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">text</span><span class="c">&gt;</span><span class="c">para text here</span><span class="c">&lt;/</span><span class="c">text</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">textItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     2. list =&gt; a list of listTextItem&#39;s (which can be ordered or unordered)</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">textItem</span> <span class="c">class</span><span class="c">=</span><span class="c">&quot;</span><span class="c">unorderedListTextItem</span><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">tag</span><span class="c">&gt;</span><span class="c">*</span><span class="c">&lt;/</span><span class="c">tag</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">text</span><span class="c">&gt;</span><span class="c">text for list item 1</span><span class="c">&lt;/</span><span class="c">text</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">textItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">textItem</span> <span class="c">class</span><span class="c">=</span><span class="c">&quot;</span><span class="c">unorderedListTextItem</span><span class="c">&quot;</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">tag</span><span class="c">&gt;</span><span class="c">*</span><span class="c">&lt;/</span><span class="c">tag</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">text</span><span class="c">&gt;</span><span class="c">text for list item 2</span><span class="c">&lt;/</span><span class="c">text</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">textItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">     3. definitionList =&gt; a list of definitionTextItem&#39;s</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span><span class="c">definition term here</span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span><span class="c">definition text here</span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="ab4c1c59f1747822" href="../R/ab4c1c59f1747822.html" target="n" data-glyph="2,0" class="t t">MamlNode</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for HelpInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="9f68d7d4cb553cb7" href="../R/9f68d7d4cb553cb7.html" target="n" data-glyph="74,1" class="t constructor">MamlNode</a>(<span class="i">XmlNode</span> <span id="r0 rd" class="r0 r">xmlNode</span>)
        {
            <a href="#fa55eb2ddff8cac1" class="i field">_xmlNode</a> = <span class="r0 r">xmlNode</span>;
        }
 
        <b>private readonly</b> <span class="i">XmlNode</span> <a id="fa55eb2ddff8cac1" href="../R/fa55eb2ddff8cac1.html" target="n" data-glyph="46,1" class="i field">_xmlNode</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Underline xmlNode for this MamlNode object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">XmlNode</span> <a id="46cdd141569a2a42" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">XmlNode</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fa55eb2ddff8cac1" class="i field">_xmlNode</a>;
            }
        }
 
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="9ed85b2acbd13e5f" href="../R/9ed85b2acbd13e5f.html" target="n" data-glyph="46,1" class="i field">_mshObject</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> MshObject which is converted from XmlNode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="290fcfe3371273a1" href="../R/290fcfe3371273a1.html" target="n" data-glyph="104,1" class="i property">PSObject</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#9ed85b2acbd13e5f" class="i field">_mshObject</a> == <b>null</b>)
                {
                    <span class="c">// There is no XSLT to convert docs to supported maml format</span>
                    <span class="c">// We dont want comments etc to spoil our format.</span>
                    <span class="c">// So remove all unsupported nodes before constructing help</span>
                    <span class="c">// object.</span>
                    <a href="#1f72615b795d52c2" class="i method">RemoveUnsupportedNodes</a>(<a href="#fa55eb2ddff8cac1" class="i field">_xmlNode</a>);
                    <a href="#9ed85b2acbd13e5f" class="i field">_mshObject</a> = <a href="#4832c5d9bd537980" class="i method">GetPSObject</a>(<a href="#fa55eb2ddff8cac1" class="i field">_xmlNode</a>);
                }
 
                <b>return</b> <a href="#9ed85b2acbd13e5f" class="i field">_mshObject</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Conversion of xmlNode =&gt; PSObject
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert an xmlNode into an PSObject. There are four scenarios,</span>
        <span class="c">///</span><span class="c">     1. Null xml, this will return an PSObject wrapping a null object.</span>
        <span class="c">///</span><span class="c">     2. Atomic xml, which is an xmlNode with only one simple text child node</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">atomicXml</span> <span class="c">attribute</span><span class="c">=</span><span class="c">&quot;</span><span class="c">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             atomic xml text</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">atomicXml</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        In this case, an PSObject that wraps string &quot;atomic xml text&quot; will be returned with following properties</span>
        <span class="c">///</span><span class="c">             attribute =&gt; name</span>
        <span class="c">///</span><span class="c">     3. Composite xml, which is an xmlNode with structured child nodes, but not a special case for Maml formatting.</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">compositeXml</span> <span class="c">attribute</span><span class="c">=</span><span class="c">&quot;</span><span class="c">attribute</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">singleChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 single child node text</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">singleChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">dupChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 dup child node text 1</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">dupChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">dupChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 dup child node text 2</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">dupChildNode</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">compositeXml</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        In this case, an PSObject will base generated based on an inside PSObject,</span>
        <span class="c">///</span><span class="c">        which in turn has following properties</span>
        <span class="c">///</span><span class="c">             a. property &quot;singleChildNode&quot;, with its value an PSObject wrapping string &quot;single child node text&quot;</span>
        <span class="c">///</span><span class="c">             b. property &quot;dupChildNode&quot;, with its value an PSObject array wrapping strings for two dupChildNode&#39;s</span>
        <span class="c">///</span><span class="c">        The outside PSObject will have property,</span>
        <span class="c">///</span><span class="c">             a. property &quot;attribute&quot;, with its value an PSObject wrapping string &quot;attribute&quot;</span>
        <span class="c">///</span><span class="c">     4. Maml formatting xml, this is a special case for Composite xml, for example</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">description</span> <span class="c">attribute</span><span class="c">=</span><span class="c">&quot;</span><span class="c">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 para 1</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         list item 1</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         list item 2</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;</span><span class="c">definitionList</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         term 1</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         definition list item 1</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         term 2</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                         definition list item 2</span>
        <span class="c">///</span><span class="c">                     </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                 </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">             </span><span class="c">&lt;/</span><span class="c">definitionList</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         In this case, an PSObject based on an PSObject array will be created. The inside PSObject array</span>
        <span class="c">///</span><span class="c">         will contain following items</span>
        <span class="c">///</span><span class="c">             . a MamlParaTextItem based on &quot;para 1&quot;</span>
        <span class="c">///</span><span class="c">             . a MamlUnorderedListItem based on &quot;list item 1&quot;</span>
        <span class="c">///</span><span class="c">             . a MamlUnorderedListItem based on &quot;list item 2&quot;</span>
        <span class="c">///</span><span class="c">             . a MamlDefinitionListItem based on &quot;definition list item 1&quot;</span>
        <span class="c">///</span><span class="c">             . a MamlDefinitionListItem based on &quot;definition list item 2&quot;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">         The outside PSObject will have a property</span>
        <span class="c">///</span><span class="c">             attribute =&gt; &quot;value&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="4832c5d9bd537980" href="../R/4832c5d9bd537980.html" target="n" data-glyph="76,1" class="i method">GetPSObject</a>(<span class="i">XmlNode</span> <span id="r1 rd" class="r1 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r1 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>new</b> <a href="../engine/MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r2 rd" class="r2 r">mshObject</span> = <b>null</b>;
 
            <b>if</b> (<a href="#7436fce43e362b93" class="i method">IsAtomic</a>(<span class="r1 r">xmlNode</span>))
            {
                <span class="r2 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r1 r">xmlNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>());
            }
            <b>else</b> <b>if</b> (<a href="#468644a019ea3b7a" class="i method">IncludeMamlFormatting</a>(<span class="r1 r">xmlNode</span>))
            {
                <span class="r2 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<a href="#b56c1ab1170216b6" class="i method">GetMamlFormattingPSObjects</a>(<span class="r1 r">xmlNode</span>));
            }
            <b>else</b>
            {
                <span class="r2 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<a href="#fa432ee328edac5e" class="i method">GetInsidePSObject</a>(<span class="r1 r">xmlNode</span>));
                <span class="c">// Add typeNames to this MSHObject and create views so that</span>
                <span class="c">// the ouput is readable. This is done only for complex nodes.</span>
                <span class="r2 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
 
                <b>if</b> (<span class="r1 r">xmlNode</span>.<span class="i">Attributes</span>[<span class="s">&quot;type&quot;</span>] != <b>null</b>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r1 r">xmlNode</span>.<span class="i">Attributes</span>[<span class="s">&quot;type&quot;</span>].<span class="i">Value</span>, <span class="s">&quot;field&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r2 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlPSClassHelpInfo#field&quot;</span>);
                    <b>else</b> <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r1 r">xmlNode</span>.<span class="i">Attributes</span>[<span class="s">&quot;type&quot;</span>].<span class="i">Value</span>, <span class="s">&quot;method&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r2 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlPSClassHelpInfo#method&quot;</span>);
                }
 
                <span class="r2 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlCommandHelpInfo#&quot;</span> + <span class="r1 r">xmlNode</span>.<span class="i">LocalName</span>);
            }
 
            <b>if</b> (<span class="r1 r">xmlNode</span>.<span class="i">Attributes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r3 rd" class="r3 r">attribute</span> <b>in</b> <span class="r1 r">xmlNode</span>.<span class="i">Attributes</span>)
                {
                    <span class="r2 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r3 r">attribute</span>.<span class="i">Name</span>, <span class="r3 r">attribute</span>.<span class="i">Value</span>));
                }
            }
 
            <b>return</b> <span class="r2 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get inside PSObject created based on inside nodes of xmlNode.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The inside PSObject will be based on null. It will created one</span>
        <span class="c">///</span><span class="c"> property per inside node grouping by node names.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example, for xmlNode like,</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">name</span><span class="c">&gt;</span><span class="c">get-item</span><span class="c">&lt;/</span><span class="c">name</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">note</span><span class="c">&gt;</span><span class="c">note 1</span><span class="c">&lt;/</span><span class="c">note</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">note</span><span class="c">&gt;</span><span class="c">note 2</span><span class="c">&lt;/</span><span class="c">note</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It will create an PSObject based on null, with following two properties</span>
        <span class="c">///</span><span class="c">     . property 1: name=&quot;name&quot; value=an PSObject to wrap string &quot;get-item&quot;</span>
        <span class="c">///</span><span class="c">     . property 2: name=&quot;note&quot; value=an PSObject array with following two PSObjects</span>
        <span class="c">///</span><span class="c">         1. PSObject wrapping string &quot;note 1&quot;</span>
        <span class="c">///</span><span class="c">         2. PSObject wrapping string &quot;note 2&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="fa432ee328edac5e" href="../R/fa432ee328edac5e.html" target="n" data-glyph="76,1" class="i method">GetInsidePSObject</a>(<span class="i">XmlNode</span> <span id="r4 rd" class="r4 r">xmlNode</span>)
        {
            <span class="i">Hashtable</span> <span id="r5 rd" class="r5 r">properties</span> = <a href="#4a2f9afe61b0794a" class="i method">GetInsideProperties</a>(<span class="r4 r">xmlNode</span>);
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r6 rd" class="r6 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <span class="i">IDictionaryEnumerator</span> <span id="r7 rd" class="r7 r">enumerator</span> = <span class="r5 r">properties</span>.<span class="i">GetEnumerator</span>();
 
            <b>while</b> (<span class="r7 r">enumerator</span>.<span class="i">MoveNext</span>())
            {
                <span class="r6 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>((<b>string</b>)<span class="r7 r">enumerator</span>.<span class="i">Key</span>, <span class="r7 r">enumerator</span>.<span class="i">Value</span>));
            }
 
            <b>return</b> <span class="r6 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for getting inside properties of an XmlNode. Properties are</span>
        <span class="c">///</span><span class="c"> stored in a hashtable with key as property name and value as property value.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Inside node with same node names will be grouped into one property with</span>
        <span class="c">///</span><span class="c"> property value as an array.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example, for xmlNode like,</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">name</span><span class="c">&gt;</span><span class="c">get-item</span><span class="c">&lt;/</span><span class="c">name</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">note</span><span class="c">&gt;</span><span class="c">note 1</span><span class="c">&lt;/</span><span class="c">note</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">note</span><span class="c">&gt;</span><span class="c">note 2</span><span class="c">&lt;/</span><span class="c">note</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It will create an PSObject based on null, with following two properties</span>
        <span class="c">///</span><span class="c">     . property 1: name=&quot;name&quot; value=an PSObject to wrap string &quot;get-item&quot;</span>
        <span class="c">///</span><span class="c">     . property 2: name=&quot;note&quot; value=an PSObject array with following two PSObjects</span>
        <span class="c">///</span><span class="c">         1. PSObject wrapping string &quot;note 1&quot;</span>
        <span class="c">///</span><span class="c">         2. PSObject wrapping string &quot;note 2&quot;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Since we don&#39;t know whether an node name will be used more than once,</span>
        <span class="c">///</span><span class="c"> We are making each property value is an array (PSObject[]) to start with.</span>
        <span class="c">///</span><span class="c"> At the end, SimplifyProperties will be called to reduce PSObject[] containing</span>
        <span class="c">///</span><span class="c"> only one element to PSObject itself.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Hashtable</span> <a id="4a2f9afe61b0794a" href="../R/4a2f9afe61b0794a.html" target="n" data-glyph="76,1" class="i method">GetInsideProperties</a>(<span class="i">XmlNode</span> <span id="r8 rd" class="r8 r">xmlNode</span>)
        {
            <span class="i">Hashtable</span> <span id="r9 rd" class="r9 r">properties</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>if</b> (<span class="r8 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <span class="r9 r">properties</span>;
 
            <b>if</b> (<span class="r8 r">xmlNode</span>.<span class="i">ChildNodes</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r10 rd" class="r10 r">childNode</span> <b>in</b> <span class="r8 r">xmlNode</span>.<span class="i">ChildNodes</span>)
                {
                    <span class="i">AddProperty</span>(<span class="r9 r">properties</span>, <span class="r10 r">childNode</span>.<span class="i">LocalName</span>, <a href="#4832c5d9bd537980" class="i method">GetPSObject</a>(<span class="r10 r">childNode</span>));
                }
            }
 
            <b>return</b> <a href="#353e389552f74139" class="i method">SimplifyProperties</a>(<span class="r9 r">properties</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes unsupported child nodes recursively from the given</span>
        <span class="c">///</span><span class="c"> xml node so that they wont spoil the format.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Node whose children are verified for maml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1f72615b795d52c2" href="../R/1f72615b795d52c2.html" target="n" data-glyph="76,1" class="i method">RemoveUnsupportedNodes</a>(<span class="i">XmlNode</span> <span id="r11 rd" class="r11 r">xmlNode</span>)
        {
            <span class="c">// Start with the first child..</span>
            <span class="c">// We want to modify only children..</span>
            <span class="c">// The current node is taken care by the callee..</span>
            <span class="i">XmlNode</span> <span id="r12 rd" class="r12 r">childNode</span> = <span class="r11 r">xmlNode</span>.<span class="i">FirstChild</span>;
            <b>while</b> (<span class="r12 r">childNode</span> != <b>null</b>)
            {
                <span class="c">// We dont want Comments..so remove..</span>
                <b>if</b> (<span class="r12 r">childNode</span>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Comment</span>)
                {
                    <span class="i">XmlNode</span> <span id="r13 rd" class="r13 r">nodeToRemove</span> = <span class="r12 r">childNode</span>;
                    <span class="r12 r">childNode</span> = <span class="r12 r">childNode</span>.<span class="i">NextSibling</span>;
                    <span class="c">// Remove this node and its children if any..</span>
                    <span class="r11 r">xmlNode</span>.<span class="i">RemoveChild</span>(<span class="r13 r">nodeToRemove</span>);
                }
                <b>else</b>
                {
                    <span class="c">// Search children...</span>
                    <a href="#1f72615b795d52c2" class="i method">RemoveUnsupportedNodes</a>(<span class="r12 r">childNode</span>);
                    <span class="r12 r">childNode</span> = <span class="r12 r">childNode</span>.<span class="i">NextSibling</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for adding a property into a property hashtable.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> As mentioned in comment of GetInsideProperties, property values stored in</span>
        <span class="c">///</span><span class="c"> property hashtable is an array to begin with.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The property value to be added is an mshObject whose base object can be an</span>
        <span class="c">///</span><span class="c"> PSObject array itself. In that case, each PSObject in the array will be</span>
        <span class="c">///</span><span class="c"> added separately into the property value array. This case can only happen when</span>
        <span class="c">///</span><span class="c"> an node with maml formatting node inside is treated. The side effect of this</span>
        <span class="c">///</span><span class="c"> is that the properties for outside mshObject will be lost. An example of this</span>
        <span class="c">///</span><span class="c"> is that,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">description</span> <span class="c">attrib1</span><span class="c">=</span><span class="c">&quot;</span><span class="c">value1</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">list</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         </span><span class="c">&lt;</span><span class="c">definitionList</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">definitionList</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">command</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> After the processing, PSObject corresponding to command will have an property</span>
        <span class="c">///</span><span class="c"> with name &quot;description&quot; and a value of an PSObject array created based on</span>
        <span class="c">///</span><span class="c"> maml formatting node inside &quot;description&quot; node. The attribute of description node</span>
        <span class="c">///</span><span class="c"> &quot;attrib1&quot; will be lost. This seems to be OK with current practice of authoring</span>
        <span class="c">///</span><span class="c"> monad command help.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">properties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property hashtable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="3b6d5ca05f718c34" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddProperty</a>(<span class="i">Hashtable</span> <span id="r14 rd" class="r14 r">properties</span>, <b>string</b> <span id="r15 rd" class="r15 r">name</span>, <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r16 rd" class="r16 r">mshObject</span>)
        {
            <span class="i">ArrayList</span> <span id="r17 rd" class="r17 r">propertyValues</span> = (<span class="i">ArrayList</span>)<span class="r14 r">properties</span>[<span class="r15 r">name</span>];
 
            <b>if</b> (<span class="r17 r">propertyValues</span> == <b>null</b>)
            {
                <span class="r17 r">propertyValues</span> = <b>new</b> <span class="i">ArrayList</span>();
 
                <span class="r14 r">properties</span>[<span class="r15 r">name</span>] = <span class="r17 r">propertyValues</span>;
            }
 
            <b>if</b> (<span class="r16 r">mshObject</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<span class="r16 r">mshObject</span>.<a href="../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="../engine/MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a> || !<span class="r16 r">mshObject</span>.<a href="../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>().<span class="i">Equals</span>(<b>typeof</b>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[])))
            {
                <span class="r17 r">propertyValues</span>.<span class="i">Add</span>(<span class="r16 r">mshObject</span>);
                <b>return</b>;
            }
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <span id="r18 rd" class="r18 r">mshObjects</span> = (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[])<span class="r16 r">mshObject</span>.<a href="../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>;
 
            <b>for</b> (<b>int</b> <span id="r19 rd" class="r19 r">i</span> = 0; <span class="r19 r">i</span> &lt; <span class="r18 r">mshObjects</span>.<span class="i">Length</span>; <span class="r19 r">i</span>++)
            {
                <span class="r17 r">propertyValues</span>.<span class="i">Add</span>(<span class="r18 r">mshObjects</span>[<span class="r19 r">i</span>]);
            }
 
            <b>return</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for simplifying property value array of only one element.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> As mentioned in comments for GetInsideProperties, this is needed</span>
        <span class="c">///</span><span class="c"> to reduce an array of only one PSObject into the PSObject itself.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> A side effect of this function is to turn property values from</span>
        <span class="c">///</span><span class="c"> ArrayList into PSObject[].</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">properties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Hashtable</span> <a id="353e389552f74139" href="../R/353e389552f74139.html" target="n" data-glyph="76,1" class="i method">SimplifyProperties</a>(<span class="i">Hashtable</span> <span id="r20 rd" class="r20 r">properties</span>)
        {
            <b>if</b> (<span class="r20 r">properties</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <span class="i">Hashtable</span> <span id="r21 rd" class="r21 r">result</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="i">IDictionaryEnumerator</span> <span id="r22 rd" class="r22 r">enumerator</span> = <span class="r20 r">properties</span>.<span class="i">GetEnumerator</span>();
 
            <b>while</b> (<span class="r22 r">enumerator</span>.<span class="i">MoveNext</span>())
            {
                <span class="i">ArrayList</span> <span id="r23 rd" class="r23 r">propertyValues</span> = (<span class="i">ArrayList</span>)<span class="r22 r">enumerator</span>.<span class="i">Value</span>;
 
                <b>if</b> (<span class="r23 r">propertyValues</span> == <b>null</b> || <span class="r23 r">propertyValues</span>.<span class="i">Count</span> == 0)
                    <b>continue</b>;
 
                <b>if</b> (<span class="r23 r">propertyValues</span>.<span class="i">Count</span> == 1)
                {
                    <b>if</b> (!<a href="#37e652979334a480" class="i method">IsMamlFormattingPSObject</a>((<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r23 r">propertyValues</span>[0]))
                    {
                        <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r24 rd" class="r24 r">mshObject</span> = (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r23 r">propertyValues</span>[0];
 
                        <span class="c">// Even for strings or other basic types, they need to be contained in PSObject in case</span>
                        <span class="c">// there is attributes for this object.</span>
 
                        <span class="r21 r">result</span>[<span class="r22 r">enumerator</span>.<span class="i">Key</span>] = <span class="r24 r">mshObject</span>;
 
                        <b>continue</b>;
                    }
                }
 
                <span class="r21 r">result</span>[<span class="r22 r">enumerator</span>.<span class="i">Key</span>] = <span class="r23 r">propertyValues</span>.<span class="i">ToArray</span>(<b>typeof</b>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>));
            }
 
            <b>return</b> <span class="r21 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An xmlNode is atomic if it contains no structured inside nodes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="7436fce43e362b93" href="../R/7436fce43e362b93.html" target="n" data-glyph="76,1" class="i method">IsAtomic</a>(<span class="i">XmlNode</span> <span id="r25 rd" class="r25 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r25 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r25 r">xmlNode</span>.<span class="i">ChildNodes</span> == <b>null</b>)
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<span class="r25 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> &gt; 1)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r25 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<span class="r25 r">xmlNode</span>.<span class="i">ChildNodes</span>[0].<span class="i">GetType</span>().<span class="i">Equals</span>(<b>typeof</b>(<span class="i">XmlText</span>)))
                <b>return</b> <b>true</b>;
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Maml formatting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether an xmlNode contains childnodes which is for</span>
        <span class="c">///</span><span class="c"> maml formatting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="468644a019ea3b7a" href="../R/468644a019ea3b7a.html" target="n" data-glyph="76,1" class="i method">IncludeMamlFormatting</a>(<span class="i">XmlNode</span> <span id="r26 rd" class="r26 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r26 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r26 r">xmlNode</span>.<span class="i">ChildNodes</span> == <b>null</b> || <span class="r26 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>false</b>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r27 rd" class="r27 r">childNode</span> <b>in</b> <span class="r26 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<a href="#0dffe3b3a495d352" class="i method">IsMamlFormattingNode</a>(<span class="r27 r">childNode</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether a node is for maml formatting. This include following nodes,</span>
        <span class="c">///</span><span class="c">     a. para</span>
        <span class="c">///</span><span class="c">     b. list</span>
        <span class="c">///</span><span class="c">     c. definitionList.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="0dffe3b3a495d352" href="../R/0dffe3b3a495d352.html" target="n" data-glyph="76,1" class="i method">IsMamlFormattingNode</a>(<span class="i">XmlNode</span> <span id="r28 rd" class="r28 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r28 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<span class="r28 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;list&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>true</b>;
 
            <b>if</b> (<span class="r28 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definitionList&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>true</b>;
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether an mshObject is created from a maml formatting node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="37e652979334a480" href="../R/37e652979334a480.html" target="n" data-glyph="76,1" class="i method">IsMamlFormattingPSObject</a>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r29 rd" class="r29 r">mshObject</span>)
        {
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r30 rd" class="r30 r">typeNames</span> = <span class="r29 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>;
 
            <b>if</b> (<span class="r30 r">typeNames</span> == <b>null</b> || <span class="r30 r">typeNames</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>false</b>;
 
            <b>return</b> <span class="r30 r">typeNames</span>[<span class="r30 r">typeNames</span>.<span class="i">Count</span> - 1].<span class="i">Equals</span>(<span class="s">&quot;MamlTextItem&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert an xmlNode containing maml formatting nodes into an PSObject array.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example, for node,</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;</span><span class="c">description</span> <span class="c">attribute</span><span class="c">=</span><span class="c">&quot;</span><span class="c">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            para 1</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    list item 1</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    list item 2</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">definitionList</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    term 1</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    definition list item 1</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    term 2</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    definition list item 2</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">definitionList</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;/</span><span class="c">description</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    In this case, an PSObject based on an PSObject array will be created. The inside PSObject array</span>
        <span class="c">///</span><span class="c">    will contain following items</span>
        <span class="c">///</span><span class="c">        . a MamlParaTextItem based on &quot;para 1&quot;</span>
        <span class="c">///</span><span class="c">        . a MamlUnorderedListItem based on &quot;list item 1&quot;</span>
        <span class="c">///</span><span class="c">        . a MamlUnorderedListItem based on &quot;list item 2&quot;</span>
        <span class="c">///</span><span class="c">        . a MamlDefinitionListItem based on &quot;definition list item 1&quot;</span>
        <span class="c">///</span><span class="c">        . a MamlDefinitionListItem based on &quot;definition list item 2&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <a id="b56c1ab1170216b6" href="../R/b56c1ab1170216b6.html" target="n" data-glyph="76,1" class="i method">GetMamlFormattingPSObjects</a>(<span class="i">XmlNode</span> <span id="r31 rd" class="r31 r">xmlNode</span>)
        {
            <span class="i">ArrayList</span> <span id="r32 rd" class="r32 r">mshObjects</span> = <b>new</b> <span class="i">ArrayList</span>();
 
            <b>int</b> <span id="r33 rd" class="r33 r">paraNodes</span> = <span class="i">GetParaMamlNodeCount</span>(<span class="r31 r">xmlNode</span>.<span class="i">ChildNodes</span>);
            <b>int</b> <span id="r34 rd" class="r34 r">count</span> = 0;
            <span class="c">// Don&#39;t trim the content if this is an &quot;introduction&quot; node.</span>
            <b>bool</b> <span id="r35 rd" class="r35 r">trim</span> = !<b>string</b>.<span class="i">Equals</span>(<span class="r31 r">xmlNode</span>.<span class="i">Name</span>, <span class="s">&quot;maml:introduction&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r36 rd" class="r36 r">childNode</span> <b>in</b> <span class="r31 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r36 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    ++<span class="r34 r">count</span>;
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r37 rd" class="r37 r">paraPSObject</span> = <a href="#bd407f9f6ecadfe3" class="i method">GetParaPSObject</a>(<span class="r36 r">childNode</span>, <span class="r34 r">count</span> != <span class="r33 r">paraNodes</span>, <span class="r38 r">trim</span>: <span class="r35 r">trim</span>);
                    <b>if</b> (<span class="r37 r">paraPSObject</span> != <b>null</b>)
                        <span class="r32 r">mshObjects</span>.<span class="i">Add</span>(<span class="r37 r">paraPSObject</span>);
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r36 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;list&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="i">ArrayList</span> <span id="r39 rd" class="r39 r">listPSObjects</span> = <a href="#da9b8f37ff0bc04c" class="i method">GetListPSObjects</a>(<span class="r36 r">childNode</span>);
 
                    <b>for</b> (<b>int</b> <span id="r40 rd" class="r40 r">i</span> = 0; <span class="r40 r">i</span> &lt; <span class="r39 r">listPSObjects</span>.<span class="i">Count</span>; <span class="r40 r">i</span>++)
                    {
                        <span class="r32 r">mshObjects</span>.<span class="i">Add</span>(<span class="r39 r">listPSObjects</span>[<span class="r40 r">i</span>]);
                    }
 
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r36 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definitionList&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="i">ArrayList</span> <span id="r41 rd" class="r41 r">definitionListPSObjects</span> = <a href="#430ee5caf20a50c7" class="i method">GetDefinitionListPSObjects</a>(<span class="r36 r">childNode</span>);
 
                    <b>for</b> (<b>int</b> <span id="r42 rd" class="r42 r">i</span> = 0; <span class="r42 r">i</span> &lt; <span class="r41 r">definitionListPSObjects</span>.<span class="i">Count</span>; <span class="r42 r">i</span>++)
                    {
                        <span class="r32 r">mshObjects</span>.<span class="i">Add</span>(<span class="r41 r">definitionListPSObjects</span>[<span class="r42 r">i</span>]);
                    }
 
                    <b>continue</b>;
                }
 
                <span class="c">// If we get here, there is some tags that is not supported by maml.</span>
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r31 r">xmlNode</span>, <span class="r36 r">childNode</span>);
            }
 
            <b>return</b> (<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>[])<span class="r32 r">mshObjects</span>.<span class="i">ToArray</span>(<b>typeof</b>(<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the number of para nodes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">nodes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="9c08195f70911351" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetParaMamlNodeCount</a>(<span class="i">XmlNodeList</span> <span id="r43 rd" class="r43 r">nodes</span>)
        {
            <b>int</b> <span id="r44 rd" class="r44 r">i</span> = 0;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r45 rd" class="r45 r">childNode</span> <b>in</b> <span class="r43 r">nodes</span>)
            {
                <b>if</b> (<span class="r45 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> (<span class="r45 r">childNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>().<span class="i">Equals</span>(<b>string</b>.<span class="i">Empty</span>))
                    {
                        <b>continue</b>;
                    }
 
                    ++<span class="r44 r">i</span>;
                }
            }
 
            <b>return</b> <span class="r44 r">i</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write an error to helpsystem to indicate an invalid maml child node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">node</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">childNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a53ce423ad2dd33f" href="../R/a53ce423ad2dd33f.html" target="n" data-glyph="76,1" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="i">XmlNode</span> <span id="r46 rd" class="r46 r">node</span>, <span class="i">XmlNode</span> <span id="r47 rd" class="r47 r">childNode</span>)
        {
            <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r48 rd" class="r48 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <a href="../utils/ExecutionExceptions.cs.html#4564d3e1b5c86b39" class="t constructor">ParentContainsErrorRecordException</a>(<span class="s">&quot;MamlInvalidChildNodeError&quot;</span>), <span class="s">&quot;MamlInvalidChildNodeError&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#7aaf68c3bc19e903" class="i field">SyntaxError</a>, <b>null</b>);
            <span class="r48 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <span class="t">ErrorDetails</span>(<b>typeof</b>(<a href="#ab4c1c59f1747822" class="t t">MamlNode</a>).<span class="i">Assembly</span>, <span class="s">&quot;HelpErrors&quot;</span>, <span class="s">&quot;MamlInvalidChildNodeError&quot;</span>, <span class="r46 r">node</span>.<span class="i">LocalName</span>, <span class="r47 r">childNode</span>.<span class="i">LocalName</span>, <a href="#1e5db927578a0a55" class="i method">GetNodePath</a>(<span class="r46 r">node</span>));
            <a href="#ab4c1c59f1747822" class="k">this</a>.<a href="#e9fbfd5f7c3d20c9" class="i property">Errors</a>.<span class="i">Add</span>(<span class="r48 r">errorRecord</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write an error to help system to indicate an invalid child node count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">node</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">childNodeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="c3a9fff3b6aba83d" href="../R/c3a9fff3b6aba83d.html" target="n" data-glyph="76,1" class="i method">WriteMamlInvalidChildNodeCountError</a>(<span class="i">XmlNode</span> <span id="r49 rd" class="r49 r">node</span>, <b>string</b> <span id="r50 rd" class="r50 r">childNodeName</span>, <b>int</b> <span id="r51 rd" class="r51 r">count</span>)
        {
            <a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r52 rd" class="r52 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <a href="../utils/ExecutionExceptions.cs.html#4564d3e1b5c86b39" class="t constructor">ParentContainsErrorRecordException</a>(<span class="s">&quot;MamlInvalidChildNodeCountError&quot;</span>), <span class="s">&quot;MamlInvalidChildNodeCountError&quot;</span>, <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../engine/ErrorPackage.cs.html#7aaf68c3bc19e903" class="i field">SyntaxError</a>, <b>null</b>);
            <span class="r52 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <span class="t">ErrorDetails</span>(<b>typeof</b>(<a href="#ab4c1c59f1747822" class="t t">MamlNode</a>).<span class="i">Assembly</span>, <span class="s">&quot;HelpErrors&quot;</span>, <span class="s">&quot;MamlInvalidChildNodeCountError&quot;</span>, <span class="r49 r">node</span>.<span class="i">LocalName</span>, <span class="r50 r">childNodeName</span>, <span class="r51 r">count</span>, <a href="#1e5db927578a0a55" class="i method">GetNodePath</a>(<span class="r49 r">node</span>));
            <a href="#ab4c1c59f1747822" class="k">this</a>.<a href="#e9fbfd5f7c3d20c9" class="i property">Errors</a>.<span class="i">Add</span>(<span class="r52 r">errorRecord</span>);
        }
 
        <b>private static string</b> <a id="1e5db927578a0a55" href="../R/1e5db927578a0a55.html" target="n" data-glyph="76,1" class="i method">GetNodePath</a>(<span class="i">XmlNode</span> <span id="r53 rd" class="r53 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r53 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r53 r">xmlNode</span>.<span class="i">ParentNode</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;\\&quot;</span> + <span class="r53 r">xmlNode</span>.<span class="i">LocalName</span>;
 
            <b>return</b> <span class="i">GetNodePath</span>(<span class="r53 r">xmlNode</span>.<span class="i">ParentNode</span>) + <span class="s">&quot;\\&quot;</span> + <span class="r53 r">xmlNode</span>.<span class="i">LocalName</span> + <a href="#3085cab1ed7e304f" class="i method">GetNodeIndex</a>(<span class="r53 r">xmlNode</span>);
        }
 
        <b>private static string</b> <a id="3085cab1ed7e304f" href="../R/3085cab1ed7e304f.html" target="n" data-glyph="76,1" class="i method">GetNodeIndex</a>(<span class="i">XmlNode</span> <span id="r54 rd" class="r54 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r54 r">xmlNode</span> == <b>null</b> || <span class="r54 r">xmlNode</span>.<span class="i">ParentNode</span> == <b>null</b>)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
            <b>int</b> <span id="r55 rd" class="r55 r">index</span> = 0;
            <b>int</b> <span id="r56 rd" class="r56 r">total</span> = 0;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r57 rd" class="r57 r">siblingNode</span> <b>in</b> <span class="r54 r">xmlNode</span>.<span class="i">ParentNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r57 r">siblingNode</span> == <span class="r54 r">xmlNode</span>)
                {
                    <span class="r55 r">index</span> = <span class="r56 r">total</span>++;
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r57 r">siblingNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="r54 r">xmlNode</span>.<span class="i">LocalName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r56 r">total</span>++;
                }
            }
 
            <b>if</b> (<span class="r56 r">total</span> &gt; 1)
            {
                <b>return</b> <span class="s">&quot;[&quot;</span> + <span class="r55 r">index</span>.<span class="i">ToString</span>(<span class="s">&quot;d&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>) + <span class="s">&quot;]&quot;</span>;
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert a para node into an mshObject.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example,</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        para text</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    In this case, an PSObject of type &quot;MamlParaTextItem&quot; will be created with following property</span>
        <span class="c">///</span><span class="c">        a. text=&quot;para text&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">newLine</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">trim</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="bd407f9f6ecadfe3" href="../R/bd407f9f6ecadfe3.html" target="n" data-glyph="76,1" class="i method">GetParaPSObject</a>(<span class="i">XmlNode</span> <span id="r58 rd" class="r58 r">xmlNode</span>, <b>bool</b> <span id="r59 rd" class="r59 r">newLine</span>, <b>bool</b> <span id="r38 rd" class="r38 r">trim</span> = <b>true</b>)
        {
            <b>if</b> (<span class="r58 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (!<span class="r58 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>null</b>;
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r60 rd" class="r60 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <span class="i">StringBuilder</span> <span id="r61 rd" class="r61 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>if</b> (<span class="r59 r">newLine</span> &amp;&amp; !<span class="r58 r">xmlNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>().<span class="i">Equals</span>(<b>string</b>.<span class="i">Empty</span>))
            {
                <span class="r61 r">sb</span>.<span class="i">AppendLine</span>(<span class="r58 r">xmlNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>());
            }
            <b>else</b>
            {
                <b>var</b> <span id="r62 rd" class="r62 r">innerText</span> = <span class="r58 r">xmlNode</span>.<span class="i">InnerText</span>;
                <b>if</b> (<span class="r38 r">trim</span>)
                {
                    <span class="r62 r">innerText</span> = <span class="r62 r">innerText</span>.<span class="i">Trim</span>();
                }
 
                <span class="r61 r">sb</span>.<span class="i">Append</span>(<span class="r62 r">innerText</span>);
            }
 
            <span class="r60 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Text&quot;</span>, <span class="r61 r">sb</span>.<span class="i">ToString</span>()));
 
            <span class="r60 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
            <span class="r60 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlParaTextItem&quot;</span>);
            <span class="r60 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlTextItem&quot;</span>);
 
            <b>return</b> <span class="r60 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert a list node into an PSObject array.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example,</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;</span><span class="c">list</span> <span class="c">class</span><span class="c">=</span><span class="c">&quot;</span><span class="c">ordered</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                text for list item 1</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                text for list item 2</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">listItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">    </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In this case, an array of PSObject, each of type &quot;MamlOrderedListText&quot; will be created with following</span>
        <span class="c">///</span><span class="c"> two properties,</span>
        <span class="c">///</span><span class="c">        a. tag=&quot; 1. &quot; or &quot; 2. &quot;</span>
        <span class="c">///</span><span class="c">        b. text=&quot;text for list item 1&quot; or &quot;text for list item 2&quot;</span>
        <span class="c">///</span><span class="c"> In the case of unordered list, similar PSObject will created with type to be &quot;MamlUnorderedListText&quot; and tag=&quot;*&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">ArrayList</span> <a id="da9b8f37ff0bc04c" href="../R/da9b8f37ff0bc04c.html" target="n" data-glyph="76,1" class="i method">GetListPSObjects</a>(<span class="i">XmlNode</span> <span id="r63 rd" class="r63 r">xmlNode</span>)
        {
            <span class="i">ArrayList</span> <span id="r64 rd" class="r64 r">mshObjects</span> = <b>new</b> <span class="i">ArrayList</span>();
 
            <b>if</b> (<span class="r63 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <span class="r64 r">mshObjects</span>;
 
            <b>if</b> (!<span class="r63 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;list&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <span class="r64 r">mshObjects</span>;
 
            <b>if</b> (<span class="r63 r">xmlNode</span>.<span class="i">ChildNodes</span> == <b>null</b> || <span class="r63 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <span class="r64 r">mshObjects</span>;
 
            <b>bool</b> <span id="r65 rd" class="r65 r">ordered</span> = <a href="#0ba889b07fbe7efd" class="i method">IsOrderedList</a>(<span class="r63 r">xmlNode</span>);
            <b>int</b> <span id="r66 rd" class="r66 r">index</span> = 1;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r67 rd" class="r67 r">childNode</span> <b>in</b> <span class="r63 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r67 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;listItem&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r68 rd" class="r68 r">listItemPSObject</span> = <a href="#5f7d500a308a2a3d" class="i method">GetListItemPSObject</a>(<span class="r67 r">childNode</span>, <span class="r65 r">ordered</span>, <b>ref</b> <span class="r66 r">index</span>);
 
                    <b>if</b> (<span class="r68 r">listItemPSObject</span> != <b>null</b>)
                        <span class="r64 r">mshObjects</span>.<span class="i">Add</span>(<span class="r68 r">listItemPSObject</span>);
 
                    <b>continue</b>;
                }
 
                <span class="c">// If we get here, there is some tags that is not supported by maml.</span>
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r63 r">xmlNode</span>, <span class="r67 r">childNode</span>);
            }
 
            <b>return</b> <span class="r64 r">mshObjects</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether a list is ordered or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="0ba889b07fbe7efd" href="../R/0ba889b07fbe7efd.html" target="n" data-glyph="76,1" class="i method">IsOrderedList</a>(<span class="i">XmlNode</span> <span id="r69 rd" class="r69 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r69 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r69 r">xmlNode</span>.<span class="i">Attributes</span> == <b>null</b> || <span class="r69 r">xmlNode</span>.<span class="i">Attributes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>false</b>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r70 rd" class="r70 r">attribute</span> <b>in</b> <span class="r69 r">xmlNode</span>.<span class="i">Attributes</span>)
            {
                <b>if</b> (<span class="r70 r">attribute</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;class&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    &amp;&amp; <span class="r70 r">attribute</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;ordered&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert an listItem node into an PSObject with property &quot;tag&quot; and &quot;text&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">ordered</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="5f7d500a308a2a3d" href="../R/5f7d500a308a2a3d.html" target="n" data-glyph="76,1" class="i method">GetListItemPSObject</a>(<span class="i">XmlNode</span> <span id="r71 rd" class="r71 r">xmlNode</span>, <b>bool</b> <span id="r72 rd" class="r72 r">ordered</span>, <b>ref int</b> <span id="r73 rd" class="r73 r">index</span>)
        {
            <b>if</b> (<span class="r71 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (!<span class="r71 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;listItem&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>null</b>;
 
            <b>string</b> <span id="r74 rd" class="r74 r">text</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r71 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> &gt; 1)
            {
                <a href="#c3a9fff3b6aba83d" class="i method">WriteMamlInvalidChildNodeCountError</a>(<span class="r71 r">xmlNode</span>, <span class="s">&quot;para&quot;</span>, 1);
            }
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r75 rd" class="r75 r">childNode</span> <b>in</b> <span class="r71 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r75 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r74 r">text</span> = <span class="r75 r">childNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>();
                    <b>continue</b>;
                }
 
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r71 r">xmlNode</span>, <span class="r75 r">childNode</span>);
            }
 
            <b>string</b> <span id="r76 rd" class="r76 r">tag</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r72 r">ordered</span>)
            {
                <span class="r76 r">tag</span> = <span class="r73 r">index</span>.<span class="i">ToString</span>(<span class="s">&quot;d2&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
                <span class="r76 r">tag</span> += <span class="s">&quot;. &quot;</span>;
                <span class="r73 r">index</span>++;
            }
            <b>else</b>
            {
                <span class="r76 r">tag</span> = <span class="s">&quot;* &quot;</span>;
            }
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r77 rd" class="r77 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Text&quot;</span>, <span class="r74 r">text</span>));
            <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Tag&quot;</span>, <span class="r76 r">tag</span>));
 
            <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
            <b>if</b> (<span class="r72 r">ordered</span>)
            {
                <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlOrderedListTextItem&quot;</span>);
            }
            <b>else</b>
            {
                <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlUnorderedListTextItem&quot;</span>);
            }
 
            <span class="r77 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlTextItem&quot;</span>);
 
            <b>return</b> <span class="r77 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert definitionList node into an array of PSObject, an for</span>
        <span class="c">///</span><span class="c"> each definitionListItem node inside this node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">ArrayList</span> <a id="430ee5caf20a50c7" href="../R/430ee5caf20a50c7.html" target="n" data-glyph="76,1" class="i method">GetDefinitionListPSObjects</a>(<span class="i">XmlNode</span> <span id="r78 rd" class="r78 r">xmlNode</span>)
        {
            <span class="i">ArrayList</span> <span id="r79 rd" class="r79 r">mshObjects</span> = <b>new</b> <span class="i">ArrayList</span>();
 
            <b>if</b> (<span class="r78 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <span class="r79 r">mshObjects</span>;
 
            <b>if</b> (!<span class="r78 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definitionList&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <span class="r79 r">mshObjects</span>;
 
            <b>if</b> (<span class="r78 r">xmlNode</span>.<span class="i">ChildNodes</span> == <b>null</b> || <span class="r78 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <span class="r79 r">mshObjects</span>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r80 rd" class="r80 r">childNode</span> <b>in</b> <span class="r78 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r80 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definitionListItem&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r81 rd" class="r81 r">definitionListItemPSObject</span> = <a href="#b3a3c674700f7660" class="i method">GetDefinitionListItemPSObject</a>(<span class="r80 r">childNode</span>);
 
                    <b>if</b> (<span class="r81 r">definitionListItemPSObject</span> != <b>null</b>)
                        <span class="r79 r">mshObjects</span>.<span class="i">Add</span>(<span class="r81 r">definitionListItemPSObject</span>);
 
                    <b>continue</b>;
                }
 
                <span class="c">// If we get here, we found some node that is not supported.</span>
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r78 r">xmlNode</span>, <span class="r80 r">childNode</span>);
            }
 
            <b>return</b> <span class="r79 r">mshObjects</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert an definitionListItem node into an PSObject</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                term text</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">term</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">                    definition text</span>
        <span class="c">///</span><span class="c">                </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">            </span><span class="c">&lt;/</span><span class="c">definition</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">        </span><span class="c">&lt;/</span><span class="c">definitionListItem</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In this case, an PSObject of type &quot;definitionListText&quot; will be created with following</span>
        <span class="c">///</span><span class="c"> properties</span>
        <span class="c">///</span><span class="c">        a. term=&quot;term text&quot;</span>
        <span class="c">///</span><span class="c">        b. definition=&quot;definition text&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b3a3c674700f7660" href="../R/b3a3c674700f7660.html" target="n" data-glyph="76,1" class="i method">GetDefinitionListItemPSObject</a>(<span class="i">XmlNode</span> <span id="r82 rd" class="r82 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r82 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (!<span class="r82 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definitionListItem&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>null</b>;
 
            <b>string</b> <span id="r83 rd" class="r83 r">term</span> = <b>null</b>;
            <b>string</b> <span id="r84 rd" class="r84 r">definition</span> = <b>null</b>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r85 rd" class="r85 r">childNode</span> <b>in</b> <span class="r82 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r85 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;term&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r83 r">term</span> = <span class="r85 r">childNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>();
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r85 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definition&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r84 r">definition</span> = <a href="#25cc00e0ea573b49" class="i method">GetDefinitionText</a>(<span class="r85 r">childNode</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// If we get here, we found some node that is not supported.</span>
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r82 r">xmlNode</span>, <span class="r85 r">childNode</span>);
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r83 r">term</span>))
                <b>return</b> <b>null</b>;
 
            <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r86 rd" class="r86 r">mshObject</span> = <b>new</b> <a href="../engine/MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <span class="r86 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Term&quot;</span>, <span class="r83 r">term</span>));
            <span class="r86 r">mshObject</span>.<a href="../engine/MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../engine/MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../engine/MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="s">&quot;Definition&quot;</span>, <span class="r84 r">definition</span>));
 
            <span class="r86 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
            <span class="r86 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlDefinitionTextItem&quot;</span>);
            <span class="r86 r">mshObject</span>.<a href="../engine/MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="s">&quot;MamlTextItem&quot;</span>);
 
            <b>return</b> <span class="r86 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the text for definition. The will treat some intermediate nodes like &quot;definition&quot; and &quot;para&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">xmlNode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="25cc00e0ea573b49" href="../R/25cc00e0ea573b49.html" target="n" data-glyph="76,1" class="i method">GetDefinitionText</a>(<span class="i">XmlNode</span> <span id="r87 rd" class="r87 r">xmlNode</span>)
        {
            <b>if</b> (<span class="r87 r">xmlNode</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (!<span class="r87 r">xmlNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;definition&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>null</b>;
 
            <b>if</b> (<span class="r87 r">xmlNode</span>.<span class="i">ChildNodes</span> == <b>null</b> || <span class="r87 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r87 r">xmlNode</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> &gt; 1)
            {
                <a href="#c3a9fff3b6aba83d" class="i method">WriteMamlInvalidChildNodeCountError</a>(<span class="r87 r">xmlNode</span>, <span class="s">&quot;para&quot;</span>, 1);
            }
 
            <b>string</b> <span id="r88 rd" class="r88 r">text</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r89 rd" class="r89 r">childNode</span> <b>in</b> <span class="r87 r">xmlNode</span>.<span class="i">ChildNodes</span>)
            {
                <b>if</b> (<span class="r89 r">childNode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;para&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r88 r">text</span> = <span class="r89 r">childNode</span>.<span class="i">InnerText</span>.<span class="i">Trim</span>();
                    <b>continue</b>;
                }
 
                <a href="#a53ce423ad2dd33f" class="i method">WriteMamlInvalidChildNodeError</a>(<span class="r87 r">xmlNode</span>, <span class="r89 r">childNode</span>);
            }
 
            <b>return</b> <span class="r88 r">text</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Preformatted string processing
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for getting preformatted text from an xml document.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Normally in xml document, preformatted text will be indented by</span>
        <span class="c">///</span><span class="c"> a fix amount based on its position. The task of this function</span>
        <span class="c">///</span><span class="c"> is to remove that fixed amount from the text.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example, in xml,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">preformatted</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     void function()</span>
        <span class="c">///</span><span class="c">     {</span>
        <span class="c">///</span><span class="c">         // call some other function here;</span>
        <span class="c">///</span><span class="c">     }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">preformatted</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> we can find that the preformatted text are indented unanimously</span>
        <span class="c">///</span><span class="c"> by 4 spaces because of its position in xml.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> After massaging in this function, the result text will be,</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> void function</span>
        <span class="c">///</span><span class="c"> {</span>
        <span class="c">///</span><span class="c">     // call some other function here;</span>
        <span class="c">///</span><span class="c"> }</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> please notice that the indention is reduced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="417209cea3ec5058" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetPreformattedText</a>(<b>string</b> <span id="r90 rd" class="r90 r">text</span>)
        {
            <span class="c">// we are assuming tabsize=4 here.</span>
            <span class="c">// It is discouraged to use tab in preformatted text.</span>
 
            <b>string</b> <span id="r91 rd" class="r91 r">noTabText</span> = <span class="r90 r">text</span>.<span class="i">Replace</span>(<span class="s">&quot;\t&quot;</span>, <span class="s">&quot;    &quot;</span>);
            <b>string</b>[] <span id="r92 rd" class="r92 r">lines</span> = <span class="r91 r">noTabText</span>.<span class="i">Split</span>(<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../engine/Utils.cs.html#f4b640ef9b5adf48" class="i field">Newline</a>);
            <b>string</b>[] <span id="r93 rd" class="r93 r">trimedLines</span> = <a href="#3395be82e15abc41" class="i method">TrimLines</a>(<span class="r92 r">lines</span>);
 
            <b>if</b> (<span class="r93 r">trimedLines</span> == <b>null</b> || <span class="r93 r">trimedLines</span>.<span class="i">Length</span> == 0)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
            <b>int</b> <span id="r94 rd" class="r94 r">minIndentation</span> = <a href="#bf46d598a97986ff" class="i method">GetMinIndentation</a>(<span class="r93 r">trimedLines</span>);
 
            <b>string</b>[] <span id="r95 rd" class="r95 r">shortedLines</span> = <b>new</b> <b>string</b>[<span class="r93 r">trimedLines</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r96 rd" class="r96 r">i</span> = 0; <span class="r96 r">i</span> &lt; <span class="r93 r">trimedLines</span>.<span class="i">Length</span>; <span class="r96 r">i</span>++)
            {
                <b>if</b> (<a href="#c7184d5dfe075b39" class="i method">IsEmptyLine</a>(<span class="r93 r">trimedLines</span>[<span class="r96 r">i</span>]))
                {
                    <span class="r95 r">shortedLines</span>[<span class="r96 r">i</span>] = <span class="r93 r">trimedLines</span>[<span class="r96 r">i</span>];
                }
                <b>else</b>
                {
                    <span class="r95 r">shortedLines</span>[<span class="r96 r">i</span>] = <span class="r93 r">trimedLines</span>[<span class="r96 r">i</span>].<span class="i">Remove</span>(0, <span class="r94 r">minIndentation</span>);
                }
            }
 
            <span class="i">StringBuilder</span> <span id="r97 rd" class="r97 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>for</b> (<b>int</b> <span id="r98 rd" class="r98 r">i</span> = 0; <span class="r98 r">i</span> &lt; <span class="r95 r">shortedLines</span>.<span class="i">Length</span>; <span class="r98 r">i</span>++)
            {
                <span class="r97 r">result</span>.<span class="i">AppendLine</span>(<span class="r95 r">shortedLines</span>[<span class="r98 r">i</span>]);
            }
 
            <b>return</b> <span class="r97 r">result</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trim empty lines from the either end of an string array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">lines</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Lines to trim.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An string array with empty lines trimed on either end.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b>[] <a id="3395be82e15abc41" href="../R/3395be82e15abc41.html" target="n" data-glyph="76,1" class="i method">TrimLines</a>(<b>string</b>[] <span id="r99 rd" class="r99 r">lines</span>)
        {
            <b>if</b> (<span class="r99 r">lines</span> == <b>null</b> || <span class="r99 r">lines</span>.<span class="i">Length</span> == 0)
                <b>return</b> <b>null</b>;
 
            <b>int</b> <span id="r100 rd" class="r100 r">i</span> = 0;
            <b>for</b> (<span class="r100 r">i</span> = 0; <span class="r100 r">i</span> &lt; <span class="r99 r">lines</span>.<span class="i">Length</span>; <span class="r100 r">i</span>++)
            {
                <b>if</b> (!<a href="#c7184d5dfe075b39" class="i method">IsEmptyLine</a>(<span class="r99 r">lines</span>[<span class="r100 r">i</span>]))
                    <b>break</b>;
            }
 
            <b>int</b> <span id="r101 rd" class="r101 r">start</span> = <span class="r100 r">i</span>;
 
            <b>if</b> (<span class="r101 r">start</span> == <span class="r99 r">lines</span>.<span class="i">Length</span>)
                <b>return</b> <b>null</b>;
 
            <b>for</b> (<span class="r100 r">i</span> = <span class="r99 r">lines</span>.<span class="i">Length</span> - 1; <span class="r100 r">i</span> &gt;= <span class="r101 r">start</span>; <span class="r100 r">i</span>--)
            {
                <b>if</b> (!<a href="#c7184d5dfe075b39" class="i method">IsEmptyLine</a>(<span class="r99 r">lines</span>[<span class="r100 r">i</span>]))
                    <b>break</b>;
            }
 
            <b>int</b> <span id="r102 rd" class="r102 r">end</span> = <span class="r100 r">i</span>;
 
            <b>string</b>[] <span id="r103 rd" class="r103 r">result</span> = <b>new</b> <b>string</b>[<span class="r102 r">end</span> - <span class="r101 r">start</span> + 1];
            <b>for</b> (<span class="r100 r">i</span> = <span class="r101 r">start</span>; <span class="r100 r">i</span> &lt;= <span class="r102 r">end</span>; <span class="r100 r">i</span>++)
            {
                <span class="r103 r">result</span>[<span class="r100 r">i</span> - <span class="r101 r">start</span>] = <span class="r99 r">lines</span>[<span class="r100 r">i</span>];
            }
 
            <b>return</b> <span class="r103 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get minimum indentation of a paragraph.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">lines</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="bf46d598a97986ff" href="../R/bf46d598a97986ff.html" target="n" data-glyph="76,1" class="i method">GetMinIndentation</a>(<b>string</b>[] <span id="r104 rd" class="r104 r">lines</span>)
        {
            <b>int</b> <span id="r105 rd" class="r105 r">minIndentation</span> = -1;
 
            <b>for</b> (<b>int</b> <span id="r106 rd" class="r106 r">i</span> = 0; <span class="r106 r">i</span> &lt; <span class="r104 r">lines</span>.<span class="i">Length</span>; <span class="r106 r">i</span>++)
            {
                <b>if</b> (<a href="#c7184d5dfe075b39" class="i method">IsEmptyLine</a>(<span class="r104 r">lines</span>[<span class="r106 r">i</span>]))
                    <b>continue</b>;
 
                <b>int</b> <span id="r107 rd" class="r107 r">indentation</span> = <a href="#539dfa808d47ffe0" class="i method">GetIndentation</a>(<span class="r104 r">lines</span>[<span class="r106 r">i</span>]);
 
                <b>if</b> (<span class="r105 r">minIndentation</span> &lt; 0 || <span class="r107 r">indentation</span> &lt; <span class="r105 r">minIndentation</span>)
                    <span class="r105 r">minIndentation</span> = <span class="r107 r">indentation</span>;
            }
 
            <b>return</b> <span class="r105 r">minIndentation</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get indentation of a line, i.e., number of spaces</span>
        <span class="c">///</span><span class="c"> at the beginning of the line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="539dfa808d47ffe0" href="../R/539dfa808d47ffe0.html" target="n" data-glyph="76,1" class="i method">GetIndentation</a>(<b>string</b> <span id="r108 rd" class="r108 r">line</span>)
        {
            <b>if</b> (<a href="#c7184d5dfe075b39" class="i method">IsEmptyLine</a>(<span class="r108 r">line</span>))
                <b>return</b> 0;
 
            <b>string</b> <span id="r109 rd" class="r109 r">leftTrimedLine</span> = <span class="r108 r">line</span>.<span class="i">TrimStart</span>(<a href="../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../engine/Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../engine/Utils.cs.html#ae9efc7d00636f59" class="i field">Space</a>);
 
            <b>return</b> <span class="r108 r">line</span>.<span class="i">Length</span> - <span class="r109 r">leftTrimedLine</span>.<span class="i">Length</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Test whether a line is empty.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> A line is empty if it contains only white spaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="c7184d5dfe075b39" href="../R/c7184d5dfe075b39.html" target="n" data-glyph="76,1" class="i method">IsEmptyLine</a>(<b>string</b> <span id="r110 rd" class="r110 r">line</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r110 r">line</span>))
                <b>return</b> <b>true</b>;
 
            <b>string</b> <span id="r111 rd" class="r111 r">trimedLine</span> = <span class="r110 r">line</span>.<span class="i">Trim</span>();
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r111 r">trimedLine</span>))
                <b>return</b> <b>true</b>;
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error handling
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is for tracking the set of errors happened during the parsing of</span>
        <span class="c">///</span><span class="c"> maml text.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="e9fbfd5f7c3d20c9" href="../R/e9fbfd5f7c3d20c9.html" target="n" data-glyph="104,1" class="i property">Errors</a> { <b>get</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
