<!DOCTYPE html>
<html><head><title>CorePsStub.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(813);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/CoreCLR/CorePsStub.cs" target="_top">CoreCLR\CorePsStub.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1591, 1572, 1571, 1573, 1587, 1570, 0067
 
<span class="k preprocess">#</span><span class="k preprocess">region</span> PS_STUBS
<span class="c">// Include PS types that are not needed for PowerShell on CSS</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTransaction
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> We don&#39;t need PSTransaction related types on CSS because System.Transactions</span>
    <span class="c">///</span><span class="c"> namespace is not available in CoreCLR.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="f4565df9151a2fcf" href="../R/f4565df9151a2fcf.html" target="n" data-glyph="0,0" class="t t">PSTransactionContext</a> : <span class="i">IDisposable</span>
    {
        <b>internal</b> <a id="01168f52b9949385" href="../R/01168f52b9949385.html" target="n" data-glyph="74,1" class="t constructor">PSTransactionContext</a>(<span class="i n">Internal</span>.<a href="#6d758ac5b09394e4" class="t t">PSTransactionManager</a> <span id="r0 rd" class="r0 r">transactionManager</span>) { }
 
        <b>public void</b> <a id="fff5d6f32d50008a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>() { }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The severity of error that causes PowerShell to automatically</span>
    <span class="c">///</span><span class="c"> rollback the transaction.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="093dd53b7c8e0582" href="../R/093dd53b7c8e0582.html" target="n" data-glyph="18,0" class="t t"><span id="5195f9d4ccc2385f">RollbackSeverity</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Non-terminating errors or worse.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="54e30288b898712c" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Error</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Terminating errors or worse.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d71031d86dd999ff" href="../R/d71031d86dd999ff.html" target="n" data-glyph="24,1" class="i field">TerminatingError</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do not rollback the transaction on error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="84ea7205031b0ba6" href="../R/84ea7205031b0ba6.html" target="n" data-glyph="24,1" class="i field">Never</a>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTransaction
}
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> We don&#39;t need PSTransaction related types on CSS because System.Transactions</span>
    <span class="c">///</span><span class="c"> namespace is not available in CoreCLR.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="6d758ac5b09394e4" href="../R/6d758ac5b09394e4.html" target="n" data-glyph="2,0" class="t t"><span id="8b5765974a4c00ed">PSTransactionManager</span></a> : <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if you have a transaction that you can set active and work on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always return false in CoreCLR</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="8034b8ed99ff105b" href="../R/8034b8ed99ff105b.html" target="n" data-glyph="104,1" class="i property">HasTransaction</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the last transaction has been committed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0006ba4076497784" href="../R/0006ba4076497784.html" target="n" data-glyph="104,1" class="i property">IsLastTransactionCommitted</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;IsLastTransactionCommitted&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the last transaction has been rolled back.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="ff1be75b1e651fd1" href="../R/ff1be75b1e651fd1.html" target="n" data-glyph="104,1" class="i property">IsLastTransactionRolledBack</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;IsLastTransactionRolledBack&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the rollback preference for the active transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#093dd53b7c8e0582" class="t t">RollbackSeverity</a> <a id="5e3b48ff3edf5b68" href="../R/5e3b48ff3edf5b68.html" target="n" data-glyph="104,1" class="i property">RollbackPreference</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;RollbackPreference&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by engine APIs to ensure they are protected from</span>
        <span class="c">///</span><span class="c"> ambient transactions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always return null in CoreCLR</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IDisposable</span> <a id="d6d4cf3db02d03bb" href="../R/d6d4cf3db02d03bb.html" target="n" data-glyph="74,1" class="i method">GetEngineProtectionScope</a>()
        {
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Aborts the current transaction, no matter how many subscribers are part of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c002f17dda3f7e78" href="../R/c002f17dda3f7e78.html" target="n" data-glyph="74,1" class="i method">Rollback</a>(<b>bool</b> <span id="r1 rd" class="r1 r">suppressErrors</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;Rollback&quot;</span>);
        }
 
        <b>public void</b> <a id="ea885a0401b9f379" href="../R/ea885a0401b9f379.html" target="n" data-glyph="72,1" class="i method">Dispose</a>() { }
    }
}
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>
{
    <b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>;
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> TransactedRegistryKey
 
    <b>internal abstract class</b> <a id="c653e56b410e12c1" href="../R/c653e56b410e12c1.html" target="n" data-glyph="2,0" class="t t"><span id="592d59e551d2502d">TransactedRegistryKey</span></a> : <span class="i">IDisposable</span>
    {
        <b>public void</b> <a id="07fc2817c2e2f523" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>() { }
 
        <b>public void</b> <a id="732d35fca9a52076" href="../R/732d35fca9a52076.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<b>string</b> <span id="r2 rd" class="r2 r">name</span>, <b>object</b> <span id="r3 rd" class="r3 r">value</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;SetValue(string name, obj value) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public void</b> <a id="88c64558949c11e3" href="../R/88c64558949c11e3.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<b>string</b> <span id="r4 rd" class="r4 r">name</span>, <b>object</b> <span id="r5 rd" class="r5 r">value</span>, <span class="i">RegistryValueKind</span> <span id="r6 rd" class="r6 r">valueKind</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;SetValue(string name, obj value, RegistryValueKind valueKind) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public string</b>[] <a id="b4aba1bdbb98b90e" href="../R/b4aba1bdbb98b90e.html" target="n" data-glyph="72,1" class="i method">GetValueNames</a>()
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetValueNames() is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public void</b> <a id="e9de0e223d0f6718" href="../R/e9de0e223d0f6718.html" target="n" data-glyph="72,1" class="i method">DeleteValue</a>(<b>string</b> <span id="r7 rd" class="r7 r">name</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;DeleteValue(string name) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public string</b>[] <a id="20530f0f672bcca5" href="../R/20530f0f672bcca5.html" target="n" data-glyph="72,1" class="i method">GetSubKeyNames</a>()
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetSubKeyNames() is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="4269bcb830b47c0c" href="../R/4269bcb830b47c0c.html" target="n" data-glyph="72,1" class="i method">CreateSubKey</a>(<b>string</b> <span id="r8 rd" class="r8 r">subkey</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;CreateSubKey(string subkey) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="03f54fd0e03f1999" href="../R/03f54fd0e03f1999.html" target="n" data-glyph="72,1" class="i method">OpenSubKey</a>(<b>string</b> <span id="r9 rd" class="r9 r">name</span>, <b>bool</b> <span id="r10 rd" class="r10 r">writable</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;OpenSubKey(string name, bool writeable) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public void</b> <a id="927c1d0458ca52e8" href="../R/927c1d0458ca52e8.html" target="n" data-glyph="72,1" class="i method">DeleteSubKeyTree</a>(<b>string</b> <span id="r11 rd" class="r11 r">subkey</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;DeleteSubKeyTree(string subkey) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public object</b> <a id="4ae1f2642c64ed17" href="../R/4ae1f2642c64ed17.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<b>string</b> <span id="r12 rd" class="r12 r">name</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetValue(string name) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public object</b> <a id="d0745177cf27711d" href="../R/d0745177cf27711d.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<b>string</b> <span id="r13 rd" class="r13 r">name</span>, <b>object</b> <span id="r14 rd" class="r14 r">defaultValue</span>, <span class="i">RegistryValueOptions</span> <span id="r15 rd" class="r15 r">options</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetValue(string name, object defaultValue, RegistryValueOptions options) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public</b> <span class="i">RegistryValueKind</span> <a id="0c3a5317248b2ec8" href="../R/0c3a5317248b2ec8.html" target="n" data-glyph="72,1" class="i method">GetValueKind</a>(<b>string</b> <span id="r16 rd" class="r16 r">name</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetValueKind(string name) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public void</b> <a id="4eccfc08b8005061" href="../R/4eccfc08b8005061.html" target="n" data-glyph="72,1" class="i method">Close</a>()
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;Close() is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public abstract string</b> <a id="9fcbc33da5a04f6f" href="../R/9fcbc33da5a04f6f.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <b>public abstract int</b> <a id="cb728ef843e43e57" href="../R/cb728ef843e43e57.html" target="n" data-glyph="102,1" class="i property">SubKeyCount</a> { <b>get</b>; }
 
        <b>public void</b> <a id="80402425535b6631" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAccessControl</a>(<span class="i">ObjectSecurity</span> <span id="r17 rd" class="r17 r">securityDescriptor</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;SetAccessControl(ObjectSecurity securityDescriptor) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
 
        <b>public</b> <span class="i">ObjectSecurity</span> <a id="6340d5d09d06170f" href="../R/6340d5d09d06170f.html" target="n" data-glyph="72,1" class="i method">GetAccessControl</a>(<span class="i">AccessControlSections</span> <span id="r18 rd" class="r18 r">includeSections</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;GetAccessControl(AccessControlSections includeSections) is not implemented. TransactedRegistry related APIs should not be used.&quot;</span>);
        }
    }
 
    <b>internal sealed class</b> <a id="3fee81b749402c36" href="../R/3fee81b749402c36.html" target="n" data-glyph="2,0" class="t t"><span id="9acfed68dbe0d405">TransactedRegistry</span></a>
    {
        <b>internal static readonly</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="7a9c731337123c11" href="../R/7a9c731337123c11.html" target="n" data-glyph="44,1" class="i field">LocalMachine</a>;
        <b>internal static readonly</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="016022f2463394b9" href="../R/016022f2463394b9.html" target="n" data-glyph="44,1" class="i field">ClassesRoot</a>;
        <b>internal static readonly</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="cb1e43316312d487" href="../R/cb1e43316312d487.html" target="n" data-glyph="44,1" class="i field">Users</a>;
        <b>internal static readonly</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="8b36e4006a02bab7" href="../R/8b36e4006a02bab7.html" target="n" data-glyph="44,1" class="i field">CurrentConfig</a>;
        <b>internal static readonly</b> <a href="#c653e56b410e12c1" class="t t">TransactedRegistryKey</a> <a id="cec0301a4f4bc63d" href="../R/cec0301a4f4bc63d.html" target="n" data-glyph="44,1" class="i field">CurrentUser</a>;
    }
 
    <b>internal sealed class</b> <a id="0cb9543d2ebe6956" href="../R/0cb9543d2ebe6956.html" target="n" data-glyph="2,0" class="t t"><span id="88038e8853e5d9b4">TransactedRegistrySecurity</span></a> : <span class="i">ObjectSecurity</span>
    {
        <b>public override</b> <span class="i">Type</span> <a id="028e562565e47e9b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AccessRightType</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
            }
        }
 
        <b>public override</b> <span class="i">Type</span> <a id="6f5039d650659ad0" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AccessRuleType</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
            }
        }
 
        <b>public override</b> <span class="i">Type</span> <a id="5c4809d4a5b52670" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AuditRuleType</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
            }
        }
 
        <b>public override</b> <span class="i">AccessRule</span> <a id="688ec028bbe11724" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AccessRuleFactory</a>(<span class="i">IdentityReference</span> <span id="r19 rd" class="r19 r">identityReference</span>, <b>int</b> <span id="r20 rd" class="r20 r">accessMask</span>, <b>bool</b> <span id="r21 rd" class="r21 r">isInherited</span>, <span class="i">InheritanceFlags</span> <span id="r22 rd" class="r22 r">inheritanceFlags</span>, <span class="i">PropagationFlags</span> <span id="r23 rd" class="r23 r">propagationFlags</span>, <span class="i">AccessControlType</span> <span id="r24 rd" class="r24 r">type</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <b>public override</b> <span class="i">AuditRule</span> <a id="173cd03bc8f4810a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AuditRuleFactory</a>(<span class="i">IdentityReference</span> <span id="r25 rd" class="r25 r">identityReference</span>, <b>int</b> <span id="r26 rd" class="r26 r">accessMask</span>, <b>bool</b> <span id="r27 rd" class="r27 r">isInherited</span>, <span class="i">InheritanceFlags</span> <span id="r28 rd" class="r28 r">inheritanceFlags</span>, <span class="i">PropagationFlags</span> <span id="r29 rd" class="r29 r">propagationFlags</span>, <span class="i">AuditFlags</span> <span id="r30 rd" class="r30 r">flags</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <b>protected override bool</b> <a id="37e0fb9817c128ed" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ModifyAccess</a>(<span class="i">AccessControlModification</span> <span id="r31 rd" class="r31 r">modification</span>, <span class="i">AccessRule</span> <span id="r32 rd" class="r32 r">rule</span>, <b>out bool</b> <span id="r33 rd" class="r33 r">modified</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <b>protected override bool</b> <a id="6a176c5a28be5e89" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ModifyAudit</a>(<span class="i">AccessControlModification</span> <span id="r34 rd" class="r34 r">modification</span>, <span class="i">AuditRule</span> <span id="r35 rd" class="r35 r">rule</span>, <b>out bool</b> <span id="r36 rd" class="r36 r">modified</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> TransactedRegistryKey
}
 
<span class="k preprocess">#</span><span class="k preprocess">endregion</span> PS_STUBS
 
<span class="c">// -- Will port the actual PS component [update: Not necessarily porting all PS components listed here]</span>
<span class="k preprocess">#</span><span class="k preprocess">region</span> TEMPORARY
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>
{
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> TODO:CORECLR - The actual PowerShellModuleAssemblyAnalyzer cannot be enabled because we don&#39;t have &#39;System.Reflection.Metadata.dll&#39; in our branch yet.</span>
    <span class="c">///</span><span class="c"> This stub will be removed once we enable the actual &#39;PowerShellModuleAssemblyAnalyzer&#39;.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="f4fb8b5b6704aa5b" href="../R/f4fb8b5b6704aa5b.html" target="n" data-glyph="2,0" class="t t">PowerShellModuleAssemblyAnalyzer</a>
    {
        <b>internal static</b> <a href="../engine/Modules/ModuleCmdletBase.cs.html#840a95d56ee83b97" class="t t">BinaryAnalysisResult</a> <a id="c02bfbd2b051c153" href="../R/c02bfbd2b051c153.html" target="n" data-glyph="74,1" class="i method">AnalyzeModuleAssembly</a>(<b>string</b> <span id="r37 rd" class="r37 r">path</span>, <b>out</b> <span class="i">Version</span> <span id="r38 rd" class="r38 r">assemblyVersion</span>)
        {
            <span class="r38 r">assemblyVersion</span> = <b>new</b> <span class="i">Version</span>(<span class="s">&quot;0.0.0.0&quot;</span>);
            <b>return</b> <b>null</b>;
        }
    }
}
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>;
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RegistryStringResourceIndirect
 
    <b>internal sealed class</b> <a id="7b46197e3795d23d" href="../R/7b46197e3795d23d.html" target="n" data-glyph="2,0" class="t t"><span id="d796a006a5d52e76">RegistryStringResourceIndirect</span></a> : <span class="i">IDisposable</span>
    {
        <b>internal static</b> <a href="#7b46197e3795d23d" class="t t">RegistryStringResourceIndirect</a> <a id="46f5e93449d857c6" href="../R/46f5e93449d857c6.html" target="n" data-glyph="74,1" class="i method">GetResourceIndirectReader</a>()
        {
            <b>return</b> <b>new</b> <span class="t">RegistryStringResourceIndirect</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose method unloads the app domain that was</span>
        <span class="c">///</span><span class="c"> created in the constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3ff544e18958a8cc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
        }
 
        <b>internal string</b> <a id="a372bc93cd96e2de" href="../R/a372bc93cd96e2de.html" target="n" data-glyph="74,1" class="i method">GetResourceStringIndirect</a>(
            <b>string</b> <span id="r39 rd" class="r39 r">assemblyName</span>,
            <b>string</b> <span id="r40 rd" class="r40 r">modulePath</span>,
            <b>string</b> <span id="r41 rd" class="r41 r">baseNameRIDPair</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;RegistryStringResourceIndirect.GetResourceStringIndirect - 3 params&quot;</span>);
        }
 
        <b>internal string</b> <a id="594e9bd78af58900" href="../R/594e9bd78af58900.html" target="n" data-glyph="74,1" class="i method">GetResourceStringIndirect</a>(
            <span class="i">RegistryKey</span> <span id="r42 rd" class="r42 r">key</span>,
            <b>string</b> <span id="r43 rd" class="r43 r">valueName</span>,
            <b>string</b> <span id="r44 rd" class="r44 r">assemblyName</span>,
            <b>string</b> <span id="r45 rd" class="r45 r">modulePath</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;RegistryStringResourceIndirect.GetResourceStringIndirect - 4 params&quot;</span>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">
namespace System.Management.Automation.ComInterop
{
    using System.Dynamic;
    using System.Runtime.InteropServices;
 
    /// &lt;summary&gt;
    /// Provides helper methods to bind COM objects dynamically.
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;
    /// COM is not supported on Unix platforms. So this is a stub type.
    /// &lt;/remarks&gt;
    internal static class ComBinder
    {
        /// &lt;summary&gt;
        /// Tries to perform binding of the dynamic get index operation.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Always return false in CoreCLR.
        /// &lt;/remarks&gt;
        public static bool TryBindGetIndex(GetIndexBinder binder, DynamicMetaObject instance, DynamicMetaObject[] args, out DynamicMetaObject result)
        {
            result = null;
            return false;
        }
 
        /// &lt;summary&gt;
        /// Tries to perform binding of the dynamic set index operation.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Always return false in CoreCLR.
        /// &lt;/remarks&gt;
        public static bool TryBindSetIndex(SetIndexBinder binder, DynamicMetaObject instance, DynamicMetaObject[] args, DynamicMetaObject value, out DynamicMetaObject result)
        {
            result = null;
            return false;
        }
 
        /// &lt;summary&gt;
        /// Tries to perform binding of the dynamic get member operation.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Always return false in CoreCLR.
        /// &lt;/remarks&gt;
        public static bool TryBindGetMember(GetMemberBinder binder, DynamicMetaObject instance, out DynamicMetaObject result, bool delayInvocation)
        {
            result = null;
            return false;
        }
 
        /// &lt;summary&gt;
        /// Tries to perform binding of the dynamic set member operation.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Always return false in CoreCLR.
        /// &lt;/remarks&gt;
        public static bool TryBindSetMember(SetMemberBinder binder, DynamicMetaObject instance, DynamicMetaObject value, out DynamicMetaObject result)
        {
            result = null;
            return false;
        }
 
        /// &lt;summary&gt;
        /// Tries to perform binding of the dynamic invoke member operation.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        /// Always return false in CoreCLR.
        /// &lt;/remarks&gt;
        public static bool TryBindInvokeMember(InvokeMemberBinder binder, bool isSetProperty, DynamicMetaObject instance, DynamicMetaObject[] args, out DynamicMetaObject result)
        {
            result = null;
            return false;
        }
    }
 
    internal static class VarEnumSelector
    {
        internal static Type GetTypeForVarEnum(VarEnum vt)
        {
            throw new PlatformNotSupportedException();
        }
    }
}
 
namespace System.Management.Automation.Security
{
    /// &lt;summary&gt;
    /// Application white listing security policies only affect Windows OSs.
    /// &lt;/summary&gt;
    internal sealed class SystemPolicy
    {
        private SystemPolicy() { }
 
        /// &lt;summary&gt;
        /// Gets the system lockdown policy.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Always return SystemEnforcementMode.None in CSS (trusted)&lt;/remarks&gt;
        public static SystemEnforcementMode GetSystemLockdownPolicy()
        {
            return SystemEnforcementMode.None;
        }
 
        /// &lt;summary&gt;
        /// Gets lockdown policy as applied to a file.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;Always return SystemEnforcementMode.None in CSS (trusted)&lt;/remarks&gt;
        public static SystemEnforcementMode GetLockdownPolicy(string path, System.Runtime.InteropServices.SafeHandle handle)
        {
            return SystemEnforcementMode.None;
        }
 
        internal static bool IsClassInApprovedList(Guid clsid)
        {
            throw new NotImplementedException(&quot;SystemPolicy.IsClassInApprovedList not implemented&quot;);
        }
    }
 
    /// &lt;summary&gt;
    /// How the policy is being enforced.
    /// &lt;/summary&gt;
    internal enum SystemEnforcementMode
    {
        /// Not enforced at all
        None = 0,
 
        /// Enabled - allow, but audit
        Audit = 1,
 
        /// Enabled, enforce restrictions
        Enforce = 2
    }
}
 
// Porting note: Tracing is absolutely not available on Linux
namespace System.Management.Automation.Tracing
{
    using System.Diagnostics.CodeAnalysis;
    using System.Management.Automation.Internal;
 
    /// &lt;summary&gt;
    /// &lt;/summary&gt;
    [SuppressMessage(&quot;Microsoft.Naming&quot;, &quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;)]
    public abstract class EtwActivity
    {
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;activityId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static bool SetActivityId(Guid activityId)
        {
            return false;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static Guid CreateActivityId()
        {
            return Guid.Empty;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public static Guid GetActivityId()
        {
            return Guid.Empty;
        }
    }
 
    public enum PowerShellTraceTask
    {
        /// &lt;summary&gt;
        /// None.
        /// &lt;/summary&gt;
        None = 0,
 
        /// &lt;summary&gt;
        /// CreateRunspace.
        /// &lt;/summary&gt;
        CreateRunspace = 1,
 
        /// &lt;summary&gt;
        /// ExecuteCommand.
        /// &lt;/summary&gt;
        ExecuteCommand = 2,
 
        /// &lt;summary&gt;
        /// Serialization.
        /// &lt;/summary&gt;
        Serialization = 3,
 
        /// &lt;summary&gt;
        /// PowerShellConsoleStartup.
        /// &lt;/summary&gt;
        PowerShellConsoleStartup = 4,
    }
 
    /// &lt;summary&gt;
    /// Defines Keywords.
    /// &lt;/summary&gt;
    [System.Diagnostics.CodeAnalysis.SuppressMessage(&quot;Microsoft.Design&quot;, &quot;CA1028&quot;)]
    [Flags]
    public enum PowerShellTraceKeywords : ulong
    {
        /// &lt;summary&gt;
        /// None.
        /// &lt;/summary&gt;
        None = 0,
 
        /// &lt;summary&gt;
        /// Runspace.
        /// &lt;/summary&gt;
        Runspace = 0x1,
 
        /// &lt;summary&gt;
        /// Pipeline.
        /// &lt;/summary&gt;
        Pipeline = 0x2,
 
        /// &lt;summary&gt;
        /// Protocol.
        /// &lt;/summary&gt;
        Protocol = 0x4,
 
        /// &lt;summary&gt;
        /// Transport.
        /// &lt;/summary&gt;
        Transport = 0x8,
 
        /// &lt;summary&gt;
        /// Host.
        /// &lt;/summary&gt;
        Host = 0x10,
 
        /// &lt;summary&gt;
        /// Cmdlets.
        /// &lt;/summary&gt;
        Cmdlets = 0x20,
 
        /// &lt;summary&gt;
        /// Serializer.
        /// &lt;/summary&gt;
        Serializer = 0x40,
 
        /// &lt;summary&gt;
        /// Session.
        /// &lt;/summary&gt;
        Session = 0x80,
 
        /// &lt;summary&gt;
        /// ManagedPlugIn.
        /// &lt;/summary&gt;
        ManagedPlugIn = 0x100,
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        UseAlwaysDebug = 0x2000000000000000,
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        UseAlwaysOperational = 0x8000000000000000,
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        UseAlwaysAnalytic = 0x4000000000000000,
    }
 
    public sealed partial class Tracer : System.Management.Automation.Tracing.EtwActivity
    {
        static Tracer() { }
 
        public void EndpointRegistered(string endpointName, string endpointType, string registeredBy)
        {
        }
 
        public void EndpointUnregistered(string endpointName, string unregisteredBy)
        {
        }
 
        public void EndpointDisabled(string endpointName, string disabledBy)
        {
        }
 
        public void EndpointEnabled(string endpointName, string enabledBy)
        {
        }
 
        public void EndpointModified(string endpointName, string modifiedBy)
        {
        }
 
        public void BeginContainerParentJobExecution(Guid containerParentJobInstanceId)
        {
        }
 
        public void BeginProxyJobExecution(Guid proxyJobInstanceId)
        {
        }
 
        public void ProxyJobRemoteJobAssociation(Guid proxyJobInstanceId, Guid containerParentJobInstanceId)
        {
        }
 
        public void EndProxyJobExecution(Guid proxyJobInstanceId)
        {
        }
 
        public void BeginProxyJobEventHandler(Guid proxyJobInstanceId)
        {
        }
 
        public void EndProxyJobEventHandler(Guid proxyJobInstanceId)
        {
        }
 
        public void BeginProxyChildJobEventHandler(Guid proxyChildJobInstanceId)
        {
        }
 
        public void EndContainerParentJobExecution(Guid containerParentJobInstanceId)
        {
        }
    }
 
    public sealed class PowerShellTraceSource : IDisposable
    {
        internal PowerShellTraceSource(PowerShellTraceTask task, PowerShellTraceKeywords keywords)
        {
        }
 
        public void Dispose()
        {
        }
 
        public bool WriteMessage(string message)
        {
            return false;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message1&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;message2&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool WriteMessage(string message1, string message2)
        {
            return false;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;instanceId&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public bool WriteMessage(string message, Guid instanceId)
        {
            return false;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;className&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;methodName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;workflowId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public void WriteMessage(string className, string methodName, Guid workflowId, string message, params string[] parameters)
        {
            return;
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;className&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;methodName&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;workflowId&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;job&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;parameters&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public void WriteMessage(string className, string methodName, Guid workflowId, Job job, string message, params string[] parameters)
        {
            return;
        }
 
        public bool TraceException(Exception exception)
        {
            return false;
        }
    }
 
    /// &lt;summary&gt;
    /// TraceSourceFactory will return an instance of TraceSource every time GetTraceSource method is called.
    /// &lt;/summary&gt;
    public static class PowerShellTraceSourceFactory
    {
        /// &lt;summary&gt;
        /// Returns an instance of BaseChannelWriter.
        /// If the Etw is not supported by the platform it will return NullWriter.Instance
        ///
        /// A Task and a set of Keywords can be specified in the GetTraceSource method (See overloads).
        ///    The supplied task and keywords are used to pass to the Etw provider in case they are
        /// not defined in the manifest file.
        /// &lt;/summary&gt;
        public static PowerShellTraceSource GetTraceSource()
        {
            return new PowerShellTraceSource(PowerShellTraceTask.None, PowerShellTraceKeywords.None);
        }
 
        /// &lt;summary&gt;
        /// Returns an instance of BaseChannelWriter.
        /// If the Etw is not supported by the platform it will return NullWriter.Instance
        ///
        /// A Task and a set of Keywords can be specified in the GetTraceSource method (See overloads).
        ///    The supplied task and keywords are used to pass to the Etw provider in case they are
        /// not defined in the manifest file.
        /// &lt;/summary&gt;
        public static PowerShellTraceSource GetTraceSource(PowerShellTraceTask task)
        {
            return new PowerShellTraceSource(task, PowerShellTraceKeywords.None);
        }
 
        /// &lt;summary&gt;
        /// Returns an instance of BaseChannelWriter.
        /// If the Etw is not supported by the platform it will return NullWriter.Instance
        ///
        /// A Task and a set of Keywords can be specified in the GetTraceSource method (See overloads).
        ///    The supplied task and keywords are used to pass to the Etw provider in case they are
        /// not defined in the manifest file.
        /// &lt;/summary&gt;
        public static PowerShellTraceSource GetTraceSource(PowerShellTraceTask task, PowerShellTraceKeywords keywords)
        {
            return new PowerShellTraceSource(task, keywords);
        }
    }
}
 
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>
{
    <b>internal static class</b> <a id="a4b69245aeec3a9b" href="../R/a4b69245aeec3a9b.html" target="n" data-glyph="2,0" class="t t">NativeCultureResolver</a>
    {
        <b>internal static void</b> <a id="11242d4bf235519d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetThreadUILanguage</a>(<span class="i">Int16</span> <span id="r46 rd" class="r46 r">langId</span>) { }
 
        <b>internal static</b> <span class="i">CultureInfo</span> <a id="b2753a9600ef53de" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">UICulture</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>; <span class="c">// this is actually wrong, but until we port &quot;hostifaces\NativeCultureResolver.cs&quot; to Nano, this will do and will help avoid build break.</span>
            }
        }
 
        <b>internal static</b> <span class="i">CultureInfo</span> <a id="325c5fc91ee1bc21" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">Culture</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>; <span class="c">// this is actually wrong, but until we port &quot;hostifaces\NativeCultureResolver.cs&quot; to Nano, this will do and will help avoid build break.</span>
            }
        }
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">endregion</span> TEMPORARY
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 1591, 1572, 1571, 1573, 1587, 1570, 0067
</pre></td></tr></table></div></body></html>
