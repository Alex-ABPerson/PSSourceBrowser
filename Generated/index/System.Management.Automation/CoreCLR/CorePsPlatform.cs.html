<!DOCTYPE html>
<html><head><title>CorePsPlatform.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1250);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/CoreCLR/CorePsPlatform.cs" target="_top">CoreCLR\CorePsPlatform.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>.<span class="i">SafeHandles</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> These are platform abstractions and platform specific implementations.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="693813241122eb45" href="../R/693813241122eb45.html" target="n" data-glyph="0,0" class="t t">Platform</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the current platform is Linux.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="99a87a41a4637eed" href="../R/99a87a41a4637eed.html" target="n" data-glyph="102,1" class="i property">IsLinux</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">RuntimeInformation</span>.<span class="i">IsOSPlatform</span>(<span class="i">OSPlatform</span>.<span class="i">Linux</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the current platform is macOS.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="560f200299e30e2b" href="../R/560f200299e30e2b.html" target="n" data-glyph="102,1" class="i property">IsMacOS</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">RuntimeInformation</span>.<span class="i">IsOSPlatform</span>(<span class="i">OSPlatform</span>.<span class="i">OSX</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the current platform is Windows.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="a0395f876114b36d" href="../R/a0395f876114b36d.html" target="n" data-glyph="102,1" class="i property">IsWindows</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">RuntimeInformation</span>.<span class="i">IsOSPlatform</span>(<span class="i">OSPlatform</span>.<span class="i">Windows</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if PowerShell was built targeting .NET Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="898d4d8b25dd0230" href="../R/898d4d8b25dd0230.html" target="n" data-glyph="102,1" class="i property">IsCoreCLR</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the underlying system is NanoServer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="38977c53f94fb1a0" href="../R/38977c53f94fb1a0.html" target="n" data-glyph="102,1" class="i property">IsNanoServer</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">                return false;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <b>if</b> (<a href="#94c875d123891ae8" class="i field">_isNanoServer</a>.<span class="i">HasValue</span>) { <b>return</b> <a href="#94c875d123891ae8" class="i field">_isNanoServer</a>.<span class="i">Value</span>; }
 
                <a href="#94c875d123891ae8" class="i field">_isNanoServer</a> = <b>false</b>;
                <b>using</b> (<span class="i">RegistryKey</span> <span id="r0 rd" class="r0 r">regKey</span> = <span class="i">Registry</span>.<span class="i">LocalMachine</span>.<span class="i">OpenSubKey</span>(<span class="s">@&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\Server\ServerLevels&quot;</span>))
                {
                    <b>if</b> (<span class="r0 r">regKey</span> != <b>null</b>)
                    {
                        <b>object</b> <span id="r1 rd" class="r1 r">value</span> = <span class="r0 r">regKey</span>.<span class="i">GetValue</span>(<span class="s">&quot;NanoServer&quot;</span>);
                        <b>if</b> (<span class="r1 r">value</span> != <b>null</b> &amp;&amp; <span class="r0 r">regKey</span>.<span class="i">GetValueKind</span>(<span class="s">&quot;NanoServer&quot;</span>) == <span class="i">RegistryValueKind</span>.<span class="i">DWord</span>)
                        {
                            <a href="#94c875d123891ae8" class="i field">_isNanoServer</a> = (<b>int</b>)<span class="r1 r">value</span> == 1;
                        }
                    }
                }
 
                <b>return</b> <a href="#94c875d123891ae8" class="i field">_isNanoServer</a>.<span class="i">Value</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the underlying system is IoT.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="aa5ad57a38d993ae" href="../R/aa5ad57a38d993ae.html" target="n" data-glyph="102,1" class="i property">IsIoT</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">                return false;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <b>if</b> (<a href="#a3a8d8403b572c0c" class="i field">_isIoT</a>.<span class="i">HasValue</span>) { <b>return</b> <a href="#a3a8d8403b572c0c" class="i field">_isIoT</a>.<span class="i">Value</span>; }
 
                <a href="#a3a8d8403b572c0c" class="i field">_isIoT</a> = <b>false</b>;
                <b>using</b> (<span class="i">RegistryKey</span> <span id="r2 rd" class="r2 r">regKey</span> = <span class="i">Registry</span>.<span class="i">LocalMachine</span>.<span class="i">OpenSubKey</span>(<span class="s">@&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion&quot;</span>))
                {
                    <b>if</b> (<span class="r2 r">regKey</span> != <b>null</b>)
                    {
                        <b>object</b> <span id="r3 rd" class="r3 r">value</span> = <span class="r2 r">regKey</span>.<span class="i">GetValue</span>(<span class="s">&quot;ProductName&quot;</span>);
                        <b>if</b> (<span class="r3 r">value</span> != <b>null</b> &amp;&amp; <span class="r2 r">regKey</span>.<span class="i">GetValueKind</span>(<span class="s">&quot;ProductName&quot;</span>) == <span class="i">RegistryValueKind</span>.<span class="i">String</span>)
                        {
                            <a href="#a3a8d8403b572c0c" class="i field">_isIoT</a> = <b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;IoTUAP&quot;</span>, (<b>string</b>)<span class="r3 r">value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                        }
                    }
                }
 
                <b>return</b> <a href="#a3a8d8403b572c0c" class="i field">_isIoT</a>.<span class="i">Value</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if underlying system is Windows Desktop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="527d8835d493a8d0" href="../R/527d8835d493a8d0.html" target="n" data-glyph="102,1" class="i property">IsWindowsDesktop</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">                return false;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <b>if</b> (<a href="#9d633843482ee3d9" class="i field">_isWindowsDesktop</a>.<span class="i">HasValue</span>) { <b>return</b> <a href="#9d633843482ee3d9" class="i field">_isWindowsDesktop</a>.<span class="i">Value</span>; }
 
                <a href="#9d633843482ee3d9" class="i field">_isWindowsDesktop</a> = !<a href="#38977c53f94fb1a0" class="i property">IsNanoServer</a> &amp;&amp; !<a href="#aa5ad57a38d993ae" class="i property">IsIoT</a>;
                <b>return</b> <a href="#9d633843482ee3d9" class="i field">_isWindowsDesktop</a>.<span class="i">Value</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating whether the underlying system supports single-threaded apartment.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="0b3908af9cce4dd8" href="../R/0b3908af9cce4dd8.html" target="n" data-glyph="102,1" class="i property">IsStaSupported</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">                return false;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <b>return</b> <a href="#7842d2870f239001" class="i field">_isStaSupported</a>.<span class="i">Value</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">        // Gets the location for cache and config folders.
        internal static readonly string CacheDirectory = Platform.SelectProductNameForDirectory(Platform.XDG_Type.CACHE);
        internal static readonly string ConfigDirectory = Platform.SelectProductNameForDirectory(Platform.XDG_Type.CONFIG);
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
        <span class="c">// Gets the location for cache and config folders.</span>
        <b>internal static readonly string</b> <a id="4dfab0cd608f3fa0" href="../R/4dfab0cd608f3fa0.html" target="n" data-glyph="44,1" class="i field">CacheDirectory</a> = <span class="i">Environment</span>.<span class="i">GetFolderPath</span>(<span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">LocalApplicationData</span>) + <span class="s">@&quot;\Microsoft\PowerShell&quot;</span>;
        <b>internal static readonly string</b> <a id="2a4e129e24ec4ad7" href="../R/2a4e129e24ec4ad7.html" target="n" data-glyph="44,1" class="i field">ConfigDirectory</a> = <span class="i">Environment</span>.<span class="i">GetFolderPath</span>(<span class="i">Environment</span>.<span class="i">SpecialFolder</span>.<span class="i">Personal</span>) + <span class="s">@&quot;\PowerShell&quot;</span>;
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<b>bool</b>&gt; <a id="7842d2870f239001" href="../R/7842d2870f239001.html" target="n" data-glyph="46,1" class="i field">_isStaSupported</a> = <b>new</b> <span class="i">Lazy</span>&lt;<b>bool</b>&gt;(() =&gt;
        {
            <span class="c">// See objbase.h</span>
            <b>const int</b> <span id="r4 rd" class="r4 r">COINIT_APARTMENTTHREADED</span> = 0x2;
            <b>const int</b> <span id="r5 rd" class="r5 r">E_NOTIMPL</span> = <b>unchecked</b>((<b>int</b>)0X80004001);
            <b>int</b> <span id="r6 rd" class="r6 r">result</span> = <a href="#eea42167b6adcbb0" class="t t">Windows</a>.<a href="#e8c8740ed7d66b0c" class="t t">NativeMethods</a>.<span class="i">CoInitializeEx</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <span class="r4 r">COINIT_APARTMENTTHREADED</span>);
 
            <span class="c">// If 0 is returned the thread has been initialized for the first time</span>
            <span class="c">// as an STA and thus supported and needs to be uninitialized.</span>
            <b>if</b> (<span class="r6 r">result</span> &gt; 0)
            {
                <a href="#eea42167b6adcbb0" class="t t">Windows</a>.<a href="#e8c8740ed7d66b0c" class="t t">NativeMethods</a>.<a href="#082ab21d6b8375ca" class="i method">CoUninitialize</a>();
            }
 
            <b>return</b> <span class="r6 r">result</span> != <span class="r5 r">E_NOTIMPL</span>;
        });
 
        <b>private static bool</b>? <a id="94c875d123891ae8" href="../R/94c875d123891ae8.html" target="n" data-glyph="46,1" class="i field">_isNanoServer</a> = <b>null</b>;
        <b>private static bool</b>? <a id="a3a8d8403b572c0c" href="../R/a3a8d8403b572c0c.html" target="n" data-glyph="46,1" class="i field">_isIoT</a> = <b>null</b>;
        <b>private static bool</b>? <a id="9d633843482ee3d9" href="../R/9d633843482ee3d9.html" target="n" data-glyph="46,1" class="i field">_isWindowsDesktop</a> = <b>null</b>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">// format files</span>
        <b>internal static readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="105908610838278e" href="../R/105908610838278e.html" target="n" data-glyph="44,1" class="i field">FormatFileNames</a> = <b>new</b>()
        {
            <span class="s">&quot;Certificate.format.ps1xml&quot;</span>,
            <span class="s">&quot;Diagnostics.format.ps1xml&quot;</span>,
            <span class="s">&quot;DotNetTypes.format.ps1xml&quot;</span>,
            <span class="s">&quot;Event.format.ps1xml&quot;</span>,
            <span class="s">&quot;FileSystem.format.ps1xml&quot;</span>,
            <span class="s">&quot;Help.format.ps1xml&quot;</span>,
            <span class="s">&quot;HelpV3.format.ps1xml&quot;</span>,
            <span class="s">&quot;PowerShellCore.format.ps1xml&quot;</span>,
            <span class="s">&quot;PowerShellTrace.format.ps1xml&quot;</span>,
            <span class="s">&quot;Registry.format.ps1xml&quot;</span>,
            <span class="s">&quot;WSMan.format.ps1xml&quot;</span>
        };
 
        <b>private static string</b> <a id="ea873cf1748c976b" href="../R/ea873cf1748c976b.html" target="n" data-glyph="46,1" class="i field">_tempDirectory</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Some common environment variables used in PS have different</span>
        <span class="c">///</span><span class="c"> names in different OS platforms.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static class</b> <a id="2ec531e5b2c821e4" href="../R/2ec531e5b2c821e4.html" target="n" data-glyph="2,1" class="t t">CommonEnvVariableNames</a>
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">            internal const string Home = &quot;HOME&quot;;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
            <b>internal const string</b> <a id="7bda162e9185ce4e" href="../R/7bda162e9185ce4e.html" target="n" data-glyph="8,2" class="i field">Home</a> = <span class="s">&quot;USERPROFILE&quot;</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove the temporary directory created for the current process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="40d85659e3743982" href="../R/40d85659e3743982.html" target="n" data-glyph="74,1" class="i method">RemoveTemporaryDirectory</a>()
        {
            <b>if</b> (<a href="#ea873cf1748c976b" class="i field">_tempDirectory</a> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <span class="i">Directory</span>.<span class="i">Delete</span>(<a href="#ea873cf1748c976b" class="i field">_tempDirectory</a>, <b>true</b>);
            }
            <b>catch</b>
            {
                <span class="c">// ignore if there is a failure</span>
            }
 
            <a href="#ea873cf1748c976b" class="i field">_tempDirectory</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a temporary directory to use for the current process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="f37d2f4e7bba31e7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetTemporaryDirectory</a>()
        {
            <b>if</b> (<a href="#ea873cf1748c976b" class="i field">_tempDirectory</a> != <b>null</b>)
            {
                <b>return</b> <a href="#ea873cf1748c976b" class="i field">_tempDirectory</a>;
            }
 
            <a href="#ea873cf1748c976b" class="i field">_tempDirectory</a> = <a href="../utils/PsUtils.cs.html#2010e19f156f8c91" class="t t">PsUtils</a>.<a href="../utils/PsUtils.cs.html#2814b0910ff078f8" class="i method">GetTemporaryDirectory</a>();
            <b>return</b> <a href="#ea873cf1748c976b" class="i field">_tempDirectory</a>;
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">        /// &lt;summary&gt;
        /// X Desktop Group configuration type enum.
        /// &lt;/summary&gt;
        public enum XDG_Type
        {
            /// &lt;summary&gt; XDG_CONFIG_HOME/powershell &lt;/summary&gt;
            CONFIG,
            /// &lt;summary&gt; XDG_CACHE_HOME/powershell &lt;/summary&gt;
            CACHE,
            /// &lt;summary&gt; XDG_DATA_HOME/powershell &lt;/summary&gt;
            DATA,
            /// &lt;summary&gt; XDG_DATA_HOME/powershell/Modules &lt;/summary&gt;
            USER_MODULES,
            /// &lt;summary&gt; /usr/local/share/powershell/Modules &lt;/summary&gt;
            SHARED_MODULES,
            /// &lt;summary&gt; XDG_CONFIG_HOME/powershell &lt;/summary&gt;
            DEFAULT
        }
 
        private static string s_tempHomeDir = null;
 
        /// &lt;summary&gt;
        /// Function for choosing directory location of PowerShell for profile loading.
        /// &lt;/summary&gt;
        public static string SelectProductNameForDirectory(Platform.XDG_Type dirpath)
        {
            // TODO: XDG_DATA_DIRS implementation as per GitHub issue #1060
 
            string xdgconfighome = System.Environment.GetEnvironmentVariable(&quot;XDG_CONFIG_HOME&quot;);
            string xdgdatahome = System.Environment.GetEnvironmentVariable(&quot;XDG_DATA_HOME&quot;);
            string xdgcachehome = System.Environment.GetEnvironmentVariable(&quot;XDG_CACHE_HOME&quot;);
            string envHome = System.Environment.GetEnvironmentVariable(CommonEnvVariableNames.Home);
            if (envHome == null)
            {
                s_tempHomeDir ??= GetTemporaryDirectory();
                envHome = s_tempHomeDir;
            }
 
            string xdgConfigHomeDefault = Path.Combine(envHome, &quot;.config&quot;, &quot;powershell&quot;);
            string xdgDataHomeDefault = Path.Combine(envHome, &quot;.local&quot;, &quot;share&quot;, &quot;powershell&quot;);
            string xdgModuleDefault = Path.Combine(xdgDataHomeDefault, &quot;Modules&quot;);
            string xdgCacheDefault = Path.Combine(envHome, &quot;.cache&quot;, &quot;powershell&quot;);
 
            switch (dirpath)
            {
                case Platform.XDG_Type.CONFIG:
                    // the user has set XDG_CONFIG_HOME corresponding to profile path
                    if (string.IsNullOrEmpty(xdgconfighome))
                    {
                        // xdg values have not been set
                        return xdgConfigHomeDefault;
                    }
 
                    else
                    {
                        return Path.Combine(xdgconfighome, &quot;powershell&quot;);
                    }
 
                case Platform.XDG_Type.DATA:
                    // the user has set XDG_DATA_HOME corresponding to module path
                    if (string.IsNullOrEmpty(xdgdatahome))
                    {
                        // create the xdg folder if needed
                        if (!Directory.Exists(xdgDataHomeDefault))
                        {
                            try
                            {
                                Directory.CreateDirectory(xdgDataHomeDefault);
                            }
                            catch (UnauthorizedAccessException)
                            {
                                // service accounts won&#39;t have permission to create user folder
                                return GetTemporaryDirectory();
                            }
                        }
 
                        return xdgDataHomeDefault;
                    }
                    else
                    {
                        return Path.Combine(xdgdatahome, &quot;powershell&quot;);
                    }
 
                case Platform.XDG_Type.USER_MODULES:
                    // the user has set XDG_DATA_HOME corresponding to module path
                    if (string.IsNullOrEmpty(xdgdatahome))
                    {
                        // xdg values have not been set
                        if (!Directory.Exists(xdgModuleDefault)) // module folder not always guaranteed to exist
                        {
                            try
                            {
                                Directory.CreateDirectory(xdgModuleDefault);
                            }
                            catch (UnauthorizedAccessException)
                            {
                                // service accounts won&#39;t have permission to create user folder
                                return GetTemporaryDirectory();
                            }
                        }
 
                        return xdgModuleDefault;
                    }
                    else
                    {
                        return Path.Combine(xdgdatahome, &quot;powershell&quot;, &quot;Modules&quot;);
                    }
 
                case Platform.XDG_Type.SHARED_MODULES:
                    return &quot;/usr/local/share/powershell/Modules&quot;;
 
                case Platform.XDG_Type.CACHE:
                    // the user has set XDG_CACHE_HOME
                    if (string.IsNullOrEmpty(xdgcachehome))
                    {
                        // xdg values have not been set
                        if (!Directory.Exists(xdgCacheDefault)) // module folder not always guaranteed to exist
                        {
                            try
                            {
                                Directory.CreateDirectory(xdgCacheDefault);
                            }
                            catch (UnauthorizedAccessException)
                            {
                                // service accounts won&#39;t have permission to create user folder
                                return GetTemporaryDirectory();
                            }
                        }
 
                        return xdgCacheDefault;
                    }
                    else
                    {
                        if (!Directory.Exists(Path.Combine(xdgcachehome, &quot;powershell&quot;)))
                        {
                            try
                            {
                                Directory.CreateDirectory(Path.Combine(xdgcachehome, &quot;powershell&quot;));
                            }
                            catch (UnauthorizedAccessException)
                            {
                                // service accounts won&#39;t have permission to create user folder
                                return GetTemporaryDirectory();
                            }
                        }
 
                        return Path.Combine(xdgcachehome, &quot;powershell&quot;);
                    }
 
                case Platform.XDG_Type.DEFAULT:
                    // default for profile location
                    return xdgConfigHomeDefault;
 
                default:
                    // xdgConfigHomeDefault needs to be created in the edge case that we do not have the folder or it was deleted
                    // This folder is the default in the event of all other failures for data storage
                    if (!Directory.Exists(xdgConfigHomeDefault))
                    {
                        try
                        {
                            Directory.CreateDirectory(xdgConfigHomeDefault);
                        }
                        catch
                        {
                            Console.Error.WriteLine(&quot;Failed to create default data directory: &quot; + xdgConfigHomeDefault);
                        }
                    }
 
                    return xdgConfigHomeDefault;
            }
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The code is copied from the .NET implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="a4c16711a5915bbd" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetFolderPath</a>(<span class="i n">System</span>.<span class="i">Environment</span>.<span class="i">SpecialFolder</span> <span id="r7 rd" class="r7 r">folder</span>)
        {
            <b>return</b> <a href="#db4d756acbcbab14" class="i method">InternalGetFolderPath</a>(<span class="r7 r">folder</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The API set &#39;api-ms-win-shell-shellfolders-l1-1-0.dll&#39; was removed from NanoServer, so we cannot depend on &#39;SHGetFolderPathW&#39;</span>
        <span class="c">///</span><span class="c"> to get the special folder paths. Instead, we need to rely on the basic environment variables to get the special folder paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to the specified system special folder, if that folder physically exists on your computer.</span>
        <span class="c">///</span><span class="c"> Otherwise, an empty string (string.Empty).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="db4d756acbcbab14" href="../R/db4d756acbcbab14.html" target="n" data-glyph="76,1" class="i method">InternalGetFolderPath</a>(<span class="i n">System</span>.<span class="i">Environment</span>.<span class="i">SpecialFolder</span> <span id="r8 rd" class="r8 r">folder</span>)
        {
            <b>string</b> <span id="r9 rd" class="r9 r">folderPath</span> = <b>null</b>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">            string envHome = System.Environment.GetEnvironmentVariable(Platform.CommonEnvVariableNames.Home);
            if (envHome == null)
            {
                envHome = Platform.GetTemporaryDirectory();
            }
 
            switch (folder)
            {
                case System.Environment.SpecialFolder.ProgramFiles:
                    folderPath = &quot;/bin&quot;;
                    if (!System.IO.Directory.Exists(folderPath)) { folderPath = null; }
 
                    break;
                case System.Environment.SpecialFolder.ProgramFilesX86:
                    folderPath = &quot;/usr/bin&quot;;
                    if (!System.IO.Directory.Exists(folderPath)) { folderPath = null; }
 
                    break;
                case System.Environment.SpecialFolder.System:
                case System.Environment.SpecialFolder.SystemX86:
                    folderPath = &quot;/sbin&quot;;
                    if (!System.IO.Directory.Exists(folderPath)) { folderPath = null; }
 
                    break;
                case System.Environment.SpecialFolder.Personal:
                    folderPath = envHome;
                    break;
                case System.Environment.SpecialFolder.LocalApplicationData:
                    folderPath = System.IO.Path.Combine(envHome, &quot;.config&quot;);
                    if (!System.IO.Directory.Exists(folderPath))
                    {
                        try
                        {
                            System.IO.Directory.CreateDirectory(folderPath);
                        }
                        catch (UnauthorizedAccessException)
                        {
                            // directory creation may fail if the account doesn&#39;t have filesystem permission such as some service accounts
                            folderPath = string.Empty;
                        }
                    }
 
                    break;
                default:
                    throw new NotSupportedException();
            }
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
            <span class="r9 r">folderPath</span> = <span class="i n">System</span>.<span class="i">Environment</span>.<span class="i">GetFolderPath</span>(<span class="r8 r">folder</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <b>return</b> <span class="r9 r">folderPath</span> ?? <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="c">// Platform methods prefixed NonWindows are:</span>
        <span class="c">// - non-windows by the definition of the IsWindows method above</span>
        <span class="c">// - here, because porting to Linux and other operating systems</span>
        <span class="c">//   should not move the original Windows code out of the module</span>
        <span class="c">//   it belongs to, so this way the windows code can remain in it&#39;s</span>
        <span class="c">//   original source file and only the non-windows code has been moved</span>
        <span class="c">//   out here</span>
        <span class="c">// - only to be used with the IsWindows feature query, and only if</span>
        <span class="c">//   no other more specific feature query makes sense</span>
 
        <b>internal static bool</b> <a id="d4033d3ef20fd433" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsIsHardLink</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r10 rd" class="r10 r">handle</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#cf8ecc81e5959edc" class="i method">IsHardLink</a>(<b>ref</b> <span class="r10 r">handle</span>);
        }
 
        <b>internal static bool</b> <a id="b041068bbad7d9af" href="../R/b041068bbad7d9af.html" target="n" data-glyph="74,1" class="i method">NonWindowsIsHardLink</a>(<span class="i">FileSystemInfo</span> <span id="r11 rd" class="r11 r">fileInfo</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#699ab28cf71a1fc0" class="i method">IsHardLink</a>(<span class="r11 r">fileInfo</span>);
        }
 
        <b>internal static string</b> <a id="b2355c229227f4d8" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsInternalGetTarget</a>(<b>string</b> <span id="r12 rd" class="r12 r">path</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#98c7807003288ece" class="i method">FollowSymLink</a>(<span class="r12 r">path</span>);
        }
 
        <b>internal static string</b> <a id="e1dcaea0970f6d6d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsGetUserFromPid</a>(<b>int</b> <span id="r13 rd" class="r13 r">path</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#6fead80ebc59c627" class="i method">GetUserFromPid</a>(<span class="r13 r">path</span>);
        }
 
        <b>internal static string</b> <a id="73977320dec19f12" href="../R/73977320dec19f12.html" target="n" data-glyph="74,1" class="i method">NonWindowsInternalGetLinkType</a>(<span class="i">FileSystemInfo</span> <span id="r14 rd" class="r14 r">fileInfo</span>)
        {
            <b>if</b> (<span class="r14 r">fileInfo</span>.<span class="i">Attributes</span>.<span class="i">HasFlag</span>(<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">FileAttributes</span>.<span class="i">ReparsePoint</span>))
            {
                <b>return</b> <span class="s">&quot;SymbolicLink&quot;</span>;
            }
 
            <b>if</b> (<a href="#b041068bbad7d9af" class="i method">NonWindowsIsHardLink</a>(<span class="r14 r">fileInfo</span>))
            {
                <b>return</b> <span class="s">&quot;HardLink&quot;</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static bool</b> <a id="5d496b737ef5f0c7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsCreateSymbolicLink</a>(<b>string</b> <span id="r15 rd" class="r15 r">path</span>, <b>string</b> <span id="r16 rd" class="r16 r">target</span>)
        {
            <span class="c">// Linux doesn&#39;t care if target is a directory or not</span>
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#f4c0858ecb678668" class="i method">CreateSymLink</a>(<span class="r15 r">path</span>, <span class="r16 r">target</span>) == 0;
        }
 
        <b>internal static bool</b> <a id="8cf180aaf61de1b4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsCreateHardLink</a>(<b>string</b> <span id="r17 rd" class="r17 r">path</span>, <b>string</b> <span id="r18 rd" class="r18 r">strTargetPath</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#60c71ffb3d4c7c6c" class="i method">CreateHardLink</a>(<span class="r17 r">path</span>, <span class="r18 r">strTargetPath</span>) == 0;
        }
 
        <b>internal static unsafe bool</b> <a id="cc88fb71b1241eac" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsSetDate</a>(<span class="i">DateTime</span> <span id="r19 rd" class="r19 r">dateToUse</span>)
        {
            <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#8a007213d701ecd9" class="t t">UnixTm</a> <span id="r20 rd" class="r20 r">tm</span> = <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#e9a6ef40207a52f2" class="i method">DateTimeToUnixTm</a>(<span class="r19 r">dateToUse</span>);
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#291ea0c95f73c379" class="i method">SetDate</a>(&amp;<span class="r20 r">tm</span>) == 0;
        }
 
        <b>internal static bool</b> <a id="3af770ab42373668" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsIsSameFileSystemItem</a>(<b>string</b> <span id="r21 rd" class="r21 r">pathOne</span>, <b>string</b> <span id="r22 rd" class="r22 r">pathTwo</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#3f2c7246031fdedc" class="i method">IsSameFileSystemItem</a>(<span class="r21 r">pathOne</span>, <span class="r22 r">pathTwo</span>);
        }
 
        <b>internal static bool</b> <a id="2554bc4db747e288" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsGetInodeData</a>(<b>string</b> <span id="r23 rd" class="r23 r">path</span>, <b>out</b> <span class="i n">System</span>.<span class="i">ValueTuple</span>&lt;<span class="i">UInt64</span>, <span class="i">UInt64</span>&gt; <span id="r24 rd" class="r24 r">inodeData</span>)
        {
            <span class="i">UInt64</span> <span id="r25 rd" class="r25 r">device</span> = 0UL;
            <span class="i">UInt64</span> <span id="r26 rd" class="r26 r">inode</span> = 0UL;
            <b>var</b> <span id="r27 rd" class="r27 r">result</span> = <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#d7d48a10ee719903" class="i method">GetInodeData</a>(<span class="r23 r">path</span>, <b>out</b> <span class="r25 r">device</span>, <b>out</b> <span class="r26 r">inode</span>);
 
            <span class="r24 r">inodeData</span> = (<span class="r25 r">device</span>, <span class="r26 r">inode</span>);
            <b>return</b> <span class="r27 r">result</span> == 0;
        }
 
        <b>internal static bool</b> <a id="67a7455f248aadf6" href="../R/67a7455f248aadf6.html" target="n" data-glyph="74,1" class="i method">NonWindowsIsExecutable</a>(<b>string</b> <span id="r28 rd" class="r28 r">path</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#b0c2f8df171a43f3" class="i method">IsExecutable</a>(<span class="r28 r">path</span>);
        }
 
        <b>internal static uint</b> <a id="5d642b8ff9b8b6b1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsGetThreadId</a>()
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#82b9be4e7593685f" class="i method">GetCurrentThreadId</a>();
        }
 
        <b>internal static int</b> <a id="1a49ca81d1bd2824" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsGetProcessParentPid</a>(<b>int</b> <span id="r29 rd" class="r29 r">pid</span>)
        {
            <b>return</b> <a href="#560f200299e30e2b" class="i property">IsMacOS</a> ? <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#eaa0c2401238900a" class="i method">GetPPid</a>(<span class="r29 r">pid</span>) : <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#8e4e251b60451f31" class="i method">GetProcFSParentPid</a>(<span class="r29 r">pid</span>);
        }
 
        <b>internal static bool</b> <a id="43c3aa64de58d5ef" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsKillProcess</a>(<b>int</b> <span id="r30 rd" class="r30 r">pid</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#2313310b571466c8" class="i method">KillProcess</a>(<span class="r30 r">pid</span>);
        }
 
        <b>internal static int</b> <a id="a2ba961313fc008a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonWindowsWaitPid</a>(<b>int</b> <span id="r31 rd" class="r31 r">pid</span>, <b>bool</b> <span id="r32 rd" class="r32 r">nohang</span>)
        {
            <b>return</b> <a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#44c4702bfe5ec169" class="i method">WaitPid</a>(<span class="r31 r">pid</span>, <span class="r32 r">nohang</span>);
        }
 
        <b>internal static class</b> <a id="eea42167b6adcbb0" href="../R/eea42167b6adcbb0.html" target="n" data-glyph="2,1" class="t t">Windows</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The native methods class.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal static class</b> <a id="e8c8740ed7d66b0c" href="../R/e8c8740ed7d66b0c.html" target="n" data-glyph="2,2" class="t t">NativeMethods</a>
            {
                <b>private const string</b> <a id="a76108f60460edfd" href="../R/a76108f60460edfd.html" target="n" data-glyph="10,3" class="i field">ole32Lib</a> = <span class="s">&quot;api-ms-win-core-com-l1-1-0.dll&quot;</span>;
 
                [<span class="i">DllImport</span>(<a href="#a76108f60460edfd" class="i field">ole32Lib</a>)]
                <b>internal static extern int</b> <a id="30ce40e661d0e904" href="../R/../../0000000000.html" target="n" data-glyph="74,3" class="i method">CoInitializeEx</a>(<span class="i">IntPtr</span> <span id="r33 rd" class="r33 r">reserve</span>, <b>int</b> <span id="r34 rd" class="r34 r">coinit</span>);
 
                [<span class="i">DllImport</span>(<a href="#a76108f60460edfd" class="i field">ole32Lib</a>)]
                <b>internal static extern void</b> <a id="082ab21d6b8375ca" href="../R/082ab21d6b8375ca.html" target="n" data-glyph="74,3" class="i method">CoUninitialize</a>();
            }
        }
 
        <span class="c">// Please note that `Win32Exception(Marshal.GetLastWin32Error())`</span>
        <span class="c">// works *correctly* on Linux in that it creates an exception with</span>
        <span class="c">// the string perror would give you for the last set value of errno.</span>
        <span class="c">// No manual mapping is required. .NET Core maps the Linux errno</span>
        <span class="c">// to a PAL value and calls strerror_r underneath to generate the message.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Unix specific implementations of required functionality.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static class</b> <a id="17627ff7d1ae7b20" href="../R/17627ff7d1ae7b20.html" target="n" data-glyph="2,1" class="t t">Unix</a>
        {
            <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>int</b>, <b>string</b>&gt; <a id="e785acc1d9dabc5c" href="../R/e785acc1d9dabc5c.html" target="n" data-glyph="46,2" class="i field">usernameCache</a> = <b>new</b>();
            <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>int</b>, <b>string</b>&gt; <a id="8d33d5db46f38e2e" href="../R/8d33d5db46f38e2e.html" target="n" data-glyph="46,2" class="i field">groupnameCache</a> = <b>new</b>();
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The type of a Unix file system item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public enum</b> <a id="0f5053b5ce7aa5c2" href="../R/0f5053b5ce7aa5c2.html" target="n" data-glyph="18,2" class="t t"><span id="7556beb478c79360">ItemType</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Directory.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="22a24667c9140615" href="../R/22a24667c9140615.html" target="n" data-glyph="24,3" class="i field">Directory</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a File.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="9ad2a3d7e78645a2" href="../R/9ad2a3d7e78645a2.html" target="n" data-glyph="24,3" class="i field">File</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Symbolic Link.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="da9d35ba3bf5ba3c" href="../R/da9d35ba3bf5ba3c.html" target="n" data-glyph="24,3" class="i field">SymbolicLink</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Block Device.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="2b63230a75b1b75e" href="../R/2b63230a75b1b75e.html" target="n" data-glyph="24,3" class="i field">BlockDevice</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Character Device.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="9bf704e7268a13cc" href="../R/9bf704e7268a13cc.html" target="n" data-glyph="24,3" class="i field">CharacterDevice</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Named Pipe.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="e46c37ec42223397" href="../R/e46c37ec42223397.html" target="n" data-glyph="24,3" class="i field">NamedPipe</a>,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The item is a Socket.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="9e04cbf38929b48f" href="../R/9e04cbf38929b48f.html" target="n" data-glyph="24,3" class="i field">Socket</a>,
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to use to retrieve specific mode bits from the mode value in the stat class.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public enum</b> <a id="5eba69866150da5d" href="../R/5eba69866150da5d.html" target="n" data-glyph="18,2" class="t t"><span id="7ae6081b2fa00391">StatMask</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to collect the owner mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="70798afb8572561e" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">OwnerModeMask</a> = 0x1C0,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the owners read bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="ed98bda773db0a2b" href="../R/ed98bda773db0a2b.html" target="n" data-glyph="24,3" class="i field">OwnerRead</a> = 0x100,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the owners write bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="80ddcca1b7aac987" href="../R/80ddcca1b7aac987.html" target="n" data-glyph="24,3" class="i field">OwnerWrite</a> = 0x080,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the owners execute bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="d2a3c602210fc4ba" href="../R/d2a3c602210fc4ba.html" target="n" data-glyph="24,3" class="i field">OwnerExecute</a> = 0x040,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the group mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="8fbf031bd4843d59" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">GroupModeMask</a> = 0x038,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the group mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="12d05e0dae5fa9f3" href="../R/12d05e0dae5fa9f3.html" target="n" data-glyph="24,3" class="i field">GroupRead</a> = 0x20,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the group mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="2988f0d03bd88874" href="../R/2988f0d03bd88874.html" target="n" data-glyph="24,3" class="i field">GroupWrite</a> = 0x10,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the group mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="c8a7257033b46b4f" href="../R/c8a7257033b46b4f.html" target="n" data-glyph="24,3" class="i field">GroupExecute</a> = 0x8,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the &quot;other&quot; mode.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="d506ed879b9317ae" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">OtherModeMask</a> = 0x007,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the &quot;other&quot; read bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="e014f71a477efba9" href="../R/e014f71a477efba9.html" target="n" data-glyph="24,3" class="i field">OtherRead</a> = 0x004,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the &quot;other&quot; write bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="fc03f0fb5f5876be" href="../R/fc03f0fb5f5876be.html" target="n" data-glyph="24,3" class="i field">OtherWrite</a> = 0x002,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to get the &quot;other&quot; execute bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="d738ed2a430a6eae" href="../R/d738ed2a430a6eae.html" target="n" data-glyph="24,3" class="i field">OtherExecute</a> = 0x001,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to retrieve the sticky bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="ba334b807ec710a9" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">SetStickyMask</a> = 0x200,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to retrieve the setgid bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="86b3305e98c22060" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">SetGidMask</a> = 0x400,
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mask to retrieve the setuid bit.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <a id="c96c64dd4769d267" href="../R/../../0000000000.html" target="n" data-glyph="24,3" class="i field">SetUidMask</a> = 0x800,
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The Common Stat class.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public class</b> <a id="77debb264671ca91" href="../R/77debb264671ca91.html" target="n" data-glyph="0,2" class="t t"><span id="d83972f8326da6b4">CommonStat</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The inode of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public long</b> <a id="4df1872656c6ecc5" href="../R/4df1872656c6ecc5.html" target="n" data-glyph="42,3" class="i field">Inode</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The Mode of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="b7b69dbfca077de3" href="../R/b7b69dbfca077de3.html" target="n" data-glyph="42,3" class="i field">Mode</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The user id of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="453fff79bfa1bdfd" href="../R/453fff79bfa1bdfd.html" target="n" data-glyph="42,3" class="i field">UserId</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The group id of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="b5651138b6cd2c71" href="../R/b5651138b6cd2c71.html" target="n" data-glyph="42,3" class="i field">GroupId</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The number of hard links for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="516c91278d4961f7" href="../R/516c91278d4961f7.html" target="n" data-glyph="42,3" class="i field">HardlinkCount</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The size in bytes of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public long</b> <a id="f6a8b987a686b873" href="../R/f6a8b987a686b873.html" target="n" data-glyph="42,3" class="i field">Size</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The last access time of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public</b> <span class="i">DateTime</span> <a id="fc30e89323d8dacd" href="../R/fc30e89323d8dacd.html" target="n" data-glyph="42,3" class="i field">AccessTime</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The last modified time for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public</b> <span class="i">DateTime</span> <a id="70a323c733b68b60" href="../R/70a323c733b68b60.html" target="n" data-glyph="42,3" class="i field">ModifiedTime</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The last time the status changes for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public</b> <span class="i">DateTime</span> <a id="7d71b2bc888fa88c" href="../R/7d71b2bc888fa88c.html" target="n" data-glyph="42,3" class="i field">StatusChangeTime</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The block size of the filesystem.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public long</b> <a id="a4c32b28499916b6" href="../R/a4c32b28499916b6.html" target="n" data-glyph="42,3" class="i field">BlockSize</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The device id of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="4fc09f347c9d85cc" href="../R/4fc09f347c9d85cc.html" target="n" data-glyph="42,3" class="i field">DeviceId</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The number of blocks used by the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public int</b> <a id="1486aab63c7c9b3d" href="../R/1486aab63c7c9b3d.html" target="n" data-glyph="42,3" class="i field">NumberOfBlocks</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The type of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public</b> <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a> <a id="371cd3a436dc8818" href="../R/371cd3a436dc8818.html" target="n" data-glyph="42,3" class="i field">ItemType</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Whether the filesystem item has the setuid bit enabled.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public bool</b> <a id="3e7044539883dcbe" href="../R/3e7044539883dcbe.html" target="n" data-glyph="42,3" class="i field">IsSetUid</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Whether the filesystem item has the setgid bit enabled.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public bool</b> <a id="f9c8207da16ba1f6" href="../R/f9c8207da16ba1f6.html" target="n" data-glyph="42,3" class="i field">IsSetGid</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Whether the filesystem item has the sticky bit enabled. This is only available for directories.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>public bool</b> <a id="6c6ac3f90b93cd00" href="../R/6c6ac3f90b93cd00.html" target="n" data-glyph="42,3" class="i field">IsSticky</a>;
 
                <b>private const char</b> <a id="0294192f9aadedb9" href="../R/0294192f9aadedb9.html" target="n" data-glyph="10,3" class="i field">CanRead</a> = <span class="s">&#39;r&#39;</span>;
                <b>private const char</b> <a id="f1630c8963ce8044" href="../R/f1630c8963ce8044.html" target="n" data-glyph="10,3" class="i field">CanWrite</a> = <span class="s">&#39;w&#39;</span>;
                <b>private const char</b> <a id="e97a68ef06c4303b" href="../R/e97a68ef06c4303b.html" target="n" data-glyph="10,3" class="i field">CanExecute</a> = <span class="s">&#39;x&#39;</span>;
 
                <span class="c">// helper for getting unix mode</span>
                <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="#5eba69866150da5d" class="t t">StatMask</a>, <b>char</b>&gt; <a id="915f988a6cd23550" href="../R/915f988a6cd23550.html" target="n" data-glyph="46,3" class="i field">modeMap</a> = <b>new</b>()
                {
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#ed98bda773db0a2b" class="i field">OwnerRead</a>, <a href="#0294192f9aadedb9" class="i field">CanRead</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#80ddcca1b7aac987" class="i field">OwnerWrite</a>, <a href="#f1630c8963ce8044" class="i field">CanWrite</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d2a3c602210fc4ba" class="i field">OwnerExecute</a>, <a href="#e97a68ef06c4303b" class="i field">CanExecute</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#12d05e0dae5fa9f3" class="i field">GroupRead</a>, <a href="#0294192f9aadedb9" class="i field">CanRead</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#2988f0d03bd88874" class="i field">GroupWrite</a>, <a href="#f1630c8963ce8044" class="i field">CanWrite</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#c8a7257033b46b4f" class="i field">GroupExecute</a>, <a href="#e97a68ef06c4303b" class="i field">CanExecute</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#e014f71a477efba9" class="i field">OtherRead</a>, <a href="#0294192f9aadedb9" class="i field">CanRead</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#fc03f0fb5f5876be" class="i field">OtherWrite</a>, <a href="#f1630c8963ce8044" class="i field">CanWrite</a> },
                        { <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d738ed2a430a6eae" class="i field">OtherExecute</a>, <a href="#e97a68ef06c4303b" class="i field">CanExecute</a> },
                };
 
                <b>private readonly</b> <a href="#5eba69866150da5d" class="t t">StatMask</a>[] <a id="40e483925680c1ef" href="../R/40e483925680c1ef.html" target="n" data-glyph="46,3" class="i field">permissions</a> = <b>new</b> <a href="#5eba69866150da5d" class="t t">StatMask</a>[]
                {
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#ed98bda773db0a2b" class="i field">OwnerRead</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#80ddcca1b7aac987" class="i field">OwnerWrite</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d2a3c602210fc4ba" class="i field">OwnerExecute</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#12d05e0dae5fa9f3" class="i field">GroupRead</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#2988f0d03bd88874" class="i field">GroupWrite</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#c8a7257033b46b4f" class="i field">GroupExecute</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#e014f71a477efba9" class="i field">OtherRead</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#fc03f0fb5f5876be" class="i field">OtherWrite</a>,
                    <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d738ed2a430a6eae" class="i field">OtherExecute</a>
                };
 
                <span class="c">// The item type and the character representation for the first element in the stat string</span>
                <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>, <b>char</b>&gt; <a id="d8784371aabffd9b" href="../R/d8784371aabffd9b.html" target="n" data-glyph="46,3" class="i field">itemTypeTable</a> = <b>new</b>()
                {
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#2b63230a75b1b75e" class="i field">BlockDevice</a>, <span class="s">&#39;b&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9bf704e7268a13cc" class="i field">CharacterDevice</a>, <span class="s">&#39;c&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#22a24667c9140615" class="i field">Directory</a>, <span class="s">&#39;d&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9ad2a3d7e78645a2" class="i field">File</a>, <span class="s">&#39;-&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#e46c37ec42223397" class="i field">NamedPipe</a>, <span class="s">&#39;p&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9e04cbf38929b48f" class="i field">Socket</a>, <span class="s">&#39;s&#39;</span> },
                    { <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#da9d35ba3bf5ba3c" class="i field">SymbolicLink</a>, <span class="s">&#39;l&#39;</span> },
                };
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Convert the mode to a string which is usable in our formatting.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The mode converted into a Unix style string similar to the output of ls.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
                <b>public string</b> <a id="0d3b74efa09c42f5" href="../R/../../0000000000.html" target="n" data-glyph="72,3" class="i method">GetModeString</a>()
                {
                    <b>int</b> <span id="r35 rd" class="r35 r">offset</span> = 0;
                    <b>char</b>[] <span id="r36 rd" class="r36 r">modeCharacters</span> = <b>new</b> <b>char</b>[10];
                    <span class="r36 r">modeCharacters</span>[<span class="r35 r">offset</span>++] = <a href="#d8784371aabffd9b" class="i field">itemTypeTable</a>[<a href="#371cd3a436dc8818" class="i field">ItemType</a>];
 
                    <b>foreach</b> (<a href="#5eba69866150da5d" class="t t">StatMask</a> <span id="r37 rd" class="r37 r">permission</span> <b>in</b> <a href="#40e483925680c1ef" class="i field">permissions</a>)
                    {
                        <span class="c">// determine whether we are setuid, sticky, or the usual rwx.</span>
                        <b>if</b> ((<a href="#b7b69dbfca077de3" class="i field">Mode</a> &amp; (<b>int</b>)<span class="r37 r">permission</span>) == (<b>int</b>)<span class="r37 r">permission</span>)
                        {
                            <b>if</b> ((<span class="r37 r">permission</span> == <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d2a3c602210fc4ba" class="i field">OwnerExecute</a> &amp;&amp; <a href="#3e7044539883dcbe" class="i field">IsSetUid</a>) || (<span class="r37 r">permission</span> == <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#c8a7257033b46b4f" class="i field">GroupExecute</a> &amp;&amp; <a href="#f9c8207da16ba1f6" class="i field">IsSetGid</a>))
                            {
                                <span class="c">// Check for setuid and add &#39;s&#39;</span>
                                <span class="r36 r">modeCharacters</span>[<span class="r35 r">offset</span>] = <span class="s">&#39;s&#39;</span>;
                            }
                            <b>else</b> <b>if</b> (<span class="r37 r">permission</span> == <a href="#5eba69866150da5d" class="t t">StatMask</a>.<a href="#d738ed2a430a6eae" class="i field">OtherExecute</a> &amp;&amp; <a href="#6c6ac3f90b93cd00" class="i field">IsSticky</a> &amp;&amp; (<a href="#371cd3a436dc8818" class="i field">ItemType</a> == <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#22a24667c9140615" class="i field">Directory</a>))
                            {
                                <span class="c">// Directories are sticky, rather than setuid</span>
                                <span class="r36 r">modeCharacters</span>[<span class="r35 r">offset</span>] = <span class="s">&#39;t&#39;</span>;
                            }
                            <b>else</b>
                            {
                                <span class="r36 r">modeCharacters</span>[<span class="r35 r">offset</span>] = <a href="#915f988a6cd23550" class="i field">modeMap</a>[<span class="r37 r">permission</span>];
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r36 r">modeCharacters</span>[<span class="r35 r">offset</span>] = <span class="s">&#39;-&#39;</span>;
                        }
 
                        <span class="r35 r">offset</span>++;
                    }
 
                    <b>return</b> <b>new</b> <b>string</b>(<span class="r36 r">modeCharacters</span>);
                }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Get the user name. This is used in formatting, but we shouldn&#39;t</span>
                <span class="c">///</span><span class="c"> do the pinvoke this unless we&#39;re going to use it.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The user name.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
                <b>public string</b> <a id="e36f9797fbde4edd" href="../R/../../0000000000.html" target="n" data-glyph="72,3" class="i method">GetUserName</a>()
                {
                    <b>if</b> (<a href="#e785acc1d9dabc5c" class="i field">usernameCache</a>.<span class="i">TryGetValue</span>(<a href="#453fff79bfa1bdfd" class="i field">UserId</a>, <b>out string</b> <span id="r38 rd" class="r38 r">username</span>))
                    {
                        <b>return</b> <span class="r38 r">username</span>;
                    }
 
                    <span class="c">// Get and add the user name to the cache so we don&#39;t need to</span>
                    <span class="c">// have a pinvoke for each file.</span>
                    <span class="r38 r">username</span> = <a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#1c4e9b9caa8a43b9" class="i method">GetPwUid</a>(<a href="#453fff79bfa1bdfd" class="i field">UserId</a>);
                    <a href="#e785acc1d9dabc5c" class="i field">usernameCache</a>.<span class="i">Add</span>(<a href="#453fff79bfa1bdfd" class="i field">UserId</a>, <span class="r38 r">username</span>);
 
                    <b>return</b> <span class="r38 r">username</span>;
                }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Get the group name. This is used in formatting, but we shouldn&#39;t</span>
                <span class="c">///</span><span class="c"> do the pinvoke this unless we&#39;re going to use it.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The name of the group.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
                <b>public string</b> <a id="ae2f5b5ca28a826f" href="../R/../../0000000000.html" target="n" data-glyph="72,3" class="i method">GetGroupName</a>()
                {
                    <b>if</b> (<a href="#8d33d5db46f38e2e" class="i field">groupnameCache</a>.<span class="i">TryGetValue</span>(<a href="#b5651138b6cd2c71" class="i field">GroupId</a>, <b>out string</b> <span id="r39 rd" class="r39 r">groupname</span>))
                    {
                        <b>return</b> <span class="r39 r">groupname</span>;
                    }
 
                    <span class="c">// Get and add the group name to the cache so we don&#39;t need to</span>
                    <span class="c">// have a pinvoke for each file.</span>
                    <span class="r39 r">groupname</span> = <a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#01827cc98c493a8f" class="i method">GetGrGid</a>(<a href="#b5651138b6cd2c71" class="i field">GroupId</a>);
                    <a href="#8d33d5db46f38e2e" class="i field">groupnameCache</a>.<span class="i">Add</span>(<a href="#b5651138b6cd2c71" class="i field">GroupId</a>, <span class="r39 r">groupname</span>);
 
                    <b>return</b> <span class="r39 r">groupname</span>;
                }
            }
 
            <span class="c">// This is a helper that attempts to map errno into a PowerShell ErrorCategory</span>
            <b>internal static</b> <a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <a id="3ba2bb8ac076855d" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">GetErrorCategory</a>(<b>int</b> <span id="r40 rd" class="r40 r">errno</span>)
            {
                <b>return</b> (<a href="../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>)<a href="#17627ff7d1ae7b20" class="t t">Unix</a>.<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#e333cd339368429c" class="i method">GetErrorCategory</a>(<span class="r40 r">errno</span>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Is this a hardlink.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">handle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The handle to a file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A boolean that represents whether the item is a hardlink.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static bool</b> <a id="cf8ecc81e5959edc" href="../R/cf8ecc81e5959edc.html" target="n" data-glyph="72,2" class="i method">IsHardLink</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r41 rd" class="r41 r">handle</span>)
            {
                <span class="c">// TODO:PSL implement using fstat to query inode refcount to see if it is a hard link</span>
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Determine if the item is a hardlink.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">fs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A FileSystemInfo to check to determine if it is a hardlink.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A boolean that represents whether the item is a hardlink.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static bool</b> <a id="699ab28cf71a1fc0" href="../R/699ab28cf71a1fc0.html" target="n" data-glyph="72,2" class="i method">IsHardLink</a>(<span class="i">FileSystemInfo</span> <span id="r42 rd" class="r42 r">fs</span>)
            {
                <b>if</b> (!<span class="r42 r">fs</span>.<span class="i">Exists</span> || (<span class="r42 r">fs</span>.<span class="i">Attributes</span> &amp; <span class="i">FileAttributes</span>.<span class="i">Directory</span>) == <span class="i">FileAttributes</span>.<span class="i">Directory</span>)
                {
                    <b>return</b> <b>false</b>;
                }
 
                <b>int</b> <span id="r43 rd" class="r43 r">count</span>;
                <b>string</b> <span id="r44 rd" class="r44 r">filePath</span> = <span class="r42 r">fs</span>.<span class="i">FullName</span>;
                <b>int</b> <span id="r45 rd" class="r45 r">ret</span> = <a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#fad6a27135034752" class="i method">GetLinkCount</a>(<span class="r44 r">filePath</span>, <b>out</b> <span class="r43 r">count</span>);
                <b>if</b> (<span class="r45 r">ret</span> == 0)
                {
                    <b>return</b> <span class="r43 r">count</span> &gt; 1;
                }
 
                <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>());
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Create a managed replica of the native stat structure.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">css</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The common stat structure from which we copy.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A managed common stat class instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>private static</b> <a href="#77debb264671ca91" class="t t">CommonStat</a> <a id="bc2411827821d9bc" href="../R/bc2411827821d9bc.html" target="n" data-glyph="76,2" class="i method">CopyStatStruct</a>(<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#6be8af972bd2d3b8" class="t t">CommonStatStruct</a> <span id="r46 rd" class="r46 r">css</span>)
            {
                <a href="#77debb264671ca91" class="t t">CommonStat</a> <span id="r47 rd" class="r47 r">cs</span> = <b>new</b>();
                <span class="r47 r">cs</span>.<a href="#4df1872656c6ecc5" class="i field">Inode</a> = <span class="r46 r">css</span>.<a href="#1d1058c57d409d8b" class="i field">Inode</a>;
                <span class="r47 r">cs</span>.<a href="#b7b69dbfca077de3" class="i field">Mode</a> = <span class="r46 r">css</span>.<a href="#f1e2c874297bba90" class="i field">Mode</a>;
                <span class="r47 r">cs</span>.<a href="#453fff79bfa1bdfd" class="i field">UserId</a> = <span class="r46 r">css</span>.<a href="#0073975da2c46476" class="i field">UserId</a>;
                <span class="r47 r">cs</span>.<a href="#b5651138b6cd2c71" class="i field">GroupId</a> = <span class="r46 r">css</span>.<a href="#7db028b6b0940e18" class="i field">GroupId</a>;
                <span class="r47 r">cs</span>.<a href="#516c91278d4961f7" class="i field">HardlinkCount</a> = <span class="r46 r">css</span>.<a href="#8c59470ad1e61752" class="i field">HardlinkCount</a>;
                <span class="r47 r">cs</span>.<a href="#f6a8b987a686b873" class="i field">Size</a> = <span class="r46 r">css</span>.<a href="#ff91baec5c8f9df7" class="i field">Size</a>;
 
                <span class="c">// These can sometime throw if we get too large a number back (seen on Raspbian).</span>
                <span class="c">// As a fallback, set the time to UnixEpoch.</span>
                <b>try</b>
                {
                    <span class="r47 r">cs</span>.<a href="#fc30e89323d8dacd" class="i field">AccessTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">AddSeconds</span>(<span class="r46 r">css</span>.<a href="#7859837701402aae" class="i field">AccessTime</a>).<span class="i">ToLocalTime</span>();
                }
                <b>catch</b>
                {
                    <span class="r47 r">cs</span>.<a href="#fc30e89323d8dacd" class="i field">AccessTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">ToLocalTime</span>();
                }
 
                <b>try</b>
                {
                    <span class="r47 r">cs</span>.<a href="#70a323c733b68b60" class="i field">ModifiedTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">AddSeconds</span>(<span class="r46 r">css</span>.<a href="#3f4880f648029bc2" class="i field">ModifiedTime</a>).<span class="i">ToLocalTime</span>();
                }
                <b>catch</b>
                {
                    <span class="r47 r">cs</span>.<a href="#70a323c733b68b60" class="i field">ModifiedTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">ToLocalTime</span>();
                }
 
                <b>try</b>
                {
                    <span class="r47 r">cs</span>.<a href="#7d71b2bc888fa88c" class="i field">StatusChangeTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">AddSeconds</span>(<span class="r46 r">css</span>.<a href="#d45cce65c79d4063" class="i field">StatusChangeTime</a>).<span class="i">ToLocalTime</span>();
                }
                <b>catch</b>
                {
                    <span class="r47 r">cs</span>.<a href="#7d71b2bc888fa88c" class="i field">StatusChangeTime</a> = <span class="i">DateTime</span>.<span class="i">UnixEpoch</span>.<span class="i">ToLocalTime</span>();
                }
 
                <span class="r47 r">cs</span>.<a href="#a4c32b28499916b6" class="i field">BlockSize</a> = <span class="r46 r">css</span>.<a href="#b1bd367d8bc37c66" class="i field">BlockSize</a>;
                <span class="r47 r">cs</span>.<a href="#4fc09f347c9d85cc" class="i field">DeviceId</a> = <span class="r46 r">css</span>.<a href="#fdd1ca9fadcdebbf" class="i field">DeviceId</a>;
                <span class="r47 r">cs</span>.<a href="#1486aab63c7c9b3d" class="i field">NumberOfBlocks</a> = <span class="r46 r">css</span>.<a href="#dcd22e0f98690157" class="i field">NumberOfBlocks</a>;
 
                <b>if</b> (<span class="r46 r">css</span>.<a href="#a127763717090542" class="i field">IsDirectory</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#22a24667c9140615" class="i field">Directory</a>;
                }
                <b>else</b> <b>if</b> (<span class="r46 r">css</span>.<a href="#831a2c1a422a6fb2" class="i field">IsFile</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9ad2a3d7e78645a2" class="i field">File</a>;
                }
                <b>else</b> <b>if</b> (<span class="r46 r">css</span>.<a href="#865fff7cfce8691e" class="i field">IsSymbolicLink</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#da9d35ba3bf5ba3c" class="i field">SymbolicLink</a>;
                }
                <b>else</b> <b>if</b> (<span class="r46 r">css</span>.<a href="#d1538e39dae9f5c7" class="i field">IsBlockDevice</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#2b63230a75b1b75e" class="i field">BlockDevice</a>;
                }
                <b>else</b> <b>if</b> (<span class="r46 r">css</span>.<a href="#715bad821dca1c9d" class="i field">IsCharacterDevice</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9bf704e7268a13cc" class="i field">CharacterDevice</a>;
                }
                <b>else</b> <b>if</b> (<span class="r46 r">css</span>.<a href="#eeba1f1519cd4cfb" class="i field">IsNamedPipe</a> == 1)
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#e46c37ec42223397" class="i field">NamedPipe</a>;
                }
                <b>else</b>
                {
                    <span class="r47 r">cs</span>.<a href="#371cd3a436dc8818" class="i field">ItemType</a> = <a href="#0f5053b5ce7aa5c2" class="t t">ItemType</a>.<a href="#9e04cbf38929b48f" class="i field">Socket</a>;
                }
 
                <span class="r47 r">cs</span>.<a href="#3e7044539883dcbe" class="i field">IsSetUid</a> = <span class="r46 r">css</span>.<a href="#b4a14b7b4e09cdf7" class="i field">IsSetUid</a> == 1;
                <span class="r47 r">cs</span>.<a href="#f9c8207da16ba1f6" class="i field">IsSetGid</a> = <span class="r46 r">css</span>.<a href="#04b47dde8f047eb2" class="i field">IsSetGid</a> == 1;
                <span class="r47 r">cs</span>.<a href="#6c6ac3f90b93cd00" class="i field">IsSticky</a> = <span class="r46 r">css</span>.<a href="#c59039474cf992df" class="i field">IsSticky</a> == 1;
 
                <b>return</b> <span class="r47 r">cs</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Get the lstat info from a path.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the lstat information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An instance of the CommonStat for the path.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static</b> <a href="#77debb264671ca91" class="t t">CommonStat</a> <a id="74e81fead7d6e104" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetLStat</a>(<b>string</b> <span id="r48 rd" class="r48 r">path</span>)
            {
                <a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#6be8af972bd2d3b8" class="t t">CommonStatStruct</a> <span id="r49 rd" class="r49 r">css</span>;
                <b>if</b> (<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#a869279b7f640a03" class="i method">GetCommonLStat</a>(<span class="r48 r">path</span>, <b>out</b> <span class="r49 r">css</span>) == 0)
                {
                    <b>return</b> <a href="#bc2411827821d9bc" class="i method">CopyStatStruct</a>(<span class="r49 r">css</span>);
                }
 
                <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>());
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Get the stat info from a path.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the stat information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An instance of the CommonStat for the path.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static</b> <a href="#77debb264671ca91" class="t t">CommonStat</a> <a id="f0c8f789f615e99b" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetStat</a>(<b>string</b> <span id="r50 rd" class="r50 r">path</span>)
            {
                <a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#6be8af972bd2d3b8" class="t t">CommonStatStruct</a> <span id="r51 rd" class="r51 r">css</span>;
                <b>if</b> (<a href="#60fde8832f02f9b4" class="t t">NativeMethods</a>.<a href="#6c36fda1d76cd310" class="i method">GetCommonStat</a>(<span class="r50 r">path</span>, <b>out</b> <span class="r51 r">css</span>) == 0)
                {
                    <b>return</b> <a href="#bc2411827821d9bc" class="i method">CopyStatStruct</a>(<span class="r51 r">css</span>);
                }
 
                <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>());
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Read the /proc file system for information about the parent.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">pid</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The process id used to get the parent process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The process id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static int</b> <a id="8e4e251b60451f31" href="../R/8e4e251b60451f31.html" target="n" data-glyph="72,2" class="i method">GetProcFSParentPid</a>(<b>int</b> <span id="r52 rd" class="r52 r">pid</span>)
            {
                <b>const int</b> <span id="r53 rd" class="r53 r">invalidPid</span> = -1;
 
                <span class="c">// read /proc/&lt;pid&gt;/stat</span>
                <span class="c">// 4th column will contain the ppid, 92 in the example below</span>
                <span class="c">// ex: 93 (bash) S 92 93 2 4294967295 ...</span>
                <b>var</b> <span id="r54 rd" class="r54 r">path</span> = <span class="s">$&quot;</span><span class="s">/proc/</span>{<span class="r52 r">pid</span>}<span class="s">/stat</span><span class="s">&quot;</span>;
                <b>try</b>
                {
                    <b>var</b> <span id="r55 rd" class="r55 r">stat</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">File</span>.<span class="i">ReadAllText</span>(<span class="r54 r">path</span>);
                    <b>var</b> <span id="r56 rd" class="r56 r">parts</span> = <span class="r55 r">stat</span>.<span class="i">Split</span>(<span class="s">&#39; &#39;</span>, 5);
                    <b>if</b> (<span class="r56 r">parts</span>.<span class="i">Length</span> &lt; 5)
                    {
                        <b>return</b> <span class="r53 r">invalidPid</span>;
                    }
 
                    <b>return</b> <span class="i">Int32</span>.<span class="i">Parse</span>(<span class="r56 r">parts</span>[3]);
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                    <b>return</b> <span class="r53 r">invalidPid</span>;
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The native methods class.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal static class</b> <a id="60fde8832f02f9b4" href="../R/60fde8832f02f9b4.html" target="n" data-glyph="2,2" class="t t">NativeMethods</a>
            {
                <b>private const string</b> <a id="524fb9d88e26daff" href="../R/524fb9d88e26daff.html" target="n" data-glyph="10,3" class="i field">psLib</a> = <span class="s">&quot;libpsl-native&quot;</span>;
 
                <span class="c">// Ansi is a misnomer, it is hardcoded to UTF-8 on Linux and macOS</span>
                <span class="c">// C bools are 1 byte and so must be marshaled as I1</span>
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>)]
                <b>internal static extern int</b> <a id="e333cd339368429c" href="../R/e333cd339368429c.html" target="n" data-glyph="74,3" class="i method">GetErrorCategory</a>(<b>int</b> <span id="r57 rd" class="r57 r">errno</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>)]
                <b>internal static extern int</b> <a id="eaa0c2401238900a" href="../R/eaa0c2401238900a.html" target="n" data-glyph="74,3" class="i method">GetPPid</a>(<b>int</b> <span id="r58 rd" class="r58 r">pid</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern int</b> <a id="fad6a27135034752" href="../R/fad6a27135034752.html" target="n" data-glyph="74,3" class="i method">GetLinkCount</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r59 rd" class="r59 r">filePath</span>, <b>out int</b> <span id="r60 rd" class="r60 r">linkCount</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">I1</span>)]
                <b>internal static extern bool</b> <a id="b0c2f8df171a43f3" href="../R/b0c2f8df171a43f3.html" target="n" data-glyph="74,3" class="i method">IsExecutable</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r61 rd" class="r61 r">filePath</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>)]
                <b>internal static extern uint</b> <a id="82b9be4e7593685f" href="../R/82b9be4e7593685f.html" target="n" data-glyph="74,3" class="i method">GetCurrentThreadId</a>();
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>)]
                [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
                <b>internal static extern bool</b> <a id="2313310b571466c8" href="../R/2313310b571466c8.html" target="n" data-glyph="74,3" class="i method">KillProcess</a>(<b>int</b> <span id="r62 rd" class="r62 r">pid</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>)]
                <b>internal static extern int</b> <a id="44c4702bfe5ec169" href="../R/44c4702bfe5ec169.html" target="n" data-glyph="74,3" class="i method">WaitPid</a>(<b>int</b> <span id="r63 rd" class="r63 r">pid</span>, <b>bool</b> <span id="r64 rd" class="r64 r">nohang</span>);
 
                <span class="c">// This is a struct tm from &lt;time.h&gt;.</span>
                [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
                <b>internal unsafe struct</b> <a id="8a007213d701ecd9" href="../R/8a007213d701ecd9.html" target="n" data-glyph="110,3" class="t t"><span id="1434031792d1e0d0">UnixTm</span></a>
                {
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Seconds (0-60).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="dc31115cc54f93d6" href="../R/dc31115cc54f93d6.html" target="n" data-glyph="44,4" class="i field">tm_sec</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Minutes (0-59).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="f42437f313665189" href="../R/f42437f313665189.html" target="n" data-glyph="44,4" class="i field">tm_min</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Hours (0-23).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="bf9413f580377e9e" href="../R/bf9413f580377e9e.html" target="n" data-glyph="44,4" class="i field">tm_hour</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Day of the month (1-31).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="2002eb3ad1f4e2db" href="../R/2002eb3ad1f4e2db.html" target="n" data-glyph="44,4" class="i field">tm_mday</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Month (0-11).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="0058cdaa2d04ad30" href="../R/0058cdaa2d04ad30.html" target="n" data-glyph="44,4" class="i field">tm_mon</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The year - 1900.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="a04812f2444d3789" href="../R/a04812f2444d3789.html" target="n" data-glyph="44,4" class="i field">tm_year</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Day of the week (0-6, Sunday = 0).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="4047e953191a8452" href="../R/4047e953191a8452.html" target="n" data-glyph="44,4" class="i field">tm_wday</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Day in the year (0-365, 1 Jan = 0).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="a3d73db152c37b39" href="../R/a3d73db152c37b39.html" target="n" data-glyph="44,4" class="i field">tm_yday</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Daylight saving time.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="2a453757ad2c16b7" href="../R/2a453757ad2c16b7.html" target="n" data-glyph="44,4" class="i field">tm_isdst</a>;
                }
 
                <span class="c">// We need a way to convert a DateTime to a unix date.</span>
                <b>internal static</b> <a href="#8a007213d701ecd9" class="t t">UnixTm</a> <a id="e9a6ef40207a52f2" href="../R/e9a6ef40207a52f2.html" target="n" data-glyph="74,3" class="i method">DateTimeToUnixTm</a>(<span class="i">DateTime</span> <span id="r65 rd" class="r65 r">date</span>)
                {
                    <a href="#8a007213d701ecd9" class="t t">UnixTm</a> <span id="r66 rd" class="r66 r">tm</span>;
                    <span class="r66 r">tm</span>.<a href="#dc31115cc54f93d6" class="i field">tm_sec</a> = <span class="r65 r">date</span>.<span class="i">Second</span>;
                    <span class="r66 r">tm</span>.<a href="#f42437f313665189" class="i field">tm_min</a> = <span class="r65 r">date</span>.<span class="i">Minute</span>;
                    <span class="r66 r">tm</span>.<a href="#bf9413f580377e9e" class="i field">tm_hour</a> = <span class="r65 r">date</span>.<span class="i">Hour</span>;
                    <span class="r66 r">tm</span>.<a href="#2002eb3ad1f4e2db" class="i field">tm_mday</a> = <span class="r65 r">date</span>.<span class="i">Day</span>;
                    <span class="r66 r">tm</span>.<a href="#0058cdaa2d04ad30" class="i field">tm_mon</a> = <span class="r65 r">date</span>.<span class="i">Month</span> - 1; <span class="c">// needs to be 0 indexed</span>
                    <span class="r66 r">tm</span>.<a href="#a04812f2444d3789" class="i field">tm_year</a> = <span class="r65 r">date</span>.<span class="i">Year</span> - 1900; <span class="c">// years since 1900</span>
                    <span class="r66 r">tm</span>.<a href="#4047e953191a8452" class="i field">tm_wday</a> = 0; <span class="c">// this is ignored by mktime</span>
                    <span class="r66 r">tm</span>.<a href="#a3d73db152c37b39" class="i field">tm_yday</a> = 0; <span class="c">// this is also ignored</span>
                    <span class="r66 r">tm</span>.<a href="#2a453757ad2c16b7" class="i field">tm_isdst</a> = <span class="r65 r">date</span>.<span class="i">IsDaylightSavingTime</span>() ? 1 : 0;
                    <b>return</b> <span class="r66 r">tm</span>;
                }
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern unsafe int</b> <a id="291ea0c95f73c379" href="../R/291ea0c95f73c379.html" target="n" data-glyph="74,3" class="i method">SetDate</a>(<a href="#8a007213d701ecd9" class="t t">UnixTm</a>* <span id="r67 rd" class="r67 r">tm</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern int</b> <a id="f4c0858ecb678668" href="../R/f4c0858ecb678668.html" target="n" data-glyph="74,3" class="i method">CreateSymLink</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r68 rd" class="r68 r">filePath</span>,
                                                         [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r69 rd" class="r69 r">target</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern int</b> <a id="60c71ffb3d4c7c6c" href="../R/60c71ffb3d4c7c6c.html" target="n" data-glyph="74,3" class="i method">CreateHardLink</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r70 rd" class="r70 r">filePath</span>,
                                                          [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r71 rd" class="r71 r">target</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
                <b>internal static extern string</b> <a id="98c7807003288ece" href="../R/98c7807003288ece.html" target="n" data-glyph="74,3" class="i method">FollowSymLink</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r72 rd" class="r72 r">filePath</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
                <b>internal static extern string</b> <a id="6fead80ebc59c627" href="../R/6fead80ebc59c627.html" target="n" data-glyph="74,3" class="i method">GetUserFromPid</a>(<b>int</b> <span id="r73 rd" class="r73 r">pid</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">I1</span>)]
                <b>internal static extern bool</b> <a id="3f2c7246031fdedc" href="../R/3f2c7246031fdedc.html" target="n" data-glyph="74,3" class="i method">IsSameFileSystemItem</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r74 rd" class="r74 r">filePathOne</span>,
                                                                 [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r75 rd" class="r75 r">filePathTwo</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern int</b> <a id="d7d48a10ee719903" href="../R/d7d48a10ee719903.html" target="n" data-glyph="74,3" class="i method">GetInodeData</a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)] <b>string</b> <span id="r76 rd" class="r76 r">path</span>,
                                                        <b>out</b> <span class="i">UInt64</span> <span id="r77 rd" class="r77 r">device</span>, <b>out</b> <span class="i">UInt64</span> <span id="r78 rd" class="r78 r">inode</span>);
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> This is a struct from getcommonstat.h in the native library.</span>
                <span class="c">///</span><span class="c"> It presents each member of the stat structure as the largest type of that member across</span>
                <span class="c">///</span><span class="c"> all stat structures on the platforms we support. This allows us to present a common</span>
                <span class="c">///</span><span class="c"> stat structure for all our platforms.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
                <b>internal struct</b> <a id="6be8af972bd2d3b8" href="../R/6be8af972bd2d3b8.html" target="n" data-glyph="110,3" class="t t"><span id="3176b22b34e85fb8">CommonStatStruct</span></a>
                {
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The inode of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="1d1058c57d409d8b" href="../R/1d1058c57d409d8b.html" target="n" data-glyph="44,4" class="i field">Inode</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The mode of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="f1e2c874297bba90" href="../R/f1e2c874297bba90.html" target="n" data-glyph="44,4" class="i field">Mode</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The user id of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="0073975da2c46476" href="../R/0073975da2c46476.html" target="n" data-glyph="44,4" class="i field">UserId</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The group id of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="7db028b6b0940e18" href="../R/7db028b6b0940e18.html" target="n" data-glyph="44,4" class="i field">GroupId</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The number of hard links to the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="8c59470ad1e61752" href="../R/8c59470ad1e61752.html" target="n" data-glyph="44,4" class="i field">HardlinkCount</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The size in bytes of the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="ff91baec5c8f9df7" href="../R/ff91baec5c8f9df7.html" target="n" data-glyph="44,4" class="i field">Size</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The time of the last access for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="7859837701402aae" href="../R/7859837701402aae.html" target="n" data-glyph="44,4" class="i field">AccessTime</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The time of the last modification for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="3f4880f648029bc2" href="../R/3f4880f648029bc2.html" target="n" data-glyph="44,4" class="i field">ModifiedTime</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The time of the last status change for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="d45cce65c79d4063" href="../R/d45cce65c79d4063.html" target="n" data-glyph="44,4" class="i field">StatusChangeTime</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The size in bytes of the file system.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal long</b> <a id="b1bd367d8bc37c66" href="../R/b1bd367d8bc37c66.html" target="n" data-glyph="44,4" class="i field">BlockSize</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The device id for the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="fdd1ca9fadcdebbf" href="../R/fdd1ca9fadcdebbf.html" target="n" data-glyph="44,4" class="i field">DeviceId</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The number of filesystem blocks that the filesystem item uses.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="dcd22e0f98690157" href="../R/dcd22e0f98690157.html" target="n" data-glyph="44,4" class="i field">NumberOfBlocks</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a directory.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="a127763717090542" href="../R/a127763717090542.html" target="n" data-glyph="44,4" class="i field">IsDirectory</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a file.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="831a2c1a422a6fb2" href="../R/831a2c1a422a6fb2.html" target="n" data-glyph="44,4" class="i field">IsFile</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a symbolic link.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="865fff7cfce8691e" href="../R/865fff7cfce8691e.html" target="n" data-glyph="44,4" class="i field">IsSymbolicLink</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a block device.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="d1538e39dae9f5c7" href="../R/d1538e39dae9f5c7.html" target="n" data-glyph="44,4" class="i field">IsBlockDevice</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a character device.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="715bad821dca1c9d" href="../R/715bad821dca1c9d.html" target="n" data-glyph="44,4" class="i field">IsCharacterDevice</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a named pipe.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="eeba1f1519cd4cfb" href="../R/eeba1f1519cd4cfb.html" target="n" data-glyph="44,4" class="i field">IsNamedPipe</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item is a socket.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="a514dc20858b68c7" href="../R/../../0000000000.html" target="n" data-glyph="44,4" class="i field">IsSocket</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item will run as the owner if executed.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="b4a14b7b4e09cdf7" href="../R/b4a14b7b4e09cdf7.html" target="n" data-glyph="44,4" class="i field">IsSetUid</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">This filesystem item will run as the group if executed.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="04b47dde8f047eb2" href="../R/04b47dde8f047eb2.html" target="n" data-glyph="44,4" class="i field">IsSetGid</a>;
 
                    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Whether the sticky bit is set on the filesystem item.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                    <b>internal int</b> <a id="c59039474cf992df" href="../R/c59039474cf992df.html" target="n" data-glyph="44,4" class="i field">IsSticky</a>;
                }
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern unsafe int</b> <a id="a869279b7f640a03" href="../R/a869279b7f640a03.html" target="n" data-glyph="74,3" class="i method">GetCommonLStat</a>(<b>string</b> <span id="r79 rd" class="r79 r">filePath</span>, [<span class="i">Out</span>] <b>out</b> <a href="#6be8af972bd2d3b8" class="t t">CommonStatStruct</a> <span id="r80 rd" class="r80 r">cs</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern unsafe int</b> <a id="6c36fda1d76cd310" href="../R/6c36fda1d76cd310.html" target="n" data-glyph="74,3" class="i method">GetCommonStat</a>(<b>string</b> <span id="r81 rd" class="r81 r">filePath</span>, [<span class="i">Out</span>] <b>out</b> <a href="#6be8af972bd2d3b8" class="t t">CommonStatStruct</a> <span id="r82 rd" class="r82 r">cs</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern string</b> <a id="1c4e9b9caa8a43b9" href="../R/1c4e9b9caa8a43b9.html" target="n" data-glyph="74,3" class="i method">GetPwUid</a>(<b>int</b> <span id="r83 rd" class="r83 r">id</span>);
 
                [<span class="i">DllImport</span>(<a href="#524fb9d88e26daff" class="i field">psLib</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Ansi</span>, <span class="i">SetLastError</span> = <b>true</b>)]
                <b>internal static extern string</b> <a id="01827cc98c493a8f" href="../R/01827cc98c493a8f.html" target="n" data-glyph="74,3" class="i method">GetGrGid</a>(<b>int</b> <span id="r84 rd" class="r84 r">id</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
