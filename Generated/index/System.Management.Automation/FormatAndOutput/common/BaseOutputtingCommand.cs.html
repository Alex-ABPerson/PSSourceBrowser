<!DOCTYPE html>
<html><head><title>BaseOutputtingCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1408);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/BaseOutputtingCommand.cs" target="_top">FormatAndOutput\common\BaseOutputtingCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> OutCommand base implementation</span>
    <span class="c">///</span><span class="c"> it manages the formatting protocol and it writes to a generic</span>
    <span class="c">///</span><span class="c"> screen host.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="82ff02ddef6485d3" href="../../R/82ff02ddef6485d3.html" target="n" data-glyph="2,0" class="t t"><span id="ca525763ad4f56ed">OutCommandInner</span></a> : <a href="BaseCommand.cs.html#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
        [<span class="i">TraceSource</span>(<span class="s">&quot;format_out_OutCommandInner&quot;</span>, <span class="s">&quot;OutCommandInner&quot;</span>)]
        <b>internal static readonly</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="45d35c51c618715a" href="../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">tracer</a> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;format_out_OutCommandInner&quot;</span>, <span class="s">&quot;OutCommandInner&quot;</span>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
 
        <b>internal override void</b> <a id="1de4c6c1cfad3a2b" href="../../R/1de4c6c1cfad3a2b.html" target="n" data-glyph="74,1" class="i method">BeginProcessing</a>()
        {
            <a href="BaseCommand.cs.html#c91a68f3aa4854f8" class="k">base</a>.<a href="BaseCommand.cs.html#5f205895950197ef" class="i method">BeginProcessing</a>();
 
            <a href="#2f43ce88b1e5c539" class="i field">_formatObjectDeserializer</a> = <b>new</b> <a href="FormattingObjectsDeserializer.cs.html#ac2f99f3a605e8d3" class="t constructor">FormatObjectDeserializer</a>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>);
 
            <span class="c">// hook up the event handlers for the context manager object</span>
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#974c5c8a372c4f82" class="i field">contextCreation</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">FormatContextCreationCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#84341f16eeaa4cb8" class="i method">CreateOutputContext</a>);
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#bf285ee900e04cdf" class="i field">fs</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">FormatStartCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#b0261b14fb29401e" class="i method">ProcessFormatStart</a>);
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#99eee74b90d871dd" class="i field">fe</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">FormatEndCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#d14b67dd05c30a2b" class="i method">ProcessFormatEnd</a>);
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#c376fccd1244e876" class="i field">gs</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">GroupStartCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#8457c34b3e9746cd" class="i method">ProcessGroupStart</a>);
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#07dca04b7238c218" class="i field">ge</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">GroupEndCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#a14f6aa2f32eb05f" class="i method">ProcessGroupEnd</a>);
            <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#9cfa5e9488585eb1" class="i field">payload</a> = <b>new</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<span class="t">PayloadCallback</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#cbbcb3dffbc18fe4" class="i method">ProcessPayload</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution entry point override</span>
        <span class="c">///</span><span class="c"> we assume that a LineOutput interface instance already has been acquired</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> IMPORTANT: it assumes the presence of a pre-processing formatting command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="4f074cd7c9facb7f" href="../../R/4f074cd7c9facb7f.html" target="n" data-glyph="74,1" class="i method">ProcessRecord</a>()
        {
            <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r0 rd" class="r0 r">so</span> = <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="BaseCommand.cs.html#194a6ddb58a33583" class="i method">ReadObject</a>();
 
            <b>if</b> (<span class="r0 r">so</span> == <b>null</b> || <span class="r0 r">so</span> == <a href="../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                <b>return</b>;
 
            <span class="c">// try to process the object</span>
            <b>if</b> (<a href="#93211642b5464bf5" class="i method">ProcessObject</a>(<span class="r0 r">so</span>))
                <b>return</b>;
 
            <span class="c">// send to the formatter for preprocessing</span>
            <span class="i">Array</span> <span id="r1 rd" class="r1 r">results</span> = <a href="#39f10ba87e3f5194" class="i method">ApplyFormatting</a>(<span class="r0 r">so</span>);
 
            <b>if</b> (<span class="r1 r">results</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r2 rd" class="r2 r">r</span> <b>in</b> <span class="r1 r">results</span>)
                {
                    <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">obj</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r2 r">r</span>);
 
                    <span class="r3 r">obj</span>.<a href="../../engine/MshObject.cs.html#46fe0e4bd3e1bb79" class="i property">IsHelpObject</a> = <span class="r0 r">so</span>.<a href="../../engine/MshObject.cs.html#46fe0e4bd3e1bb79" class="i property">IsHelpObject</a>;
 
                    <a href="#93211642b5464bf5" class="i method">ProcessObject</a>(<span class="r3 r">obj</span>);
                }
            }
        }
 
        <b>internal override void</b> <a id="2464d9d0e5806eec" href="../../R/2464d9d0e5806eec.html" target="n" data-glyph="74,1" class="i method">EndProcessing</a>()
        {
            <a href="BaseCommand.cs.html#c91a68f3aa4854f8" class="k">base</a>.<a href="BaseCommand.cs.html#f243d83d2a166983" class="i method">EndProcessing</a>();
            <b>if</b> (<a href="#946878c78752fd47" class="i field">_command</a> != <b>null</b>)
            {
                <span class="c">// shut down the command processor, if we ever used it</span>
                <span class="i">Array</span> <span id="r4 rd" class="r4 r">results</span> = <a href="#946878c78752fd47" class="i field">_command</a>.<a href="BaseCommand.cs.html#abdf0e782c7f04a8" class="i method">ShutDown</a>();
 
                <b>if</b> (<span class="r4 r">results</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>object</b> <span id="r5 rd" class="r5 r">o</span> <b>in</b> <span class="r4 r">results</span>)
                    {
                        <a href="#93211642b5464bf5" class="i method">ProcessObject</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r5 r">o</span>));
                    }
                }
            }
 
            <b>if</b> (<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#395f9b67268aec0e" class="i property">LineOutput</a>.<a href="ILineOutput.cs.html#70dcb6840034d68c" class="i property">RequiresBuffering</a>)
            {
                <span class="c">// we need to notify the interface implementor that</span>
                <span class="c">// we are about to do the playback</span>
                <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a>.<a href="ILineOutput.cs.html#9f7e9045951eb39a" class="t t">DoPlayBackCall</a> <span id="r6 rd" class="r6 r">playBackCall</span> = <b>new</b> <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a>.<span class="t">DoPlayBackCall</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#e215cbd7f988e557" class="i method">DrainCache</a>);
 
                <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#395f9b67268aec0e" class="i property">LineOutput</a>.<a href="ILineOutput.cs.html#0edf42379d2dd089" class="i method">ExecuteBufferPlayBack</a>(<span class="r6 r">playBackCall</span>);
            }
            <b>else</b>
            {
                <span class="c">// we drain the cache ourselves</span>
                <a href="#e215cbd7f988e557" class="i method">DrainCache</a>();
            }
        }
 
        <b>private void</b> <a id="e215cbd7f988e557" href="../../R/e215cbd7f988e557.html" target="n" data-glyph="76,1" class="i method">DrainCache</a>()
        {
            <b>if</b> (<a href="#b8c99270dbdc34ee" class="i field">_cache</a> != <b>null</b>)
            {
                <span class="c">// drain the cache, since we are shutting down</span>
                <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>&gt; <span id="r7 rd" class="r7 r">unprocessedObjects</span> = <a href="#b8c99270dbdc34ee" class="i field">_cache</a>.<a href="OutputQueue.cs.html#59cfa4007b1e7c56" class="i method">Drain</a>();
 
                <b>if</b> (<span class="r7 r">unprocessedObjects</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>object</b> <span id="r8 rd" class="r8 r">obj</span> <b>in</b> <span class="r7 r">unprocessedObjects</span>)
                    {
                        <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#cae66f6e6f16e88a" class="i method">Process</a>(<span class="r8 r">obj</span>);
                    }
                }
            }
        }
 
        <b>private bool</b> <a id="93211642b5464bf5" href="../../R/93211642b5464bf5.html" target="n" data-glyph="76,1" class="i method">ProcessObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r9 rd" class="r9 r">so</span>)
        {
            <b>object</b> <span id="r10 rd" class="r10 r">o</span> = <a href="#2f43ce88b1e5c539" class="i field">_formatObjectDeserializer</a>.<a href="FormattingObjectsDeserializer.cs.html#ec20518b08204ba4" class="i method">Deserialize</a>(<span class="r9 r">so</span>);
 
            <span class="c">// Console.WriteLine(&quot;OutCommandInner.Execute() retrieved object {0}, of type {1}&quot;, o.ToString(), o.GetType());</span>
            <b>if</b> (<a href="#66181a4652ac9f8f" class="i method">NeedsPreprocessing</a>(<span class="r10 r">o</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// instantiate the cache if not done yet</span>
            <b>if</b> (<a href="#b8c99270dbdc34ee" class="i field">_cache</a> == <b>null</b>)
            {
                <a href="#b8c99270dbdc34ee" class="i field">_cache</a> = <b>new</b> <a href="OutputQueue.cs.html#58dc8fa82cedfb85" class="t constructor">FormattedObjectsCache</a>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#395f9b67268aec0e" class="i property">LineOutput</a>.<a href="ILineOutput.cs.html#70dcb6840034d68c" class="i property">RequiresBuffering</a>);
            }
 
            <span class="c">// no need for formatting, just process the object</span>
            <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r11 rd" class="r11 r">formatStart</span> = <span class="r10 r">o</span> <b>as</b> <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a>;
 
            <b>if</b> (<span class="r11 r">formatStart</span> != <b>null</b>)
            {
                <span class="c">// get autosize flag from object</span>
                <span class="c">// turn on group caching</span>
                <b>if</b> (<span class="r11 r">formatStart</span>.<a href="FormattingObjects.cs.html#065f6dd45eb3f7ff" class="i field">autosizeInfo</a> != <b>null</b>)
                {
                    <a href="OutputQueue.cs.html#d9e324a65c0ee1b7" class="t t">FormattedObjectsCache</a>.<a href="OutputQueue.cs.html#2f3138276d6167c7" class="t t">ProcessCachedGroupNotification</a> <span id="r12 rd" class="r12 r">callBack</span> = <b>new</b> <a href="OutputQueue.cs.html#d9e324a65c0ee1b7" class="t t">FormattedObjectsCache</a>.<span class="t">ProcessCachedGroupNotification</span>(<a href="#5adadca148c84fd2" class="i method">ProcessCachedGroup</a>);
                    <a href="#b8c99270dbdc34ee" class="i field">_cache</a>.<a href="OutputQueue.cs.html#63ebad5cb88463e5" class="i method">EnableGroupCaching</a>(<span class="r12 r">callBack</span>, <span class="r11 r">formatStart</span>.<a href="FormattingObjects.cs.html#065f6dd45eb3f7ff" class="i field">autosizeInfo</a>.<a href="FormattingObjects.cs.html#cba98de5f6b53b54" class="i field">objectCount</a>);
                }
                <b>else</b>
                {
                    <span class="c">// If the format info doesn&#39;t define column widths, then auto-size based on the first ten elements</span>
                    <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a> <span id="r13 rd" class="r13 r">headerInfo</span> = <span class="r11 r">formatStart</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>as</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a>;
                    <b>if</b> ((<span class="r13 r">headerInfo</span> != <b>null</b>) &amp;&amp;
                        (<span class="r13 r">headerInfo</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span> &gt; 0) &amp;&amp;
                        (<span class="r13 r">headerInfo</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>[0].<span class="i">width</span> == 0))
                    {
                        <a href="OutputQueue.cs.html#d9e324a65c0ee1b7" class="t t">FormattedObjectsCache</a>.<a href="OutputQueue.cs.html#2f3138276d6167c7" class="t t">ProcessCachedGroupNotification</a> <span id="r14 rd" class="r14 r">callBack</span> = <b>new</b> <a href="OutputQueue.cs.html#d9e324a65c0ee1b7" class="t t">FormattedObjectsCache</a>.<span class="t">ProcessCachedGroupNotification</span>(<a href="#5adadca148c84fd2" class="i method">ProcessCachedGroup</a>);
                        <a href="#b8c99270dbdc34ee" class="i field">_cache</a>.<span class="i">EnableGroupCaching</span>(<span class="r14 r">callBack</span>, <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(300));
                    }
                }
            }
 
            <span class="c">// Console.WriteLine(&quot;OutCommandInner.Execute() calling ctxManager.Process({0})&quot;,o.ToString());</span>
            <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>&gt; <span id="r15 rd" class="r15 r">info</span> = <a href="#b8c99270dbdc34ee" class="i field">_cache</a>.<a href="OutputQueue.cs.html#4ae98e2ab9f6596b" class="i method">Add</a>((<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>)<span class="r10 r">o</span>);
 
            <b>if</b> (<span class="r15 r">info</span> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r16 rd" class="r16 r">k</span> = 0; <span class="r16 r">k</span> &lt; <span class="r15 r">info</span>.<span class="i">Count</span>; <span class="r16 r">k</span>++)
                    <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<span class="i">Process</span>(<span class="r15 r">info</span>[<span class="r16 r">k</span>]);
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper to return what shape we have to use to format the output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <a id="5b7469b4efe46cca" href="../../R/5b7469b4efe46cca.html" target="n" data-glyph="106,1" class="i property">ActiveFormattingShape</a>
        {
            <b>get</b>
            {
                <span class="c">// we assume that the format context</span>
                <span class="c">// contains the information</span>
                <b>const</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <span id="r17 rd" class="r17 r">shape</span> = <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#37eebd0cc455d8f9" class="i field">Table</a>; <span class="c">// default</span>
                <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <span id="r18 rd" class="r18 r">foc</span> = <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#efa81fb33d3c7bdd" class="i property">FormatContext</a>;
 
                <b>if</b> (<span class="r18 r">foc</span> == <b>null</b> || <span class="r18 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> == <b>null</b>)
                    <b>return</b> <span class="r17 r">shape</span>;
 
                <b>if</b> (<span class="r18 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a>)
                    <b>return</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#37eebd0cc455d8f9" class="i field">Table</a>;
 
                <b>if</b> (<span class="r18 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="FormattingObjects.cs.html#45d61e3bb0461a3a" class="t t">ListViewHeaderInfo</a>)
                    <b>return</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#2b03b9d9f0f6e343" class="i field">List</a>;
 
                <b>if</b> (<span class="r18 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a>)
                    <b>return</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#1895b57cea68b6b9" class="i field">Wide</a>;
 
                <b>if</b> (<span class="r18 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="FormattingObjects.cs.html#7f36f548ccbb71e3" class="t t">ComplexViewHeaderInfo</a>)
                    <b>return</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#136f83366cb298b8" class="i field">Complex</a>;
 
                <b>return</b> <span class="r17 r">shape</span>;
            }
        }
 
        <b>protected override void</b> <a id="80d35e63f2020da6" href="../../R/80d35e63f2020da6.html" target="n" data-glyph="75,1" class="i method">InternalDispose</a>()
        {
            <a href="BaseCommand.cs.html#c91a68f3aa4854f8" class="k">base</a>.<a href="BaseCommand.cs.html#b1d3f5a2bdd34bfe" class="i method">InternalDispose</a>();
            <b>if</b> (<a href="#946878c78752fd47" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#946878c78752fd47" class="i field">_command</a>.<a href="BaseCommand.cs.html#6609c3a8c47b823c" class="i method">Dispose</a>();
                <a href="#946878c78752fd47" class="i field">_command</a> = <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enum describing the state for the output finite state machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private enum</b> <a id="f33314a49cfe0553" href="../../R/f33314a49cfe0553.html" target="n" data-glyph="22,1" class="t t"><span id="9199c954b3b1ae1f">FormattingState</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> We are in the clear state: no formatting in process.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="826e02274dae67a2" href="../../R/826e02274dae67a2.html" target="n" data-glyph="24,2" class="i field">Reset</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> We received a Format Start message, but we are not inside a group.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="fb8ce84920c1532a" href="../../R/fb8ce84920c1532a.html" target="n" data-glyph="24,2" class="i field">Formatting</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> We are inside a group because we received a Group Start.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="1bf27c9945479431" href="../../R/1bf27c9945479431.html" target="n" data-glyph="24,2" class="i field">InsideGroup</a>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Toggle to signal if we are in a formatting sequence.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#f33314a49cfe0553" class="t t">FormattingState</a> <a id="becc170164462440" href="../../R/becc170164462440.html" target="n" data-glyph="46,1" class="i field">_currentFormattingState</a> = <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#826e02274dae67a2" class="i field">Reset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instance of a command wrapper to execute the</span>
        <span class="c">///</span><span class="c"> default formatter when needed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="BaseCommand.cs.html#c5695f10b2ea210f" class="t t">CommandWrapper</a> <a id="946878c78752fd47" href="../../R/946878c78752fd47.html" target="n" data-glyph="46,1" class="i field">_command</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumeration to drive the preprocessing stage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private enum</b> <a id="84f3d28605891ea3" href="../../R/../../0000000000.html" target="n" data-glyph="22,1" class="t t"><span id="673c4ec47490737e">PreprocessingState</span></a> { <a id="595d6776b68997f9" href="../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">raw</a>, <a id="8de49fc8bd064514" href="../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">processed</a>, <a id="57d75b951fc89a68" href="../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">error</a> }
 
        <b>private const int</b> <a id="7acea46653e96055" href="../../R/7acea46653e96055.html" target="n" data-glyph="10,1" class="i field">DefaultConsoleWidth</a> = 120;
        <b>private const int</b> <a id="8a16d233017f8949" href="../../R/8a16d233017f8949.html" target="n" data-glyph="10,1" class="i field">DefaultConsoleHeight</a> = <b>int</b>.<span class="i">MaxValue</span>;
        <b>internal const int</b> <a id="cc49a35b69390030" href="../../R/cc49a35b69390030.html" target="n" data-glyph="8,1" class="i field">StackAllocThreshold</a> = 120;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Test if an object coming from the pipeline needs to be</span>
        <span class="c">///</span><span class="c"> preprocessed by the default formatter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to examine for formatting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Whether the object needs to be shunted to preprocessing.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="66181a4652ac9f8f" href="../../R/66181a4652ac9f8f.html" target="n" data-glyph="76,1" class="i method">NeedsPreprocessing</a>(<b>object</b> <span id="r19 rd" class="r19 r">o</span>)
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r20 rd" class="r20 r">fed</span> = <span class="r19 r">o</span> <b>as</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a>;
            <b>if</b> (<span class="r20 r">fed</span> != <b>null</b>)
            {
                <span class="c">// we got an already pre-processed object</span>
                <b>if</b> (!<span class="r20 r">fed</span>.<a href="FormattingObjects.cs.html#59a0e653a3524695" class="i field">outOfBand</a>)
                {
                    <span class="c">// we allow out of band data in any state</span>
                    <a href="#80c3a40b818ddb59" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#1bf27c9945479431" class="i field">InsideGroup</a>, <span class="r19 r">o</span>);
                }
 
                <b>return</b> <b>false</b>;
            }
            <b>else</b> <b>if</b> (<span class="r19 r">o</span> <b>is</b> <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a>)
            {
                <span class="c">// when encountering FormatStartDate out of sequence,</span>
                <span class="c">// pretend that the previous formatting directives were properly closed</span>
                <b>if</b> (<a href="#becc170164462440" class="i field">_currentFormattingState</a> == <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#1bf27c9945479431" class="i field">InsideGroup</a>)
                {
                    <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#2464d9d0e5806eec" class="i method">EndProcessing</a>();
                    <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#1de4c6c1cfad3a2b" class="i method">BeginProcessing</a>();
                }
 
                <span class="c">// we got a Fs message, we enter a sequence</span>
                <a href="#80c3a40b818ddb59" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#826e02274dae67a2" class="i field">Reset</a>, <span class="r19 r">o</span>);
                <a href="#becc170164462440" class="i field">_currentFormattingState</a> = <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#fb8ce84920c1532a" class="i field">Formatting</a>;
 
                <b>return</b> <b>false</b>;
            }
            <b>else</b> <b>if</b> (<span class="r19 r">o</span> <b>is</b> <a href="FormattingObjects.cs.html#66dc8d81a6ebddc3" class="t t">FormatEndData</a>)
            {
                <span class="c">// we got a Fe message, we exit a sequence</span>
                <a href="#80c3a40b818ddb59" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#fb8ce84920c1532a" class="i field">Formatting</a>, <span class="r19 r">o</span>);
                <a href="#becc170164462440" class="i field">_currentFormattingState</a> = <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#826e02274dae67a2" class="i field">Reset</a>;
 
                <b>return</b> <b>false</b>;
            }
            <b>else</b> <b>if</b> (<span class="r19 r">o</span> <b>is</b> <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a>)
            {
                <a href="#80c3a40b818ddb59" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#fb8ce84920c1532a" class="i field">Formatting</a>, <span class="r19 r">o</span>);
                <a href="#becc170164462440" class="i field">_currentFormattingState</a> = <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#1bf27c9945479431" class="i field">InsideGroup</a>;
 
                <b>return</b> <b>false</b>;
            }
            <b>else</b> <b>if</b> (<span class="r19 r">o</span> <b>is</b> <a href="FormattingObjects.cs.html#13ca7c3ddab84ebb" class="t t">GroupEndData</a>)
            {
                <a href="#80c3a40b818ddb59" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#1bf27c9945479431" class="i field">InsideGroup</a>, <span class="r19 r">o</span>);
                <a href="#becc170164462440" class="i field">_currentFormattingState</a> = <a href="#f33314a49cfe0553" class="t t">FormattingState</a>.<a href="#fb8ce84920c1532a" class="i field">Formatting</a>;
 
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// this is a raw object</span>
            <b>return</b> <b>true</b>;
        }
 
        <b>private void</b> <a id="80c3a40b818ddb59" href="../../R/80c3a40b818ddb59.html" target="n" data-glyph="76,1" class="i method">ValidateCurrentFormattingState</a>(<a href="#f33314a49cfe0553" class="t t">FormattingState</a> <span id="r21 rd" class="r21 r">expectedFormattingState</span>, <b>object</b> <span id="r22 rd" class="r22 r">obj</span>)
        {
            <span class="c">// check if we are in the expected formatting state</span>
            <b>if</b> (<a href="#becc170164462440" class="i field">_currentFormattingState</a> != <span class="r21 r">expectedFormattingState</span>)
            {
                <span class="c">// we are not in the expected state, some message is out of sequence,</span>
                <span class="c">// need to abort the command</span>
 
                <b>string</b> <span id="r23 rd" class="r23 r">violatingCommand</span> = <span class="s">&quot;format-*&quot;</span>;
                <a href="../../P/1758f1866f7dadf6.html#1758f1866f7dadf6" class="t t">StartData</a> <span id="r24 rd" class="r24 r">sdObj</span> = <span class="r22 r">obj</span> <b>as</b> <a href="../../P/1758f1866f7dadf6.html#1758f1866f7dadf6" class="t t">StartData</a>;
                <b>if</b> (<span class="r24 r">sdObj</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r24 r">sdObj</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a>)
                    {
                        <span class="r23 r">violatingCommand</span> = <span class="s">&quot;format-wide&quot;</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r24 r">sdObj</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a>)
                    {
                        <span class="r23 r">violatingCommand</span> = <span class="s">&quot;format-table&quot;</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r24 r">sdObj</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="FormattingObjects.cs.html#45d61e3bb0461a3a" class="t t">ListViewHeaderInfo</a>)
                    {
                        <span class="r23 r">violatingCommand</span> = <span class="s">&quot;format-list&quot;</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r24 r">sdObj</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="FormattingObjects.cs.html#7f36f548ccbb71e3" class="t t">ComplexViewHeaderInfo</a>)
                    {
                        <span class="r23 r">violatingCommand</span> = <span class="s">&quot;format-complex&quot;</span>;
                    }
                }
 
                <b>string</b> <span id="r25 rd" class="r25 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_out_xxx</span>.<span class="i">OutLineOutput_OutOfSequencePacket</span>,
                    <span class="r22 r">obj</span>.<span class="i">GetType</span>().<span class="i">FullName</span>, <span class="r23 r">violatingCommand</span>);
 
                <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r26 rd" class="r26 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(
                                                <b>new</b> <span class="i">InvalidOperationException</span>(),
                                                <span class="s">&quot;ConsoleLineOutputOutOfSequencePacket&quot;</span>,
                                                <a href="../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../engine/ErrorPackage.cs.html#c855a7c43559f12f" class="i field">InvalidData</a>,
                                                <b>null</b>);
 
                <span class="r26 r">errorRecord</span>.<a href="../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r25 r">msg</span>);
                <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>.<a href="BaseCommand.cs.html#293390b36cb4485f" class="i method">ThrowTerminatingError</a>(<span class="r26 r">errorRecord</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shunt object to the formatting pipeline for preprocessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to be preprocessed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of objects returned by the preprocessing step.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Array</span> <a id="39f10ba87e3f5194" href="../../R/39f10ba87e3f5194.html" target="n" data-glyph="76,1" class="i method">ApplyFormatting</a>(<b>object</b> <span id="r27 rd" class="r27 r">o</span>)
        {
            <b>if</b> (<a href="#946878c78752fd47" class="i field">_command</a> == <b>null</b>)
            {
                <a href="#946878c78752fd47" class="i field">_command</a> = <b>new</b> <span class="t">CommandWrapper</span>();
                <a href="#946878c78752fd47" class="i field">_command</a>.<span class="i">Initialize</span>(<a href="#82ff02ddef6485d3" class="k">this</a>.<a href="BaseCommand.cs.html#810407458232faa8" class="i method">OuterCmdlet</a>().<a href="../../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>, <span class="s">&quot;format-default&quot;</span>, <b>typeof</b>(<a href="../format-default/format-default.cs.html#ca2f64f1f70e29ba" class="t t">FormatDefaultCommand</a>));
            }
 
            <b>return</b> <a href="#946878c78752fd47" class="i field">_command</a>.<a href="BaseCommand.cs.html#db41fa224416459e" class="i method">Process</a>(<span class="r27 r">o</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class factory for output context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">formatInfoData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Fromat info data received from the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <a id="84341f16eeaa4cb8" href="../../R/84341f16eeaa4cb8.html" target="n" data-glyph="76,1" class="i method">CreateOutputContext</a>(
                                        <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r28 rd" class="r28 r">parentContext</span>,
                                        <a href="../../P/3e4c5eb82116c3fb.html#3e4c5eb82116c3fb" class="t t">FormatInfoData</a> <span id="r29 rd" class="r29 r">formatInfoData</span>)
        {
            <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r30 rd" class="r30 r">formatStartData</span> = <span class="r29 r">formatInfoData</span> <b>as</b> <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a>;
            <span class="c">// initialize the format context</span>
            <b>if</b> (<span class="r30 r">formatStartData</span> != <b>null</b>)
            {
                <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <span id="r31 rd" class="r31 r">foc</span> = <b>new</b> <a href="#cf9212425070a49b" class="t constructor">FormatOutputContext</a>(<span class="r28 r">parentContext</span>, <span class="r30 r">formatStartData</span>);
 
                <b>return</b> <span class="r31 r">foc</span>;
            }
 
            <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r32 rd" class="r32 r">gsd</span> = <span class="r29 r">formatInfoData</span> <b>as</b> <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a>;
            <span class="c">// we are starting a group, initialize the group context</span>
            <b>if</b> (<span class="r32 r">gsd</span> != <b>null</b>)
            {
                <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a> <span id="r33 rd" class="r33 r">goc</span> = <b>null</b>;
 
                <b>switch</b> (<a href="#5b7469b4efe46cca" class="i property">ActiveFormattingShape</a>)
                {
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#37eebd0cc455d8f9" class="i field">Table</a>:
                        {
                            <span class="r33 r">goc</span> = <b>new</b> <a href="#00ac489a531ad555" class="t constructor">TableOutputContext</a>(<a href="#82ff02ddef6485d3" class="k">this</a>, <span class="r28 r">parentContext</span>, <span class="r32 r">gsd</span>);
                            <b>break</b>;
                        }
 
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#2b03b9d9f0f6e343" class="i field">List</a>:
                        {
                            <span class="r33 r">goc</span> = <b>new</b> <a href="#1aa6259993f3fdb7" class="t constructor">ListOutputContext</a>(<a href="#82ff02ddef6485d3" class="k">this</a>, <span class="r28 r">parentContext</span>, <span class="r32 r">gsd</span>);
                            <b>break</b>;
                        }
 
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#1895b57cea68b6b9" class="i field">Wide</a>:
                        {
                            <span class="r33 r">goc</span> = <b>new</b> <a href="#20ca27e26270bd98" class="t constructor">WideOutputContext</a>(<a href="#82ff02ddef6485d3" class="k">this</a>, <span class="r28 r">parentContext</span>, <span class="r32 r">gsd</span>);
                            <b>break</b>;
                        }
 
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#136f83366cb298b8" class="i field">Complex</a>:
                        {
                            <span class="r33 r">goc</span> = <b>new</b> <a href="#b5c18c3fc108e1b3" class="t constructor">ComplexOutputContext</a>(<a href="#82ff02ddef6485d3" class="k">this</a>, <span class="r28 r">parentContext</span>, <span class="r32 r">gsd</span>);
                            <b>break</b>;
                        }
 
                    <b>default</b>:
                        {
                            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid shape. This should never happen&quot;</span>);
                        }
 
                        <b>break</b>;
                }
 
                <span class="r33 r">goc</span>.<a href="#c2dfbfc8b1377db4" class="i method">Initialize</a>();
                <b>return</b> <span class="r33 r">goc</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for Fs processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The context containing the Fs entry.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b0261b14fb29401e" href="../../R/b0261b14fb29401e.html" target="n" data-glyph="76,1" class="i method">ProcessFormatStart</a>(<a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r34 rd" class="r34 r">c</span>)
        {
            <span class="c">// we just add an empty line to the display</span>
            <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#395f9b67268aec0e" class="i property">LineOutput</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for Fe processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">fe</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Fe notification message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current context, with Fs in it.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="d14b67dd05c30a2b" href="../../R/d14b67dd05c30a2b.html" target="n" data-glyph="76,1" class="i method">ProcessFormatEnd</a>(<a href="FormattingObjects.cs.html#66dc8d81a6ebddc3" class="t t">FormatEndData</a> <span id="r35 rd" class="r35 r">fe</span>, <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r36 rd" class="r36 r">c</span>)
        {
            <span class="c">// Console.WriteLine(&quot;ProcessFormatEnd&quot;);</span>
            <span class="c">// we just add an empty line to the display</span>
            <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#395f9b67268aec0e" class="i property">LineOutput</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for Gs processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The context containing the Gs entry.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8457c34b3e9746cd" href="../../R/8457c34b3e9746cd.html" target="n" data-glyph="76,1" class="i method">ProcessGroupStart</a>(<a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r37 rd" class="r37 r">c</span>)
        {
            <span class="c">// Console.WriteLine(&quot;ProcessGroupStart&quot;);</span>
            <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a> <span id="r38 rd" class="r38 r">goc</span> = (<a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>)<span class="r37 r">c</span>;
 
            <b>if</b> (<span class="r38 r">goc</span>.<a href="#deb5b90c42a28331" class="i property">Data</a>.<a href="FormattingObjects.cs.html#1812765ac10b536b" class="i field">groupingEntry</a> != <b>null</b>)
            {
                <a href="ComplexWriter.cs.html#dde06a7912f5417c" class="t t">ComplexWriter</a> <span id="r39 rd" class="r39 r">writer</span> = <b>new</b> <span class="t">ComplexWriter</span>();
                <span class="r39 r">writer</span>.<a href="ComplexWriter.cs.html#5e5a6185d20a34fb" class="i method">Initialize</a>(<a href="#d0b349da12c3b254" class="i field">_lo</a>, <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>);
                <span class="r39 r">writer</span>.<a href="ComplexWriter.cs.html#6c3ead2b5662ffe5" class="i method">WriteObject</a>(<span class="r38 r">goc</span>.<a href="#deb5b90c42a28331" class="i property">Data</a>.<a href="FormattingObjects.cs.html#1812765ac10b536b" class="i field">groupingEntry</a>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>);
                <a href="#d0b349da12c3b254" class="i field">_lo</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
            }
 
            <span class="r38 r">goc</span>.<a href="#fbf761c791c0f369" class="i method">GroupStart</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for Ge processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">ge</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Ge notification message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current context, with Gs in it.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a14f6aa2f32eb05f" href="../../R/a14f6aa2f32eb05f.html" target="n" data-glyph="76,1" class="i method">ProcessGroupEnd</a>(<a href="FormattingObjects.cs.html#13ca7c3ddab84ebb" class="t t">GroupEndData</a> <span id="r40 rd" class="r40 r">ge</span>, <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r41 rd" class="r41 r">c</span>)
        {
            <span class="c">// Console.WriteLine(&quot;ProcessGroupEnd&quot;);</span>
            <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a> <span id="r42 rd" class="r42 r">goc</span> = (<a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>)<span class="r41 r">c</span>;
 
            <span class="r42 r">goc</span>.<a href="#17e7fc8d1af4cea5" class="i method">GroupEnd</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the current payload object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Currently active context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="cbbcb3dffbc18fe4" href="../../R/cbbcb3dffbc18fe4.html" target="n" data-glyph="76,1" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r43 rd" class="r43 r">fed</span>, <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r44 rd" class="r44 r">c</span>)
        {
            <span class="c">// we assume FormatEntryData as a standard wrapper</span>
            <b>if</b> (<span class="r43 r">fed</span> == <b>null</b>)
            {
                <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r43 r">fed</span>));
            }
 
            <b>if</b> (<span class="r43 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> == <b>null</b>)
            {
                <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;fed.formatEntryInfo&quot;</span>);
            }
 
            <a href="../../engine/MshObject.cs.html#03e0630da31ec3a9" class="t t">WriteStreamType</a> <span id="r45 rd" class="r45 r">oldWSState</span> = <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#6d6f4ce7ecf426c3" class="i property">WriteStream</a>;
            <b>try</b>
            {
                <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#6d6f4ce7ecf426c3" class="i property">WriteStream</a> = <span class="r43 r">fed</span>.<a href="FormattingObjects.cs.html#778494cb50302a19" class="i field">writeStream</a>;
 
                <b>if</b> (<span class="r44 r">c</span> == <b>null</b>)
                {
                    <a href="#d3bc45902d6ec637" class="i method">ProcessOutOfBandPayload</a>(<span class="r43 r">fed</span>);
                }
                <b>else</b>
                {
                    <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a> <span id="r46 rd" class="r46 r">goc</span> = (<a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>)<span class="r44 r">c</span>;
 
                    <span class="r46 r">goc</span>.<a href="#9dd3360ec2b9f65c" class="i method">ProcessPayload</a>(<span class="r43 r">fed</span>);
                }
            }
            <b>finally</b>
            {
                <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#6d6f4ce7ecf426c3" class="i property">WriteStream</a> = <span class="r45 r">oldWSState</span>;
            }
        }
 
        <b>private void</b> <a id="d3bc45902d6ec637" href="../../R/d3bc45902d6ec637.html" target="n" data-glyph="76,1" class="i method">ProcessOutOfBandPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r47 rd" class="r47 r">fed</span>)
        {
            <span class="c">// try if it is raw text</span>
            <a href="../../P/a62f9103f62f1601.html#a62f9103f62f1601" class="t t">RawTextFormatEntry</a> <span id="r48 rd" class="r48 r">rte</span> = <span class="r47 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/a62f9103f62f1601.html#a62f9103f62f1601" class="t t">RawTextFormatEntry</a>;
            <b>if</b> (<span class="r48 r">rte</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r47 r">fed</span>.<a href="FormattingObjects.cs.html#306aa78f9710b993" class="i field">isHelpObject</a>)
                {
                    <a href="ComplexWriter.cs.html#dde06a7912f5417c" class="t t">ComplexWriter</a> <span id="r49 rd" class="r49 r">complexWriter</span> = <b>new</b> <span class="t">ComplexWriter</span>();
 
                    <span class="r49 r">complexWriter</span>.<a href="ComplexWriter.cs.html#5e5a6185d20a34fb" class="i method">Initialize</a>(<a href="#d0b349da12c3b254" class="i field">_lo</a>, <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>);
                    <span class="r49 r">complexWriter</span>.<a href="ComplexWriter.cs.html#93cf2050ed478438" class="i method">WriteString</a>(<span class="r48 r">rte</span>.<a href="FormattingObjects.cs.html#4a19b20fca76aab8" class="i field">text</a>);
                }
                <b>else</b>
                {
                    <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#fd3191b17b478f7f" class="i method">WriteLine</a>(<span class="r48 r">rte</span>.<a href="FormattingObjects.cs.html#4a19b20fca76aab8" class="i field">text</a>);
                }
 
                <b>return</b>;
            }
 
            <span class="c">// try if it is a complex entry</span>
            <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r50 rd" class="r50 r">cve</span> = <span class="r47 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a>;
            <b>if</b> (<span class="r50 r">cve</span> != <b>null</b> &amp;&amp; <span class="r50 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a> != <b>null</b>)
            {
                <a href="ComplexWriter.cs.html#dde06a7912f5417c" class="t t">ComplexWriter</a> <span id="r51 rd" class="r51 r">complexWriter</span> = <b>new</b> <span class="t">ComplexWriter</span>();
 
                <span class="r51 r">complexWriter</span>.<span class="i">Initialize</span>(<a href="#d0b349da12c3b254" class="i field">_lo</a>, <b>int</b>.<span class="i">MaxValue</span>);
                <span class="r51 r">complexWriter</span>.<a href="ComplexWriter.cs.html#6c3ead2b5662ffe5" class="i method">WriteObject</a>(<span class="r50 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>);
 
                <b>return</b>;
            }
            <span class="c">// try if it is a list view</span>
            <a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a> <span id="r52 rd" class="r52 r">lve</span> = <span class="r47 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a>;
            <b>if</b> (<span class="r52 r">lve</span> != <b>null</b> &amp;&amp; <span class="r52 r">lve</span>.<a href="FormattingObjects.cs.html#2ee07edd74ba8a57" class="i field">listViewFieldList</a> != <b>null</b>)
            {
                <a href="ListWriter.cs.html#ad29ebb165496bdd" class="t t">ListWriter</a> <span id="r53 rd" class="r53 r">listWriter</span> = <b>new</b> <span class="t">ListWriter</span>();
 
                <a href="#d0b349da12c3b254" class="i field">_lo</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
 
                <b>string</b>[] <span id="r54 rd" class="r54 r">properties</span> = <a href="#19b9a3099ef6280e" class="t t">ListOutputContext</a>.<a href="#2dda74892f152002" class="i method">GetProperties</a>(<span class="r52 r">lve</span>);
                <span class="r53 r">listWriter</span>.<a href="ListWriter.cs.html#d153226e55f3200e" class="i method">Initialize</a>(<span class="r54 r">properties</span>, <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>, <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>);
                <b>string</b>[] <span id="r55 rd" class="r55 r">values</span> = <a href="#19b9a3099ef6280e" class="t t">ListOutputContext</a>.<a href="#623a136daaf8356e" class="i method">GetValues</a>(<span class="r52 r">lve</span>);
                <span class="r53 r">listWriter</span>.<a href="ListWriter.cs.html#4f661ea66ff0c095" class="i method">WriteProperties</a>(<span class="r55 r">values</span>, <a href="#d0b349da12c3b254" class="i field">_lo</a>);
 
                <a href="#d0b349da12c3b254" class="i field">_lo</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
 
                <b>return</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The screen host associated with this outputter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a> <a id="d0b349da12c3b254" href="../../R/d0b349da12c3b254.html" target="n" data-glyph="46,1" class="i field">_lo</a> = <b>null</b>;
 
        <b>internal</b> <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a> <a id="395f9b67268aec0e" href="../../R/395f9b67268aec0e.html" target="n" data-glyph="104,1" class="i property">LineOutput</a>
        {
            <b>get</b> { <b>return</b> <a href="#d0b349da12c3b254" class="i field">_lo</a>; }
 
            <b>set</b> { <a href="#d0b349da12c3b254" class="i field">_lo</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="FormattingObjects.cs.html#e645f7b307e3b22d" class="t t">ShapeInfo</a> <a id="cbddd83bb130c4fc" href="../../R/cbddd83bb130c4fc.html" target="n" data-glyph="106,1" class="i property">ShapeInfoOnFormatContext</a>
        {
            <b>get</b>
            {
                <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <span id="r56 rd" class="r56 r">foc</span> = <a href="#82ff02ddef6485d3" class="k">this</a>.<a href="#efa81fb33d3c7bdd" class="i property">FormatContext</a>;
 
                <b>if</b> (<span class="r56 r">foc</span> == <b>null</b>)
                    <b>return</b> <b>null</b>;
 
                <b>return</b> <span class="r56 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieve the active FormatOutputContext on the stack</span>
        <span class="c">///</span><span class="c"> by walking up to the top of the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <a id="efa81fb33d3c7bdd" href="../../R/efa81fb33d3c7bdd.html" target="n" data-glyph="106,1" class="i property">FormatContext</a>
        {
            <b>get</b>
            {
                <b>for</b> (<a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r57 rd" class="r57 r">oc</span> = <a href="#f048e21f48d4a996" class="i field">_ctxManager</a>.<a href="FormatMsgCtxManager.cs.html#24323897931fde32" class="i property">ActiveOutputContext</a>; <span class="r57 r">oc</span> != <b>null</b>; <span class="r57 r">oc</span> = <span class="r57 r">oc</span>.<a href="FormatMsgCtxManager.cs.html#a9825d257e90c2c8" class="i property">ParentContext</a>)
                {
                    <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <span id="r58 rd" class="r58 r">foc</span> = <span class="r57 r">oc</span> <b>as</b> <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a>;
 
                    <b>if</b> (<span class="r58 r">foc</span> != <b>null</b>)
                        <b>return</b> <span class="r58 r">foc</span>;
                }
 
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Context manager instance to guide the message traversal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a> <a id="f048e21f48d4a996" href="../../R/f048e21f48d4a996.html" target="n" data-glyph="46,1" class="i field">_ctxManager</a> = <b>new</b> <span class="t">FormatMessagesContextManager</span>();
 
        <b>private</b> <a href="OutputQueue.cs.html#d9e324a65c0ee1b7" class="t t">FormattedObjectsCache</a> <a id="b8c99270dbdc34ee" href="../../R/b8c99270dbdc34ee.html" target="n" data-glyph="46,1" class="i field">_cache</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handler for processing the caching notification and responsible for</span>
        <span class="c">///</span><span class="c"> setting the value of the formatting hint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">formatStartData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">objects</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5adadca148c84fd2" href="../../R/5adadca148c84fd2.html" target="n" data-glyph="76,1" class="i method">ProcessCachedGroup</a>(<a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r59 rd" class="r59 r">formatStartData</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>&gt; <span id="r60 rd" class="r60 r">objects</span>)
        {
            <a href="#2a160ad8b1649174" class="i field">_formattingHint</a> = <b>null</b>;
 
            <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a> <span id="r61 rd" class="r61 r">thi</span> = <span class="r59 r">formatStartData</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>as</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a>;
 
            <b>if</b> (<span class="r61 r">thi</span> != <b>null</b>)
            {
                <a href="#863add846d710b2c" class="i method">ProcessCachedGroupOnTable</a>(<span class="r61 r">thi</span>, <span class="r60 r">objects</span>);
                <b>return</b>;
            }
 
            <a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a> <span id="r62 rd" class="r62 r">wvhi</span> = <span class="r59 r">formatStartData</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>as</b> <a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a>;
 
            <b>if</b> (<span class="r62 r">wvhi</span> != <b>null</b>)
            {
                <a href="#cb5f99049542dda4" class="i method">ProcessCachedGroupOnWide</a>(<span class="r62 r">wvhi</span>, <span class="r60 r">objects</span>);
                <b>return</b>;
            }
        }
 
        <b>private void</b> <a id="863add846d710b2c" href="../../R/863add846d710b2c.html" target="n" data-glyph="76,1" class="i method">ProcessCachedGroupOnTable</a>(<a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a> <span id="r63 rd" class="r63 r">thi</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>&gt; <span id="r64 rd" class="r64 r">objects</span>)
        {
            <b>if</b> (<span class="r63 r">thi</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span> == 0)
                <b>return</b>;
 
            <b>int</b>[] <span id="r65 rd" class="r65 r">widths</span> = <b>new</b> <b>int</b>[<span class="r63 r">thi</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span>];
 
            <b>for</b> (<b>int</b> <span id="r66 rd" class="r66 r">k</span> = 0; <span class="r66 r">k</span> &lt; <span class="r63 r">thi</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span>; <span class="r66 r">k</span>++)
            {
                <b>string</b> <span id="r67 rd" class="r67 r">label</span> = <span class="r63 r">thi</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>[<span class="r66 r">k</span>].<span class="i">label</span>;
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r67 r">label</span>))
                    <span class="r67 r">label</span> = <span class="r63 r">thi</span>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>[<span class="r66 r">k</span>].<span class="i">propertyName</span>;
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r67 r">label</span>))
                    <span class="r65 r">widths</span>[<span class="r66 r">k</span>] = 0;
                <b>else</b>
                    <span class="r65 r">widths</span>[<span class="r66 r">k</span>] = <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r67 r">label</span>);
            }
 
            <b>int</b> <span id="r68 rd" class="r68 r">cellCount</span>; <span class="c">// scratch variable</span>
            <b>foreach</b> (<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a> <span id="r69 rd" class="r69 r">o</span> <b>in</b> <span class="r64 r">objects</span>)
            {
                <b>if</b> (<span class="r69 r">o</span> <b>is</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r70 rd" class="r70 r">fed</span>)
                {
                    <a href="../../P/20532373052c8ea7.html#20532373052c8ea7" class="t t">TableRowEntry</a> <span id="r71 rd" class="r71 r">tre</span> = <span class="r70 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/20532373052c8ea7.html#20532373052c8ea7" class="t t">TableRowEntry</a>;
                    <b>int</b> <span id="r72 rd" class="r72 r">kk</span> = 0;
 
                    <b>foreach</b> (<a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r73 rd" class="r73 r">fpf</span> <b>in</b> <span class="r71 r">tre</span>.<a href="FormattingObjects.cs.html#20666ce23d542f89" class="i field">formatPropertyFieldList</a>)
                    {
                        <span class="r68 r">cellCount</span> = <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r73 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a>);
                        <b>if</b> (<span class="r65 r">widths</span>[<span class="r72 r">kk</span>] &lt; <span class="r68 r">cellCount</span>)
                            <span class="r65 r">widths</span>[<span class="r72 r">kk</span>] = <span class="r68 r">cellCount</span>;
 
                        <span class="r72 r">kk</span>++;
                    }
                }
            }
 
            <a href="#95538e75fe4ffeed" class="t t">TableFormattingHint</a> <span id="r74 rd" class="r74 r">hint</span> = <b>new</b> <span class="t">TableFormattingHint</span>();
 
            <span class="r74 r">hint</span>.<a href="#7d78b487274e38a7" class="i field">columnWidths</a> = <span class="r65 r">widths</span>;
            <a href="#2a160ad8b1649174" class="i field">_formattingHint</a> = <span class="r74 r">hint</span>;
        }
 
        <b>private void</b> <a id="cb5f99049542dda4" href="../../R/cb5f99049542dda4.html" target="n" data-glyph="76,1" class="i method">ProcessCachedGroupOnWide</a>(<a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a> <span id="r75 rd" class="r75 r">wvhi</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a>&gt; <span id="r76 rd" class="r76 r">objects</span>)
        {
            <b>if</b> (<span class="r75 r">wvhi</span>.<a href="FormattingObjects.cs.html#0a83aa25eadba343" class="i field">columns</a> != 0)
            {
                <span class="c">// columns forced on the client</span>
                <b>return</b>;
            }
 
            <b>int</b> <span id="r77 rd" class="r77 r">maxLen</span> = 0;
            <b>int</b> <span id="r78 rd" class="r78 r">cellCount</span>; <span class="c">// scratch variable</span>
 
            <b>foreach</b> (<a href="FormattingObjects.cs.html#31e92f7027c4f191" class="t t">PacketInfoData</a> <span id="r79 rd" class="r79 r">o</span> <b>in</b> <span class="r76 r">objects</span>)
            {
                <b>if</b> (<span class="r79 r">o</span> <b>is</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r80 rd" class="r80 r">fed</span>)
                {
                    <a href="../../P/06bff2ee63bb3209.html#06bff2ee63bb3209" class="t t">WideViewEntry</a> <span id="r81 rd" class="r81 r">wve</span> = <span class="r80 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/06bff2ee63bb3209.html#06bff2ee63bb3209" class="t t">WideViewEntry</a>;
                    <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r82 rd" class="r82 r">fpf</span> = <span class="r81 r">wve</span>.<a href="FormattingObjects.cs.html#03906afc1c6fa346" class="i field">formatPropertyField</a> <b>as</b> <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a>;
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r82 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a>))
                    {
                        <span class="r78 r">cellCount</span> = <a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r82 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a>);
                        <b>if</b> (<span class="r78 r">cellCount</span> &gt; <span class="r77 r">maxLen</span>)
                            <span class="r77 r">maxLen</span> = <span class="r78 r">cellCount</span>;
                    }
                }
            }
 
            <a href="#a3b10fe942c1357e" class="t t">WideFormattingHint</a> <span id="r83 rd" class="r83 r">hint</span> = <b>new</b> <span class="t">WideFormattingHint</span>();
 
            <span class="r83 r">hint</span>.<a href="#dbcea74b94984974" class="i field">maxWidth</a> = <span class="r77 r">maxLen</span>;
            <a href="#2a160ad8b1649174" class="i field">_formattingHint</a> = <span class="r83 r">hint</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tables and Wides need to use spaces for padding to maintain table look even if console window is resized.</span>
        <span class="c">///</span><span class="c"> For all other output, we use int.MaxValue if the user didn&#39;t explicitly specify a width.</span>
        <span class="c">///</span><span class="c"> If we detect that int.MaxValue is used, first we try to get the current console window width.</span>
        <span class="c">///</span><span class="c"> However, if we can&#39;t read that (for example, implicit remoting has no console window), we default</span>
        <span class="c">///</span><span class="c"> to something reasonable: 120 columns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="489598de9be5a188" href="../../R/489598de9be5a188.html" target="n" data-glyph="76,1" class="i method">GetConsoleWindowWidth</a>(<b>int</b> <span id="r84 rd" class="r84 r">columnNumber</span>)
        {
            <b>if</b> (<a href="../../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../../engine/Utils.cs.html#eceb430589b651ca" class="i field">SetConsoleWidthToZero</a>)
            {
                <b>return</b> <a href="#7acea46653e96055" class="i field">DefaultConsoleWidth</a>;
            }
 
            <b>if</b> (<span class="r84 r">columnNumber</span> == <b>int</b>.<span class="i">MaxValue</span>)
            {
                <b>try</b>
                {
                    <span class="c">// if Console width is set to 0, the default width is returned so that the output string is not null.</span>
                    <span class="c">// This can happen in environments where TERM is not set.</span>
                    <b>return</b> (<span class="i">Console</span>.<span class="i">WindowWidth</span> != 0) ? <span class="i">Console</span>.<span class="i">WindowWidth</span> : <a href="#7acea46653e96055" class="i field">DefaultConsoleWidth</a>;
                }
                <b>catch</b>
                {
                    <b>return</b> <a href="#7acea46653e96055" class="i field">DefaultConsoleWidth</a>;
                }
            }
 
            <b>return</b> <span class="r84 r">columnNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the console height.null  If not available (like when remoting), treat as Int.MaxValue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="44601cc170ca9ca1" href="../../R/44601cc170ca9ca1.html" target="n" data-glyph="76,1" class="i method">GetConsoleWindowHeight</a>(<b>int</b> <span id="r85 rd" class="r85 r">rowNumber</span>)
        {
            <b>if</b> (<a href="../../engine/Utils.cs.html#f365eaa75311eda0" class="t t">InternalTestHooks</a>.<a href="../../engine/Utils.cs.html#e6a1ce5eceaa5326" class="i field">SetConsoleHeightToZero</a>)
            {
                <b>return</b> <a href="#8a16d233017f8949" class="i field">DefaultConsoleHeight</a>;
            }
 
            <b>if</b> (<span class="r85 r">rowNumber</span> &lt;= 0)
            {
                <b>try</b>
                {
                    <span class="c">// if Console height is set to 0, the default height is returned.</span>
                    <span class="c">// This can happen in environments where TERM is not set.</span>
                    <b>return</b> (<span class="i">Console</span>.<span class="i">WindowHeight</span> &gt; 0) ? <span class="i">Console</span>.<span class="i">WindowHeight</span> : <a href="#8a16d233017f8949" class="i field">DefaultConsoleHeight</a>;
                }
                <b>catch</b>
                {
                    <b>return</b> <a href="#8a16d233017f8949" class="i field">DefaultConsoleHeight</a>;
                }
            }
 
            <b>return</b> <span class="r85 r">rowNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Base class for all the formatting hints.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private abstract class</b> <a id="105e0797d45529ba" href="../../R/105e0797d45529ba.html" target="n" data-glyph="4,1" class="t t"><span id="fd01e4d8e538dc3f">FormattingHint</span></a>
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hint for format-table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="95538e75fe4ffeed" href="../../R/95538e75fe4ffeed.html" target="n" data-glyph="4,1" class="t t"><span id="b7ab5f3abee576fb">TableFormattingHint</span></a> : <a href="#105e0797d45529ba" class="t t">FormattingHint</a>
        {
            <b>internal int</b>[] <a id="7d78b487274e38a7" href="../../R/7d78b487274e38a7.html" target="n" data-glyph="44,2" class="i field">columnWidths</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hint for format-wide.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="a3b10fe942c1357e" href="../../R/a3b10fe942c1357e.html" target="n" data-glyph="4,1" class="t t"><span id="073f9fb33713a227">WideFormattingHint</span></a> : <a href="#105e0797d45529ba" class="t t">FormattingHint</a>
        {
            <b>internal int</b> <a id="dbcea74b94984974" href="../../R/dbcea74b94984974.html" target="n" data-glyph="44,2" class="i field">maxWidth</a> = 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable holding the autosize hint (set by the caching code and reset by the hint consumer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#105e0797d45529ba" class="t t">FormattingHint</a> <a id="2a160ad8b1649174" href="../../R/2a160ad8b1649174.html" target="n" data-glyph="46,1" class="i field">_formattingHint</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for consuming the formatting hint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="#105e0797d45529ba" class="t t">FormattingHint</a> <a id="74374fc782a827c5" href="../../R/74374fc782a827c5.html" target="n" data-glyph="76,1" class="i method">RetrieveFormattingHint</a>()
        {
            <a href="#105e0797d45529ba" class="t t">FormattingHint</a> <span id="r86 rd" class="r86 r">fh</span> = <a href="#2a160ad8b1649174" class="i field">_formattingHint</a>;
            <a href="#2a160ad8b1649174" class="i field">_formattingHint</a> = <b>null</b>;
            <b>return</b> <span class="r86 r">fh</span>;
        }
 
        <b>private</b> <a href="FormattingObjectsDeserializer.cs.html#592ef20b2bc0f279" class="t t">FormatObjectDeserializer</a> <a id="2f43ce88b1e5c539" href="../../R/2f43ce88b1e5c539.html" target="n" data-glyph="46,1" class="i field">_formatObjectDeserializer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Context for the outer scope of the format sequence.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="e3092a15b1608e63" href="../../R/e3092a15b1608e63.html" target="n" data-glyph="4,1" class="t t">FormatOutputContext</a> : <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="cf9212425070a49b" href="../../R/cf9212425070a49b.html" target="n" data-glyph="74,2" class="t constructor">FormatOutputContext</a>(<a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r87 rd" class="r87 r">parentContext</span>, <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r88 rd" class="r88 r">formatData</span>)
                : <a href="FormatMsgCtxManager.cs.html#e7bb6a0f01de60f3" class="k">base</a>(<span class="r87 r">parentContext</span>)
            {
                <a href="#eefa7f68bd57fc7f" class="i property">Data</a> = <span class="r88 r">formatData</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Retrieve the format data in the context.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <a id="eefa7f68bd57fc7f" href="../../R/eefa7f68bd57fc7f.html" target="n" data-glyph="104,2" class="i property">Data</a> { <b>get</b>; } = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Context for the currently active group.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private abstract class</b> <a id="c03e72aeccf5acd3" href="../../R/c03e72aeccf5acd3.html" target="n" data-glyph="4,1" class="t t">GroupOutputContext</a> : <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a id="2f83ea617fa4a4b9" href="../../R/2f83ea617fa4a4b9.html" target="n" data-glyph="74,2" class="t constructor">GroupOutputContext</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r89 rd" class="r89 r">cmd</span>,
                                    <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r90 rd" class="r90 r">parentContext</span>,
                                    <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r91 rd" class="r91 r">formatData</span>)
                : <a href="FormatMsgCtxManager.cs.html#e7bb6a0f01de60f3" class="k">base</a>(<span class="r90 r">parentContext</span>)
            {
                <a href="#f0ae508c93e30545" class="i property">InnerCommand</a> = <span class="r89 r">cmd</span>;
                <a href="#deb5b90c42a28331" class="i property">Data</a> = <span class="r91 r">formatData</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Called at creation time, overrides will initialize here, e.g.</span>
            <span class="c">///</span><span class="c"> column widths, etc.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal virtual void</b> <a id="c2dfbfc8b1377db4" href="../../R/c2dfbfc8b1377db4.html" target="n" data-glyph="74,2" class="i method">Initialize</a>() { }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Called when a group of data is started, overridden will do</span>
            <span class="c">///</span><span class="c"> things such as headers, etc...</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal virtual void</b> <a id="fbf761c791c0f369" href="../../R/fbf761c791c0f369.html" target="n" data-glyph="74,2" class="i method">GroupStart</a>() { }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Called when the end of a group is reached, overrides will do</span>
            <span class="c">///</span><span class="c"> things such as group footers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal virtual void</b> <a id="17e7fc8d1af4cea5" href="../../R/17e7fc8d1af4cea5.html" target="n" data-glyph="74,2" class="i method">GroupEnd</a>() { }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Called when there is an entry to process, overrides will do</span>
            <span class="c">///</span><span class="c"> things such as writing a row in a table.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal virtual void</b> <a id="9dd3360ec2b9f65c" href="../../R/9dd3360ec2b9f65c.html" target="n" data-glyph="74,2" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r92 rd" class="r92 r">fed</span>) { }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Retrieve the format data in the context.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <a id="deb5b90c42a28331" href="../../R/deb5b90c42a28331.html" target="n" data-glyph="104,2" class="i property">Data</a> { <b>get</b>; } = <b>null</b>;
 
            <b>protected</b> <a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <a id="f0ae508c93e30545" href="../../R/f0ae508c93e30545.html" target="n" data-glyph="105,2" class="i property">InnerCommand</a> { <b>get</b>; }
        }
 
        <b>private class</b> <a id="202cd2852b3d97c6" href="../../R/202cd2852b3d97c6.html" target="n" data-glyph="4,1" class="t t">TableOutputContextBase</a> : <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">cmd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reference to the OutCommandInner instance who owns this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="905169f9074716d5" href="../../R/905169f9074716d5.html" target="n" data-glyph="74,2" class="t constructor">TableOutputContextBase</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r93 rd" class="r93 r">cmd</span>,
                <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r94 rd" class="r94 r">parentContext</span>,
                <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r95 rd" class="r95 r">formatData</span>)
                : <a href="#2f83ea617fa4a4b9" class="k">base</a>(<span class="r93 r">cmd</span>, <span class="r94 r">parentContext</span>, <span class="r95 r">formatData</span>)
            {
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the table writer for this context.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>protected</b> <a href="TableWriter.cs.html#719f009e44c059f3" class="t t">TableWriter</a> <a id="f2f8175d416645e0" href="../../R/f2f8175d416645e0.html" target="n" data-glyph="105,2" class="i property">Writer</a> { <b>get</b> { <b>return</b> <a href="#c8b69249b1daf43c" class="i field">_tableWriter</a>; } }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Helper class to properly write a table using text output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private readonly</b> <a href="TableWriter.cs.html#719f009e44c059f3" class="t t">TableWriter</a> <a id="c8b69249b1daf43c" href="../../R/c8b69249b1daf43c.html" target="n" data-glyph="46,2" class="i field">_tableWriter</a> = <b>new</b> <span class="t">TableWriter</span>();
        }
 
        <b>private sealed class</b> <a id="b2411ceaaaab85bb" href="../../R/b2411ceaaaab85bb.html" target="n" data-glyph="4,1" class="t t">TableOutputContext</a> : <a href="#202cd2852b3d97c6" class="t t">TableOutputContextBase</a>
        {
            <b>private int</b> <a id="e7ad236afbf18759" href="../../R/e7ad236afbf18759.html" target="n" data-glyph="46,2" class="i field">_rowCount</a> = 0;
            <b>private int</b> <a id="c12eee226bc301da" href="../../R/c12eee226bc301da.html" target="n" data-glyph="46,2" class="i field">_consoleHeight</a> = -1;
            <b>private int</b> <a id="96813d89c4a3bb97" href="../../R/96813d89c4a3bb97.html" target="n" data-glyph="46,2" class="i field">_consoleWidth</a> = -1;
 
            <b>private const int</b> <a id="2c283a9fcd372907" href="../../R/2c283a9fcd372907.html" target="n" data-glyph="10,2" class="i field">WhitespaceAndPagerLineCount</a> = 2;
 
            <b>private readonly bool</b> <a id="5a2cec4cbaa9c294" href="../../R/5a2cec4cbaa9c294.html" target="n" data-glyph="46,2" class="i field">_repeatHeader</a> = <b>false</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">cmd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reference to the OutCommandInner instance who owns this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="00ac489a531ad555" href="../../R/00ac489a531ad555.html" target="n" data-glyph="74,2" class="t constructor">TableOutputContext</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r96 rd" class="r96 r">cmd</span>,
                <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r97 rd" class="r97 r">parentContext</span>,
                <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r98 rd" class="r98 r">formatData</span>)
                : <a href="#905169f9074716d5" class="k">base</a>(<span class="r96 r">cmd</span>, <span class="r97 r">parentContext</span>, <span class="r98 r">formatData</span>)
            {
                <b>if</b> (<span class="r97 r">parentContext</span> <b>is</b> <a href="#e3092a15b1608e63" class="t t">FormatOutputContext</a> <span id="r99 rd" class="r99 r">foc</span>)
                {
                    <b>if</b> (<span class="r99 r">foc</span>.<a href="#eefa7f68bd57fc7f" class="i property">Data</a>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> <b>is</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a> <span id="r100 rd" class="r100 r">thi</span>)
                    {
                        <a href="#5a2cec4cbaa9c294" class="i field">_repeatHeader</a> = <span class="r100 r">thi</span>.<a href="FormattingObjects.cs.html#15c3af5c58a0773e" class="i field">repeatHeader</a>;
                    }
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initialize column widths.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="1b368fad6e7e9627" href="../../R/1b368fad6e7e9627.html" target="n" data-glyph="74,2" class="i method">Initialize</a>()
            {
                <a href="#95538e75fe4ffeed" class="t t">TableFormattingHint</a> <span id="r101 rd" class="r101 r">tableHint</span> = <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#74374fc782a827c5" class="i method">RetrieveFormattingHint</a>() <b>as</b> <a href="#95538e75fe4ffeed" class="t t">TableFormattingHint</a>;
                <b>int</b>[] <span id="r102 rd" class="r102 r">columnWidthsHint</span> = <b>null</b>;
                <span class="c">// We expect that console width is less then 120.</span>
 
                <b>if</b> (<span class="r101 r">tableHint</span> != <b>null</b>)
                {
                    <span class="r102 r">columnWidthsHint</span> = <span class="r101 r">tableHint</span>.<a href="#7d78b487274e38a7" class="i field">columnWidths</a>;
                }
 
                <a href="#c12eee226bc301da" class="i field">_consoleHeight</a> = <a href="#44601cc170ca9ca1" class="i method">GetConsoleWindowHeight</a>(<a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#39159c993fef4e35" class="i property">RowNumber</a>);
                <a href="#96813d89c4a3bb97" class="i field">_consoleWidth</a> = <a href="#489598de9be5a188" class="i method">GetConsoleWindowWidth</a>(<a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>);
 
                <b>int</b> <span id="r103 rd" class="r103 r">columns</span> = <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span>;
                <b>if</b> (<span class="r103 r">columns</span> == 0)
                {
                    <b>return</b>;
                }
 
                <span class="c">// create arrays for widths and alignment</span>
                <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r104 rd" class="r104 r">columnWidths</span> = <span class="r103 r">columns</span> &lt;= <a href="#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r103 r">columns</span>] : <b>new</b> <b>int</b>[<span class="r103 r">columns</span>];
                <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r105 rd" class="r105 r">alignment</span> = <span class="r103 r">columns</span> &lt;= <a href="#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r103 r">columns</span>] : <b>new</b> <b>int</b>[<span class="r103 r">columns</span>];
 
                <b>int</b> <span id="r106 rd" class="r106 r">k</span> = 0;
                <b>foreach</b> (<a href="../../P/e315917abb72a6d3.html#e315917abb72a6d3" class="t t">TableColumnInfo</a> <span id="r107 rd" class="r107 r">tci</span> <b>in</b> <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>)
                {
                    <span class="r104 r">columnWidths</span>[<span class="r106 r">k</span>] = (<span class="r102 r">columnWidthsHint</span> != <b>null</b>) ? <span class="r102 r">columnWidthsHint</span>[<span class="r106 r">k</span>] : <span class="r107 r">tci</span>.<a href="FormattingObjects.cs.html#d02b38345329f767" class="i field">width</a>;
                    <span class="r105 r">alignment</span>[<span class="r106 r">k</span>] = <span class="r107 r">tci</span>.<a href="FormattingObjects.cs.html#b5bc3990acaff052" class="i field">alignment</a>;
                    <span class="r106 r">k</span>++;
                }
 
                <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<span class="i">Initialize</span>(0, <a href="#96813d89c4a3bb97" class="i field">_consoleWidth</a>, <span class="r104 r">columnWidths</span>, <span class="r105 r">alignment</span>, <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#f025bd3adb94b2dc" class="i field">hideHeader</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write the headers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="c42d23517917eb49" href="../../R/c42d23517917eb49.html" target="n" data-glyph="74,2" class="i method">GroupStart</a>()
            {
                <b>int</b> <span id="r108 rd" class="r108 r">columns</span> = <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span>;
 
                <b>if</b> (<span class="r108 r">columns</span> == 0)
                {
                    <b>return</b>;
                }
 
                <b>string</b>[] <span id="r109 rd" class="r109 r">properties</span> = <b>new</b> <b>string</b>[<span class="r108 r">columns</span>];
                <b>int</b> <span id="r110 rd" class="r110 r">k</span> = 0;
                <b>foreach</b> (<a href="../../P/e315917abb72a6d3.html#e315917abb72a6d3" class="t t">TableColumnInfo</a> <span id="r111 rd" class="r111 r">tci</span> <b>in</b> <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>)
                {
                    <span class="r109 r">properties</span>[<span class="r110 r">k</span>++] = <span class="r111 r">tci</span>.<a href="FormattingObjects.cs.html#1653297383e48941" class="i field">label</a> ?? <span class="r111 r">tci</span>.<a href="FormattingObjects.cs.html#f400652910d0cd7e" class="i field">propertyName</a>;
                }
 
                <a href="#e7ad236afbf18759" class="i field">_rowCount</a> += <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<a href="TableWriter.cs.html#77d74ae3ed223bd5" class="i method">GenerateHeader</a>(<span class="r109 r">properties</span>, <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write a row into the table.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="b2017b77b2288949" href="../../R/b2017b77b2288949.html" target="n" data-glyph="74,2" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r112 rd" class="r112 r">fed</span>)
            {
                <b>int</b> <span id="r113 rd" class="r113 r">headerColumns</span> = <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f818199573ded478" class="i property">CurrentTableHeaderInfo</a>.<a href="FormattingObjects.cs.html#471131c66ff85ab6" class="i field">tableColumnInfoList</a>.<span class="i">Count</span>;
 
                <b>if</b> (<span class="r113 r">headerColumns</span> == 0)
                {
                    <b>return</b>;
                }
 
                <b>if</b> (<a href="#5a2cec4cbaa9c294" class="i field">_repeatHeader</a> &amp;&amp; <a href="#e7ad236afbf18759" class="i field">_rowCount</a> &gt;= <a href="#c12eee226bc301da" class="i field">_consoleHeight</a> - <a href="#2c283a9fcd372907" class="i field">WhitespaceAndPagerLineCount</a>)
                {
                    <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
                    <a href="#e7ad236afbf18759" class="i field">_rowCount</a> = <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<a href="TableWriter.cs.html#77d74ae3ed223bd5" class="i method">GenerateHeader</a>(<b>null</b>, <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>);
                }
 
                <a href="../../P/20532373052c8ea7.html#20532373052c8ea7" class="t t">TableRowEntry</a> <span id="r114 rd" class="r114 r">tre</span> = <span class="r112 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/20532373052c8ea7.html#20532373052c8ea7" class="t t">TableRowEntry</a>;
 
                <span class="c">// need to make sure we have matching counts: the header count will have to prevail</span>
                <b>string</b>[] <span id="r115 rd" class="r115 r">values</span> = <b>new</b> <b>string</b>[<span class="r113 r">headerColumns</span>];
                <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r116 rd" class="r116 r">alignment</span> = <span class="r113 r">headerColumns</span> &lt;= <a href="#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r113 r">headerColumns</span>] : <b>new</b> <b>int</b>[<span class="r113 r">headerColumns</span>];
 
                <b>int</b> <span id="r117 rd" class="r117 r">fieldCount</span> = <span class="r114 r">tre</span>.<a href="FormattingObjects.cs.html#20666ce23d542f89" class="i field">formatPropertyFieldList</a>.<span class="i">Count</span>;
 
                <b>for</b> (<b>int</b> <span id="r118 rd" class="r118 r">k</span> = 0; <span class="r118 r">k</span> &lt; <span class="r113 r">headerColumns</span>; <span class="r118 r">k</span>++)
                {
                    <b>if</b> (<span class="r118 r">k</span> &lt; <span class="r117 r">fieldCount</span>)
                    {
                        <span class="r115 r">values</span>[<span class="r118 r">k</span>] = <span class="r114 r">tre</span>.<a href="FormattingObjects.cs.html#20666ce23d542f89" class="i field">formatPropertyFieldList</a>[<span class="r118 r">k</span>].<span class="i">propertyValue</span>;
                        <span class="r116 r">alignment</span>[<span class="r118 r">k</span>] = <span class="r114 r">tre</span>.<a href="FormattingObjects.cs.html#20666ce23d542f89" class="i field">formatPropertyFieldList</a>[<span class="r118 r">k</span>].<span class="i">alignment</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r115 r">values</span>[<span class="r118 r">k</span>] = <b>string</b>.<span class="i">Empty</span>;
                        <span class="r116 r">alignment</span>[<span class="r118 r">k</span>] = <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#7c93eb74c2450823" class="i field">Left</a>; <span class="c">// hard coded default</span>
                    }
                }
 
                <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<span class="i">GenerateRow</span>(<span class="r115 r">values</span>, <a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>, <span class="r114 r">tre</span>.<a href="FormattingObjects.cs.html#789fe50dd8c8d75f" class="i field">multiLine</a>, <span class="r116 r">alignment</span>, <a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>, <span class="i">generatedRows</span>: <b>null</b>);
                <a href="#e7ad236afbf18759" class="i field">_rowCount</a>++;
            }
 
            <b>private</b> <a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a> <a id="f818199573ded478" href="../../R/f818199573ded478.html" target="n" data-glyph="106,2" class="i property">CurrentTableHeaderInfo</a>
            {
                <b>get</b>
                {
                    <b>return</b> (<a href="../../P/600b733820939944.html#600b733820939944" class="t t">TableHeaderInfo</a>)<a href="#b2411ceaaaab85bb" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#cbddd83bb130c4fc" class="i property">ShapeInfoOnFormatContext</a>;
                }
            }
        }
 
        <b>private sealed class</b> <a id="19b9a3099ef6280e" href="../../R/19b9a3099ef6280e.html" target="n" data-glyph="4,1" class="t t">ListOutputContext</a> : <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">cmd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reference to the OutCommandInner instance who owns this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="1aa6259993f3fdb7" href="../../R/1aa6259993f3fdb7.html" target="n" data-glyph="74,2" class="t constructor">ListOutputContext</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r119 rd" class="r119 r">cmd</span>,
                <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r120 rd" class="r120 r">parentContext</span>,
                <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r121 rd" class="r121 r">formatData</span>)
                : <a href="#2f83ea617fa4a4b9" class="k">base</a>(<span class="r119 r">cmd</span>, <span class="r120 r">parentContext</span>, <span class="r121 r">formatData</span>)
            {
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initialize column widths.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="c9e52a8e51d070f5" href="../../R/c9e52a8e51d070f5.html" target="n" data-glyph="74,2" class="i method">Initialize</a>()
            {
            }
 
            <b>private void</b> <a id="22507332844842a6" href="../../R/22507332844842a6.html" target="n" data-glyph="76,2" class="i method">InternalInitialize</a>(<a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a> <span id="r122 rd" class="r122 r">lve</span>)
            {
                <a href="#7ea958b77a74ddc2" class="i field">_properties</a> = <a href="#2dda74892f152002" class="i method">GetProperties</a>(<span class="r122 r">lve</span>);
                <a href="#08fdc5854fff42fb" class="i field">_listWriter</a>.<a href="ListWriter.cs.html#d153226e55f3200e" class="i method">Initialize</a>(<a href="#7ea958b77a74ddc2" class="i field">_properties</a>, <a href="#19b9a3099ef6280e" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>, <a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>);
            }
 
            <b>internal static string</b>[] <a id="2dda74892f152002" href="../../R/2dda74892f152002.html" target="n" data-glyph="74,2" class="i method">GetProperties</a>(<a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a> <span id="r123 rd" class="r123 r">lve</span>)
            {
                <b>int</b> <span id="r124 rd" class="r124 r">count</span> = <span class="r123 r">lve</span>.<a href="FormattingObjects.cs.html#2ee07edd74ba8a57" class="i field">listViewFieldList</a>.<span class="i">Count</span>;
 
                <b>if</b> (<span class="r124 r">count</span> == 0)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b>[] <span id="r125 rd" class="r125 r">result</span> = <b>new</b> <b>string</b>[<span class="r124 r">count</span>];
                <b>for</b> (<b>int</b> <span id="r126 rd" class="r126 r">index</span> = 0; <span class="r126 r">index</span> &lt; <span class="r125 r">result</span>.<span class="i">Length</span>; ++<span class="r126 r">index</span>)
                {
                    <a href="../../P/9b9728314a191a59.html#9b9728314a191a59" class="t t">ListViewField</a> <span id="r127 rd" class="r127 r">lvf</span> = <span class="r123 r">lve</span>.<a href="FormattingObjects.cs.html#2ee07edd74ba8a57" class="i field">listViewFieldList</a>[<span class="r126 r">index</span>];
                    <span class="r125 r">result</span>[<span class="r126 r">index</span>] = <span class="r127 r">lvf</span>.<a href="FormattingObjects.cs.html#f0ac848f92b79da4" class="i field">label</a> ?? <span class="r127 r">lvf</span>.<a href="FormattingObjects.cs.html#e3cc7f45037e2908" class="i field">propertyName</a>;
                }
 
                <b>return</b> <span class="r125 r">result</span>;
            }
 
            <b>internal static string</b>[] <a id="623a136daaf8356e" href="../../R/623a136daaf8356e.html" target="n" data-glyph="74,2" class="i method">GetValues</a>(<a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a> <span id="r128 rd" class="r128 r">lve</span>)
            {
                <b>int</b> <span id="r129 rd" class="r129 r">count</span> = <span class="r128 r">lve</span>.<a href="FormattingObjects.cs.html#2ee07edd74ba8a57" class="i field">listViewFieldList</a>.<span class="i">Count</span>;
 
                <b>if</b> (<span class="r129 r">count</span> == 0)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b>[] <span id="r130 rd" class="r130 r">result</span> = <b>new</b> <b>string</b>[<span class="r129 r">count</span>];
                <b>for</b> (<b>int</b> <span id="r131 rd" class="r131 r">index</span> = 0; <span class="r131 r">index</span> &lt; <span class="r130 r">result</span>.<span class="i">Length</span>; ++<span class="r131 r">index</span>)
                {
                    <a href="../../P/9b9728314a191a59.html#9b9728314a191a59" class="t t">ListViewField</a> <span id="r132 rd" class="r132 r">lvf</span> = <span class="r128 r">lve</span>.<a href="FormattingObjects.cs.html#2ee07edd74ba8a57" class="i field">listViewFieldList</a>[<span class="r131 r">index</span>];
                    <span class="r130 r">result</span>[<span class="r131 r">index</span>] = <span class="r132 r">lvf</span>.<a href="FormattingObjects.cs.html#d1c4d9ed2b0ee64a" class="i field">formatPropertyField</a>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a>;
                }
 
                <b>return</b> <span class="r130 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write the headers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="c7367c1ffffd2121" href="../../R/c7367c1ffffd2121.html" target="n" data-glyph="74,2" class="i method">GroupStart</a>()
            {
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write a row into the list.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="aee2e3297c1a7760" href="../../R/aee2e3297c1a7760.html" target="n" data-glyph="74,2" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r133 rd" class="r133 r">fed</span>)
            {
                <a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a> <span id="r134 rd" class="r134 r">lve</span> = <span class="r133 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/89184b93ea446f41.html#89184b93ea446f41" class="t t">ListViewEntry</a>;
                <a href="#22507332844842a6" class="i method">InternalInitialize</a>(<span class="r134 r">lve</span>);
                <b>string</b>[] <span id="r135 rd" class="r135 r">values</span> = <a href="#623a136daaf8356e" class="i method">GetValues</a>(<span class="r134 r">lve</span>);
                <a href="#08fdc5854fff42fb" class="i field">_listWriter</a>.<a href="ListWriter.cs.html#4f661ea66ff0c095" class="i method">WriteProperties</a>(<span class="r135 r">values</span>, <a href="#19b9a3099ef6280e" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>);
                <a href="#19b9a3099ef6280e" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Property list currently active.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private string</b>[] <a id="7ea958b77a74ddc2" href="../../R/7ea958b77a74ddc2.html" target="n" data-glyph="46,2" class="i field">_properties</a> = <b>null</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Writer to do the actual formatting.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private readonly</b> <a href="ListWriter.cs.html#ad29ebb165496bdd" class="t t">ListWriter</a> <a id="08fdc5854fff42fb" href="../../R/08fdc5854fff42fb.html" target="n" data-glyph="46,2" class="i field">_listWriter</a> = <b>new</b> <span class="t">ListWriter</span>();
        }
 
        <b>private sealed class</b> <a id="b80013b2ab0b1697" href="../../R/b80013b2ab0b1697.html" target="n" data-glyph="4,1" class="t t">WideOutputContext</a> : <a href="#202cd2852b3d97c6" class="t t">TableOutputContextBase</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">cmd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reference to the OutCommandInner instance who owns this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="20ca27e26270bd98" href="../../R/20ca27e26270bd98.html" target="n" data-glyph="74,2" class="t constructor">WideOutputContext</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r136 rd" class="r136 r">cmd</span>,
                <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r137 rd" class="r137 r">parentContext</span>,
                <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r138 rd" class="r138 r">formatData</span>)
                : <a href="#905169f9074716d5" class="k">base</a>(<span class="r136 r">cmd</span>, <span class="r137 r">parentContext</span>, <span class="r138 r">formatData</span>)
            {
            }
 
            <b>private</b> <a href="#129c0751da2bb7a4" class="t t">StringValuesBuffer</a> <a id="52245a8e330506f7" href="../../R/52245a8e330506f7.html" target="n" data-glyph="46,2" class="i field">_buffer</a> = <b>null</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initialize column widths.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="0c0b79e758ecffc1" href="../../R/0c0b79e758ecffc1.html" target="n" data-glyph="74,2" class="i method">Initialize</a>()
            {
                <span class="c">// set the hard wider default, to be used if no other info is available</span>
                <b>int</b> <span id="r139 rd" class="r139 r">itemsPerRow</span> = 2;
 
                <span class="c">// get the header info and the view hint</span>
                <a href="#a3b10fe942c1357e" class="t t">WideFormattingHint</a> <span id="r140 rd" class="r140 r">hint</span> = <a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#74374fc782a827c5" class="i method">RetrieveFormattingHint</a>() <b>as</b> <a href="#a3b10fe942c1357e" class="t t">WideFormattingHint</a>;
 
                <b>int</b> <span id="r141 rd" class="r141 r">columnsOnTheScreen</span> = <a href="#489598de9be5a188" class="i method">GetConsoleWindowWidth</a>(<a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>);
 
                <span class="c">// give a preference to the hint, if there</span>
                <b>if</b> (<span class="r140 r">hint</span> != <b>null</b> &amp;&amp; <span class="r140 r">hint</span>.<a href="#dbcea74b94984974" class="i field">maxWidth</a> &gt; 0)
                {
                    <span class="r139 r">itemsPerRow</span> = <a href="TableWriter.cs.html#719f009e44c059f3" class="t t">TableWriter</a>.<a href="TableWriter.cs.html#bee0f990e519c83c" class="i method">ComputeWideViewBestItemsPerRowFit</a>(<span class="r140 r">hint</span>.<a href="#dbcea74b94984974" class="i field">maxWidth</a>, <span class="r141 r">columnsOnTheScreen</span>);
                }
                <b>else</b> <b>if</b> (<a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#3676cfaba609dafb" class="i property">CurrentWideHeaderInfo</a>.<a href="FormattingObjects.cs.html#0a83aa25eadba343" class="i field">columns</a> &gt; 0)
                {
                    <span class="r139 r">itemsPerRow</span> = <a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#3676cfaba609dafb" class="i property">CurrentWideHeaderInfo</a>.<a href="FormattingObjects.cs.html#0a83aa25eadba343" class="i field">columns</a>;
                }
 
                <span class="c">// create a buffer object to hold partial rows</span>
                <a href="#52245a8e330506f7" class="i field">_buffer</a> = <b>new</b> <a href="#5edb5afd7887453b" class="t constructor">StringValuesBuffer</a>(<span class="r139 r">itemsPerRow</span>);
 
                <span class="c">// initialize the writer</span>
                <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r142 rd" class="r142 r">columnWidths</span> = <span class="r139 r">itemsPerRow</span> &lt;= <a href="#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r139 r">itemsPerRow</span>] : <b>new</b> <b>int</b>[<span class="r139 r">itemsPerRow</span>];
                <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r143 rd" class="r143 r">alignment</span> = <span class="r139 r">itemsPerRow</span> &lt;= <a href="#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r139 r">itemsPerRow</span>] : <b>new</b> <b>int</b>[<span class="r139 r">itemsPerRow</span>];
 
                <b>for</b> (<b>int</b> <span id="r144 rd" class="r144 r">k</span> = 0; <span class="r144 r">k</span> &lt; <span class="r139 r">itemsPerRow</span>; <span class="r144 r">k</span>++)
                {
                    <span class="r142 r">columnWidths</span>[<span class="r144 r">k</span>] = 0; <span class="c">// autosize</span>
                    <span class="r143 r">alignment</span>[<span class="r144 r">k</span>] = <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#7c93eb74c2450823" class="i field">Left</a>;
                }
 
                <a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<span class="i">Initialize</span>(0, <span class="r141 r">columnsOnTheScreen</span>, <span class="r142 r">columnWidths</span>, <span class="r143 r">alignment</span>, <b>false</b>, <a href="#44601cc170ca9ca1" class="i method">GetConsoleWindowHeight</a>(<a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#39159c993fef4e35" class="i property">RowNumber</a>));
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write the headers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="d5edec6eaf918110" href="../../R/d5edec6eaf918110.html" target="n" data-glyph="74,2" class="i method">GroupStart</a>()
            {
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Called when the end of a group is reached, flush the</span>
            <span class="c">///</span><span class="c"> write buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="55a8380b0671a20a" href="../../R/55a8380b0671a20a.html" target="n" data-glyph="74,2" class="i method">GroupEnd</a>()
            {
                <a href="#8628c4ae5a727e18" class="i method">WriteStringBuffer</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write a row into the table.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="13119d9c4392e097" href="../../R/13119d9c4392e097.html" target="n" data-glyph="74,2" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r145 rd" class="r145 r">fed</span>)
            {
                <a href="../../P/06bff2ee63bb3209.html#06bff2ee63bb3209" class="t t">WideViewEntry</a> <span id="r146 rd" class="r146 r">wve</span> = <span class="r145 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="../../P/06bff2ee63bb3209.html#06bff2ee63bb3209" class="t t">WideViewEntry</a>;
                <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r147 rd" class="r147 r">fpf</span> = <span class="r146 r">wve</span>.<a href="FormattingObjects.cs.html#03906afc1c6fa346" class="i field">formatPropertyField</a> <b>as</b> <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a>;
                <a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#308251cc9b75ed1d" class="i method">Add</a>(<span class="r147 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a>);
                <b>if</b> (<a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#872cb299daf62104" class="i property">IsFull</a>)
                {
                    <a href="#8628c4ae5a727e18" class="i method">WriteStringBuffer</a>();
                }
            }
 
            <b>private</b> <a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a> <a id="3676cfaba609dafb" href="../../R/3676cfaba609dafb.html" target="n" data-glyph="106,2" class="i property">CurrentWideHeaderInfo</a>
            {
                <b>get</b>
                {
                    <b>return</b> (<a href="../../P/7c1f0191b6b2f555.html#7c1f0191b6b2f555" class="t t">WideViewHeaderInfo</a>)<a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#cbddd83bb130c4fc" class="i property">ShapeInfoOnFormatContext</a>;
                }
            }
 
            <b>private void</b> <a id="8628c4ae5a727e18" href="../../R/8628c4ae5a727e18.html" target="n" data-glyph="76,2" class="i method">WriteStringBuffer</a>()
            {
                <b>if</b> (<a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#f2889253fed4cff9" class="i property">IsEmpty</a>)
                {
                    <b>return</b>;
                }
 
                <b>string</b>[] <span id="r148 rd" class="r148 r">values</span> = <b>new</b> <b>string</b>[<a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#0c3436d0db758772" class="i property">Length</a>];
                <b>for</b> (<b>int</b> <span id="r149 rd" class="r149 r">k</span> = 0; <span class="r149 r">k</span> &lt; <span class="r148 r">values</span>.<span class="i">Length</span>; <span class="r149 r">k</span>++)
                {
                    <b>if</b> (<span class="r149 r">k</span> &lt; <a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#6bdf1af993009c34" class="i property">CurrentCount</a>)
                        <span class="r148 r">values</span>[<span class="r149 r">k</span>] = <a href="#52245a8e330506f7" class="i field">_buffer</a><a href="#171401d894aedd02">[</a><span class="r149 r">k</span>];
                    <b>else</b>
                        <span class="r148 r">values</span>[<span class="r149 r">k</span>] = <b>string</b>.<span class="i">Empty</span>;
                }
 
                <a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f2f8175d416645e0" class="i property">Writer</a>.<a href="TableWriter.cs.html#1ac3b06f93162369" class="i method">GenerateRow</a>(<span class="r148 r">values</span>, <a href="#b80013b2ab0b1697" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>, <b>false</b>, <b>null</b>, <a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>, <span class="r150 r">generatedRows</span>: <b>null</b>);
                <a href="#52245a8e330506f7" class="i field">_buffer</a>.<a href="#8b3f148fa54ebfef" class="i method">Reset</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Helper class to accumulate the display values so that when the end</span>
            <span class="c">///</span><span class="c"> of a line is reached, a full line can be composed.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private sealed class</b> <a id="129c0751da2bb7a4" href="../../R/129c0751da2bb7a4.html" target="n" data-glyph="4,2" class="t t">StringValuesBuffer</a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Construct the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">size</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Number of entries to cache.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
                <b>internal</b> <a id="5edb5afd7887453b" href="../../R/5edb5afd7887453b.html" target="n" data-glyph="74,3" class="t constructor">StringValuesBuffer</a>(<b>int</b> <span id="r151 rd" class="r151 r">size</span>)
                {
                    <a href="#ac979a1d5c8823c3" class="i field">_arr</a> = <b>new</b> <b>string</b>[<span class="r151 r">size</span>];
                    <a href="#8b3f148fa54ebfef" class="i method">Reset</a>();
                }
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Get the size of the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal int</b> <a id="0c3436d0db758772" href="../../R/0c3436d0db758772.html" target="n" data-glyph="104,3" class="i property">Length</a> { <b>get</b> { <b>return</b> <a href="#ac979a1d5c8823c3" class="i field">_arr</a>.<span class="i">Length</span>; } }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Get the current number of entries in the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal int</b> <a id="6bdf1af993009c34" href="../../R/6bdf1af993009c34.html" target="n" data-glyph="104,3" class="i property">CurrentCount</a> { <b>get</b> { <b>return</b> <a href="#8c5d348c1ca96253" class="i field">_lastEmptySpot</a>; } }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Check if the buffer is full.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal bool</b> <a id="872cb299daf62104" href="../../R/872cb299daf62104.html" target="n" data-glyph="104,3" class="i property">IsFull</a>
                {
                    <b>get</b> { <b>return</b> <a href="#8c5d348c1ca96253" class="i field">_lastEmptySpot</a> == <a href="#ac979a1d5c8823c3" class="i field">_arr</a>.<span class="i">Length</span>; }
                }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Check if the buffer is empty.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal bool</b> <a id="f2889253fed4cff9" href="../../R/f2889253fed4cff9.html" target="n" data-glyph="104,3" class="i property">IsEmpty</a>
                {
                    <b>get</b> { <b>return</b> <a href="#8c5d348c1ca96253" class="i field">_lastEmptySpot</a> == 0; }
                }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Indexer to access the k-th item in the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal string</b> <a id="171401d894aedd02" href="../../R/171401d894aedd02.html" target="n" data-glyph="104,3" class="k">this</a>[<b>int</b> <span id="r152 rd" class="r152 r">k</span>] { <b>get</b> { <b>return</b> <a href="#ac979a1d5c8823c3" class="i field">_arr</a>[<span class="r152 r">k</span>]; } }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Add an item to the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">s</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
                <b>internal void</b> <a id="308251cc9b75ed1d" href="../../R/308251cc9b75ed1d.html" target="n" data-glyph="74,3" class="i method">Add</a>(<b>string</b> <span id="r153 rd" class="r153 r">s</span>)
                {
                    <a href="#ac979a1d5c8823c3" class="i field">_arr</a>[<a href="#8c5d348c1ca96253" class="i field">_lastEmptySpot</a>++] = <span class="r153 r">s</span>;
                }
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Reset the buffer.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal void</b> <a id="8b3f148fa54ebfef" href="../../R/8b3f148fa54ebfef.html" target="n" data-glyph="74,3" class="i method">Reset</a>()
                {
                    <a href="#8c5d348c1ca96253" class="i field">_lastEmptySpot</a> = 0;
                    <b>for</b> (<b>int</b> <span id="r154 rd" class="r154 r">k</span> = 0; <span class="r154 r">k</span> &lt; <a href="#ac979a1d5c8823c3" class="i field">_arr</a>.<span class="i">Length</span>; <span class="r154 r">k</span>++)
                        <a href="#ac979a1d5c8823c3" class="i field">_arr</a>[<span class="r154 r">k</span>] = <b>null</b>;
                }
 
                <b>private readonly string</b>[] <a id="ac979a1d5c8823c3" href="../../R/ac979a1d5c8823c3.html" target="n" data-glyph="46,3" class="i field">_arr</a>;
                <b>private int</b> <a id="8c5d348c1ca96253" href="../../R/8c5d348c1ca96253.html" target="n" data-glyph="46,3" class="i field">_lastEmptySpot</a>;
            }
        }
 
        <b>private sealed class</b> <a id="6dec307b8de3ae66" href="../../R/6dec307b8de3ae66.html" target="n" data-glyph="4,1" class="t t">ComplexOutputContext</a> : <a href="#c03e72aeccf5acd3" class="t t">GroupOutputContext</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct a context to push on the stack.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r155 r">cmd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reference to the OutCommandInner instance who owns this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">parentContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent context in the stack.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">formatData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Format data to put in the context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="b5c18c3fc108e1b3" href="../../R/b5c18c3fc108e1b3.html" target="n" data-glyph="74,2" class="t constructor">ComplexOutputContext</a>(<a href="#82ff02ddef6485d3" class="t t">OutCommandInner</a> <span id="r155 rd" class="r155 r">cmd</span>,
                <a href="FormatMsgCtxManager.cs.html#dab543ae467daa92" class="t t">FormatMessagesContextManager</a>.<a href="FormatMsgCtxManager.cs.html#522b3a720477f4b3" class="t t">OutputContext</a> <span id="r156 rd" class="r156 r">parentContext</span>,
                <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r157 rd" class="r157 r">formatData</span>)
                : <a href="#2f83ea617fa4a4b9" class="k">base</a>(<span class="r155 r">cmd</span>, <span class="r156 r">parentContext</span>, <span class="r157 r">formatData</span>)
            {
            }
 
            <b>internal override void</b> <a id="01674b22e13665a3" href="../../R/01674b22e13665a3.html" target="n" data-glyph="74,2" class="i method">Initialize</a>()
            {
                <a href="#c847c6bd62c6c144" class="i field">_writer</a>.<a href="ComplexWriter.cs.html#5e5a6185d20a34fb" class="i method">Initialize</a>(<a href="#6dec307b8de3ae66" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>,
                                    <a href="#6dec307b8de3ae66" class="k">this</a>.<a href="#f0ae508c93e30545" class="i property">InnerCommand</a>.<a href="#d0b349da12c3b254" class="i field">_lo</a>.<a href="ILineOutput.cs.html#3290dc933f9a91b3" class="i property">ColumnNumber</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Write a row into the list.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">fed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">FormatEntryData to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal override void</b> <a id="8e79e11f30302d58" href="../../R/8e79e11f30302d58.html" target="n" data-glyph="74,2" class="i method">ProcessPayload</a>(<a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r158 rd" class="r158 r">fed</span>)
            {
                <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r159 rd" class="r159 r">cve</span> = <span class="r158 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> <b>as</b> <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a>;
                <b>if</b> (<span class="r159 r">cve</span> == <b>null</b> || <span class="r159 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a> == <b>null</b>)
                    <b>return</b>;
                <a href="#c847c6bd62c6c144" class="i field">_writer</a>.<a href="ComplexWriter.cs.html#6c3ead2b5662ffe5" class="i method">WriteObject</a>(<span class="r159 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>);
            }
 
            <b>private readonly</b> <a href="ComplexWriter.cs.html#dde06a7912f5417c" class="t t">ComplexWriter</a> <a id="c847c6bd62c6c144" href="../../R/c847c6bd62c6c144.html" target="n" data-glyph="46,2" class="i field">_writer</a> = <b>new</b> <span class="t">ComplexWriter</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
