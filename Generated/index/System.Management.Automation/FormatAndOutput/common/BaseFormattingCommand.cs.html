<!DOCTYPE html>
<html><head><title>BaseFormattingCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(900);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/BaseFormattingCommand.cs" target="_top">FormatAndOutput\common\BaseFormattingCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class defining the formatting context and the</span>
    <span class="c">///</span><span class="c"> formatting context manager (stack based)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="3792d0aad574d050" href="../../R/3792d0aad574d050.html" target="n" data-glyph="2,0" class="t t">InnerFormatShapeCommandBase</a> : <a href="BaseCommand.cs.html#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor to set up the formatting context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e28db20662856152" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">InnerFormatShapeCommandBase</a>()
        {
            <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Push</span>(<a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#ac9793f83c9c3902" class="i field">none</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enum listing the possible states the context is in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="4602885947eb96d7" href="../../R/4602885947eb96d7.html" target="n" data-glyph="20,1" class="t t"><span id="4af729f041594dc6">FormattingContextState</span></a> { <a id="ac9793f83c9c3902" href="../../R/ac9793f83c9c3902.html" target="n" data-glyph="24,2" class="i field">none</a>, <a id="8b7187dde1a3e979" href="../../R/8b7187dde1a3e979.html" target="n" data-glyph="24,2" class="i field">document</a>, <a id="80aa06320719110f" href="../../R/80aa06320719110f.html" target="n" data-glyph="24,2" class="i field">group</a> }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Context manager: stack to keep track in which context</span>
        <span class="c">///</span><span class="c"> the formatter is.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Stack</span>&lt;<a href="#4602885947eb96d7" class="t t">FormattingContextState</a>&gt; <a id="6a1cedbf494a8130" href="../../R/6a1cedbf494a8130.html" target="n" data-glyph="45,1" class="i field">contextManager</a> = <b>new</b> <span class="i">Stack</span>&lt;<a href="#4602885947eb96d7" class="t t">FormattingContextState</a>&gt;();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Core inner implementation for format/xxx commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="b8a16c335363cf07" href="../../R/b8a16c335363cf07.html" target="n" data-glyph="2,0" class="t t">InnerFormatShapeCommand</a> : <a href="#3792d0aad574d050" class="t t">InnerFormatShapeCommandBase</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor to glue to the CRO.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="14694107d1746d35" href="../../R/14694107d1746d35.html" target="n" data-glyph="74,1" class="t constructor">InnerFormatShapeCommand</a>(<a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <span id="r0 rd" class="r0 r">shape</span>)
        {
            <a href="#da0f29bb8551b2bf" class="i field">_shape</a> = <span class="r0 r">shape</span>;
        }
 
        <b>internal static int</b> <a id="bff7a772fdb83202" href="../../R/bff7a772fdb83202.html" target="n" data-glyph="74,1" class="i method">FormatEnumerationLimit</a>()
        {
            <b>object</b> <span id="r1 rd" class="r1 r">enumLimitVal</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="c">// Win8: 192504</span>
                <b>if</b> (<a href="../../engine/hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../../engine/hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>() != <b>null</b>)
                {
                    <span class="r1 r">enumLimitVal</span> = <a href="../../engine/hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../../engine/hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>()
                        .<a href="../../engine/ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../../engine/SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>
                        .<span class="i">GetValue</span>(<span class="s">&quot;global:&quot;</span> + <a href="../../engine/InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../../engine/InitialSessionState.cs.html#5f35a6e393befada" class="i field">FormatEnumerationLimit</a>);
                }
            }
            <span class="c">// Eat the following exceptions, enumerationLimit will use the default value</span>
            <b>catch</b> (<a href="../../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
            {
            }
            <b>catch</b> (<a href="../../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a>)
            {
            }
 
            <span class="c">// if $global:FormatEnumerationLimit is an int, overwrite the default value</span>
            <b>return</b> <span class="r1 r">enumLimitVal</span> <b>is int</b> ? (<b>int</b>)<span class="r1 r">enumLimitVal</span> : <a href="../../engine/InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../../engine/InitialSessionState.cs.html#4d3f35f31f97da63" class="i field">DefaultFormatEnumerationLimit</a>;
        }
 
        <b>internal override void</b> <a id="c12444c678bc3f67" href="../../R/c12444c678bc3f67.html" target="n" data-glyph="74,1" class="i method">BeginProcessing</a>()
        {
            <a href="#3792d0aad574d050" class="k">base</a>.<a href="BaseCommand.cs.html#5f205895950197ef" class="i method">BeginProcessing</a>();
 
            <span class="c">// Get the Format Enumeration Limit.</span>
            <a href="#a3dfcc1f490498af" class="i field">_enumerationLimit</a> = <a href="#b8a16c335363cf07" class="t t">InnerFormatShapeCommand</a>.<a href="#bff7a772fdb83202" class="i method">FormatEnumerationLimit</a>();
 
            <a href="#d7a6f69aa3194559" class="i field">_expressionFactory</a> = <b>new</b> <span class="t">PSPropertyExpressionFactory</span>();
 
            <a href="#b3713aaffdcb200f" class="i field">_formatObjectDeserializer</a> = <b>new</b> <a href="FormattingObjectsDeserializer.cs.html#ac2f99f3a605e8d3" class="t constructor">FormatObjectDeserializer</a>(<a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution entry point.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="f8fca2a48960fb34" href="../../R/f8fca2a48960fb34.html" target="n" data-glyph="74,1" class="i method">ProcessRecord</a>()
        {
            <a href="#5f0a3c620d94186c" class="i field">_typeInfoDataBase</a> = <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#810407458232faa8" class="i method">OuterCmdlet</a>().<a href="../../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../engine/ExecutionContext.cs.html#40afda0efcb0cad4" class="i property">FormatDBManager</a>.<a href="DisplayDatabase/typeDataManager.cs.html#b98bbbe500c5a257" class="i method">GetTypeInfoDataBase</a>();
 
            <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r2 rd" class="r2 r">so</span> = <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#194a6ddb58a33583" class="i method">ReadObject</a>();
            <b>if</b> (<span class="r2 r">so</span> == <b>null</b> || <span class="r2 r">so</span> == <a href="../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                <b>return</b>;
 
            <span class="i">IEnumerable</span> <span id="r3 rd" class="r3 r">e</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r2 r">so</span>);
            <b>if</b> (<span class="r3 r">e</span> == <b>null</b>)
            {
                <a href="#8113fe9fd9b4b888" class="i method">ProcessObject</a>(<span class="r2 r">so</span>);
                <b>return</b>;
            }
 
            <span class="c">// we have an IEnumerable, we have to decide if to expand, if at all</span>
            <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a> <span id="r4 rd" class="r4 r">expansionState</span> = <a href="#b8a16c335363cf07" class="k">this</a>.<a href="#c8c8f64d1f254e3b" class="i method">GetExpansionState</a>(<span class="r2 r">so</span>);
 
            <b>switch</b> (<span class="r4 r">expansionState</span>)
            {
                <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7516787afa7e0926" class="i field">EnumOnly</a>:
                    {
                        <b>foreach</b> (<b>object</b> <span id="r5 rd" class="r5 r">obj</span> <b>in</b> <span class="r3 r">e</span>)
                        {
                            <a href="#8113fe9fd9b4b888" class="i method">ProcessObject</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r5 r">obj</span>));
                        }
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#58f0e5cb847b50e0" class="i field">Both</a>:
                    {
                        <b>var</b> <span id="r6 rd" class="r6 r">objs</span> = <span class="r3 r">e</span>.<span class="i">Cast</span>&lt;<b>object</b>&gt;().<span class="i">ToArray</span>();
 
                        <span class="i">ProcessCoreOutOfBand</span>(<span class="r2 r">so</span>, <span class="r6 r">objs</span>.<span class="i">Length</span>);
                        <b>foreach</b> (<b>object</b> <span id="r7 rd" class="r7 r">obj</span> <b>in</b> <span class="r6 r">objs</span>)
                        {
                            <a href="#8113fe9fd9b4b888" class="i method">ProcessObject</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r7 r">obj</span>));
                        }
                    }
 
                    <b>break</b>;
                <b>default</b>:
                    {
                        <span class="c">// do not enumerate at all (CoreOnly)</span>
                        <a href="#8113fe9fd9b4b888" class="i method">ProcessObject</a>(<span class="r2 r">so</span>);
                    }
 
                    <b>break</b>;
            }
        }
 
        <b>private</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a> <a id="c8c8f64d1f254e3b" href="../../R/c8c8f64d1f254e3b.html" target="n" data-glyph="76,1" class="i method">GetExpansionState</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r8 rd" class="r8 r">so</span>)
        {
            <span class="c">// if the command line swtich has been specified, use this as an override</span>
            <b>if</b> (<a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a> != <b>null</b> &amp;&amp; <a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a>.<a href="BaseFormattingCommandParameters.cs.html#b73dca96d5343e4c" class="i field">expansion</a>.<span class="i">HasValue</span>)
            {
                <b>return</b> <a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a>.<a href="BaseFormattingCommandParameters.cs.html#b73dca96d5343e4c" class="i field">expansion</a>.<span class="i">Value</span>;
            }
 
            <span class="c">// check if we have an expansion entry in format.mshxml</span>
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r9 rd" class="r9 r">typeNames</span> = <span class="r8 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <b>return</b> <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetEnumerableExpansionFromType</span>(
                <a href="#d7a6f69aa3194559" class="i field">_expressionFactory</a>, <a href="#5f0a3c620d94186c" class="i field">_typeInfoDataBase</a>, <span class="r9 r">typeNames</span>);
        }
 
        <b>private void</b> <a id="673294add4ef2d23" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessCoreOutOfBand</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r10 rd" class="r10 r">so</span>, <b>int</b> <span id="r11 rd" class="r11 r">count</span>)
        {
            <span class="c">// emit some description header</span>
            <span class="i">SendCommentOutOfBand</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">IEnum_Header</span>);
 
            <span class="c">// emit the object as out of band</span>
            <a href="#b907bfe3756c961d" class="i method">ProcessOutOfBand</a>(<span class="r10 r">so</span>, <span class="r12 r">isProcessingError</span>: <b>false</b>);
 
            <b>string</b> <span id="r13 rd" class="r13 r">msg</span>;
            <span class="c">// emit a comment to signal that the next N objects are from the IEnumerable</span>
            <b>switch</b> (<span class="r11 r">count</span>)
            {
                <b>case</b> 0:
                    {
                        <span class="r13 r">msg</span> = <span class="i">FormatAndOut_format_xxx</span>.<span class="i">IEnum_NoObjects</span>;
                    }
 
                    <b>break</b>;
                <b>case</b> 1:
                    {
                        <span class="r13 r">msg</span> = <span class="i">FormatAndOut_format_xxx</span>.<span class="i">IEnum_OneObject</span>;
                    }
 
                    <b>break</b>;
                <b>default</b>:
                    {
                        <span class="r13 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">IEnum_ManyObjects</span>, <span class="r11 r">count</span>);
                    }
 
                    <b>break</b>;
            }
 
            <a href="#20086324a4e3a1e4" class="i method">SendCommentOutOfBand</a>(<span class="r13 r">msg</span>);
        }
 
        <b>private void</b> <a id="20086324a4e3a1e4" href="../../R/20086324a4e3a1e4.html" target="n" data-glyph="76,1" class="i method">SendCommentOutOfBand</a>(<b>string</b> <span id="r14 rd" class="r14 r">msg</span>)
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r15 rd" class="r15 r">fed</span> = <a href="FormatViewManager.cs.html#269774e606f18d4a" class="t t">OutOfBandFormatViewManager</a>.<a href="FormatViewManager.cs.html#98375fbb715665f2" class="i method">GenerateOutOfBandObjectAsToString</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r14 r">msg</span>));
            <b>if</b> (<span class="r15 r">fed</span> != <b>null</b>)
            {
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r15 r">fed</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execute formatting on a single object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8113fe9fd9b4b888" href="../../R/8113fe9fd9b4b888.html" target="n" data-glyph="76,1" class="i method">ProcessObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r16 rd" class="r16 r">so</span>)
        {
            <span class="c">// we do protect against reentrancy, assuming</span>
            <span class="c">// no fancy multiplexing</span>
            <b>if</b> (<a href="#b3713aaffdcb200f" class="i field">_formatObjectDeserializer</a>.<a href="FormattingObjectsDeserializer.cs.html#bc503e2333cffabf" class="i method">IsFormatInfoData</a>(<span class="r16 r">so</span>))
            {
                <span class="c">// we are already formatted...</span>
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r16 r">so</span>);
                <b>return</b>;
            }
 
            <span class="c">// if objects have to be treated as out of band, just</span>
            <span class="c">// bail now</span>
            <span class="c">// this is the case of objects coming before the</span>
            <span class="c">// context manager is properly set</span>
            <b>if</b> (<a href="#ce91c00a92536a14" class="i method">ProcessOutOfBandObjectOutsideDocumentSequence</a>(<span class="r16 r">so</span>))
            {
                <b>return</b>;
            }
 
            <span class="c">// if we haven&#39;t started yet, need to do so</span>
            <a href="#4602885947eb96d7" class="t t">FormattingContextState</a> <span id="r17 rd" class="r17 r">ctx</span> = <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Peek</span>();
            <b>if</b> (<span class="r17 r">ctx</span> == <a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#ac9793f83c9c3902" class="i field">none</a>)
            {
                <span class="c">// initialize the view manager</span>
                <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#3d32a9179d1e6116" class="i method">Initialize</a>(<a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>, <a href="#d7a6f69aa3194559" class="i field">_expressionFactory</a>, <a href="#5f0a3c620d94186c" class="i field">_typeInfoDataBase</a>, <span class="r16 r">so</span>, <a href="#da0f29bb8551b2bf" class="i field">_shape</a>, <a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a>);
 
                <span class="c">// add the start message to output queue</span>
                <a href="#84e1b64a7770f5ff" class="i method">WriteFormatStartData</a>(<span class="r16 r">so</span>);
 
                <span class="c">// enter the document context</span>
                <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Push</span>(<a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#8b7187dde1a3e979" class="i field">document</a>);
            }
 
            <span class="c">// if we are here, we are either in the document document, or in a group</span>
 
            <span class="c">// since we have a view now, we check if objects should be treated as out of band</span>
            <b>if</b> (<a href="#96b503bc4095fa22" class="i method">ProcessOutOfBandObjectInsideDocumentSequence</a>(<span class="r16 r">so</span>))
            {
                <b>return</b>;
            }
 
            <span class="c">// check if we have to enter or exit a group</span>
            <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a> <span id="r18 rd" class="r18 r">transition</span> = <a href="#4214ed95992cc41b" class="i method">ComputeGroupTransition</a>(<span class="r16 r">so</span>);
            <b>if</b> (<span class="r18 r">transition</span> == <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#52a69d81da7c9b69" class="i field">enter</a>)
            {
                <span class="c">// insert the group start marker</span>
                <a href="#74cd55d25855aa85" class="i method">PushGroup</a>(<span class="r16 r">so</span>);
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="#60927b4c71254272" class="i method">WritePayloadObject</a>(<span class="r16 r">so</span>);
            }
            <b>else</b> <b>if</b> (<span class="r18 r">transition</span> == <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#5ffe1e52559b403a" class="i field">exit</a>)
            {
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="#60927b4c71254272" class="i method">WritePayloadObject</a>(<span class="r16 r">so</span>);
                <span class="c">// insert the group end marker</span>
                <a href="#1de98ba71c8ddebe" class="i method">PopGroup</a>();
            }
            <b>else</b> <b>if</b> (<span class="r18 r">transition</span> == <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#ed16c4ef53680bbe" class="i field">startNew</a>)
            {
                <span class="c">// Add newline before each group except first</span>
                <a href="#c02eeb90029cf8b3" class="i method">WriteNewLineObject</a>();
 
                <span class="c">// double transition</span>
                <a href="#1de98ba71c8ddebe" class="i method">PopGroup</a>(); <span class="c">// exit the current one</span>
                <a href="#74cd55d25855aa85" class="i method">PushGroup</a>(<span class="r16 r">so</span>); <span class="c">// start a sibling group</span>
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="#60927b4c71254272" class="i method">WritePayloadObject</a>(<span class="r16 r">so</span>);
            }
            <b>else</b> <span class="c">// none, we did not have any transitions, just push out the data</span>
            {
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="#60927b4c71254272" class="i method">WritePayloadObject</a>(<span class="r16 r">so</span>);
            }
        }
 
        <b>private void</b> <a id="c02eeb90029cf8b3" href="../../R/c02eeb90029cf8b3.html" target="n" data-glyph="76,1" class="i method">WriteNewLineObject</a>()
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r19 rd" class="r19 r">fed</span> = <b>new</b> <span class="t">FormatEntryData</span>();
            <span class="r19 r">fed</span>.<a href="FormattingObjects.cs.html#59a0e653a3524695" class="i field">outOfBand</a> = <b>true</b>;
 
            <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r20 rd" class="r20 r">cve</span> = <b>new</b> <span class="t">ComplexViewEntry</span>();
            <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r21 rd" class="r21 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
            <span class="r20 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r21 r">fe</span>);
 
            <span class="c">// Formating system writes newline before each object</span>
            <span class="c">// so no need to add newline here like:</span>
            <span class="c">//     fe.formatValueList.Add(new FormatNewLine());</span>
            <span class="r19 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> = <span class="r20 r">cve</span>;
 
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r19 r">fed</span>);
        }
 
        <b>private bool</b> <a id="97c7b2bb5093b872" href="../../R/97c7b2bb5093b872.html" target="n" data-glyph="106,1" class="i property">ShouldProcessOutOfBand</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#da0f29bb8551b2bf" class="i field">_shape</a> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5698f6824831305f" class="i field">Undefined</a> || <a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a> == <b>null</b>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>return</b> !<a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a>.<a href="BaseFormattingCommandParameters.cs.html#695d9ec4dcb21ca5" class="i field">forceFormattingAlsoOnOutOfBand</a>;
            }
        }
 
        <b>private bool</b> <a id="ce91c00a92536a14" href="../../R/ce91c00a92536a14.html" target="n" data-glyph="76,1" class="i method">ProcessOutOfBandObjectOutsideDocumentSequence</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r22 rd" class="r22 r">so</span>)
        {
            <b>if</b> (!<a href="#97c7b2bb5093b872" class="i property">ShouldProcessOutOfBand</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r22 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r23 rd" class="r23 r">errors</span>;
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="k">var</a> <span id="r24 rd" class="r24 r">fed</span> = <a href="FormatViewManager.cs.html#269774e606f18d4a" class="t t">OutOfBandFormatViewManager</a>.<a href="FormatViewManager.cs.html#599d5de51adea7e6" class="i method">GenerateOutOfBandData</a>(<a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>, <a href="#d7a6f69aa3194559" class="i field">_expressionFactory</a>,
                <a href="#5f0a3c620d94186c" class="i field">_typeInfoDataBase</a>, <span class="r22 r">so</span>, <a href="#a3dfcc1f490498af" class="i field">_enumerationLimit</a>, <b>false</b>, <b>out</b> <span class="r23 r">errors</span>);
            <a href="#94e871634282d8c8" class="i method">WriteErrorRecords</a>(<span class="r23 r">errors</span>);
 
            <b>if</b> (<span class="r24 r">fed</span> != <b>null</b>)
            {
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r24 r">fed</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b> <a id="96b503bc4095fa22" href="../../R/96b503bc4095fa22.html" target="n" data-glyph="76,1" class="i method">ProcessOutOfBandObjectInsideDocumentSequence</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r25 rd" class="r25 r">so</span>)
        {
            <b>if</b> (!<a href="#97c7b2bb5093b872" class="i property">ShouldProcessOutOfBand</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r26 rd" class="r26 r">typeNames</span> = <span class="r25 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <b>if</b> (<a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<span class="i">IsObjectApplicable</span>(<span class="r26 r">typeNames</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <a href="#b907bfe3756c961d" class="i method">ProcessOutOfBand</a>(<span class="r25 r">so</span>, <span class="r12 r">isProcessingError</span>: <b>false</b>);
        }
 
        <b>private bool</b> <a id="b907bfe3756c961d" href="../../R/b907bfe3756c961d.html" target="n" data-glyph="76,1" class="i method">ProcessOutOfBand</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r27 rd" class="r27 r">so</span>, <b>bool</b> <span id="r12 rd" class="r12 r">isProcessingError</span>)
        {
            <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r28 rd" class="r28 r">errors</span>;
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r29 rd" class="r29 r">fed</span> = <a href="FormatViewManager.cs.html#269774e606f18d4a" class="t t">OutOfBandFormatViewManager</a>.<a href="FormatViewManager.cs.html#599d5de51adea7e6" class="i method">GenerateOutOfBandData</a>(<a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a>, <a href="#d7a6f69aa3194559" class="i field">_expressionFactory</a>,
                                    <a href="#5f0a3c620d94186c" class="i field">_typeInfoDataBase</a>, <span class="r27 r">so</span>, <a href="#a3dfcc1f490498af" class="i field">_enumerationLimit</a>, <b>true</b>, <b>out</b> <span class="r28 r">errors</span>);
            <b>if</b> (!<span class="r12 r">isProcessingError</span>)
                <a href="#94e871634282d8c8" class="i method">WriteErrorRecords</a>(<span class="r28 r">errors</span>);
 
            <b>if</b> (<span class="r29 r">fed</span> != <b>null</b>)
            {
                <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r29 r">fed</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>protected void</b> <a id="5ee0b9e007f74a53" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">WriteInternalErrorMessage</a>(<b>string</b> <span id="r30 rd" class="r30 r">message</span>)
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r31 rd" class="r31 r">fed</span> = <b>new</b> <span class="t">FormatEntryData</span>();
            <span class="r31 r">fed</span>.<a href="FormattingObjects.cs.html#59a0e653a3524695" class="i field">outOfBand</a> = <b>true</b>;
 
            <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r32 rd" class="r32 r">cve</span> = <b>new</b> <span class="t">ComplexViewEntry</span>();
            <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r33 rd" class="r33 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
            <span class="r32 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r33 r">fe</span>);
 
            <span class="r33 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
 
            <span class="c">// get a field for the message</span>
            <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r34 rd" class="r34 r">ftf</span> = <b>new</b> <span class="t">FormatTextField</span>();
            <span class="r34 r">ftf</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <span class="r30 r">message</span>;
            <span class="r33 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r34 r">ftf</span>);
 
            <span class="r33 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
 
            <span class="r31 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> = <span class="r32 r">cve</span>;
 
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r31 r">fed</span>);
        }
 
        <b>private void</b> <a id="94e871634282d8c8" href="../../R/94e871634282d8c8.html" target="n" data-glyph="76,1" class="i method">WriteErrorRecords</a>(<span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r35 rd" class="r35 r">errorRecordList</span>)
        {
            <b>if</b> (<span class="r35 r">errorRecordList</span> == <b>null</b>)
                <b>return</b>;
 
            <span class="c">// NOTE: for the time being we directly process error records.</span>
            <span class="c">// This is should change if we hook up error pipelines; for the</span>
            <span class="c">// time being, this achieves partial results.</span>
            <span class="c">//</span>
            <span class="c">// see NTRAID#Windows OS Bug-932722-2004/10/21-kevinloo (&quot;Output: SS: Swallowing exceptions&quot;)</span>
            <b>foreach</b> (<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r36 rd" class="r36 r">errorRecord</span> <b>in</b> <span class="r35 r">errorRecordList</span>)
            {
                <span class="c">// we are recursing on formatting errors: isProcessingError == true</span>
                <a href="#b907bfe3756c961d" class="i method">ProcessOutOfBand</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r36 r">errorRecord</span>), <b>true</b>);
            }
        }
 
        <b>internal override void</b> <a id="9dfc39a5f5cd910c" href="../../R/9dfc39a5f5cd910c.html" target="n" data-glyph="74,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// need to pop all the contexts, in case the transmission sequence</span>
            <span class="c">// was interrupted</span>
            <b>while</b> (<b>true</b>)
            {
                <a href="#4602885947eb96d7" class="t t">FormattingContextState</a> <span id="r37 rd" class="r37 r">ctx</span> = <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Peek</span>();
 
                <b>if</b> (<span class="r37 r">ctx</span> == <a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#ac9793f83c9c3902" class="i field">none</a>)
                {
                    <b>break</b>; <span class="c">// we emerged and we are done</span>
                }
                <b>else</b> <b>if</b> (<span class="r37 r">ctx</span> == <a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#80aa06320719110f" class="i field">group</a>)
                {
                    <a href="#1de98ba71c8ddebe" class="i method">PopGroup</a>();
                }
                <b>else</b> <b>if</b> (<span class="r37 r">ctx</span> == <a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#8b7187dde1a3e979" class="i field">document</a>)
                {
                    <span class="c">// inject the end format information</span>
                    <a href="FormattingObjects.cs.html#66dc8d81a6ebddc3" class="t t">FormatEndData</a> <span id="r38 rd" class="r38 r">endFormat</span> = <b>new</b> <span class="t">FormatEndData</span>();
                    <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r38 r">endFormat</span>);
                    <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Pop</span>();
                }
            }
        }
 
        <b>internal void</b> <a id="e8fee5d7a94a799c" href="../../R/e8fee5d7a94a799c.html" target="n" data-glyph="74,1" class="i method">SetCommandLineParameters</a>(<a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r39 rd" class="r39 r">commandLineParameters</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r39 r">commandLineParameters</span> != <b>null</b>, <span class="s">&quot;the caller has to pass a valid instance&quot;</span>);
            <a href="#0a7fe3c4ef78a5d7" class="i field">_parameters</a> = <span class="r39 r">commandLineParameters</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Group transitions:</span>
        <span class="c">///</span><span class="c"> none: stay in the same group</span>
        <span class="c">///</span><span class="c"> enter: start a new group</span>
        <span class="c">///</span><span class="c"> exit: exit from the current group.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private enum</b> <a id="f08b5db9146f33b7" href="../../R/f08b5db9146f33b7.html" target="n" data-glyph="22,1" class="t t"><span id="857e0957f6935ad5">GroupTransition</span></a> { <a id="918af53333c4bda5" href="../../R/918af53333c4bda5.html" target="n" data-glyph="24,2" class="i field">none</a>, <a id="52a69d81da7c9b69" href="../../R/52a69d81da7c9b69.html" target="n" data-glyph="24,2" class="i field">enter</a>, <a id="5ffe1e52559b403a" href="../../R/5ffe1e52559b403a.html" target="n" data-glyph="24,2" class="i field">exit</a>, <a id="ed16c4ef53680bbe" href="../../R/ed16c4ef53680bbe.html" target="n" data-glyph="24,2" class="i field">startNew</a> }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compute the group transition, given an input object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object received from the input pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">GroupTransition enumeration.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a> <a id="4214ed95992cc41b" href="../../R/4214ed95992cc41b.html" target="n" data-glyph="76,1" class="i method">ComputeGroupTransition</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r40 rd" class="r40 r">so</span>)
        {
            <span class="c">// check if we have to start a group</span>
            <a href="#4602885947eb96d7" class="t t">FormattingContextState</a> <span id="r41 rd" class="r41 r">ctx</span> = <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Peek</span>();
            <b>if</b> (<span class="r41 r">ctx</span> == <a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#8b7187dde1a3e979" class="i field">document</a>)
            {
                <span class="c">// prime the grouping algorithm</span>
                <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#76275f69d267cb26" class="i method">UpdateGroupingKeyValue</a>(<span class="r40 r">so</span>);
 
                <span class="c">// need to start a group, but we are not in one</span>
                <b>return</b> <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#52a69d81da7c9b69" class="i field">enter</a>;
            }
 
            <span class="c">// check if we need to start another group and keep track</span>
            <span class="c">// of the current value for the grouping property</span>
            <b>return</b> <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#76275f69d267cb26" class="i method">UpdateGroupingKeyValue</a>(<span class="r40 r">so</span>) ? <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#ed16c4ef53680bbe" class="i field">startNew</a> : <a href="#f08b5db9146f33b7" class="t t">GroupTransition</a>.<a href="#918af53333c4bda5" class="i field">none</a>;
        }
 
        <b>private void</b> <a id="84e1b64a7770f5ff" href="../../R/84e1b64a7770f5ff.html" target="n" data-glyph="76,1" class="i method">WriteFormatStartData</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r42 rd" class="r42 r">so</span>)
        {
            <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r43 rd" class="r43 r">startFormat</span> = <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#57afcf95360e2136" class="i method">GenerateStartData</a>(<span class="r42 r">so</span>);
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r43 r">startFormat</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write a payplad object by properly wrapping it into</span>
        <span class="c">///</span><span class="c"> a FormatEntry object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="60927b4c71254272" href="../../R/60927b4c71254272.html" target="n" data-glyph="76,1" class="i method">WritePayloadObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r44 rd" class="r44 r">so</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r44 r">so</span> != <b>null</b>, <span class="s">&quot;object so cannot be null&quot;</span>);
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r45 rd" class="r45 r">fed</span> = <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#c3fea5a39fe015f9" class="i method">GeneratePayload</a>(<span class="r44 r">so</span>, <a href="#a3dfcc1f490498af" class="i field">_enumerationLimit</a>);
            <span class="r45 r">fed</span>.<a href="FormattingObjects.cs.html#778494cb50302a19" class="i field">writeStream</a> = <span class="r44 r">so</span>.<a href="../../engine/MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a>;
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r45 r">fed</span>);
 
            <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r46 rd" class="r46 r">errors</span> = <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#8a2162eacf099bc6" class="i property">ErrorManager</a>.<a href="FormatViewManager.cs.html#f68eea41bf77f42b" class="i method">DrainFailedResultList</a>();
            <a href="#94e871634282d8c8" class="i method">WriteErrorRecords</a>(<span class="r46 r">errors</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inject the start group information</span>
        <span class="c">///</span><span class="c"> and push group context on stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">firstObjectInGroup</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">current pipeline object</span>
        <span class="c">///</span><span class="c"> that is starting the group</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="74cd55d25855aa85" href="../../R/74cd55d25855aa85.html" target="n" data-glyph="76,1" class="i method">PushGroup</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r47 rd" class="r47 r">firstObjectInGroup</span>)
        {
            <a href="FormattingObjects.cs.html#67d0643231a3f21d" class="t t">GroupStartData</a> <span id="r48 rd" class="r48 r">startGroup</span> = <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#4fa5c09af3cb9427" class="i method">GenerateGroupStartData</a>(<span class="r47 r">firstObjectInGroup</span>, <a href="#a3dfcc1f490498af" class="i field">_enumerationLimit</a>);
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r48 r">startGroup</span>);
            <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Push</span>(<a href="#4602885947eb96d7" class="t t">FormattingContextState</a>.<a href="#80aa06320719110f" class="i field">group</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inject the end group information</span>
        <span class="c">///</span><span class="c"> and pop group context out of stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1de98ba71c8ddebe" href="../../R/1de98ba71c8ddebe.html" target="n" data-glyph="76,1" class="i method">PopGroup</a>()
        {
            <a href="FormattingObjects.cs.html#13ca7c3ddab84ebb" class="t t">GroupEndData</a> <span id="r49 rd" class="r49 r">endGroup</span> = <a href="#ced3a1eb7439220a" class="i field">_viewManager</a>.<a href="FormatViewManager.cs.html#b54274aaffb01f4b" class="i property">ViewGenerator</a>.<a href="FormatViewGenerator.cs.html#3d5aabbfbc2ce8ec" class="i method">GenerateGroupEndData</a>();
            <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#fb27266ca93cb0b2" class="i method">WriteObject</a>(<span class="r49 r">endGroup</span>);
            <a href="#6a1cedbf494a8130" class="i field">contextManager</a>.<span class="i">Pop</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The formatting shape this formatter emits.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <a id="da0f29bb8551b2bf" href="../../R/da0f29bb8551b2bf.html" target="n" data-glyph="46,1" class="i field">_shape</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> expression factory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="bf169e190464feb7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateScriptBlock</a>(<b>string</b> <span id="r50 rd" class="r50 r">scriptText</span>)
        {
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="k">var</a> <span id="r51 rd" class="r51 r">scriptBlock</span> = <a href="#b8a16c335363cf07" class="k">this</a>.<a href="BaseCommand.cs.html#810407458232faa8" class="i method">OuterCmdlet</a>().<a href="../../engine/MshCmdlet.cs.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<a href="../../engine/MshCmdlet.cs.html#ac0cb14e542420b6" class="i method">NewScriptBlock</a>(<span class="r50 r">scriptText</span>);
            <span class="r51 r">scriptBlock</span>.<a href="../../engine/runtime/CompiledScriptBlock.cs.html#28f1dfc28a9bfb01" class="i property">DebuggerStepThrough</a> = <b>true</b>;
            <b>return</b> <span class="r51 r">scriptBlock</span>;
        }
 
        <b>private</b> <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <a id="d7a6f69aa3194559" href="../../R/d7a6f69aa3194559.html" target="n" data-glyph="46,1" class="i field">_expressionFactory</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private</b> <a href="FormattingObjectsDeserializer.cs.html#592ef20b2bc0f279" class="t t">FormatObjectDeserializer</a> <a id="b3713aaffdcb200f" href="../../R/b3713aaffdcb200f.html" target="n" data-glyph="46,1" class="i field">_formatObjectDeserializer</a>;
 
        <b>private</b> <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <a id="5f0a3c620d94186c" href="../../R/5f0a3c620d94186c.html" target="n" data-glyph="46,1" class="i field">_typeInfoDataBase</a> = <b>null</b>;
 
        <b>private</b> <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <a id="0a7fe3c4ef78a5d7" href="../../R/0a7fe3c4ef78a5d7.html" target="n" data-glyph="46,1" class="i field">_parameters</a> = <b>null</b>;
        <b>private readonly</b> <a href="FormatViewManager.cs.html#85c6ee82c806ad0f" class="t t">FormatViewManager</a> <a id="ced3a1eb7439220a" href="../../R/ced3a1eb7439220a.html" target="n" data-glyph="46,1" class="i field">_viewManager</a> = <b>new</b> <span class="t">FormatViewManager</span>();
 
        <b>private int</b> <a id="a3dfcc1f490498af" href="../../R/a3dfcc1f490498af.html" target="n" data-glyph="46,1" class="i field">_enumerationLimit</a> = <a href="../../engine/InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../../engine/InitialSessionState.cs.html#4d3f35f31f97da63" class="i field">DefaultFormatEnumerationLimit</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="26a8c60a996abec5" href="../../R/26a8c60a996abec5.html" target="n" data-glyph="0,0" class="t t"><span id="cd2c12d7a098390a">OuterFormatShapeCommandBase</span></a> : <a href="BaseCommand.cs.html#6f1170ef393f015d" class="t t">FrontEndCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Switches
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter to specify the</span>
        <span class="c">///</span><span class="c"> group by property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public object</b> <a id="ca94285f84f64882" href="../../R/ca94285f84f64882.html" target="n" data-glyph="102,1" class="i property">GroupBy</a> { <b>get</b>; <b>set</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b> <a id="9309c1c05de57e36" href="../../R/9309c1c05de57e36.html" target="n" data-glyph="102,1" class="i property">View</a> { <b>get</b>; <b>set</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8f33efab7f2bfbd0" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ShowError</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>.<span class="i">HasValue</span>)
                    <b>return</b> <a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>.<span class="i">Value</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>set</b>
            {
                <a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a> = <b>value</b>;
            }
        }
 
        <b>internal bool</b>? <a id="e554ebbbcd79bde0" href="../../R/e554ebbbcd79bde0.html" target="n" data-glyph="44,1" class="i field">showErrorsAsMessages</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="66198834bb27d74a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">DisplayError</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>.<span class="i">HasValue</span>)
                    <b>return</b> <a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>.<span class="i">Value</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>set</b>
            {
                <a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a> = <b>value</b>;
            }
        }
 
        <b>internal bool</b>? <a id="24b946e9fd0e6eac" href="../../R/24b946e9fd0e6eac.html" target="n" data-glyph="44,1" class="i field">showErrorsInFormattedOutput</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="a08e138204f7e558" href="../../R/a08e138204f7e558.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> { <b>return</b> <a href="#1940e49f3fe47166" class="i field">_forceFormattingAlsoOnOutOfBand</a>; }
 
            <b>set</b> { <a href="#1940e49f3fe47166" class="i field">_forceFormattingAlsoOnOutOfBand</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="1940e49f3fe47166" href="../../R/1940e49f3fe47166.html" target="n" data-glyph="46,1" class="i field">_forceFormattingAlsoOnOutOfBand</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateSet</span>(<a href="DisplayDatabase/commands.cs.html#e9bfff239d124b39" class="t t">EnumerableExpansionConversion</a>.<a href="DisplayDatabase/commands.cs.html#11b99676ea0c5591" class="i field">CoreOnlyString</a>,
                        <a href="DisplayDatabase/commands.cs.html#e9bfff239d124b39" class="t t">EnumerableExpansionConversion</a>.<a href="DisplayDatabase/commands.cs.html#593ca701c4e65663" class="i field">EnumOnlyString</a>,
                        <a href="DisplayDatabase/commands.cs.html#e9bfff239d124b39" class="t t">EnumerableExpansionConversion</a>.<a href="DisplayDatabase/commands.cs.html#5c2038b61da293ae" class="i field">BothString</a>, <a href="../../engine/Attributes.cs.html#90833178fccd6012" class="i property">IgnoreCase</a> = <b>true</b>)]
        <b>public string</b> <a id="e488a242f9c85693" href="../../R/e488a242f9c85693.html" target="n" data-glyph="102,1" class="i property">Expand</a> { <b>get</b>; <b>set</b>; } = <b>null</b>;
 
        <b>internal</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a>? <a id="b880a80a0e590801" href="../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">expansion</a> = <b>null</b>;
 
        <b>internal</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a>? <a id="17f7e17a1d43f365" href="../../R/17f7e17a1d43f365.html" target="n" data-glyph="74,1" class="i method">ProcessExpandParameter</a>()
        {
            <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a>? <span id="r52 rd" class="r52 r">retVal</span> = <b>null</b>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e488a242f9c85693" class="i property">Expand</a>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="DisplayDatabase/displayDescriptionData.cs.html#3f58d980f9d62b33" class="t t">EnumerableExpansion</a> <span id="r53 rd" class="r53 r">temp</span>;
            <b>bool</b> <span id="r54 rd" class="r54 r">success</span> = <a href="DisplayDatabase/commands.cs.html#e9bfff239d124b39" class="t t">EnumerableExpansionConversion</a>.<a href="DisplayDatabase/commands.cs.html#0d999d07647b478e" class="i method">Convert</a>(<a href="#e488a242f9c85693" class="i property">Expand</a>, <b>out</b> <span class="r53 r">temp</span>);
            <b>if</b> (!<span class="r54 r">success</span>)
            {
                <span class="c">// this should never happen, since we use the [ValidateSet] attribute</span>
                <span class="c">// NOTE: this is an exception that should never be triggered</span>
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;Expand&quot;</span>, <span class="i">FormatAndOut_MshParameter</span>.<span class="i">IllegalEnumerableExpansionValue</span>);
            }
 
            <span class="r52 r">retVal</span> = <span class="r53 r">temp</span>;
            <b>return</b> <span class="r52 r">retVal</span>;
        }
 
        <b>internal</b> <a href="Utilities/MshParameter.cs.html#9560e25e37f30aeb" class="t t">MshParameter</a> <a id="3273fcac1f8a125c" href="../../R/3273fcac1f8a125c.html" target="n" data-glyph="74,1" class="i method">ProcessGroupByParameter</a>()
        {
            <b>if</b> (<a href="#ca94285f84f64882" class="i property">GroupBy</a> != <b>null</b>)
            {
                <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r55 rd" class="r55 r">invocationContext</span> =
                        <b>new</b> <a href="BaseCommand.cs.html#581f28e2926055c3" class="t constructor">TerminatingErrorContext</a>(<a href="#26a8c60a996abec5" class="k">this</a>);
                <a href="Utilities/MshParameter.cs.html#a383d14a462356ba" class="t t">ParameterProcessor</a> <span id="r56 rd" class="r56 r">processor</span> = <b>new</b> <a href="Utilities/MshParameter.cs.html#b515869a2dd77ad7" class="t constructor">ParameterProcessor</a>(<b>new</b> <span class="t">FormatGroupByParameterDefinition</span>());
                <span class="i">List</span>&lt;<a href="Utilities/MshParameter.cs.html#9560e25e37f30aeb" class="t t">MshParameter</a>&gt; <span id="r57 rd" class="r57 r">groupParameterList</span> =
                    <span class="r56 r">processor</span>.<a href="Utilities/MshParameter.cs.html#a7cb56173a63995b" class="i method">ProcessParameters</a>(<b>new</b> <b>object</b>[] { <a href="#ca94285f84f64882" class="i property">GroupBy</a> },
                                                <span class="r55 r">invocationContext</span>);
 
                <b>if</b> (<span class="r57 r">groupParameterList</span>.<span class="i">Count</span> != 0)
                    <b>return</b> <span class="r57 r">groupParameterList</span>[0];
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="aad6d3339be02727" href="../../R/aad6d3339be02727.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#b8a16c335363cf07" class="t t">InnerFormatShapeCommand</a> <span id="r58 rd" class="r58 r">innerFormatCommand</span> =
                            (<a href="#b8a16c335363cf07" class="t t">InnerFormatShapeCommand</a>)<a href="#26a8c60a996abec5" class="k">this</a>.<a href="BaseCommand.cs.html#1b0ab4db6b16490a" class="i field">implementation</a>;
 
            <span class="c">// read command line switches and pass them to the inner command</span>
            <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r59 rd" class="r59 r">parameters</span> = <a href="#3149a767c09ebfa6" class="i method">GetCommandLineParameters</a>();
            <span class="r58 r">innerFormatCommand</span>.<a href="#e8fee5d7a94a799c" class="i method">SetCommandLineParameters</a>(<span class="r59 r">parameters</span>);
 
            <span class="c">// must call base class for further processing</span>
            <a href="BaseCommand.cs.html#6f1170ef393f015d" class="k">base</a>.<a href="BaseCommand.cs.html#0203cc0f4a76912c" class="i method">BeginProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It reads the command line switches and collects them into a</span>
        <span class="c">///</span><span class="c"> FormattingCommandLineParameters instance, ready to pass to the</span>
        <span class="c">///</span><span class="c"> inner format command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Parameters collected in unified manner.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <a id="3149a767c09ebfa6" href="../../R/3149a767c09ebfa6.html" target="n" data-glyph="74,1" class="i method">GetCommandLineParameters</a>()
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>internal void</b> <a id="7468c97a5df9f3b1" href="../../R/7468c97a5df9f3b1.html" target="n" data-glyph="74,1" class="i method">ReportCannotSpecifyViewAndProperty</a>()
        {
            <b>string</b> <span id="r60 rd" class="r60 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">CannotSpecifyViewAndPropertyError</span>);
 
            <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r61 rd" class="r61 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(
                <b>new</b> <span class="i">InvalidDataException</span>(),
                <span class="s">&quot;FormatCannotSpecifyViewAndProperty&quot;</span>,
                <a href="../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                <b>null</b>);
 
            <span class="r61 r">errorRecord</span>.<a href="../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r60 r">msg</span>);
            <a href="#26a8c60a996abec5" class="k">this</a>.<a href="../../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r61 r">errorRecord</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="0531203b239b5b99" href="../../R/0531203b239b5b99.html" target="n" data-glyph="0,0" class="t t"><span id="64a6ea1db524dada">OuterFormatTableAndListBase</span></a> : <a href="#26a8c60a996abec5" class="t t">OuterFormatShapeCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Switches
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Positional parameter for properties, property sets and table sets</span>
        <span class="c">///</span><span class="c"> specified on the command line.</span>
        <span class="c">///</span><span class="c"> The parameter is optional, since the defaults</span>
        <span class="c">///</span><span class="c"> will be determined using property sets, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../engine/Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public object</b>[] <a id="83f736677309acdb" href="../../R/83f736677309acdb.html" target="n" data-glyph="102,1" class="i property">Property</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal override</b> <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <a id="1cf7cf8ea705f3d9" href="../../R/1cf7cf8ea705f3d9.html" target="n" data-glyph="74,1" class="i method">GetCommandLineParameters</a>()
        {
            <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r62 rd" class="r62 r">parameters</span> = <b>new</b> <span class="t">FormattingCommandLineParameters</span>();
 
            <a href="#62998820eded3a18" class="i method">GetCommandLineProperties</a>(<span class="r62 r">parameters</span>, <b>false</b>);
            <span class="r62 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#7cf8249f10e75d94" class="i field">groupByParameter</a> = <a href="#0531203b239b5b99" class="k">this</a>.<a href="#3273fcac1f8a125c" class="i method">ProcessGroupByParameter</a>();
 
            <span class="r62 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#695d9ec4dcb21ca5" class="i field">forceFormattingAlsoOnOutOfBand</a> = <a href="#0531203b239b5b99" class="k">this</a>.<a href="#a08e138204f7e558" class="i property">Force</a>;
            <b>if</b> (<a href="#0531203b239b5b99" class="k">this</a>.<a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>.<span class="i">HasValue</span>)
                <span class="r62 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#025f75af7537e666" class="i field">showErrorsAsMessages</a> = <a href="#0531203b239b5b99" class="k">this</a>.<a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>;
            <b>if</b> (<a href="#0531203b239b5b99" class="k">this</a>.<a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>.<span class="i">HasValue</span>)
                <span class="r62 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#8b9bc0b7842c6771" class="i field">showErrorsInFormattedOutput</a> = <a href="#0531203b239b5b99" class="k">this</a>.<a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>;
 
            <span class="r62 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#b73dca96d5343e4c" class="i field">expansion</a> = <a href="#17f7e17a1d43f365" class="i method">ProcessExpandParameter</a>();
 
            <b>return</b> <span class="r62 r">parameters</span>;
        }
 
        <b>internal void</b> <a id="62998820eded3a18" href="../../R/62998820eded3a18.html" target="n" data-glyph="74,1" class="i method">GetCommandLineProperties</a>(<a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r63 rd" class="r63 r">parameters</span>, <b>bool</b> <span id="r64 rd" class="r64 r">isTable</span>)
        {
            <b>if</b> (<a href="#83f736677309acdb" class="i property">Property</a> != <b>null</b>)
            {
                <a href="Utilities/MshParameter.cs.html#9e4f820e338aa2d4" class="t t">CommandParameterDefinition</a> <span id="r65 rd" class="r65 r">def</span>;
 
                <b>if</b> (<span class="r64 r">isTable</span>)
                    <span class="r65 r">def</span> = <b>new</b> <span class="t">FormatTableParameterDefinition</span>();
                <b>else</b>
                    <span class="r65 r">def</span> = <b>new</b> <span class="t">FormatListParameterDefinition</span>();
                <a href="Utilities/MshParameter.cs.html#a383d14a462356ba" class="t t">ParameterProcessor</a> <span id="r66 rd" class="r66 r">processor</span> = <b>new</b> <a href="Utilities/MshParameter.cs.html#b515869a2dd77ad7" class="t constructor">ParameterProcessor</a>(<span class="r65 r">def</span>);
                <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r67 rd" class="r67 r">invocationContext</span> = <b>new</b> <a href="BaseCommand.cs.html#581f28e2926055c3" class="t constructor">TerminatingErrorContext</a>(<a href="#0531203b239b5b99" class="k">this</a>);
 
                <span class="r63 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#76039c18012927ae" class="i field">mshParameterList</a> = <span class="r66 r">processor</span>.<a href="Utilities/MshParameter.cs.html#a7cb56173a63995b" class="i method">ProcessParameters</a>(<a href="#83f736677309acdb" class="i property">Property</a>, <span class="r67 r">invocationContext</span>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#0531203b239b5b99" class="k">this</a>.<a href="#9309c1c05de57e36" class="i property">View</a>))
            {
                <span class="c">// we have a view command line switch</span>
                <b>if</b> (<span class="r63 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#76039c18012927ae" class="i field">mshParameterList</a>.<span class="i">Count</span> != 0)
                {
                    <a href="#7468c97a5df9f3b1" class="i method">ReportCannotSpecifyViewAndProperty</a>();
                }
 
                <span class="r63 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#1a88a5a755966031" class="i field">viewName</a> = <a href="#0531203b239b5b99" class="k">this</a>.<a href="#9309c1c05de57e36" class="i property">View</a>;
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="a492d91d060c6ee8" href="../../R/a492d91d060c6ee8.html" target="n" data-glyph="0,0" class="t t"><span id="1d01e08d14d0ff00">OuterFormatTableBase</span></a> : <a href="#0531203b239b5b99" class="t t">OuterFormatTableAndListBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Switches
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="eb430af28aaadc18" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AutoSize</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#380e30435abab5bc" class="i field">_autosize</a>.<span class="i">HasValue</span>)
                    <b>return</b> <a href="#380e30435abab5bc" class="i field">_autosize</a>.<span class="i">Value</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>set</b>
            {
                <a href="#380e30435abab5bc" class="i field">_autosize</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b>? <a id="380e30435abab5bc" href="../../R/380e30435abab5bc.html" target="n" data-glyph="46,1" class="i field">_autosize</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets if header is repeated per screen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f32721c4568335ad" href="../../R/f32721c4568335ad.html" target="n" data-glyph="102,1" class="i property">RepeatHeader</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="5de8feaa80912771" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HideTableHeaders</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#def3d76820a4d733" class="i field">_hideHeaders</a>.<span class="i">HasValue</span>)
                    <b>return</b> <a href="#def3d76820a4d733" class="i field">_hideHeaders</a>.<span class="i">Value</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>set</b>
            {
                <a href="#def3d76820a4d733" class="i field">_hideHeaders</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b>? <a id="def3d76820a4d733" href="../../R/def3d76820a4d733.html" target="n" data-glyph="46,1" class="i field">_hideHeaders</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional, non positional parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="cb2d16e6d9cb1c16" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Wrap</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#3fc03f01043fe36e" class="i field">_multiLine</a>.<span class="i">HasValue</span>)
                    <b>return</b> <a href="#3fc03f01043fe36e" class="i field">_multiLine</a>.<span class="i">Value</span>;
                <b>return</b> <b>false</b>;
            }
 
            <b>set</b>
            {
                <a href="#3fc03f01043fe36e" class="i field">_multiLine</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b>? <a id="3fc03f01043fe36e" href="../../R/3fc03f01043fe36e.html" target="n" data-glyph="46,1" class="i field">_multiLine</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        <b>internal override</b> <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <a id="1733d4763965a2c2" href="../../R/1733d4763965a2c2.html" target="n" data-glyph="74,1" class="i method">GetCommandLineParameters</a>()
        {
            <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r68 rd" class="r68 r">parameters</span> = <b>new</b> <span class="t">FormattingCommandLineParameters</span>();
 
            <a href="#62998820eded3a18" class="i method">GetCommandLineProperties</a>(<span class="r68 r">parameters</span>, <b>true</b>);
            <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#695d9ec4dcb21ca5" class="i field">forceFormattingAlsoOnOutOfBand</a> = <a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#a08e138204f7e558" class="i property">Force</a>;
            <b>if</b> (<a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>.<span class="i">HasValue</span>)
                <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#025f75af7537e666" class="i field">showErrorsAsMessages</a> = <a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#e554ebbbcd79bde0" class="i field">showErrorsAsMessages</a>;
            <b>if</b> (<a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>.<span class="i">HasValue</span>)
                <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#8b9bc0b7842c6771" class="i field">showErrorsInFormattedOutput</a> = <a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#24b946e9fd0e6eac" class="i field">showErrorsInFormattedOutput</a>;
 
            <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#b73dca96d5343e4c" class="i field">expansion</a> = <a href="#17f7e17a1d43f365" class="i method">ProcessExpandParameter</a>();
 
            <b>if</b> (<a href="#380e30435abab5bc" class="i field">_autosize</a>.<span class="i">HasValue</span>)
                <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#6d591228fabfce17" class="i field">autosize</a> = <a href="#380e30435abab5bc" class="i field">_autosize</a>.<span class="i">Value</span>;
 
            <b>if</b> (<a href="#f32721c4568335ad" class="i property">RepeatHeader</a>)
            {
                <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#70112446dbe5c325" class="i field">repeatHeader</a> = <b>true</b>;
            }
 
            <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#7cf8249f10e75d94" class="i field">groupByParameter</a> = <a href="#a492d91d060c6ee8" class="k">this</a>.<a href="#3273fcac1f8a125c" class="i method">ProcessGroupByParameter</a>();
 
            <a href="BaseFormattingCommandParameters.cs.html#dab7c52a57e30ace" class="t t">TableSpecificParameters</a> <span id="r69 rd" class="r69 r">tableParameters</span> = <b>new</b> <span class="t">TableSpecificParameters</span>();
            <span class="r68 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#33d66bd4e6ba4c6b" class="i field">shapeParameters</a> = <span class="r69 r">tableParameters</span>;
 
            <b>if</b> (<a href="#def3d76820a4d733" class="i field">_hideHeaders</a>.<span class="i">HasValue</span>)
            {
                <span class="r69 r">tableParameters</span>.<a href="BaseFormattingCommandParameters.cs.html#cf1a62fa6419ead8" class="i field">hideHeaders</a> = <a href="#def3d76820a4d733" class="i field">_hideHeaders</a>.<span class="i">Value</span>;
            }
 
            <b>if</b> (<a href="#3fc03f01043fe36e" class="i field">_multiLine</a>.<span class="i">HasValue</span>)
            {
                <span class="r69 r">tableParameters</span>.<a href="BaseFormattingCommandParameters.cs.html#d1fbd247a280d55a" class="i field">multiLine</a> = <a href="#3fc03f01043fe36e" class="i field">_multiLine</a>.<span class="i">Value</span>;
            }
 
            <b>return</b> <span class="r68 r">parameters</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
