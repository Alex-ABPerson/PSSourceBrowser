<!DOCTYPE html>
<html><head><title>MshParameter.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(530);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/Utilities/MshParameter.cs" target="_top">FormatAndOutput\common\Utilities\MshParameter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Normalized parameter class to be constructed from the command line parameters</span>
    <span class="c">///</span><span class="c"> using the metadata information provided by an instance of CommandParameterDefinition</span>
    <span class="c">///</span><span class="c"> it&#39;s basically the hash table with the normalized values.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="9560e25e37f30aeb" href="../../../R/9560e25e37f30aeb.html" target="n" data-glyph="2,0" class="t t"><span id="f6fb3e590432876a">MshParameter</span></a>
    {
        <b>internal</b> <span class="i">Hashtable</span> <a id="5e0ea2473b4e086f" href="../../../R/5e0ea2473b4e086f.html" target="n" data-glyph="44,1" class="i field">hash</a> = <b>null</b>;
 
        <b>internal object</b> <a id="659a68599a5f4ade" href="../../../R/659a68599a5f4ade.html" target="n" data-glyph="74,1" class="i method">GetEntry</a>(<b>string</b> <span id="r0 rd" class="r0 r">key</span>)
        {
            <b>if</b> (<a href="#9560e25e37f30aeb" class="k">this</a>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>.<span class="i">ContainsKey</span>(<span class="r0 r">key</span>))
                <b>return</b> <a href="#9560e25e37f30aeb" class="k">this</a>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>[<span class="r0 r">key</span>];
 
            <b>return</b> <a href="../../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
    }
 
    <b>internal class</b> <a id="133deb8711eb3fc8" href="../../../R/133deb8711eb3fc8.html" target="n" data-glyph="2,0" class="t t">NameEntryDefinition</a> : <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a>
    {
        <b>internal const string</b> <a id="b25c8941f322b3bd" href="../../../R/b25c8941f322b3bd.html" target="n" data-glyph="8,1" class="i field">NameEntryKey</a> = <span class="s">&quot;name&quot;</span>;
 
        <b>internal</b> <a id="b534fdfa7a59c600" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">NameEntryDefinition</a>()
            : <b>base</b>(<a href="#b25c8941f322b3bd" class="i field">NameEntryKey</a>, <b>new</b> <b>string</b>[] { <a href="../BaseFormattingCommandParameters.cs.html#9ef7eadb77e0beb8" class="t t">FormatParameterDefinitionKeys</a>.<a href="../BaseFormattingCommandParameters.cs.html#063f141a7f43b109" class="i field">LabelEntryKey</a> }, <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>) }, <b>false</b>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Metadata base class for hashtable entry definitions</span>
    <span class="c">///</span><span class="c"> it contains the key name and the allowable types</span>
    <span class="c">///</span><span class="c"> it also provides hooks for type expansion.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="1392fe99b3c663c7" href="../../../R/1392fe99b3c663c7.html" target="n" data-glyph="2,0" class="t t">HashtableEntryDefinition</a>
    {
        <b>internal</b> <a id="dd6d550527dc932b" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">HashtableEntryDefinition</a>(<b>string</b> <span id="r1 rd" class="r1 r">name</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r2 rd" class="r2 r">secondaryNames</span>, <span class="i">Type</span>[] <span id="r3 rd" class="r3 r">types</span>, <b>bool</b> <span id="r4 rd" class="r4 r">mandatory</span>)
            : <a href="#eef45c9fcdf9a58d" class="k">this</a>(<span class="r1 r">name</span>, <span class="r3 r">types</span>, <span class="r4 r">mandatory</span>)
        {
            <a href="#70d4315c2d4e0c59" class="i property">SecondaryNames</a> = <span class="r2 r">secondaryNames</span>;
        }
 
        <b>internal</b> <a id="eef45c9fcdf9a58d" href="../../../R/eef45c9fcdf9a58d.html" target="n" data-glyph="74,1" class="t constructor">HashtableEntryDefinition</a>(<b>string</b> <span id="r5 rd" class="r5 r">name</span>, <span class="i">Type</span>[] <span id="r6 rd" class="r6 r">types</span>, <b>bool</b> <span id="r7 rd" class="r7 r">mandatory</span>)
        {
            <a href="#f21fc45c67892847" class="i property">KeyName</a> = <span class="r5 r">name</span>;
            <a href="#13e45024009d614c" class="i property">AllowedTypes</a> = <span class="r6 r">types</span>;
            <a href="#d3e02645d32308b3" class="i property">Mandatory</a> = <span class="r7 r">mandatory</span>;
        }
 
        <b>internal</b> <a id="00fb96cb57e73056" href="../../../R/00fb96cb57e73056.html" target="n" data-glyph="74,1" class="t constructor">HashtableEntryDefinition</a>(<b>string</b> <span id="r8 rd" class="r8 r">name</span>, <span class="i">Type</span>[] <span id="r9 rd" class="r9 r">types</span>)
            : <a href="#eef45c9fcdf9a58d" class="k">this</a>(<span class="r8 r">name</span>, <span class="r9 r">types</span>, <b>false</b>)
        {
        }
 
        <b>internal virtual</b> <span class="i">Hashtable</span> <a id="0ee53f3353eb44d3" href="../../../R/0ee53f3353eb44d3.html" target="n" data-glyph="74,1" class="i method">CreateHashtableFromSingleType</a>(<b>object</b> <span id="r10 rd" class="r10 r">val</span>)
        {
            <span class="c">// NOTE: must override for the default type(s) entry</span>
            <span class="c">// this entry will have to expand the object into a hash table</span>
            <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <b>internal bool</b> <a id="65798aa4ab7b7ad6" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsKeyMatch</a>(<b>string</b> <span id="r11 rd" class="r11 r">key</span>)
        {
            <b>if</b> (<a href="#9e4f820e338aa2d4" class="t t">CommandParameterDefinition</a>.<a href="#b24478c8827fe7cf" class="i method">FindPartialMatch</a>(<span class="r11 r">key</span>, <a href="#1392fe99b3c663c7" class="k">this</a>.<a href="#f21fc45c67892847" class="i property">KeyName</a>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#1392fe99b3c663c7" class="k">this</a>.<a href="#70d4315c2d4e0c59" class="i property">SecondaryNames</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r12 rd" class="r12 r">secondaryKey</span> <b>in</b> <a href="#1392fe99b3c663c7" class="k">this</a>.<a href="#70d4315c2d4e0c59" class="i property">SecondaryNames</a>)
                {
                    <b>if</b> (<a href="#9e4f820e338aa2d4" class="t t">CommandParameterDefinition</a>.<a href="#b24478c8827fe7cf" class="i method">FindPartialMatch</a>(<span class="r11 r">key</span>, <span class="r12 r">secondaryKey</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal virtual object</b> <a id="044913a71797a48c" href="../../../R/044913a71797a48c.html" target="n" data-glyph="74,1" class="i method">Verify</a>(<b>object</b> <span id="r13 rd" class="r13 r">val</span>,
                                        <a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r14 rd" class="r14 r">invocationContext</span>,
                                        <b>bool</b> <span id="r15 rd" class="r15 r">originalParameterWasHashTable</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>internal virtual object</b> <a id="7abc750374ea07c6" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ComputeDefaultValue</a>()
        {
            <b>return</b> <a href="../../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <b>internal string</b> <a id="f21fc45c67892847" href="../../../R/f21fc45c67892847.html" target="n" data-glyph="104,1" class="i property">KeyName</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Type</span>[] <a id="13e45024009d614c" href="../../../R/13e45024009d614c.html" target="n" data-glyph="104,1" class="i property">AllowedTypes</a> { <b>get</b>; }
 
        <b>internal bool</b> <a id="d3e02645d32308b3" href="../../../R/d3e02645d32308b3.html" target="n" data-glyph="104,1" class="i property">Mandatory</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="70d4315c2d4e0c59" href="../../../R/70d4315c2d4e0c59.html" target="n" data-glyph="104,1" class="i property">SecondaryNames</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Metadata abstract base class to contain hash entries definitions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="9e4f820e338aa2d4" href="../../../R/9e4f820e338aa2d4.html" target="n" data-glyph="2,0" class="t t">CommandParameterDefinition</a>
    {
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2214:DoNotCallOverridableMethodsInConstructors&quot;</span>)]
        <b>internal</b> <a id="f04e161083708387" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CommandParameterDefinition</a>()
        {
            <a href="#7f1d12c06194c25e" class="i method">SetEntries</a>();
        }
 
        <b>protected abstract void</b> <a id="7f1d12c06194c25e" href="../../../R/7f1d12c06194c25e.html" target="n" data-glyph="75,1" class="i method">SetEntries</a>();
 
        <b>internal virtual</b> <a href="#9560e25e37f30aeb" class="t t">MshParameter</a> <a id="c1375c38b912c0e0" href="../../../R/c1375c38b912c0e0.html" target="n" data-glyph="74,1" class="i method">CreateInstance</a>() { <b>return</b> <b>new</b> <span class="t">MshParameter</span>(); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For a key name, verify it is a legal entry:</span>
        <span class="c">///</span><span class="c">     1. it must match (partial match allowed)</span>
        <span class="c">///</span><span class="c">     2. it must be unambiguous (if partial match)</span>
        <span class="c">///</span><span class="c"> If an error condition occurs, an exception will be thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">keyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">invocationContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation context for error reporting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Matching hash table entry.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a> <a id="d0b82ea8adbb7a03" href="../../../R/d0b82ea8adbb7a03.html" target="n" data-glyph="74,1" class="i method">MatchEntry</a>(<b>string</b> <span id="r16 rd" class="r16 r">keyName</span>, <a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r17 rd" class="r17 r">invocationContext</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r16 r">keyName</span>))
                <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r16 r">keyName</span>));
 
            <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a> <span id="r18 rd" class="r18 r">matchingEntry</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r19 rd" class="r19 r">k</span> = 0; <span class="r19 r">k</span> &lt; <a href="#9e4f820e338aa2d4" class="k">this</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>.<span class="i">Count</span>; <span class="r19 r">k</span>++)
            {
                <b>if</b> (<a href="#9e4f820e338aa2d4" class="k">this</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r19 r">k</span>].<span class="i">IsKeyMatch</span>(<span class="r16 r">keyName</span>))
                {
                    <span class="c">// we have a match</span>
                    <b>if</b> (<span class="r18 r">matchingEntry</span> == <b>null</b>)
                    {
                        <span class="c">// this is the first match, we save the entry</span>
                        <span class="c">// and we keep going for ambiguity check</span>
                        <span class="r18 r">matchingEntry</span> = <a href="#9e4f820e338aa2d4" class="k">this</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r19 r">k</span>];
                    }
                    <b>else</b>
                    {
                        <span class="c">// we already had a match, we have an ambiguous key</span>
                        <span class="i">ProcessAmbiguousKey</span>(<span class="r17 r">invocationContext</span>, <span class="r16 r">keyName</span>, <span class="r18 r">matchingEntry</span>, <a href="#9e4f820e338aa2d4" class="k">this</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r19 r">k</span>]);
                    }
                }
            }
 
            <b>if</b> (<span class="r18 r">matchingEntry</span> != <b>null</b>)
            {
                <span class="c">// we found an unambiguous match</span>
                <b>return</b> <span class="r18 r">matchingEntry</span>;
            }
            <span class="c">// we did not have a match</span>
            <a href="#4e96a71709d089b7" class="i method">ProcessIllegalKey</a>(<span class="r17 r">invocationContext</span>, <span class="r16 r">keyName</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static bool</b> <a id="b24478c8827fe7cf" href="../../../R/b24478c8827fe7cf.html" target="n" data-glyph="74,1" class="i method">FindPartialMatch</a>(<b>string</b> <span id="r20 rd" class="r20 r">key</span>, <b>string</b> <span id="r21 rd" class="r21 r">normalizedKey</span>)
        {
            <b>if</b> (<span class="r20 r">key</span>.<span class="i">Length</span> &lt; <span class="r21 r">normalizedKey</span>.<span class="i">Length</span>)
            {
                <span class="c">// shorter, could be an abbreviation</span>
                <b>if</b> (<span class="r20 r">key</span>.<span class="i">AsSpan</span>().<span class="i">Equals</span>(<span class="r21 r">normalizedKey</span>.<span class="i">AsSpan</span>(0, <span class="r20 r">key</span>.<span class="i">Length</span>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// found abbreviation</span>
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r20 r">key</span>, <span class="r21 r">normalizedKey</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// found full match</span>
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error Processing
 
        <b>private static void</b> <a id="8bdb043fcbb8e010" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessAmbiguousKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r22 rd" class="r22 r">invocationContext</span>,
                                            <b>string</b> <span id="r23 rd" class="r23 r">keyName</span>,
                                            <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a> <span id="r24 rd" class="r24 r">matchingEntry</span>,
                                            <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a> <span id="r25 rd" class="r25 r">currentEntry</span>)
        {
            <b>string</b> <span id="r26 rd" class="r26 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">AmbiguousKeyError</span>,
                <span class="r23 r">keyName</span>, <span class="r24 r">matchingEntry</span>.<a href="#f21fc45c67892847" class="i property">KeyName</a>, <span class="r25 r">currentEntry</span>.<a href="#f21fc45c67892847" class="i property">KeyName</a>);
 
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r22 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyAmbiguous&quot;</span>, <span class="r26 r">msg</span>);
        }
 
        <b>private static void</b> <a id="4e96a71709d089b7" href="../../../R/4e96a71709d089b7.html" target="n" data-glyph="76,1" class="i method">ProcessIllegalKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r27 rd" class="r27 r">invocationContext</span>,
                                            <b>string</b> <span id="r28 rd" class="r28 r">keyName</span>)
        {
            <b>string</b> <span id="r29 rd" class="r29 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">IllegalKeyError</span>, <span class="r28 r">keyName</span>);
 
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r27 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyIllegal&quot;</span>, <span class="r29 r">msg</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a>&gt; <a id="a6ab54dfe5530d74" href="../../../R/a6ab54dfe5530d74.html" target="n" data-glyph="44,1" class="i field">hashEntries</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a>&gt;();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Engine to process a generic object[] from the command line and</span>
    <span class="c">///</span><span class="c"> generate a list of MshParameter objects , given the metadata provided by</span>
    <span class="c">///</span><span class="c"> a class derived from CommandParameterDefinition.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="a383d14a462356ba" href="../../../R/a383d14a462356ba.html" target="n" data-glyph="2,0" class="t t">ParameterProcessor</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
        [<span class="i">TraceSource</span>(<span class="s">&quot;ParameterProcessor&quot;</span>, <span class="s">&quot;ParameterProcessor&quot;</span>)]
        <b>internal static readonly</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="b7af2d06b516f399" href="../../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">tracer</a> = <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;ParameterProcessor&quot;</span>, <span class="s">&quot;ParameterProcessor&quot;</span>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
 
        <b>internal static void</b> <a id="3d60110670c1968c" href="../../../R/3d60110670c1968c.html" target="n" data-glyph="74,1" class="i method">ThrowParameterBindingException</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r30 rd" class="r30 r">invocationContext</span>,
                                                            <b>string</b> <span id="r31 rd" class="r31 r">errorId</span>,
                                                            <b>string</b> <span id="r32 rd" class="r32 r">msg</span>)
        {
            <a href="../../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r33 rd" class="r33 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(
                                <b>new</b> <span class="i">NotSupportedException</span>(),
                                <span class="r31 r">errorId</span>,
                                <a href="../../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <b>null</b>);
 
            <span class="r33 r">errorRecord</span>.<a href="../../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r32 r">msg</span>);
            <span class="r30 r">invocationContext</span>.<a href="../BaseCommand.cs.html#293390b36cb4485f" class="i method">ThrowTerminatingError</a>(<span class="r33 r">errorRecord</span>);
        }
 
        <b>internal</b> <a id="b515869a2dd77ad7" href="../../../R/b515869a2dd77ad7.html" target="n" data-glyph="74,1" class="t constructor">ParameterProcessor</a>(<a href="#9e4f820e338aa2d4" class="t t">CommandParameterDefinition</a> <span id="r34 rd" class="r34 r">p</span>)
        {
            <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a> = <span class="r34 r">p</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#9560e25e37f30aeb" class="t t">MshParameter</a>&gt; <a id="a7cb56173a63995b" href="../../../R/a7cb56173a63995b.html" target="n" data-glyph="74,1" class="i method">ProcessParameters</a>(<b>object</b>[] <span id="r35 rd" class="r35 r">p</span>, <a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r36 rd" class="r36 r">invocationContext</span>)
        {
            <b>if</b> (<span class="r35 r">p</span> == <b>null</b> || <span class="r35 r">p</span>.<span class="i">Length</span> == 0)
                <b>return</b> <b>null</b>;
 
            <span class="i">List</span>&lt;<a href="#9560e25e37f30aeb" class="t t">MshParameter</a>&gt; <span id="r37 rd" class="r37 r">retVal</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#9560e25e37f30aeb" class="t t">MshParameter</a>&gt;();
            <a href="#9560e25e37f30aeb" class="t t">MshParameter</a> <span id="r38 rd" class="r38 r">currParam</span>;
 
            <b>bool</b> <span id="r39 rd" class="r39 r">originalParameterWasHashTable</span> = <b>false</b>;
            <b>for</b> (<b>int</b> <span id="r40 rd" class="r40 r">k</span> = 0; <span class="r40 r">k</span> &lt; <span class="r35 r">p</span>.<span class="i">Length</span>; <span class="r40 r">k</span>++)
            {
                <span class="c">// we always copy into a fresh hash table</span>
                <span class="r38 r">currParam</span> = <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#c1375c38b912c0e0" class="i method">CreateInstance</a>();
                <b>var</b> <span id="r41 rd" class="r41 r">actualObject</span> = <a href="../../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../engine/MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r35 r">p</span>[<span class="r40 r">k</span>]);
                <b>if</b> (<span class="r41 r">actualObject</span> <b>is</b> <span class="i">IDictionary</span>)
                {
                    <span class="r39 r">originalParameterWasHashTable</span> = <b>true</b>;
                    <span class="r38 r">currParam</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a> = <a href="#9c1a1b1060cd5cb7" class="i method">VerifyHashTable</a>((<span class="i">IDictionary</span>)<span class="r41 r">actualObject</span>, <span class="r36 r">invocationContext</span>);
                }
                <b>else</b> <b>if</b> ((<span class="r41 r">actualObject</span> != <b>null</b>) &amp;&amp; <span class="i">MatchesAllowedTypes</span>(<span class="r41 r">actualObject</span>.<span class="i">GetType</span>(), <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[0].<span class="i">AllowedTypes</span>))
                {
                    <span class="c">// a simple type was specified, build a hash with one entry</span>
                    <span class="r38 r">currParam</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a> = <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[0].<span class="i">CreateHashtableFromSingleType</span>(<span class="r41 r">actualObject</span>);
                }
                <b>else</b>
                {
                    <span class="c">// unknown type, error</span>
                    <span class="c">// provide error message (the user did not enter a hash table)</span>
                    <span class="i">ProcessUnknownParameterType</span>(<span class="r36 r">invocationContext</span>, <span class="r41 r">actualObject</span>, <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[0].<span class="i">AllowedTypes</span>);
                }
 
                <span class="c">// value range validation and post processing on the hash table</span>
                <a href="#74a3cf0194b4e771" class="i method">VerifyAndNormalizeParameter</a>(<span class="r38 r">currParam</span>, <span class="r36 r">invocationContext</span>, <span class="r39 r">originalParameterWasHashTable</span>);
                <span class="r37 r">retVal</span>.<span class="i">Add</span>(<span class="r38 r">currParam</span>);
            }
 
            <b>return</b> <span class="r37 r">retVal</span>;
        }
 
        <b>private static bool</b> <a id="7efa687b56f709b5" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">MatchesAllowedTypes</a>(<span class="i">Type</span> <span id="r42 rd" class="r42 r">t</span>, <span class="i">Type</span>[] <span id="r43 rd" class="r43 r">allowedTypes</span>)
        {
            <b>for</b> (<b>int</b> <span id="r44 rd" class="r44 r">k</span> = 0; <span class="r44 r">k</span> &lt; <span class="r43 r">allowedTypes</span>.<span class="i">Length</span>; <span class="r44 r">k</span>++)
            {
                <b>if</b> (<span class="r43 r">allowedTypes</span>[<span class="r44 r">k</span>].<span class="i">IsAssignableFrom</span>(<span class="r42 r">t</span>))
                    <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Hashtable</span> <a id="9c1a1b1060cd5cb7" href="../../../R/9c1a1b1060cd5cb7.html" target="n" data-glyph="76,1" class="i method">VerifyHashTable</a>(<span class="i">IDictionary</span> <span id="r45 rd" class="r45 r">hash</span>, <a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r46 rd" class="r46 r">invocationContext</span>)
        {
            <span class="c">// full blown hash, need to:</span>
            <span class="c">// 1. verify names(keys) and expand names if there are partial matches</span>
            <span class="c">// 2. verify value types</span>
            <span class="i">Hashtable</span> <span id="r47 rd" class="r47 r">retVal</span> = <b>new</b> <span class="i">Hashtable</span>();
 
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r48 rd" class="r48 r">e</span> <b>in</b> <span class="r45 r">hash</span>)
            {
                <b>if</b> (<span class="r48 r">e</span>.<span class="i">Key</span> == <b>null</b>)
                {
                    <a href="#a91029609e961acd" class="i method">ProcessNullHashTableKey</a>(<span class="r46 r">invocationContext</span>);
                }
 
                <b>string</b> <span id="r49 rd" class="r49 r">currentStringKey</span> = <span class="r48 r">e</span>.<span class="i">Key</span> <b>as string</b>;
                <b>if</b> (<span class="r49 r">currentStringKey</span> == <b>null</b>)
                {
                    <span class="i">ProcessNonStringHashTableKey</span>(<span class="r46 r">invocationContext</span>, <span class="r48 r">e</span>.<span class="i">Key</span>);
                }
 
                <span class="c">// find a match for the key</span>
                <a href="#1392fe99b3c663c7" class="t t">HashtableEntryDefinition</a> <span id="r50 rd" class="r50 r">def</span> = <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#d0b82ea8adbb7a03" class="i method">MatchEntry</a>(<span class="r49 r">currentStringKey</span>, <span class="r46 r">invocationContext</span>);
                <b>if</b> (<span class="r47 r">retVal</span>.<span class="i">Contains</span>(<span class="r50 r">def</span>.<a href="#f21fc45c67892847" class="i property">KeyName</a>))
                {
                    <span class="c">// duplicate key error</span>
                    <a href="#c0f2c991e215493f" class="i method">ProcessDuplicateHashTableKey</a>(<span class="r46 r">invocationContext</span>, <span class="r49 r">currentStringKey</span>, <span class="r50 r">def</span>.<a href="#f21fc45c67892847" class="i property">KeyName</a>);
                }
 
                <span class="c">// now the key is verified, need to check the type</span>
                <b>bool</b> <span id="r51 rd" class="r51 r">matchType</span> = <b>false</b>;
 
                <b>if</b> (<span class="r50 r">def</span>.<a href="#13e45024009d614c" class="i property">AllowedTypes</a> == <b>null</b> || <span class="r50 r">def</span>.<a href="#13e45024009d614c" class="i property">AllowedTypes</a>.<span class="i">Length</span> == 0)
                {
                    <span class="c">// we match on any type, it will be up to the entry to further check</span>
                    <span class="r51 r">matchType</span> = <b>true</b>;
                }
                <b>else</b>
                {
                    <b>for</b> (<b>int</b> <span id="r52 rd" class="r52 r">t</span> = 0; <span class="r52 r">t</span> &lt; <span class="r50 r">def</span>.<a href="#13e45024009d614c" class="i property">AllowedTypes</a>.<span class="i">Length</span>; <span class="r52 r">t</span>++)
                    {
                        <b>if</b> (<span class="r48 r">e</span>.<span class="i">Value</span> == <b>null</b>)
                        {
                            <a href="#954fbcac275901cb" class="i method">ProcessMissingKeyValue</a>(<span class="r46 r">invocationContext</span>, <span class="r49 r">currentStringKey</span>);
                        }
 
                        <b>if</b> (<span class="r50 r">def</span>.<a href="#13e45024009d614c" class="i property">AllowedTypes</a>[<span class="r52 r">t</span>].<span class="i">IsAssignableFrom</span>(<span class="r48 r">e</span>.<span class="i">Value</span>.<span class="i">GetType</span>()))
                        {
                            <span class="r51 r">matchType</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (!<span class="r51 r">matchType</span>)
                {
                    <span class="c">// bad type error</span>
                    <span class="i">ProcessIllegalHashTableKeyValue</span>(<span class="r46 r">invocationContext</span>, <span class="r49 r">currentStringKey</span>, <span class="r48 r">e</span>.<span class="i">Value</span>.<span class="i">GetType</span>(), <span class="r50 r">def</span>.<a href="#13e45024009d614c" class="i property">AllowedTypes</a>);
                }
 
                <span class="r47 r">retVal</span>.<span class="i">Add</span>(<span class="r50 r">def</span>.<a href="#f21fc45c67892847" class="i property">KeyName</a>, <span class="r48 r">e</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <span class="r47 r">retVal</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="74a3cf0194b4e771" href="../../../R/74a3cf0194b4e771.html" target="n" data-glyph="76,1" class="i method">VerifyAndNormalizeParameter</a>(<a href="#9560e25e37f30aeb" class="t t">MshParameter</a> <span id="r53 rd" class="r53 r">parameter</span>,
                                                    <a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r54 rd" class="r54 r">invocationContext</span>,
                                                    <b>bool</b> <span id="r55 rd" class="r55 r">originalParameterWasHashTable</span>)
        {
            <b>for</b> (<b>int</b> <span id="r56 rd" class="r56 r">k</span> = 0; <span class="r56 r">k</span> &lt; <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>.<span class="i">Count</span>; <span class="r56 r">k</span>++)
            {
                <b>if</b> (<span class="r53 r">parameter</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>.<span class="i">ContainsKey</span>(<a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">KeyName</span>))
                {
                    <span class="c">// we have a key, just do some post processing normalization</span>
                    <span class="c">// retrieve the value</span>
                    <b>object</b> <span id="r57 rd" class="r57 r">val</span> = <span class="r53 r">parameter</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>[<a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">KeyName</span>];
                    <b>object</b> <span id="r58 rd" class="r58 r">newVal</span> = <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">Verify</span>(<span class="r57 r">val</span>, <span class="r54 r">invocationContext</span>, <span class="r55 r">originalParameterWasHashTable</span>);
 
                    <b>if</b> (<span class="r58 r">newVal</span> != <b>null</b>)
                    {
                        <span class="c">// if a new value is provided, we need to update the hash entry</span>
                        <span class="r53 r">parameter</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>[<a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">KeyName</span>] = <span class="r58 r">newVal</span>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// we do not have the key, we might want to have a default value</span>
                    <b>object</b> <span id="r59 rd" class="r59 r">defaultValue</span> = <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">ComputeDefaultValue</span>();
 
                    <b>if</b> (<span class="r59 r">defaultValue</span> != <a href="../../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                    {
                        <span class="c">// we have a default value, add it</span>
                        <span class="r53 r">parameter</span>.<a href="#5e0ea2473b4e086f" class="i field">hash</a>[<a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">KeyName</span>] = <span class="r59 r">defaultValue</span>;
                    }
                    <b>else</b> <b>if</b> (<a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">Mandatory</span>)
                    {
                        <span class="c">// no default value and mandatory: we cannot proceed</span>
                        <span class="i">ProcessMissingMandatoryKey</span>(<span class="r54 r">invocationContext</span>, <a href="#4c01d67bda2b6c8a" class="i field">_paramDef</a>.<a href="#a6ab54dfe5530d74" class="i field">hashEntries</a>[<span class="r56 r">k</span>].<span class="i">KeyName</span>);
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error Processing
 
        <b>private static void</b> <a id="5b802784df99bebf" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessUnknownParameterType</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r60 rd" class="r60 r">invocationContext</span>, <b>object</b> <span id="r61 rd" class="r61 r">actualObject</span>, <span class="i">Type</span>[] <span id="r62 rd" class="r62 r">allowedTypes</span>)
        {
            <b>string</b> <span id="r63 rd" class="r63 r">allowedTypesList</span> = <a href="#cad4583e582053f6" class="i method">CatenateTypeArray</a>(<span class="r62 r">allowedTypes</span>);
            <b>string</b> <span id="r64 rd" class="r64 r">msg</span>;
 
            <b>if</b> (<span class="r61 r">actualObject</span> != <b>null</b>)
            {
                <span class="r64 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">UnknownParameterTypeError</span>,
                    <span class="r61 r">actualObject</span>.<span class="i">GetType</span>().<span class="i">FullName</span>, <span class="r63 r">allowedTypesList</span>);
            }
            <b>else</b>
            {
                <span class="r64 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">NullParameterTypeError</span>,
                    <span class="r63 r">allowedTypesList</span>);
            }
 
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r60 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyUnknownType&quot;</span>, <span class="r64 r">msg</span>);
        }
 
        <b>private static void</b> <a id="c0f2c991e215493f" href="../../../R/c0f2c991e215493f.html" target="n" data-glyph="76,1" class="i method">ProcessDuplicateHashTableKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r65 rd" class="r65 r">invocationContext</span>, <b>string</b> <span id="r66 rd" class="r66 r">duplicateKey</span>, <b>string</b> <span id="r67 rd" class="r67 r">existingKey</span>)
        {
            <b>string</b> <span id="r68 rd" class="r68 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">DuplicateKeyError</span>,
                           <span class="r66 r">duplicateKey</span>, <span class="r67 r">existingKey</span>);
 
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r65 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyDuplicate&quot;</span>, <span class="r68 r">msg</span>);
        }
 
        <b>private static void</b> <a id="a91029609e961acd" href="../../../R/a91029609e961acd.html" target="n" data-glyph="76,1" class="i method">ProcessNullHashTableKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r69 rd" class="r69 r">invocationContext</span>)
        {
            <b>string</b> <span id="r70 rd" class="r70 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">DictionaryKeyNullError</span>);
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r69 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyNull&quot;</span>, <span class="r70 r">msg</span>);
        }
 
        <b>private static void</b> <a id="01dde5997cd349d4" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessNonStringHashTableKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r71 rd" class="r71 r">invocationContext</span>, <b>object</b> <span id="r72 rd" class="r72 r">key</span>)
        {
            <b>string</b> <span id="r73 rd" class="r73 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">DictionaryKeyNonStringError</span>, <span class="r72 r">key</span>.<span class="i">GetType</span>().<span class="i">Name</span>);
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r71 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyNonString&quot;</span>, <span class="r73 r">msg</span>);
        }
 
        <b>private static void</b> <a id="b0ab667908abd05f" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessIllegalHashTableKeyValue</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r74 rd" class="r74 r">invocationContext</span>, <b>string</b> <span id="r75 rd" class="r75 r">key</span>, <span class="i">Type</span> <span id="r76 rd" class="r76 r">actualType</span>, <span class="i">Type</span>[] <span id="r77 rd" class="r77 r">allowedTypes</span>)
        {
            <b>string</b> <span id="r78 rd" class="r78 r">msg</span>;
            <b>string</b> <span id="r79 rd" class="r79 r">errorID</span>;
            <b>if</b> (<span class="r77 r">allowedTypes</span>.<span class="i">Length</span> &gt; 1)
            {
                <b>string</b> <span id="r80 rd" class="r80 r">legalTypes</span> = <a href="#cad4583e582053f6" class="i method">CatenateTypeArray</a>(<span class="r77 r">allowedTypes</span>);
 
                <span class="r78 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">IllegalTypeMultiError</span>,
                    <span class="r75 r">key</span>,
                    <span class="r76 r">actualType</span>.<span class="i">FullName</span>,
                    <span class="r80 r">legalTypes</span>
                    );
 
                <span class="r79 r">errorID</span> = <span class="s">&quot;DictionaryKeyIllegalValue1&quot;</span>;
            }
            <b>else</b>
            {
                <span class="r78 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">IllegalTypeSingleError</span>,
                    <span class="r75 r">key</span>,
                    <span class="r76 r">actualType</span>.<span class="i">FullName</span>,
                    <span class="r77 r">allowedTypes</span>[0]
                    );
 
                <span class="r79 r">errorID</span> = <span class="s">&quot;DictionaryKeyIllegalValue2&quot;</span>;
            }
 
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r74 r">invocationContext</span>, <span class="r79 r">errorID</span>, <span class="r78 r">msg</span>);
        }
 
        <b>private static void</b> <a id="954fbcac275901cb" href="../../../R/954fbcac275901cb.html" target="n" data-glyph="76,1" class="i method">ProcessMissingKeyValue</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r81 rd" class="r81 r">invocationContext</span>, <b>string</b> <span id="r82 rd" class="r82 r">keyName</span>)
        {
            <b>string</b> <span id="r83 rd" class="r83 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">MissingKeyValueError</span>, <span class="r82 r">keyName</span>);
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r81 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyMissingValue&quot;</span>, <span class="r83 r">msg</span>);
        }
 
        <b>private static void</b> <a id="d899689d03f5d5f9" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessMissingMandatoryKey</a>(<a href="../BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r84 rd" class="r84 r">invocationContext</span>, <b>string</b> <span id="r85 rd" class="r85 r">keyName</span>)
        {
            <b>string</b> <span id="r86 rd" class="r86 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_MshParameter</span>.<span class="i">MissingKeyMandatoryEntryError</span>, <span class="r85 r">keyName</span>);
            <a href="#a383d14a462356ba" class="t t">ParameterProcessor</a>.<a href="#3d60110670c1968c" class="i method">ThrowParameterBindingException</a>(<span class="r84 r">invocationContext</span>, <span class="s">&quot;DictionaryKeyMandatoryEntry&quot;</span>, <span class="r86 r">msg</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Utilities
 
        <b>private static string</b> <a id="cad4583e582053f6" href="../../../R/cad4583e582053f6.html" target="n" data-glyph="76,1" class="i method">CatenateTypeArray</a>(<span class="i">Type</span>[] <span id="r87 rd" class="r87 r">arr</span>)
        {
            <b>string</b>[] <span id="r88 rd" class="r88 r">strings</span> = <b>new</b> <b>string</b>[<span class="r87 r">arr</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r89 rd" class="r89 r">k</span> = 0; <span class="r89 r">k</span> &lt; <span class="r87 r">arr</span>.<span class="i">Length</span>; <span class="r89 r">k</span>++)
            {
                <span class="r88 r">strings</span>[<span class="r89 r">k</span>] = <span class="r87 r">arr</span>[<span class="r89 r">k</span>].<span class="i">FullName</span>;
            }
 
            <b>return</b> <a href="#9c316777487fb386" class="i method">CatenateStringArray</a>(<span class="r88 r">strings</span>);
        }
 
        <b>internal static string</b> <a id="9c316777487fb386" href="../../../R/9c316777487fb386.html" target="n" data-glyph="74,1" class="i method">CatenateStringArray</a>(<b>string</b>[] <span id="r90 rd" class="r90 r">arr</span>)
        {
            <span class="i">StringBuilder</span> <span id="r91 rd" class="r91 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="r91 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;{&#39;</span>);
            <b>for</b> (<b>int</b> <span id="r92 rd" class="r92 r">k</span> = 0; <span class="r92 r">k</span> &lt; <span class="r90 r">arr</span>.<span class="i">Length</span>; <span class="r92 r">k</span>++)
            {
                <b>if</b> (<span class="r92 r">k</span> &gt; 0)
                {
                    <span class="r91 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                }
 
                <span class="r91 r">sb</span>.<span class="i">Append</span>(<span class="r90 r">arr</span>[<span class="r92 r">k</span>]);
            }
 
            <span class="r91 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
            <b>return</b> <span class="r91 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private readonly</b> <a href="#9e4f820e338aa2d4" class="t t">CommandParameterDefinition</a> <a id="4c01d67bda2b6c8a" href="../../../R/4c01d67bda2b6c8a.html" target="n" data-glyph="46,1" class="i field">_paramDef</a> = <b>null</b>;
    }
}
</pre></td></tr></table></div></body></html>
