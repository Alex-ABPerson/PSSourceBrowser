<!DOCTYPE html>
<html><head><title>TableWriter.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(649);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/TableWriter.cs" target="_top">FormatAndOutput\common\TableWriter.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <b>internal class</b> <a id="719f009e44c059f3" href="../../R/719f009e44c059f3.html" target="n" data-glyph="2,0" class="t t"><span id="1daf7edc530594b8">TableWriter</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Information about each column boundaries.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="5a751f84c69a7ce5" href="../../R/5a751f84c69a7ce5.html" target="n" data-glyph="4,1" class="t t"><span id="a103acf3eeb17bee">ColumnInfo</span></a>
        {
            <b>internal int</b> <a id="df15716318ff3977" href="../../R/df15716318ff3977.html" target="n" data-glyph="44,2" class="i field">startCol</a> = 0;
            <b>internal int</b> <a id="4bf6df601c84f507" href="../../R/4bf6df601c84f507.html" target="n" data-glyph="44,2" class="i field">width</a> = 0;
            <b>internal int</b> <a id="8ee16560db679ee2" href="../../R/8ee16560db679ee2.html" target="n" data-glyph="44,2" class="i field">alignment</a> = <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#7c93eb74c2450823" class="i field">Left</a>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class containing information about the tabular layout.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="54bb149c0feea7e0" href="../../R/54bb149c0feea7e0.html" target="n" data-glyph="4,1" class="t t"><span id="8aa1d033e282971f">ScreenInfo</span></a>
        {
            <b>internal int</b> <a id="7a3eb1d059018f6d" href="../../R/7a3eb1d059018f6d.html" target="n" data-glyph="44,2" class="i field">screenColumns</a> = 0;
            <b>internal int</b> <a id="e29b10e744a77621" href="../../R/e29b10e744a77621.html" target="n" data-glyph="44,2" class="i field">screenRows</a> = 0;
 
            <b>internal const int</b> <a id="c77181968d9b01f5" href="../../R/c77181968d9b01f5.html" target="n" data-glyph="8,2" class="i field">separatorCharacterCount</a> = 1;
 
            <b>internal const int</b> <a id="9e1509f09e26ba1a" href="../../R/9e1509f09e26ba1a.html" target="n" data-glyph="8,2" class="i field">minimumScreenColumns</a> = 5;
 
            <b>internal const int</b> <a id="fcd1cdff631bd323" href="../../R/fcd1cdff631bd323.html" target="n" data-glyph="8,2" class="i field">minimumColumnWidth</a> = 1;
 
            <b>internal</b> <a href="#5a751f84c69a7ce5" class="t t">ColumnInfo</a>[] <a id="df031ae2b3ccccf8" href="../../R/df031ae2b3ccccf8.html" target="n" data-glyph="44,2" class="i field">columnInfo</a> = <b>null</b>;
        }
 
        <b>private</b> <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a> <a id="4ed2960ea60aebd3" href="../../R/4ed2960ea60aebd3.html" target="n" data-glyph="46,1" class="i field">_si</a>;
 
        <b>private const char</b> <a id="2396d36748e2b7ec" href="../../R/2396d36748e2b7ec.html" target="n" data-glyph="10,1" class="i field">ESC</a> = <span class="s">&#39;\u001b&#39;</span>;
 
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="2974fa3c0ec5fb68" href="../../R/2974fa3c0ec5fb68.html" target="n" data-glyph="46,1" class="i field">_header</a>;
 
        <b>internal static int</b> <a id="bee0f990e519c83c" href="../../R/bee0f990e519c83c.html" target="n" data-glyph="74,1" class="i method">ComputeWideViewBestItemsPerRowFit</a>(<b>int</b> <span id="r0 rd" class="r0 r">stringLen</span>, <b>int</b> <span id="r1 rd" class="r1 r">screenColumns</span>)
        {
            <b>if</b> (<span class="r0 r">stringLen</span> &lt;= 0 || <span class="r1 r">screenColumns</span> &lt; 1)
                <b>return</b> 1;
 
            <b>if</b> (<span class="r0 r">stringLen</span> &gt;= <span class="r1 r">screenColumns</span>)
            {
                <span class="c">// we too wide anyways, we might have to trim even for a single column</span>
                <b>return</b> 1;
            }
 
            <span class="c">// we try to fit more than one: start increasing until we do not fit anymore</span>
            <b>int</b> <span id="r2 rd" class="r2 r">columnNumber</span> = 1;
            <b>while</b> (<b>true</b>)
            {
                <span class="c">// would we fit with one more column?</span>
                <b>int</b> <span id="r3 rd" class="r3 r">nextValue</span> = <span class="r2 r">columnNumber</span> + 1;
                <span class="c">// compute the width if we added the extra column</span>
                <b>int</b> <span id="r4 rd" class="r4 r">width</span> = <span class="r0 r">stringLen</span> * <span class="r3 r">nextValue</span> + (<span class="r3 r">nextValue</span> - 1) * <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>;
 
                <b>if</b> (<span class="r4 r">width</span> &gt;= <span class="r1 r">screenColumns</span>)
                {
                    <span class="c">// we would not fit, so we are done</span>
                    <b>return</b> <span class="r2 r">columnNumber</span>;
                }
 
                <span class="c">// try another round</span>
                <span class="r2 r">columnNumber</span>++;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the table specifying the width of each column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">leftMarginIndent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Left margin indentation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">screenColumns</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Number of character columns on the screen.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">columnWidths</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of specified column widths.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">alignment</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of alignment flags.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">suppressHeader</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, suppress header printing.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">screenRows</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Number of rows on the screen.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b223a0b4dea5b0e7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<b>int</b> <span id="r5 rd" class="r5 r">leftMarginIndent</span>, <b>int</b> <span id="r6 rd" class="r6 r">screenColumns</span>, <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r7 rd" class="r7 r">columnWidths</span>, <span class="i">ReadOnlySpan</span>&lt;<b>int</b>&gt; <span id="r8 rd" class="r8 r">alignment</span>, <b>bool</b> <span id="r9 rd" class="r9 r">suppressHeader</span>, <b>int</b> <span id="r10 rd" class="r10 r">screenRows</span> = <b>int</b>.<span class="i">MaxValue</span>)
        {
            <b>if</b> (<span class="r5 r">leftMarginIndent</span> &lt; 0)
            {
                <span class="r5 r">leftMarginIndent</span> = 0;
            }
 
            <b>if</b> (<span class="r6 r">screenColumns</span> - <span class="r5 r">leftMarginIndent</span> &lt; <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#9e1509f09e26ba1a" class="i field">minimumScreenColumns</a>)
            {
                <a href="#b8802941719bb173" class="i field">_disabled</a> = <b>true</b>;
                <b>return</b>;
            }
 
            <a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a> = <span class="r5 r">leftMarginIndent</span>;
            <a href="#61f9b2decfdba0b1" class="i field">_hideHeader</a> = <span class="r9 r">suppressHeader</span>;
 
            <span class="c">// make sure the column widths are correct; if not, take appropriate action</span>
            <a href="ColumnWidthManager.cs.html#0a3c9c3ec27de51d" class="t t">ColumnWidthManager</a> <span id="r11 rd" class="r11 r">manager</span> = <b>new</b> <span class="t">ColumnWidthManager</span>(
                <span class="r6 r">screenColumns</span> - <span class="r5 r">leftMarginIndent</span>,
                <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#fcd1cdff631bd323" class="i field">minimumColumnWidth</a>,
                <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>);
 
            <span class="r11 r">manager</span>.<a href="ColumnWidthManager.cs.html#b13fedaaa4e27f7a" class="i method">CalculateColumnWidths</a>(<span class="r7 r">columnWidths</span>);
 
            <span class="c">// if all the columns are hidden, just disable</span>
            <b>bool</b> <span id="r12 rd" class="r12 r">oneValid</span> = <b>false</b>;
 
            <b>for</b> (<b>int</b> <span id="r13 rd" class="r13 r">k</span> = 0; <span class="r13 r">k</span> &lt; <span class="r7 r">columnWidths</span>.<span class="i">Length</span>; <span class="r13 r">k</span>++)
            {
                <b>if</b> (<span class="r7 r">columnWidths</span>[<span class="r13 r">k</span>] &gt;= <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#fcd1cdff631bd323" class="i field">minimumColumnWidth</a>)
                {
                    <span class="r12 r">oneValid</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (!<span class="r12 r">oneValid</span>)
            {
                <a href="#b8802941719bb173" class="i field">_disabled</a> = <b>true</b>;
                <b>return</b>;
            }
 
            <span class="c">// now set the run time data structures</span>
            <a href="#4ed2960ea60aebd3" class="i field">_si</a> = <b>new</b> <span class="t">ScreenInfo</span>();
            <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#7a3eb1d059018f6d" class="i field">screenColumns</a> = <span class="r6 r">screenColumns</span>;
            <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#e29b10e744a77621" class="i field">screenRows</a> = <span class="r10 r">screenRows</span>;
            <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a> = <b>new</b> <a href="#5a751f84c69a7ce5" class="t t">ColumnInfo</a>[<span class="r7 r">columnWidths</span>.<span class="i">Length</span>];
 
            <b>int</b> <span id="r14 rd" class="r14 r">startCol</span> = <a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a>;
            <b>for</b> (<b>int</b> <span id="r15 rd" class="r15 r">k</span> = 0; <span class="r15 r">k</span> &lt; <span class="r7 r">columnWidths</span>.<span class="i">Length</span>; <span class="r15 r">k</span>++)
            {
                <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r15 r">k</span>] = <b>new</b> <span class="t">ColumnInfo</span>();
                <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r15 r">k</span>].<a href="#df15716318ff3977" class="i field">startCol</a> = <span class="r14 r">startCol</span>;
                <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r15 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a> = <span class="r7 r">columnWidths</span>[<span class="r15 r">k</span>];
                <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r15 r">k</span>].<a href="#8ee16560db679ee2" class="i field">alignment</a> = <span class="r8 r">alignment</span>[<span class="r15 r">k</span>];
                <span class="r14 r">startCol</span> += <span class="r7 r">columnWidths</span>[<span class="r15 r">k</span>] + <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>;
            }
        }
 
        <b>internal int</b> <a id="77d74ae3ed223bd5" href="../../R/77d74ae3ed223bd5.html" target="n" data-glyph="74,1" class="i method">GenerateHeader</a>(<b>string</b>[] <span id="r16 rd" class="r16 r">values</span>, <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a> <span id="r17 rd" class="r17 r">lo</span>)
        {
            <b>if</b> (<a href="#b8802941719bb173" class="i field">_disabled</a> || <a href="#61f9b2decfdba0b1" class="i field">_hideHeader</a>)
            {
                <b>return</b> 0;
            }
            <b>else</b> <b>if</b> (<a href="#2974fa3c0ec5fb68" class="i field">_header</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r18 rd" class="r18 r">line</span> <b>in</b> <a href="#2974fa3c0ec5fb68" class="i field">_header</a>)
                {
                    <span class="r17 r">lo</span>.<span class="i">WriteLine</span>(<a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#994226c730f84059" class="i property">Formatting</a>.<a href="PSStyle.cs.html#4634e78ec9d162e5" class="i property">TableHeader</a> + <span class="r18 r">line</span> + <a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#0b1059dd37953926" class="i property">Reset</a>);
                }
 
                <b>return</b> <a href="#2974fa3c0ec5fb68" class="i field">_header</a>.<span class="i">Count</span>;
            }
 
            <a href="#2974fa3c0ec5fb68" class="i field">_header</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <span class="c">// generate the row with the header labels</span>
            <a href="#1ac3b06f93162369" class="i method">GenerateRow</a>(<span class="r16 r">values</span>, <span class="r17 r">lo</span>, <b>true</b>, <b>null</b>, <span class="r17 r">lo</span>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>, <a href="#2974fa3c0ec5fb68" class="i field">_header</a>, <span class="r19 r">isHeader</span>: <b>true</b>);
 
            <span class="c">// generate an array of &quot;--&quot; as header markers below</span>
            <span class="c">// the column header labels</span>
            <b>string</b>[] <span id="r20 rd" class="r20 r">breakLine</span> = <b>new</b> <b>string</b>[<span class="r16 r">values</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r21 rd" class="r21 r">k</span> = 0; <span class="r21 r">k</span> &lt; <span class="r20 r">breakLine</span>.<span class="i">Length</span>; <span class="r21 r">k</span>++)
            {
                <span class="c">// the column can be hidden</span>
                <b>if</b> (<a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r21 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a> &lt;= 0)
                {
                    <span class="r20 r">breakLine</span>[<span class="r21 r">k</span>] = <b>string</b>.<span class="i">Empty</span>;
                    <b>continue</b>;
                }
                <span class="c">// the title can be larger than the width</span>
                <b>int</b> <span id="r22 rd" class="r22 r">count</span> = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r21 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r16 r">values</span>[<span class="r21 r">k</span>]))
                {
                    <b>int</b> <span id="r23 rd" class="r23 r">labelDisplayCells</span> = <span class="r17 r">lo</span>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r16 r">values</span>[<span class="r21 r">k</span>]);
                    <b>if</b> (<span class="r23 r">labelDisplayCells</span> &lt; <span class="r22 r">count</span>)
                        <span class="r22 r">count</span> = <span class="r23 r">labelDisplayCells</span>;
                }
                <span class="c">// NOTE: we can do this because &quot;-&quot; is a single cell character</span>
                <span class="c">// on all devices. If changed to some other character, this assumption</span>
                <span class="c">// would be invalidated</span>
                <span class="r20 r">breakLine</span>[<span class="r21 r">k</span>] = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#38be8b72f7ee64ab" class="i method">DashPadding</a>(<span class="r22 r">count</span>);
            }
 
            <a href="#1ac3b06f93162369" class="i method">GenerateRow</a>(<span class="r20 r">breakLine</span>, <span class="r17 r">lo</span>, <b>false</b>, <b>null</b>, <span class="r17 r">lo</span>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>, <a href="#2974fa3c0ec5fb68" class="i field">_header</a>, <span class="r19 r">isHeader</span>: <b>true</b>);
            <b>return</b> <a href="#2974fa3c0ec5fb68" class="i field">_header</a>.<span class="i">Count</span>;
        }
 
        <b>internal void</b> <a id="1ac3b06f93162369" href="../../R/1ac3b06f93162369.html" target="n" data-glyph="74,1" class="i method">GenerateRow</a>(<b>string</b>[] <span id="r24 rd" class="r24 r">values</span>, <a href="ILineOutput.cs.html#bef25620bcca346e" class="t t">LineOutput</a> <span id="r25 rd" class="r25 r">lo</span>, <b>bool</b> <span id="r26 rd" class="r26 r">multiLine</span>, <span class="i">ReadOnlySpan</span>&lt;<b>int</b>&gt; <span id="r27 rd" class="r27 r">alignment</span>, <a href="ILineOutput.cs.html#20795ffb5d8d2dc1" class="t t">DisplayCells</a> <span id="r28 rd" class="r28 r">dc</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r29 rd" class="r29 r">generatedRows</span>, <b>bool</b> <span id="r19 rd" class="r19 r">isHeader</span> = <b>false</b>)
        {
            <b>if</b> (<a href="#b8802941719bb173" class="i field">_disabled</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// build the current row alignment settings</span>
            <b>int</b> <span id="r30 rd" class="r30 r">cols</span> = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span>;
            <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r31 rd" class="r31 r">currentAlignment</span> = <span class="r30 r">cols</span> &lt;= <a href="BaseOutputtingCommand.cs.html#82ff02ddef6485d3" class="t t">OutCommandInner</a>.<a href="BaseOutputtingCommand.cs.html#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r30 r">cols</span>] : <b>new</b> <b>int</b>[<span class="r30 r">cols</span>];
 
            <b>if</b> (<span class="r27 r">alignment</span>.<span class="i">IsEmpty</span>)
            {
                <b>for</b> (<b>int</b> <span id="r32 rd" class="r32 r">i</span> = 0; <span class="r32 r">i</span> &lt; <span class="r31 r">currentAlignment</span>.<span class="i">Length</span>; <span class="r32 r">i</span>++)
                {
                    <span class="r31 r">currentAlignment</span>[<span class="r32 r">i</span>] = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r32 r">i</span>].<a href="#8ee16560db679ee2" class="i field">alignment</a>;
                }
            }
            <b>else</b>
            {
                <b>for</b> (<b>int</b> <span id="r33 rd" class="r33 r">i</span> = 0; <span class="r33 r">i</span> &lt; <span class="r31 r">currentAlignment</span>.<span class="i">Length</span>; <span class="r33 r">i</span>++)
                {
                    <b>if</b> (<span class="r27 r">alignment</span>[<span class="r33 r">i</span>] == <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#797b50eeb23d8eb1" class="i field">Undefined</a>)
                    {
                        <span class="r31 r">currentAlignment</span>[<span class="r33 r">i</span>] = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r33 r">i</span>].<a href="#8ee16560db679ee2" class="i field">alignment</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r31 r">currentAlignment</span>[<span class="r33 r">i</span>] = <span class="r27 r">alignment</span>[<span class="r33 r">i</span>];
                    }
                }
            }
 
            <b>if</b> (<span class="r26 r">multiLine</span>)
            {
                <b>foreach</b> (<b>string</b> <span id="r34 rd" class="r34 r">line</span> <b>in</b> <span class="i">GenerateTableRow</span>(<span class="r24 r">values</span>, <span class="r31 r">currentAlignment</span>, <span class="r25 r">lo</span>.<a href="ILineOutput.cs.html#99386fe34bd7140c" class="i property">DisplayCells</a>))
                {
                    <span class="r29 r">generatedRows</span>?.<span class="i">Add</span>(<span class="r34 r">line</span>);
                    <b>if</b> (<span class="r19 r">isHeader</span>)
                    {
                        <span class="r25 r">lo</span>.<span class="i">WriteLine</span>(<a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#994226c730f84059" class="i property">Formatting</a>.<a href="PSStyle.cs.html#4634e78ec9d162e5" class="i property">TableHeader</a> + <span class="r34 r">line</span> + <a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#0b1059dd37953926" class="i property">Reset</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r25 r">lo</span>.<a href="ILineOutput.cs.html#fd3191b17b478f7f" class="i method">WriteLine</a>(<span class="r34 r">line</span>);
                    }
                }
            }
            <b>else</b>
            {
                <b>string</b> <span id="r35 rd" class="r35 r">line</span> = <span class="i">GenerateRow</span>(<span class="r24 r">values</span>, <span class="r31 r">currentAlignment</span>, <span class="r28 r">dc</span>);
                <span class="r29 r">generatedRows</span>?.<span class="i">Add</span>(<span class="r35 r">line</span>);
                <b>if</b> (<span class="r19 r">isHeader</span>)
                {
                    <span class="r25 r">lo</span>.<span class="i">WriteLine</span>(<a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#994226c730f84059" class="i property">Formatting</a>.<a href="PSStyle.cs.html#4634e78ec9d162e5" class="i property">TableHeader</a> + <span class="r35 r">line</span> + <a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#0b1059dd37953926" class="i property">Reset</a>);
                }
                <b>else</b>
                {
                    <span class="r25 r">lo</span>.<a href="ILineOutput.cs.html#fd3191b17b478f7f" class="i method">WriteLine</a>(<span class="r35 r">line</span>);
                }
            }
        }
 
        <b>private string</b>[] <a id="4d48ccfffda612ae" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateTableRow</a>(<b>string</b>[] <span id="r36 rd" class="r36 r">values</span>, <span class="i">ReadOnlySpan</span>&lt;<b>int</b>&gt; <span id="r37 rd" class="r37 r">alignment</span>, <a href="ILineOutput.cs.html#20795ffb5d8d2dc1" class="t t">DisplayCells</a> <span id="r38 rd" class="r38 r">ds</span>)
        {
            <span class="c">// select the active columns (skip hidden ones)</span>
            <span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r39 rd" class="r39 r">validColumnArray</span> = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span> &lt;= <a href="BaseOutputtingCommand.cs.html#82ff02ddef6485d3" class="t t">OutCommandInner</a>.<a href="BaseOutputtingCommand.cs.html#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span>] : <b>new</b> <b>int</b>[<a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span>];
            <b>int</b> <span id="r40 rd" class="r40 r">validColumnCount</span> = 0;
            <b>for</b> (<b>int</b> <span id="r41 rd" class="r41 r">k</span> = 0; <span class="r41 r">k</span> &lt; <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span>; <span class="r41 r">k</span>++)
            {
                <b>if</b> (<a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r41 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a> &gt; 0)
                {
                    <span class="r39 r">validColumnArray</span>[<span class="r40 r">validColumnCount</span>++] = <span class="r41 r">k</span>;
                }
            }
 
            <b>if</b> (<span class="r40 r">validColumnCount</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">StringCollection</span>[] <span id="r42 rd" class="r42 r">scArray</span> = <b>new</b> <span class="i">StringCollection</span>[<span class="r40 r">validColumnCount</span>];
            <b>bool</b> <span id="r43 rd" class="r43 r">addPadding</span> = <b>true</b>;
            <b>for</b> (<b>int</b> <span id="r44 rd" class="r44 r">k</span> = 0; <span class="r44 r">k</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span>; <span class="r44 r">k</span>++)
            {
                <span class="c">// for the last column, don&#39;t pad it with trailing spaces</span>
                <b>if</b> (<span class="r44 r">k</span> == <span class="r42 r">scArray</span>.<span class="i">Length</span> - 1)
                {
                    <span class="r43 r">addPadding</span> = <b>false</b>;
                }
 
                <span class="c">// obtain a set of tokens for each field</span>
                <span class="r42 r">scArray</span>[<span class="r44 r">k</span>] = <span class="i">GenerateMultiLineRowField</span>(<span class="r36 r">values</span>[<span class="r39 r">validColumnArray</span>[<span class="r44 r">k</span>]], <span class="r39 r">validColumnArray</span>[<span class="r44 r">k</span>],
                    <span class="r37 r">alignment</span>[<span class="r39 r">validColumnArray</span>[<span class="r44 r">k</span>]], <span class="r38 r">ds</span>, <span class="r43 r">addPadding</span>);
 
                <span class="c">// NOTE: the following padding operations assume that we</span>
                <span class="c">// pad with a blank (or any character that ALWAYS maps to a single screen cell</span>
                <b>if</b> (<span class="r44 r">k</span> &gt; 0)
                {
                    <span class="c">// skipping the first ones, add a separator for concatenation</span>
                    <b>for</b> (<b>int</b> <span id="r45 rd" class="r45 r">j</span> = 0; <span class="r45 r">j</span> &lt; <span class="r42 r">scArray</span>[<span class="r44 r">k</span>].<span class="i">Count</span>; <span class="r45 r">j</span>++)
                    {
                        <span class="r42 r">scArray</span>[<span class="r44 r">k</span>][<span class="r45 r">j</span>] = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>) + <span class="r42 r">scArray</span>[<span class="r44 r">k</span>][<span class="r45 r">j</span>];
                    }
                }
                <b>else</b>
                {
                    <span class="c">// add indentation padding if needed</span>
                    <b>if</b> (<a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a> &gt; 0)
                    {
                        <b>for</b> (<b>int</b> <span id="r46 rd" class="r46 r">j</span> = 0; <span class="r46 r">j</span> &lt; <span class="r42 r">scArray</span>[<span class="r44 r">k</span>].<span class="i">Count</span>; <span class="r46 r">j</span>++)
                        {
                            <span class="r42 r">scArray</span>[<span class="r44 r">k</span>][<span class="r46 r">j</span>] = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a>) + <span class="r42 r">scArray</span>[<span class="r44 r">k</span>][<span class="r46 r">j</span>];
                        }
                    }
                }
            }
 
            <span class="c">// now we processed all the rows columns and we need to find the cell that occupies the most</span>
            <span class="c">// rows</span>
            <b>int</b> <span id="r47 rd" class="r47 r">screenRows</span> = 0;
            <b>for</b> (<b>int</b> <span id="r48 rd" class="r48 r">k</span> = 0; <span class="r48 r">k</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span>; <span class="r48 r">k</span>++)
            {
                <b>if</b> (<span class="r42 r">scArray</span>[<span class="r48 r">k</span>].<span class="i">Count</span> &gt; <span class="r47 r">screenRows</span>)
                    <span class="r47 r">screenRows</span> = <span class="r42 r">scArray</span>[<span class="r48 r">k</span>].<span class="i">Count</span>;
            }
 
            <span class="c">// column headers can span multiple rows if the width of the column is shorter than the header text like:</span>
            <span class="c">//</span>
            <span class="c">// Long Header2 Head</span>
            <span class="c">// Head         er3</span>
            <span class="c">// er</span>
            <span class="c">// ---- ------- ----</span>
            <span class="c">// 1    2       3</span>
            <span class="c">//</span>
            <span class="c">// To ensure we don&#39;t add whitespace to the end, we need to determine the last column in each row with content</span>
 
            <span class="i n">System</span>.<span class="i">Span</span>&lt;<b>int</b>&gt; <span id="r49 rd" class="r49 r">lastColWithContent</span> = <span class="r47 r">screenRows</span> &lt;= <a href="BaseOutputtingCommand.cs.html#82ff02ddef6485d3" class="t t">OutCommandInner</a>.<a href="BaseOutputtingCommand.cs.html#cc49a35b69390030" class="i field">StackAllocThreshold</a> ? <b>stackalloc int</b>[<span class="r47 r">screenRows</span>] : <b>new</b> <b>int</b>[<span class="r47 r">screenRows</span>];
            <b>for</b> (<b>int</b> <span id="r50 rd" class="r50 r">row</span> = 0; <span class="r50 r">row</span> &lt; <span class="r47 r">screenRows</span>; <span class="r50 r">row</span>++)
            {
                <b>for</b> (<b>int</b> <span id="r51 rd" class="r51 r">col</span> = 0; <span class="r51 r">col</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span>; <span class="r51 r">col</span>++)
                {
                    <b>if</b> (<span class="r42 r">scArray</span>[<span class="r51 r">col</span>].<span class="i">Count</span> &gt; <span class="r50 r">row</span>)
                    {
                        <span class="r49 r">lastColWithContent</span>[<span class="r50 r">row</span>] = <span class="r51 r">col</span>;
                    }
                }
            }
 
            <span class="c">// add padding for the columns that are shorter</span>
            <b>for</b> (<b>int</b> <span id="r52 rd" class="r52 r">col</span> = 0; <span class="r52 r">col</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span>; <span class="r52 r">col</span>++)
            {
                <b>int</b> <span id="r53 rd" class="r53 r">paddingBlanks</span> = 0;
 
                <span class="c">// don&#39;t pad if last column</span>
                <b>if</b> (<span class="r52 r">col</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span> - 1)
                {
                    <span class="r53 r">paddingBlanks</span> = <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r39 r">validColumnArray</span>[<span class="r52 r">col</span>]].<a href="#4bf6df601c84f507" class="i field">width</a>;
                    <b>if</b> (<span class="r52 r">col</span> &gt; 0)
                    {
                        <span class="r53 r">paddingBlanks</span> += <a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r53 r">paddingBlanks</span> += <a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a>;
                    }
                }
 
                <b>int</b> <span id="r54 rd" class="r54 r">paddingEntries</span> = <span class="r47 r">screenRows</span> - <span class="r42 r">scArray</span>[<span class="r52 r">col</span>].<span class="i">Count</span>;
                <b>if</b> (<span class="r54 r">paddingEntries</span> &gt; 0)
                {
                    <b>for</b> (<b>int</b> <span id="r55 rd" class="r55 r">row</span> = <span class="r47 r">screenRows</span> - <span class="r54 r">paddingEntries</span>; <span class="r55 r">row</span> &lt; <span class="r47 r">screenRows</span>; <span class="r55 r">row</span>++)
                    {
                        <span class="c">// if the column is beyond the last column with content, just use empty string</span>
                        <b>if</b> (<span class="r52 r">col</span> &gt; <span class="r49 r">lastColWithContent</span>[<span class="r55 r">row</span>])
                        {
                            <span class="r42 r">scArray</span>[<span class="r52 r">col</span>].<span class="i">Add</span>(<b>string</b>.<span class="i">Empty</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r42 r">scArray</span>[<span class="r52 r">col</span>].<span class="i">Add</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<span class="r53 r">paddingBlanks</span>));
                        }
                    }
                }
            }
 
            <span class="c">// finally, build an array of strings</span>
            <b>string</b>[] <span id="r56 rd" class="r56 r">rows</span> = <b>new</b> <b>string</b>[<span class="r47 r">screenRows</span>];
            <b>for</b> (<b>int</b> <span id="r57 rd" class="r57 r">row</span> = 0; <span class="r57 r">row</span> &lt; <span class="r47 r">screenRows</span>; <span class="r57 r">row</span>++)
            {
                <span class="i">StringBuilder</span> <span id="r58 rd" class="r58 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="c">// for a given row, walk the columns</span>
                <b>for</b> (<b>int</b> <span id="r59 rd" class="r59 r">col</span> = 0; <span class="r59 r">col</span> &lt; <span class="r42 r">scArray</span>.<span class="i">Length</span>; <span class="r59 r">col</span>++)
                {
                    <span class="c">// if the column is the last column with content, we need to trim trailing whitespace, unless there is only one row</span>
                    <b>if</b> (<span class="r59 r">col</span> == <span class="r49 r">lastColWithContent</span>[<span class="r57 r">row</span>] &amp;&amp; <span class="r47 r">screenRows</span> &gt; 1)
                    {
                        <span class="r58 r">sb</span>.<span class="i">Append</span>(<span class="r42 r">scArray</span>[<span class="r59 r">col</span>][<span class="r57 r">row</span>].<span class="i">TrimEnd</span>());
                    }
                    <b>else</b>
                    {
                        <span class="r58 r">sb</span>.<span class="i">Append</span>(<span class="r42 r">scArray</span>[<span class="r59 r">col</span>][<span class="r57 r">row</span>]);
                    }
                }
 
                <span class="r56 r">rows</span>[<span class="r57 r">row</span>] = <span class="r58 r">sb</span>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <span class="r56 r">rows</span>;
        }
 
        <b>private</b> <span class="i">StringCollection</span> <a id="2de653d1eff9b2c3" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateMultiLineRowField</a>(<b>string</b> <span id="r60 rd" class="r60 r">val</span>, <b>int</b> <span id="r61 rd" class="r61 r">k</span>, <b>int</b> <span id="r62 rd" class="r62 r">alignment</span>, <a href="ILineOutput.cs.html#20795ffb5d8d2dc1" class="t t">DisplayCells</a> <span id="r63 rd" class="r63 r">dc</span>, <b>bool</b> <span id="r64 rd" class="r64 r">addPadding</span>)
        {
            <span class="i">StringCollection</span> <span id="r65 rd" class="r65 r">sc</span> = <a href="ComplexWriter.cs.html#ce52aabdba932938" class="t t">StringManipulationHelper</a>.<a href="ComplexWriter.cs.html#d919cc7a3bb58a02" class="i method">GenerateLines</a>(<span class="r63 r">dc</span>, <span class="r60 r">val</span>,
                                        <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r61 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>, <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r61 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>);
            <b>if</b> (<span class="r64 r">addPadding</span> || <span class="r62 r">alignment</span> == <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#48a1364e44f6b937" class="i field">Right</a> || <span class="r62 r">alignment</span> == <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#5b5c0b66d8d7db76" class="i field">Center</a>)
            {
                <span class="c">// if length is shorter, do some padding</span>
                <b>for</b> (<b>int</b> <span id="r66 rd" class="r66 r">col</span> = 0; <span class="r66 r">col</span> &lt; <span class="r65 r">sc</span>.<span class="i">Count</span>; <span class="r66 r">col</span>++)
                {
                    <b>if</b> (<span class="r63 r">dc</span>.<span class="i">Length</span>(<span class="r65 r">sc</span>[<span class="r66 r">col</span>]) &lt; <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r61 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>)
                        <span class="r65 r">sc</span>[<span class="r66 r">col</span>] = <span class="i">GenerateRowField</span>(<span class="r65 r">sc</span>[<span class="r66 r">col</span>], <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r61 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>, <span class="r62 r">alignment</span>, <span class="r63 r">dc</span>, <span class="r64 r">addPadding</span>);
                }
            }
 
            <b>return</b> <span class="r65 r">sc</span>;
        }
 
        <b>private string</b> <a id="d417b04ef350e909" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateRow</a>(<b>string</b>[] <span id="r67 rd" class="r67 r">values</span>, <span class="i">ReadOnlySpan</span>&lt;<b>int</b>&gt; <span id="r68 rd" class="r68 r">alignment</span>, <a href="ILineOutput.cs.html#20795ffb5d8d2dc1" class="t t">DisplayCells</a> <span id="r69 rd" class="r69 r">dc</span>)
        {
            <span class="i">StringBuilder</span> <span id="r70 rd" class="r70 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>bool</b> <span id="r71 rd" class="r71 r">addPadding</span> = <b>true</b>;
            <b>for</b> (<b>int</b> <span id="r72 rd" class="r72 r">k</span> = 0; <span class="r72 r">k</span> &lt; <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span>; <span class="r72 r">k</span>++)
            {
                <span class="c">// don&#39;t pad the last column</span>
                <b>if</b> (<span class="r72 r">k</span> == <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>.<span class="i">Length</span> - 1)
                {
                    <span class="r71 r">addPadding</span> = <b>false</b>;
                }
 
                <b>if</b> (<a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r72 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a> &lt;= 0)
                {
                    <span class="c">// skip columns that are not at least a single character wide</span>
                    <b>continue</b>;
                }
 
                <span class="c">// NOTE: the following padding operations assume that we</span>
                <span class="c">// pad with a blank (or any character that ALWAYS maps to a single screen cell</span>
                <b>if</b> (<span class="r72 r">k</span> &gt; 0)
                {
                    <span class="r70 r">sb</span>.<span class="i">Append</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<a href="#54bb149c0feea7e0" class="t t">ScreenInfo</a>.<a href="#c77181968d9b01f5" class="i field">separatorCharacterCount</a>));
                }
                <b>else</b>
                {
                    <span class="c">// add indentation padding if needed</span>
                    <b>if</b> (<a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a> &gt; 0)
                    {
                        <span class="r70 r">sb</span>.<span class="i">Append</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<a href="#ab1b7c19cee52fa9" class="i field">_startColumn</a>));
                    }
                }
 
                <span class="r70 r">sb</span>.<span class="i">Append</span>(<span class="i">GenerateRowField</span>(<span class="r67 r">values</span>[<span class="r72 r">k</span>], <a href="#4ed2960ea60aebd3" class="i field">_si</a>.<a href="#df031ae2b3ccccf8" class="i field">columnInfo</a>[<span class="r72 r">k</span>].<a href="#4bf6df601c84f507" class="i field">width</a>, <span class="r68 r">alignment</span>[<span class="r72 r">k</span>], <span class="r69 r">dc</span>, <span class="r71 r">addPadding</span>));
                <b>if</b> (<span class="r67 r">values</span>[<span class="r72 r">k</span>] <b>is not null</b> &amp;&amp; <span class="r67 r">values</span>[<span class="r72 r">k</span>].<span class="i">Contains</span>(<a href="#2396d36748e2b7ec" class="i field">ESC</a>))
                {
                    <span class="c">// Reset the console output if the content of this column contains ESC</span>
                    <span class="r70 r">sb</span>.<span class="i">Append</span>(<a href="PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>.<a href="PSStyle.cs.html#0b1059dd37953926" class="i property">Reset</a>);
                }
            }
 
            <b>return</b> <span class="r70 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <b>private static string</b> <a id="88198e6e3f53b26f" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateRowField</a>(<b>string</b> <span id="r73 rd" class="r73 r">val</span>, <b>int</b> <span id="r74 rd" class="r74 r">width</span>, <b>int</b> <span id="r75 rd" class="r75 r">alignment</span>, <a href="ILineOutput.cs.html#20795ffb5d8d2dc1" class="t t">DisplayCells</a> <span id="r76 rd" class="r76 r">dc</span>, <b>bool</b> <span id="r77 rd" class="r77 r">addPadding</span>)
        {
            <span class="c">// make sure the string does not have any embedded &lt;CR&gt; in it</span>
            <b>string</b> <span id="r78 rd" class="r78 r">s</span> = <a href="ComplexWriter.cs.html#ce52aabdba932938" class="t t">StringManipulationHelper</a>.<a href="ComplexWriter.cs.html#bef24cc449cb3320" class="i method">TruncateAtNewLine</a>(<span class="r73 r">val</span>);
 
            <b>string</b> <span id="r79 rd" class="r79 r">currentValue</span> = <span class="r78 r">s</span>;
            <b>int</b> <span id="r80 rd" class="r80 r">currentValueDisplayLength</span> = <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r79 r">currentValue</span>);
 
            <b>if</b> (<span class="r80 r">currentValueDisplayLength</span> &lt; <span class="r74 r">width</span>)
            {
                <span class="c">// the string is shorter than the width of the column</span>
                <span class="c">// need to pad with with blanks to reach the desired width</span>
                <b>int</b> <span id="r81 rd" class="r81 r">padCount</span> = <span class="r74 r">width</span> - <span class="r80 r">currentValueDisplayLength</span>;
                <b>switch</b> (<span class="r75 r">alignment</span>)
                {
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#48a1364e44f6b937" class="i field">Right</a>:
                        {
                            <span class="r78 r">s</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<span class="r81 r">padCount</span>) + <span class="r78 r">s</span>;
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#5b5c0b66d8d7db76" class="i field">Center</a>:
                        {
                            <span class="c">// add a bit at both ends of the string</span>
                            <b>int</b> <span id="r82 rd" class="r82 r">padLeft</span> = <span class="r81 r">padCount</span> / 2;
                            <b>int</b> <span id="r83 rd" class="r83 r">padRight</span> = <span class="r81 r">padCount</span> - <span class="r82 r">padLeft</span>;
 
                            <span class="r78 r">s</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<span class="r82 r">padLeft</span>) + <span class="r78 r">s</span>;
                            <b>if</b> (<span class="r77 r">addPadding</span>)
                            {
                                <span class="r78 r">s</span> += <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<span class="r83 r">padRight</span>);
                            }
                        }
 
                        <b>break</b>;
 
                    <b>default</b>:
                        {
                            <b>if</b> (<span class="r77 r">addPadding</span>)
                            {
                                <span class="c">// left align is the default</span>
                                <span class="r78 r">s</span> += <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#946b4ff19a62bfcc" class="i method">Padding</a>(<span class="r81 r">padCount</span>);
                            }
                        }
 
                        <b>break</b>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r80 r">currentValueDisplayLength</span> &gt; <span class="r74 r">width</span>)
            {
                <span class="c">// the string is longer than the width of the column</span>
                <span class="c">// truncate and add ellipsis if it&#39;s too long</span>
                <b>int</b> <span id="r84 rd" class="r84 r">truncationDisplayLength</span> = <span class="r74 r">width</span> - <a href="#2fef837951d38416" class="i field">EllipsisSize</a>;
 
                <b>if</b> (<span class="r84 r">truncationDisplayLength</span> &gt; 0)
                {
                    <span class="c">// we have space for the ellipsis, add it</span>
                    <b>switch</b> (<span class="r75 r">alignment</span>)
                    {
                        <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#48a1364e44f6b937" class="i field">Right</a>:
                            {
                                <span class="c">// get from &quot;abcdef&quot; to &quot;...f&quot;</span>
                                <b>int</b> <span id="r85 rd" class="r85 r">tailCount</span> = <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#ab9f6d147501de5e" class="i method">GetTailSplitLength</a>(<span class="r78 r">s</span>, <span class="r84 r">truncationDisplayLength</span>);
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(<span class="r78 r">s</span>.<span class="i">Length</span> - <span class="r85 r">tailCount</span>);
                                <span class="r78 r">s</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a5549bfa35c48a67" class="i field">Ellipsis</a> + <span class="r78 r">s</span>;
                            }
 
                            <b>break</b>;
 
                        <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#5b5c0b66d8d7db76" class="i field">Center</a>:
                            {
                                <span class="c">// get from &quot;abcdef&quot; to &quot;a...&quot;</span>
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(0, <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#7907b04513ae9647" class="i method">GetHeadSplitLength</a>(<span class="r78 r">s</span>, <span class="r84 r">truncationDisplayLength</span>));
                                <span class="r78 r">s</span> += <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a5549bfa35c48a67" class="i field">Ellipsis</a>;
                            }
 
                            <b>break</b>;
 
                        <b>default</b>:
                            {
                                <span class="c">// left align is the default</span>
                                <span class="c">// get from &quot;abcdef&quot; to &quot;a...&quot;</span>
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(0, <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#7907b04513ae9647" class="i method">GetHeadSplitLength</a>(<span class="r78 r">s</span>, <span class="r84 r">truncationDisplayLength</span>));
                                <span class="r78 r">s</span> += <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a5549bfa35c48a67" class="i field">Ellipsis</a>;
                            }
 
                            <b>break</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// not enough space for the ellipsis, just truncate at the width</span>
                    <b>int</b> <span id="r86 rd" class="r86 r">len</span> = <span class="r74 r">width</span>;
 
                    <b>switch</b> (<span class="r75 r">alignment</span>)
                    {
                        <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#48a1364e44f6b937" class="i field">Right</a>:
                            {
                                <span class="c">// get from &quot;abcdef&quot; to &quot;f&quot;</span>
                                <b>int</b> <span id="r87 rd" class="r87 r">tailCount</span> = <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#ab9f6d147501de5e" class="i method">GetTailSplitLength</a>(<span class="r78 r">s</span>, <span class="r86 r">len</span>);
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(<span class="r78 r">s</span>.<span class="i">Length</span> - <span class="r87 r">tailCount</span>, <span class="r87 r">tailCount</span>);
                            }
 
                            <b>break</b>;
 
                        <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#5b5c0b66d8d7db76" class="i field">Center</a>:
                            {
                                <span class="c">// get from &quot;abcdef&quot; to &quot;a&quot;</span>
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(0, <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#7907b04513ae9647" class="i method">GetHeadSplitLength</a>(<span class="r78 r">s</span>, <span class="r86 r">len</span>));
                            }
 
                            <b>break</b>;
 
                        <b>default</b>:
                            {
                                <span class="c">// left align is the default</span>
                                <span class="c">// get from &quot;abcdef&quot; to &quot;a&quot;</span>
                                <span class="r78 r">s</span> = <span class="r78 r">s</span>.<span class="i">Substring</span>(0, <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#7907b04513ae9647" class="i method">GetHeadSplitLength</a>(<span class="r78 r">s</span>, <span class="r86 r">len</span>));
                            }
 
                            <b>break</b>;
                    }
                }
            }
 
            <span class="c">// we need to take into consideration that truncation left the string one</span>
            <span class="c">// display cell short if a double cell character got truncated</span>
            <span class="c">// in this case, we need to pad with a blank</span>
            <b>int</b> <span id="r88 rd" class="r88 r">finalValueDisplayLength</span> = <span class="r76 r">dc</span>.<a href="ILineOutput.cs.html#c7940c04c4b1ebce" class="i method">Length</a>(<span class="r78 r">s</span>);
            <b>if</b> (<span class="r88 r">finalValueDisplayLength</span> == <span class="r74 r">width</span>)
            {
                <b>return</b> <span class="r78 r">s</span>;
            }
 
            <b>switch</b> (<span class="r75 r">alignment</span>)
            {
                <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#48a1364e44f6b937" class="i field">Right</a>:
                    {
                        <span class="r78 r">s</span> = <span class="s">&quot; &quot;</span> + <span class="r78 r">s</span>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#eaffd63a419491c3" class="t t">TextAlignment</a>.<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#5b5c0b66d8d7db76" class="i field">Center</a>:
                    {
                        <b>if</b> (<span class="r77 r">addPadding</span>)
                        {
                            <span class="r78 r">s</span> += <span class="s">&quot; &quot;</span>;
                        }
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    {
                        <span class="c">// left align is the default</span>
                        <b>if</b> (<span class="r77 r">addPadding</span>)
                        {
                            <span class="r78 r">s</span> += <span class="s">&quot; &quot;</span>;
                        }
                    }
 
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r78 r">s</span>;
        }
 
        <b>private const int</b> <a id="2fef837951d38416" href="../../R/2fef837951d38416.html" target="n" data-glyph="10,1" class="i field">EllipsisSize</a> = 1;
 
        <b>private bool</b> <a id="b8802941719bb173" href="../../R/b8802941719bb173.html" target="n" data-glyph="46,1" class="i field">_disabled</a> = <b>false</b>;
 
        <b>private bool</b> <a id="61f9b2decfdba0b1" href="../../R/61f9b2decfdba0b1.html" target="n" data-glyph="46,1" class="i field">_hideHeader</a> = <b>false</b>;
 
        <b>private int</b> <a id="ab1b7c19cee52fa9" href="../../R/ab1b7c19cee52fa9.html" target="n" data-glyph="46,1" class="i field">_startColumn</a> = 0;
    }
}
</pre></td></tr></table></div></body></html>
