<!DOCTYPE html>
<html><head><title>BaseCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(408);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/BaseCommand.cs" target="_top">FormatAndOutput\common\BaseCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Facade class to provide context information to process</span>
    <span class="c">///</span><span class="c"> exceptions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="2dfdff306d6451a6" href="../../R/2dfdff306d6451a6.html" target="n" data-glyph="2,0" class="t t">TerminatingErrorContext</a>
    {
        <b>internal</b> <a id="581f28e2926055c3" href="../../R/581f28e2926055c3.html" target="n" data-glyph="74,1" class="t constructor">TerminatingErrorContext</a>(<a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r0 rd" class="r0 r">command</span>)
        {
            <b>if</b> (<span class="r0 r">command</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">command</span>));
            <a href="#6608ae8a7b1d02b6" class="i field">_command</a> = <span class="r0 r">command</span>;
        }
 
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>.<span class="i">DoesNotReturn</span>]
        <b>internal void</b> <a id="293390b36cb4485f" href="../../R/293390b36cb4485f.html" target="n" data-glyph="74,1" class="i method">ThrowTerminatingError</a>(<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r1 rd" class="r1 r">errorRecord</span>)
        {
            <a href="#6608ae8a7b1d02b6" class="i field">_command</a>.<a href="../../engine/cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r1 r">errorRecord</span>);
        }
 
        <b>private readonly</b> <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="6608ae8a7b1d02b6" href="../../R/6608ae8a7b1d02b6.html" target="n" data-glyph="46,1" class="i field">_command</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class to invoke a command in a secondary pipeline.</span>
    <span class="c">///</span><span class="c"> NOTE: this implementation does not return any error messages</span>
    <span class="c">///</span><span class="c"> that invoked pipelines might generate.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="c5695f10b2ea210f" href="../../R/c5695f10b2ea210f.html" target="n" data-glyph="2,0" class="t t"><span id="3d77451533c5dc1c">CommandWrapper</span></a> : <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the command before executing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">execContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionContext used to create sub pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">nameOfCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the command to run.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">typeOfCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of the command to run.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2ed22de0d67c02e7" href="../../R/2ed22de0d67c02e7.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<a href="../../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r2 rd" class="r2 r">execContext</span>, <b>string</b> <span id="r3 rd" class="r3 r">nameOfCommand</span>, <span class="i">Type</span> <span id="r4 rd" class="r4 r">typeOfCommand</span>)
        {
            <a href="#ac3e35bbdc3f7513" class="i field">_context</a> = <span class="r2 r">execContext</span>;
            <a href="#a07088863645f858" class="i field">_commandName</a> = <span class="r3 r">nameOfCommand</span>;
            <a href="#236ac3cd203d332b" class="i field">_commandType</a> = <span class="r4 r">typeOfCommand</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a parameter to the command invocation.</span>
        <span class="c">///</span><span class="c"> It needs to be called before any execution takes place.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">parameterValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value of the parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ee069911d5d236a1" href="../../R/ee069911d5d236a1.html" target="n" data-glyph="74,1" class="i method">AddNamedParameter</a>(<b>string</b> <span id="r5 rd" class="r5 r">parameterName</span>, <b>object</b> <span id="r6 rd" class="r6 r">parameterValue</span>)
        {
            <a href="#b4b653eb0f150a0e" class="i field">_commandParameterList</a>.<span class="i">Add</span>(
                <a href="../../engine/CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<a href="../../engine/CommandParameter.cs.html#b0a57c9e4428f6f3" class="i method">CreateParameterWithArgument</a>(
                    <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r5 r">parameterName</span>, <b>null</b>,
                    <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r6 r">parameterValue</span>,
                    <b>false</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Send an object to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of objects out of the success pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Array</span> <a id="db41fa224416459e" href="../../R/db41fa224416459e.html" target="n" data-glyph="74,1" class="i method">Process</a>(<b>object</b> <span id="r7 rd" class="r7 r">o</span>)
        {
            <b>if</b> (<a href="#bb00e832b97263c8" class="i field">_pp</a> == <b>null</b>)
            {
                <span class="c">// if this is the first call, we need to initialize the</span>
                <span class="c">// pipeline underneath</span>
                <a href="#c5cea6daf4472617" class="i method">DelayedInternalInitialize</a>();
            }
 
            <b>return</b> <a href="#bb00e832b97263c8" class="i field">_pp</a>.<a href="../../engine/pipeline.cs.html#f434c7211d4ab4d2" class="i method">Step</a>(<span class="r7 r">o</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shut down the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of objects out of the success pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Array</span> <a id="abdf0e782c7f04a8" href="../../R/abdf0e782c7f04a8.html" target="n" data-glyph="74,1" class="i method">ShutDown</a>()
        {
            <b>if</b> (<a href="#bb00e832b97263c8" class="i field">_pp</a> == <b>null</b>)
            {
                <span class="c">// if Process() never got called, no sub pipeline</span>
                <span class="c">// ever got created, hence we just return an empty array</span>
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;();
            }
 
            <a href="../../engine/pipeline.cs.html#5e576bcabfa5c82b" class="t t">PipelineProcessor</a> <span id="r8 rd" class="r8 r">ppTemp</span> = <a href="#bb00e832b97263c8" class="i field">_pp</a>;
 
            <a href="#bb00e832b97263c8" class="i field">_pp</a> = <b>null</b>;
            <b>return</b> <span class="r8 r">ppTemp</span>.<a href="../../engine/pipeline.cs.html#8a9a9e1fb869f895" class="i method">SynchronousExecuteEnumerate</a>(<a href="../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>);
        }
 
        <b>private void</b> <a id="c5cea6daf4472617" href="../../R/c5cea6daf4472617.html" target="n" data-glyph="76,1" class="i method">DelayedInternalInitialize</a>()
        {
            <a href="#bb00e832b97263c8" class="i field">_pp</a> = <b>new</b> <span class="t">PipelineProcessor</span>();
 
            <a href="../../engine/CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r9 rd" class="r9 r">cmdletInfo</span> = <b>new</b> <a href="../../engine/CmdletInfo.cs.html#cdd24b9416013a7d" class="t constructor">CmdletInfo</a>(<a href="#a07088863645f858" class="i field">_commandName</a>, <a href="#236ac3cd203d332b" class="i field">_commandType</a>, <b>null</b>, <b>null</b>, <a href="#ac3e35bbdc3f7513" class="i field">_context</a>);
 
            <a href="../../engine/CommandProcessor.cs.html#35bfa3d4fe5f92fc" class="t t">CommandProcessor</a> <span id="r10 rd" class="r10 r">cp</span> = <b>new</b> <a href="../../engine/CommandProcessor.cs.html#64adc694daeabdd8" class="t constructor">CommandProcessor</a>(<span class="r9 r">cmdletInfo</span>, <a href="#ac3e35bbdc3f7513" class="i field">_context</a>);
 
            <b>foreach</b> (<a href="../../engine/CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r11 rd" class="r11 r">par</span> <b>in</b> <a href="#b4b653eb0f150a0e" class="i field">_commandParameterList</a>)
            {
                <span class="r10 r">cp</span>.<a href="../../engine/CommandProcessorBase.cs.html#a862b2435f52bbdf" class="i method">AddParameter</a>(<span class="r11 r">par</span>);
            }
 
            <a href="#bb00e832b97263c8" class="i field">_pp</a>.<a href="../../engine/pipeline.cs.html#b06f99a3f17ecd81" class="i method">Add</a>(<span class="r10 r">cp</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Just dispose the pipeline processor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6609c3a8c47b823c" href="../../R/6609c3a8c47b823c.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (<a href="#bb00e832b97263c8" class="i field">_pp</a> == <b>null</b>)
                <b>return</b>;
 
            <a href="#bb00e832b97263c8" class="i field">_pp</a>.<a href="../../engine/pipeline.cs.html#3193eaf8bd4e8783" class="i method">Dispose</a>();
            <a href="#bb00e832b97263c8" class="i field">_pp</a> = <b>null</b>;
        }
 
        <b>private</b> <a href="../../engine/pipeline.cs.html#5e576bcabfa5c82b" class="t t">PipelineProcessor</a> <a id="bb00e832b97263c8" href="../../R/bb00e832b97263c8.html" target="n" data-glyph="46,1" class="i field">_pp</a> = <b>null</b>;
 
        <b>private string</b> <a id="a07088863645f858" href="../../R/a07088863645f858.html" target="n" data-glyph="46,1" class="i field">_commandName</a> = <b>null</b>;
        <b>private</b> <span class="i">Type</span> <a id="236ac3cd203d332b" href="../../R/236ac3cd203d332b.html" target="n" data-glyph="46,1" class="i field">_commandType</a>;
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="../../engine/CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="b4b653eb0f150a0e" href="../../R/b4b653eb0f150a0e.html" target="n" data-glyph="46,1" class="i field">_commandParameterList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../../engine/CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
 
        <b>private</b> <a href="../../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="ac3e35bbdc3f7513" href="../../R/ac3e35bbdc3f7513.html" target="n" data-glyph="46,1" class="i field">_context</a> = <b>null</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for the command-let&#39;s we expose</span>
    <span class="c">///</span><span class="c"> it contains a reference to the implementation</span>
    <span class="c">///</span><span class="c"> class it wraps.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="6f1170ef393f015d" href="../../R/6f1170ef393f015d.html" target="n" data-glyph="0,0" class="t t"><span id="bdfe751a66687188">FrontEndCommandBase</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Switches
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter specifies the current pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../engine/Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public</b> <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="5b63cc33eb03b359" href="../../R/5b63cc33eb03b359.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; } = <a href="../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hook up the calls from the implementation object</span>
        <span class="c">///</span><span class="c"> and then call the implementation&#39;s Begin()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="0203cc0f4a76912c" href="../../R/0203cc0f4a76912c.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a> != <b>null</b>, <span class="s">&quot;this.implementation is null&quot;</span>);
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#77e8016dce571e60" class="i field">OuterCmdletCall</a> = <b>new</b> <a href="#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a>.<span class="t">OuterCmdletCallback</span>(<a href="#6f1170ef393f015d" class="k">this</a>.<a href="#915674b56d34384c" class="i method">OuterCmdletCall</a>);
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#182fb8a272559cc5" class="i field">InputObjectCall</a> = <b>new</b> <a href="#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a>.<span class="t">InputObjectCallback</span>(<a href="#6f1170ef393f015d" class="k">this</a>.<a href="#03e7dff0a1ae93c9" class="i method">InputObjectCall</a>);
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#e5e431ca02487a5e" class="i field">WriteObjectCall</a> = <b>new</b> <a href="#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a>.<span class="t">WriteObjectCallback</span>(<a href="#6f1170ef393f015d" class="k">this</a>.<a href="#2253dbc2844d356c" class="i method">WriteObjectCall</a>);
 
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#d488bea854b916b6" class="i method">CreateTerminatingErrorContext</a>();
 
            <a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#5f205895950197ef" class="i method">BeginProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call the implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="a42822309fcbb9f2" href="../../R/a42822309fcbb9f2.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#a29cf9039f70c9d3" class="i method">ProcessRecord</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call the implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="31fcdf80aa97634d" href="../../R/31fcdf80aa97634d.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#f243d83d2a166983" class="i method">EndProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call the implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4f457784b9d9d062" href="../../R/4f457784b9d9d062.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#2eed6c25908a6b36" class="i method">StopProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for the implementation to obtain a reference to the Cmdlet object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Cmdlet reference.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected virtual</b> <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="915674b56d34384c" href="../../R/915674b56d34384c.html" target="n" data-glyph="75,1" class="i method">OuterCmdletCall</a>()
        {
            <b>return</b> <a href="#6f1170ef393f015d" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for the implementation to get the current pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Current object from the pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected virtual</b> <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="03e7dff0a1ae93c9" href="../../R/03e7dff0a1ae93c9.html" target="n" data-glyph="75,1" class="i method">InputObjectCall</a>()
        {
            <span class="c">// just bind to the input object parameter</span>
            <b>return</b> <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#5b63cc33eb03b359" class="i property">InputObject</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback for the implementation to write objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to be written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="2253dbc2844d356c" href="../../R/2253dbc2844d356c.html" target="n" data-glyph="75,1" class="i method">WriteObjectCall</a>(<b>object</b> <span id="r12 rd" class="r12 r">value</span>)
        {
            <span class="c">// just call Monad API</span>
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="../../engine/cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r12 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reference to the implementation command that this class</span>
        <span class="c">///</span><span class="c"> is wrapping.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#c91a68f3aa4854f8" class="t t">ImplementationCommandBase</a> <a id="1b0ab4db6b16490a" href="../../R/1b0ab4db6b16490a.html" target="n" data-glyph="44,1" class="i field">implementation</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Implementation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default implementation just delegates to internal helper.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This method calls GC.SuppressFinalize</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6be9f7be69627a33" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#f7ecc6c74226a44c" class="i method">Dispose</a>(<b>true</b>);
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#6f1170ef393f015d" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose pattern implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="f7ecc6c74226a44c" href="../../R/f7ecc6c74226a44c.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r13 rd" class="r13 r">disposing</span>)
        {
            <b>if</b> (<span class="r13 r">disposing</span>)
            {
                <a href="#b27f0d29516bb9e7" class="i method">InternalDispose</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do-nothing implementation: derived classes will override as see fit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="b27f0d29516bb9e7" href="../../R/b27f0d29516bb9e7.html" target="n" data-glyph="75,1" class="i method">InternalDispose</a>()
        {
            <b>if</b> (<a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a> == <b>null</b>)
                <b>return</b>;
 
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a>.<a href="#8ae9c69d7ca822e4" class="i method">Dispose</a>();
            <a href="#6f1170ef393f015d" class="k">this</a>.<a href="#1b0ab4db6b16490a" class="i field">implementation</a> = <b>null</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation class to be called by the outer command</span>
    <span class="c">///</span><span class="c"> In order to properly work, the callbacks have to be properly set by the outer command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="c91a68f3aa4854f8" href="../../R/c91a68f3aa4854f8.html" target="n" data-glyph="2,0" class="t t"><span id="ec222ba54bf60c36">ImplementationCommandBase</span></a> : <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inner version of CommandBase.BeginProcessing()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="5f205895950197ef" href="../../R/5f205895950197ef.html" target="n" data-glyph="74,1" class="i method">BeginProcessing</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inner version of CommandBase.ProcessRecord()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="a29cf9039f70c9d3" href="../../R/a29cf9039f70c9d3.html" target="n" data-glyph="74,1" class="i method">ProcessRecord</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inner version of CommandBase.EndProcessing()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="f243d83d2a166983" href="../../R/f243d83d2a166983.html" target="n" data-glyph="74,1" class="i method">EndProcessing</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Inner version of CommandBase.StopProcessing()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="2eed6c25908a6b36" href="../../R/2eed6c25908a6b36.html" target="n" data-glyph="74,1" class="i method">StopProcessing</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieve the current input pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="194a6ddb58a33583" href="../../R/194a6ddb58a33583.html" target="n" data-glyph="74,1" class="i method">ReadObject</a>()
        {
            <span class="c">// delegate to the front end object</span>
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#182fb8a272559cc5" class="i field">InputObjectCall</a> != <b>null</b>, <span class="s">&quot;this.InputObjectCall is null&quot;</span>);
            <b>return</b> <a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#182fb8a272559cc5" class="i field">InputObjectCall</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write an object to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to write to the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="fb27266ca93cb0b2" href="../../R/fb27266ca93cb0b2.html" target="n" data-glyph="74,1" class="i method">WriteObject</a>(<b>object</b> <span id="r14 rd" class="r14 r">o</span>)
        {
            <span class="c">// delegate to the front end object</span>
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#e5e431ca02487a5e" class="i field">WriteObjectCall</a> != <b>null</b>, <span class="s">&quot;this.WriteObjectCall is null&quot;</span>);
            <a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#e5e431ca02487a5e" class="i field">WriteObjectCall</a>(<span class="r14 r">o</span>);
        }
 
        <span class="c">// callback methods to get to the outer Monad Cmdlet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a hold of the Monad outer Cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="810407458232faa8" href="../../R/810407458232faa8.html" target="n" data-glyph="74,1" class="i method">OuterCmdlet</a>()
        {
            <span class="c">// delegate to the front end object</span>
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#77e8016dce571e60" class="i field">OuterCmdletCall</a> != <b>null</b>, <span class="s">&quot;this.OuterCmdletCall is null&quot;</span>);
            <b>return</b> <a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#77e8016dce571e60" class="i field">OuterCmdletCall</a>();
        }
 
        <b>protected</b> <a href="#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <a id="b2bcbcedcda4b3d3" href="../../R/b2bcbcedcda4b3d3.html" target="n" data-glyph="105,1" class="i property">TerminatingErrorContext</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal void</b> <a id="d488bea854b916b6" href="../../R/d488bea854b916b6.html" target="n" data-glyph="74,1" class="i method">CreateTerminatingErrorContext</a>()
        {
            <a href="#b2bcbcedcda4b3d3" class="i property">TerminatingErrorContext</a> = <b>new</b> <a href="#581f28e2926055c3" class="t constructor">TerminatingErrorContext</a>(<a href="#c91a68f3aa4854f8" class="k">this</a>.<a href="#810407458232faa8" class="i method">OuterCmdlet</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delegate definition to get to the outer command-let.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate</b> <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="6e5dd28db3a975a3" href="../../R/6e5dd28db3a975a3.html" target="n" data-glyph="14,1" class="t t"><span id="7b8a4ddcabd3e601">OuterCmdletCallback</span></a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback to get to the outer command-let.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#6e5dd28db3a975a3" class="t t">OuterCmdletCallback</a> <a id="77e8016dce571e60" href="../../R/77e8016dce571e60.html" target="n" data-glyph="44,1" class="i field">OuterCmdletCall</a>;
 
        <span class="c">// callback to the methods to get an object and write an object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delegate definition to get to the current pipeline input object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate</b> <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="204fd287bc3d4124" href="../../R/204fd287bc3d4124.html" target="n" data-glyph="14,1" class="t t"><span id="c5d6d7ed79ba8a86">InputObjectCallback</span></a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delegate definition to write object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate void</b> <a id="dca675166f5c722d" href="../../R/dca675166f5c722d.html" target="n" data-glyph="14,1" class="t t"><span id="5322afd29ff452bf">WriteObjectCallback</span></a>(<b>object</b> <span id="r15 rd" class="r15 r">o</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback to read object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#204fd287bc3d4124" class="t t">InputObjectCallback</a> <a id="182fb8a272559cc5" href="../../R/182fb8a272559cc5.html" target="n" data-glyph="44,1" class="i field">InputObjectCall</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Callback to write object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#dca675166f5c722d" class="t t">WriteObjectCallback</a> <a id="e5e431ca02487a5e" href="../../R/e5e431ca02487a5e.html" target="n" data-glyph="44,1" class="i field">WriteObjectCall</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Implementation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default implementation just delegates to internal helper.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This method calls GC.SuppressFinalize</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8ae9c69d7ca822e4" href="../../R/8ae9c69d7ca822e4.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#fd4c5eb5f455d6a4" class="i method">Dispose</a>(<b>true</b>);
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c91a68f3aa4854f8" class="k">this</a>);
        }
 
        <b>private void</b> <a id="fd4c5eb5f455d6a4" href="../../R/fd4c5eb5f455d6a4.html" target="n" data-glyph="76,1" class="i method">Dispose</a>(<b>bool</b> <span id="r16 rd" class="r16 r">disposing</span>)
        {
            <b>if</b> (<span class="r16 r">disposing</span>)
            {
                <a href="#b1d3f5a2bdd34bfe" class="i method">InternalDispose</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do-nothing implementation: derived classes will override as see fit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="b1d3f5a2bdd34bfe" href="../../R/b1d3f5a2bdd34bfe.html" target="n" data-glyph="75,1" class="i method">InternalDispose</a>()
        {
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    }
}
</pre></td></tr></table></div></body></html>
