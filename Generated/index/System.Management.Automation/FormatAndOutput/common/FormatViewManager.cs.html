<!DOCTYPE html>
<html><head><title>FormatViewManager.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(688);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/FormatViewManager.cs" target="_top">FormatAndOutput\common\FormatViewManager.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <b>internal static class</b> <a id="0dfec4e099bb5077" href="../../R/0dfec4e099bb5077.html" target="n" data-glyph="2,0" class="t t">DefaultScalarTypes</a>
    {
        <b>internal static bool</b> <a id="8fe777ecc8eb55fb" href="../../R/8fe777ecc8eb55fb.html" target="n" data-glyph="74,1" class="i method">IsTypeInList</a>(<span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r0 rd" class="r0 r">typeNames</span>)
        {
            <span class="c">// NOTE: we do not use inheritance here, since we deal with</span>
            <span class="c">// value types or with types where inheritance is not a factor for the selection</span>
            <b>string</b> <span id="r1 rd" class="r1 r">typeName</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#ff11eb07e566e898" class="i method">PSObjectIsOfExactType</a>(<span class="r0 r">typeNames</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1 r">typeName</span>))
                <b>return</b> <b>false</b>;
 
            <b>string</b> <span id="r2 rd" class="r2 r">originalTypeName</span> = <a href="../../engine/serialization.cs.html#27835b221aec7524" class="t t">Deserializer</a>.<a href="../../engine/serialization.cs.html#d085fa30e43177dc" class="i method">MaskDeserializationPrefix</a>(<span class="r1 r">typeName</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">originalTypeName</span>))
                <b>return</b> <b>false</b>;
 
            <span class="c">// check if the type is derived from a System.Enum</span>
            <span class="c">// e.g. in C#</span>
            <span class="c">// enum Foo { Red, Black, Green}</span>
 
            <b>if</b> (<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#4bf2c1de171773d8" class="i method">PSObjectIsEnum</a>(<span class="r0 r">typeNames</span>))
                <b>return</b> <b>true</b>;
 
            <b>return</b> <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Contains</span>(<span class="r2 r">originalTypeName</span>);
        }
 
        <b>static</b> <a id="5caa9e079abd9cc3" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">DefaultScalarTypes</a>()
        {
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.String&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.SByte&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Byte&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Int16&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.UInt16&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Int32&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.UInt32&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Int64&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.UInt64&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Char&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Single&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Double&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Boolean&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Decimal&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.IntPtr&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Security.SecureString&quot;</span>);
            <a href="#b7fcd94cba436e14" class="i field">s_defaultScalarTypesHash</a>.<span class="i">Add</span>(<span class="s">&quot;System.Numerics.BigInteger&quot;</span>);
        }
 
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="b7fcd94cba436e14" href="../../R/b7fcd94cba436e14.html" target="n" data-glyph="46,1" class="i field">s_defaultScalarTypesHash</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class to manage the selection of a desired view type and</span>
    <span class="c">///</span><span class="c"> manage state associated to the selected view.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="85c6ee82c806ad0f" href="../../R/85c6ee82c806ad0f.html" target="n" data-glyph="2,0" class="t t"><span id="9f7a396fe7a18f48">FormatViewManager</span></a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
        [<span class="i">TraceSource</span>(<span class="s">&quot;FormatViewBinding&quot;</span>, <span class="s">&quot;Format view binding&quot;</span>)]
        <b>private static readonly</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="6d1c6b59796b7f3e" href="../../R/6d1c6b59796b7f3e.html" target="n" data-glyph="46,1" class="i field">s_formatViewBindingTracer</a> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;FormatViewBinding&quot;</span>, <span class="s">&quot;Format view binding&quot;</span>, <b>false</b>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
 
        <b>private static string</b> <a id="795332630642fe3c" href="../../R/795332630642fe3c.html" target="n" data-glyph="76,1" class="i method">PSObjectTypeName</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">so</span>)
        {
            <span class="c">// if so is not null, its TypeNames will not be null</span>
            <b>if</b> (<span class="r3 r">so</span> != <b>null</b>)
            {
                <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r4 rd" class="r4 r">typeNames</span> = <span class="r3 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
                <b>if</b> (<span class="r4 r">typeNames</span>.<span class="i">Count</span> &gt; 0)
                {
                    <b>return</b> <span class="r4 r">typeNames</span>[0];
                }
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <b>internal void</b> <a id="3d32a9179d1e6116" href="../../R/3d32a9179d1e6116.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r5 rd" class="r5 r">errorContext</span>,
                                    <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r6 rd" class="r6 r">expressionFactory</span>,
                                    <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r7 rd" class="r7 r">db</span>,
                                    <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r8 rd" class="r8 r">so</span>,
                                    <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <span id="r9 rd" class="r9 r">shape</span>,
                                    <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r10 rd" class="r10 r">parameters</span>)
        {
            <a href="DisplayDatabase/displayDescriptionData.cs.html#a2841e9b0027167f" class="t t">ViewDefinition</a> <span id="r11 rd" class="r11 r">view</span> = <b>null</b>;
            <b>const string</b> <span id="r12 rd" class="r12 r">findViewType</span> = <span class="s">&quot;FINDING VIEW TYPE: {0}&quot;</span>;
            <b>const string</b> <span id="r13 rd" class="r13 r">findViewShapeType</span> = <span class="s">&quot;FINDING VIEW {0} TYPE: {1}&quot;</span>;
            <b>const string</b> <span id="r14 rd" class="r14 r">findViewNameType</span> = <span class="s">&quot;FINDING VIEW NAME: {0} TYPE: {1}&quot;</span>;
            <b>const string</b> <span id="r15 rd" class="r15 r">viewFound</span> = <span class="s">&quot;An applicable view has been found&quot;</span>;
            <b>const string</b> <span id="r16 rd" class="r16 r">viewNotFound</span> = <span class="s">&quot;No applicable view has been found&quot;</span>;
            <b>try</b>
            {
                <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<a href="DisplayDatabase/typeDataQuery.cs.html#ba71622808607920" class="i method">SetTracer</a>(<a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>);
 
                <span class="c">// shape not specified: we need to select one</span>
                <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r17 rd" class="r17 r">typeNames</span> = <span class="r8 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
                <b>if</b> (<span class="r9 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5698f6824831305f" class="i field">Undefined</a>)
                {
                    <b>using</b> (<a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(<span class="r12 r">findViewType</span>, <a href="#795332630642fe3c" class="i method">PSObjectTypeName</a>(<span class="r8 r">so</span>)))
                    {
                        <span class="r11 r">view</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetViewByShapeAndType</span>(<span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <span class="r9 r">shape</span>, <span class="r17 r">typeNames</span>, <b>null</b>);
                    }
 
                    <b>if</b> (<span class="r11 r">view</span> != <b>null</b>)
                    {
                        <span class="c">// we got a matching view from the database</span>
                        <span class="c">// use this and we are done</span>
                        <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#992481d22603f5f0" class="i method">SelectViewGeneratorFromViewDefinition</a>(
                                                <span class="r5 r">errorContext</span>,
                                                <span class="r6 r">expressionFactory</span>,
                                                <span class="r7 r">db</span>,
                                                <span class="r11 r">view</span>,
                                                <span class="r10 r">parameters</span>);
                        <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r15 r">viewFound</span>);
                        <a href="#1bb7a5ce0ef30212" class="i method">PrepareViewForRemoteObjects</a>(<a href="#b54274aaffb01f4b" class="i property">ViewGenerator</a>, <span class="r8 r">so</span>);
                        <b>return</b>;
                    }
 
                    <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r16 r">viewNotFound</span>);
                    <span class="c">// we did not get any default view (and shape), we need to force one</span>
                    <span class="c">// we just select properties out of the object itself, since they were not</span>
                    <span class="c">// specified on the command line</span>
                    <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#9c9f343a8011048a" class="i method">SelectViewGeneratorFromProperties</a>(<span class="r9 r">shape</span>, <span class="r8 r">so</span>, <span class="r5 r">errorContext</span>, <span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <b>null</b>);
                    <a href="#1bb7a5ce0ef30212" class="i method">PrepareViewForRemoteObjects</a>(<a href="#b54274aaffb01f4b" class="i property">ViewGenerator</a>, <span class="r8 r">so</span>);
 
                    <b>return</b>;
                }
 
                <span class="c">// we have a predefined shape: did the user specify properties on the command line?</span>
                <b>if</b> (<span class="r10 r">parameters</span> != <b>null</b> &amp;&amp; <span class="r10 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#76039c18012927ae" class="i field">mshParameterList</a>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#9c9f343a8011048a" class="i method">SelectViewGeneratorFromProperties</a>(<span class="r9 r">shape</span>, <span class="r8 r">so</span>, <span class="r5 r">errorContext</span>, <span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <span class="r10 r">parameters</span>);
                    <b>return</b>;
                }
 
                <span class="c">// predefined shape: did the user specify the name of a view?</span>
                <b>if</b> (<span class="r10 r">parameters</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r10 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#1a88a5a755966031" class="i field">viewName</a>))
                {
                    <b>using</b> (<a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#3e3de94a643f35de" class="i method">TraceScope</a>(<span class="r14 r">findViewNameType</span>, <span class="r10 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#1a88a5a755966031" class="i field">viewName</a>,
                        <a href="#795332630642fe3c" class="i method">PSObjectTypeName</a>(<span class="r8 r">so</span>)))
                    {
                        <span class="r11 r">view</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetViewByShapeAndType</span>(<span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <span class="r9 r">shape</span>, <span class="r17 r">typeNames</span>, <span class="r10 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#1a88a5a755966031" class="i field">viewName</a>);
                    }
 
                    <b>if</b> (<span class="r11 r">view</span> != <b>null</b>)
                    {
                        <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#992481d22603f5f0" class="i method">SelectViewGeneratorFromViewDefinition</a>(
                                                    <span class="r5 r">errorContext</span>,
                                                    <span class="r6 r">expressionFactory</span>,
                                                    <span class="r7 r">db</span>,
                                                    <span class="r11 r">view</span>,
                                                    <span class="r10 r">parameters</span>);
                        <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r15 r">viewFound</span>);
                        <b>return</b>;
                    }
 
                    <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r16 r">viewNotFound</span>);
                    <span class="c">// illegal input, we have to terminate</span>
                    <a href="#585d970150a0f1ca" class="i method">ProcessUnknownViewName</a>(<span class="r5 r">errorContext</span>, <span class="r10 r">parameters</span>.<a href="BaseFormattingCommandParameters.cs.html#1a88a5a755966031" class="i field">viewName</a>, <span class="r8 r">so</span>, <span class="r7 r">db</span>, <span class="r9 r">shape</span>);
                }
 
                <span class="c">// predefined shape: do we have a default view in format.ps1xml?</span>
                <b>using</b> (<a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<span class="i">TraceScope</span>(<span class="r13 r">findViewShapeType</span>, <span class="r9 r">shape</span>, <a href="#795332630642fe3c" class="i method">PSObjectTypeName</a>(<span class="r8 r">so</span>)))
                {
                    <span class="r11 r">view</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetViewByShapeAndType</span>(<span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <span class="r9 r">shape</span>, <span class="r17 r">typeNames</span>, <b>null</b>);
                }
 
                <b>if</b> (<span class="r11 r">view</span> != <b>null</b>)
                {
                    <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#992481d22603f5f0" class="i method">SelectViewGeneratorFromViewDefinition</a>(
                                                <span class="r5 r">errorContext</span>,
                                                <span class="r6 r">expressionFactory</span>,
                                                <span class="r7 r">db</span>,
                                                <span class="r11 r">view</span>,
                                                <span class="r10 r">parameters</span>);
                    <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r15 r">viewFound</span>);
                    <a href="#1bb7a5ce0ef30212" class="i method">PrepareViewForRemoteObjects</a>(<a href="#b54274aaffb01f4b" class="i property">ViewGenerator</a>, <span class="r8 r">so</span>);
 
                    <b>return</b>;
                }
 
                <a href="#6d1c6b59796b7f3e" class="i field">s_formatViewBindingTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="r16 r">viewNotFound</span>);
                <span class="c">// we just select properties out of the object itself</span>
                <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> = <a href="#9c9f343a8011048a" class="i method">SelectViewGeneratorFromProperties</a>(<span class="r9 r">shape</span>, <span class="r8 r">so</span>, <span class="r5 r">errorContext</span>, <span class="r6 r">expressionFactory</span>, <span class="r7 r">db</span>, <span class="r10 r">parameters</span>);
                <a href="#1bb7a5ce0ef30212" class="i method">PrepareViewForRemoteObjects</a>(<a href="#b54274aaffb01f4b" class="i property">ViewGenerator</a>, <span class="r8 r">so</span>);
            }
            <b>finally</b>
            {
                <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<a href="DisplayDatabase/typeDataQuery.cs.html#228399addcca3bf0" class="i method">ResetTracer</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prepares a given view for remote object processing ie., lets the view</span>
        <span class="c">///</span><span class="c"> display (or not) ComputerName property. This will query the object to</span>
        <span class="c">///</span><span class="c"> check if ComputerName property is present. If present, this will prepare</span>
        <span class="c">///</span><span class="c"> the view.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">viewGenerator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="1bb7a5ce0ef30212" href="../../R/1bb7a5ce0ef30212.html" target="n" data-glyph="76,1" class="i method">PrepareViewForRemoteObjects</a>(<a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <span id="r18 rd" class="r18 r">viewGenerator</span>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r19 rd" class="r19 r">so</span>)
        {
            <b>if</b> (<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#5b277609e87413fc" class="i method">ShouldShowComputerNameProperty</a>(<span class="r19 r">so</span>))
            {
                <span class="r18 r">viewGenerator</span>.<a href="FormatViewGenerator.cs.html#5f10a67e10b50942" class="i method">PrepareForRemoteObjects</a>(<span class="r19 r">so</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to process Unknown error message.</span>
        <span class="c">///</span><span class="c"> It helps is creating appropriate error message to</span>
        <span class="c">///</span><span class="c"> be displayed to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">errorContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">viewName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Uses supplied view name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Source object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">db</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Types info database.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">formatShape</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Requested format shape.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="585d970150a0f1ca" href="../../R/585d970150a0f1ca.html" target="n" data-glyph="76,1" class="i method">ProcessUnknownViewName</a>(<a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r20 rd" class="r20 r">errorContext</span>, <b>string</b> <span id="r21 rd" class="r21 r">viewName</span>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r22 rd" class="r22 r">so</span>, <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r23 rd" class="r23 r">db</span>, <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <span id="r24 rd" class="r24 r">formatShape</span>)
        {
            <b>string</b> <span id="r25 rd" class="r25 r">msg</span> = <b>null</b>;
            <b>bool</b> <span id="r26 rd" class="r26 r">foundValidViews</span> = <b>false</b>;
            <b>string</b> <span id="r27 rd" class="r27 r">formatTypeName</span> = <b>null</b>;
            <b>const string</b> <span id="r28 rd" class="r28 r">separator</span> = <span class="s">&quot;, &quot;</span>;
            <span class="i">StringBuilder</span> <span id="r29 rd" class="r29 r">validViewFormats</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>if</b> (<span class="r22 r">so</span> != <b>null</b> &amp;&amp; <span class="r22 r">so</span>.<a href="../../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> != <b>null</b> &amp;&amp;
                <span class="r23 r">db</span> != <b>null</b> &amp;&amp; <span class="r23 r">db</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#63e926f26a6da5a5" class="i field">viewDefinitionsSection</a> != <b>null</b> &amp;&amp;
                <span class="r23 r">db</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#63e926f26a6da5a5" class="i field">viewDefinitionsSection</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#bf04e3771cfbee35" class="i field">viewDefinitionList</a> != <b>null</b> &amp;&amp;
                <span class="r23 r">db</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#63e926f26a6da5a5" class="i field">viewDefinitionsSection</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#bf04e3771cfbee35" class="i field">viewDefinitionList</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">StringBuilder</span> <span id="r30 rd" class="r30 r">validViews</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>string</b> <span id="r31 rd" class="r31 r">currentObjectTypeName</span> = <span class="r22 r">so</span>.<a href="../../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>().<span class="i">ToString</span>();
 
                <span class="i">Type</span> <span id="r32 rd" class="r32 r">formatType</span> = <b>null</b>;
                <b>if</b> (<span class="r24 r">formatShape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#37eebd0cc455d8f9" class="i field">Table</a>)
                {
                    <span class="r32 r">formatType</span> = <b>typeof</b>(<a href="DisplayDatabase/displayDescriptionData_Table.cs.html#ccad4737e6e7dc9d" class="t t">TableControlBody</a>);
                    <span class="r27 r">formatTypeName</span> = <span class="s">&quot;Table&quot;</span>;
                }
                <b>else</b> <b>if</b> (<span class="r24 r">formatShape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#2b03b9d9f0f6e343" class="i field">List</a>)
                {
                    <span class="r32 r">formatType</span> = <b>typeof</b>(<a href="DisplayDatabase/displayDescriptionData_List.cs.html#3771338ebddfda56" class="t t">ListControlBody</a>);
                    <span class="r27 r">formatTypeName</span> = <span class="s">&quot;List&quot;</span>;
                }
                <b>else</b> <b>if</b> (<span class="r24 r">formatShape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#1895b57cea68b6b9" class="i field">Wide</a>)
                {
                    <span class="r32 r">formatType</span> = <b>typeof</b>(<a href="DisplayDatabase/displayDescriptionData_Wide.cs.html#6fd8600eba3bbaa2" class="t t">WideControlBody</a>);
                    <span class="r27 r">formatTypeName</span> = <span class="s">&quot;Wide&quot;</span>;
                }
                <b>else</b> <b>if</b> (<span class="r24 r">formatShape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#136f83366cb298b8" class="i field">Complex</a>)
                {
                    <span class="r32 r">formatType</span> = <b>typeof</b>(<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>);
                    <span class="r27 r">formatTypeName</span> = <span class="s">&quot;Custom&quot;</span>;
                }
 
                <b>if</b> (<span class="r32 r">formatType</span> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="DisplayDatabase/displayDescriptionData.cs.html#a2841e9b0027167f" class="t t">ViewDefinition</a> <span id="r33 rd" class="r33 r">currentViewDefinition</span> <b>in</b> <span class="r23 r">db</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#63e926f26a6da5a5" class="i field">viewDefinitionsSection</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#bf04e3771cfbee35" class="i field">viewDefinitionList</a>)
                    {
                        <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> != <b>null</b>)
                        {
                            <b>foreach</b> (<a href="DisplayDatabase/displayDescriptionData.cs.html#c83e340e0e2a174f" class="t t">TypeOrGroupReference</a> <span id="r34 rd" class="r34 r">currentTypeOrGroupReference</span> <b>in</b> <span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#32d268bba2ea075f" class="i field">appliesTo</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#e562e7ea6df51ae6" class="i field">referenceList</a>)
                            {
                                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r34 r">currentTypeOrGroupReference</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#df908891090d2c93" class="i field">name</a>) &amp;&amp;
                                    <b>string</b>.<span class="i">Equals</span>(<span class="r31 r">currentObjectTypeName</span>, <span class="r34 r">currentTypeOrGroupReference</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#df908891090d2c93" class="i field">name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a>.<span class="i">GetType</span>() == <span class="r32 r">formatType</span>)
                                    {
                                        <span class="r30 r">validViews</span>.<span class="i">Append</span>(<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>);
                                        <span class="r30 r">validViews</span>.<span class="i">Append</span>(<span class="r28 r">separator</span>);
                                    }
                                    <b>else</b> <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r21 r">viewName</span>, <span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>string</b> <span id="r35 rd" class="r35 r">cmdletFormatName</span> = <b>null</b>;
                                        <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#ccad4737e6e7dc9d" class="t t">TableControlBody</a>)
                                        {
                                            <span class="r35 r">cmdletFormatName</span> = <span class="s">&quot;Format-Table&quot;</span>;
                                        }
                                        <b>else</b> <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_List.cs.html#3771338ebddfda56" class="t t">ListControlBody</a>)
                                        {
                                            <span class="r35 r">cmdletFormatName</span> = <span class="s">&quot;Format-List&quot;</span>;
                                        }
                                        <b>else</b> <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Wide.cs.html#6fd8600eba3bbaa2" class="t t">WideControlBody</a>)
                                        {
                                            <span class="r35 r">cmdletFormatName</span> = <span class="s">&quot;Format-Wide&quot;</span>;
                                        }
                                        <b>else</b> <b>if</b> (<span class="r33 r">currentViewDefinition</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>)
                                        {
                                            <span class="r35 r">cmdletFormatName</span> = <span class="s">&quot;Format-Custom&quot;</span>;
                                        }
 
                                        <b>if</b> (<span class="r29 r">validViewFormats</span>.<span class="i">Length</span> == 0)
                                        {
                                            <b>string</b> <span id="r36 rd" class="r36 r">suggestValidViewNamePrefix</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">SuggestValidViewNamePrefix</span>);
                                            <span class="r29 r">validViewFormats</span>.<span class="i">Append</span>(<span class="r36 r">suggestValidViewNamePrefix</span>);
                                        }
                                        <b>else</b>
                                        {
                                            <span class="r29 r">validViewFormats</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                                        }
 
                                        <span class="r29 r">validViewFormats</span>.<span class="i">Append</span>(<span class="r35 r">cmdletFormatName</span>);
                                    }
                                }
                            }
                        }
                    }
                }
 
                <b>if</b> (<span class="r30 r">validViews</span>.<span class="i">Length</span> &gt; 0)
                {
                    <span class="r30 r">validViews</span>.<span class="i">Remove</span>(<span class="r30 r">validViews</span>.<span class="i">Length</span> - <span class="r28 r">separator</span>.<span class="i">Length</span>, <span class="r28 r">separator</span>.<span class="i">Length</span>);
                    <span class="r25 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">InvalidViewNameError</span>, <span class="r21 r">viewName</span>, <span class="r27 r">formatTypeName</span>, <span class="r30 r">validViews</span>.<span class="i">ToString</span>());
                    <span class="r26 r">foundValidViews</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (!<span class="r26 r">foundValidViews</span>)
            {
                <span class="i">StringBuilder</span> <span id="r37 rd" class="r37 r">unKnowViewFormatStringBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>if</b> (<span class="r29 r">validViewFormats</span>.<span class="i">Length</span> &gt; 0)
                {
                    <span class="c">// unKnowViewFormatStringBuilder.Append(StringUtil.Format(FormatAndOut_format_xxx.UnknownViewNameError, viewName));</span>
                    <span class="r37 r">unKnowViewFormatStringBuilder</span>.<span class="i">Append</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">UnknownViewNameErrorSuffix</span>, <span class="r21 r">viewName</span>, <span class="r27 r">formatTypeName</span>));
                    <span class="r37 r">unKnowViewFormatStringBuilder</span>.<span class="i">Append</span>(<span class="r29 r">validViewFormats</span>);
                }
                <b>else</b>
                {
                    <span class="r37 r">unKnowViewFormatStringBuilder</span>.<span class="i">Append</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">UnknownViewNameError</span>, <span class="r21 r">viewName</span>));
                    <span class="r37 r">unKnowViewFormatStringBuilder</span>.<span class="i">Append</span>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">NonExistingViewNameError</span>, <span class="r27 r">formatTypeName</span>, <span class="r22 r">so</span>.<a href="../../engine/MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>()));
                }
 
                <span class="r25 r">msg</span> = <span class="r37 r">unKnowViewFormatStringBuilder</span>.<span class="i">ToString</span>();
            }
 
            <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r38 rd" class="r38 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(
                                            <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>(),
                                            <span class="s">&quot;FormatViewNotFound&quot;</span>,
                                            <a href="../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../engine/ErrorPackage.cs.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                                            <span class="r21 r">viewName</span>);
 
            <span class="r38 r">errorRecord</span>.<a href="../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r25 r">msg</span>);
            <span class="r20 r">errorContext</span>.<a href="BaseCommand.cs.html#293390b36cb4485f" class="i method">ThrowTerminatingError</a>(<span class="r38 r">errorRecord</span>);
        }
 
        <b>internal</b> <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <a id="b54274aaffb01f4b" href="../../R/b54274aaffb01f4b.html" target="n" data-glyph="104,1" class="i property">ViewGenerator</a>
        {
            <b>get</b>
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a> != <b>null</b>, <span class="s">&quot;this.viewGenerator cannot be null&quot;</span>);
                <b>return</b> <a href="#1297f00d1ff224b9" class="i field">_viewGenerator</a>;
            }
        }
 
        <b>private static</b> <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <a id="992481d22603f5f0" href="../../R/992481d22603f5f0.html" target="n" data-glyph="76,1" class="i method">SelectViewGeneratorFromViewDefinition</a>(
                                        <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r39 rd" class="r39 r">errorContext</span>,
                                        <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r40 rd" class="r40 r">expressionFactory</span>,
                                        <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r41 rd" class="r41 r">db</span>,
                                        <a href="DisplayDatabase/displayDescriptionData.cs.html#a2841e9b0027167f" class="t t">ViewDefinition</a> <span id="r42 rd" class="r42 r">view</span>,
                                        <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r43 rd" class="r43 r">parameters</span>)
        {
            <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <span id="r44 rd" class="r44 r">viewGenerator</span> = <b>null</b>;
            <b>if</b> (<span class="r42 r">view</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Table.cs.html#ccad4737e6e7dc9d" class="t t">TableControlBody</a>)
            {
                <span class="r44 r">viewGenerator</span> = <b>new</b> <span class="t">TableViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r42 r">view</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_List.cs.html#3771338ebddfda56" class="t t">ListControlBody</a>)
            {
                <span class="r44 r">viewGenerator</span> = <b>new</b> <span class="t">ListViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r42 r">view</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Wide.cs.html#6fd8600eba3bbaa2" class="t t">WideControlBody</a>)
            {
                <span class="r44 r">viewGenerator</span> = <b>new</b> <span class="t">WideViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r42 r">view</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>)
            {
                <span class="r44 r">viewGenerator</span> = <b>new</b> <span class="t">ComplexViewGenerator</span>();
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r44 r">viewGenerator</span> != <b>null</b>, <span class="s">&quot;viewGenerator != null&quot;</span>);
            <span class="r44 r">viewGenerator</span>.<a href="FormatViewGenerator.cs.html#9cd46fe1c9c781b9" class="i method">Initialize</a>(<span class="r39 r">errorContext</span>, <span class="r40 r">expressionFactory</span>, <span class="r41 r">db</span>, <span class="r42 r">view</span>, <span class="r43 r">parameters</span>);
            <b>return</b> <span class="r44 r">viewGenerator</span>;
        }
 
        <b>private static</b> <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <a id="9c9f343a8011048a" href="../../R/9c9f343a8011048a.html" target="n" data-glyph="76,1" class="i method">SelectViewGeneratorFromProperties</a>(<a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a> <span id="r45 rd" class="r45 r">shape</span>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r46 rd" class="r46 r">so</span>,
                                    <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r47 rd" class="r47 r">errorContext</span>,
                                    <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r48 rd" class="r48 r">expressionFactory</span>,
                                    <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r49 rd" class="r49 r">db</span>,
                                    <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r50 rd" class="r50 r">parameters</span>)
        {
            <span class="c">// use some heuristics to determine the shape if none is specified</span>
            <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5698f6824831305f" class="i field">Undefined</a> &amp;&amp; <span class="r50 r">parameters</span> == <b>null</b>)
            {
                <span class="c">// check first if we have a known shape for a type</span>
                <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r51 rd" class="r51 r">typeNames</span> = <span class="r46 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
                <span class="r45 r">shape</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetShapeFromType</span>(<span class="r48 r">expressionFactory</span>, <span class="r49 r">db</span>, <span class="r51 r">typeNames</span>);
 
                <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5698f6824831305f" class="i field">Undefined</a>)
                {
                    <span class="c">// check if we can have a table:</span>
                    <span class="c">// we want to get the # of properties we are going to display</span>
                    <span class="i">List</span>&lt;<a href="Utilities/Mshexpression.cs.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>&gt; <span id="r52 rd" class="r52 r">expressionList</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#790e58b6ea611caf" class="i method">GetDefaultPropertySet</a>(<span class="r46 r">so</span>);
                    <b>if</b> (<span class="r52 r">expressionList</span>.<span class="i">Count</span> == 0)
                    {
                        <span class="c">// we failed to get anything from a property set</span>
                        <span class="c">// we just get the first properties out of the first object</span>
                        <b>foreach</b> (<a href="Utilities/MshParameterAssociation.cs.html#5b4350463581137f" class="t t">MshResolvedExpressionParameterAssociation</a> <span id="r53 rd" class="r53 r">mrepa</span> <b>in</b> <a href="Utilities/MshParameterAssociation.cs.html#74bd0302d2e8a453" class="t t">AssociationManager</a>.<a href="Utilities/MshParameterAssociation.cs.html#cabeb4b5070a19b8" class="i method">ExpandAll</a>(<span class="r46 r">so</span>))
                        {
                            <span class="r52 r">expressionList</span>.<span class="i">Add</span>(<span class="r53 r">mrepa</span>.<a href="Utilities/MshParameterAssociation.cs.html#b52bad4dbc0efdac" class="i property">ResolvedExpression</a>);
                        }
                    }
 
                    <span class="c">// decide what shape we want for the given number of properties</span>
                    <span class="r45 r">shape</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetShapeFromPropertyCount</span>(<span class="r49 r">db</span>, <span class="r52 r">expressionList</span>.<span class="i">Count</span>);
                }
            }
 
            <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <span id="r54 rd" class="r54 r">viewGenerator</span> = <b>null</b>;
            <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#37eebd0cc455d8f9" class="i field">Table</a>)
            {
                <span class="r54 r">viewGenerator</span> = <b>new</b> <span class="t">TableViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#2b03b9d9f0f6e343" class="i field">List</a>)
            {
                <span class="r54 r">viewGenerator</span> = <b>new</b> <span class="t">ListViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#1895b57cea68b6b9" class="i field">Wide</a>)
            {
                <span class="r54 r">viewGenerator</span> = <b>new</b> <span class="t">WideViewGenerator</span>();
            }
            <b>else</b> <b>if</b> (<span class="r45 r">shape</span> == <a href="DisplayDatabase/displayDescriptionData.cs.html#04ea493f07f17b0e" class="t t">FormatShape</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#136f83366cb298b8" class="i field">Complex</a>)
            {
                <span class="r54 r">viewGenerator</span> = <b>new</b> <span class="t">ComplexViewGenerator</span>();
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r54 r">viewGenerator</span> != <b>null</b>, <span class="s">&quot;viewGenerator != null&quot;</span>);
 
            <span class="r54 r">viewGenerator</span>.<a href="FormatViewGenerator.cs.html#833496cb40edf527" class="i method">Initialize</a>(<span class="r47 r">errorContext</span>, <span class="r48 r">expressionFactory</span>, <span class="r46 r">so</span>, <span class="r49 r">db</span>, <span class="r50 r">parameters</span>);
            <b>return</b> <span class="r54 r">viewGenerator</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The view generator that produced data for a selected shape.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <a id="1297f00d1ff224b9" href="../../R/1297f00d1ff224b9.html" target="n" data-glyph="46,1" class="i field">_viewGenerator</a> = <b>null</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class to manage the selection of a desired view type</span>
    <span class="c">///</span><span class="c"> for out of band objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="269774e606f18d4a" href="../../R/269774e606f18d4a.html" target="n" data-glyph="2,0" class="t t">OutOfBandFormatViewManager</a>
    {
        <b>private static bool</b> <a id="c2286d9f56ed1351" href="../../R/c2286d9f56ed1351.html" target="n" data-glyph="76,1" class="i method">IsNotRemotingProperty</a>(<b>string</b> <span id="r55 rd" class="r55 r">name</span>)
        {
            <b>var</b> <span id="r56 rd" class="r56 r">isRemotingPropertyName</span> = <span class="r55 r">name</span>.<span class="i">Equals</span>(<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#b64ee1a165cf4e4d" class="i field">ComputerNameNoteProperty</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                   || <span class="r55 r">name</span>.<span class="i">Equals</span>(<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#63fb661fa395e3a3" class="i field">ShowComputerNameNoteProperty</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                   || <span class="r55 r">name</span>.<span class="i">Equals</span>(<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#283cde56f2755f0c" class="i field">RunspaceIdNoteProperty</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                   || <span class="r55 r">name</span>.<span class="i">Equals</span>(<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../../engine/remoting/common/WireDataFormat/EncodeAndDecode.cs.html#b6939c85b2591c0c" class="i field">SourceJobInstanceId</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>return</b> !<span class="r56 r">isRemotingPropertyName</span>;
        }
 
        <b>private static readonly</b> <a href="../../engine/MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <a id="48d1c02ce04efb82" href="../../R/48d1c02ce04efb82.html" target="n" data-glyph="46,1" class="i field">NameIsNotRemotingProperty</a> = <a href="#c2286d9f56ed1351" class="i method">IsNotRemotingProperty</a>;
 
        <b>internal static bool</b> <a id="71f7066b7e5a3036" href="../../R/71f7066b7e5a3036.html" target="n" data-glyph="74,1" class="i method">HasNonRemotingProperties</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r57 rd" class="r57 r">so</span>) =&gt; <span class="r57 r">so</span>.<a href="../../engine/MshObject.cs.html#1c0e9bcb3834bacc" class="i method">GetFirstPropertyOrDefault</a>(<a href="#48d1c02ce04efb82" class="i field">NameIsNotRemotingProperty</a>) != <b>null</b>;
 
        <b>internal static</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <a id="599d5de51adea7e6" href="../../R/599d5de51adea7e6.html" target="n" data-glyph="74,1" class="i method">GenerateOutOfBandData</a>(<a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r58 rd" class="r58 r">errorContext</span>, <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r59 rd" class="r59 r">expressionFactory</span>,
                    <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r60 rd" class="r60 r">db</span>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r61 rd" class="r61 r">so</span>, <b>int</b> <span id="r62 rd" class="r62 r">enumerationLimit</span>, <b>bool</b> <span id="r63 rd" class="r63 r">useToStringFallback</span>, <b>out</b> <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r64 rd" class="r64 r">errors</span>)
        {
            <span class="r64 r">errors</span> = <b>null</b>;
 
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r65 rd" class="r65 r">typeNames</span> = <span class="r61 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <a href="DisplayDatabase/displayDescriptionData.cs.html#a2841e9b0027167f" class="t t">ViewDefinition</a> <span id="r66 rd" class="r66 r">view</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<span class="i">GetOutOfBandView</span>(<span class="r59 r">expressionFactory</span>, <span class="r60 r">db</span>, <span class="r65 r">typeNames</span>);
 
            <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a> <span id="r67 rd" class="r67 r">outOfBandViewGenerator</span>;
            <b>if</b> (<span class="r66 r">view</span> != <b>null</b>)
            {
                <span class="c">// process an out of band view retrieved from the display database</span>
                <b>if</b> (<span class="r66 r">view</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>)
                {
                    <span class="r67 r">outOfBandViewGenerator</span> = <b>new</b> <span class="t">ComplexViewGenerator</span>();
                }
                <b>else</b>
                {
                    <span class="r67 r">outOfBandViewGenerator</span> = <b>new</b> <span class="t">ListViewGenerator</span>();
                }
 
                <span class="r67 r">outOfBandViewGenerator</span>.<a href="FormatViewGenerator.cs.html#9cd46fe1c9c781b9" class="i method">Initialize</a>(<span class="r58 r">errorContext</span>, <span class="r59 r">expressionFactory</span>, <span class="r60 r">db</span>, <span class="r66 r">view</span>, <b>null</b>);
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#0dfec4e099bb5077" class="t t">DefaultScalarTypes</a>.<span class="i">IsTypeInList</span>(<span class="r65 r">typeNames</span>)
                    || !<a href="#71f7066b7e5a3036" class="i method">HasNonRemotingProperties</a>(<span class="r61 r">so</span>))
                {
                    <span class="c">// we force a ToString() on well known types</span>
                    <b>return</b> <a href="#98375fbb715665f2" class="i method">GenerateOutOfBandObjectAsToString</a>(<span class="r61 r">so</span>);
                }
 
                <b>if</b> (!<span class="r63 r">useToStringFallback</span>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// we must check we have enough properties for a list view</span>
                <b>if</b> (<b>new</b> <a href="Utilities/Mshexpression.cs.html#484c4460dc545619" class="t constructor">PSPropertyExpression</a>(<span class="s">&quot;*&quot;</span>).<a href="Utilities/Mshexpression.cs.html#b282aad8812891f2" class="i method">ResolveNames</a>(<span class="r61 r">so</span>).<span class="i">Count</span> == 0)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// we do not have a view, we default to list view</span>
                <span class="c">// process an out of band view as a default</span>
                <span class="r67 r">outOfBandViewGenerator</span> = <b>new</b> <span class="t">ListViewGenerator</span>();
                <span class="r67 r">outOfBandViewGenerator</span>.<a href="FormatViewGenerator.cs.html#833496cb40edf527" class="i method">Initialize</a>(<span class="r58 r">errorContext</span>, <span class="r59 r">expressionFactory</span>, <span class="r61 r">so</span>, <span class="r60 r">db</span>, <b>null</b>);
            }
 
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r68 rd" class="r68 r">fed</span> = <span class="r67 r">outOfBandViewGenerator</span>.<a href="FormatViewGenerator.cs.html#c3fea5a39fe015f9" class="i method">GeneratePayload</a>(<span class="r61 r">so</span>, <span class="r62 r">enumerationLimit</span>);
            <span class="r68 r">fed</span>.<a href="FormattingObjects.cs.html#59a0e653a3524695" class="i field">outOfBand</a> = <b>true</b>;
            <span class="r68 r">fed</span>.<a href="FormattingObjects.cs.html#778494cb50302a19" class="i field">writeStream</a> = <span class="r61 r">so</span>.<a href="../../engine/MshObject.cs.html#e3bac6ee3e22d6dc" class="i property">WriteStream</a>;
 
            <span class="r64 r">errors</span> = <span class="r67 r">outOfBandViewGenerator</span>.<a href="FormatViewGenerator.cs.html#8a2162eacf099bc6" class="i property">ErrorManager</a>.<a href="#f68eea41bf77f42b" class="i method">DrainFailedResultList</a>();
 
            <b>return</b> <span class="r68 r">fed</span>;
        }
 
        <b>internal static</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <a id="98375fbb715665f2" href="../../R/98375fbb715665f2.html" target="n" data-glyph="74,1" class="i method">GenerateOutOfBandObjectAsToString</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r69 rd" class="r69 r">so</span>)
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r70 rd" class="r70 r">fed</span> = <b>new</b> <span class="t">FormatEntryData</span>();
            <span class="r70 r">fed</span>.<a href="FormattingObjects.cs.html#59a0e653a3524695" class="i field">outOfBand</a> = <b>true</b>;
 
            <a href="../../P/a62f9103f62f1601.html#a62f9103f62f1601" class="t t">RawTextFormatEntry</a> <span id="r71 rd" class="r71 r">rawTextEntry</span> = <b>new</b> <span class="t">RawTextFormatEntry</span>();
            <span class="r71 r">rawTextEntry</span>.<a href="FormattingObjects.cs.html#4a19b20fca76aab8" class="i field">text</a> = <span class="r69 r">so</span>.<a href="../../engine/MshObject.cs.html#298666357e641f03" class="i method">ToString</a>();
            <span class="r70 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> = <span class="r71 r">rawTextEntry</span>;
 
            <b>return</b> <span class="r70 r">fed</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class to manage the logging of errors resulting from</span>
    <span class="c">///</span><span class="c"> evaluations of PSPropertyExpression instances</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Depending on settings, it queues the failing PSPropertyExpressionResult</span>
    <span class="c">///</span><span class="c"> instances and generates a list of out-of-band FormatEntryData</span>
    <span class="c">///</span><span class="c"> objects to be sent to the output pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="c96e2566b8ef87f3" href="../../R/c96e2566b8ef87f3.html" target="n" data-glyph="2,0" class="t t">FormatErrorManager</a>
    {
        <b>internal</b> <a id="b1873303d8eb78a3" href="../../R/b1873303d8eb78a3.html" target="n" data-glyph="74,1" class="t constructor">FormatErrorManager</a>(<a href="DisplayDatabase/displayDescriptionData.cs.html#18b4c1b2e0ae9821" class="t t">FormatErrorPolicy</a> <span id="r72 rd" class="r72 r">formatErrorPolicy</span>)
        {
            <a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a> = <span class="r72 r">formatErrorPolicy</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Log a failed evaluation of an PSPropertyExpression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSPropertyExpressionResult containing the failed evaluation data.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">sourceObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object used to evaluate the PSPropertyExpression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="7cc094527e60e409" href="../../R/7cc094527e60e409.html" target="n" data-glyph="74,1" class="i method">LogPSPropertyExpressionFailedResult</a>(<a href="Utilities/Mshexpression.cs.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a> <span id="r73 rd" class="r73 r">result</span>, <b>object</b> <span id="r74 rd" class="r74 r">sourceObject</span>)
        {
            <b>if</b> (!<a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#4bb7858f6fc0148a" class="i property">ShowErrorsAsMessages</a>)
                <b>return</b>;
            <a href="Utilities/MshObjectUtil.cs.html#838c705d30ff70d2" class="t t">PSPropertyExpressionError</a> <span id="r75 rd" class="r75 r">error</span> = <b>new</b> <span class="t">PSPropertyExpressionError</span>();
            <span class="r75 r">error</span>.<a href="Utilities/MshObjectUtil.cs.html#978024d49e2568e4" class="i field">result</a> = <span class="r73 r">result</span>;
            <span class="r75 r">error</span>.<a href="Utilities/MshObjectUtil.cs.html#953f8cc5addb2241" class="i field">sourceObject</a> = <span class="r74 r">sourceObject</span>;
            <a href="#aa20337d012c1c15" class="i field">_formattingErrorList</a>.<span class="i">Add</span>(<span class="r75 r">error</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Log a failed formatting operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String format error object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="97dfdc35a9bb1ad1" href="../../R/97dfdc35a9bb1ad1.html" target="n" data-glyph="74,1" class="i method">LogStringFormatError</a>(<a href="Utilities/MshObjectUtil.cs.html#b2c053e472911f78" class="t t">StringFormatError</a> <span id="r76 rd" class="r76 r">error</span>)
        {
            <b>if</b> (!<a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#4bb7858f6fc0148a" class="i property">ShowErrorsAsMessages</a>)
                <b>return</b>;
            <a href="#aa20337d012c1c15" class="i field">_formattingErrorList</a>.<span class="i">Add</span>(<span class="r76 r">error</span>);
        }
 
        <b>internal bool</b> <a id="b7ca91a1c7843d84" href="../../R/b7ca91a1c7843d84.html" target="n" data-glyph="104,1" class="i property">DisplayErrorStrings</a>
        {
            <b>get</b> { <b>return</b> <a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#8539dcca38fb4f53" class="i property">ShowErrorsInFormattedOutput</a>; }
        }
 
        <b>internal bool</b> <a id="67e8e6ea42f6a2c3" href="../../R/67e8e6ea42f6a2c3.html" target="n" data-glyph="104,1" class="i property">DisplayFormatErrorString</a>
        {
            <b>get</b>
            {
                <span class="c">// NOTE: we key off the same flag</span>
                <b>return</b> <a href="#c96e2566b8ef87f3" class="k">this</a>.<a href="#b7ca91a1c7843d84" class="i property">DisplayErrorStrings</a>;
            }
        }
 
        <b>internal string</b> <a id="ee6fa415b7246812" href="../../R/ee6fa415b7246812.html" target="n" data-glyph="104,1" class="i property">ErrorString</a>
        {
            <b>get</b> { <b>return</b> <a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#0066ddd892dd2f1c" class="i field">errorStringInFormattedOutput</a>; }
        }
 
        <b>internal string</b> <a id="c53687bf77ffa1fd" href="../../R/c53687bf77ffa1fd.html" target="n" data-glyph="104,1" class="i property">FormatErrorString</a>
        {
            <b>get</b> { <b>return</b> <a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#83c25677f7030db9" class="i field">formatErrorStringInFormattedOutput</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provide a list of ErrorRecord entries</span>
        <span class="c">///</span><span class="c"> to be written to the error pipeline and clear the list of pending</span>
        <span class="c">///</span><span class="c"> errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of ErrorRecord objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="f68eea41bf77f42b" href="../../R/f68eea41bf77f42b.html" target="n" data-glyph="74,1" class="i method">DrainFailedResultList</a>()
        {
            <b>if</b> (!<a href="#2f33c0c61a6e1149" class="i field">_formatErrorPolicy</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#4bb7858f6fc0148a" class="i property">ShowErrorsAsMessages</a>)
                <b>return</b> <b>null</b>;
 
            <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r77 rd" class="r77 r">retVal</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
            <b>foreach</b> (<a href="Utilities/MshObjectUtil.cs.html#6ede2b1afddeca57" class="t t">FormattingError</a> <span id="r78 rd" class="r78 r">error</span> <b>in</b> <a href="#aa20337d012c1c15" class="i field">_formattingErrorList</a>)
            {
                <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r79 rd" class="r79 r">errorRecord</span> = <a href="#e5a8a797ffb0296d" class="i method">GenerateErrorRecord</a>(<span class="r78 r">error</span>);
                <b>if</b> (<span class="r79 r">errorRecord</span> != <b>null</b>)
                    <span class="r77 r">retVal</span>.<span class="i">Add</span>(<span class="r79 r">errorRecord</span>);
            }
 
            <a href="#aa20337d012c1c15" class="i field">_formattingErrorList</a>.<span class="i">Clear</span>();
            <b>return</b> <span class="r77 r">retVal</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Conversion between an error internal representation and ErrorRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Internal error object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Corresponding ErrorRecord instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="e5a8a797ffb0296d" href="../../R/e5a8a797ffb0296d.html" target="n" data-glyph="76,1" class="i method">GenerateErrorRecord</a>(<a href="Utilities/MshObjectUtil.cs.html#6ede2b1afddeca57" class="t t">FormattingError</a> <span id="r80 rd" class="r80 r">error</span>)
        {
            <a href="../../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r81 rd" class="r81 r">errorRecord</span> = <b>null</b>;
            <b>string</b> <span id="r82 rd" class="r82 r">msg</span> = <b>null</b>;
            <a href="Utilities/MshObjectUtil.cs.html#838c705d30ff70d2" class="t t">PSPropertyExpressionError</a> <span id="r83 rd" class="r83 r">psPropertyExpressionError</span> = <span class="r80 r">error</span> <b>as</b> <a href="Utilities/MshObjectUtil.cs.html#838c705d30ff70d2" class="t t">PSPropertyExpressionError</a>;
            <b>if</b> (<span class="r83 r">psPropertyExpressionError</span> != <b>null</b>)
            {
                <span class="r81 r">errorRecord</span> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(
                                <span class="r83 r">psPropertyExpressionError</span>.<a href="Utilities/MshObjectUtil.cs.html#978024d49e2568e4" class="i field">result</a>.<a href="Utilities/Mshexpression.cs.html#a35b9dec64c079ad" class="i property">Exception</a>,
                                <span class="s">&quot;PSPropertyExpressionError&quot;</span>,
                                <a href="../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <span class="r83 r">psPropertyExpressionError</span>.<a href="Utilities/MshObjectUtil.cs.html#953f8cc5addb2241" class="i field">sourceObject</a>);
 
                <span class="r82 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">PSPropertyExpressionError</span>,
                    <span class="r83 r">psPropertyExpressionError</span>.<a href="Utilities/MshObjectUtil.cs.html#978024d49e2568e4" class="i field">result</a>.<a href="Utilities/Mshexpression.cs.html#e5f78ff6d355262e" class="i property">ResolvedExpression</a>.<a href="Utilities/Mshexpression.cs.html#4f5da54f51065de6" class="i method">ToString</a>());
                <span class="r81 r">errorRecord</span>.<a href="../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r82 r">msg</span>);
            }
 
            <a href="Utilities/MshObjectUtil.cs.html#b2c053e472911f78" class="t t">StringFormatError</a> <span id="r84 rd" class="r84 r">formattingError</span> = <span class="r80 r">error</span> <b>as</b> <a href="Utilities/MshObjectUtil.cs.html#b2c053e472911f78" class="t t">StringFormatError</a>;
            <b>if</b> (<span class="r84 r">formattingError</span> != <b>null</b>)
            {
                <span class="r81 r">errorRecord</span> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(
                                <span class="r84 r">formattingError</span>.<a href="Utilities/MshObjectUtil.cs.html#f4c78e3b4f174ffb" class="i field">exception</a>,
                                <span class="s">&quot;formattingError&quot;</span>,
                                <a href="../../engine/ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../engine/ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <span class="r84 r">formattingError</span>.<a href="Utilities/MshObjectUtil.cs.html#953f8cc5addb2241" class="i field">sourceObject</a>);
 
                <span class="r82 r">msg</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">FormatAndOut_format_xxx</span>.<span class="i">FormattingError</span>,
                    <span class="r84 r">formattingError</span>.<a href="Utilities/MshObjectUtil.cs.html#eeb7251b546d4e9f" class="i field">formatString</a>);
                <span class="r81 r">errorRecord</span>.<a href="../../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="../../engine/ErrorPackage.cs.html#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r82 r">msg</span>);
            }
 
            <b>return</b> <span class="r81 r">errorRecord</span>;
        }
 
        <b>private readonly</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#18b4c1b2e0ae9821" class="t t">FormatErrorPolicy</a> <a id="2f33c0c61a6e1149" href="../../R/2f33c0c61a6e1149.html" target="n" data-glyph="46,1" class="i field">_formatErrorPolicy</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current list of failed PSPropertyExpression evaluations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="Utilities/MshObjectUtil.cs.html#6ede2b1afddeca57" class="t t">FormattingError</a>&gt; <a id="aa20337d012c1c15" href="../../R/aa20337d012c1c15.html" target="n" data-glyph="46,1" class="i field">_formattingErrorList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="Utilities/MshObjectUtil.cs.html#6ede2b1afddeca57" class="t t">FormattingError</a>&gt;();
    }
}
</pre></td></tr></table></div></body></html>
