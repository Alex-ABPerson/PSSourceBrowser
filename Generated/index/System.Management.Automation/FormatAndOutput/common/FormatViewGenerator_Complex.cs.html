<!DOCTYPE html>
<html><head><title>FormatViewGenerator_Complex.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(783);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/FormatAndOutput/common/FormatViewGenerator_Complex.cs" target="_top">FormatAndOutput\common\FormatViewGenerator_Complex.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>
{
    <b>internal sealed class</b> <a id="5cc9c4af85907827" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="7fa3198a6c790b91">ComplexViewGenerator</span></a> : <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="t t">ViewGenerator</a>
    {
        <b>internal override void</b> <a id="6759ac0a36d47896" href="../../R/6759ac0a36d47896.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r0 rd" class="r0 r">errorContext</span>, <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r1 rd" class="r1 r">expressionFactory</span>,
            <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r2 rd" class="r2 r">so</span>, <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r3 rd" class="r3 r">db</span>, <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r4 rd" class="r4 r">parameters</span>)
        {
            <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="k">base</a>.<a href="FormatViewGenerator.cs.html#833496cb40edf527" class="i method">Initialize</a>(<span class="r0 r">errorContext</span>, <span class="r1 r">expressionFactory</span>, <span class="r2 r">so</span>, <span class="r3 r">db</span>, <span class="r4 r">parameters</span>);
            <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#dd84c23f790c4386" class="i field">inputParameters</a> = <span class="r4 r">parameters</span>;
        }
 
        <b>internal override</b> <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <a id="fd84a68ca487ce2b" href="../../R/fd84a68ca487ce2b.html" target="n" data-glyph="74,1" class="i method">GenerateStartData</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r5 rd" class="r5 r">so</span>)
        {
            <a href="../../P/9d01b2c6a374f73c.html#9d01b2c6a374f73c" class="t t">FormatStartData</a> <span id="r6 rd" class="r6 r">startFormat</span> = <a href="FormatViewGenerator.cs.html#114d05fb89fdbf3a" class="k">base</a>.<a href="FormatViewGenerator.cs.html#57afcf95360e2136" class="i method">GenerateStartData</a>(<span class="r5 r">so</span>);
            <span class="r6 r">startFormat</span>.<a href="FormattingObjects.cs.html#5b221bdd992b6985" class="i field">shapeInfo</a> = <b>new</b> <span class="t">ComplexViewHeaderInfo</span>();
            <b>return</b> <span class="r6 r">startFormat</span>;
        }
 
        <b>internal override</b> <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <a id="a760a4769d87a0eb" href="../../R/a760a4769d87a0eb.html" target="n" data-glyph="74,1" class="i method">GeneratePayload</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r7 rd" class="r7 r">so</span>, <b>int</b> <span id="r8 rd" class="r8 r">enumerationLimit</span>)
        {
            <a href="../../P/f4000593193508ac.html#f4000593193508ac" class="t t">FormatEntryData</a> <span id="r9 rd" class="r9 r">fed</span> = <b>new</b> <span class="t">FormatEntryData</span>();
 
            <b>if</b> (<a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#f359c9daefc97a85" class="i field">dataBaseInfo</a>.<a href="FormatViewGenerator.cs.html#eed4b417ecb3ef9f" class="i field">view</a> != <b>null</b>)
                <span class="r9 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> = <a href="#f3f09211fd81c460" class="i method">GenerateComplexViewEntryFromDataBaseInfo</a>(<span class="r7 r">so</span>, <span class="r8 r">enumerationLimit</span>);
            <b>else</b>
                <span class="r9 r">fed</span>.<a href="FormattingObjects.cs.html#56d0b66ce8c292b0" class="i field">formatEntryInfo</a> = <a href="#4e244d08ddeaf139" class="i method">GenerateComplexViewEntryFromProperties</a>(<span class="r7 r">so</span>, <span class="r8 r">enumerationLimit</span>);
            <b>return</b> <span class="r9 r">fed</span>;
        }
 
        <b>private</b> <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <a id="4e244d08ddeaf139" href="../../R/4e244d08ddeaf139.html" target="n" data-glyph="76,1" class="i method">GenerateComplexViewEntryFromProperties</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r10 rd" class="r10 r">so</span>, <b>int</b> <span id="r11 rd" class="r11 r">enumerationLimit</span>)
        {
            <a href="#81235efa38066810" class="t t">ComplexViewObjectBrowser</a> <span id="r12 rd" class="r12 r">browser</span> = <b>new</b> <a href="#b25186b91b11741b" class="t constructor">ComplexViewObjectBrowser</a>(<a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#8a2162eacf099bc6" class="i property">ErrorManager</a>, <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#c2479d77e0c5066e" class="i field">expressionFactory</a>, <span class="r11 r">enumerationLimit</span>);
            <b>return</b> <span class="r12 r">browser</span>.<a href="#78e05e359bdd7c5c" class="i method">GenerateView</a>(<span class="r10 r">so</span>, <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#dd84c23f790c4386" class="i field">inputParameters</a>);
        }
 
        <b>private</b> <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <a id="f3f09211fd81c460" href="../../R/f3f09211fd81c460.html" target="n" data-glyph="76,1" class="i method">GenerateComplexViewEntryFromDataBaseInfo</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r13 rd" class="r13 r">so</span>, <b>int</b> <span id="r14 rd" class="r14 r">enumerationLimit</span>)
        {
            <span class="c">// execute on the format directive</span>
            <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r15 rd" class="r15 r">cve</span> = <b>new</b> <span class="t">ComplexViewEntry</span>();
 
            <span class="c">// NOTE: we set a max depth to protect ourselves from infinite loops</span>
            <b>const int</b> <span id="r16 rd" class="r16 r">maxTreeDepth</span> = 50;
            <a href="#09aae07112cd0765" class="t t">ComplexControlGenerator</a> <span id="r17 rd" class="r17 r">controlGenerator</span> =
                            <b>new</b> <a href="#f2a7ff7295a53441" class="t constructor">ComplexControlGenerator</a>(<a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#f359c9daefc97a85" class="i field">dataBaseInfo</a>.<a href="FormatViewGenerator.cs.html#9ae8dc35895a1d32" class="i field">db</a>,
                                    <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#f359c9daefc97a85" class="i field">dataBaseInfo</a>.<a href="FormatViewGenerator.cs.html#eed4b417ecb3ef9f" class="i field">view</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#c9b22677d64cbd6d" class="i field">loadingInfo</a>,
                                    <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#c2479d77e0c5066e" class="i field">expressionFactory</a>,
                                    <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#f359c9daefc97a85" class="i field">dataBaseInfo</a>.<a href="FormatViewGenerator.cs.html#eed4b417ecb3ef9f" class="i field">view</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5caf58c73baca5e5" class="i field">formatControlDefinitionHolder</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#63ed85d946592a81" class="i field">controlDefinitionList</a>,
                                    <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#8a2162eacf099bc6" class="i property">ErrorManager</a>,
                                    <span class="r14 r">enumerationLimit</span>,
                                    <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#7ef585c8382b83f1" class="i field">errorContext</a>);
 
            <span class="r17 r">controlGenerator</span>.<a href="#bab824a128bef20a" class="i method">GenerateFormatEntries</a>(<span class="r16 r">maxTreeDepth</span>,
                <a href="#5cc9c4af85907827" class="k">this</a>.<a href="FormatViewGenerator.cs.html#f359c9daefc97a85" class="i field">dataBaseInfo</a>.<a href="FormatViewGenerator.cs.html#eed4b417ecb3ef9f" class="i field">view</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a>, <span class="r13 r">so</span>, <span class="r15 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>);
            <b>return</b> <span class="r15 r">cve</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class to process a complex control directive and generate</span>
    <span class="c">///</span><span class="c"> the corresponding formatting tokens.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="09aae07112cd0765" href="../../R/09aae07112cd0765.html" target="n" data-glyph="2,0" class="t t">ComplexControlGenerator</a>
    {
        <b>internal</b> <a id="f2a7ff7295a53441" href="../../R/f2a7ff7295a53441.html" target="n" data-glyph="74,1" class="t constructor">ComplexControlGenerator</a>(<a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <span id="r18 rd" class="r18 r">dataBase</span>,
                                            <a href="DisplayDatabase/displayDescriptionData.cs.html#6f18a6e62cd3034a" class="t t">DatabaseLoadingInfo</a> <span id="r19 rd" class="r19 r">loadingInfo</span>,
                                            <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r20 rd" class="r20 r">expressionFactory</span>,
                                            <span class="i">List</span>&lt;<a href="DisplayDatabase/displayDescriptionData.cs.html#2f33871deccdeb6a" class="t t">ControlDefinition</a>&gt; <span id="r21 rd" class="r21 r">controlDefinitionList</span>,
                                            <a href="FormatViewManager.cs.html#c96e2566b8ef87f3" class="t t">FormatErrorManager</a> <span id="r22 rd" class="r22 r">resultErrorManager</span>,
                                            <b>int</b> <span id="r23 rd" class="r23 r">enumerationLimit</span>,
                                            <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <span id="r24 rd" class="r24 r">errorContext</span>)
        {
            <a href="#e63ff45029b1c6d5" class="i field">_db</a> = <span class="r18 r">dataBase</span>;
            <a href="#fe15e09fa236a65d" class="i field">_loadingInfo</a> = <span class="r19 r">loadingInfo</span>;
            <a href="#d28ddc33143e502f" class="i field">_expressionFactory</a> = <span class="r20 r">expressionFactory</span>;
            <a href="#a213e860bf94e5ee" class="i field">_controlDefinitionList</a> = <span class="r21 r">controlDefinitionList</span>;
            <a href="#99d808d5886c8288" class="i field">_errorManager</a> = <span class="r22 r">resultErrorManager</span>;
            <a href="#85907f58eca8a0b7" class="i field">_enumerationLimit</a> = <span class="r23 r">enumerationLimit</span>;
            <a href="#93b519a62fc6ad5d" class="i field">_errorContext</a> = <span class="r24 r">errorContext</span>;
        }
 
        <b>internal void</b> <a id="bab824a128bef20a" href="../../R/bab824a128bef20a.html" target="n" data-glyph="74,1" class="i method">GenerateFormatEntries</a>(<b>int</b> <span id="r25 rd" class="r25 r">maxTreeDepth</span>, <a href="DisplayDatabase/displayDescriptionData.cs.html#8f28d7f0c894b08f" class="t t">ControlBase</a> <span id="r26 rd" class="r26 r">control</span>,
                <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r27 rd" class="r27 r">so</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r28 rd" class="r28 r">formatValueList</span>)
        {
            <b>if</b> (<span class="r26 r">control</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r26 r">control</span>));
            }
 
            <a href="#1b58a9a96df94f83" class="i method">ExecuteFormatControl</a>(<b>new</b> <a href="#ddb35deed014f4f2" class="t constructor">TraversalInfo</a>(0, <span class="r25 r">maxTreeDepth</span>), <span class="r26 r">control</span>,
                                    <span class="r27 r">so</span>, <span class="r28 r">formatValueList</span>);
        }
 
        <b>private bool</b> <a id="1b58a9a96df94f83" href="../../R/1b58a9a96df94f83.html" target="n" data-glyph="76,1" class="i method">ExecuteFormatControl</a>(<a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r29 rd" class="r29 r">level</span>, <a href="DisplayDatabase/displayDescriptionData.cs.html#8f28d7f0c894b08f" class="t t">ControlBase</a> <span id="r30 rd" class="r30 r">control</span>,
        <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r31 rd" class="r31 r">so</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r32 rd" class="r32 r">formatValueList</span>)
        {
            <span class="c">// we are looking for a complex control to execute</span>
            <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a> <span id="r33 rd" class="r33 r">complexBody</span> = <b>null</b>;
 
            <span class="c">// we might have a reference</span>
            <a href="DisplayDatabase/displayDescriptionData.cs.html#d96b19e9f459881c" class="t t">ControlReference</a> <span id="r34 rd" class="r34 r">controlReference</span> = <span class="r30 r">control</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#d96b19e9f459881c" class="t t">ControlReference</a>;
            <b>if</b> (<span class="r34 r">controlReference</span> != <b>null</b> &amp;&amp; <span class="r34 r">controlReference</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#e17a51c99fe16fa6" class="i field">controlType</a> == <b>typeof</b>(<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>))
            {
                <span class="c">// retrieve the reference</span>
                <span class="r33 r">complexBody</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#9a6b41001553727b" class="t t">DisplayDataQuery</a>.<a href="DisplayDatabase/typeDataQuery.cs.html#de7000f465d0e8c8" class="i method">ResolveControlReference</a>(
                                        <a href="#e63ff45029b1c6d5" class="i field">_db</a>,
                                        <a href="#a213e860bf94e5ee" class="i field">_controlDefinitionList</a>,
                                        <span class="r34 r">controlReference</span>) <b>as</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>;
            }
            <b>else</b>
            {
                <span class="c">// try as an in line control</span>
                <span class="r33 r">complexBody</span> = <span class="r30 r">control</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>;
            }
 
            <span class="c">// finally, execute the control body</span>
            <b>if</b> (<span class="r33 r">complexBody</span> != <b>null</b>)
            {
                <span class="c">// we have an inline control, just execute it</span>
                <a href="#d06a23ea07b13249" class="i method">ExecuteFormatControlBody</a>(<span class="r29 r">level</span>, <span class="r31 r">so</span>, <span class="r33 r">complexBody</span>, <span class="r32 r">formatValueList</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private void</b> <a id="d06a23ea07b13249" href="../../R/d06a23ea07b13249.html" target="n" data-glyph="76,1" class="i method">ExecuteFormatControlBody</a>(<a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r35 rd" class="r35 r">level</span>,
                <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r36 rd" class="r36 r">so</span>, <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a> <span id="r37 rd" class="r37 r">complexBody</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r38 rd" class="r38 r">formatValueList</span>)
        {
            <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a> <span id="r39 rd" class="r39 r">activeControlEntryDefinition</span> =
                    <a href="#359ce5fbef6204be" class="i method">GetActiveComplexControlEntryDefinition</a>(<span class="r37 r">complexBody</span>, <span class="r36 r">so</span>);
 
            <a href="#93176ff6d676da2a" class="i method">ExecuteFormatTokenList</a>(<span class="r35 r">level</span>,
                                 <span class="r36 r">so</span>, <span class="r39 r">activeControlEntryDefinition</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#2e6c7078199a0a87" class="i field">itemDefinition</a>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#6ec68525c45d8456" class="i field">formatTokenList</a>, <span class="r38 r">formatValueList</span>);
        }
 
        <b>private</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a> <a id="359ce5fbef6204be" href="../../R/359ce5fbef6204be.html" target="n" data-glyph="76,1" class="i method">GetActiveComplexControlEntryDefinition</a>(<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a> <span id="r40 rd" class="r40 r">complexBody</span>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r41 rd" class="r41 r">so</span>)
        {
            <span class="c">// see if we have an override that matches</span>
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r42 rd" class="r42 r">typeNames</span> = <span class="r41 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <a href="DisplayDatabase/typeDataQuery.cs.html#4160365ef9194840" class="t t">TypeMatch</a> <span id="r43 rd" class="r43 r">match</span> = <b>new</b> <span class="t">TypeMatch</span>(<a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>, <a href="#e63ff45029b1c6d5" class="i field">_db</a>, <span class="r42 r">typeNames</span>);
            <b>foreach</b> (<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a> <span id="r44 rd" class="r44 r">x</span> <b>in</b> <span class="r40 r">complexBody</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#174fdbef536fb93b" class="i field">optionalEntryList</a>)
            {
                <b>if</b> (<span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#35fbe3fded1f5f58" class="i method">PerfectMatch</a>(<b>new</b> <a href="DisplayDatabase/typeDataQuery.cs.html#7c5d4ed20a71f83a" class="t constructor">TypeMatchItem</a>(<span class="r44 r">x</span>, <span class="r44 r">x</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#566a2784c455086f" class="i field">appliesTo</a>, <span class="r41 r">so</span>)))
                {
                    <b>return</b> <span class="r44 r">x</span>;
                }
            }
 
            <b>if</b> (<span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#e4b748ecf1e6a974" class="i property">BestMatch</a> != <b>null</b>)
            {
                <b>return</b> <span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#e4b748ecf1e6a974" class="i property">BestMatch</a> <b>as</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a>;
            }
            <b>else</b>
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r45 rd" class="r45 r">typesWithoutPrefix</span> = <a href="../../engine/serialization.cs.html#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">MaskDeserializationPrefix</span>(<span class="r42 r">typeNames</span>);
                <b>if</b> (<span class="r45 r">typesWithoutPrefix</span> != <b>null</b>)
                {
                    <span class="r43 r">match</span> = <b>new</b> <a href="DisplayDatabase/typeDataQuery.cs.html#81107a9d67dfb853" class="t constructor">TypeMatch</a>(<a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>, <a href="#e63ff45029b1c6d5" class="i field">_db</a>, <span class="r45 r">typesWithoutPrefix</span>);
                    <b>foreach</b> (<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a> <span id="r46 rd" class="r46 r">x</span> <b>in</b> <span class="r40 r">complexBody</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#174fdbef536fb93b" class="i field">optionalEntryList</a>)
                    {
                        <b>if</b> (<span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#35fbe3fded1f5f58" class="i method">PerfectMatch</a>(<b>new</b> <a href="DisplayDatabase/typeDataQuery.cs.html#e89f42829fd9ee71" class="t constructor">TypeMatchItem</a>(<span class="r46 r">x</span>, <span class="r46 r">x</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#566a2784c455086f" class="i field">appliesTo</a>)))
                        {
                            <b>return</b> <span class="r46 r">x</span>;
                        }
                    }
 
                    <b>if</b> (<span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#e4b748ecf1e6a974" class="i property">BestMatch</a> != <b>null</b>)
                    {
                        <b>return</b> <span class="r43 r">match</span>.<a href="DisplayDatabase/typeDataQuery.cs.html#e4b748ecf1e6a974" class="i property">BestMatch</a> <b>as</b> <a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#f45a1bce8f5f571d" class="t t">ComplexControlEntryDefinition</a>;
                    }
                }
 
                <span class="c">// we do not have any override, use default</span>
                <b>return</b> <span class="r40 r">complexBody</span>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#b7e4fd11cf1878b2" class="i field">defaultEntry</a>;
            }
        }
 
        <b>private void</b> <a id="93176ff6d676da2a" href="../../R/93176ff6d676da2a.html" target="n" data-glyph="76,1" class="i method">ExecuteFormatTokenList</a>(<a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r47 rd" class="r47 r">level</span>,
                <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r48 rd" class="r48 r">so</span>, <span class="i">List</span>&lt;<a href="DisplayDatabase/displayDescriptionData.cs.html#3165e4839d638a14" class="t t">FormatToken</a>&gt; <span id="r49 rd" class="r49 r">formatTokenList</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r50 rd" class="r50 r">formatValueList</span>)
        {
            <b>if</b> (<span class="r48 r">so</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r48 r">so</span>));
            }
 
            <span class="c">// guard against infinite loop</span>
            <b>if</b> (<span class="r47 r">level</span>.<a href="#8cd5778150daaddf" class="i property">Level</a> == <span class="r47 r">level</span>.<a href="#b7f6af8a5c17beed" class="i property">MaxDepth</a>)
            {
                <b>return</b>;
            }
 
            <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r51 rd" class="r51 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
 
            <span class="r50 r">formatValueList</span>.<span class="i">Add</span>(<span class="r51 r">fe</span>);
            <span class="k preprocess">#</span><span class="k preprocess">region</span> foreach loop
            <b>foreach</b> (<a href="DisplayDatabase/displayDescriptionData.cs.html#3165e4839d638a14" class="t t">FormatToken</a> <span id="r52 rd" class="r52 r">t</span> <b>in</b> <span class="r49 r">formatTokenList</span>)
            {
                <a href="DisplayDatabase/displayDescriptionData.cs.html#9ea056dc3d88f871" class="t t">TextToken</a> <span id="r53 rd" class="r53 r">tt</span> = <span class="r52 r">t</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#9ea056dc3d88f871" class="t t">TextToken</a>;
                <b>if</b> (<span class="r53 r">tt</span> != <b>null</b>)
                {
                    <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r54 rd" class="r54 r">ftf</span> = <b>new</b> <span class="t">FormatTextField</span>();
                    <span class="r54 r">ftf</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <a href="#e63ff45029b1c6d5" class="i field">_db</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#e0a60407d1f4cd87" class="i field">displayResourceManagerCache</a>.<a href="DisplayDatabase/displayResourceManagerCache.cs.html#e5be68d2e2dc5e03" class="i method">GetTextTokenString</a>(<span class="r53 r">tt</span>);
                    <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r54 r">ftf</span>);
                    <b>continue</b>;
                }
 
                <a href="DisplayDatabase/displayDescriptionData.cs.html#90c7a11dd5bf40b9" class="k">var</a> <span id="r55 rd" class="r55 r">newline</span> = <span class="r52 r">t</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#90c7a11dd5bf40b9" class="t t">NewLineToken</a>;
                <b>if</b> (<span class="r55 r">newline</span> != <b>null</b>)
                {
                    <b>for</b> (<b>int</b> <span id="r56 rd" class="r56 r">i</span> = 0; <span class="r56 r">i</span> &lt; <span class="r55 r">newline</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#20917f3293ed14b3" class="i field">count</a>; <span class="r56 r">i</span>++)
                    {
                        <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
                    }
 
                    <b>continue</b>;
                }
 
                <a href="DisplayDatabase/displayDescriptionData.cs.html#fbfb7a1c796e4583" class="t t">FrameToken</a> <span id="r57 rd" class="r57 r">ft</span> = <span class="r52 r">t</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#fbfb7a1c796e4583" class="t t">FrameToken</a>;
                <b>if</b> (<span class="r57 r">ft</span> != <b>null</b>)
                {
                    <span class="c">// instantiate a new entry and attach a frame info object</span>
                    <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r58 rd" class="r58 r">feFrame</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
                    <span class="r58 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a> = <b>new</b> <span class="t">FrameInfo</span>();
 
                    <span class="c">// add the frame info</span>
                    <span class="r58 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#39cc530b5fe0b069" class="i field">firstLine</a> = <span class="r57 r">ft</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#ca4e66c87c45b617" class="i field">frameInfoDefinition</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#b7d2dcd04c6f327f" class="i field">firstLine</a>;
                    <span class="r58 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#32b84b84ce7d6de1" class="i field">leftIndentation</a> = <span class="r57 r">ft</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#ca4e66c87c45b617" class="i field">frameInfoDefinition</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#1cdf969f8416851b" class="i field">leftIndentation</a>;
                    <span class="r58 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#3193e186da1897ae" class="i field">rightIndentation</a> = <span class="r57 r">ft</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#ca4e66c87c45b617" class="i field">frameInfoDefinition</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#b345a59343577c2f" class="i field">rightIndentation</a>;
 
                    <span class="c">// execute the list inside the frame</span>
                    <a href="#93176ff6d676da2a" class="i method">ExecuteFormatTokenList</a>(<span class="r47 r">level</span>, <span class="r48 r">so</span>, <span class="r57 r">ft</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#65ae9878360152fd" class="i field">itemDefinition</a>.<a href="DisplayDatabase/displayDescriptionData_Complex.cs.html#6ec68525c45d8456" class="i field">formatTokenList</a>, <span class="r58 r">feFrame</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>);
 
                    <span class="c">// add the frame computation results to the current format entry</span>
                    <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r58 r">feFrame</span>);
                    <b>continue</b>;
                }
                <span class="k preprocess">#</span><span class="k preprocess">region</span> CompoundPropertyToken
                <a href="DisplayDatabase/displayDescriptionData.cs.html#2fef245f1232b6cc" class="t t">CompoundPropertyToken</a> <span id="r59 rd" class="r59 r">cpt</span> = <span class="r52 r">t</span> <b>as</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#2fef245f1232b6cc" class="t t">CompoundPropertyToken</a>;
                <b>if</b> (<span class="r59 r">cpt</span> != <b>null</b>)
                {
                    <b>if</b> (!<a href="#211074da49d73141" class="i method">EvaluateDisplayCondition</a>(<span class="r48 r">so</span>, <span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#bc89f26dd68ecce3" class="i field">conditionToken</a>))
                    {
                        <span class="c">// token not active, skip it</span>
                        <b>continue</b>;
                    }
 
                    <span class="c">// get the property from the object</span>
                    <b>object</b> <span id="r60 rd" class="r60 r">val</span> = <b>null</b>;
 
                    <span class="c">// if no expression was specified, just use the</span>
                    <span class="c">// object itself</span>
                    <b>if</b> (<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#290a24606a772090" class="i field">expression</a> == <b>null</b> || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#290a24606a772090" class="i field">expression</a>.<a href="DisplayDatabase/displayDescriptionData.cs.html#5d00f85462b58293" class="i field">expressionValue</a>))
                    {
                        <span class="r60 r">val</span> = <span class="r48 r">so</span>;
                    }
                    <b>else</b>
                    {
                        <a href="Utilities/Mshexpression.cs.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r61 rd" class="r61 r">ex</span> = <a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>.<a href="Utilities/MshObjectUtil.cs.html#7824b14db1a1b446" class="i method">CreateFromExpressionToken</a>(<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#290a24606a772090" class="i field">expression</a>, <a href="#fe15e09fa236a65d" class="i field">_loadingInfo</a>);
                        <span class="i">List</span>&lt;<a href="Utilities/Mshexpression.cs.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a>&gt; <span id="r62 rd" class="r62 r">resultList</span> = <span class="r61 r">ex</span>.<a href="Utilities/Mshexpression.cs.html#1e7cef19203a999b" class="i method">GetValues</a>(<span class="r48 r">so</span>);
                        <b>if</b> (<span class="r62 r">resultList</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="r60 r">val</span> = <span class="r62 r">resultList</span>[0].<span class="i">Result</span>;
                            <b>if</b> (<span class="r62 r">resultList</span>[0].<span class="i">Exception</span> != <b>null</b>)
                            {
                                <a href="#99d808d5886c8288" class="i field">_errorManager</a>.<span class="i">LogPSPropertyExpressionFailedResult</span>(<span class="r62 r">resultList</span>[0], <span class="r48 r">so</span>);
                            }
                        }
                    }
 
                    <span class="c">// if the token is has a formatting string, it&#39;s a leaf node,</span>
                    <span class="c">// do the formatting and we will be done</span>
                    <b>if</b> (<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a> == <b>null</b> || <span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a> <b>is</b> <a href="DisplayDatabase/displayDescriptionData_Misc.cs.html#8b203e8b8f221c9d" class="t t">FieldControlBody</a>)
                    {
                        <span class="c">// Since it is a leaf node we just consider it an empty string and go</span>
                        <span class="c">// on with formatting</span>
                        <b>if</b> (<span class="r60 r">val</span> == <b>null</b>)
                        {
                            <span class="r60 r">val</span> = <b>string</b>.<span class="i">Empty</span>;
                        }
 
                        <a href="DisplayDatabase/displayDescriptionData.cs.html#94a81ac7165c610e" class="t t">FieldFormattingDirective</a> <span id="r63 rd" class="r63 r">fieldFormattingDirective</span> = <b>null</b>;
                        <a href="Utilities/MshObjectUtil.cs.html#b2c053e472911f78" class="t t">StringFormatError</a> <span id="r64 rd" class="r64 r">formatErrorObject</span> = <b>null</b>;
                        <b>if</b> (<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a> != <b>null</b>)
                        {
                            <span class="r63 r">fieldFormattingDirective</span> = ((<a href="DisplayDatabase/displayDescriptionData_Misc.cs.html#8b203e8b8f221c9d" class="t t">FieldControlBody</a>)<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a>).<a href="DisplayDatabase/displayDescriptionData_Misc.cs.html#1527c60678548045" class="i field">fieldFormattingDirective</a>;
                            <b>if</b> (<span class="r63 r">fieldFormattingDirective</span> != <b>null</b> &amp;&amp; <a href="#99d808d5886c8288" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#67e8e6ea42f6a2c3" class="i property">DisplayFormatErrorString</a>)
                            {
                                <span class="r64 r">formatErrorObject</span> = <b>new</b> <span class="t">StringFormatError</span>();
                            }
                        }
 
                        <span class="i">IEnumerable</span> <span id="r65 rd" class="r65 r">e</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r60 r">val</span>);
                        <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r66 rd" class="r66 r">fpf</span> = <b>new</b> <span class="t">FormatPropertyField</span>();
                        <b>if</b> (<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#b8143f210ef4f18c" class="i field">enumerateCollection</a> &amp;&amp; <span class="r65 r">e</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>object</b> <span id="r67 rd" class="r67 r">x</span> <b>in</b> <span class="r65 r">e</span>)
                            {
                                <b>if</b> (<span class="r67 r">x</span> == <b>null</b>)
                                {
                                    <span class="c">// nothing to process</span>
                                    <b>continue</b>;
                                }
 
                                <span class="r66 r">fpf</span> = <b>new</b> <span class="t">FormatPropertyField</span>();
 
                                <span class="r66 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#e4612b43d245b791" class="i method">FormatField</a>(<span class="r63 r">fieldFormattingDirective</span>, <span class="r67 r">x</span>, <a href="#85907f58eca8a0b7" class="i field">_enumerationLimit</a>, <span class="r64 r">formatErrorObject</span>, <a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>);
                                <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r66 r">fpf</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r66 r">fpf</span> = <b>new</b> <span class="t">FormatPropertyField</span>();
 
                            <span class="r66 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#e4612b43d245b791" class="i method">FormatField</a>(<span class="r63 r">fieldFormattingDirective</span>, <span class="r60 r">val</span>, <a href="#85907f58eca8a0b7" class="i field">_enumerationLimit</a>, <span class="r64 r">formatErrorObject</span>, <a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>);
                            <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r66 r">fpf</span>);
                        }
 
                        <b>if</b> (<span class="r64 r">formatErrorObject</span> != <b>null</b> &amp;&amp; <span class="r64 r">formatErrorObject</span>.<a href="Utilities/MshObjectUtil.cs.html#f4c78e3b4f174ffb" class="i field">exception</a> != <b>null</b>)
                        {
                            <a href="#99d808d5886c8288" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#97dfdc35a9bb1ad1" class="i method">LogStringFormatError</a>(<span class="r64 r">formatErrorObject</span>);
                            <span class="r66 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="#99d808d5886c8288" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#c53687bf77ffa1fd" class="i property">FormatErrorString</a>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// An empty result that is not a leaf node should not be expanded</span>
                        <b>if</b> (<span class="r60 r">val</span> == <b>null</b>)
                        {
                            <b>continue</b>;
                        }
 
                        <span class="i">IEnumerable</span> <span id="r68 rd" class="r68 r">e</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r60 r">val</span>);
                        <b>if</b> (<span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#b8143f210ef4f18c" class="i field">enumerateCollection</a> &amp;&amp; <span class="r68 r">e</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>object</b> <span id="r69 rd" class="r69 r">x</span> <b>in</b> <span class="r68 r">e</span>)
                            {
                                <b>if</b> (<span class="r69 r">x</span> == <b>null</b>)
                                {
                                    <span class="c">// nothing to process</span>
                                    <b>continue</b>;
                                }
 
                                <span class="c">// proceed with the recursion</span>
                                <a href="#1b58a9a96df94f83" class="i method">ExecuteFormatControl</a>(<span class="r47 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a>, <a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r69 r">x</span>), <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="c">// proceed with the recursion</span>
                            <a href="#1b58a9a96df94f83" class="i method">ExecuteFormatControl</a>(<span class="r47 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <span class="r59 r">cpt</span>.<a href="DisplayDatabase/displayDescriptionData.cs.html#7a9545ab76072c90" class="i field">control</a>, <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r60 r">val</span>), <span class="r51 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>);
                        }
                    }
                }
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CompoundPropertyToken
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> foreach loop
        }
 
        <b>private bool</b> <a id="211074da49d73141" href="../../R/211074da49d73141.html" target="n" data-glyph="76,1" class="i method">EvaluateDisplayCondition</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r70 rd" class="r70 r">so</span>, <a href="DisplayDatabase/displayDescriptionData.cs.html#82a5bbc134cdede1" class="t t">ExpressionToken</a> <span id="r71 rd" class="r71 r">conditionToken</span>)
        {
            <b>if</b> (<span class="r71 r">conditionToken</span> == <b>null</b>)
                <b>return</b> <b>true</b>;
 
            <a href="Utilities/Mshexpression.cs.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r72 rd" class="r72 r">ex</span> = <a href="#d28ddc33143e502f" class="i field">_expressionFactory</a>.<a href="Utilities/MshObjectUtil.cs.html#7824b14db1a1b446" class="i method">CreateFromExpressionToken</a>(<span class="r71 r">conditionToken</span>, <a href="#fe15e09fa236a65d" class="i field">_loadingInfo</a>);
            <a href="Utilities/Mshexpression.cs.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a> <span id="r73 rd" class="r73 r">expressionResult</span>;
            <b>bool</b> <span id="r74 rd" class="r74 r">retVal</span> = <a href="DisplayDatabase/typeDataQuery.cs.html#ef3dc2db8049371b" class="t t">DisplayCondition</a>.<a href="DisplayDatabase/typeDataQuery.cs.html#6d5d07c7b0fd2b94" class="i method">Evaluate</a>(<span class="r70 r">so</span>, <span class="r72 r">ex</span>, <b>out</b> <span class="r73 r">expressionResult</span>);
 
            <b>if</b> (<span class="r73 r">expressionResult</span> != <b>null</b> &amp;&amp; <span class="r73 r">expressionResult</span>.<a href="Utilities/Mshexpression.cs.html#a35b9dec64c079ad" class="i property">Exception</a> != <b>null</b>)
            {
                <a href="#99d808d5886c8288" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#7cc094527e60e409" class="i method">LogPSPropertyExpressionFailedResult</a>(<span class="r73 r">expressionResult</span>, <span class="r70 r">so</span>);
            }
 
            <b>return</b> <span class="r74 r">retVal</span>;
        }
 
        <b>private readonly</b> <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="t t">TypeInfoDataBase</a> <a id="e63ff45029b1c6d5" href="../../R/e63ff45029b1c6d5.html" target="n" data-glyph="46,1" class="i field">_db</a>;
        <b>private readonly</b> <a href="DisplayDatabase/displayDescriptionData.cs.html#6f18a6e62cd3034a" class="t t">DatabaseLoadingInfo</a> <a id="fe15e09fa236a65d" href="../../R/fe15e09fa236a65d.html" target="n" data-glyph="46,1" class="i field">_loadingInfo</a>;
        <b>private readonly</b> <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <a id="d28ddc33143e502f" href="../../R/d28ddc33143e502f.html" target="n" data-glyph="46,1" class="i field">_expressionFactory</a>;
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="DisplayDatabase/displayDescriptionData.cs.html#2f33871deccdeb6a" class="t t">ControlDefinition</a>&gt; <a id="a213e860bf94e5ee" href="../../R/a213e860bf94e5ee.html" target="n" data-glyph="46,1" class="i field">_controlDefinitionList</a>;
        <b>private readonly</b> <a href="FormatViewManager.cs.html#c96e2566b8ef87f3" class="t t">FormatErrorManager</a> <a id="99d808d5886c8288" href="../../R/99d808d5886c8288.html" target="n" data-glyph="46,1" class="i field">_errorManager</a>;
        <b>private readonly</b> <a href="BaseCommand.cs.html#2dfdff306d6451a6" class="t t">TerminatingErrorContext</a> <a id="93b519a62fc6ad5d" href="../../R/93b519a62fc6ad5d.html" target="n" data-glyph="46,1" class="i field">_errorContext</a>;
        <b>private readonly int</b> <a id="85907f58eca8a0b7" href="../../R/85907f58eca8a0b7.html" target="n" data-glyph="46,1" class="i field">_enumerationLimit</a>;
    }
 
    <b>internal class</b> <a id="1c4877727c3f6aa6" href="../../R/1c4877727c3f6aa6.html" target="n" data-glyph="2,0" class="t t">TraversalInfo</a>
    {
        <b>internal</b> <a id="ddb35deed014f4f2" href="../../R/ddb35deed014f4f2.html" target="n" data-glyph="74,1" class="t constructor">TraversalInfo</a>(<b>int</b> <span id="r75 rd" class="r75 r">level</span>, <b>int</b> <span id="r76 rd" class="r76 r">maxDepth</span>)
        {
            <a href="#b3ba63d4da5ef801" class="i field">_level</a> = <span class="r75 r">level</span>;
            <a href="#d5b91819ae825925" class="i field">_maxDepth</a> = <span class="r76 r">maxDepth</span>;
        }
 
        <b>internal int</b> <a id="8cd5778150daaddf" href="../../R/8cd5778150daaddf.html" target="n" data-glyph="104,1" class="i property">Level</a> { <b>get</b> { <b>return</b> <a href="#b3ba63d4da5ef801" class="i field">_level</a>; } }
 
        <b>internal int</b> <a id="b7f6af8a5c17beed" href="../../R/b7f6af8a5c17beed.html" target="n" data-glyph="104,1" class="i property">MaxDepth</a> { <b>get</b> { <b>return</b> <a href="#d5b91819ae825925" class="i field">_maxDepth</a>; } }
 
        <b>internal</b> <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <a id="136ea3aa0d05ae49" href="../../R/136ea3aa0d05ae49.html" target="n" data-glyph="104,1" class="i property">NextLevel</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>new</b> <span class="t">TraversalInfo</span>(<a href="#b3ba63d4da5ef801" class="i field">_level</a> + 1, <a href="#d5b91819ae825925" class="i field">_maxDepth</a>);
            }
        }
 
        <b>private readonly int</b> <a id="b3ba63d4da5ef801" href="../../R/b3ba63d4da5ef801.html" target="n" data-glyph="46,1" class="i field">_level</a>;
        <b>private readonly int</b> <a id="d5b91819ae825925" href="../../R/d5b91819ae825925.html" target="n" data-glyph="46,1" class="i field">_maxDepth</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class to generate a complex view from properties.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="81235efa38066810" href="../../R/81235efa38066810.html" target="n" data-glyph="2,0" class="t t">ComplexViewObjectBrowser</a>
    {
        <b>internal</b> <a id="b25186b91b11741b" href="../../R/b25186b91b11741b.html" target="n" data-glyph="74,1" class="t constructor">ComplexViewObjectBrowser</a>(<a href="FormatViewManager.cs.html#c96e2566b8ef87f3" class="t t">FormatErrorManager</a> <span id="r77 rd" class="r77 r">resultErrorManager</span>, <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <span id="r78 rd" class="r78 r">mshExpressionFactory</span>, <b>int</b> <span id="r79 rd" class="r79 r">enumerationLimit</span>)
        {
            <a href="#833c13bf4065e4d5" class="i field">_errorManager</a> = <span class="r77 r">resultErrorManager</span>;
            <a href="#5e621659640594c7" class="i field">_expressionFactory</a> = <span class="r78 r">mshExpressionFactory</span>;
            <a href="#9787d93c339d62a3" class="i field">_enumerationLimit</a> = <span class="r79 r">enumerationLimit</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Given an object, generate a tree-like view</span>
        <span class="c">///</span><span class="c"> of the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">inputParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parameters from the command line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Complex view entry to send to the output command.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <a id="78e05e359bdd7c5c" href="../../R/78e05e359bdd7c5c.html" target="n" data-glyph="74,1" class="i method">GenerateView</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r80 rd" class="r80 r">so</span>, <a href="BaseFormattingCommandParameters.cs.html#87b6b3663c8d513b" class="t t">FormattingCommandLineParameters</a> <span id="r81 rd" class="r81 r">inputParameters</span>)
        {
            <a href="#593a2c899ca3ae38" class="i field">_complexSpecificParameters</a> = (<a href="BaseFormattingCommandParameters.cs.html#208b258600dc3b8d" class="t t">ComplexSpecificParameters</a>)<span class="r81 r">inputParameters</span>.<a href="BaseFormattingCommandParameters.cs.html#33d66bd4e6ba4c6b" class="i field">shapeParameters</a>;
 
            <b>int</b> <span id="r82 rd" class="r82 r">maxDepth</span> = <a href="#593a2c899ca3ae38" class="i field">_complexSpecificParameters</a>.<a href="BaseFormattingCommandParameters.cs.html#5a6d233c005000fd" class="i field">maxDepth</a>;
            <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r83 rd" class="r83 r">level</span> = <b>new</b> <a href="#ddb35deed014f4f2" class="t constructor">TraversalInfo</a>(0, <span class="r82 r">maxDepth</span>);
 
            <span class="i">List</span>&lt;<a href="Utilities/MshParameter.cs.html#9560e25e37f30aeb" class="t t">MshParameter</a>&gt; <span id="r84 rd" class="r84 r">mshParameterList</span> = <b>null</b>;
            <span class="r84 r">mshParameterList</span> = <span class="r81 r">inputParameters</span>.<a href="BaseFormattingCommandParameters.cs.html#76039c18012927ae" class="i field">mshParameterList</a>;
 
            <span class="c">// create a top level entry as root of the tree</span>
            <a href="FormattingObjects.cs.html#c397a47f3998c0d5" class="t t">ComplexViewEntry</a> <span id="r85 rd" class="r85 r">cve</span> = <b>new</b> <span class="t">ComplexViewEntry</span>();
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r86 rd" class="r86 r">typeNames</span> = <span class="r80 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <b>if</b> (<span class="i">TreatAsScalarType</span>(<span class="r86 r">typeNames</span>))
            {
                <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r87 rd" class="r87 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
 
                <span class="r85 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r87 r">fe</span>);
                <a href="#b9939377ff2b3c80" class="i method">DisplayRawObject</a>(<span class="r80 r">so</span>, <span class="r87 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>);
            }
            <b>else</b>
            {
                <span class="c">// check if the top level object is an enumeration</span>
                <span class="i">IEnumerable</span> <span id="r88 rd" class="r88 r">e</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r80 r">so</span>);
 
                <b>if</b> (<span class="r88 r">e</span> != <b>null</b>)
                {
                    <span class="c">// let&#39;s start the traversal with an enumeration</span>
                    <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r89 rd" class="r89 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
 
                    <span class="r85 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>.<span class="i">Add</span>(<span class="r89 r">fe</span>);
                    <a href="#79a84f4a2a82c71d" class="i method">DisplayEnumeration</a>(<span class="r88 r">e</span>, <span class="r83 r">level</span>, <span class="r89 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>);
                }
                <b>else</b>
                {
                    <span class="c">// let&#39;s start the traversal with a traversal on properties</span>
                    <a href="#9ed51344b4a2463b" class="i method">DisplayObject</a>(<span class="r80 r">so</span>, <span class="r83 r">level</span>, <span class="r84 r">mshParameterList</span>, <span class="r85 r">cve</span>.<a href="FormattingObjects.cs.html#ac53bdbd43ec372f" class="i field">formatValueList</a>);
                }
            }
 
            <b>return</b> <span class="r85 r">cve</span>;
        }
 
        <b>private void</b> <a id="b9939377ff2b3c80" href="../../R/b9939377ff2b3c80.html" target="n" data-glyph="76,1" class="i method">DisplayRawObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r90 rd" class="r90 r">so</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r91 rd" class="r91 r">formatValueList</span>)
        {
            <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r92 rd" class="r92 r">fpf</span> = <b>new</b> <span class="t">FormatPropertyField</span>();
 
            <a href="Utilities/MshObjectUtil.cs.html#b2c053e472911f78" class="t t">StringFormatError</a> <span id="r93 rd" class="r93 r">formatErrorObject</span> = <b>null</b>;
            <b>if</b> (<a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#67e8e6ea42f6a2c3" class="i property">DisplayFormatErrorString</a>)
            {
                <span class="c">// we send a format error object down to the formatting calls</span>
                <span class="c">// only if we want to show the formatting error strings</span>
                <span class="r93 r">formatErrorObject</span> = <b>new</b> <span class="t">StringFormatError</span>();
            }
 
            <span class="r92 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#982c120083201153" class="i method">SmartToString</a>(<span class="r90 r">so</span>, <a href="#5e621659640594c7" class="i field">_expressionFactory</a>, <a href="#9787d93c339d62a3" class="i field">_enumerationLimit</a>, <span class="r93 r">formatErrorObject</span>);
 
            <b>if</b> (<span class="r93 r">formatErrorObject</span> != <b>null</b> &amp;&amp; <span class="r93 r">formatErrorObject</span>.<a href="Utilities/MshObjectUtil.cs.html#f4c78e3b4f174ffb" class="i field">exception</a> != <b>null</b>)
            {
                <span class="c">// if we did no thave any errors in the expression evaluation</span>
                <span class="c">// we might have errors in the formatting, if present</span>
                <a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#97dfdc35a9bb1ad1" class="i method">LogStringFormatError</a>(<span class="r93 r">formatErrorObject</span>);
                <b>if</b> (<a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#67e8e6ea42f6a2c3" class="i property">DisplayFormatErrorString</a>)
                {
                    <span class="r92 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#c53687bf77ffa1fd" class="i property">FormatErrorString</a>;
                }
            }
 
            <span class="r91 r">formatValueList</span>.<span class="i">Add</span>(<span class="r92 r">fpf</span>);
            <span class="r91 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Recursive call to display an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">so</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">currentLevel</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current level in the traversal.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">parameterList</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of parameters from the command line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">formatValueList</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of format tokens to add to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9ed51344b4a2463b" href="../../R/9ed51344b4a2463b.html" target="n" data-glyph="76,1" class="i method">DisplayObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r94 rd" class="r94 r">so</span>, <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r95 rd" class="r95 r">currentLevel</span>, <span class="i">List</span>&lt;<a href="Utilities/MshParameter.cs.html#9560e25e37f30aeb" class="t t">MshParameter</a>&gt; <span id="r96 rd" class="r96 r">parameterList</span>,
                                        <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r97 rd" class="r97 r">formatValueList</span>)
        {
            <span class="c">// resolve the names of the properties</span>
            <span class="i">List</span>&lt;<a href="Utilities/MshParameterAssociation.cs.html#5b4350463581137f" class="t t">MshResolvedExpressionParameterAssociation</a>&gt; <span id="r98 rd" class="r98 r">activeAssociationList</span> =
                        <a href="Utilities/MshParameterAssociation.cs.html#74bd0302d2e8a453" class="t t">AssociationManager</a>.<a href="Utilities/MshParameterAssociation.cs.html#6d5c0400cefef48c" class="i method">SetupActiveProperties</a>(<span class="r96 r">parameterList</span>, <span class="r94 r">so</span>, <a href="#5e621659640594c7" class="i field">_expressionFactory</a>);
 
            <span class="c">// create a format entry</span>
            <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r99 rd" class="r99 r">fe</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
            <span class="r97 r">formatValueList</span>.<span class="i">Add</span>(<span class="r99 r">fe</span>);
 
            <span class="c">// add the display name of the object</span>
            <b>string</b> <span id="r100 rd" class="r100 r">objectDisplayName</span> = <a href="#e4e3fa318bf4babd" class="i method">GetObjectDisplayName</a>(<span class="r94 r">so</span>);
            <b>if</b> (<span class="r100 r">objectDisplayName</span> != <b>null</b>)
                <span class="r100 r">objectDisplayName</span> = <span class="s">&quot;class &quot;</span> + <span class="r100 r">objectDisplayName</span>;
 
            <a href="#49fc0868d8865b48" class="i method">AddPrologue</a>(<span class="r99 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>, <span class="s">&quot;{&quot;</span>, <span class="r100 r">objectDisplayName</span>);
            <a href="#be31181a2a9faeae" class="i method">ProcessActiveAssociationList</a>(<span class="r94 r">so</span>, <span class="r95 r">currentLevel</span>, <span class="r98 r">activeAssociationList</span>, <a href="#e0dbd531bc88b884" class="i method">AddIndentationLevel</a>(<span class="r99 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>));
            <a href="#8e10087a3faff7cc" class="i method">AddEpilogue</a>(<span class="r99 r">fe</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>, <span class="s">&quot;}&quot;</span>);
        }
 
        <b>private void</b> <a id="be31181a2a9faeae" href="../../R/be31181a2a9faeae.html" target="n" data-glyph="76,1" class="i method">ProcessActiveAssociationList</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r101 rd" class="r101 r">so</span>,
                                <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r102 rd" class="r102 r">currentLevel</span>,
                                <span class="i">List</span>&lt;<a href="Utilities/MshParameterAssociation.cs.html#5b4350463581137f" class="t t">MshResolvedExpressionParameterAssociation</a>&gt; <span id="r103 rd" class="r103 r">activeAssociationList</span>,
                                                    <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r104 rd" class="r104 r">formatValueList</span>)
        {
            <b>foreach</b> (<a href="Utilities/MshParameterAssociation.cs.html#5b4350463581137f" class="t t">MshResolvedExpressionParameterAssociation</a> <span id="r105 rd" class="r105 r">a</span> <b>in</b> <span class="r103 r">activeAssociationList</span>)
            {
                <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r106 rd" class="r106 r">ftf</span> = <b>new</b> <span class="t">FormatTextField</span>();
 
                <span class="r106 r">ftf</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <span class="r105 r">a</span>.<a href="Utilities/MshParameterAssociation.cs.html#b52bad4dbc0efdac" class="i property">ResolvedExpression</a>.<a href="Utilities/Mshexpression.cs.html#4f5da54f51065de6" class="i method">ToString</a>() + <span class="s">&quot; = &quot;</span>;
                <span class="r104 r">formatValueList</span>.<span class="i">Add</span>(<span class="r106 r">ftf</span>);
 
                <span class="c">// compute the value of the entry</span>
                <span class="i">List</span>&lt;<a href="Utilities/Mshexpression.cs.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a>&gt; <span id="r107 rd" class="r107 r">resList</span> = <span class="r105 r">a</span>.<a href="Utilities/MshParameterAssociation.cs.html#b52bad4dbc0efdac" class="i property">ResolvedExpression</a>.<a href="Utilities/Mshexpression.cs.html#1e7cef19203a999b" class="i method">GetValues</a>(<span class="r101 r">so</span>);
                <b>object</b> <span id="r108 rd" class="r108 r">val</span> = <b>null</b>;
                <b>if</b> (<span class="r107 r">resList</span>.<span class="i">Count</span> &gt;= 1)
                {
                    <a href="Utilities/Mshexpression.cs.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a> <span id="r109 rd" class="r109 r">result</span> = <span class="r107 r">resList</span>[0];
                    <b>if</b> (<span class="r109 r">result</span>.<a href="Utilities/Mshexpression.cs.html#a35b9dec64c079ad" class="i property">Exception</a> != <b>null</b>)
                    {
                        <a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#7cc094527e60e409" class="i method">LogPSPropertyExpressionFailedResult</a>(<span class="r109 r">result</span>, <span class="r101 r">so</span>);
                        <b>if</b> (<a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#b7ca91a1c7843d84" class="i property">DisplayErrorStrings</a>)
                        {
                            <span class="r108 r">val</span> = <a href="#833c13bf4065e4d5" class="i field">_errorManager</a>.<a href="FormatViewManager.cs.html#ee6fa415b7246812" class="i property">ErrorString</a>;
                        }
                        <b>else</b>
                        {
                            <span class="r108 r">val</span> = <b>string</b>.<span class="i">Empty</span>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r108 r">val</span> = <span class="r109 r">result</span>.<a href="Utilities/Mshexpression.cs.html#5ffe7f472d198e60" class="i property">Result</a>;
                    }
                }
 
                <span class="c">// extract the optional max depth</span>
                <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r110 rd" class="r110 r">level</span> = <span class="r102 r">currentLevel</span>;
                <b>if</b> (<span class="r105 r">a</span>.<a href="Utilities/MshParameterAssociation.cs.html#441a58a0d01cc3cb" class="i property">OriginatingParameter</a> != <b>null</b>)
                {
                    <b>object</b> <span id="r111 rd" class="r111 r">maxDepthKey</span> = <span class="r105 r">a</span>.<a href="Utilities/MshParameterAssociation.cs.html#441a58a0d01cc3cb" class="i property">OriginatingParameter</a>.<a href="Utilities/MshParameter.cs.html#659a68599a5f4ade" class="i method">GetEntry</a>(<a href="BaseFormattingCommandParameters.cs.html#9ef7eadb77e0beb8" class="t t">FormatParameterDefinitionKeys</a>.<a href="BaseFormattingCommandParameters.cs.html#3f0144aa41fe0ed2" class="i field">DepthEntryKey</a>);
                    <b>if</b> (<span class="r111 r">maxDepthKey</span> != <a href="../../engine/AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../engine/AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                    {
                        <b>int</b> <span id="r112 rd" class="r112 r">parameterMaxDept</span> = (<b>int</b>)<span class="r111 r">maxDepthKey</span>;
                        <span class="r110 r">level</span> = <b>new</b> <a href="#ddb35deed014f4f2" class="t constructor">TraversalInfo</a>(<span class="r102 r">currentLevel</span>.<a href="#8cd5778150daaddf" class="i property">Level</a>, <span class="r112 r">parameterMaxDept</span>);
                    }
                }
 
                <span class="i">IEnumerable</span> <span id="r113 rd" class="r113 r">e</span> = <b>null</b>;
                <b>if</b> (<span class="r108 r">val</span> != <b>null</b> || (<span class="r110 r">level</span>.<a href="#8cd5778150daaddf" class="i property">Level</a> &gt;= <span class="r110 r">level</span>.<a href="#b7f6af8a5c17beed" class="i property">MaxDepth</a>))
                    <span class="r113 r">e</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r108 r">val</span>);
 
                <b>if</b> (<span class="r113 r">e</span> != <b>null</b>)
                {
                    <span class="r104 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
                    <a href="#79a84f4a2a82c71d" class="i method">DisplayEnumeration</a>(<span class="r113 r">e</span>, <span class="r110 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <a href="#e0dbd531bc88b884" class="i method">AddIndentationLevel</a>(<span class="r104 r">formatValueList</span>));
                }
                <b>else</b> <b>if</b> (<span class="r108 r">val</span> == <b>null</b> || <a href="#1e0f9acac30c400f" class="i method">TreatAsLeafNode</a>(<span class="r108 r">val</span>, <span class="r110 r">level</span>))
                {
                    <a href="#9fa25827416cda00" class="i method">DisplayLeaf</a>(<span class="r108 r">val</span>, <span class="r104 r">formatValueList</span>);
                }
                <b>else</b>
                {
                    <span class="r104 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
 
                    <span class="c">// we need to go one more level down</span>
                    <a href="#9ed51344b4a2463b" class="i method">DisplayObject</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r108 r">val</span>), <span class="r110 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <b>null</b>,
                        <a href="#e0dbd531bc88b884" class="i method">AddIndentationLevel</a>(<span class="r104 r">formatValueList</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Recursive call to display an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Enumeration to display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">level</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current level in the traversal.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">formatValueList</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of format tokens to add to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="79a84f4a2a82c71d" href="../../R/79a84f4a2a82c71d.html" target="n" data-glyph="76,1" class="i method">DisplayEnumeration</a>(<span class="i">IEnumerable</span> <span id="r114 rd" class="r114 r">e</span>, <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r115 rd" class="r115 r">level</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r116 rd" class="r116 r">formatValueList</span>)
        {
            <a href="#49fc0868d8865b48" class="i method">AddPrologue</a>(<span class="r116 r">formatValueList</span>, <span class="s">&quot;[&quot;</span>, <b>null</b>);
            <a href="#b9865dd55809a673" class="i method">DisplayEnumerationInner</a>(<span class="r114 r">e</span>, <span class="r115 r">level</span>, <a href="#e0dbd531bc88b884" class="i method">AddIndentationLevel</a>(<span class="r116 r">formatValueList</span>));
            <a href="#8e10087a3faff7cc" class="i method">AddEpilogue</a>(<span class="r116 r">formatValueList</span>, <span class="s">&quot;]&quot;</span>);
 
            <span class="r116 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
        }
 
        <b>private void</b> <a id="b9865dd55809a673" href="../../R/b9865dd55809a673.html" target="n" data-glyph="76,1" class="i method">DisplayEnumerationInner</a>(<span class="i">IEnumerable</span> <span id="r117 rd" class="r117 r">e</span>, <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r118 rd" class="r118 r">level</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r119 rd" class="r119 r">formatValueList</span>)
        {
            <b>int</b> <span id="r120 rd" class="r120 r">enumCount</span> = 0;
            <b>foreach</b> (<b>object</b> <span id="r121 rd" class="r121 r">x</span> <b>in</b> <span class="r117 r">e</span>)
            {
                <b>if</b> (<a href="../../engine/hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../../engine/hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>().<a href="../../engine/ExecutionContext.cs.html#bc7d7c4d79ef05e4" class="i property">CurrentPipelineStopping</a>)
                {
                    <b>throw</b> <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
                }
 
                <b>if</b> (<a href="#9787d93c339d62a3" class="i field">_enumerationLimit</a> &gt;= 0)
                {
                    <b>if</b> (<a href="#9787d93c339d62a3" class="i field">_enumerationLimit</a> == <span class="r120 r">enumCount</span>)
                    {
                        <a href="#9fa25827416cda00" class="i method">DisplayLeaf</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a5549bfa35c48a67" class="i field">Ellipsis</a>, <span class="r119 r">formatValueList</span>);
                        <b>break</b>;
                    }
 
                    <span class="r120 r">enumCount</span>++;
                }
 
                <b>if</b> (<a href="#1e0f9acac30c400f" class="i method">TreatAsLeafNode</a>(<span class="r121 r">x</span>, <span class="r118 r">level</span>))
                {
                    <a href="#9fa25827416cda00" class="i method">DisplayLeaf</a>(<span class="r121 r">x</span>, <span class="r119 r">formatValueList</span>);
                }
                <b>else</b>
                {
                    <span class="c">// check if the top level object is an enumeration</span>
                    <span class="i">IEnumerable</span> <span id="r122 rd" class="r122 r">e1</span> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#a532bab7048287b1" class="i method">GetEnumerable</a>(<span class="r121 r">x</span>);
 
                    <b>if</b> (<span class="r122 r">e1</span> != <b>null</b>)
                    {
                        <span class="r119 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
                        <a href="#79a84f4a2a82c71d" class="i method">DisplayEnumeration</a>(<span class="r122 r">e1</span>, <span class="r118 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <a href="#e0dbd531bc88b884" class="i method">AddIndentationLevel</a>(<span class="r119 r">formatValueList</span>));
                    }
                    <b>else</b>
                    {
                        <a href="#9ed51344b4a2463b" class="i method">DisplayObject</a>(<a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r121 r">x</span>), <span class="r118 r">level</span>.<a href="#136ea3aa0d05ae49" class="i property">NextLevel</a>, <b>null</b>, <span class="r119 r">formatValueList</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display a leaf value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">val</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">formatValueList</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of format tokens to add to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9fa25827416cda00" href="../../R/9fa25827416cda00.html" target="n" data-glyph="76,1" class="i method">DisplayLeaf</a>(<b>object</b> <span id="r123 rd" class="r123 r">val</span>, <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r124 rd" class="r124 r">formatValueList</span>)
        {
            <a href="../../P/03678054b01fd58e.html#03678054b01fd58e" class="t t">FormatPropertyField</a> <span id="r125 rd" class="r125 r">fpf</span> = <b>new</b> <span class="t">FormatPropertyField</span>();
 
            <span class="r125 r">fpf</span>.<a href="FormattingObjects.cs.html#5e8dcfb251ff14e3" class="i field">propertyValue</a> = <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#e4612b43d245b791" class="i method">FormatField</a>(<b>null</b>, <a href="Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="Utilities/MshObjectUtil.cs.html#f46bb6f0d2c46a5c" class="i method">AsPSObject</a>(<span class="r123 r">val</span>), <a href="#9787d93c339d62a3" class="i field">_enumerationLimit</a>, <b>null</b>, <a href="#5e621659640594c7" class="i field">_expressionFactory</a>);
            <span class="r124 r">formatValueList</span>.<span class="i">Add</span>(<span class="r125 r">fpf</span>);
            <span class="r124 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determine if we have to stop the expansion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">val</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to verify.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">level</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current level of recursion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="1e0f9acac30c400f" href="../../R/1e0f9acac30c400f.html" target="n" data-glyph="76,1" class="i method">TreatAsLeafNode</a>(<b>object</b> <span id="r126 rd" class="r126 r">val</span>, <a href="#1c4877727c3f6aa6" class="t t">TraversalInfo</a> <span id="r127 rd" class="r127 r">level</span>)
        {
            <b>if</b> (<span class="r127 r">level</span>.<a href="#8cd5778150daaddf" class="i property">Level</a> &gt;= <span class="r127 r">level</span>.<a href="#b7f6af8a5c17beed" class="i property">MaxDepth</a> || <span class="r126 r">val</span> == <b>null</b>)
                <b>return</b> <b>true</b>;
 
            <b>return</b> <span class="i">TreatAsScalarType</span>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../engine/MshObject.cs.html#0dfe59c032d463c4" class="i method">GetTypeNames</a>(<span class="r126 r">val</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Treat as scalar check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">typeNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the type to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if it has to be treated as a scalar.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="75bfc86909a2a5a0" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TreatAsScalarType</a>(<span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r128 rd" class="r128 r">typeNames</span>)
        {
            <b>return</b> <a href="FormatViewManager.cs.html#0dfec4e099bb5077" class="t t">DefaultScalarTypes</a>.<a href="FormatViewManager.cs.html#8fe777ecc8eb55fb" class="i method">IsTypeInList</a>(<span class="r128 r">typeNames</span>);
        }
 
        <b>private string</b> <a id="e4e3fa318bf4babd" href="../../R/e4e3fa318bf4babd.html" target="n" data-glyph="76,1" class="i method">GetObjectDisplayName</a>(<a href="../../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r129 rd" class="r129 r">so</span>)
        {
            <b>if</b> (<a href="#593a2c899ca3ae38" class="i field">_complexSpecificParameters</a>.<a href="BaseFormattingCommandParameters.cs.html#319287d83c762165" class="i field">classDisplay</a> == <a href="BaseFormattingCommandParameters.cs.html#208b258600dc3b8d" class="t t">ComplexSpecificParameters</a>.<a href="BaseFormattingCommandParameters.cs.html#fc431e12d2c44b11" class="t t">ClassInfoDisplay</a>.<a href="BaseFormattingCommandParameters.cs.html#e1cfa3fa4f4155b3" class="i field">none</a>)
                <b>return</b> <b>null</b>;
 
            <a href="../../engine/TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r130 rd" class="r130 r">typeNames</span> = <span class="r129 r">so</span>.<a href="../../engine/MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <b>if</b> (<span class="r130 r">typeNames</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <span class="s">&quot;PSObject&quot;</span>;
            }
 
            <b>if</b> (<a href="#593a2c899ca3ae38" class="i field">_complexSpecificParameters</a>.<a href="BaseFormattingCommandParameters.cs.html#319287d83c762165" class="i field">classDisplay</a> == <a href="BaseFormattingCommandParameters.cs.html#208b258600dc3b8d" class="t t">ComplexSpecificParameters</a>.<a href="BaseFormattingCommandParameters.cs.html#fc431e12d2c44b11" class="t t">ClassInfoDisplay</a>.<a href="BaseFormattingCommandParameters.cs.html#520609b1bf6be842" class="i field">shortName</a>)
            {
                <span class="c">// get the last token in the full name</span>
                <b>string</b>[] <span id="r131 rd" class="r131 r">arr</span> = <span class="r130 r">typeNames</span>[0].<span class="i">Split</span>(<a href="../../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../engine/Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../../engine/Utils.cs.html#ffdbb627389644d2" class="i field">Dot</a>);
                <b>if</b> (<span class="r131 r">arr</span>.<span class="i">Length</span> &gt; 0)
                    <b>return</b> <span class="r131 r">arr</span>[<span class="r131 r">arr</span>.<span class="i">Length</span> - 1];
            }
 
            <b>return</b> <span class="r130 r">typeNames</span>[0];
        }
 
        <b>private static void</b> <a id="49fc0868d8865b48" href="../../R/49fc0868d8865b48.html" target="n" data-glyph="76,1" class="i method">AddPrologue</a>(<span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r132 rd" class="r132 r">formatValueList</span>, <b>string</b> <span id="r133 rd" class="r133 r">openTag</span>, <b>string</b> <span id="r134 rd" class="r134 r">label</span>)
        {
            <b>if</b> (<span class="r134 r">label</span> != <b>null</b>)
            {
                <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r135 rd" class="r135 r">ftfLabel</span> = <b>new</b> <span class="t">FormatTextField</span>();
                <span class="r135 r">ftfLabel</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <span class="r134 r">label</span>;
                <span class="r132 r">formatValueList</span>.<span class="i">Add</span>(<span class="r135 r">ftfLabel</span>);
                <span class="r132 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
            }
 
            <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r136 rd" class="r136 r">ftf</span> = <b>new</b> <span class="t">FormatTextField</span>();
            <span class="r136 r">ftf</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <span class="r133 r">openTag</span>;
            <span class="r132 r">formatValueList</span>.<span class="i">Add</span>(<span class="r136 r">ftf</span>);
 
            <span class="r132 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
        }
 
        <b>private static void</b> <a id="8e10087a3faff7cc" href="../../R/8e10087a3faff7cc.html" target="n" data-glyph="76,1" class="i method">AddEpilogue</a>(<span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r137 rd" class="r137 r">formatValueList</span>, <b>string</b> <span id="r138 rd" class="r138 r">closeTag</span>)
        {
            <a href="../../P/a01601ca02f98310.html#a01601ca02f98310" class="t t">FormatTextField</a> <span id="r139 rd" class="r139 r">ftf</span> = <b>new</b> <span class="t">FormatTextField</span>();
 
            <span class="r139 r">ftf</span>.<a href="FormattingObjects.cs.html#429b438a5454027b" class="i field">text</a> = <span class="r138 r">closeTag</span>;
            <span class="r137 r">formatValueList</span>.<span class="i">Add</span>(<span class="r139 r">ftf</span>);
 
            <span class="r137 r">formatValueList</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FormatNewLine</span>());
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <a id="e0dbd531bc88b884" href="../../R/e0dbd531bc88b884.html" target="n" data-glyph="76,1" class="i method">AddIndentationLevel</a>(<span class="i">List</span>&lt;<a href="FormattingObjects.cs.html#2bfca6d9f0ec67b7" class="t t">FormatValue</a>&gt; <span id="r140 rd" class="r140 r">formatValueList</span>)
        {
            <a href="../../P/26a608afdff943e2.html#26a608afdff943e2" class="t t">FormatEntry</a> <span id="r141 rd" class="r141 r">feFrame</span> = <b>new</b> <a href="FormattingObjects.cs.html#f7a77819c3cdc49c" class="t constructor">FormatEntry</a>();
            <span class="r141 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a> = <b>new</b> <span class="t">FrameInfo</span>();
 
            <span class="c">// add the frame info</span>
            <span class="r141 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#39cc530b5fe0b069" class="i field">firstLine</a> = 0;
            <span class="r141 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#32b84b84ce7d6de1" class="i field">leftIndentation</a> = <a href="#ac2bd9d3994d7a6e" class="i field">_indentationStep</a>;
            <span class="r141 r">feFrame</span>.<a href="FormattingObjects.cs.html#734a043002f59427" class="i field">frameInfo</a>.<a href="FormattingObjects.cs.html#3193e186da1897ae" class="i field">rightIndentation</a> = 0;
            <span class="r140 r">formatValueList</span>.<span class="i">Add</span>(<span class="r141 r">feFrame</span>);
 
            <b>return</b> <span class="r141 r">feFrame</span>.<a href="FormattingObjects.cs.html#50808a04a1fbd08f" class="i field">formatValueList</a>;
        }
 
        <b>private</b> <a href="BaseFormattingCommandParameters.cs.html#208b258600dc3b8d" class="t t">ComplexSpecificParameters</a> <a id="593a2c899ca3ae38" href="../../R/593a2c899ca3ae38.html" target="n" data-glyph="46,1" class="i field">_complexSpecificParameters</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indentation added to each level in the recursion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly int</b> <a id="ac2bd9d3994d7a6e" href="../../R/ac2bd9d3994d7a6e.html" target="n" data-glyph="46,1" class="i field">_indentationStep</a> = 2;
 
        <b>private readonly</b> <a href="FormatViewManager.cs.html#c96e2566b8ef87f3" class="t t">FormatErrorManager</a> <a id="833c13bf4065e4d5" href="../../R/833c13bf4065e4d5.html" target="n" data-glyph="46,1" class="i field">_errorManager</a>;
 
        <b>private readonly</b> <a href="Utilities/MshObjectUtil.cs.html#ac8b562fd83d9f0f" class="t t">PSPropertyExpressionFactory</a> <a id="5e621659640594c7" href="../../R/5e621659640594c7.html" target="n" data-glyph="46,1" class="i field">_expressionFactory</a>;
 
        <b>private readonly int</b> <a id="9787d93c339d62a3" href="../../R/9787d93c339d62a3.html" target="n" data-glyph="46,1" class="i field">_enumerationLimit</a>;
    }
}
</pre></td></tr></table></div></body></html>
