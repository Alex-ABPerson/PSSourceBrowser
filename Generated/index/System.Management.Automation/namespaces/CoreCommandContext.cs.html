<!DOCTYPE html>
<html><head><title>CoreCommandContext.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1194);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/namespaces/CoreCommandContext.cs" target="_top">namespaces\CoreCommandContext.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The context of the core command that is being run. This</span>
    <span class="c">///</span><span class="c"> includes data like the user name and password, as well</span>
    <span class="c">///</span><span class="c"> as callbacks for streaming output, prompting, and progress.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> This allows the providers to be called in a variety of situations.</span>
    <span class="c">///</span><span class="c"> The most common will be from the core cmdlets themselves but they</span>
    <span class="c">///</span><span class="c"> can also be called programmatically either by having the results</span>
    <span class="c">///</span><span class="c"> accumulated or by providing delegates for the various streams.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> NOTE:  USER Feedback mechanism are only enabled for the CoreCmdlet</span>
    <span class="c">///</span><span class="c"> case.  This is because we have not seen a use-case for them in the</span>
    <span class="c">///</span><span class="c"> other scenarios.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="1e83d35d5286e174" href="../R/1e83d35d5286e174.html" target="n" data-glyph="2,0" class="t t">CmdletProviderContext</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Trace object
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the PSTraceSource class used for trace output</span>
        <span class="c">///</span><span class="c"> using &quot;CmdletProviderContext&quot; as the category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i n">Dbg</span>.<span class="i">TraceSourceAttribute</span>(
             <span class="s">&quot;CmdletProviderContext&quot;</span>,
             <span class="s">&quot;The context under which a core command is being run.&quot;</span>)]
        <b>private static readonly</b> <span class="i n">Dbg</span>.<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="448fe8cdb89aa297" href="../R/448fe8cdb89aa297.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> =
            <span class="i n">Dbg</span>.<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;CmdletProviderContext&quot;</span>,
             <span class="s">&quot;The context under which a core command is being run.&quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Trace object
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">executionContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context of the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">executionContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8a0e078b40b2fd0e" href="../R/8a0e078b40b2fd0e.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(<a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r0 rd" class="r0 r">executionContext</span>)
        {
            <b>if</b> (<span class="r0 r">executionContext</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">executionContext</span>));
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r0 r">executionContext</span>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../engine/SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
            <a href="#f037b19aae477b8f" class="i property">Drive</a> = <span class="r0 r">executionContext</span>.<a href="../engine/ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../engine/SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a>;
            <b>if</b> ((<span class="r0 r">executionContext</span>.<a href="../engine/ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> != <b>null</b>) &amp;&amp;
                (<span class="r0 r">executionContext</span>.<a href="../engine/ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="../engine/CommandProcessorBase.cs.html#f58ee453ebc82f56" class="i property">Command</a> <b>is</b> <a href="../engine/cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>))
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a> = (<a href="../engine/cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>)<span class="r0 r">executionContext</span>.<a href="../engine/ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="../engine/CommandProcessorBase.cs.html#f58ee453ebc82f56" class="i property">Command</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">executionContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context of the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">executionContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="9ed059070157e397" href="../R/9ed059070157e397.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(<a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1 rd" class="r1 r">executionContext</span>, <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r2 rd" class="r2 r">origin</span>)
        {
            <b>if</b> (<span class="r1 r">executionContext</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">executionContext</span>));
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r1 r">executionContext</span>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <span class="r2 r">origin</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command object that is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">credentials</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The credentials the core command provider should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">drive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The drive under which this context should operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains a null Host or Context reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ace297f213897850" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(
            <a href="../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r3 rd" class="r3 r">command</span>,
            <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r4 rd" class="r4 r">credentials</span>,
            <a href="../engine/DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r5 rd" class="r5 r">drive</span>)
        {
            <span class="c">// verify the command parameter</span>
            <b>if</b> (<span class="r3 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">command</span>));
            }
 
            <a href="#3f3284850ae00ae1" class="i field">_command</a> = <span class="r3 r">command</span>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <span class="r3 r">command</span>.<a href="../engine/CommandBase.cs.html#6cef80897300e0a9" class="i property">CommandOrigin</a>;
 
            <b>if</b> (<span class="r4 r">credentials</span> != <b>null</b>)
            {
                <a href="#177e70df87cd6c19" class="i field">_credentials</a> = <span class="r4 r">credentials</span>;
            }
 
            <a href="#f037b19aae477b8f" class="i property">Drive</a> = <span class="r5 r">drive</span>;
 
            <b>if</b> (<span class="r3 r">command</span>.<a href="../engine/CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;command.Host&quot;</span>);
            }
 
            <b>if</b> (<span class="r3 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;command.Context&quot;</span>);
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r3 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>;
 
            <span class="c">// Stream will default to true because command methods will be used.</span>
 
            <a href="#9b96586b254b58dd" class="i property">PassThru</a> = <b>true</b>;
            <a href="#1b44305085a36605" class="i field">_streamErrors</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command object that is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">credentials</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The credentials the core command provider should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains a null Host or Context reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="0500b16f3c97e8c7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(
            <a href="../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r6 rd" class="r6 r">command</span>,
            <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r7 rd" class="r7 r">credentials</span>)
        {
            <span class="c">// verify the command parameter</span>
            <b>if</b> (<span class="r6 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r6 r">command</span>));
            }
 
            <a href="#3f3284850ae00ae1" class="i field">_command</a> = <span class="r6 r">command</span>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <span class="r6 r">command</span>.<a href="../engine/CommandBase.cs.html#6cef80897300e0a9" class="i property">CommandOrigin</a>;
 
            <b>if</b> (<span class="r7 r">credentials</span> != <b>null</b>)
            {
                <a href="#177e70df87cd6c19" class="i field">_credentials</a> = <span class="r7 r">credentials</span>;
            }
 
            <b>if</b> (<span class="r6 r">command</span>.<a href="../engine/CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;command.Host&quot;</span>);
            }
 
            <b>if</b> (<span class="r6 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;command.Context&quot;</span>);
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r6 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>;
 
            <span class="c">// Stream will default to true because command methods will be used.</span>
 
            <a href="#9b96586b254b58dd" class="i property">PassThru</a> = <b>true</b>;
            <a href="#1b44305085a36605" class="i field">_streamErrors</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command object that is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">command</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains a null Host or Context reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ce9b8f5a7a73244f" href="../R/ce9b8f5a7a73244f.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(
            <a href="../engine/cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r8 rd" class="r8 r">command</span>)
        {
            <span class="c">// verify the command parameter</span>
            <b>if</b> (<span class="r8 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r8 r">command</span>));
            }
 
            <a href="#3f3284850ae00ae1" class="i field">_command</a> = <span class="r8 r">command</span>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <span class="r8 r">command</span>.<a href="../engine/CommandBase.cs.html#6cef80897300e0a9" class="i property">CommandOrigin</a>;
 
            <b>if</b> (<span class="r8 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;command.Context&quot;</span>);
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r8 r">command</span>.<a href="../engine/CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>;
 
            <span class="c">// Stream will default to true because command methods will be used.</span>
 
            <a href="#9b96586b254b58dd" class="i property">PassThru</a> = <b>true</b>;
            <a href="#1b44305085a36605" class="i field">_streamErrors</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the context under which the core command providers</span>
        <span class="c">///</span><span class="c"> operate using an existing context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">contextToCopyFrom</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CmdletProviderContext instance to copy the filters, ExecutionContext,</span>
        <span class="c">///</span><span class="c"> Credentials, Drive, and Force options from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">contextToCopyFrom</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="1f17a9746c926c80" href="../R/1f17a9746c926c80.html" target="n" data-glyph="74,1" class="t constructor">CmdletProviderContext</a>(
            <a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r9 rd" class="r9 r">contextToCopyFrom</span>)
        {
            <b>if</b> (<span class="r9 r">contextToCopyFrom</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r9 r">contextToCopyFrom</span>));
            }
 
            <a href="#6e235b353e90f247" class="i property">ExecutionContext</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#6e235b353e90f247" class="i property">ExecutionContext</a>;
 
            <a href="#3f3284850ae00ae1" class="i field">_command</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#3f3284850ae00ae1" class="i field">_command</a>;
 
            <b>if</b> (<span class="r9 r">contextToCopyFrom</span>.<a href="#684ef2e396f82105" class="i property">Credential</a> != <b>null</b>)
            {
                <a href="#177e70df87cd6c19" class="i field">_credentials</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#684ef2e396f82105" class="i property">Credential</a>;
            }
 
            <a href="#f037b19aae477b8f" class="i property">Drive</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#f037b19aae477b8f" class="i property">Drive</a>;
            <a href="#98156387f3f041e7" class="i field">_force</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#81325ef4e72a5774" class="i property">Force</a>;
            <a href="#1e83d35d5286e174" class="k">this</a>.<a href="#af96a15bc7ec301b" class="i method">CopyFilters</a>(<span class="r9 r">contextToCopyFrom</span>);
            <a href="#b9edf955d3776935" class="i property">SuppressWildcardExpansion</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#b9edf955d3776935" class="i property">SuppressWildcardExpansion</a>;
            <a href="#64e2274dc8fab8bd" class="i property">DynamicParameters</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#64e2274dc8fab8bd" class="i property">DynamicParameters</a>;
            <a href="#be31bc97eaf769ac" class="i property">Origin</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#be31bc97eaf769ac" class="i property">Origin</a>;
 
            <span class="c">// Copy the stopping state incase the source context</span>
            <span class="c">// has already been signaled for stopping</span>
 
            <a href="#649b794a0afa4fa8" class="i property">Stopping</a> = <span class="r9 r">contextToCopyFrom</span>.<a href="#649b794a0afa4fa8" class="i property">Stopping</a>;
 
            <span class="c">// add this context to the stop referral on the copied</span>
            <span class="c">// context</span>
 
            <span class="r9 r">contextToCopyFrom</span>.<a href="#83eb3c02121e2600" class="i property">StopReferrals</a>.<span class="i">Add</span>(<a href="#1e83d35d5286e174" class="k">this</a>);
            <a href="#eecd54108afa22dd" class="i field">_copiedContext</a> = <span class="r9 r">contextToCopyFrom</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the constructor that takes a context to copy is</span>
        <span class="c">///</span><span class="c"> called, this will be set to the context being copied.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <a id="eecd54108afa22dd" href="../R/eecd54108afa22dd.html" target="n" data-glyph="46,1" class="i field">_copiedContext</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The credentials under which the operation should run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="177e70df87cd6c19" href="../R/177e70df87cd6c19.html" target="n" data-glyph="46,1" class="i field">_credentials</a> = <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>.<a href="../engine/Credential.cs.html#8c5314944c80f8ac" class="i property">Empty</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The force parameter gives guidance to providers on how vigorously they</span>
        <span class="c">///</span><span class="c"> should try to perform an operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="98156387f3f041e7" href="../R/98156387f3f041e7.html" target="n" data-glyph="46,1" class="i field">_force</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command which defines the context. This should not be</span>
        <span class="c">///</span><span class="c"> made visible to anyone and should only be set through the</span>
        <span class="c">///</span><span class="c"> constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="../engine/cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <a id="3f3284850ae00ae1" href="../R/3f3284850ae00ae1.html" target="n" data-glyph="46,1" class="i field">_command</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This makes the origin of the provider request visible to the internals.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="be31bc97eaf769ac" href="../R/be31bc97eaf769ac.html" target="n" data-glyph="104,1" class="i property">Origin</a> { <b>get</b>; } = <a href="../engine/SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../engine/SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This defines the default behavior for the WriteError method.</span>
        <span class="c">///</span><span class="c"> If it is true, a call to this method will result in an immediate call</span>
        <span class="c">///</span><span class="c"> to the command WriteError method, or to the writeErrorDelegate if</span>
        <span class="c">///</span><span class="c"> one has been supplied.</span>
        <span class="c">///</span><span class="c"> If it is false, the objects will be accumulated until the</span>
        <span class="c">///</span><span class="c"> GetErrorObjects method is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly bool</b> <a id="1b44305085a36605" href="../R/1b44305085a36605.html" target="n" data-glyph="46,1" class="i field">_streamErrors</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection in which objects that are written using the WriteObject(s)</span>
        <span class="c">///</span><span class="c"> methods are accumulated if </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9b96586b254b58dd" class="i property">PassThru</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="850c33eec64dfdad" href="../R/850c33eec64dfdad.html" target="n" data-glyph="46,1" class="i field">_accumulatedObjects</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection in which objects that are written using the WriteError</span>
        <span class="c">///</span><span class="c"> method are accumulated if </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9b96586b254b58dd" class="i property">PassThru</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="da75917a781d986b" href="../R/da75917a781d986b.html" target="n" data-glyph="46,1" class="i field">_accumulatedErrorObjects</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the provider that is currently executing in this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <a id="e9c071cb7aa5d9c5" href="../R/e9c071cb7aa5d9c5.html" target="n" data-glyph="46,1" class="i field">_providerInstance</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the execution context of the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="6e235b353e90f247" href="../R/6e235b353e90f247.html" target="n" data-glyph="104,1" class="i property">ExecutionContext</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the provider instance for the current</span>
        <span class="c">///</span><span class="c"> execution context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <a id="fc5b658eeb4ac721" href="../R/fc5b658eeb4ac721.html" target="n" data-glyph="104,1" class="i property">ProviderInstance</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e9c071cb7aa5d9c5" class="i field">_providerInstance</a>;
            }
 
            <b>set</b>
            {
                <a href="#e9c071cb7aa5d9c5" class="i field">_providerInstance</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copies the include, exclude, and provider filters from</span>
        <span class="c">///</span><span class="c"> the specified context to this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context to copy the filters from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="af96a15bc7ec301b" href="../R/af96a15bc7ec301b.html" target="n" data-glyph="76,1" class="i method">CopyFilters</a>(<a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r10 rd" class="r10 r">context</span>)
        {
            <span class="i n">Dbg</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r10 r">context</span> != <b>null</b>,
                <span class="s">&quot;The caller should have verified the context&quot;</span>);
 
            <a href="#ab4bd68ec99ecaa3" class="i property">Include</a> = <span class="r10 r">context</span>.<a href="#ab4bd68ec99ecaa3" class="i property">Include</a>;
            <a href="#93e21581391c00fc" class="i property">Exclude</a> = <span class="r10 r">context</span>.<a href="#93e21581391c00fc" class="i property">Exclude</a>;
            <a href="#274e5d6991e70230" class="i property">Filter</a> = <span class="r10 r">context</span>.<a href="#274e5d6991e70230" class="i property">Filter</a>;
        }
 
        <b>internal void</b> <a id="d67d95295b027157" href="../R/d67d95295b027157.html" target="n" data-glyph="74,1" class="i method">RemoveStopReferral</a>()
        {
            <b>if</b> (<a href="#eecd54108afa22dd" class="i field">_copiedContext</a> != <b>null</b>)
            {
                <a href="#eecd54108afa22dd" class="i field">_copiedContext</a>.<a href="#83eb3c02121e2600" class="i property">StopReferrals</a>.<span class="i">Remove</span>(<a href="#1e83d35d5286e174" class="k">this</a>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the dynamic parameters for the context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="64e2274dc8fab8bd" href="../R/64e2274dc8fab8bd.html" target="n" data-glyph="104,1" class="i property">DynamicParameters</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns MyInvocation from the underlying cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="564b4e39ec1a78d8" href="../R/564b4e39ec1a78d8.html" target="n" data-glyph="104,1" class="i property">MyInvocation</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the Write* calls should be passed through to the command</span>
        <span class="c">///</span><span class="c"> instance if there is one.  The default value is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9b96586b254b58dd" href="../R/9b96586b254b58dd.html" target="n" data-glyph="104,1" class="i property">PassThru</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The drive associated with this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><b>value</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null on set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="f037b19aae477b8f" href="../R/f037b19aae477b8f.html" target="n" data-glyph="104,1" class="i property">Drive</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the user name under which the operation should run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="684ef2e396f82105" href="../R/684ef2e396f82105.html" target="n" data-glyph="104,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <a href="../engine/Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r11 rd" class="r11 r">result</span> = <a href="#177e70df87cd6c19" class="i field">_credentials</a>;
 
                <span class="c">// If the username wasn&#39;t specified, use the drive credentials</span>
 
                <b>if</b> (<a href="#177e70df87cd6c19" class="i field">_credentials</a> == <b>null</b> &amp;&amp; <a href="#f037b19aae477b8f" class="i property">Drive</a> != <b>null</b>)
                {
                    <span class="r11 r">result</span> = <a href="#f037b19aae477b8f" class="i property">Drive</a>.<a href="../engine/DataStoreAdapter.cs.html#3933458893b044e7" class="i property">Credential</a>;
                }
 
                <b>return</b> <span class="r11 r">result</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Transaction Support
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the flag that determines if the command requested a transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="da88c8dba55de825" href="../R/da88c8dba55de825.html" target="n" data-glyph="104,1" class="i property">UseTransaction</a>
        {
            <b>get</b>
            {
                <b>if</b> ((<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>) &amp;&amp; (<a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#fa3830ca3ad4b256" class="i property">CommandRuntime</a> != <b>null</b>))
                {
                    <a href="../engine/MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r12 rd" class="r12 r">mshRuntime</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#fa3830ca3ad4b256" class="i property">CommandRuntime</a> <b>as</b> <a href="../engine/MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a>;
 
                    <b>if</b> (<span class="r12 r">mshRuntime</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r12 r">mshRuntime</span>.<a href="../engine/MshCommandRuntime.cs.html#84be5d945a0edf7b" class="i property">UseTransaction</a>;
                    }
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if a transaction is available and active.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="8118210c15935306" href="../R/8118210c15935306.html" target="n" data-glyph="72,1" class="i method">TransactionAvailable</a>()
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <b>return</b> <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#794277d21aa1757e" class="i method">TransactionAvailable</a>();
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an object that surfaces the current PowerShell transaction.</span>
        <span class="c">///</span><span class="c"> When this object is disposed, PowerShell resets the active transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../CoreCLR/CorePsStub.cs.html#f4565df9151a2fcf" class="t t">PSTransactionContext</a> <a id="0c53307667a43029" href="../R/0c53307667a43029.html" target="n" data-glyph="102,1" class="i property">CurrentPSTransaction</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#64c8f19647a51837" class="i property">CurrentPSTransaction</a>;
                }
 
                <b>return</b> <b>null</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Transaction Support
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Force property that is passed to providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../engine/MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="81325ef4e72a5774" href="../R/81325ef4e72a5774.html" target="n" data-glyph="104,1" class="i property">Force</a>
        {
            <b>get</b> { <b>return</b> <a href="#98156387f3f041e7" class="i field">_force</a>; }
 
            <b>set</b> { <a href="#98156387f3f041e7" class="i field">_force</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider specific filter that should be used when determining</span>
        <span class="c">///</span><span class="c"> which items an action should take place on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="274e5d6991e70230" href="../R/274e5d6991e70230.html" target="n" data-glyph="104,1" class="i property">Filter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A glob string that signifies which items should be included when determining</span>
        <span class="c">///</span><span class="c"> which items the action should occur on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="ab4bd68ec99ecaa3" href="../R/ab4bd68ec99ecaa3.html" target="n" data-glyph="104,1" class="i property">Include</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A glob string that signifies which items should be excluded when determining</span>
        <span class="c">///</span><span class="c"> which items the action should occur on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="93e21581391c00fc" href="../R/93e21581391c00fc.html" target="n" data-glyph="104,1" class="i property">Exclude</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the property that tells providers (that</span>
        <span class="c">///</span><span class="c"> declare their own wildcard support) to suppress wildcard</span>
        <span class="c">///</span><span class="c"> expansion. This is set when the user specifies the</span>
        <span class="c">///</span><span class="c"> -LiteralPath parameter to one of the core commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b9edf955d3776935" href="../R/b9edf955d3776935.html" target="n" data-glyph="102,1" class="i property">SuppressWildcardExpansion</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> User feedback mechanisms
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">true iff the action should be performed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.  The pipeline failure will be</span>
        <span class="c">///</span><span class="c"> ActionPreferenceStopException.</span>
        <span class="c">///</span><span class="c"> Also, this occurs if the pipeline was already stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="95238f0619e47372" href="../R/95238f0619e47372.html" target="n" data-glyph="74,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r13 rd" class="r13 r">target</span>)
        {
            <b>bool</b> <span id="r14 rd" class="r14 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r14 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#45a4136cf5b777da" class="i method">ShouldProcess</a>(<span class="r13 r">target</span>);
            }
 
            <b>return</b> <span class="r14 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">What action was being performed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">true iff the action should be performed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.  The pipeline failure will be</span>
        <span class="c">///</span><span class="c"> ActionPreferenceStopException.</span>
        <span class="c">///</span><span class="c"> Also, this occurs if the pipeline was already stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="61687f6ce7373548" href="../R/61687f6ce7373548.html" target="n" data-glyph="74,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r15 rd" class="r15 r">target</span>,
            <b>string</b> <span id="r16 rd" class="r16 r">action</span>)
        {
            <b>bool</b> <span id="r17 rd" class="r17 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r17 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<span class="r15 r">target</span>, <span class="r16 r">action</span>);
            }
 
            <b>return</b> <span class="r17 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This should contain a textual description of the action to be</span>
        <span class="c">///</span><span class="c"> performed.  This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This should contain a textual query of whether the action</span>
        <span class="c">///</span><span class="c"> should be performed, usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">true iff the action should be performed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.  The pipeline failure will be</span>
        <span class="c">///</span><span class="c"> ActionPreferenceStopException.</span>
        <span class="c">///</span><span class="c"> Also, this occurs if the pipeline was already stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="2bbfd7223a75f254" href="../R/2bbfd7223a75f254.html" target="n" data-glyph="74,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r18 rd" class="r18 r">verboseDescription</span>,
            <b>string</b> <span id="r19 rd" class="r19 r">verboseWarning</span>,
            <b>string</b> <span id="r20 rd" class="r20 r">caption</span>)
        {
            <b>bool</b> <span id="r21 rd" class="r21 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r21 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#6babd36f7e136213" class="i method">ShouldProcess</a>(
                    <span class="r18 r">verboseDescription</span>,
                    <span class="r19 r">verboseWarning</span>,
                    <span class="r20 r">caption</span>);
            }
 
            <b>return</b> <span class="r21 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This should contain a textual description of the action to be</span>
        <span class="c">///</span><span class="c"> performed.  This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This should contain a textual query of whether the action</span>
        <span class="c">///</span><span class="c"> should be performed, usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">shouldProcessReason</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the reason(s) why ShouldProcess returned what it returned.</span>
        <span class="c">///</span><span class="c"> Only the reasons enumerated in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../engine/cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">true iff the action should be performed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ActionPreference.Stop or ActionPreference.Inquire policy</span>
        <span class="c">///</span><span class="c"> triggered a terminating error.  The pipeline failure will be</span>
        <span class="c">///</span><span class="c"> ActionPreferenceStopException.</span>
        <span class="c">///</span><span class="c"> Also, this occurs if the pipeline was already stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="91c88ed03192cbae" href="../R/91c88ed03192cbae.html" target="n" data-glyph="74,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r22 rd" class="r22 r">verboseDescription</span>,
            <b>string</b> <span id="r23 rd" class="r23 r">verboseWarning</span>,
            <b>string</b> <span id="r24 rd" class="r24 r">caption</span>,
            <b>out</b> <a href="../engine/cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r25 rd" class="r25 r">shouldProcessReason</span>)
        {
            <b>bool</b> <span id="r26 rd" class="r26 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r26 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#fee13e39455d3a34" class="i method">ShouldProcess</a>(
                    <span class="r22 r">verboseDescription</span>,
                    <span class="r23 r">verboseWarning</span>,
                    <span class="r24 r">caption</span>,
                    <b>out</b> <span class="r25 r">shouldProcessReason</span>);
            }
            <b>else</b>
            {
                <span class="r25 r">shouldProcessReason</span> = <a href="../engine/cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>.<a href="../engine/cmdlet.cs.html#401296eb0e0f2185" class="i field">None</a>;
            }
 
            <b>return</b> <span class="r26 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ask the user whether to continue/stop or break to a subshell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message to display to the user. This routine will append</span>
        <span class="c">///</span><span class="c"> the text &quot;Continue&quot; to ensure that people know what question</span>
        <span class="c">///</span><span class="c"> they are answering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dialog caption if the host uses a dialog.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the user wants to continue, false if not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1a373e10bbb0a4fe" href="../R/1a373e10bbb0a4fe.html" target="n" data-glyph="74,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r27 rd" class="r27 r">query</span>,
            <b>string</b> <span id="r28 rd" class="r28 r">caption</span>)
        {
            <b>bool</b> <span id="r29 rd" class="r29 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r29 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<span class="r27 r">query</span>, <span class="r28 r">caption</span>);
            }
 
            <b>return</b> <span class="r29 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ask the user whether to continue/stop or break to a subshell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message to display to the user. This routine will append</span>
        <span class="c">///</span><span class="c"> the text &quot;Continue&quot; to ensure that people know what question</span>
        <span class="c">///</span><span class="c"> they are answering.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dialog caption if the host uses a dialog.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">yesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether the user selected YesToAll</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">noToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether the user selected NoToAll</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the user wants to continue, false if not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a69fe1825a1d66a0" href="../R/a69fe1825a1d66a0.html" target="n" data-glyph="74,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r30 rd" class="r30 r">query</span>,
            <b>string</b> <span id="r31 rd" class="r31 r">caption</span>,
            <b>ref bool</b> <span id="r32 rd" class="r32 r">yesToAll</span>,
            <b>ref bool</b> <span id="r33 rd" class="r33 r">noToAll</span>)
        {
            <b>bool</b> <span id="r34 rd" class="r34 r">result</span> = <b>true</b>;
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <span class="r34 r">result</span> = <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(
                    <span class="r30 r">query</span>, <span class="r31 r">caption</span>, <b>ref</b> <span class="r32 r">yesToAll</span>, <b>ref</b> <span class="r33 r">noToAll</span>);
            }
            <b>else</b>
            {
                <span class="r32 r">yesToAll</span> = <b>false</b>;
                <span class="r33 r">noToAll</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r34 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the object to the Verbose pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string that needs to be written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9fffd3153f3f9964" href="../R/9fffd3153f3f9964.html" target="n" data-glyph="74,1" class="i method">WriteVerbose</a>(<b>string</b> <span id="r35 rd" class="r35 r">text</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#377660744c64cd7e" class="i method">WriteVerbose</a>(<span class="r35 r">text</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the object to the Warning pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string that needs to be written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="95d5586759ff5402" href="../R/95d5586759ff5402.html" target="n" data-glyph="74,1" class="i method">WriteWarning</a>(<b>string</b> <span id="r36 rd" class="r36 r">text</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<span class="r36 r">text</span>);
            }
        }
 
        <b>internal void</b> <a id="400e92caae94e043" href="../R/400e92caae94e043.html" target="n" data-glyph="74,1" class="i method">WriteProgress</a>(<a href="../engine/ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r37 rd" class="r37 r">record</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<span class="r37 r">record</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes a debug string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The String that needs to be written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b574419691e377b8" href="../R/b574419691e377b8.html" target="n" data-glyph="74,1" class="i method">WriteDebug</a>(<b>string</b> <span id="r38 rd" class="r38 r">text</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#be99e4c15c8c7557" class="i method">WriteDebug</a>(<span class="r38 r">text</span>);
            }
        }
 
        <b>internal void</b> <a id="f05dd6f9a12ceb7d" href="../R/f05dd6f9a12ceb7d.html" target="n" data-glyph="74,1" class="i method">WriteInformation</a>(<a href="../engine/InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r39 rd" class="r39 r">record</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#f38cc55507c70e22" class="i method">WriteInformation</a>(<span class="r39 r">record</span>);
            }
        }
 
        <b>internal void</b> <a id="7d2edbbc32088735" href="../R/7d2edbbc32088735.html" target="n" data-glyph="74,1" class="i method">WriteInformation</a>(<b>object</b> <span id="r40 rd" class="r40 r">messageData</span>, <b>string</b>[] <span id="r41 rd" class="r41 r">tags</span>)
        {
            <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
            {
                <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#d39d94290d054da5" class="i method">WriteInformation</a>(<span class="r40 r">messageData</span>, <span class="r41 r">tags</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> User feedback mechanisms
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the filters that are used within this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">include</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The include filters which determines which items are included in</span>
        <span class="c">///</span><span class="c"> operations within this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">exclude</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exclude filters which determines which items are excluded from</span>
        <span class="c">///</span><span class="c"> operations within this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">filter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider specific filter for the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="44c8a66ad9db4cf4" href="../R/44c8a66ad9db4cf4.html" target="n" data-glyph="74,1" class="i method">SetFilters</a>(<span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r42 rd" class="r42 r">include</span>, <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r43 rd" class="r43 r">exclude</span>, <b>string</b> <span id="r44 rd" class="r44 r">filter</span>)
        {
            <a href="#ab4bd68ec99ecaa3" class="i property">Include</a> = <span class="r42 r">include</span>;
            <a href="#93e21581391c00fc" class="i property">Exclude</a> = <span class="r43 r">exclude</span>;
            <a href="#274e5d6991e70230" class="i property">Filter</a> = <span class="r44 r">filter</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an array of the objects that have been accumulated</span>
        <span class="c">///</span><span class="c"> and the clears the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object array of the objects that have been accumulated</span>
        <span class="c">///</span><span class="c"> through the WriteObject method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="c2d4b021c21c5144" href="../R/c2d4b021c21c5144.html" target="n" data-glyph="74,1" class="i method">GetAccumulatedObjects</a>()
        {
            <span class="c">// Get the contents as an array</span>
 
            <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r45 rd" class="r45 r">results</span> = <a href="#850c33eec64dfdad" class="i field">_accumulatedObjects</a>;
            <a href="#850c33eec64dfdad" class="i field">_accumulatedObjects</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
 
            <span class="c">// Return the array</span>
 
            <b>return</b> <span class="r45 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an array of the error objects that have been accumulated</span>
        <span class="c">///</span><span class="c"> and the clears the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object array of the objects that have been accumulated</span>
        <span class="c">///</span><span class="c"> through the WriteError method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="0915d5820646740a" href="../R/0915d5820646740a.html" target="n" data-glyph="74,1" class="i method">GetAccumulatedErrorObjects</a>()
        {
            <span class="c">// Get the contents as an array</span>
 
            <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r46 rd" class="r46 r">results</span> = <a href="#da75917a781d986b" class="i field">_accumulatedErrorObjects</a>;
            <a href="#da75917a781d986b" class="i field">_accumulatedErrorObjects</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
 
            <span class="c">// Return the array</span>
 
            <b>return</b> <span class="r46 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there are any errors accumulated, the first error is thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a CmdletProvider wrote any exceptions to the error pipeline, it is</span>
        <span class="c">///</span><span class="c"> wrapped and then thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c8e1b5c9dc612598" href="../R/c8e1b5c9dc612598.html" target="n" data-glyph="74,1" class="i method">ThrowFirstErrorOrDoNothing</a>()
        {
            <a href="#fbd6be97427096df" class="i method">ThrowFirstErrorOrDoNothing</a>(<b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there are any errors accumulated, the first error is thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">wrapExceptionInProviderException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the error will be wrapped in a ProviderInvocationException before</span>
        <span class="c">///</span><span class="c"> being thrown. If false, the error will be thrown as is.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">wrapExceptionInProviderException</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true, the</span>
        <span class="c">///</span><span class="c"> first exception that was written to the error pipeline by a CmdletProvider</span>
        <span class="c">///</span><span class="c"> is wrapped and thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">wrapExceptionInProviderException</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false,</span>
        <span class="c">///</span><span class="c"> the first exception that was written to the error pipeline by a CmdletProvider</span>
        <span class="c">///</span><span class="c"> is thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="fbd6be97427096df" href="../R/fbd6be97427096df.html" target="n" data-glyph="74,1" class="i method">ThrowFirstErrorOrDoNothing</a>(<b>bool</b> <span id="r47 rd" class="r47 r">wrapExceptionInProviderException</span>)
        {
            <b>if</b> (<a href="#98adf40dae698aee" class="i method">HasErrors</a>())
            {
                <span class="i">Collection</span>&lt;<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r48 rd" class="r48 r">errors</span> = <a href="#0915d5820646740a" class="i method">GetAccumulatedErrorObjects</a>();
 
                <b>if</b> (<span class="r48 r">errors</span> != <b>null</b> &amp;&amp; <span class="r48 r">errors</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// Throw the first exception</span>
 
                    <b>if</b> (<span class="r47 r">wrapExceptionInProviderException</span>)
                    {
                        <a href="../engine/DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r49 rd" class="r49 r">providerInfo</span> = <b>null</b>;
                        <b>if</b> (<a href="#1e83d35d5286e174" class="k">this</a>.<a href="#fc5b658eeb4ac721" class="i property">ProviderInstance</a> != <b>null</b>)
                        {
                            <span class="r49 r">providerInfo</span> = <a href="#1e83d35d5286e174" class="k">this</a>.<a href="#fc5b658eeb4ac721" class="i property">ProviderInstance</a>.<a href="ProviderBase.cs.html#6129ef83671ead76" class="i property">ProviderInfo</a>;
                        }
 
                        <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r50 rd" class="r50 r">e</span> =
                            <b>new</b> <span class="t">ProviderInvocationException</span>(
                                <span class="r49 r">providerInfo</span>,
                                <span class="r48 r">errors</span>[0]);
 
                        <span class="c">// Log a provider health event</span>
 
                        <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<span class="i">LogProviderHealthEvent</span>(
                            <a href="#1e83d35d5286e174" class="k">this</a>.<a href="#6e235b353e90f247" class="i property">ExecutionContext</a>,
                            <span class="r49 r">providerInfo</span> != <b>null</b> ? <span class="r49 r">providerInfo</span>.<a href="../engine/DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a> : <span class="s">&quot;unknown provider&quot;</span>,
                            <span class="r50 r">e</span>,
                            <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
 
                        <b>throw</b> <span class="r50 r">e</span>;
                    }
                    <b>else</b>
                    {
                        <b>throw</b> <span class="r48 r">errors</span>[0].<span class="i">Exception</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes all the accumulated errors to the specified context using WriteError.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">errorContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context to write the errors to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">errorContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b54d7344a7a16d71" href="../R/b54d7344a7a16d71.html" target="n" data-glyph="74,1" class="i method">WriteErrorsToContext</a>(<a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r51 rd" class="r51 r">errorContext</span>)
        {
            <b>if</b> (<span class="r51 r">errorContext</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r51 r">errorContext</span>));
            }
 
            <b>if</b> (<a href="#98adf40dae698aee" class="i method">HasErrors</a>())
            {
                <b>foreach</b> (<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r52 rd" class="r52 r">errorRecord</span> <b>in</b> <a href="#0915d5820646740a" class="i method">GetAccumulatedErrorObjects</a>())
                {
                    <span class="r51 r">errorContext</span>.<a href="#97661a296df11e6d" class="i method">WriteError</a>(<span class="r52 r">errorRecord</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an object to the output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to be written.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If streaming is on and the writeObjectHandler was specified then the object</span>
        <span class="c">///</span><span class="c"> gets written to the writeObjectHandler. If streaming is on and the writeObjectHandler</span>
        <span class="c">///</span><span class="c"> was not specified and the command object was specified, the object gets written to</span>
        <span class="c">///</span><span class="c"> the WriteObject method of the command object.</span>
        <span class="c">///</span><span class="c"> If streaming is off the object gets written to an accumulator collection. The collection</span>
        <span class="c">///</span><span class="c"> of written object can be retrieved using the AccumulatedObjects method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CmdletProvider could not stream the results because no</span>
        <span class="c">///</span><span class="c"> cmdlet was specified to stream the output through.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline has been signaled for stopping but</span>
        <span class="c">///</span><span class="c"> the provider calls this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="09901f5e3c1e6a4e" href="../R/09901f5e3c1e6a4e.html" target="n" data-glyph="74,1" class="i method">WriteObject</a>(<b>object</b> <span id="r53 rd" class="r53 r">obj</span>)
        {
            <span class="c">// Making sure to obey the StopProcessing by</span>
            <span class="c">// throwing an exception anytime a provider tries</span>
            <span class="c">// to WriteObject</span>
 
            <b>if</b> (<a href="#649b794a0afa4fa8" class="i property">Stopping</a>)
            {
                <a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a> <span id="r54 rd" class="r54 r">stopPipeline</span> =
                    <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
 
                <b>throw</b> <span class="r54 r">stopPipeline</span>;
            }
 
            <b>if</b> (<a href="#9b96586b254b58dd" class="i property">PassThru</a>)
            {
                <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
                {
                    <a href="#448fe8cdb89aa297" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Writing to command pipeline&quot;</span>);
 
                    <span class="c">// Since there was no writeObject handler use</span>
                    <span class="c">// the command WriteObject method.</span>
 
                    <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r53 r">obj</span>);
                }
                <b>else</b>
                {
                    <span class="c">// The flag was set for streaming but we have no where</span>
                    <span class="c">// to stream to.</span>
 
                    <span class="i">InvalidOperationException</span> <span id="r55 rd" class="r55 r">e</span> =
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                            <span class="i">SessionStateStrings</span>.<span class="i">OutputStreamingNotEnabled</span>);
                    <b>throw</b> <span class="r55 r">e</span>;
                }
            }
            <b>else</b>
            {
                <a href="#448fe8cdb89aa297" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Writing to accumulated objects&quot;</span>);
 
                <span class="c">// Convert the object to a PSObject if it&#39;s not already</span>
                <span class="c">// one.</span>
 
                <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r56 rd" class="r56 r">newObj</span> = <a href="../engine/MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../engine/MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r53 r">obj</span>);
 
                <span class="c">// Since we are not streaming, just add the object to the accumulatedObjects</span>
 
                <a href="#850c33eec64dfdad" class="i field">_accumulatedObjects</a>.<span class="i">Add</span>(<span class="r56 r">newObj</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the error to the pipeline or accumulates the error in an internal</span>
        <span class="c">///</span><span class="c"> buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error record to write to the pipeline or the internal buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CmdletProvider could not stream the error because no</span>
        <span class="c">///</span><span class="c"> cmdlet was specified to stream the output through.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline has been signaled for stopping but</span>
        <span class="c">///</span><span class="c"> the provider calls this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="97661a296df11e6d" href="../R/97661a296df11e6d.html" target="n" data-glyph="74,1" class="i method">WriteError</a>(<a href="../engine/ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r57 rd" class="r57 r">errorRecord</span>)
        {
            <span class="c">// Making sure to obey the StopProcessing by</span>
            <span class="c">// throwing an exception anytime a provider tries</span>
            <span class="c">// to WriteError</span>
 
            <b>if</b> (<a href="#649b794a0afa4fa8" class="i property">Stopping</a>)
            {
                <a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a> <span id="r58 rd" class="r58 r">stopPipeline</span> =
                    <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#105b0214d3aab114" class="t constructor">PipelineStoppedException</a>();
 
                <b>throw</b> <span class="r58 r">stopPipeline</span>;
            }
 
            <b>if</b> (<a href="#1b44305085a36605" class="i field">_streamErrors</a>)
            {
                <b>if</b> (<a href="#3f3284850ae00ae1" class="i field">_command</a> != <b>null</b>)
                {
                    <a href="#448fe8cdb89aa297" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Writing error package to command error pipe&quot;</span>);
 
                    <a href="#3f3284850ae00ae1" class="i field">_command</a>.<a href="../engine/cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r57 r">errorRecord</span>);
                }
                <b>else</b>
                {
                    <span class="i">InvalidOperationException</span> <span id="r59 rd" class="r59 r">e</span> =
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                            <span class="i">SessionStateStrings</span>.<span class="i">ErrorStreamingNotEnabled</span>);
                    <b>throw</b> <span class="r59 r">e</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// Since we are not streaming, just add the object to the accumulatedErrorObjects</span>
                <a href="#da75917a781d986b" class="i field">_accumulatedErrorObjects</a>.<span class="i">Add</span>(<span class="r57 r">errorRecord</span>);
 
                <b>if</b> (<span class="r57 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b>
                    &amp;&amp; <span class="r57 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="../engine/ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> != <b>null</b>)
                {
                    <span class="i">Exception</span> <span id="r60 rd" class="r60 r">textLookupError</span> = <span class="r57 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="../engine/ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a>;
                    <span class="r57 r">errorRecord</span>.<a href="../engine/ErrorPackage.cs.html#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="../engine/ErrorPackage.cs.html#b82f0242bd2d7b72" class="i property">TextLookupError</a> = <b>null</b>;
                    <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#565c5a5f3608944d" class="i method">LogProviderHealthEvent</a>(
                        <a href="#1e83d35d5286e174" class="k">this</a>.<a href="#6e235b353e90f247" class="i property">ExecutionContext</a>,
                        <a href="#1e83d35d5286e174" class="k">this</a>.<a href="#fc5b658eeb4ac721" class="i property">ProviderInstance</a>.<a href="ProviderBase.cs.html#6129ef83671ead76" class="i property">ProviderInfo</a>.<a href="../engine/DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>,
                        <span class="r60 r">textLookupError</span>,
                        <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the error pipeline hasn&#39;t been supplied a delegate or a command then this method</span>
        <span class="c">///</span><span class="c"> will determine if any errors have accumulated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the errors are being accumulated and some errors have been accumulated.  False otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="98adf40dae698aee" href="../R/98adf40dae698aee.html" target="n" data-glyph="74,1" class="i method">HasErrors</a>()
        {
            <b>return</b> <a href="#da75917a781d986b" class="i field">_accumulatedErrorObjects</a> != <b>null</b> &amp;&amp; <a href="#da75917a781d986b" class="i field">_accumulatedErrorObjects</a>.<span class="i">Count</span> &gt; 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call this on a separate thread when a provider is using</span>
        <span class="c">///</span><span class="c"> this context to do work. This method will call the StopProcessing</span>
        <span class="c">///</span><span class="c"> method of the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="be8494a4c434a5e5" href="../R/be8494a4c434a5e5.html" target="n" data-glyph="74,1" class="i method">StopProcessing</a>()
        {
            <a href="#649b794a0afa4fa8" class="i property">Stopping</a> = <b>true</b>;
 
            <b>if</b> (<a href="#e9c071cb7aa5d9c5" class="i field">_providerInstance</a> != <b>null</b>)
            {
                <span class="c">// We don&#39;t need to catch any of the exceptions here because</span>
                <span class="c">// we are terminating the pipeline and any exception will</span>
                <span class="c">// be caught by the engine.</span>
 
                <a href="#e9c071cb7aa5d9c5" class="i field">_providerInstance</a>.<a href="ProviderBase.cs.html#483a76eaadb50f39" class="i method">StopProcessing</a>();
            }
 
            <span class="c">// Call the stop referrals if any</span>
 
            <b>foreach</b> (<a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r61 rd" class="r61 r">referralContext</span> <b>in</b> <a href="#83eb3c02121e2600" class="i property">StopReferrals</a>)
            {
                <span class="r61 r">referralContext</span>.<a href="#be8494a4c434a5e5" class="i method">StopProcessing</a>();
            }
        }
 
        <b>internal bool</b> <a id="649b794a0afa4fa8" href="../R/649b794a0afa4fa8.html" target="n" data-glyph="104,1" class="i property">Stopping</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of contexts to which the StopProcessing calls</span>
        <span class="c">///</span><span class="c"> should be referred.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a>&gt; <a id="83eb3c02121e2600" href="../R/83eb3c02121e2600.html" target="n" data-glyph="104,1" class="i property">StopReferrals</a> { <b>get</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<a href="#1e83d35d5286e174" class="t t">CmdletProviderContext</a>&gt;();
 
        <b>internal bool</b> <a id="140650e26c23dd20" href="../R/140650e26c23dd20.html" target="n" data-glyph="104,1" class="i property">HasIncludeOrExclude</a>
        {
            <b>get</b>
            {
                <b>return</b> ((<a href="#ab4bd68ec99ecaa3" class="i property">Include</a> != <b>null</b> &amp;&amp; <a href="#ab4bd68ec99ecaa3" class="i property">Include</a>.<span class="i">Count</span> &gt; 0) ||
                        (<a href="#93e21581391c00fc" class="i property">Exclude</a> != <b>null</b> &amp;&amp; <a href="#93e21581391c00fc" class="i property">Exclude</a>.<span class="i">Count</span> &gt; 0));
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public methods
    }
}
</pre></td></tr></table></div></body></html>
