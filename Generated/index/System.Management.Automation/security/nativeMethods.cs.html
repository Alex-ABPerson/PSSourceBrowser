<!DOCTYPE html>
<html><head><title>nativeMethods.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(2166);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/security/nativeMethods.cs" target="_top">security\nativeMethods.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56523
 
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i">DWORD</span> = <span class="i n">System</span>.<span class="i">UInt32</span>;
<b>using</b> <span class="i">BOOL</span> = <span class="i n">System</span>.<span class="i">UInt32</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Security</span>
{
    <span class="c">// Crypto API native constants</span>
    <b>internal static</b> <a href="../P/8710e5604ffa77bf.html" target="s" class="k">partial</a> <b>class</b> <a id="8710e5604ffa77bf" href="../R/8710e5604ffa77bf.html" target="n" data-glyph="2,0" class="t t">NativeConstants</a>
    {
        <b>internal const int</b> <a id="cf982207c12b0be3" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">CRYPT_OID_INFO_OID_KEY</a> = 1;
        <b>internal const int</b> <a id="e5165b2b307806ee" href="../R/e5165b2b307806ee.html" target="n" data-glyph="8,1" class="i field">CRYPT_OID_INFO_NAME_KEY</a> = 2;
        <b>internal const int</b> <a id="0ff16e8d344d6db1" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">CRYPT_OID_INFO_CNG_ALGID_KEY</a> = 5;
    }
 
    <span class="c">// Safer native constants</span>
    <b>internal</b> <a href="../P/8710e5604ffa77bf.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeConstants</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_TOKEN_NULL_IF_EQUAL -&gt; 0x00000001.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="63bc2583060e665b" href="../R/63bc2583060e665b.html" target="n" data-glyph="6,1" class="i field">SAFER_TOKEN_NULL_IF_EQUAL</a> = 1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_TOKEN_COMPARE_ONLY -&gt; 0x00000002.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="d773ff87bd527087" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">SAFER_TOKEN_COMPARE_ONLY</a> = 2;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_TOKEN_MAKE_INERT -&gt; 0x00000004.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="083bc58d07e79760" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">SAFER_TOKEN_MAKE_INERT</a> = 4;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_IMAGEPATH -&gt; 0x00001.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="5e1c593982250c8b" href="../R/5e1c593982250c8b.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_IMAGEPATH</a> = 1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_NOSIGNEDHASH -&gt; 0x00002.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="b90fe1cbc0961391" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_NOSIGNEDHASH</a> = 2;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_IMAGEHASH -&gt; 0x00004.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="f698a50143de406b" href="../R/f698a50143de406b.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_IMAGEHASH</a> = 4;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_AUTHENTICODE -&gt; 0x00008.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="1421bc6054d461f9" href="../R/1421bc6054d461f9.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_AUTHENTICODE</a> = 8;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_URLZONE -&gt; 0x00010.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="0ac3bc27273ec7b9" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_URLZONE</a> = 16;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_CRITERIA_IMAGEPATH_NT -&gt; 0x01000.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="1f3c75c7356a82f7" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">SAFER_CRITERIA_IMAGEPATH_NT</a> = 4096;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WTD_UI_NONE -&gt; 0x00002.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="8669194cca490212" href="../R/8669194cca490212.html" target="n" data-glyph="6,1" class="i field">WTD_UI_NONE</a> = 2;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> S_OK -&gt; ((HRESULT)0L)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="055e6579dd4d3c01" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">S_OK</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> S_FALSE -&gt; ((HRESULT)1L)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="26ca897e24e984d6" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">S_FALSE</a> = 1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ERROR_MORE_DATA -&gt; 234L.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="878b6266a08de297" href="../R/../../0000000000.html" target="n" data-glyph="6,1" class="i field">ERROR_MORE_DATA</a> = 234;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ERROR_ACCESS_DISABLED_BY_POLICY -&gt; 1260L.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="48d70c2dd896fa62" href="../R/48d70c2dd896fa62.html" target="n" data-glyph="6,1" class="i field">ERROR_ACCESS_DISABLED_BY_POLICY</a> = 1260;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ERROR_ACCESS_DISABLED_NO_SAFER_UI_BY_POLICY -&gt; 786L.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="916b6bc740ae9d32" href="../R/916b6bc740ae9d32.html" target="n" data-glyph="6,1" class="i field">ERROR_ACCESS_DISABLED_NO_SAFER_UI_BY_POLICY</a> = 786;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SAFER_MAX_HASH_SIZE -&gt; 64.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const int</b> <a id="f4887edc37d4b7f1" href="../R/f4887edc37d4b7f1.html" target="n" data-glyph="6,1" class="i field">SAFER_MAX_HASH_SIZE</a> = 64;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SRP_POLICY_SCRIPT -&gt; L&quot;SCRIPT&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="ed9966073c0ce587" href="../R/ed9966073c0ce587.html" target="n" data-glyph="6,1" class="i field">SRP_POLICY_SCRIPT</a> = <span class="s">&quot;SCRIPT&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SIGNATURE_DISPLAYNAME_LENGTH -&gt; MAX_PATH.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="af7a9fbabaf1203f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SIGNATURE_DISPLAYNAME_LENGTH</a> = <a href="../P/8710e5604ffa77bf.html#8710e5604ffa77bf" class="t t">NativeConstants</a>.<a href="#ba5cf9bec23657f0" class="i field">MAX_PATH</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SIGNATURE_PUBLISHER_LENGTH -&gt; 128.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="59875ca875a0b5f1" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SIGNATURE_PUBLISHER_LENGTH</a> = 128;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SIGNATURE_HASH_LENGTH -&gt; 64.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="a1a0f02aac15c753" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SIGNATURE_HASH_LENGTH</a> = 64;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> MAX_PATH -&gt; 260.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="ba5cf9bec23657f0" href="../R/ba5cf9bec23657f0.html" target="n" data-glyph="8,1" class="i field">MAX_PATH</a> = 260;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">Summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This function is not supported on this system.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">Summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="e1fa29a1d53b8abc" href="../R/e1fa29a1d53b8abc.html" target="n" data-glyph="8,1" class="i field">FUNCTION_NOT_SUPPORTED</a> = 120;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Pinvoke methods from crypt32.dll.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static</b> <a href="../P/8e47b880ffb978dc.html" target="s" class="k">partial</a> <b>class</b> <a id="8e47b880ffb978dc" href="../R/8e47b880ffb978dc.html" target="n" data-glyph="2,0" class="t t">NativeMethods</a>
    {
        <span class="c">// -------------------------------------------------------------------</span>
        <span class="c">// crypt32.dll stuff</span>
        <span class="c">//</span>
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="b2567beca59466b5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertEnumSystemStore</a>(<a href="#b51e8370cbdd0329" class="t t">CertStoreFlags</a> <span id="r0 rd" class="r0 r">Flags</span>,
                                 <span class="i">IntPtr</span> <span id="r1 rd" class="r1 r">notUsed1</span>,
                                 <span class="i">IntPtr</span> <span id="r2 rd" class="r2 r">notUsed2</span>,
                                 <a href="#6281d71cd3307532" class="t t">CertEnumSystemStoreCallBackProto</a> <span id="r3 rd" class="r3 r">fn</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signature of call back function used by CertEnumSystemStore.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate
        bool</b> <a id="6281d71cd3307532" href="../R/6281d71cd3307532.html" target="n" data-glyph="14,1" class="t t"><span id="84626b6921f5621c">CertEnumSystemStoreCallBackProto</span></a>([<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                                               <b>string</b> <span id="r4 rd" class="r4 r">storeName</span>,
                                               <span class="i">DWORD</span> <span id="r5 rd" class="r5 r">dwFlagsNotUsed</span>,
                                               <span class="i">IntPtr</span> <span id="r6 rd" class="r6 r">notUsed1</span>,
                                               <span class="i">IntPtr</span> <span id="r7 rd" class="r7 r">notUsed2</span>,
                                               <span class="i">IntPtr</span> <span id="r8 rd" class="r8 r">notUsed3</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signature of cert enumeration function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">IntPtr</span> <a id="9574ce4f0b75328f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertEnumCertificatesInStore</a>(<span class="i">IntPtr</span> <span id="r9 rd" class="r9 r">storeHandle</span>,
                                            <span class="i">IntPtr</span> <span id="r10 rd" class="r10 r">certContext</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signature of cert find function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">IntPtr</span> <a id="2a0494e79988523e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertFindCertificateInStore</a>(
            <span class="i">IntPtr</span> <span id="r11 rd" class="r11 r">hCertStore</span>,
            <span class="i n">Security</span>.<a href="../P/8e47b880ffb978dc.html#8e47b880ffb978dc" class="t t">NativeMethods</a>.<a href="#24439daa21f04bd9" class="t t">CertOpenStoreEncodingType</a> <span id="r12 rd" class="r12 r">dwEncodingType</span>,
            <span class="i">DWORD</span> <span id="r13 rd" class="r13 r">dwFindFlags</span>,                  <span class="c">// 0</span>
            <span class="i n">Security</span>.<a href="../P/8e47b880ffb978dc.html#8e47b880ffb978dc" class="t t">NativeMethods</a>.<a href="#4da39670a39af27b" class="t t">CertFindType</a> <span id="r14 rd" class="r14 r">dwFindType</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r15 rd" class="r15 r">pvFindPara</span>,
            <span class="i">IntPtr</span> <span id="r16 rd" class="r16 r">notUsed1</span>);                   <span class="c">// pPrevCertContext</span>
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="4da39670a39af27b" href="../R/4da39670a39af27b.html" target="n" data-glyph="20,1" class="t t"><span id="af0eddab00de0f3d">CertFindType</span></a>
        {                                                       <span class="c">// pvFindPara:</span>
            <a id="611ebf9268a1810f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_COMPARE_ANY</a> = 0 &lt;&lt; 16,         <span class="c">// null</span>
            <a id="cd3691605ccf8398" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_FIND_ISSUER_STR</a> = (8 &lt;&lt; 16) | 4,   <span class="c">// substring</span>
            <a id="4e7ed610a7861413" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_FIND_SUBJECT_STR</a> = (8 &lt;&lt; 16) | 7,   <span class="c">// substring</span>
            <a id="2ff683bb4dee0596" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_FIND_CROSS_CERT_DIST_POINTS</a> = 17 &lt;&lt; 16,        <span class="c">// null</span>
            <a id="7751b6d1b97dc4e2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_FIND_SUBJECT_INFO_ACCESS</a> = 19 &lt;&lt; 16,        <span class="c">// null</span>
            <a id="a47635c18532f207" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_FIND_HASH_STR</a> = 20 &lt;&lt; 16,        <span class="c">// thumbprint</span>
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="4afefa97d5f81236" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertCloseStore</a>(<span class="i">IntPtr</span> <span id="r17 rd" class="r17 r">hCertStore</span>, <b>int</b> <span id="r18 rd" class="r18 r">dwFlags</span>);
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="b51e8370cbdd0329" href="../R/b51e8370cbdd0329.html" target="n" data-glyph="20,1" class="t t"><span id="5fec194219a68ceb">CertStoreFlags</span></a>
        {
            <a id="407677214ddd3c35" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_USER</a> = 1 &lt;&lt; 16,
            <a id="bd6af7c5c06a0ed4" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE</a> = 2 &lt;&lt; 16,
            <a id="6cb71a8afd03fa01" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_SERVICE</a> = 4 &lt;&lt; 16,
            <a id="8d78165031f753a0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_SERVICES</a> = 5 &lt;&lt; 16,
            <a id="ac82493a7cfc537f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_USERS</a> = 6 &lt;&lt; 16,
            <a id="ff65ebc827d66aff" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_USER_GROUP_POLICY</a> = 7 &lt;&lt; 16,
            <a id="c8c1e0b9fb9e16f0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY</a> = 8 &lt;&lt; 16,
            <a id="e39eb0f185722f7b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE_ENTERPRISE</a> = 9 &lt;&lt; 16,
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="91bf1376b85fb91e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertGetEnhancedKeyUsage</a>(<span class="i">IntPtr</span> <span id="r19 rd" class="r19 r">pCertContext</span>, <span class="c">// PCCERT_CONTEXT</span>
                                      <span class="i">DWORD</span> <span id="r20 rd" class="r20 r">dwFlags</span>,
                                      <span class="i">IntPtr</span> <span id="r21 rd" class="r21 r">pUsage</span>,       <span class="c">// PCERT_ENHKEY_USAGE</span>
                                      <b>out int</b> <span id="r22 rd" class="r22 r">pcbUsage</span>);  <span class="c">// DWORD*</span>
 
        [<span class="i">DllImport</span>(<span class="s">&quot;Crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">IntPtr</span> <a id="05e6a196887feb7c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertOpenStore</a>(<a href="#7ba05a631a0d5c60" class="t t">CertOpenStoreProvider</a> <span id="r23 rd" class="r23 r">storeProvider</span>,
                              <a href="#24439daa21f04bd9" class="t t">CertOpenStoreEncodingType</a> <span id="r24 rd" class="r24 r">dwEncodingType</span>,
                              <span class="i">IntPtr</span> <span id="r25 rd" class="r25 r">notUsed1</span>,          <span class="c">// hCryptProv</span>
                              <a href="#019df68e96544337" class="t t">CertOpenStoreFlags</a> <span id="r26 rd" class="r26 r">dwFlags</span>,
                              [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                              <b>string</b> <span id="r27 rd" class="r27 r">storeName</span>);
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="019df68e96544337" href="../R/019df68e96544337.html" target="n" data-glyph="20,1" class="t t"><span id="d77553c7c317843e">CertOpenStoreFlags</span></a>
        {
            <a id="74f37e701598e06a" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_NO_CRYPT_RELEASE_FLAG</a> = 0x00000001,
            <a id="7277a74e5b0e9881" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_SET_LOCALIZED_NAME_FLAG</a> = 0x00000002,
            <a id="e5d315930d58b1a7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_DEFER_CLOSE_UNTIL_LAST_FREE_FLAG</a> = 0x00000004,
            <a id="f83b0598b7e1c45c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_DELETE_FLAG</a> = 0x00000010,
            <a id="22f8e205a9c896e0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_UNSAFE_PHYSICAL_FLAG</a> = 0x00000020,
            <a id="7305889c4bb1e0af" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_SHARE_STORE_FLAG</a> = 0x00000040,
            <a id="89fee050e0b6eb93" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_SHARE_CONTEXT_FLAG</a> = 0x00000080,
            <a id="eb7d864ff4fc1b8e" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_MANIFOLD_FLAG</a> = 0x00000100,
            <a id="defcbe0aeb056228" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ENUM_ARCHIVED_FLAG</a> = 0x00000200,
            <a id="1d743574aa636912" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_UPDATE_KEYID_FLAG</a> = 0x00000400,
            <a id="d7f2c61f63a6c9bc" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_BACKUP_RESTORE_FLAG</a> = 0x00000800,
            <a id="50eebc9092196493" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_READONLY_FLAG</a> = 0x00008000,
            <a id="59f4bc29a493e7f4" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_OPEN_EXISTING_FLAG</a> = 0x00004000,
            <a id="bf070b450c4c248f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_CREATE_NEW_FLAG</a> = 0x00002000,
            <a id="ba5a949a08c9a8d1" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_MAXIMUM_ALLOWED_FLAG</a> = 0x00001000,
 
            <a id="7f9313a03e54aec9" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_USER</a> = 1 &lt;&lt; 16,
            <a id="95010b6be8826dca" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE</a> = 2 &lt;&lt; 16,
            <a id="742f92788991e7be" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_SERVICE</a> = 4 &lt;&lt; 16,
            <a id="07393924f00928e5" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_SERVICES</a> = 5 &lt;&lt; 16,
            <a id="495f0f283b6d53c7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_USERS</a> = 6 &lt;&lt; 16,
            <a id="e48bae29ab7f3bac" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_CURRENT_USER_GROUP_POLICY</a> = 7 &lt;&lt; 16,
            <a id="3d72c5ff95fa109d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE_GROUP_POLICY</a> = 8 &lt;&lt; 16,
            <a id="1de5e980febf3df6" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SYSTEM_STORE_LOCAL_MACHINE_ENTERPRISE</a> = 9 &lt;&lt; 16,
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="7ba05a631a0d5c60" href="../R/7ba05a631a0d5c60.html" target="n" data-glyph="20,1" class="t t"><span id="45553450dc784f36">CertOpenStoreProvider</span></a>
        {
            <a id="743ed9f5d6f7046a" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_PROV_MEMORY</a> = 2,
            <a id="501a4f261d7554be" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_PROV_SYSTEM</a> = 10,
            <a id="98a1cc48aa8a3f46" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_PROV_SYSTEM_REGISTRY</a> = 13,
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="24439daa21f04bd9" href="../R/24439daa21f04bd9.html" target="n" data-glyph="20,1" class="t t"><span id="998dda3c9e70749a">CertOpenStoreEncodingType</span></a>
        {
            <a id="2ad57eec775ef307" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">X509_ASN_ENCODING</a> = 0x00000001,
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;Crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="72bd6e63e4f22c87" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertControlStore</a>(
                        <span class="i">IntPtr</span> <span id="r28 rd" class="r28 r">hCertStore</span>,
                        <span class="i">DWORD</span> <span id="r29 rd" class="r29 r">dwFlags</span>,
                        <a href="#0bfd7d5849e24157" class="t t">CertControlStoreType</a> <span id="r30 rd" class="r30 r">dwCtrlType</span>,
                        <span class="i">IntPtr</span> <span id="r31 rd" class="r31 r">pvCtrlPara</span>);
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="0bfd7d5849e24157" href="../R/0bfd7d5849e24157.html" target="n" data-glyph="20,1" class="t t"><span id="b9b990d5bf449e8f">CertControlStoreType</span></a> : <b>uint</b>
        {
            <a id="b6d9d6e55faf14b1" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_CTRL_RESYNC</a> = 1,
            <a id="fe90656add1be746" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_CTRL_COMMIT</a> = 3,
            <a id="e2a52e4f896aee68" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_CTRL_AUTO_RESYNC</a> = 4,
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="2c096b4b26c34cb8" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="23aea358768968f8">AddCertificateContext</span></a> : <b>uint</b>
        {
            <a id="99062d776e549bf0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_NEW</a> = 1,
            <a id="eca90b8d992bfabc" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_USE_EXISTING</a> = 2,
            <a id="06590387ae3275ed" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_REPLACE_EXISTING</a> = 3,
            <a id="a8845b8a4ea0f522" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_ALWAYS</a> = 4,
            <a id="af3fcc492ebabe47" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_REPLACE_EXISTING_INHERIT_PROPERTIES</a> = 5,
            <a id="697d7e357109e46d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_NEWER</a> = 6,
            <a id="867a8d790a02959b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_STORE_ADD_NEWER_INHERIT_PROPERTIES</a> = 7
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="a854e13a0f719a4c" href="../R/a854e13a0f719a4c.html" target="n" data-glyph="20,1" class="t t"><span id="e19081c09fa997f1">CertPropertyId</span></a>
        {
            <a id="cfd2136581aad955" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_KEY_PROV_HANDLE_PROP_ID</a> = 1,
            <a id="7d01abdccc28f3d7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_KEY_PROV_INFO_PROP_ID</a> = 2,   <span class="c">// CRYPT_KEY_PROV_INFO</span>
            <a id="fa75b1daa9a7eca7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SHA1_HASH_PROP_ID</a> = 3,
            <a id="87693e00283921d7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_MD5_HASH_PROP_ID</a> = 4,
            <a id="009307bc0e0fc35b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_SEND_AS_TRUSTED_ISSUER_PROP_ID</a> = 102,
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="c0e2d3de4548bbe5" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="5837f053df72cd9e">NCryptDeletKeyFlag</span></a>
        {
            <a id="4189487b9150fa23" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">NCRYPT_MACHINE_KEY_FLAG</a> = 0x00000020,  <span class="c">// same as CAPI CRYPT_MACHINE_KEYSET</span>
            <a id="c497a4c5e0fcfe84" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">NCRYPT_SILENT_FLAG</a> = 0x00000040,  <span class="c">// same as CAPI CRYPT_SILENT</span>
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="accbc53a56ae0d5c" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="fbca1403cc07b46f">ProviderFlagsEnum</span></a> : <b>uint</b>
        {
            <a id="a27c34131311afc4" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_VERIFYCONTEXT</a> = 0xF0000000,
            <a id="bc7d4916ce32e87d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_NEWKEYSET</a> = 0x00000008,
            <a id="67ca0ec5cfc5b996" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_DELETEKEYSET</a> = 0x00000010,
            <a id="15c6879a3e76e687" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_MACHINE_KEYSET</a> = 0x00000020,
            <a id="18a6318ead265fa1" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_SILENT</a> = 0x00000040,
        }
 
        <b>internal enum</b> <a id="31bc02db645bc2cd" href="../R/31bc02db645bc2cd.html" target="n" data-glyph="20,1" class="t t"><span id="a3b39e22bb6373b2">ProviderParam</span></a> : <b>int</b>
        {
            <a id="09abbe14af8a6814" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PP_CLIENT_HWND</a> = 1,
        }
 
        <b>internal enum</b> <a id="eeeed12a339f0d46" href="../R/eeeed12a339f0d46.html" target="n" data-glyph="20,1" class="t t"><span id="01ab76c9ec4fdca9">PROV</span></a> : <b>uint</b>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_RSA_FULL type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="4b320b859d2c72a2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RSA_FULL</a> = 1,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_RSA_SIG type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="940c3b4e5a143fdb" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RSA_SIG</a> = 2,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_RSA_DSS type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="bf852c1e2659a058" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">DSS</a> = 3,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_FORTEZZA type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="621ac6d202572b73" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">FORTEZZA</a> = 4,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_MS_EXCHANGE type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="75c2b1f28ad315cd" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">MS_EXCHANGE</a> = 5,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_SSL type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="0cb10b3aaf621c77" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SSL</a> = 6,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_RSA_SCHANNEL type. SSL certificates are generated with these providers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="8e8068955dc26fdb" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RSA_SCHANNEL</a> = 12,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_DSS_DH type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="3b2a823a5eebdd76" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">DSS_DH</a> = 13,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_EC_ECDSA type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="f816207ef75e25ce" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">EC_ECDSA_SIG</a> = 14,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_EC_ECNRA_SIG type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="b53e9dfeb639b6ed" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">EC_ECNRA_SIG</a> = 15,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_EC_ECDSA_FULL type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="f72d865f2f7f19e3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">EC_ECDSA_FULL</a> = 16,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_EC_ECNRA_FULL type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="4bb05ef1fdf03ff3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">EC_ECNRA_FULL</a> = 17,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_DH_SCHANNEL type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="fd7b4b8bb6681409" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">DH_SCHANNEL</a> = 18,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_SPYRUS_LYNKS type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="43daf32077a7e329" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SPYRUS_LYNKS</a> = 20,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_RNG type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="eb654a4575e9ec5d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RNG</a> = 21,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The PROV_INTEL_SEC type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="1681581d22e64b1c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">INTEL_SEC</a> = 22
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="1606d27affa9eeed" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="90ae617403b25608">CRYPT_KEY_PROV_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> String naming a key container within a particular CSP.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public string</b> <a id="dba91fc6a9d839ec" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pwszContainerName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> String that names a CSP.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public string</b> <a id="15b9c9f8ba0535bd" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pwszProvName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> CSP type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public</b> <a href="#eeeed12a339f0d46" class="t t">PROV</a> <a id="13504a1e0d5a5020" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwProvType</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Flags value indicating whether a key container is to be created or destroyed, and</span>
            <span class="c">///</span><span class="c"> whether an application is allowed access to a key container.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public uint</b> <a id="c589cbbab666a366" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwFlags</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Number of elements in the rgProvParam array.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public uint</b> <a id="d326ae12be58e028" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cProvParam</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Array of pointers to CRYPT_KEY_PROV_PARAM structures.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">IntPtr</span> <a id="3ddfc276b7bbe3de" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">rgProvParam</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The specification of the private key to retrieve. AT_KEYEXCHANGE and AT_SIGNATURE</span>
            <span class="c">///</span><span class="c"> are defined for the default provider.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public uint</b> <a id="fceb3ab2d660c9d5" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwKeySpec</a>;
        }
 
        <b>internal const string</b> <a id="d9c2ea88c671b515" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">NCRYPT_WINDOW_HANDLE_PROPERTY</a> = <span class="s">&quot;HWND Handle&quot;</span>;
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="809080fcea7ad23f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertDeleteCertificateFromStore</a>(<span class="i">IntPtr</span> <span id="r32 rd" class="r32 r">pCertContext</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">IntPtr</span> <a id="9531c1623fef0e3f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertDuplicateCertificateContext</a>(<span class="i">IntPtr</span> <span id="r33 rd" class="r33 r">pCertContext</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="c9d6508283987f11" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertAddCertificateContextToStore</a>(<span class="i">IntPtr</span> <span id="r34 rd" class="r34 r">hCertStore</span>,
                                              <span class="i">IntPtr</span> <span id="r35 rd" class="r35 r">pCertContext</span>,
                                              <span class="i">DWORD</span> <span id="r36 rd" class="r36 r">dwAddDisposition</span>,
                                              <b>ref</b> <span class="i">IntPtr</span> <span id="r37 rd" class="r37 r">ppStoreContext</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="35434eb108ded018" href="../R/35434eb108ded018.html" target="n" data-glyph="74,1" class="i method">CertFreeCertificateContext</a>(<span class="i">IntPtr</span> <span id="r38 rd" class="r38 r">certContext</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="9a9b2485e29c28f1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertGetCertificateContextProperty</a>(<span class="i">IntPtr</span> <span id="r39 rd" class="r39 r">pCertContext</span>,
                                               <a href="#a854e13a0f719a4c" class="t t">CertPropertyId</a> <span id="r40 rd" class="r40 r">dwPropId</span>,
                                               <span class="i">IntPtr</span> <span id="r41 rd" class="r41 r">pvData</span>,
                                               <b>ref int</b> <span id="r42 rd" class="r42 r">pcbData</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="39367496ec28037e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CertSetCertificateContextProperty</a>(<span class="i">IntPtr</span> <span id="r43 rd" class="r43 r">pCertContext</span>,
                                               <a href="#a854e13a0f719a4c" class="t t">CertPropertyId</a> <span id="r44 rd" class="r44 r">dwPropId</span>,
                                               <span class="i">DWORD</span> <span id="r45 rd" class="r45 r">dwFlags</span>,
                                               <span class="i">IntPtr</span> <span id="r46 rd" class="r46 r">pvData</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">IntPtr</span> <a id="a2fb2552bb64c246" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptFindLocalizedName</a>(<b>string</b> <span id="r47 rd" class="r47 r">pwszCryptName</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#070e0e02dcf8a6aa" class="i field">CryptAcquireContextDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="1de41d551c58d80b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptAcquireContext</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r48 rd" class="r48 r">hProv</span>,
                                 <b>string</b> <span id="r49 rd" class="r49 r">strContainerName</span>,
                                 <b>string</b> <span id="r50 rd" class="r50 r">strProviderName</span>,
                                 <b>int</b> <span id="r51 rd" class="r51 r">nProviderType</span>,
                                 <b>uint</b> <span id="r52 rd" class="r52 r">uiProviderFlags</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#224026bfc1d52a3e" class="i field">CryptReleaseContextDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="4894c83fabfb0307" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptReleaseContext</a>(<span class="i">IntPtr</span> <span id="r53 rd" class="r53 r">hProv</span>, <b>int</b> <span id="r54 rd" class="r54 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#92b93d6c32965d59" class="i field">CryptSetProvParamDllName</a>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>internal static extern unsafe
        bool</b> <a id="ee9f93fdbe8d43d3" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptSetProvParam</a>(<span class="i">IntPtr</span> <span id="r55 rd" class="r55 r">hProv</span>, <a href="#31bc02db645bc2cd" class="t t">ProviderParam</a> <span id="r56 rd" class="r56 r">dwParam</span>, <b>void</b>* <span id="r57 rd" class="r57 r">pbData</span>, <b>int</b> <span id="r58 rd" class="r58 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;ncrypt.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        int</b> <a id="a5c8a01993d19c97" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NCryptOpenStorageProvider</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r59 rd" class="r59 r">hProv</span>,
                                      <b>string</b> <span id="r60 rd" class="r60 r">strProviderName</span>,
                                      <b>uint</b> <span id="r61 rd" class="r61 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;ncrypt.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        int</b> <a id="56f1440cfd6ba26e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NCryptOpenKey</a>(<span class="i">IntPtr</span> <span id="r62 rd" class="r62 r">hProv</span>,
                          <b>ref</b> <span class="i">IntPtr</span> <span id="r63 rd" class="r63 r">hKey</span>,
                          <b>string</b> <span id="r64 rd" class="r64 r">strKeyName</span>,
                          <b>uint</b> <span id="r65 rd" class="r65 r">dwLegacySpec</span>,
                          <b>uint</b> <span id="r66 rd" class="r66 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;ncrypt.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern unsafe
        int</b> <a id="657625be44c16e33" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NCryptSetProperty</a>(<span class="i">IntPtr</span> <span id="r67 rd" class="r67 r">hProv</span>, <b>string</b> <span id="r68 rd" class="r68 r">pszProperty</span>, <b>void</b>* <span id="r69 rd" class="r69 r">pbInput</span>, <b>int</b> <span id="r70 rd" class="r70 r">cbInput</span>, <b>int</b> <span id="r71 rd" class="r71 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;ncrypt.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        int</b> <a id="774401883221e61d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NCryptDeleteKey</a>(<span class="i">IntPtr</span> <span id="r72 rd" class="r72 r">hKey</span>,
                            <b>uint</b> <span id="r73 rd" class="r73 r">dwFlags</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;ncrypt.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        int</b> <a id="8b178f527ebe2bf5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NCryptFreeObject</a>(<span class="i">IntPtr</span> <span id="r74 rd" class="r74 r">hObject</span>);
 
        <span class="c">// -----------------------------------------------------------------</span>
        <span class="c">// cryptUI.dll stuff</span>
        <span class="c">//</span>
 
        <span class="c">//</span>
        <span class="c">// CryptUIWizDigitalSign() function and associated structures/enums</span>
        <span class="c">//</span>
 
        [<span class="i">DllImport</span>(<span class="s">&quot;cryptUI.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern
        bool</b> <a id="558506c62ace3653" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptUIWizDigitalSign</a>(<span class="i">DWORD</span> <span id="r75 rd" class="r75 r">dwFlags</span>,
                                   <span class="i">IntPtr</span> <span id="r76 rd" class="r76 r">hwndParentNotUsed</span>,
                                   <span class="i">IntPtr</span> <span id="r77 rd" class="r77 r">pwszWizardTitleNotUsed</span>,
                                   <span class="i">IntPtr</span> <span id="r78 rd" class="r78 r">pDigitalSignInfo</span>,
                                   <span class="i">IntPtr</span> <span id="r79 rd" class="r79 r">ppSignContextNotUsed</span>);
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="8f7ff94913e85e03" href="../R/8f7ff94913e85e03.html" target="n" data-glyph="20,1" class="t t"><span id="b06993b29b027e95">CryptUIFlags</span></a>
        {
            <a id="9f5c59c67c2f023f" href="../R/9f5c59c67c2f023f.html" target="n" data-glyph="24,2" class="i field">CRYPTUI_WIZ_NO_UI</a> = 0x0001
            <span class="c">// other flags not used</span>
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="df8e3ea0bc9ee165" href="../R/df8e3ea0bc9ee165.html" target="n" data-glyph="110,1" class="t t"><span id="6648be26c1b4fa90">CRYPTUI_WIZ_DIGITAL_SIGN_INFO</span></a>
        {
            <b>internal</b> <span class="i">DWORD</span> <a id="9b59faedc71eea99" href="../R/9b59faedc71eea99.html" target="n" data-glyph="44,2" class="i field">dwSize</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="2e9a657a5cfdbe15" href="../R/2e9a657a5cfdbe15.html" target="n" data-glyph="44,2" class="i field">dwSubjectChoice</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="838762608b55ccfa" href="../R/838762608b55ccfa.html" target="n" data-glyph="44,2" class="i field">pwszFileName</a>;
 
            <b>internal</b> <span class="i">DWORD</span> <a id="9a481418e4b95b7b" href="../R/9a481418e4b95b7b.html" target="n" data-glyph="44,2" class="i field">dwSigningCertChoice</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="6d4e59c6d76f10bb" href="../R/6d4e59c6d76f10bb.html" target="n" data-glyph="44,2" class="i field">pSigningCertContext</a>; <span class="c">// PCCERT_CONTEXT</span>
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="a17c88b7ee011d13" href="../R/a17c88b7ee011d13.html" target="n" data-glyph="44,2" class="i field">pwszTimestampURL</a>;
 
            <b>internal</b> <span class="i">DWORD</span> <a id="d01e808a4a63d577" href="../R/d01e808a4a63d577.html" target="n" data-glyph="44,2" class="i field">dwAdditionalCertChoice</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="518550dccb633b4d" href="../R/518550dccb633b4d.html" target="n" data-glyph="44,2" class="i field">pSignExtInfo</a>; <span class="c">// PCCRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</span>
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="9df341838a67f723" href="../R/9df341838a67f723.html" target="n" data-glyph="20,1" class="t t"><span id="fb7dae7a88d08a57">SignInfoSubjectChoice</span></a>
        {
            <a id="6ba7abcce0da2c19" href="../R/6ba7abcce0da2c19.html" target="n" data-glyph="24,2" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_FILE</a> = 0x01
            <span class="c">// CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_BLOB = 0x02 NotUsed</span>
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="3874b596b552d0ee" href="../R/3874b596b552d0ee.html" target="n" data-glyph="20,1" class="t t"><span id="0d4769eac25dd7d4">SignInfoCertChoice</span></a>
        {
            <a id="a4d77ab26b8b648e" href="../R/a4d77ab26b8b648e.html" target="n" data-glyph="24,2" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_CERT</a> = 0x01
            <span class="c">// CRYPTUI_WIZ_DIGITAL_SIGN_STORE = 0x02, NotUsed</span>
            <span class="c">// CRYPTUI_WIZ_DIGITAL_SIGN_PVK = 0x03, NotUsed</span>
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="b1173d1b71fe372b" href="../R/b1173d1b71fe372b.html" target="n" data-glyph="20,1" class="t t"><span id="d9eb904d8a5f0f18">SignInfoAdditionalCertChoice</span></a>
        {
            <a id="8a3bd77e550a4044" href="../R/8a3bd77e550a4044.html" target="n" data-glyph="24,2" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN</a> = 1,
            <a id="9362ca2ba8858438" href="../R/9362ca2ba8858438.html" target="n" data-glyph="24,2" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN_NO_ROOT</a> = 2
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="3f27e0ee7868180e" href="../R/3f27e0ee7868180e.html" target="n" data-glyph="110,1" class="t t"><span id="e12dab2f1e47e5c1">CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</span></a>
        {
            <b>internal</b> <span class="i">DWORD</span> <a id="cafdfb12b3413486" href="../R/cafdfb12b3413486.html" target="n" data-glyph="44,2" class="i field">dwSize</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="6f301bb017347870" href="../R/6f301bb017347870.html" target="n" data-glyph="44,2" class="i field">dwAttrFlagsNotUsed</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="884143d4a83540c4" href="../R/884143d4a83540c4.html" target="n" data-glyph="44,2" class="i field">pwszDescription</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="0d80f41f11c4c64d" href="../R/0d80f41f11c4c64d.html" target="n" data-glyph="44,2" class="i field">pwszMoreInfoLocation</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
            <b>internal string</b> <a id="2949e9b74027afbf" href="../R/2949e9b74027afbf.html" target="n" data-glyph="44,2" class="i field">pszHashAlg</a>;
 
            <b>internal</b> <span class="i">IntPtr</span> <a id="f54dd09fb0f2689c" href="../R/f54dd09fb0f2689c.html" target="n" data-glyph="44,2" class="i field">pwszSigningCertDisplayStringNotUsed</a>; <span class="c">// LPCWSTR</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="381f7ebc319dd50e" href="../R/381f7ebc319dd50e.html" target="n" data-glyph="44,2" class="i field">hAdditionalCertStoreNotUsed</a>; <span class="c">// HCERTSTORE</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="559f2b914cb9eeef" href="../R/559f2b914cb9eeef.html" target="n" data-glyph="44,2" class="i field">psAuthenticatedNotUsed</a>;      <span class="c">// PCRYPT_ATTRIBUTES</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="808dccab1e6aa635" href="../R/808dccab1e6aa635.html" target="n" data-glyph="44,2" class="i field">psUnauthenticatedNotUsed</a>;    <span class="c">// PCRYPT_ATTRIBUTES</span>
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#3f27e0ee7868180e" class="t t">CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</a>
            <a id="2f3c1dda47824a31" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">InitSignInfoExtendedStruct</a>(<b>string</b> <span id="r80 rd" class="r80 r">description</span>,
                                       <b>string</b> <span id="r81 rd" class="r81 r">moreInfoUrl</span>,
                                       <b>string</b> <span id="r82 rd" class="r82 r">hashAlgorithm</span>)
        {
            <a href="#3f27e0ee7868180e" class="t t">CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</a> <span id="r83 rd" class="r83 r">siex</span> =
                <b>new</b> <span class="t">CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</span>();
 
            <span class="r83 r">siex</span>.<a href="#cafdfb12b3413486" class="i field">dwSize</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r83 r">siex</span>);
            <span class="r83 r">siex</span>.<a href="#6f301bb017347870" class="i field">dwAttrFlagsNotUsed</a> = 0;
            <span class="r83 r">siex</span>.<a href="#884143d4a83540c4" class="i field">pwszDescription</a> = <span class="r80 r">description</span>;
            <span class="r83 r">siex</span>.<a href="#0d80f41f11c4c64d" class="i field">pwszMoreInfoLocation</a> = <span class="r81 r">moreInfoUrl</span>;
            <span class="r83 r">siex</span>.<a href="#2949e9b74027afbf" class="i field">pszHashAlg</a> = <b>null</b>;
            <span class="r83 r">siex</span>.<a href="#f54dd09fb0f2689c" class="i field">pwszSigningCertDisplayStringNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r83 r">siex</span>.<a href="#381f7ebc319dd50e" class="i field">hAdditionalCertStoreNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r83 r">siex</span>.<a href="#559f2b914cb9eeef" class="i field">psAuthenticatedNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r83 r">siex</span>.<a href="#808dccab1e6aa635" class="i field">psUnauthenticatedNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <b>if</b> (<span class="r82 r">hashAlgorithm</span> != <b>null</b>)
            {
                <span class="r83 r">siex</span>.<a href="#2949e9b74027afbf" class="i field">pszHashAlg</a> = <span class="r82 r">hashAlgorithm</span>;
            }
 
            <b>return</b> <span class="r83 r">siex</span>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="314dcdcbaa6d8c0c" href="../R/314dcdcbaa6d8c0c.html" target="n" data-glyph="110,1" class="t t"><span id="b890b1dd3408dcc1">CRYPT_OID_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>public uint</b> <a id="95011030b3af86b6" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cbSize</a>;
 
            <span class="c">///</span><span class="c"> LPCSTR-&gt;CHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
            <b>public string</b> <a id="bc42d3b869f3a936" href="../R/bc42d3b869f3a936.html" target="n" data-glyph="42,2" class="i field">pszOID</a>;
 
            <span class="c">///</span><span class="c"> LPCWSTR-&gt;WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>public string</b> <a id="766867229d5c8398" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pwszName</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>public uint</b> <a id="ec83070cc38260a3" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwGroupId</a>;
 
            <span class="c">///</span><span class="c"> Anonymous_a3ae7823_8a1d_432c_bc07_a72b6fc6c7d8</span>
            <b>public</b> <a href="#38afbf36fab53666" class="t t">Anonymous_a3ae7823_8a1d_432c_bc07_a72b6fc6c7d8</a> <a id="388d6d86bbd748c5" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">Union1</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_DATA_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>public</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="eeb96fe87196516d" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">ExtraInfo</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Explicit</span>)]
        <b>internal struct</b> <a id="38afbf36fab53666" href="../R/38afbf36fab53666.html" target="n" data-glyph="110,1" class="t t"><span id="2b1d5558a356f851">Anonymous_a3ae7823_8a1d_432c_bc07_a72b6fc6c7d8</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            [<span class="i">FieldOffset</span>(0)]
            <b>public uint</b> <a id="9b74660ea02dbcbf" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwValue</a>;
 
            <span class="c">///</span><span class="c"> ALG_ID-&gt;unsigned int</span>
            [<span class="i">FieldOffset</span>(0)]
            <b>public uint</b> <a id="c97f4edfb24022e3" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">Algid</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            [<span class="i">FieldOffset</span>(0)]
            <b>public uint</b> <a id="647f3edf996e74ef" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwLength</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="ccbd29b032ebd6eb" href="../R/ccbd29b032ebd6eb.html" target="n" data-glyph="110,1" class="t t"><span id="e2ae4e6d66e65d42">CRYPT_ATTR_BLOB</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>public uint</b> <a id="6cabaf9038fbc1e1" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cbData</a>;
 
            <span class="c">///</span><span class="c"> BYTE*</span>
            <b>public</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="c564f633ce2ed1c8" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pbData</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="9042fe6a5fdc753a" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="3c81de9bc757a654">CRYPT_DATA_BLOB</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>public uint</b> <a id="d5d94f8372300b70" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cbData</a>;
 
            <span class="c">///</span><span class="c"> BYTE*</span>
            <b>public</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="e4d3b41fba53f488" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pbData</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="9c66db0c3cccd922" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="33ab676e14941d23">CERT_CONTEXT</span></a>
        {
            <b>public int</b> <a id="8c9c039836594430" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwCertEncodingType</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="70bdd18ccd67d5bb" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pbCertEncoded</a>;
            <b>public int</b> <a id="1665bd504dd35630" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cbCertEncoded</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="5731f044619e3c7d" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">pCertInfo</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="16f0f8f0d611bd91" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">hCertStore</a>;
        }
 
        <span class="c">// Return the OID info for a given algorithm</span>
        [<span class="i">DllImport</span>(<span class="s">&quot;crypt32.dll&quot;</span>, <span class="i">EntryPoint</span> = <span class="s">&quot;CryptFindOIDInfo&quot;</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="e01b7a5cb3222031" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptFindOIDInfo</a>(
            <b>uint</b> <span id="r84 rd" class="r84 r">dwKeyType</span>,
            <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r85 rd" class="r85 r">pvKey</span>,
            <b>uint</b> <span id="r86 rd" class="r86 r">dwGroupId</span>);
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <span class="i">DWORD</span> <a id="775419e05d4ffee7" href="../R/775419e05d4ffee7.html" target="n" data-glyph="74,1" class="i method">GetCertChoiceFromSigningOption</a>(
            <a href="Authenticode.cs.html#1cbd6367fe8ec186" class="t t">SigningOption</a> <span id="r87 rd" class="r87 r">option</span>)
        {
            <span class="i">DWORD</span> <span id="r88 rd" class="r88 r">cc</span> = 0;
 
            <b>switch</b> (<span class="r87 r">option</span>)
            {
                <b>case</b> <a href="Authenticode.cs.html#1cbd6367fe8ec186" class="t t">SigningOption</a>.<a href="Authenticode.cs.html#647fdff284626bfc" class="i field">AddOnlyCertificate</a>:
                    <span class="r88 r">cc</span> = 0;
                    <b>break</b>;
 
                <b>case</b> <a href="Authenticode.cs.html#1cbd6367fe8ec186" class="t t">SigningOption</a>.<a href="Authenticode.cs.html#63e530e43e4601d1" class="i field">AddFullCertificateChain</a>:
                    <span class="r88 r">cc</span> = (<span class="i">DWORD</span>)<a href="#b1173d1b71fe372b" class="t t">SignInfoAdditionalCertChoice</a>.<a href="#8a3bd77e550a4044" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN</a>;
                    <b>break</b>;
 
                <b>case</b> <a href="Authenticode.cs.html#1cbd6367fe8ec186" class="t t">SigningOption</a>.<a href="Authenticode.cs.html#967ad3140fea4d29" class="i field">AddFullCertificateChainExceptRoot</a>:
                    <span class="r88 r">cc</span> = (<span class="i">DWORD</span>)<a href="#b1173d1b71fe372b" class="t t">SignInfoAdditionalCertChoice</a>.<a href="#9362ca2ba8858438" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN_NO_ROOT</a>;
                    <b>break</b>;
 
                <b>default</b>:
                    <span class="r88 r">cc</span> = (<span class="i">DWORD</span>)<a href="#b1173d1b71fe372b" class="t t">SignInfoAdditionalCertChoice</a>.<a href="#9362ca2ba8858438" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_ADD_CHAIN_NO_ROOT</a>;
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r88 r">cc</span>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#df8e3ea0bc9ee165" class="t t">CRYPTUI_WIZ_DIGITAL_SIGN_INFO</a>
            <a id="c023fc9619b6d8e6" href="../R/c023fc9619b6d8e6.html" target="n" data-glyph="74,1" class="i method">InitSignInfoStruct</a>(<b>string</b> <span id="r89 rd" class="r89 r">fileName</span>,
                               <span class="i">X509Certificate2</span> <span id="r90 rd" class="r90 r">signingCert</span>,
                               <b>string</b> <span id="r91 rd" class="r91 r">timeStampServerUrl</span>,
                               <b>string</b> <span id="r92 rd" class="r92 r">hashAlgorithm</span>,
                               <a href="Authenticode.cs.html#1cbd6367fe8ec186" class="t t">SigningOption</a> <span id="r93 rd" class="r93 r">option</span>)
        {
            <a href="#df8e3ea0bc9ee165" class="t t">CRYPTUI_WIZ_DIGITAL_SIGN_INFO</a> <span id="r94 rd" class="r94 r">si</span> = <b>new</b> <span class="t">CRYPTUI_WIZ_DIGITAL_SIGN_INFO</span>();
 
            <span class="r94 r">si</span>.<a href="#9b59faedc71eea99" class="i field">dwSize</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r94 r">si</span>);
            <span class="r94 r">si</span>.<a href="#2e9a657a5cfdbe15" class="i field">dwSubjectChoice</a> = (<span class="i">DWORD</span>)<a href="#9df341838a67f723" class="t t">SignInfoSubjectChoice</a>.<a href="#6ba7abcce0da2c19" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_SUBJECT_FILE</a>;
            <span class="r94 r">si</span>.<a href="#838762608b55ccfa" class="i field">pwszFileName</a> = <span class="r89 r">fileName</span>;
            <span class="r94 r">si</span>.<a href="#9a481418e4b95b7b" class="i field">dwSigningCertChoice</a> = (<span class="i">DWORD</span>)<a href="#3874b596b552d0ee" class="t t">SignInfoCertChoice</a>.<a href="#a4d77ab26b8b648e" class="i field">CRYPTUI_WIZ_DIGITAL_SIGN_CERT</a>;
            <span class="r94 r">si</span>.<a href="#6d4e59c6d76f10bb" class="i field">pSigningCertContext</a> = <span class="r90 r">signingCert</span>.<span class="i">Handle</span>;
            <span class="r94 r">si</span>.<a href="#a17c88b7ee011d13" class="i field">pwszTimestampURL</a> = <span class="r91 r">timeStampServerUrl</span>;
            <span class="r94 r">si</span>.<a href="#d01e808a4a63d577" class="i field">dwAdditionalCertChoice</a> = <a href="#775419e05d4ffee7" class="i method">GetCertChoiceFromSigningOption</a>(<span class="r93 r">option</span>);
 
            <a href="#3f27e0ee7868180e" class="t t">CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO</a> <span id="r95 rd" class="r95 r">siex</span> =
                <span class="i">InitSignInfoExtendedStruct</span>(<b>string</b>.<span class="i">Empty</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r92 r">hashAlgorithm</span>);
            <span class="i">IntPtr</span> <span id="r96 rd" class="r96 r">pSiexBuffer</span> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r95 r">siex</span>));
            <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r95 r">siex</span>, <span class="r96 r">pSiexBuffer</span>, <b>false</b>);
            <span class="r94 r">si</span>.<a href="#518550dccb633b4d" class="i field">pSignExtInfo</a> = <span class="r96 r">pSiexBuffer</span>;
 
            <b>return</b> <span class="r94 r">si</span>;
        }
 
        <span class="c">// -----------------------------------------------------------------</span>
        <span class="c">// wintrust.dll stuff</span>
        <span class="c">//</span>
 
        <span class="c">//</span>
        <span class="c">// WinVerifyTrust() function and associated structures/enums</span>
        <span class="c">//</span>
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
        <span class="i">DWORD</span> <a id="4ea87b27cb005ae5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WinVerifyTrust</a>(
            <span class="i">IntPtr</span> <span id="r97 rd" class="r97 r">hWndNotUsed</span>, <span class="c">// HWND</span>
            <span class="i">IntPtr</span> <span id="r98 rd" class="r98 r">pgActionID</span>, <span class="c">// GUID*</span>
            <span class="i">IntPtr</span> <span id="r99 rd" class="r99 r">pWinTrustData</span> <span class="c">// WINTRUST_DATA*</span>
        );
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="1bb3b56f29e4f176" href="../R/1bb3b56f29e4f176.html" target="n" data-glyph="110,1" class="t t"><span id="9d0b3697e37fb45a">WINTRUST_FILE_INFO</span></a>
        {
            <b>internal</b> <span class="i">DWORD</span> <a id="5bd27981b8cd272b" href="../R/5bd27981b8cd272b.html" target="n" data-glyph="44,2" class="i field">cbStruct</a>;               <span class="c">// = sizeof(WINTRUST_FILE_INFO)</span>
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="063a7c0482151717" href="../R/063a7c0482151717.html" target="n" data-glyph="44,2" class="i field">pcwszFilePath</a>;         <span class="c">// LPCWSTR</span>
 
            <b>internal</b> <span class="i">IntPtr</span> <a id="10f4fdcdb83dcf49" href="../R/10f4fdcdb83dcf49.html" target="n" data-glyph="44,2" class="i field">hFileNotUsed</a>;          <span class="c">// optional, HANDLE to pcwszFilePath</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="d319f4f03d806b75" href="../R/d319f4f03d806b75.html" target="n" data-glyph="44,2" class="i field">pgKnownSubjectNotUsed</a>; <span class="c">// optional: GUID* : fill if the</span>
                                                   <span class="c">// subject type is known</span>
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="5806626ab54c4ba7" href="../R/5806626ab54c4ba7.html" target="n" data-glyph="110,1" class="t t"><span id="4bf5009f35dd3d02">WINTRUST_BLOB_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="d8c72fb86df9e780" href="../R/d8c72fb86df9e780.html" target="n" data-glyph="44,2" class="i field">cbStruct</a>;
 
            <span class="c">///</span><span class="c"> GUID-&gt;_GUID</span>
            <b>internal</b> <span class="i">Guid</span> <a id="d0983c71618f920d" href="../R/d0983c71618f920d.html" target="n" data-glyph="44,2" class="i field">gSubject</a>;
 
            <span class="c">///</span><span class="c"> LPCWSTR-&gt;WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="16ad43f8eaacf2fc" href="../R/16ad43f8eaacf2fc.html" target="n" data-glyph="44,2" class="i field">pcwszDisplayName</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="83f5390acfb60898" href="../R/83f5390acfb60898.html" target="n" data-glyph="44,2" class="i field">cbMemObject</a>;
 
            <span class="c">///</span><span class="c"> BYTE*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="e4e400ddde5b4091" href="../R/e4e400ddde5b4091.html" target="n" data-glyph="44,2" class="i field">pbMemObject</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="35379b84cb4d4186" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cbMemSignedMsg</a>;
 
            <span class="c">///</span><span class="c"> BYTE*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="cfe33a25a75f95a5" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pbMemSignedMsg</a>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#1bb3b56f29e4f176" class="t t">WINTRUST_FILE_INFO</a> <a id="00e82de9fc965d0c" href="../R/00e82de9fc965d0c.html" target="n" data-glyph="74,1" class="i method">InitWintrustFileInfoStruct</a>(<b>string</b> <span id="r100 rd" class="r100 r">fileName</span>)
        {
            <a href="#1bb3b56f29e4f176" class="t t">WINTRUST_FILE_INFO</a> <span id="r101 rd" class="r101 r">fi</span> = <b>new</b> <span class="t">WINTRUST_FILE_INFO</span>();
 
            <span class="r101 r">fi</span>.<a href="#5bd27981b8cd272b" class="i field">cbStruct</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r101 r">fi</span>);
            <span class="r101 r">fi</span>.<a href="#063a7c0482151717" class="i field">pcwszFilePath</a> = <span class="r100 r">fileName</span>;
            <span class="r101 r">fi</span>.<a href="#10f4fdcdb83dcf49" class="i field">hFileNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r101 r">fi</span>.<a href="#d319f4f03d806b75" class="i field">pgKnownSubjectNotUsed</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <b>return</b> <span class="r101 r">fi</span>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a> <a id="1ea5081fa4c12912" href="../R/1ea5081fa4c12912.html" target="n" data-glyph="74,1" class="i method">InitWintrustBlobInfoStruct</a>(<b>string</b> <span id="r102 rd" class="r102 r">fileName</span>, <b>string</b> <span id="r103 rd" class="r103 r">content</span>)
        {
            <a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a> <span id="r104 rd" class="r104 r">bi</span> = <b>new</b> <span class="t">WINTRUST_BLOB_INFO</span>();
            <b>byte</b>[] <span id="r105 rd" class="r105 r">contentBytes</span> = <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetBytes</span>(<span class="r103 r">content</span>);
 
            <span class="c">// The GUID of the PowerShell SIP</span>
            <span class="r104 r">bi</span>.<a href="#d0983c71618f920d" class="i field">gSubject</a> = <b>new</b> <span class="i">Guid</span>(0x603bcc1f, 0x4b59, 0x4e08, <b>new</b> <b>byte</b>[] { 0xb7, 0x24, 0xd2, 0xc6, 0x29, 0x7e, 0xf3, 0x51 });
            <span class="r104 r">bi</span>.<a href="#d8c72fb86df9e780" class="i field">cbStruct</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r104 r">bi</span>);
            <span class="r104 r">bi</span>.<a href="#16ad43f8eaacf2fc" class="i field">pcwszDisplayName</a> = <span class="r102 r">fileName</span>;
            <span class="r104 r">bi</span>.<a href="#83f5390acfb60898" class="i field">cbMemObject</a> = (<b>uint</b>)<span class="r105 r">contentBytes</span>.<span class="i">Length</span>;
            <span class="r104 r">bi</span>.<a href="#e4e400ddde5b4091" class="i field">pbMemObject</a> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="r105 r">contentBytes</span>.<span class="i">Length</span>);
            <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r105 r">contentBytes</span>, 0, <span class="r104 r">bi</span>.<a href="#e4e400ddde5b4091" class="i field">pbMemObject</a>, <span class="r105 r">contentBytes</span>.<span class="i">Length</span>);
 
            <b>return</b> <span class="r104 r">bi</span>;
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="b720c63e9040ead2" href="../R/b720c63e9040ead2.html" target="n" data-glyph="20,1" class="t t"><span id="e3ddf4735360f537">WintrustUIChoice</span></a>
        {
            <a id="42c2a661f671b4b6" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_UI_ALL</a> = 1,
            <a id="b0b7ddd104822d36" href="../R/b0b7ddd104822d36.html" target="n" data-glyph="24,2" class="i field">WTD_UI_NONE</a> = 2,
            <a id="f37d8367a09ed80b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_UI_NOBAD</a> = 3,
            <a id="d175629f95763c47" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_UI_NOGOOD</a> = 4
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="531b5c5289be30d9" href="../R/531b5c5289be30d9.html" target="n" data-glyph="20,1" class="t t"><span id="75ee6287dea24def">WintrustUnionChoice</span></a>
        {
            <a id="d91ee5c15d8d9f55" href="../R/d91ee5c15d8d9f55.html" target="n" data-glyph="24,2" class="i field">WTD_CHOICE_FILE</a> = 1,
            <span class="c">// WTD_CHOICE_CATALOG = 2,</span>
            <a id="86b86eece6bba22d" href="../R/86b86eece6bba22d.html" target="n" data-glyph="24,2" class="i field">WTD_CHOICE_BLOB</a> = 3,
            <span class="c">// WTD_CHOICE_SIGNER = 4,</span>
            <span class="c">// WTD_CHOICE_CERT = 5,</span>
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="e73e7ef04c9fdc99" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="bb2eb5bb09d48621">WintrustProviderFlags</span></a>
        {
            <a id="d17d64eaf4058697" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_PROV_FLAGS_MASK</a> = 0x0000FFFF,
            <a id="75104d213b35fcaa" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_USE_IE4_TRUST_FLAG</a> = 0x00000001,
            <a id="e888c2b63bea8a61" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_NO_IE4_CHAIN_FLAG</a> = 0x00000002,
            <a id="d9f4faa4d6624ee7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_NO_POLICY_USAGE_FLAG</a> = 0x00000004,
            <a id="23a060b40dd82035" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_REVOCATION_CHECK_NONE</a> = 0x00000010,
            <a id="fa465e95568f1273" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_REVOCATION_CHECK_END_CERT</a> = 0x00000020,
            <a id="a9bb4b075508e35d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_REVOCATION_CHECK_CHAIN</a> = 0x00000040,
            <a id="5e1729e89765dc46" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_REVOCATION_CHECK_CHAIN_EXCLUDE_ROOT</a> = 0x00000080,
            <a id="54c2ecad8e22f6ac" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_SAFER_FLAG</a> = 0x00000100,
            <a id="022461deb0d70224" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_HASH_ONLY_FLAG</a> = 0x00000200,
            <a id="ff7028f9cd3ef16f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_USE_DEFAULT_OSVER_CHECK</a> = 0x00000400,
            <a id="80f7b082d4789b90" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_LIFETIME_SIGNING_FLAG</a> = 0x00000800,
            <a id="c7bb3a1f2a50a30a" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_CACHE_ONLY_URL_RETRIEVAL</a> = 0x00001000
        }
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="c7d0805ab534bdb0" href="../R/c7d0805ab534bdb0.html" target="n" data-glyph="20,1" class="t t"><span id="6c06929aa6fdc82e">WintrustAction</span></a>
        {
            <a id="f388338c119ce0a5" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_STATEACTION_IGNORE</a> = 0x00000000,
            <a id="ba3c741c6853fb3c" href="../R/ba3c741c6853fb3c.html" target="n" data-glyph="24,2" class="i field">WTD_STATEACTION_VERIFY</a> = 0x00000001,
            <a id="b172bce73a27abd2" href="../R/b172bce73a27abd2.html" target="n" data-glyph="24,2" class="i field">WTD_STATEACTION_CLOSE</a> = 0x00000002,
            <a id="95133e02022ed89d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_STATEACTION_AUTO_CACHE</a> = 0x00000003,
            <a id="1f03f8f54d0d4b26" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WTD_STATEACTION_AUTO_CACHE_FLUSH</a> = 0x00000004
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Explicit</span>)]
        <b>internal struct</b> <a id="c5d1f01ed344a671" href="../R/c5d1f01ed344a671.html" target="n" data-glyph="110,1" class="t t"><span id="9b58f27625a3ce6e">WinTrust_Choice</span></a>
        {
            <span class="c">///</span><span class="c"> WINTRUST_FILE_INFO_*</span>
            [<span class="i">FieldOffsetAttribute</span>(0)]
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="f5e9e3c464b373ea" href="../R/f5e9e3c464b373ea.html" target="n" data-glyph="44,2" class="i field">pFile</a>;
 
            <span class="c">///</span><span class="c"> WINTRUST_CATALOG_INFO_*</span>
            [<span class="i">FieldOffsetAttribute</span>(0)]
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="fd62f6c41171db53" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pCatalog</a>;
 
            <span class="c">///</span><span class="c"> WINTRUST_BLOB_INFO_*</span>
            [<span class="i">FieldOffsetAttribute</span>(0)]
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="1f3939dd65fb46b1" href="../R/1f3939dd65fb46b1.html" target="n" data-glyph="44,2" class="i field">pBlob</a>;
 
            <span class="c">///</span><span class="c"> WINTRUST_SGNR_INFO_*</span>
            [<span class="i">FieldOffsetAttribute</span>(0)]
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="a3b3b811a7977b9d" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pSgnr</a>;
 
            <span class="c">///</span><span class="c"> WINTRUST_CERT_INFO_*</span>
            [<span class="i">FieldOffsetAttribute</span>(0)]
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="6ddd5793d6f3b949" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pCert</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="bd246f5cf2c315f0" href="../R/bd246f5cf2c315f0.html" target="n" data-glyph="110,1" class="t t"><span id="da8a641549a4df84">WINTRUST_DATA</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="a0fb7af6908a81c3" href="../R/a0fb7af6908a81c3.html" target="n" data-glyph="44,2" class="i field">cbStruct</a>;
 
            <span class="c">///</span><span class="c"> LPVOID-&gt;void*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="90a30c65059d35ca" href="../R/90a30c65059d35ca.html" target="n" data-glyph="44,2" class="i field">pPolicyCallbackData</a>;
 
            <span class="c">///</span><span class="c"> LPVOID-&gt;void*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="bb94daf3e856c4da" href="../R/bb94daf3e856c4da.html" target="n" data-glyph="44,2" class="i field">pSIPClientData</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="6f88fe78861de487" href="../R/6f88fe78861de487.html" target="n" data-glyph="44,2" class="i field">dwUIChoice</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="c129b770265f7543" href="../R/c129b770265f7543.html" target="n" data-glyph="44,2" class="i field">fdwRevocationChecks</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="629d47588ce555cd" href="../R/629d47588ce555cd.html" target="n" data-glyph="44,2" class="i field">dwUnionChoice</a>;
 
            <span class="c">///</span><span class="c"> WinTrust_Choice struct</span>
            <b>internal</b> <a href="#c5d1f01ed344a671" class="t t">WinTrust_Choice</a> <a id="1659fd4ba7585d47" href="../R/1659fd4ba7585d47.html" target="n" data-glyph="44,2" class="i field">Choice</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="ef4502aaee901d79" href="../R/ef4502aaee901d79.html" target="n" data-glyph="44,2" class="i field">dwStateAction</a>;
 
            <span class="c">///</span><span class="c"> HANDLE-&gt;void*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="d4c398eab97e2eb9" href="../R/d4c398eab97e2eb9.html" target="n" data-glyph="44,2" class="i field">hWVTStateData</a>;
 
            <span class="c">///</span><span class="c"> WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="29005b4bf5c637f9" href="../R/29005b4bf5c637f9.html" target="n" data-glyph="44,2" class="i field">pwszURLReference</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="4254bcf07584abe4" href="../R/4254bcf07584abe4.html" target="n" data-glyph="44,2" class="i field">dwProvFlags</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="b7e6b820308f777d" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwUIContext</a>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <a id="4998e3fd9a2fc301" href="../R/4998e3fd9a2fc301.html" target="n" data-glyph="74,1" class="i method">InitWintrustDataStructFromFile</a>(<a href="#1bb3b56f29e4f176" class="t t">WINTRUST_FILE_INFO</a> <span id="r106 rd" class="r106 r">wfi</span>)
        {
            <a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <span id="r107 rd" class="r107 r">wtd</span> = <b>new</b> <span class="t">WINTRUST_DATA</span>();
 
            <span class="r107 r">wtd</span>.<a href="#a0fb7af6908a81c3" class="i field">cbStruct</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r107 r">wtd</span>);
            <span class="r107 r">wtd</span>.<a href="#90a30c65059d35ca" class="i field">pPolicyCallbackData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r107 r">wtd</span>.<a href="#bb94daf3e856c4da" class="i field">pSIPClientData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r107 r">wtd</span>.<a href="#6f88fe78861de487" class="i field">dwUIChoice</a> = (<span class="i">DWORD</span>)<a href="#b720c63e9040ead2" class="t t">WintrustUIChoice</a>.<a href="#b0b7ddd104822d36" class="i field">WTD_UI_NONE</a>;
            <span class="r107 r">wtd</span>.<a href="#c129b770265f7543" class="i field">fdwRevocationChecks</a> = 0;
            <span class="r107 r">wtd</span>.<a href="#629d47588ce555cd" class="i field">dwUnionChoice</a> = (<span class="i">DWORD</span>)<a href="#531b5c5289be30d9" class="t t">WintrustUnionChoice</a>.<a href="#d91ee5c15d8d9f55" class="i field">WTD_CHOICE_FILE</a>;
 
            <span class="i">IntPtr</span> <span id="r108 rd" class="r108 r">pFileBuffer</span> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r106 r">wfi</span>));
            <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r106 r">wfi</span>, <span class="r108 r">pFileBuffer</span>, <b>false</b>);
            <span class="r107 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#f5e9e3c464b373ea" class="i field">pFile</a> = <span class="r108 r">pFileBuffer</span>;
 
            <span class="r107 r">wtd</span>.<a href="#ef4502aaee901d79" class="i field">dwStateAction</a> = (<span class="i">DWORD</span>)<a href="#c7d0805ab534bdb0" class="t t">WintrustAction</a>.<a href="#ba3c741c6853fb3c" class="i field">WTD_STATEACTION_VERIFY</a>;
            <span class="r107 r">wtd</span>.<a href="#d4c398eab97e2eb9" class="i field">hWVTStateData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r107 r">wtd</span>.<a href="#29005b4bf5c637f9" class="i field">pwszURLReference</a> = <b>null</b>;
            <span class="r107 r">wtd</span>.<a href="#4254bcf07584abe4" class="i field">dwProvFlags</a> = 0;
 
            <b>return</b> <span class="r107 r">wtd</span>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <a id="417c475c2f711dc7" href="../R/417c475c2f711dc7.html" target="n" data-glyph="74,1" class="i method">InitWintrustDataStructFromBlob</a>(<a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a> <span id="r109 rd" class="r109 r">wbi</span>)
        {
            <a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <span id="r110 rd" class="r110 r">wtd</span> = <b>new</b> <span class="t">WINTRUST_DATA</span>();
 
            <span class="r110 r">wtd</span>.<a href="#a0fb7af6908a81c3" class="i field">cbStruct</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r109 r">wbi</span>);
            <span class="r110 r">wtd</span>.<a href="#90a30c65059d35ca" class="i field">pPolicyCallbackData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r110 r">wtd</span>.<a href="#bb94daf3e856c4da" class="i field">pSIPClientData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r110 r">wtd</span>.<a href="#6f88fe78861de487" class="i field">dwUIChoice</a> = (<span class="i">DWORD</span>)<a href="#b720c63e9040ead2" class="t t">WintrustUIChoice</a>.<a href="#b0b7ddd104822d36" class="i field">WTD_UI_NONE</a>;
            <span class="r110 r">wtd</span>.<a href="#c129b770265f7543" class="i field">fdwRevocationChecks</a> = 0;
            <span class="r110 r">wtd</span>.<a href="#629d47588ce555cd" class="i field">dwUnionChoice</a> = (<span class="i">DWORD</span>)<a href="#531b5c5289be30d9" class="t t">WintrustUnionChoice</a>.<a href="#86b86eece6bba22d" class="i field">WTD_CHOICE_BLOB</a>;
 
            <span class="i">IntPtr</span> <span id="r111 rd" class="r111 r">pBlob</span> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r109 r">wbi</span>));
            <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r109 r">wbi</span>, <span class="r111 r">pBlob</span>, <b>false</b>);
            <span class="r110 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#1f3939dd65fb46b1" class="i field">pBlob</a> = <span class="r111 r">pBlob</span>;
 
            <span class="r110 r">wtd</span>.<a href="#ef4502aaee901d79" class="i field">dwStateAction</a> = (<span class="i">DWORD</span>)<a href="#c7d0805ab534bdb0" class="t t">WintrustAction</a>.<a href="#ba3c741c6853fb3c" class="i field">WTD_STATEACTION_VERIFY</a>;
            <span class="r110 r">wtd</span>.<a href="#d4c398eab97e2eb9" class="i field">hWVTStateData</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="r110 r">wtd</span>.<a href="#29005b4bf5c637f9" class="i field">pwszURLReference</a> = <b>null</b>;
            <span class="r110 r">wtd</span>.<a href="#4254bcf07584abe4" class="i field">dwProvFlags</a> = 0;
 
            <b>return</b> <span class="r110 r">wtd</span>;
        }
 
        [<span class="i">ArchitectureSensitive</span>]
        <b>internal static</b> <span class="i">DWORD</span> <a id="eb40a12321690001" href="../R/eb40a12321690001.html" target="n" data-glyph="74,1" class="i method">DestroyWintrustDataStruct</a>(<a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <span id="r112 rd" class="r112 r">wtd</span>)
        {
            <span class="i">DWORD</span> <span id="r113 rd" class="r113 r">dwResult</span> = <a href="MshSignature.cs.html#6481827cdaae5dde" class="t t">Win32Errors</a>.<a href="MshSignature.cs.html#7762bd4daf328a09" class="i field">E_FAIL</a>;
            <span class="i">IntPtr</span> <span id="r114 rd" class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="i">IntPtr</span> <span id="r115 rd" class="r115 r">wtdBuffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <span class="i">Guid</span> <span id="r116 rd" class="r116 r">actionVerify</span> =
                <b>new</b> <span class="i">Guid</span>(<a href="../../GuidAssembly/R/00aac56b-cd44-11d0-8cc2-00c04fc295ee.html" target="n" class="s">&quot;00AAC56B-CD44-11d0-8CC2-00C04FC295EE&quot;</a>);
 
            <b>try</b>
            {
                <span class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span> =
                    <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r116 r">actionVerify</span>));
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r116 r">actionVerify</span>,
                                       <span class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>,
                                       <b>false</b>);
 
                <span class="r112 r">wtd</span>.<a href="#ef4502aaee901d79" class="i field">dwStateAction</a> = (<span class="i">DWORD</span>)<a href="#c7d0805ab534bdb0" class="t t">WintrustAction</a>.<a href="#b172bce73a27abd2" class="i field">WTD_STATEACTION_CLOSE</a>;
                <span class="r115 r">wtdBuffer</span> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r112 r">wtd</span>));
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r112 r">wtd</span>, <span class="r115 r">wtdBuffer</span>, <b>false</b>);
 
                <span class="c">// The GetLastWin32Error of this is checked, but PreSharp doesn&#39;t seem to be</span>
                <span class="c">// able to see that.</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56523
                <span class="r113 r">dwResult</span> = <span class="i">WinVerifyTrust</span>(
                    <span class="i">IntPtr</span>.<span class="i">Zero</span>,
                    <span class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>,
                    <span class="r115 r">wtdBuffer</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56523
 
                <span class="r112 r">wtd</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a>&gt;(<span class="r115 r">wtdBuffer</span>);
            }
            <b>finally</b>
            {
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a>&gt;(<span class="r115 r">wtdBuffer</span>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r115 r">wtdBuffer</span>);
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<span class="i">Guid</span>&gt;(<span class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r114 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>);
            }
 
            <span class="c">// Clear the blob or file info, depending on the type of</span>
            <span class="c">// verification that was done.</span>
            <b>if</b> (<span class="r112 r">wtd</span>.<a href="#629d47588ce555cd" class="i field">dwUnionChoice</a> == (<span class="i">DWORD</span>)<a href="#531b5c5289be30d9" class="t t">WintrustUnionChoice</a>.<a href="#86b86eece6bba22d" class="i field">WTD_CHOICE_BLOB</a>)
            {
                <a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a> <span id="r117 rd" class="r117 r">originalBlob</span> =
                    (<a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a>)<span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a>&gt;(<span class="r112 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#1f3939dd65fb46b1" class="i field">pBlob</a>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r117 r">originalBlob</span>.<a href="#e4e400ddde5b4091" class="i field">pbMemObject</a>);
 
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<a href="#5806626ab54c4ba7" class="t t">WINTRUST_BLOB_INFO</a>&gt;(<span class="r112 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#1f3939dd65fb46b1" class="i field">pBlob</a>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r112 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#1f3939dd65fb46b1" class="i field">pBlob</a>);
            }
            <b>else</b>
            {
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<a href="#1bb3b56f29e4f176" class="t t">WINTRUST_FILE_INFO</a>&gt;(<span class="r112 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#f5e9e3c464b373ea" class="i field">pFile</a>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r112 r">wtd</span>.<a href="#1659fd4ba7585d47" class="i field">Choice</a>.<a href="#f5e9e3c464b373ea" class="i field">pFile</a>);
            }
 
            <b>return</b> <span class="r113 r">dwResult</span>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="73a0318550bc8918" href="../R/73a0318550bc8918.html" target="n" data-glyph="110,1" class="t t"><span id="5d351700b12552d7">CRYPT_PROVIDER_CERT</span></a>
        {
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> <span class="i">IDE0044</span>
            <b>private</b> <span class="i">DWORD</span> <a id="8f46bc540e2adfb0" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_cbStruct</a>;
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> <span class="i">IDE0044</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="6eb4ed8ede6c44fd" href="../R/6eb4ed8ede6c44fd.html" target="n" data-glyph="44,2" class="i field">pCert</a>; <span class="c">// PCCERT_CONTEXT</span>
            <b>private readonly</b> <span class="i">BOOL</span> <a id="b5143ee538a44779" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fCommercial</a>;
            <b>private readonly</b> <span class="i">BOOL</span> <a id="040a82e93b9380b1" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fTrustedRoot</a>;
            <b>private readonly</b> <span class="i">BOOL</span> <a id="06039a02ea8a5cb9" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fSelfSigned</a>;
            <b>private readonly</b> <span class="i">BOOL</span> <a id="9d36e6d582d67a0f" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fTestCert</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="84f02bb858978740" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwRevokedReason</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="e138b486b68d2084" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwConfidence</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="a1692ed39c96a0c3" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwError</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="6f7d4a7bc1548f08" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pTrustListContext</a>; <span class="c">// CTL_CONTEXT*</span>
            <b>private readonly</b> <span class="i">BOOL</span> <a id="c55d92c0ad895b7e" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fTrustListSignerCert</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="94104463241a3c5e" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pCtlContext</a>; <span class="c">// PCCTL_CONTEXT</span>
            <b>private readonly</b> <span class="i">DWORD</span> <a id="f9eaa2711879e490" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwCtlError</a>;
            <b>private readonly</b> <span class="i">BOOL</span> <a id="92bea50443f98324" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fIsCyclic</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="e356c9a5eaca103c" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pChainElement</a>; <span class="c">// PCERT_CHAIN_ELEMENT</span>
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="4cd87de1651d2327" href="../R/4cd87de1651d2327.html" target="n" data-glyph="110,1" class="t t"><span id="5c5d381549da9a7e">CRYPT_PROVIDER_SGNR</span></a>
        {
            <b>private readonly</b> <span class="i">DWORD</span> <a id="981dc7655aea8315" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_cbStruct</a>;
            <b>private</b> <a href="#254b4fefaf6fd177" class="t t">FILETIME</a> <a id="9fa21ed5e0a9dfb9" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_sftVerifyAsOf</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="015c2502404dcf7e" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_csCertChain</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="e3d3272a2e1144a5" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pasCertChain</a>; <span class="c">// CRYPT_PROVIDER_CERT*</span>
            <b>private readonly</b> <span class="i">DWORD</span> <a id="4fbd46f24c52bccb" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwSignerType</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="75fdc7c208f0b8d2" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_psSigner</a>; <span class="c">// CMSG_SIGNER_INFO*</span>
            <b>private readonly</b> <span class="i">DWORD</span> <a id="5dc9a601bba7caa1" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwError</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="88c18970ad6884a0" href="../R/88c18970ad6884a0.html" target="n" data-glyph="44,2" class="i field">csCounterSigners</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="4b8af73933734d41" href="../R/4b8af73933734d41.html" target="n" data-glyph="44,2" class="i field">pasCounterSigners</a>; <span class="c">// CRYPT_PROVIDER_SGNR*</span>
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="2e8f38ee4a3029ce" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pChainContext</a>; <span class="c">// PCCERT_CHAIN_CONTEXT</span>
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
            <span class="i">IntPtr</span> <span class="c">// CRYPT_PROVIDER_DATA*</span>
            <a id="1ef2b9d01762c439" href="../R/1ef2b9d01762c439.html" target="n" data-glyph="74,1" class="i method">WTHelperProvDataFromStateData</a>(<span class="i">IntPtr</span> <span id="r118 rd" class="r118 r">hStateData</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
            <span class="i">IntPtr</span> <span class="c">// CRYPT_PROVIDER_SGNR*</span>
            <a id="ca26533a539ea03b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WTHelperGetProvSignerFromChain</a>(
                <span class="i">IntPtr</span> <span id="r119 rd" class="r119 r">pProvData</span>, <span class="c">// CRYPT_PROVIDER_DATA*</span>
                <span class="i">DWORD</span> <span id="r120 rd" class="r120 r">idxSigner</span>,
                <span class="i">BOOL</span> <span id="r121 rd" class="r121 r">fCounterSigner</span>,
                <span class="i">DWORD</span> <span id="r122 rd" class="r122 r">idxCounterSigner</span>
            );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b>
            <span class="i">IntPtr</span> <span class="c">// CRYPT_PROVIDER_CERT*</span>
            <a id="0e0e96f4dcbea2c4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WTHelperGetProvCertFromChain</a>(
                <span class="i">IntPtr</span> <span id="r123 rd" class="r123 r">pSgnr</span>, <span class="c">// CRYPT_PROVIDER_SGNR*</span>
                <span class="i">DWORD</span> <span id="r124 rd" class="r124 r">idxCert</span>
            );
 
        <span class="c">///</span><span class="c"> Return Type: HRESULT-&gt;LONG-&gt;int</span>
        <span class="c">///</span><span class="c">pszFile: PCWSTR-&gt;WCHAR*</span>
        <span class="c">///</span><span class="c">hFile: HANDLE-&gt;void*</span>
        <span class="c">///</span><span class="c">sigInfoFlags: SIGNATURE_INFO_FLAGS-&gt;Anonymous_5157c654_2076_48e7_9241_84ac648615e9</span>
        <span class="c">///</span><span class="c">psiginfo: SIGNATURE_INFO*</span>
        <span class="c">///</span><span class="c">ppCertContext: void**</span>
        <span class="c">///</span><span class="c">phWVTStateData: HANDLE*</span>
        [<span class="i">DllImportAttribute</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">EntryPoint</span> = <span class="s">&quot;WTGetSignatureInfo&quot;</span>, <span class="i">CallingConvention</span> = <span class="i">CallingConvention</span>.<span class="i">StdCall</span>)]
        <b>internal static extern int</b> <a id="a325ea3431700651" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WTGetSignatureInfo</a>([<span class="i">InAttribute</span>()][<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r125 rd" class="r125 r">pszFile</span>, [<span class="i">InAttribute</span>()] <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r126 rd" class="r126 r">hFile</span>, <a href="#4edef05b7e93ff0c" class="t t">SIGNATURE_INFO_FLAGS</a> <span id="r127 rd" class="r127 r">sigInfoFlags</span>, <b>ref</b> <a href="#5e16ae48f8d33815" class="t t">SIGNATURE_INFO</a> <span id="r128 rd" class="r128 r">psiginfo</span>, <b>ref</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r129 rd" class="r129 r">ppCertContext</span>, <b>ref</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r130 rd" class="r130 r">phWVTStateData</span>);
 
        <b>internal static void</b> <a id="a926a12c36339476" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">FreeWVTStateData</a>(<span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r131 rd" class="r131 r">phWVTStateData</span>)
        {
            <a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a> <span id="r132 rd" class="r132 r">wtd</span> = <b>new</b> <span class="t">WINTRUST_DATA</span>();
            <span class="i">DWORD</span> <span id="r133 rd" class="r133 r">dwResult</span> = <a href="MshSignature.cs.html#6481827cdaae5dde" class="t t">Win32Errors</a>.<a href="MshSignature.cs.html#7762bd4daf328a09" class="i field">E_FAIL</a>;
            <span class="i">IntPtr</span> <span id="r134 rd" class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="i">IntPtr</span> <span id="r135 rd" class="r135 r">wtdBuffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <span class="i">Guid</span> <span id="r136 rd" class="r136 r">actionVerify</span> =
                <b>new</b> <span class="i">Guid</span>(<a href="../../GuidAssembly/R/00aac56b-cd44-11d0-8cc2-00c04fc295ee.html" target="n" class="s">&quot;00AAC56B-CD44-11d0-8CC2-00C04FC295EE&quot;</a>);
 
            <b>try</b>
            {
                <span class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span> =
                    <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r136 r">actionVerify</span>));
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r136 r">actionVerify</span>,
                                       <span class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>,
                                       <b>false</b>);
 
                <span class="r132 r">wtd</span>.<a href="#a0fb7af6908a81c3" class="i field">cbStruct</a> = (<span class="i">DWORD</span>)<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r132 r">wtd</span>);
                <span class="r132 r">wtd</span>.<a href="#6f88fe78861de487" class="i field">dwUIChoice</a> = (<span class="i">DWORD</span>)<a href="#b720c63e9040ead2" class="t t">WintrustUIChoice</a>.<a href="#b0b7ddd104822d36" class="i field">WTD_UI_NONE</a>;
                <span class="r132 r">wtd</span>.<a href="#c129b770265f7543" class="i field">fdwRevocationChecks</a> = 0;
                <span class="r132 r">wtd</span>.<a href="#629d47588ce555cd" class="i field">dwUnionChoice</a> = (<span class="i">DWORD</span>)<a href="#531b5c5289be30d9" class="t t">WintrustUnionChoice</a>.<a href="#86b86eece6bba22d" class="i field">WTD_CHOICE_BLOB</a>;
                <span class="r132 r">wtd</span>.<a href="#ef4502aaee901d79" class="i field">dwStateAction</a> = (<span class="i">DWORD</span>)<a href="#c7d0805ab534bdb0" class="t t">WintrustAction</a>.<a href="#b172bce73a27abd2" class="i field">WTD_STATEACTION_CLOSE</a>;
                <span class="r132 r">wtd</span>.<a href="#d4c398eab97e2eb9" class="i field">hWVTStateData</a> = <span class="r131 r">phWVTStateData</span>;
 
                <span class="r135 r">wtdBuffer</span> = <span class="i">Marshal</span>.<span class="i">AllocCoTaskMem</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r132 r">wtd</span>));
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r132 r">wtd</span>, <span class="r135 r">wtdBuffer</span>, <b>false</b>);
 
                <span class="c">// The GetLastWin32Error of this is checked, but PreSharp doesn&#39;t seem to be</span>
                <span class="c">// able to see that.</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56523
                <span class="r133 r">dwResult</span> = <span class="i">WinVerifyTrust</span>(
                    <span class="i">IntPtr</span>.<span class="i">Zero</span>,
                    <span class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>,
                    <span class="r135 r">wtdBuffer</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56523
            }
            <b>finally</b>
            {
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<a href="#bd246f5cf2c315f0" class="t t">WINTRUST_DATA</a>&gt;(<span class="r135 r">wtdBuffer</span>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r135 r">wtdBuffer</span>);
                <span class="i">Marshal</span>.<span class="i">DestroyStructure</span>&lt;<span class="i">Guid</span>&gt;(<span class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>);
                <span class="i">Marshal</span>.<span class="i">FreeCoTaskMem</span>(<span class="r134 r">WINTRUST_ACTION_GENERIC_VERIFY_V2</span>);
            }
        }
 
        <span class="c">//</span>
        <span class="c">// stuff required for getting cert extensions</span>
        <span class="c">//</span>
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="441de241f970b427" href="../R/441de241f970b427.html" target="n" data-glyph="110,1" class="t t"><span id="0703cd07b49a3ca0">CERT_ENHKEY_USAGE</span></a>
        {
            <b>internal</b> <span class="i">DWORD</span> <a id="9e9f33b48953b15f" href="../R/9e9f33b48953b15f.html" target="n" data-glyph="44,2" class="i field">cUsageIdentifier</a>;
            <span class="c">// [MarshalAs(UnmanagedType.LPArray, ArraySubType=UnmanagedType.LPStr, SizeParamIndex=0)]</span>
            <span class="c">// internal string[] rgpszUsageIdentifier; // LPSTR*</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="a6569772e5dbc9db" href="../R/a6569772e5dbc9db.html" target="n" data-glyph="44,2" class="i field">rgpszUsageIdentifier</a>;
        }
 
        <b>internal enum</b> <a id="572fb43ac8539387" href="../R/572fb43ac8539387.html" target="n" data-glyph="20,1" class="t t"><span id="5dab760ca40dbc25">SIGNATURE_STATE</span></a>
        {
            <span class="c">///</span><span class="c"> SIGNATURE_STATE_UNSIGNED_MISSING -&gt; 0</span>
            <a id="98208ffb0a1d241b" href="../R/98208ffb0a1d241b.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_UNSIGNED_MISSING</a> = 0,
 
            <a id="f93a6877245718f7" href="../R/f93a6877245718f7.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_UNSIGNED_UNSUPPORTED</a>,
 
            <a id="1ac970798ef0ee7e" href="../R/1ac970798ef0ee7e.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_UNSIGNED_POLICY</a>,
 
            <a id="abf3ab431500086e" href="../R/abf3ab431500086e.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_INVALID_CORRUPT</a>,
 
            <a id="a6f1d809a32135c6" href="../R/a6f1d809a32135c6.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_INVALID_POLICY</a>,
 
            <a id="e35797f27b4a0cbb" href="../R/e35797f27b4a0cbb.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_VALID</a>,
 
            <a id="69175753973c4996" href="../R/69175753973c4996.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_TRUSTED</a>,
 
            <a id="cf8cd455571f8f84" href="../R/cf8cd455571f8f84.html" target="n" data-glyph="24,2" class="i field">SIGNATURE_STATE_UNTRUSTED</a>,
        }
 
        <b>internal enum</b> <a id="4edef05b7e93ff0c" href="../R/4edef05b7e93ff0c.html" target="n" data-glyph="20,1" class="t t"><span id="8cc399165e983234">SIGNATURE_INFO_FLAGS</span></a>
        {
            <span class="c">///</span><span class="c"> SIF_NONE -&gt; 0x0000</span>
            <a id="b3079fbc9e131d61" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIF_NONE</a> = 0,
 
            <span class="c">///</span><span class="c"> SIF_AUTHENTICODE_SIGNED -&gt; 0x0001</span>
            <a id="1b4a7a33e019d430" href="../R/1b4a7a33e019d430.html" target="n" data-glyph="24,2" class="i field">SIF_AUTHENTICODE_SIGNED</a> = 1,
 
            <span class="c">///</span><span class="c"> SIF_CATALOG_SIGNED -&gt; 0x0002</span>
            <a id="151b0a8e6a448cfc" href="../R/151b0a8e6a448cfc.html" target="n" data-glyph="24,2" class="i field">SIF_CATALOG_SIGNED</a> = 2,
 
            <span class="c">///</span><span class="c"> SIF_VERSION_INFO -&gt; 0x0004</span>
            <a id="b3cc42466d11f8c3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIF_VERSION_INFO</a> = 4,
 
            <span class="c">///</span><span class="c"> SIF_CHECK_OS_BINARY -&gt; 0x0800</span>
            <a id="7fc26f6a54e658d3" href="../R/7fc26f6a54e658d3.html" target="n" data-glyph="24,2" class="i field">SIF_CHECK_OS_BINARY</a> = 2048,
 
            <span class="c">///</span><span class="c"> SIF_BASE_VERIFICATION -&gt; 0x1000</span>
            <a id="fa084371aa37cf06" href="../R/fa084371aa37cf06.html" target="n" data-glyph="24,2" class="i field">SIF_BASE_VERIFICATION</a> = 4096,
 
            <span class="c">///</span><span class="c"> SIF_CATALOG_FIRST -&gt; 0x2000</span>
            <a id="98a81ffd5da78208" href="../R/98a81ffd5da78208.html" target="n" data-glyph="24,2" class="i field">SIF_CATALOG_FIRST</a> = 8192,
 
            <span class="c">///</span><span class="c"> SIF_MOTW -&gt; 0x4000</span>
            <a id="0f31737ddec056e2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIF_MOTW</a> = 16384,
        }
 
        <b>internal enum</b> <a id="661e9506792daec9" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="3865716b338acdec">SIGNATURE_INFO_AVAILABILITY</span></a>
        {
            <span class="c">///</span><span class="c"> SIA_DISPLAYNAME -&gt; 0x0001</span>
            <a id="94a5c2a7aa2a4b5c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIA_DISPLAYNAME</a> = 1,
 
            <span class="c">///</span><span class="c"> SIA_PUBLISHERNAME -&gt; 0x0002</span>
            <a id="dc22115397324c1d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIA_PUBLISHERNAME</a> = 2,
 
            <span class="c">///</span><span class="c"> SIA_MOREINFOURL -&gt; 0x0004</span>
            <a id="bd78f580af466d6f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIA_MOREINFOURL</a> = 4,
 
            <span class="c">///</span><span class="c"> SIA_HASH -&gt; 0x0008</span>
            <a id="5f53ad3762bc5547" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIA_HASH</a> = 8,
        }
 
        <b>internal enum</b> <a id="4e25a6f20b472588" href="../R/4e25a6f20b472588.html" target="n" data-glyph="20,1" class="t t"><span id="da91e3b0ce1c84cd">SIGNATURE_INFO_TYPE</span></a>
        {
            <span class="c">///</span><span class="c"> SIT_UNKNOWN -&gt; 0</span>
            <a id="838dba7523f2d962" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SIT_UNKNOWN</a> = 0,
 
            <a id="172d7d70d3baad84" href="../R/172d7d70d3baad84.html" target="n" data-glyph="24,2" class="i field">SIT_AUTHENTICODE</a>,
 
            <a id="6e3314140b87c19d" href="../R/6e3314140b87c19d.html" target="n" data-glyph="24,2" class="i field">SIT_CATALOG</a>,
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="5e16ae48f8d33815" href="../R/5e16ae48f8d33815.html" target="n" data-glyph="110,1" class="t t"><span id="d8ec95a297aaf20c">SIGNATURE_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="aca02399f8bc4b00" href="../R/aca02399f8bc4b00.html" target="n" data-glyph="44,2" class="i field">cbSize</a>;
 
            <span class="c">///</span><span class="c"> SIGNATURE_STATE-&gt;Anonymous_7e0526d8_af30_47f9_9233_a77658d0f1e5</span>
            <b>internal</b> <a href="#572fb43ac8539387" class="t t">SIGNATURE_STATE</a> <a id="b27f49d005fa038a" href="../R/b27f49d005fa038a.html" target="n" data-glyph="44,2" class="i field">nSignatureState</a>;
 
            <span class="c">///</span><span class="c"> SIGNATURE_INFO_TYPE-&gt;Anonymous_27075e4b_faa5_4e57_ada0_6d49fae74187</span>
            <b>internal</b> <a href="#4e25a6f20b472588" class="t t">SIGNATURE_INFO_TYPE</a> <a id="4435c2c3e325a8cb" href="../R/4435c2c3e325a8cb.html" target="n" data-glyph="44,2" class="i field">nSignatureType</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="656f58ed6b85ac3a" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwSignatureInfoAvailability</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="d737d1ef54a867ad" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwInfoAvailability</a>;
 
            <span class="c">///</span><span class="c"> PWSTR-&gt;WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="f58e37b7c838c412" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pszDisplayName</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="13451dee1999e7e8" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cchDisplayName</a>;
 
            <span class="c">///</span><span class="c"> PWSTR-&gt;WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="212622e5d81ba07f" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pszPublisherName</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="fabcb1b9856994f5" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cchPublisherName</a>;
 
            <span class="c">///</span><span class="c"> PWSTR-&gt;WCHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="2fb2e0f7c8b40412" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pszMoreInfoURL</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="f28cd5b99369a528" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cchMoreInfoURL</a>;
 
            <span class="c">///</span><span class="c"> LPBYTE-&gt;BYTE*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="b2c75ed9df8ca846" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">prgbHash</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="3add0df6985b8a93" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cbHash</a>;
 
            <span class="c">///</span><span class="c"> BOOL-&gt;int</span>
            <b>internal int</b> <a id="6817210ef5be177b" href="../R/6817210ef5be177b.html" target="n" data-glyph="44,2" class="i field">fOSBinary</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="41c6bc63b762ac02" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="b1d90a047d3c40b8">CERT_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="d9cb836b23e540f1" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwVersion</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_INTEGER_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="39d47ba1434e5058" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">SerialNumber</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_ALGORITHM_IDENTIFIER-&gt;_CRYPT_ALGORITHM_IDENTIFIER</span>
            <b>internal</b> <a href="#fd0cea3a7e7875a3" class="t t">CRYPT_ALGORITHM_IDENTIFIER</a> <a id="5af4beb858ebc5cf" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">SignatureAlgorithm</a>;
 
            <span class="c">///</span><span class="c"> CERT_NAME_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="6326f0cc82cef953" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Issuer</a>;
 
            <span class="c">///</span><span class="c"> FILETIME-&gt;_FILETIME</span>
            <b>internal</b> <a href="#254b4fefaf6fd177" class="t t">FILETIME</a> <a id="57a8fcc7fb6692e6" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">NotBefore</a>;
 
            <span class="c">///</span><span class="c"> FILETIME-&gt;_FILETIME</span>
            <b>internal</b> <a href="#254b4fefaf6fd177" class="t t">FILETIME</a> <a id="d481361ea91bcf44" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">NotAfter</a>;
 
            <span class="c">///</span><span class="c"> CERT_NAME_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="02800f3911289196" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Subject</a>;
 
            <span class="c">///</span><span class="c"> CERT_PUBLIC_KEY_INFO-&gt;_CERT_PUBLIC_KEY_INFO</span>
            <b>internal</b> <a href="#be70ba01728f1c4c" class="t t">CERT_PUBLIC_KEY_INFO</a> <a id="9c2f909dfde83aef" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">SubjectPublicKeyInfo</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_BIT_BLOB-&gt;_CRYPT_BIT_BLOB</span>
            <b>internal</b> <a href="#ad4576e041fb2a60" class="t t">CRYPT_BIT_BLOB</a> <a id="b1cc3b94959f6335" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">IssuerUniqueId</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_BIT_BLOB-&gt;_CRYPT_BIT_BLOB</span>
            <b>internal</b> <a href="#ad4576e041fb2a60" class="t t">CRYPT_BIT_BLOB</a> <a id="ff7be4758acfb0a8" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">SubjectUniqueId</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="2093059bfa88221c" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cExtension</a>;
 
            <span class="c">///</span><span class="c"> PCERT_EXTENSION-&gt;_CERT_EXTENSION*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="14fd831936f086a6" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">rgExtension</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="fd0cea3a7e7875a3" href="../R/fd0cea3a7e7875a3.html" target="n" data-glyph="110,1" class="t t"><span id="f244866d59516e5e">CRYPT_ALGORITHM_IDENTIFIER</span></a>
        {
            <span class="c">///</span><span class="c"> LPSTR-&gt;CHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
            <b>internal string</b> <a id="993d971cd8ec7299" href="../R/993d971cd8ec7299.html" target="n" data-glyph="44,2" class="i field">pszObjId</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_OBJID_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="dd7d264a0eff4a46" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Parameters</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="254b4fefaf6fd177" href="../R/254b4fefaf6fd177.html" target="n" data-glyph="110,1" class="t t"><span id="ec06d680d673c97f">FILETIME</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="c043e5734f8e50e6" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwLowDateTime</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="e05ea34e5fcdebbf" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwHighDateTime</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="be70ba01728f1c4c" href="../R/be70ba01728f1c4c.html" target="n" data-glyph="110,1" class="t t"><span id="ac132ba874506503">CERT_PUBLIC_KEY_INFO</span></a>
        {
            <span class="c">///</span><span class="c"> CRYPT_ALGORITHM_IDENTIFIER-&gt;_CRYPT_ALGORITHM_IDENTIFIER</span>
            <b>internal</b> <a href="#fd0cea3a7e7875a3" class="t t">CRYPT_ALGORITHM_IDENTIFIER</a> <a id="510d3664b0baa0a4" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Algorithm</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_BIT_BLOB-&gt;_CRYPT_BIT_BLOB</span>
            <b>internal</b> <a href="#ad4576e041fb2a60" class="t t">CRYPT_BIT_BLOB</a> <a id="3872ab10a646f061" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">PublicKey</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="ad4576e041fb2a60" href="../R/ad4576e041fb2a60.html" target="n" data-glyph="110,1" class="t t"><span id="fd66b75180536b5d">CRYPT_BIT_BLOB</span></a>
        {
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="236bad4291a89218" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cbData</a>;
 
            <span class="c">///</span><span class="c"> BYTE*</span>
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="ab03db2507613494" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pbData</a>;
 
            <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
            <b>internal uint</b> <a id="794a272c38d6c1a5" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cUnusedBits</a>;
        }
 
        [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="a82b891a501a0b5c" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="eaa532f7206c70f8">CERT_EXTENSION</span></a>
        {
            <span class="c">///</span><span class="c"> LPSTR-&gt;CHAR*</span>
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
            <b>internal string</b> <a id="3e8adb914e0b065e" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pszObjId</a>;
 
            <span class="c">///</span><span class="c"> BOOL-&gt;int</span>
            <b>internal int</b> <a id="8485a4d9b305ae11" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">fCritical</a>;
 
            <span class="c">///</span><span class="c"> CRYPT_OBJID_BLOB-&gt;_CRYPTOAPI_BLOB</span>
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="a2aa5586faf09156" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Value</a>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Pinvoke methods from certca.dll.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static</b> <a href="../P/8e47b880ffb978dc.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeMethods</span>
    {
        <b>internal const int</b> <a id="21e5927b3c6cdb4f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">CRYPT_E_NOT_FOUND</a> = <b>unchecked</b>((<b>int</b>)0x80092004);
        <b>internal const int</b> <a id="6b4ff3e0e4e74816" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">E_INVALID_DATA</a> = <b>unchecked</b>((<b>int</b>)0x8007000d);
        <b>internal const int</b> <a id="06497d7d38dcd735" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">NTE_NOT_SUPPORTED</a> = <b>unchecked</b>((<b>int</b>)0x80090029);
 
        <b>internal enum</b> <a id="f7c01b47e01ec3e3" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="ce9eb479f6a245ac">AltNameType</span></a> : <b>uint</b>
        {
            <a id="a3d3e7a95161f544" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_OTHER_NAME</a> = 1,
            <a id="15c34514a6c3c8ab" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_RFC822_NAME</a> = 2,
            <a id="eb8389c98ede7fb2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_DNS_NAME</a> = 3,
            <a id="9e1e1262ac9056b7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_X400_ADDRESS</a> = 4,
            <a id="2c09b1636682f979" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_DIRECTORY_NAME</a> = 5,
            <a id="57f5064facb4a453" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_EDI_PARTY_NAME</a> = 6,
            <a id="46ca664ee027ab6c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_URL</a> = 7,
            <a id="019a19fb8d144e76" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_IP_ADDRESS</a> = 8,
            <a id="dbc1694c9604dc58" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CERT_ALT_NAME_REGISTERED_ID</a> = 9,
        }
 
        <b>internal enum</b> <a id="8e794ca71865f39f" href="../R/../../0000000000.html" target="n" data-glyph="20,1" class="t t"><span id="6412b83cae39ae2b">CryptDecodeFlags</span></a> : <b>uint</b>
        {
            <a id="0254ae981154816b" href="../R/0254ae981154816b.html" target="n" data-glyph="24,2" class="i field">CRYPT_DECODE_ENABLE_PUNYCODE_FLAG</a> = 0x02000000,
            <a id="dc44897789bf307c" href="../R/dc44897789bf307c.html" target="n" data-glyph="24,2" class="i field">CRYPT_DECODE_ENABLE_UTF8PERCENT_FLAG</a> = 0x04000000,
            <a id="a9de36cd5b3c6f34" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CRYPT_DECODE_ENABLE_IA5CONVERSION_FLAG</a> = (<a href="#0254ae981154816b" class="i field">CRYPT_DECODE_ENABLE_PUNYCODE_FLAG</a> | <a href="#dc44897789bf307c" class="i field">CRYPT_DECODE_ENABLE_UTF8PERCENT_FLAG</a>),
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SAFER_APIs
 
    <span class="c">// SAFER native methods</span>
    <b>internal static</b> <a href="../P/8e47b880ffb978dc.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeMethods</span>
    {
        <span class="c">///</span><span class="c"> Return Type: BOOL-&gt;int</span>
        <span class="c">///</span><span class="c">dwNumProperties: DWORD-&gt;unsigned int</span>
        <span class="c">///</span><span class="c">pCodeProperties: PSAFER_CODE_PROPERTIES-&gt;_SAFER_CODE_PROPERTIES*</span>
        <span class="c">///</span><span class="c">pLevelHandle: SAFER_LEVEL_HANDLE*</span>
        <span class="c">///</span><span class="c">lpReserved: LPVOID-&gt;void*</span>
        [<span class="i">DllImportAttribute</span>(<span class="s">&quot;advapi32.dll&quot;</span>, <span class="i">EntryPoint</span> = <span class="s">&quot;SaferIdentifyLevel&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="8bbce7a869205ec6" href="../R/8bbce7a869205ec6.html" target="n" data-glyph="74,1" class="i method">SaferIdentifyLevel</a>(
            <b>uint</b> <span id="r137 rd" class="r137 r">dwNumProperties</span>,
            [<span class="i">InAttribute</span>()]
            <b>ref</b> <a href="#049e6b87ba615ace" class="t t">SAFER_CODE_PROPERTIES</a> <span id="r138 rd" class="r138 r">pCodeProperties</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r139 rd" class="r139 r">pLevelHandle</span>,
            [<span class="i">InAttribute</span>()]
            [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r140 rd" class="r140 r">bucket</span>);
 
        <span class="c">///</span><span class="c"> Return Type: BOOL-&gt;int</span>
        <span class="c">///</span><span class="c">LevelHandle: SAFER_LEVEL_HANDLE-&gt;SAFER_LEVEL_HANDLE__*</span>
        <span class="c">///</span><span class="c">InAccessToken: HANDLE-&gt;void*</span>
        <span class="c">///</span><span class="c">OutAccessToken: PHANDLE-&gt;HANDLE*</span>
        <span class="c">///</span><span class="c">dwFlags: DWORD-&gt;unsigned int</span>
        <span class="c">///</span><span class="c">lpReserved: LPVOID-&gt;void*</span>
        [<span class="i">DllImportAttribute</span>(<span class="s">&quot;advapi32.dll&quot;</span>, <span class="i">EntryPoint</span> = <span class="s">&quot;SaferComputeTokenFromLevel&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="9a84a9f719768991" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SaferComputeTokenFromLevel</a>(
            [<span class="i">InAttribute</span>()]
            <span class="i">IntPtr</span> <span id="r141 rd" class="r141 r">LevelHandle</span>,
            [<span class="i">InAttribute</span>()]
            <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r142 rd" class="r142 r">InAccessToken</span>,
            <b>ref</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r143 rd" class="r143 r">OutAccessToken</span>,
            <b>uint</b> <span id="r144 rd" class="r144 r">dwFlags</span>,
            <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r145 rd" class="r145 r">lpReserved</span>);
 
        <span class="c">///</span><span class="c"> Return Type: BOOL-&gt;int</span>
        <span class="c">///</span><span class="c">hLevelHandle: SAFER_LEVEL_HANDLE-&gt;SAFER_LEVEL_HANDLE__*</span>
        [<span class="i">DllImportAttribute</span>(<span class="s">&quot;advapi32.dll&quot;</span>, <span class="i">EntryPoint</span> = <span class="s">&quot;SaferCloseLevel&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="884b948b0387d2b8" href="../R/884b948b0387d2b8.html" target="n" data-glyph="74,1" class="i method">SaferCloseLevel</a>([<span class="i">InAttribute</span>()] <span class="i">IntPtr</span> <span id="r146 rd" class="r146 r">hLevelHandle</span>);
 
        <span class="c">///</span><span class="c"> Return Type: BOOL-&gt;int</span>
        <span class="c">///</span><span class="c">hObject: HANDLE-&gt;void*</span>
        [<span class="i">DllImportAttribute</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#344fbd4b4ca02933" class="i field">CloseHandleDllName</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;CloseHandle&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="19c17d803127ede3" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CloseHandle</a>([<span class="i">InAttribute</span>()] <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r147 rd" class="r147 r">hObject</span>);
    }
 
    [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
    <b>internal struct</b> <a id="049e6b87ba615ace" href="../R/049e6b87ba615ace.html" target="n" data-glyph="110,0" class="t t"><span id="40a0b7d800d10532">SAFER_CODE_PROPERTIES</span></a>
    {
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="3be490791f8c6f3d" href="../R/3be490791f8c6f3d.html" target="n" data-glyph="42,1" class="i field">cbSize</a>;
 
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="84e443ef0f366853" href="../R/84e443ef0f366853.html" target="n" data-glyph="42,1" class="i field">dwCheckFlags</a>;
 
        <span class="c">///</span><span class="c"> LPCWSTR-&gt;WCHAR*</span>
        [<span class="i">MarshalAsAttribute</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
        <b>public string</b> <a id="7779286298dff7bd" href="../R/7779286298dff7bd.html" target="n" data-glyph="42,1" class="i field">ImagePath</a>;
 
        <span class="c">///</span><span class="c"> HANDLE-&gt;void*</span>
        <b>public</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="e92a1d1b2067db1a" href="../R/e92a1d1b2067db1a.html" target="n" data-glyph="42,1" class="i field">hImageFileHandle</a>;
 
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="b56e29b41dd5f915" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">UrlZoneId</a>;
 
        <span class="c">///</span><span class="c"> BYTE[SAFER_MAX_HASH_SIZE]</span>
        [<span class="i">MarshalAsAttribute</span>(
            <span class="i">UnmanagedType</span>.<span class="i">ByValArray</span>,
            <span class="i">SizeConst</span> = <a href="../P/8710e5604ffa77bf.html#8710e5604ffa77bf" class="t t">NativeConstants</a>.<a href="#f4887edc37d4b7f1" class="i field">SAFER_MAX_HASH_SIZE</a>,
            <span class="i">ArraySubType</span> = <span class="i">UnmanagedType</span>.<span class="i">I1</span>)]
        <b>public byte</b>[] <a id="78579087c2512d2f" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">ImageHash</a>;
 
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="1d73d7b09eeca379" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">dwImageHashSize</a>;
 
        <span class="c">///</span><span class="c"> LARGE_INTEGER-&gt;_LARGE_INTEGER</span>
        <b>public</b> <a href="#47226832b567cebf" class="t t">LARGE_INTEGER</a> <a id="a04f361f4b09e8c0" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">ImageSize</a>;
 
        <span class="c">///</span><span class="c"> ALG_ID-&gt;unsigned int</span>
        <b>public uint</b> <a id="ad0cad8559cf3b79" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">HashAlgorithm</a>;
 
        <span class="c">///</span><span class="c"> LPBYTE-&gt;BYTE*</span>
        <b>public</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="a9c37235a6d84a48" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">pByteBlock</a>;
 
        <span class="c">///</span><span class="c"> HWND-&gt;HWND__*</span>
        <b>public</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="bf8011a5eec017db" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">hWndParent</a>;
 
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="5b7a74cd253ebefa" href="../R/5b7a74cd253ebefa.html" target="n" data-glyph="42,1" class="i field">dwWVTUIChoice</a>;
    }
 
    [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Explicit</span>)]
    <b>internal struct</b> <a id="47226832b567cebf" href="../R/47226832b567cebf.html" target="n" data-glyph="110,0" class="t t"><span id="3b3ec7067726ae59">LARGE_INTEGER</span></a>
    {
        <span class="c">///</span><span class="c"> Anonymous_9320654f_2227_43bf_a385_74cc8c562686</span>
        [<span class="i">FieldOffsetAttribute</span>(0)]
        <b>public</b> <a href="#020dd2934e2ee288" class="t t">Anonymous_9320654f_2227_43bf_a385_74cc8c562686</a> <a id="c3327e5a6196e597" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">Struct1</a>;
 
        <span class="c">///</span><span class="c"> Anonymous_947eb392_1446_4e25_bbd4_10e98165f3a9</span>
        [<span class="i">FieldOffsetAttribute</span>(0)]
        <b>public</b> <a href="#b64a724078891283" class="t t">Anonymous_947eb392_1446_4e25_bbd4_10e98165f3a9</a> <a id="26b3df8df5368520" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">u</a>;
 
        <span class="c">///</span><span class="c"> LONGLONG-&gt;__int64</span>
        [<span class="i">FieldOffsetAttribute</span>(0)]
        <b>public long</b> <a id="feb675b0a52eb517" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">QuadPart</a>;
    }
 
    [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
    <b>internal struct</b> <a id="f5936d27a70ad6ad" href="../R/../../0000000000.html" target="n" data-glyph="110,0" class="t t"><span id="9ab6bfad4e1342b0">HWND__</span></a>
    {
        <span class="c">///</span><span class="c"> int</span>
        <b>public int</b> <a id="545abccc25e5615f" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">unused</a>;
    }
 
    [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
    <b>internal struct</b> <a id="020dd2934e2ee288" href="../R/020dd2934e2ee288.html" target="n" data-glyph="110,0" class="t t"><span id="b0538c8e9875bfc9">Anonymous_9320654f_2227_43bf_a385_74cc8c562686</span></a>
    {
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="e30368c0e8c4f279" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">LowPart</a>;
 
        <span class="c">///</span><span class="c"> LONG-&gt;int</span>
        <b>public int</b> <a id="89400683ba6d75ca" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">HighPart</a>;
    }
 
    [<span class="i">StructLayoutAttribute</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
    <b>internal struct</b> <a id="b64a724078891283" href="../R/b64a724078891283.html" target="n" data-glyph="110,0" class="t t"><span id="6516caa2f275381b">Anonymous_947eb392_1446_4e25_bbd4_10e98165f3a9</span></a>
    {
        <span class="c">///</span><span class="c"> DWORD-&gt;unsigned int</span>
        <b>public uint</b> <a id="acf3453b7341272e" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">LowPart</a>;
 
        <span class="c">///</span><span class="c"> LONG-&gt;int</span>
        <b>public int</b> <a id="13807a099ef469e3" href="../R/../../0000000000.html" target="n" data-glyph="42,1" class="i field">HighPart</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SAFER_APIs
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Pinvoke methods from advapi32.dll.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static</b> <a href="../P/8e47b880ffb978dc.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeMethods</span>
    {
        <span class="c">//</span>
        <span class="c">// This is duplicating some of the effort made in Win32Native.cs,</span>
        <span class="c">// namespace = Microsoft.PowerShell.Commands.Internal.Win32Native</span>
        <span class="c">//</span>
        <b>internal const uint</b> <a id="25b2718d2378b3e2" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ERROR_SUCCESS</a> = 0;
        <b>internal const uint</b> <a id="506c423186946cdc" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ERROR_NO_TOKEN</a> = 0x3f0;
 
        <b>internal const uint</b> <a id="0f3be4d15ff24262" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">STATUS_SUCCESS</a> = 0;
        <b>internal const uint</b> <a id="e3867beb8e8f6e5f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">STATUS_INVALID_PARAMETER</a> = 0xC000000D;
 
        <b>internal const uint</b> <a id="5681d2a71b9cdd9f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ACL_REVISION</a> = 2;
 
        <b>internal const uint</b> <a id="5ff9009d0fa6d69f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SYSTEM_SCOPED_POLICY_ID_ACE_TYPE</a> = 0x13;
 
        <b>internal const uint</b> <a id="4e4aaeec4e4a63b5" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SUB_CONTAINERS_AND_OBJECTS_INHERIT</a> = 0x3;
        <b>internal const uint</b> <a id="99b397ca1be8c1f9" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">INHERIT_ONLY_ACE</a> = 0x8;
 
        <b>internal const uint</b> <a id="d7cc4e13431eac50" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ASSIGN_PRIMARY</a> = 0x0001;
        <b>internal const uint</b> <a id="217db5ced3f2d1f6" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_DUPLICATE</a> = 0x0002;
        <b>internal const uint</b> <a id="995a8c5940a39b21" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_IMPERSONATE</a> = 0x0004;
        <b>internal const uint</b> <a id="2fea1a3017c55f81" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_QUERY</a> = 0x0008;
        <b>internal const uint</b> <a id="f401585a738e7511" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_QUERY_SOURCE</a> = 0x0010;
        <b>internal const uint</b> <a id="03272cc0176c3a8f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ADJUST_PRIVILEGES</a> = 0x0020;
        <b>internal const uint</b> <a id="2a5773e364231170" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ADJUST_GROUPS</a> = 0x0040;
        <b>internal const uint</b> <a id="4359c056b2158432" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ADJUST_DEFAULT</a> = 0x0080;
        <b>internal const uint</b> <a id="e89584309cb47eda" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ADJUST_SESSIONID</a> = 0x0100;
 
        <b>internal const uint</b> <a id="51c9467dd84ef756" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_ENABLED_BY_DEFAULT</a> = 0x00000001;
        <b>internal const uint</b> <a id="e577e767ec2642be" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_ENABLED</a> = 0x00000002;
        <b>internal const uint</b> <a id="34bbba1eaa0a7aeb" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_REMOVED</a> = 0X00000004;
        <b>internal const uint</b> <a id="87699c6d4e341f23" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_USED_FOR_ACCESS</a> = 0x80000000;
 
        <b>internal enum</b> <a id="7adbbf976513945e" href="../R/7adbbf976513945e.html" target="n" data-glyph="20,1" class="t t"><span id="38c9cd492a0021fd">SeObjectType</span></a> : <b>uint</b>
        {
            <a id="dd980e31f9f0f49a" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_UNKNOWN_OBJECT_TYPE</a> = 0,
            <a id="b3a6a8b7c972cd2d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_FILE_OBJECT</a> = 1,
            <a id="1a7057a92b6b77c4" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_SERVICE</a> = 2,
            <a id="9a829ee170c23e35" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_PRINTER</a> = 3,
            <a id="1f8758862e470731" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_REGISTRY_KEY</a> = 4,
            <a id="3f8346dfb2e3600c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_LMSHARE</a> = 5,
            <a id="8e7fe93d58e57cbe" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_KERNEL_OBJECT</a> = 6,
            <a id="2c3678dca5de1830" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_WINDOW_OBJECT</a> = 7,
            <a id="89b7900e162cb4d0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_DS_OBJECT</a> = 8,
            <a id="5106711672543142" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_DS_OBJECT_ALL</a> = 9,
            <a id="37fb35ea06ee30e3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_PROVIDER_DEFINED_OBJECT</a> = 10,
            <a id="92cff49c0313207b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_WMIGUID_OBJECT</a> = 11,
            <a id="33753f099550dd56" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SE_REGISTRY_WOW64_32KEY</a> = 12
        }
 
        <b>internal enum</b> <a id="bbba0c4eb26f440f" href="../R/bbba0c4eb26f440f.html" target="n" data-glyph="20,1" class="t t"><span id="c130b3416c1c12a3">SecurityInformation</span></a> : <b>uint</b>
        {
            <a id="0dea9e3d79ddec5b" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">OWNER_SECURITY_INFORMATION</a> = 0x00000001,
            <a id="ec98d36f3218d861" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">GROUP_SECURITY_INFORMATION</a> = 0x00000002,
            <a id="a8cfbc67405a01e2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">DACL_SECURITY_INFORMATION</a> = 0x00000004,
            <a id="fad62943ad73aad0" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SACL_SECURITY_INFORMATION</a> = 0x00000008,
            <a id="8dac46fded37c5d5" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">LABEL_SECURITY_INFORMATION</a> = 0x00000010,
            <a id="b5a0ef364cfea0fc" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">ATTRIBUTE_SECURITY_INFORMATION</a> = 0x00000020,
            <a id="8f11c6807d8ce3c7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SCOPE_SECURITY_INFORMATION</a> = 0x00000040,
            <a id="0e34c7b8e052a578" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">BACKUP_SECURITY_INFORMATION</a> = 0x00010000,
            <a id="54204b84917824bd" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PROTECTED_DACL_SECURITY_INFORMATION</a> = 0x80000000,
            <a id="d7ada0ce419bf32e" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PROTECTED_SACL_SECURITY_INFORMATION</a> = 0x40000000,
            <a id="c8cbfa6b862e73e9" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">UNPROTECTED_DACL_SECURITY_INFORMATION</a> = 0x20000000,
            <a id="5b12f37a9b0ed03d" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">UNPROTECTED_SACL_SECURITY_INFORMATION</a> = 0x10000000
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="dfd35b9be1eaf72f" href="../R/dfd35b9be1eaf72f.html" target="n" data-glyph="110,1" class="t t"><span id="09d4b107fb5019ee">LUID</span></a>
        {
            <b>internal uint</b> <a id="7cca7aa2bdb82ac7" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">LowPart</a>;
            <b>internal uint</b> <a id="b28c44947dc30290" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">HighPart</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="58f64691b4163f93" href="../R/58f64691b4163f93.html" target="n" data-glyph="110,1" class="t t"><span id="3e363c0b705ae529">LUID_AND_ATTRIBUTES</span></a>
        {
            <b>internal</b> <a href="#dfd35b9be1eaf72f" class="t t">LUID</a> <a id="06ec398dde226a16" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Luid</a>;
            <b>internal uint</b> <a id="08a43a0638c17df6" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Attributes</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="faf859a9d2488391" href="../R/faf859a9d2488391.html" target="n" data-glyph="110,1" class="t t"><span id="cad02e466e98b6f7">TOKEN_PRIVILEGE</span></a>
        {
            <b>internal uint</b> <a id="994ce824eae17d4e" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">PrivilegeCount</a>;
            <b>internal</b> <a href="#58f64691b4163f93" class="t t">LUID_AND_ATTRIBUTES</a> <a id="5ae20950d09201a7" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Privilege</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="3c1226c03bc1c298" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="f9d4a0fe82cd7093">ACL</span></a>
        {
            <b>internal byte</b> <a id="3d32ae3b75bcc8ec" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AclRevision</a>;
            <b>internal byte</b> <a id="79018feb24582d9c" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Sbz1</a>;
            <b>internal ushort</b> <a id="896b1e5425aeabfb" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AclSize</a>;
            <b>internal ushort</b> <a id="721440cae8afa730" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AceCount</a>;
            <b>internal ushort</b> <a id="07e10bfb9582c752" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Sbz2</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="2ded3a8eae421785" href="../R/2ded3a8eae421785.html" target="n" data-glyph="110,1" class="t t"><span id="e13694c039cdf20a">ACE_HEADER</span></a>
        {
            <b>internal byte</b> <a id="95b21987bf613f66" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AceType</a>;
            <b>internal byte</b> <a id="094060d1be1051e9" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AceFlags</a>;
            <b>internal ushort</b> <a id="473b7252edc5bcc1" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">AceSize</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="210333921970b2f1" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="5cd50741c1975659">SYSTEM_AUDIT_ACE</span></a>
        {
            <b>internal</b> <a href="#2ded3a8eae421785" class="t t">ACE_HEADER</a> <a id="b854fd1505fdcd4d" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Header</a>;
            <b>internal uint</b> <a id="d6358421fc1dc603" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Mask</a>;
            <b>internal uint</b> <a id="5a9b29925c285561" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">SidStart</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="bd94d544e32b1ab0" href="../R/bd94d544e32b1ab0.html" target="n" data-glyph="110,1" class="t t"><span id="d060b5c119a1dc18">LSA_UNICODE_STRING</span></a>
        {
            <b>internal ushort</b> <a id="5657330616860cc1" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Length</a>;
            <b>internal ushort</b> <a id="4baa4b69868eb002" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">MaximumLength</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="225341ccf165be98" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Buffer</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="7aea9b15cc2af53d" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="280b1db82c50d618">CENTRAL_ACCESS_POLICY</span></a>
        {
            <b>internal</b> <span class="i">IntPtr</span> <a id="71990df14e543673" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">CAPID</a>;
            <b>internal</b> <a href="#bd94d544e32b1ab0" class="t t">LSA_UNICODE_STRING</a> <a id="5bffc90cc8656aed" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Name</a>;
            <b>internal</b> <a href="#bd94d544e32b1ab0" class="t t">LSA_UNICODE_STRING</a> <a id="71568fad51d70ed9" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Description</a>;
            <b>internal</b> <a href="#bd94d544e32b1ab0" class="t t">LSA_UNICODE_STRING</a> <a id="b84f32a9d86f7b60" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">ChangeId</a>;
            <b>internal uint</b> <a id="51e31737615f4cb1" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Flags</a>;
            <b>internal uint</b> <a id="d2201ef9b5a3583f" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">CAPECount</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="4618f82c14046cbe" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">CAPEs</a>;
        }
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#b64d0afd3372e8ea" class="i field">GetNamedSecurityInfoDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="6d141b6cd7e35e49" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetNamedSecurityInfo</a>(
            <b>string</b> <span id="r148 rd" class="r148 r">pObjectName</span>,
            <a href="#7adbbf976513945e" class="t t">SeObjectType</a> <span id="r149 rd" class="r149 r">ObjectType</span>,
            <a href="#bbba0c4eb26f440f" class="t t">SecurityInformation</a> <span id="r150 rd" class="r150 r">SecurityInfo</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r151 rd" class="r151 r">ppsidOwner</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r152 rd" class="r152 r">ppsidGroup</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r153 rd" class="r153 r">ppDacl</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r154 rd" class="r154 r">ppSacl</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r155 rd" class="r155 r">ppSecurityDescriptor</span>
        );
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#58d4d2025ef3f17f" class="i field">SetNamedSecurityInfoDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="ce5d4235c798e1a5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetNamedSecurityInfo</a>(
            <b>string</b> <span id="r156 rd" class="r156 r">pObjectName</span>,
            <a href="#7adbbf976513945e" class="t t">SeObjectType</a> <span id="r157 rd" class="r157 r">ObjectType</span>,
            <a href="#bbba0c4eb26f440f" class="t t">SecurityInformation</a> <span id="r158 rd" class="r158 r">SecurityInfo</span>,
            <span class="i">IntPtr</span> <span id="r159 rd" class="r159 r">psidOwner</span>,
            <span class="i">IntPtr</span> <span id="r160 rd" class="r160 r">psidGroup</span>,
            <span class="i">IntPtr</span> <span id="r161 rd" class="r161 r">pDacl</span>,
            <span class="i">IntPtr</span> <span id="r162 rd" class="r162 r">pSacl</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#fbd1e293a6b69e45" class="i field">ConvertStringSidToSidDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="50c8315a507f3be2" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ConvertStringSidToSid</a>(
            <b>string</b> <span id="r163 rd" class="r163 r">StringSid</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r164 rd" class="r164 r">Sid</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#a53094a112988829" class="i field">IsValidSidDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="b1b54ec4477f35bf" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsValidSid</a>(<span class="i">IntPtr</span> <span id="r165 rd" class="r165 r">pSid</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#87eaa0f36360a7c9" class="i field">GetLengthSidDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="c5e8d36778108260" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetLengthSid</a>(<span class="i">IntPtr</span> <span id="r166 rd" class="r166 r">pSid</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;Advapi32.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="45645ea49a109792" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LsaQueryCAPs</a>(
            <span class="i">IntPtr</span>[] <span id="r167 rd" class="r167 r">CAPIDs</span>,
            <b>uint</b> <span id="r168 rd" class="r168 r">CAPIDCount</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r169 rd" class="r169 r">CAPs</span>,
            <b>out uint</b> <span id="r170 rd" class="r170 r">CAPCount</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#797f12a3ea336383" class="i field">LsaFreeMemoryDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="4e028be95841afd2" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LsaFreeMemory</a>(<span class="i">IntPtr</span> <span id="r171 rd" class="r171 r">Buffer</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#1afafd7a5a489d19" class="i field">InitializeAclDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="aadc6177fadbfb71" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">InitializeAcl</a>(
            <span class="i">IntPtr</span> <span id="r172 rd" class="r172 r">pAcl</span>,
            <b>uint</b> <span id="r173 rd" class="r173 r">nAclLength</span>,
            <b>uint</b> <span id="r174 rd" class="r174 r">dwAclRevision</span>);
 
        [<span class="i">DllImport</span>(<span class="s">&quot;api-ms-win-security-base-l1-2-0.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="92799d7b71cd0a8c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddScopedPolicyIDAce</a>(
            <span class="i">IntPtr</span> <span id="r175 rd" class="r175 r">Acl</span>,
            <b>uint</b> <span id="r176 rd" class="r176 r">AceRevision</span>,
            <b>uint</b> <span id="r177 rd" class="r177 r">AceFlags</span>,
            <b>uint</b> <span id="r178 rd" class="r178 r">AccessMask</span>,
            <span class="i">IntPtr</span> <span id="r179 rd" class="r179 r">Sid</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#b2a49fa9b822570e" class="i field">GetCurrentProcessDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="ba3c715e21077c6d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetCurrentProcess</a>();
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#8a732f23d022ee31" class="i field">GetCurrentThreadDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="ab83de9f52f191e2" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetCurrentThread</a>();
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#798b1555bc1a5597" class="i field">OpenProcessTokenDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="c3c6a3c54e97809e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">OpenProcessToken</a>(
            <span class="i">IntPtr</span> <span id="r180 rd" class="r180 r">ProcessHandle</span>,
            <b>uint</b> <span id="r181 rd" class="r181 r">DesiredAccess</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r182 rd" class="r182 r">TokenHandle</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#b974e6a8a31626a5" class="i field">OpenThreadTokenDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="ccce8674f2e27826" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">OpenThreadToken</a>(
            <span class="i">IntPtr</span> <span id="r183 rd" class="r183 r">ThreadHandle</span>,
            <b>uint</b> <span id="r184 rd" class="r184 r">DesiredAccess</span>,
            <b>bool</b> <span id="r185 rd" class="r185 r">OpenAsSelf</span>,
            <b>out</b> <span class="i">IntPtr</span> <span id="r186 rd" class="r186 r">TokenHandle</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#c10e90ab0b2989a6" class="i field">LookupPrivilegeValueDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="b27750b0fb068ace" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LookupPrivilegeValue</a>(
            <b>string</b> <span id="r187 rd" class="r187 r">lpSystemName</span>,
            <b>string</b> <span id="r188 rd" class="r188 r">lpName</span>,
            <b>ref</b> <a href="#dfd35b9be1eaf72f" class="t t">LUID</a> <span id="r189 rd" class="r189 r">lpLuid</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#88a7e5c9463e78ce" class="i field">AdjustTokenPrivilegesDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="5e08c3dc64c7b85f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AdjustTokenPrivileges</a>(
            <span class="i">IntPtr</span> <span id="r190 rd" class="r190 r">TokenHandle</span>,
            <b>bool</b> <span id="r191 rd" class="r191 r">DisableAllPrivileges</span>,
            <b>ref</b> <a href="#faf859a9d2488391" class="t t">TOKEN_PRIVILEGE</a> <span id="r192 rd" class="r192 r">NewState</span>,
            <b>uint</b> <span id="r193 rd" class="r193 r">BufferLength</span>,
            <b>ref</b> <a href="#faf859a9d2488391" class="t t">TOKEN_PRIVILEGE</a> <span id="r194 rd" class="r194 r">PreviousState</span>,
            <b>ref uint</b> <span id="r195 rd" class="r195 r">ReturnLength</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#001ee47a74a501c0" class="i field">LocalFreeDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="75985bc691767a78" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LocalFree</a>(<span class="i">IntPtr</span> <span id="r196 rd" class="r196 r">hMem</span>);
 
        <b>internal const uint</b> <a id="4e222a5289c26b77" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">DONT_RESOLVE_DLL_REFERENCES</a> = 0x00000001;
        <b>internal const uint</b> <a id="b4f792b7f709ef0b" href="../R/b4f792b7f709ef0b.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_AS_DATAFILE</a> = 0x00000002;
        <b>internal const uint</b> <a id="85b99d1657d3e8e5" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_WITH_ALTERED_SEARCH_PATH</a> = 0x00000008;
        <b>internal const uint</b> <a id="91d1ac80553a4053" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_IGNORE_CODE_AUTHZ_LEVEL</a> = 0x00000010;
        <b>internal const uint</b> <a id="030bbdea81266eb3" href="../R/030bbdea81266eb3.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_AS_IMAGE_RESOURCE</a> = 0x00000020;
        <b>internal const uint</b> <a id="d2948a5e0d124658" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_AS_DATAFILE_EXCLUSIVE</a> = 0x00000040;
        <b>internal const uint</b> <a id="db16934da617dc2a" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_REQUIRE_SIGNED_TARGET</a> = 0x00000080;
        <b>internal const uint</b> <a id="ec379d1be052f068" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_SEARCH_DLL_LOAD_DIR</a> = 0x00000100;
        <b>internal const uint</b> <a id="267205e273f43a70" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_SEARCH_APPLICATION_DIR</a> = 0x00000200;
        <b>internal const uint</b> <a id="6fa2b1ab29ea4e49" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_SEARCH_USER_DIRS</a> = 0x00000400;
        <b>internal const uint</b> <a id="636e445f27bcc3a9" href="../R/636e445f27bcc3a9.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_SEARCH_SYSTEM32</a> = 0x00000800;
        <b>internal const uint</b> <a id="642a221c6563a5e2" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">LOAD_LIBRARY_SEARCH_DEFAULT_DIRS</a> = 0x00001000;
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#a888f812186fc015" class="i field">LoadLibraryEx</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="0ab781afdd8fe22e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LoadLibraryExW</a>(
            <b>string</b> <span id="r197 rd" class="r197 r">DllName</span>,
            <span class="i">IntPtr</span> <span id="r198 rd" class="r198 r">reserved</span>,
            <b>uint</b> <span id="r199 rd" class="r199 r">Flags</span>);
 
        [<span class="i">DllImport</span>(<a href="../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../utils/PInvokeDllNames.cs.html#a7d239a9004d28b4" class="i field">FreeLibrary</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="4167b45c8194c2f6" href="../R/4167b45c8194c2f6.html" target="n" data-glyph="74,1" class="i method">FreeLibrary</a>(
            <span class="i">IntPtr</span> <span id="r200 rd" class="r200 r">Module</span>);
 
        <b>internal static bool</b> <a id="f263701866080cd0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsSystem32DllPresent</a>(<b>string</b> <span id="r201 rd" class="r201 r">DllName</span>)
        {
            <b>bool</b> <span id="r202 rd" class="r202 r">DllExists</span> = <b>false</b>;
 
            <b>try</b>
            {
                <span class="i">IntPtr</span> <span id="r203 rd" class="r203 r">module</span> = <span class="i">LoadLibraryExW</span>(
                                        <span class="r201 r">DllName</span>,
                                        <span class="i">IntPtr</span>.<span class="i">Zero</span>,
                                        <a href="../P/8e47b880ffb978dc.html#8e47b880ffb978dc" class="t t">NativeMethods</a>.<a href="#b4f792b7f709ef0b" class="i field">LOAD_LIBRARY_AS_DATAFILE</a> |
                                            <a href="../P/8e47b880ffb978dc.html#8e47b880ffb978dc" class="t t">NativeMethods</a>.<a href="#030bbdea81266eb3" class="i field">LOAD_LIBRARY_AS_IMAGE_RESOURCE</a> |
                                            <a href="../P/8e47b880ffb978dc.html#8e47b880ffb978dc" class="t t">NativeMethods</a>.<a href="#636e445f27bcc3a9" class="i field">LOAD_LIBRARY_SEARCH_SYSTEM32</a>);
                <b>if</b> (<span class="r203 r">module</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#4167b45c8194c2f6" class="i method">FreeLibrary</a>(<span class="r203 r">module</span>);
                    <span class="r202 r">DllExists</span> = <b>true</b>;
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
 
            <b>return</b> <span class="r202 r">DllExists</span>;
        }
    }
 
    <span class="c">// Constants needed for Catalog Error Handling</span>
    <b>internal</b> <a href="../P/8710e5604ffa77bf.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeConstants</span>
    {
        <span class="c">// CRYPTCAT_E_AREA_HEADER = &quot;0x00000000&quot;;</span>
        <b>public const int</b> <a id="086b31327f313cc4" href="../R/086b31327f313cc4.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_AREA_HEADER</a> = 0;
 
        <span class="c">// CRYPTCAT_E_AREA_MEMBER = &quot;0x00010000&quot;;</span>
        <b>public const int</b> <a id="0aef5350a66f0066" href="../R/0aef5350a66f0066.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_AREA_MEMBER</a> = 65536;
 
        <span class="c">// CRYPTCAT_E_AREA_ATTRIBUTE = &quot;0x00020000&quot;;</span>
        <b>public const int</b> <a id="c5e3110923e13a52" href="../R/c5e3110923e13a52.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_AREA_ATTRIBUTE</a> = 131072;
 
        <span class="c">// CRYPTCAT_E_CDF_UNSUPPORTED = &quot;0x00000001&quot;;</span>
        <b>public const int</b> <a id="aafae9888c4387c8" href="../R/aafae9888c4387c8.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_UNSUPPORTED</a> = 1;
 
        <span class="c">// CRYPTCAT_E_CDF_DUPLICATE = &quot;0x00000002&quot;;</span>
        <b>public const int</b> <a id="5cdc443990f4cd13" href="../R/5cdc443990f4cd13.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_DUPLICATE</a> = 2;
 
        <span class="c">// CRYPTCAT_E_CDF_TAGNOTFOUND = &quot;0x00000004&quot;;</span>
        <b>public const int</b> <a id="18da7c22d175fb96" href="../R/18da7c22d175fb96.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_TAGNOTFOUND</a> = 4;
 
        <span class="c">// CRYPTCAT_E_CDF_MEMBER_FILE_PATH = &quot;0x00010001&quot;;</span>
        <b>public const int</b> <a id="239e5e0233f3b18e" href="../R/239e5e0233f3b18e.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_MEMBER_FILE_PATH</a> = 65537;
 
        <span class="c">// CRYPTCAT_E_CDF_MEMBER_INDIRECTDATA = &quot;0x00010002&quot;;</span>
        <b>public const int</b> <a id="cd40cee2f5c29243" href="../R/cd40cee2f5c29243.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_MEMBER_INDIRECTDATA</a> = 65538;
 
        <span class="c">// CRYPTCAT_E_CDF_MEMBER_FILENOTFOUND = &quot;0x00010004&quot;;</span>
        <b>public const int</b> <a id="b206254c5b592cf1" href="../R/b206254c5b592cf1.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_MEMBER_FILENOTFOUND</a> = 65540;
 
        <span class="c">// CRYPTCAT_E_CDF_BAD_GUID_CONV = &quot;0x00020001&quot;;</span>
        <b>public const int</b> <a id="5bc600a3a2646a36" href="../R/5bc600a3a2646a36.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_BAD_GUID_CONV</a> = 131073;
 
        <span class="c">// CRYPTCAT_E_CDF_ATTR_TOOFEWVALUES = &quot;0x00020002&quot;;</span>
        <b>public const int</b> <a id="ed9da0b30ce3ced2" href="../R/ed9da0b30ce3ced2.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_ATTR_TOOFEWVALUES</a> = 131074;
 
        <span class="c">// CRYPTCAT_E_CDF_ATTR_TYPECOMBO = &quot;0x00020004&quot;;</span>
        <b>public const int</b> <a id="d4d7e3fda1ae7e04" href="../R/d4d7e3fda1ae7e04.html" target="n" data-glyph="6,1" class="i field">CRYPTCAT_E_CDF_ATTR_TYPECOMBO</a> = 131076;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Pinvoke methods from wintrust.dll</span>
    <span class="c">///</span><span class="c"> These are added to Generate and Validate Window Catalog Files.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static</b> <a href="../P/8e47b880ffb978dc.html" target="s" class="k">partial</a> <b>class</b> <span class="t t">NativeMethods</span>
    {
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="b370cfb35efec725" href="../R/b370cfb35efec725.html" target="n" data-glyph="110,1" class="t t"><span id="50de0ee7e341962b">CRYPT_ATTRIBUTE_TYPE_VALUE</span></a>
        {
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStr</span>)]
            <b>internal string</b> <a id="f562dae2a51e4e6c" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pszObjId</a>;
 
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="8ba3534ce286abfe" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Value</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="43c4d5783dfd2269" href="../R/43c4d5783dfd2269.html" target="n" data-glyph="110,1" class="t t"><span id="796026ec4dfd9889">SIP_INDIRECT_DATA</span></a>
        {
            <b>internal</b> <a href="#b370cfb35efec725" class="t t">CRYPT_ATTRIBUTE_TYPE_VALUE</a> <a id="f55f7b9ccbbd5e95" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Data</a>;
            <b>internal</b> <a href="#fd0cea3a7e7875a3" class="t t">CRYPT_ALGORITHM_IDENTIFIER</a> <a id="db8a4fc71f6b626a" href="../R/db8a4fc71f6b626a.html" target="n" data-glyph="44,2" class="i field">DigestAlgorithm</a>;
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="7aa61fa776dcc351" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">Digest</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal readonly struct</b> <a id="25747f9bf691e409" href="../R/../../0000000000.html" target="n" data-glyph="110,1" class="t t"><span id="47c94f9a2ad448f2">CRYPTCATCDF</span></a>
        {
            <b>private readonly</b> <span class="i">DWORD</span> <a id="0a8b3d0a93715ad7" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_cbStruct</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="9a8babad097caf8a" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hFile</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="2b13b4ca211e67ed" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwCurFilePos</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="3c4d524a595ab1c5" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwLastMemberOffset</a>;
            <b>private readonly</b> <span class="i">BOOL</span> <a id="83931081848a864e" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fEOF</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>private readonly string</b> <a id="2216aef22d04b1e5" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_pwszResultDir</a>;
 
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="9457bae5228513a9" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hCATStore</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="0b5e9487d8cd89a3" href="../R/0b5e9487d8cd89a3.html" target="n" data-glyph="110,1" class="t t"><span id="d344f193e9b96758">CRYPTCATMEMBER</span></a>
        {
            <b>internal</b> <span class="i">DWORD</span> <a id="9d71bb33a7c2c6e5" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">cbStruct</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="dd6a825e9d3feeca" href="../R/dd6a825e9d3feeca.html" target="n" data-glyph="44,2" class="i field">pwszReferenceTag</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="806d542c26d204e2" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pwszFileName</a>;
 
            <b>internal</b> <span class="i">Guid</span> <a id="3333c658f09f3891" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">gSubjectType</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="cb5bc179ce334dc1" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">fdwMemberFlags</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="338cb5505e0dcd95" href="../R/338cb5505e0dcd95.html" target="n" data-glyph="44,2" class="i field">pIndirectData</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="1b98c36aa4e6c38f" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwCertVersion</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="039e197fc6001273" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">dwReserved</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="0a403de9ca6b234f" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">hReserved</a>;
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="22602d3e5f84ad0c" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">sEncodedIndirectData</a>;
            <b>internal</b> <a href="#ccbd29b032ebd6eb" class="t t">CRYPT_ATTR_BLOB</a> <a id="4e547bc21ba2fd02" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">sEncodedMemberInfo</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="c4e73ae122fbf09e" href="../R/c4e73ae122fbf09e.html" target="n" data-glyph="110,1" class="t t"><span id="adfb2c279ea7c835">CRYPTCATATTRIBUTE</span></a>
        {
            <b>private readonly</b> <span class="i">DWORD</span> <a id="e10030edc846927a" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_cbStruct</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="31aa0990865c995c" href="../R/31aa0990865c995c.html" target="n" data-glyph="44,2" class="i field">pwszReferenceTag</a>;
 
            <b>private readonly</b> <span class="i">DWORD</span> <a id="0b91c7025e782ac0" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwAttrTypeAndAction</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="42eef149a33c6bf0" href="../R/42eef149a33c6bf0.html" target="n" data-glyph="44,2" class="i field">cbValue</a>;
            <b>internal</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="4951468e87ad303c" href="../R/4951468e87ad303c.html" target="n" data-glyph="44,2" class="i field">pbValue</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="bdd0c3b05c7d5e3f" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwReserved</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="d2233044ce700a9f" href="../R/d2233044ce700a9f.html" target="n" data-glyph="110,1" class="t t"><span id="0555d79441d70969">CRYPTCATSTORE</span></a>
        {
            <b>private readonly</b> <span class="i">DWORD</span> <a id="380f213302f029ee" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_cbStruct</a>;
            <b>internal</b> <span class="i">DWORD</span> <a id="d1373b8c0d82130d" href="../R/d1373b8c0d82130d.html" target="n" data-glyph="44,2" class="i field">dwPublicVersion</a>;
 
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="b28903ba39da827e" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">pwszP7File</a>;
 
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="e985bf1ece052f2e" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hProv</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="65b005f8d9ad3305" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_dwEncodingType</a>;
            <b>private readonly</b> <span class="i">DWORD</span> <a id="474ba5135a8776dc" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_fdwStoreFlags</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="5d624410067d2f4d" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hReserved</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="f15a9b0fe7731e4f" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hAttrs</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="9f8debade91bd3cb" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hCryptMsg</a>;
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="563731d273bf9b2a" href="../R/../../0000000000.html" target="n" data-glyph="46,2" class="i field">_hSorted</a>;
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="894c552cea2eb54e" href="../R/894c552cea2eb54e.html" target="n" data-glyph="74,1" class="i method">CryptCATCDFOpen</a>(
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r204 rd" class="r204 r">pwszFilePath</span>,
            <a href="#0039f5a20c45943e" class="t t">CryptCATCDFOpenCallBack</a> <span id="r205 rd" class="r205 r">pfnParseError</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="ffad7586376326b7" href="../R/ffad7586376326b7.html" target="n" data-glyph="74,1" class="i method">CryptCATCDFClose</a>(
            <span class="i">IntPtr</span> <span id="r206 rd" class="r206 r">pCDF</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="5317d674a3a39e54" href="../R/5317d674a3a39e54.html" target="n" data-glyph="74,1" class="i method">CryptCATCDFEnumCatAttributes</a>(
            <span class="i">IntPtr</span> <span id="r207 rd" class="r207 r">pCDF</span>,
            <span class="i">IntPtr</span> <span id="r208 rd" class="r208 r">pPrevAttr</span>,
            <a href="#0039f5a20c45943e" class="t t">CryptCATCDFOpenCallBack</a> <span id="r209 rd" class="r209 r">pfnParseError</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="0fecffbd0de576b0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptCATCDFEnumMembersByCDFTagEx</a>(
            <span class="i">IntPtr</span> <span id="r210 rd" class="r210 r">pCDF</span>,
            <span class="i">IntPtr</span> <span id="r211 rd" class="r211 r">pwszPrevCDFTag</span>,
            <a href="#dc710e31420a665a" class="t t">CryptCATCDFEnumMembersByCDFTagExErrorCallBack</a> <span id="r212 rd" class="r212 r">fn</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r213 rd" class="r213 r">ppMember</span>,
            <b>bool</b> <span id="r214 rd" class="r214 r">fContinueOnError</span>,
            <span class="i">IntPtr</span> <span id="r215 rd" class="r215 r">pvReserved</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="a7e3c23c78e575f2" href="../R/a7e3c23c78e575f2.html" target="n" data-glyph="74,1" class="i method">CryptCATCDFEnumAttributesWithCDFTag</a>(
            <span class="i">IntPtr</span> <span id="r216 rd" class="r216 r">pCDF</span>,
            <span class="i">IntPtr</span> <span id="r217 rd" class="r217 r">pwszMemberTag</span>,
            <span class="i">IntPtr</span> <span id="r218 rd" class="r218 r">pMember</span>,
            <span class="i">IntPtr</span> <span id="r219 rd" class="r219 r">pPrevAttr</span>,
            <a href="#dc710e31420a665a" class="t t">CryptCATCDFEnumMembersByCDFTagExErrorCallBack</a> <span id="r220 rd" class="r220 r">fn</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="0060df5392695c54" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptCATOpen</a>(
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r221 rd" class="r221 r">pwszFilePath</span>,
            <span class="i">DWORD</span> <span id="r222 rd" class="r222 r">fdwOpenFlags</span>,
            <span class="i">IntPtr</span> <span id="r223 rd" class="r223 r">hProv</span>,
            <span class="i">DWORD</span> <span id="r224 rd" class="r224 r">dwPublicVersion</span>,
            <span class="i">DWORD</span> <span id="r225 rd" class="r225 r">dwEncodingType</span>
         );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="a659272625b81972" href="../R/a659272625b81972.html" target="n" data-glyph="74,1" class="i method">CryptCATClose</a>(
          <span class="i">IntPtr</span> <span id="r226 rd" class="r226 r">hCatalog</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="5c52d0c32daa2ed0" href="../R/5c52d0c32daa2ed0.html" target="n" data-glyph="74,1" class="i method">CryptCATStoreFromHandle</a>(
            <span class="i">IntPtr</span> <span id="r227 rd" class="r227 r">hCatalog</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="e136f6981e1f550f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptCATAdminAcquireContext2</a>(
          <b>ref</b> <span class="i">IntPtr</span> <span id="r228 rd" class="r228 r">phCatAdmin</span>,
          <span class="i">IntPtr</span> <span id="r229 rd" class="r229 r">pgSubsystem</span>,
          [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
          <b>string</b> <span id="r230 rd" class="r230 r">pwszHashAlgorithm</span>,
          <span class="i">IntPtr</span> <span id="r231 rd" class="r231 r">pStrongHashPolicy</span>,
          <span class="i">DWORD</span> <span id="r232 rd" class="r232 r">dwFlags</span>
      );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="70ab54cb52633e59" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptCATAdminReleaseContext</a>(
            <span class="i">IntPtr</span> <span id="r233 rd" class="r233 r">phCatAdmin</span>,
            <span class="i">DWORD</span> <span id="r234 rd" class="r234 r">dwFlags</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;kernel32&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern unsafe</b> <span class="i">IntPtr</span> <a id="6fd36a37e0e48bbc" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateFile</a>(
            <b>string</b> <span id="r235 rd" class="r235 r">lpFileName</span>,
            <span class="i">DWORD</span> <span id="r236 rd" class="r236 r">dwDesiredAccess</span>,
            <span class="i">DWORD</span> <span id="r237 rd" class="r237 r">dwShareMode</span>,
            <span class="i">DWORD</span> <span id="r238 rd" class="r238 r">lpSecurityAttributes</span>,
            <span class="i">DWORD</span> <span id="r239 rd" class="r239 r">dwCreationDisposition</span>,
            <span class="i">DWORD</span> <span id="r240 rd" class="r240 r">dwFlagsAndAttributes</span>,
            <span class="i">IntPtr</span> <span id="r241 rd" class="r241 r">hTemplateFile</span>
           );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="67836faa70e5b8c9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CryptCATAdminCalcHashFromFileHandle2</a>(
            <span class="i">IntPtr</span> <span id="r242 rd" class="r242 r">hCatAdmin</span>,
            <span class="i">IntPtr</span> <span id="r243 rd" class="r243 r">hFile</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">DWORD</span> <span id="r244 rd" class="r244 r">pcbHash</span>,
            <span class="i">IntPtr</span> <span id="r245 rd" class="r245 r">pbHash</span>,
            <span class="i">DWORD</span> <span id="r246 rd" class="r246 r">dwFlags</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="f90cd1b54a63d19f" href="../R/f90cd1b54a63d19f.html" target="n" data-glyph="74,1" class="i method">CryptCATEnumerateCatAttr</a>(
            <span class="i">IntPtr</span> <span id="r247 rd" class="r247 r">hCatalog</span>,
            <span class="i">IntPtr</span> <span id="r248 rd" class="r248 r">pPrevAttr</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="ee70974e333a155a" href="../R/ee70974e333a155a.html" target="n" data-glyph="74,1" class="i method">CryptCATEnumerateMember</a>(
                <span class="i">IntPtr</span> <span id="r249 rd" class="r249 r">hCatalog</span>,
                <span class="i">IntPtr</span> <span id="r250 rd" class="r250 r">pPrevMember</span>
        );
 
        [<span class="i">DllImport</span>(<span class="s">&quot;wintrust.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="1a4102b745f0dc71" href="../R/1a4102b745f0dc71.html" target="n" data-glyph="74,1" class="i method">CryptCATEnumerateAttr</a>(
            <span class="i">IntPtr</span> <span id="r251 rd" class="r251 r">hCatalog</span>,
            <span class="i">IntPtr</span> <span id="r252 rd" class="r252 r">pCatMember</span>,
            <span class="i">IntPtr</span> <span id="r253 rd" class="r253 r">pPrevAttr</span>
        );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signature of call back function used by CryptCATCDFOpen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate
        void</b> <a id="0039f5a20c45943e" href="../R/0039f5a20c45943e.html" target="n" data-glyph="14,1" class="t t"><span id="b77803ee5f3846bd">CryptCATCDFOpenCallBack</span></a>(<span class="i">DWORD</span> <span id="r254 rd" class="r254 r">NotUsedDWORD1</span>,
                                      <span class="i">DWORD</span> <span id="r255 rd" class="r255 r">NotUsedDWORD2</span>,
                                      [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                                      <b>string</b> <span id="r256 rd" class="r256 r">NotUsedString</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Signature of call back function used by CryptCATCDFEnumMembersByCDFTagEx.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal delegate
        void</b> <a id="dc710e31420a665a" href="../R/dc710e31420a665a.html" target="n" data-glyph="14,1" class="t t"><span id="dc7d626f243742ea">CryptCATCDFEnumMembersByCDFTagExErrorCallBack</span></a>(<span class="i">DWORD</span> <span id="r257 rd" class="r257 r">NotUsedDWORD1</span>,
                                      <span class="i">DWORD</span> <span id="r258 rd" class="r258 r">NotUsedDWORD2</span>,
                                      [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                                      <b>string</b> <span id="r259 rd" class="r259 r">NotUsedString</span>);
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56523
</pre></td></tr></table></div></body></html>
